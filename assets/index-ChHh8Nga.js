var Vde=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var T9e=Vde(cT=>{function Hde(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var jde=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function zL(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Wde(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var YJ={exports:{}},UL={},KJ={exports:{}},Zi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NM=Symbol.for("react.element"),$de=Symbol.for("react.portal"),Xde=Symbol.for("react.fragment"),qde=Symbol.for("react.strict_mode"),Zde=Symbol.for("react.profiler"),Yde=Symbol.for("react.provider"),Kde=Symbol.for("react.context"),Jde=Symbol.for("react.forward_ref"),Qde=Symbol.for("react.suspense"),epe=Symbol.for("react.memo"),tpe=Symbol.for("react.lazy"),gj=Symbol.iterator;function npe(n){return n===null||typeof n!="object"?null:(n=gj&&n[gj]||n["@@iterator"],typeof n=="function"?n:null)}var JJ={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QJ=Object.assign,eQ={};function yw(n,e,t){this.props=n,this.context=e,this.refs=eQ,this.updater=t||JJ}yw.prototype.isReactComponent={};yw.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};yw.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function tQ(){}tQ.prototype=yw.prototype;function J5(n,e,t){this.props=n,this.context=e,this.refs=eQ,this.updater=t||JJ}var Q5=J5.prototype=new tQ;Q5.constructor=J5;QJ(Q5,yw.prototype);Q5.isPureReactComponent=!0;var vj=Array.isArray,nQ=Object.prototype.hasOwnProperty,eU={current:null},rQ={key:!0,ref:!0,__self:!0,__source:!0};function iQ(n,e,t){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)nQ.call(e,r)&&!rQ.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){for(var a=Array(l),h=0;h<l;h++)a[h]=arguments[h+2];i.children=a}if(n&&n.defaultProps)for(r in l=n.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:NM,type:n,key:s,ref:o,props:i,_owner:eU.current}}function rpe(n,e){return{$$typeof:NM,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function tU(n){return typeof n=="object"&&n!==null&&n.$$typeof===NM}function ipe(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var _j=/\/+/g;function Jk(n,e){return typeof n=="object"&&n!==null&&n.key!=null?ipe(""+n.key):e.toString(36)}function jI(n,e,t,r,i){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case NM:case $de:o=!0}}if(o)return o=n,i=i(o),n=r===""?"."+Jk(o,0):r,vj(i)?(t="",n!=null&&(t=n.replace(_j,"$&/")+"/"),jI(i,e,t,"",function(h){return h})):i!=null&&(tU(i)&&(i=rpe(i,t+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(_j,"$&/")+"/")+n)),e.push(i)),1;if(o=0,r=r===""?".":r+":",vj(n))for(var l=0;l<n.length;l++){s=n[l];var a=r+Jk(s,l);o+=jI(s,e,t,a,i)}else if(a=npe(n),typeof a=="function")for(n=a.call(n),l=0;!(s=n.next()).done;)s=s.value,a=r+Jk(s,l++),o+=jI(s,e,t,a,i);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function yC(n,e,t){if(n==null)return n;var r=[],i=0;return jI(n,r,"","",function(s){return e.call(t,s,i++)}),r}function spe(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Bc={current:null},WI={transition:null},ape={ReactCurrentDispatcher:Bc,ReactCurrentBatchConfig:WI,ReactCurrentOwner:eU};Zi.Children={map:yC,forEach:function(n,e,t){yC(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return yC(n,function(){e++}),e},toArray:function(n){return yC(n,function(e){return e})||[]},only:function(n){if(!tU(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Zi.Component=yw;Zi.Fragment=Xde;Zi.Profiler=Zde;Zi.PureComponent=J5;Zi.StrictMode=qde;Zi.Suspense=Qde;Zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ape;Zi.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=QJ({},n.props),i=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=eU.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(a in e)nQ.call(e,a)&&!rQ.hasOwnProperty(a)&&(r[a]=e[a]===void 0&&l!==void 0?l[a]:e[a])}var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){l=Array(a);for(var h=0;h<a;h++)l[h]=arguments[h+2];r.children=l}return{$$typeof:NM,type:n.type,key:i,ref:s,props:r,_owner:o}};Zi.createContext=function(n){return n={$$typeof:Kde,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:Yde,_context:n},n.Consumer=n};Zi.createElement=iQ;Zi.createFactory=function(n){var e=iQ.bind(null,n);return e.type=n,e};Zi.createRef=function(){return{current:null}};Zi.forwardRef=function(n){return{$$typeof:Jde,render:n}};Zi.isValidElement=tU;Zi.lazy=function(n){return{$$typeof:tpe,_payload:{_status:-1,_result:n},_init:spe}};Zi.memo=function(n,e){return{$$typeof:epe,type:n,compare:e===void 0?null:e}};Zi.startTransition=function(n){var e=WI.transition;WI.transition={};try{n()}finally{WI.transition=e}};Zi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Zi.useCallback=function(n,e){return Bc.current.useCallback(n,e)};Zi.useContext=function(n){return Bc.current.useContext(n)};Zi.useDebugValue=function(){};Zi.useDeferredValue=function(n){return Bc.current.useDeferredValue(n)};Zi.useEffect=function(n,e){return Bc.current.useEffect(n,e)};Zi.useId=function(){return Bc.current.useId()};Zi.useImperativeHandle=function(n,e,t){return Bc.current.useImperativeHandle(n,e,t)};Zi.useInsertionEffect=function(n,e){return Bc.current.useInsertionEffect(n,e)};Zi.useLayoutEffect=function(n,e){return Bc.current.useLayoutEffect(n,e)};Zi.useMemo=function(n,e){return Bc.current.useMemo(n,e)};Zi.useReducer=function(n,e,t){return Bc.current.useReducer(n,e,t)};Zi.useRef=function(n){return Bc.current.useRef(n)};Zi.useState=function(n){return Bc.current.useState(n)};Zi.useSyncExternalStore=function(n,e,t){return Bc.current.useSyncExternalStore(n,e,t)};Zi.useTransition=function(){return Bc.current.useTransition()};Zi.version="18.2.0";KJ.exports=Zi;var Ae=KJ.exports;const Zl=zL(Ae),AR=Hde({__proto__:null,default:Zl},[Ae]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ope=Ae,lpe=Symbol.for("react.element"),cpe=Symbol.for("react.fragment"),upe=Object.prototype.hasOwnProperty,hpe=ope.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fpe={key:!0,ref:!0,__self:!0,__source:!0};function sQ(n,e,t){var r,i={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)upe.call(e,r)&&!fpe.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:lpe,type:n,key:s,ref:o,props:i,_owner:hpe.current}}UL.Fragment=cpe;UL.jsx=sQ;UL.jsxs=sQ;YJ.exports=UL;var me=YJ.exports,BN={},aQ={exports:{}},Vu={},oQ={exports:{}},lQ={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(_e,We){var Ue=_e.length;_e.push(We);e:for(;0<Ue;){var vt=Ue-1>>>1,xt=_e[vt];if(0<i(xt,We))_e[vt]=We,_e[Ue]=xt,Ue=vt;else break e}}function t(_e){return _e.length===0?null:_e[0]}function r(_e){if(_e.length===0)return null;var We=_e[0],Ue=_e.pop();if(Ue!==We){_e[0]=Ue;e:for(var vt=0,xt=_e.length,Vt=xt>>>1;vt<Vt;){var lt=2*(vt+1)-1,Ht=_e[lt],Qt=lt+1,rn=_e[Qt];if(0>i(Ht,Ue))Qt<xt&&0>i(rn,Ht)?(_e[vt]=rn,_e[Qt]=Ue,vt=Qt):(_e[vt]=Ht,_e[lt]=Ue,vt=lt);else if(Qt<xt&&0>i(rn,Ue))_e[vt]=rn,_e[Qt]=Ue,vt=Qt;else break e}}return We}function i(_e,We){var Ue=_e.sortIndex-We.sortIndex;return Ue!==0?Ue:_e.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var a=[],h=[],f=1,p=null,v=3,y=!1,S=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(_e){for(var We=t(h);We!==null;){if(We.callback===null)r(h);else if(We.startTime<=_e)r(h),We.sortIndex=We.expirationTime,e(a,We);else break;We=t(h)}}function H(_e){if(C=!1,k(_e),!S)if(t(a)!==null)S=!0,Re(X);else{var We=t(h);We!==null&&st(H,We.startTime-_e)}}function X(_e,We){S=!1,C&&(C=!1,E(re),re=-1),y=!0;var Ue=v;try{for(k(We),p=t(a);p!==null&&(!(p.expirationTime>We)||_e&&!fe());){var vt=p.callback;if(typeof vt=="function"){p.callback=null,v=p.priorityLevel;var xt=vt(p.expirationTime<=We);We=n.unstable_now(),typeof xt=="function"?p.callback=xt:p===t(a)&&r(a),k(We)}else r(a);p=t(a)}if(p!==null)var Vt=!0;else{var lt=t(h);lt!==null&&st(H,lt.startTime-We),Vt=!1}return Vt}finally{p=null,v=Ue,y=!1}}var Z=!1,Q=null,re=-1,ie=5,oe=-1;function fe(){return!(n.unstable_now()-oe<ie)}function Se(){if(Q!==null){var _e=n.unstable_now();oe=_e;var We=!0;try{We=Q(!0,_e)}finally{We?Ee():(Z=!1,Q=null)}}else Z=!1}var Ee;if(typeof L=="function")Ee=function(){L(Se)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,He=Ie.port2;Ie.port1.onmessage=Se,Ee=function(){He.postMessage(null)}}else Ee=function(){M(Se,0)};function Re(_e){Q=_e,Z||(Z=!0,Ee())}function st(_e,We){re=M(function(){_e(n.unstable_now())},We)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(_e){_e.callback=null},n.unstable_continueExecution=function(){S||y||(S=!0,Re(X))},n.unstable_forceFrameRate=function(_e){0>_e||125<_e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<_e?Math.floor(1e3/_e):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(_e){switch(v){case 1:case 2:case 3:var We=3;break;default:We=v}var Ue=v;v=We;try{return _e()}finally{v=Ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(_e,We){switch(_e){case 1:case 2:case 3:case 4:case 5:break;default:_e=3}var Ue=v;v=_e;try{return We()}finally{v=Ue}},n.unstable_scheduleCallback=function(_e,We,Ue){var vt=n.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?vt+Ue:vt):Ue=vt,_e){case 1:var xt=-1;break;case 2:xt=250;break;case 5:xt=1073741823;break;case 4:xt=1e4;break;default:xt=5e3}return xt=Ue+xt,_e={id:f++,callback:We,priorityLevel:_e,startTime:Ue,expirationTime:xt,sortIndex:-1},Ue>vt?(_e.sortIndex=Ue,e(h,_e),t(a)===null&&_e===t(h)&&(C?(E(re),re=-1):C=!0,st(H,Ue-vt))):(_e.sortIndex=xt,e(a,_e),S||y||(S=!0,Re(X))),_e},n.unstable_shouldYield=fe,n.unstable_wrapCallback=function(_e){var We=v;return function(){var Ue=v;v=We;try{return _e.apply(this,arguments)}finally{v=Ue}}}})(lQ);oQ.exports=lQ;var dpe=oQ.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cQ=Ae,Uu=dpe;function Zn(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var uQ=new Set,IT={};function vx(n,e){Yb(n,e),Yb(n+"Capture",e)}function Yb(n,e){for(IT[n]=e,n=0;n<e.length;n++)uQ.add(e[n])}var Vm=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kN=Object.prototype.hasOwnProperty,ppe=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yj={},xj={};function mpe(n){return kN.call(xj,n)?!0:kN.call(yj,n)?!1:ppe.test(n)?xj[n]=!0:(yj[n]=!0,!1)}function gpe(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function vpe(n,e,t,r){if(e===null||typeof e>"u"||gpe(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function kc(n,e,t,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Tl={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Tl[n]=new kc(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Tl[e]=new kc(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Tl[n]=new kc(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Tl[n]=new kc(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Tl[n]=new kc(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Tl[n]=new kc(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Tl[n]=new kc(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Tl[n]=new kc(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Tl[n]=new kc(n,5,!1,n.toLowerCase(),null,!1,!1)});var nU=/[\-:]([a-z])/g;function rU(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(nU,rU);Tl[e]=new kc(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(nU,rU);Tl[e]=new kc(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(nU,rU);Tl[e]=new kc(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Tl[n]=new kc(n,1,!1,n.toLowerCase(),null,!1,!1)});Tl.xlinkHref=new kc("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Tl[n]=new kc(n,1,!1,n.toLowerCase(),null,!0,!0)});function iU(n,e,t,r){var i=Tl.hasOwnProperty(e)?Tl[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vpe(e,t,i,r)&&(t=null),r||i===null?mpe(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var rg=cQ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xC=Symbol.for("react.element"),ob=Symbol.for("react.portal"),lb=Symbol.for("react.fragment"),sU=Symbol.for("react.strict_mode"),ON=Symbol.for("react.profiler"),hQ=Symbol.for("react.provider"),fQ=Symbol.for("react.context"),aU=Symbol.for("react.forward_ref"),FN=Symbol.for("react.suspense"),NN=Symbol.for("react.suspense_list"),oU=Symbol.for("react.memo"),Dv=Symbol.for("react.lazy"),dQ=Symbol.for("react.offscreen"),bj=Symbol.iterator;function SS(n){return n===null||typeof n!="object"?null:(n=bj&&n[bj]||n["@@iterator"],typeof n=="function"?n:null)}var ja=Object.assign,Qk;function SA(n){if(Qk===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Qk=e&&e[1]||""}return`
`+Qk+n}var eO=!1;function tO(n,e){if(!n||eO)return"";eO=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var r=h}Reflect.construct(n,[],e)}else{try{e.call()}catch(h){r=h}n.call(e.prototype)}else{try{throw Error()}catch(h){r=h}n()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var a=`
`+i[o].replace(" at new "," at ");return n.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",n.displayName)),a}while(1<=o&&0<=l);break}}}finally{eO=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?SA(n):""}function _pe(n){switch(n.tag){case 5:return SA(n.type);case 16:return SA("Lazy");case 13:return SA("Suspense");case 19:return SA("SuspenseList");case 0:case 2:case 15:return n=tO(n.type,!1),n;case 11:return n=tO(n.type.render,!1),n;case 1:return n=tO(n.type,!0),n;default:return""}}function zN(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case lb:return"Fragment";case ob:return"Portal";case ON:return"Profiler";case sU:return"StrictMode";case FN:return"Suspense";case NN:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case fQ:return(n.displayName||"Context")+".Consumer";case hQ:return(n._context.displayName||"Context")+".Provider";case aU:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case oU:return e=n.displayName||null,e!==null?e:zN(n.type)||"Memo";case Dv:e=n._payload,n=n._init;try{return zN(n(e))}catch{}}return null}function ype(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zN(e);case 8:return e===sU?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function h0(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function pQ(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xpe(n){var e=pQ(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function bC(n){n._valueTracker||(n._valueTracker=xpe(n))}function mQ(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=pQ(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function TR(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function UN(n,e){var t=e.checked;return ja({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function wj(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=h0(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function gQ(n,e){e=e.checked,e!=null&&iU(n,"checked",e,!1)}function GN(n,e){gQ(n,e);var t=h0(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?VN(n,e.type,t):e.hasOwnProperty("defaultValue")&&VN(n,e.type,h0(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Sj(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function VN(n,e,t){(e!=="number"||TR(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var AA=Array.isArray;function Pb(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+h0(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function HN(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Zn(91));return ja({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Aj(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Zn(92));if(AA(t)){if(1<t.length)throw Error(Zn(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:h0(t)}}function vQ(n,e){var t=h0(e.value),r=h0(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Tj(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function _Q(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jN(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?_Q(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var wC,yQ=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(wC=wC||document.createElement("div"),wC.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=wC.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function RT(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var VA={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bpe=["Webkit","ms","Moz","O"];Object.keys(VA).forEach(function(n){bpe.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),VA[e]=VA[n]})});function xQ(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||VA.hasOwnProperty(n)&&VA[n]?(""+e).trim():e+"px"}function bQ(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=xQ(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var wpe=ja({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function WN(n,e){if(e){if(wpe[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Zn(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Zn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Zn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Zn(62))}}function $N(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var XN=null;function lU(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var qN=null,Lb=null,Db=null;function Mj(n){if(n=GM(n)){if(typeof qN!="function")throw Error(Zn(280));var e=n.stateNode;e&&(e=WL(e),qN(n.stateNode,n.type,e))}}function wQ(n){Lb?Db?Db.push(n):Db=[n]:Lb=n}function SQ(){if(Lb){var n=Lb,e=Db;if(Db=Lb=null,Mj(n),e)for(n=0;n<e.length;n++)Mj(e[n])}}function AQ(n,e){return n(e)}function TQ(){}var nO=!1;function MQ(n,e,t){if(nO)return n(e,t);nO=!0;try{return AQ(n,e,t)}finally{nO=!1,(Lb!==null||Db!==null)&&(TQ(),SQ())}}function PT(n,e){var t=n.stateNode;if(t===null)return null;var r=WL(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Zn(231,e,typeof t));return t}var ZN=!1;if(Vm)try{var AS={};Object.defineProperty(AS,"passive",{get:function(){ZN=!0}}),window.addEventListener("test",AS,AS),window.removeEventListener("test",AS,AS)}catch{ZN=!1}function Spe(n,e,t,r,i,s,o,l,a){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(f){this.onError(f)}}var HA=!1,MR=null,ER=!1,YN=null,Ape={onError:function(n){HA=!0,MR=n}};function Tpe(n,e,t,r,i,s,o,l,a){HA=!1,MR=null,Spe.apply(Ape,arguments)}function Mpe(n,e,t,r,i,s,o,l,a){if(Tpe.apply(this,arguments),HA){if(HA){var h=MR;HA=!1,MR=null}else throw Error(Zn(198));ER||(ER=!0,YN=h)}}function _x(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function EQ(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Ej(n){if(_x(n)!==n)throw Error(Zn(188))}function Epe(n){var e=n.alternate;if(!e){if(e=_x(n),e===null)throw Error(Zn(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===t)return Ej(i),n;if(s===r)return Ej(i),e;s=s.sibling}throw Error(Zn(188))}if(t.return!==r.return)t=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===t){o=!0,t=i,r=s;break}if(l===r){o=!0,r=i,t=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===t){o=!0,t=s,r=i;break}if(l===r){o=!0,r=s,t=i;break}l=l.sibling}if(!o)throw Error(Zn(189))}}if(t.alternate!==r)throw Error(Zn(190))}if(t.tag!==3)throw Error(Zn(188));return t.stateNode.current===t?n:e}function CQ(n){return n=Epe(n),n!==null?IQ(n):null}function IQ(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=IQ(n);if(e!==null)return e;n=n.sibling}return null}var RQ=Uu.unstable_scheduleCallback,Cj=Uu.unstable_cancelCallback,Cpe=Uu.unstable_shouldYield,Ipe=Uu.unstable_requestPaint,po=Uu.unstable_now,Rpe=Uu.unstable_getCurrentPriorityLevel,cU=Uu.unstable_ImmediatePriority,PQ=Uu.unstable_UserBlockingPriority,CR=Uu.unstable_NormalPriority,Ppe=Uu.unstable_LowPriority,LQ=Uu.unstable_IdlePriority,GL=null,op=null;function Lpe(n){if(op&&typeof op.onCommitFiberRoot=="function")try{op.onCommitFiberRoot(GL,n,void 0,(n.current.flags&128)===128)}catch{}}var $f=Math.clz32?Math.clz32:kpe,Dpe=Math.log,Bpe=Math.LN2;function kpe(n){return n>>>=0,n===0?32:31-(Dpe(n)/Bpe|0)|0}var SC=64,AC=4194304;function TA(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function IR(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~i;l!==0?r=TA(l):(s&=o,s!==0&&(r=TA(s)))}else o=t&~i,o!==0?r=TA(o):s!==0&&(r=TA(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-$f(e),i=1<<t,r|=n[t],e&=~i;return r}function Ope(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fpe(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-$f(s),l=1<<o,a=i[o];a===-1?(!(l&t)||l&r)&&(i[o]=Ope(l,e)):a<=e&&(n.expiredLanes|=l),s&=~l}}function KN(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function DQ(){var n=SC;return SC<<=1,!(SC&4194240)&&(SC=64),n}function rO(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function zM(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-$f(e),n[e]=t}function Npe(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-$f(t),s=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~s}}function uU(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-$f(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var Ns=0;function BQ(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var kQ,hU,OQ,FQ,NQ,JN=!1,TC=[],Kv=null,Jv=null,Qv=null,LT=new Map,DT=new Map,Fv=[],zpe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ij(n,e){switch(n){case"focusin":case"focusout":Kv=null;break;case"dragenter":case"dragleave":Jv=null;break;case"mouseover":case"mouseout":Qv=null;break;case"pointerover":case"pointerout":LT.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":DT.delete(e.pointerId)}}function TS(n,e,t,r,i,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=GM(e),e!==null&&hU(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function Upe(n,e,t,r,i){switch(e){case"focusin":return Kv=TS(Kv,n,e,t,r,i),!0;case"dragenter":return Jv=TS(Jv,n,e,t,r,i),!0;case"mouseover":return Qv=TS(Qv,n,e,t,r,i),!0;case"pointerover":var s=i.pointerId;return LT.set(s,TS(LT.get(s)||null,n,e,t,r,i)),!0;case"gotpointercapture":return s=i.pointerId,DT.set(s,TS(DT.get(s)||null,n,e,t,r,i)),!0}return!1}function zQ(n){var e=_y(n.target);if(e!==null){var t=_x(e);if(t!==null){if(e=t.tag,e===13){if(e=EQ(t),e!==null){n.blockedOn=e,NQ(n.priority,function(){OQ(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function $I(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=QN(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);XN=r,t.target.dispatchEvent(r),XN=null}else return e=GM(t),e!==null&&hU(e),n.blockedOn=t,!1;e.shift()}return!0}function Rj(n,e,t){$I(n)&&t.delete(e)}function Gpe(){JN=!1,Kv!==null&&$I(Kv)&&(Kv=null),Jv!==null&&$I(Jv)&&(Jv=null),Qv!==null&&$I(Qv)&&(Qv=null),LT.forEach(Rj),DT.forEach(Rj)}function MS(n,e){n.blockedOn===e&&(n.blockedOn=null,JN||(JN=!0,Uu.unstable_scheduleCallback(Uu.unstable_NormalPriority,Gpe)))}function BT(n){function e(i){return MS(i,n)}if(0<TC.length){MS(TC[0],n);for(var t=1;t<TC.length;t++){var r=TC[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Kv!==null&&MS(Kv,n),Jv!==null&&MS(Jv,n),Qv!==null&&MS(Qv,n),LT.forEach(e),DT.forEach(e),t=0;t<Fv.length;t++)r=Fv[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Fv.length&&(t=Fv[0],t.blockedOn===null);)zQ(t),t.blockedOn===null&&Fv.shift()}var Bb=rg.ReactCurrentBatchConfig,RR=!0;function Vpe(n,e,t,r){var i=Ns,s=Bb.transition;Bb.transition=null;try{Ns=1,fU(n,e,t,r)}finally{Ns=i,Bb.transition=s}}function Hpe(n,e,t,r){var i=Ns,s=Bb.transition;Bb.transition=null;try{Ns=4,fU(n,e,t,r)}finally{Ns=i,Bb.transition=s}}function fU(n,e,t,r){if(RR){var i=QN(n,e,t,r);if(i===null)dO(n,e,r,PR,t),Ij(n,r);else if(Upe(i,n,e,t,r))r.stopPropagation();else if(Ij(n,r),e&4&&-1<zpe.indexOf(n)){for(;i!==null;){var s=GM(i);if(s!==null&&kQ(s),s=QN(n,e,t,r),s===null&&dO(n,e,r,PR,t),s===i)break;i=s}i!==null&&r.stopPropagation()}else dO(n,e,r,null,t)}}var PR=null;function QN(n,e,t,r){if(PR=null,n=lU(r),n=_y(n),n!==null)if(e=_x(n),e===null)n=null;else if(t=e.tag,t===13){if(n=EQ(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return PR=n,null}function UQ(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Rpe()){case cU:return 1;case PQ:return 4;case CR:case Ppe:return 16;case LQ:return 536870912;default:return 16}default:return 16}}var Gv=null,dU=null,XI=null;function GQ(){if(XI)return XI;var n,e=dU,t=e.length,r,i="value"in Gv?Gv.value:Gv.textContent,s=i.length;for(n=0;n<t&&e[n]===i[n];n++);var o=t-n;for(r=1;r<=o&&e[t-r]===i[s-r];r++);return XI=i.slice(n,1<r?1-r:void 0)}function qI(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function MC(){return!0}function Pj(){return!1}function Hu(n){function e(t,r,i,s,o){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?MC:Pj,this.isPropagationStopped=Pj,this}return ja(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=MC)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=MC)},persist:function(){},isPersistent:MC}),e}var xw={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},pU=Hu(xw),UM=ja({},xw,{view:0,detail:0}),jpe=Hu(UM),iO,sO,ES,VL=ja({},UM,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:mU,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ES&&(ES&&n.type==="mousemove"?(iO=n.screenX-ES.screenX,sO=n.screenY-ES.screenY):sO=iO=0,ES=n),iO)},movementY:function(n){return"movementY"in n?n.movementY:sO}}),Lj=Hu(VL),Wpe=ja({},VL,{dataTransfer:0}),$pe=Hu(Wpe),Xpe=ja({},UM,{relatedTarget:0}),aO=Hu(Xpe),qpe=ja({},xw,{animationName:0,elapsedTime:0,pseudoElement:0}),Zpe=Hu(qpe),Ype=ja({},xw,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Kpe=Hu(Ype),Jpe=ja({},xw,{data:0}),Dj=Hu(Jpe),Qpe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eme={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tme={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nme(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=tme[n])?!!e[n]:!1}function mU(){return nme}var rme=ja({},UM,{key:function(n){if(n.key){var e=Qpe[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=qI(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?eme[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:mU,charCode:function(n){return n.type==="keypress"?qI(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?qI(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),ime=Hu(rme),sme=ja({},VL,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bj=Hu(sme),ame=ja({},UM,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:mU}),ome=Hu(ame),lme=ja({},xw,{propertyName:0,elapsedTime:0,pseudoElement:0}),cme=Hu(lme),ume=ja({},VL,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),hme=Hu(ume),fme=[9,13,27,32],gU=Vm&&"CompositionEvent"in window,jA=null;Vm&&"documentMode"in document&&(jA=document.documentMode);var dme=Vm&&"TextEvent"in window&&!jA,VQ=Vm&&(!gU||jA&&8<jA&&11>=jA),kj=" ",Oj=!1;function HQ(n,e){switch(n){case"keyup":return fme.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jQ(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var cb=!1;function pme(n,e){switch(n){case"compositionend":return jQ(e);case"keypress":return e.which!==32?null:(Oj=!0,kj);case"textInput":return n=e.data,n===kj&&Oj?null:n;default:return null}}function mme(n,e){if(cb)return n==="compositionend"||!gU&&HQ(n,e)?(n=GQ(),XI=dU=Gv=null,cb=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VQ&&e.locale!=="ko"?null:e.data;default:return null}}var gme={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fj(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!gme[n.type]:e==="textarea"}function WQ(n,e,t,r){wQ(r),e=LR(e,"onChange"),0<e.length&&(t=new pU("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var WA=null,kT=null;function vme(n){nee(n,0)}function HL(n){var e=fb(n);if(mQ(e))return n}function _me(n,e){if(n==="change")return e}var $Q=!1;if(Vm){var oO;if(Vm){var lO="oninput"in document;if(!lO){var Nj=document.createElement("div");Nj.setAttribute("oninput","return;"),lO=typeof Nj.oninput=="function"}oO=lO}else oO=!1;$Q=oO&&(!document.documentMode||9<document.documentMode)}function zj(){WA&&(WA.detachEvent("onpropertychange",XQ),kT=WA=null)}function XQ(n){if(n.propertyName==="value"&&HL(kT)){var e=[];WQ(e,kT,n,lU(n)),MQ(vme,e)}}function yme(n,e,t){n==="focusin"?(zj(),WA=e,kT=t,WA.attachEvent("onpropertychange",XQ)):n==="focusout"&&zj()}function xme(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return HL(kT)}function bme(n,e){if(n==="click")return HL(e)}function wme(n,e){if(n==="input"||n==="change")return HL(e)}function Sme(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Yf=typeof Object.is=="function"?Object.is:Sme;function OT(n,e){if(Yf(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!kN.call(e,i)||!Yf(n[i],e[i]))return!1}return!0}function Uj(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Gj(n,e){var t=Uj(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=Uj(t)}}function qQ(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?qQ(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function ZQ(){for(var n=window,e=TR();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=TR(n.document)}return e}function vU(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Ame(n){var e=ZQ(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&qQ(t.ownerDocument.documentElement,t)){if(r!==null&&vU(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!n.extend&&s>r&&(i=r,r=s,s=i),i=Gj(t,s);var o=Gj(t,r);i&&o&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),s>r?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Tme=Vm&&"documentMode"in document&&11>=document.documentMode,ub=null,e4=null,$A=null,t4=!1;function Vj(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;t4||ub==null||ub!==TR(r)||(r=ub,"selectionStart"in r&&vU(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$A&&OT($A,r)||($A=r,r=LR(e4,"onSelect"),0<r.length&&(e=new pU("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=ub)))}function EC(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var hb={animationend:EC("Animation","AnimationEnd"),animationiteration:EC("Animation","AnimationIteration"),animationstart:EC("Animation","AnimationStart"),transitionend:EC("Transition","TransitionEnd")},cO={},YQ={};Vm&&(YQ=document.createElement("div").style,"AnimationEvent"in window||(delete hb.animationend.animation,delete hb.animationiteration.animation,delete hb.animationstart.animation),"TransitionEvent"in window||delete hb.transitionend.transition);function jL(n){if(cO[n])return cO[n];if(!hb[n])return n;var e=hb[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in YQ)return cO[n]=e[t];return n}var KQ=jL("animationend"),JQ=jL("animationiteration"),QQ=jL("animationstart"),eee=jL("transitionend"),tee=new Map,Hj="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function E0(n,e){tee.set(n,e),vx(e,[n])}for(var uO=0;uO<Hj.length;uO++){var hO=Hj[uO],Mme=hO.toLowerCase(),Eme=hO[0].toUpperCase()+hO.slice(1);E0(Mme,"on"+Eme)}E0(KQ,"onAnimationEnd");E0(JQ,"onAnimationIteration");E0(QQ,"onAnimationStart");E0("dblclick","onDoubleClick");E0("focusin","onFocus");E0("focusout","onBlur");E0(eee,"onTransitionEnd");Yb("onMouseEnter",["mouseout","mouseover"]);Yb("onMouseLeave",["mouseout","mouseover"]);Yb("onPointerEnter",["pointerout","pointerover"]);Yb("onPointerLeave",["pointerout","pointerover"]);vx("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vx("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vx("onBeforeInput",["compositionend","keypress","textInput","paste"]);vx("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vx("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vx("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var MA="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cme=new Set("cancel close invalid load scroll toggle".split(" ").concat(MA));function jj(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,Mpe(r,e,void 0,n),n.currentTarget=null}function nee(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],a=l.instance,h=l.currentTarget;if(l=l.listener,a!==s&&i.isPropagationStopped())break e;jj(i,l,h),s=a}else for(o=0;o<r.length;o++){if(l=r[o],a=l.instance,h=l.currentTarget,l=l.listener,a!==s&&i.isPropagationStopped())break e;jj(i,l,h),s=a}}}if(ER)throw n=YN,ER=!1,YN=null,n}function ma(n,e){var t=e[a4];t===void 0&&(t=e[a4]=new Set);var r=n+"__bubble";t.has(r)||(ree(e,n,2,!1),t.add(r))}function fO(n,e,t){var r=0;e&&(r|=4),ree(t,n,r,e)}var CC="_reactListening"+Math.random().toString(36).slice(2);function FT(n){if(!n[CC]){n[CC]=!0,uQ.forEach(function(t){t!=="selectionchange"&&(Cme.has(t)||fO(t,!1,n),fO(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[CC]||(e[CC]=!0,fO("selectionchange",!1,e))}}function ree(n,e,t,r){switch(UQ(e)){case 1:var i=Vpe;break;case 4:i=Hpe;break;default:i=fU}t=i.bind(null,e,t,n),i=void 0,!ZN||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function dO(n,e,t,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var a=o.tag;if((a===3||a===4)&&(a=o.stateNode.containerInfo,a===i||a.nodeType===8&&a.parentNode===i))return;o=o.return}for(;l!==null;){if(o=_y(l),o===null)return;if(a=o.tag,a===5||a===6){r=s=o;continue e}l=l.parentNode}}r=r.return}MQ(function(){var h=s,f=lU(t),p=[];e:{var v=tee.get(n);if(v!==void 0){var y=pU,S=n;switch(n){case"keypress":if(qI(t)===0)break e;case"keydown":case"keyup":y=ime;break;case"focusin":S="focus",y=aO;break;case"focusout":S="blur",y=aO;break;case"beforeblur":case"afterblur":y=aO;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=Lj;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=$pe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=ome;break;case KQ:case JQ:case QQ:y=Zpe;break;case eee:y=cme;break;case"scroll":y=jpe;break;case"wheel":y=hme;break;case"copy":case"cut":case"paste":y=Kpe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Bj}var C=(e&4)!==0,M=!C&&n==="scroll",E=C?v!==null?v+"Capture":null:v;C=[];for(var L=h,k;L!==null;){k=L;var H=k.stateNode;if(k.tag===5&&H!==null&&(k=H,E!==null&&(H=PT(L,E),H!=null&&C.push(NT(L,H,k)))),M)break;L=L.return}0<C.length&&(v=new y(v,S,null,t,f),p.push({event:v,listeners:C}))}}if(!(e&7)){e:{if(v=n==="mouseover"||n==="pointerover",y=n==="mouseout"||n==="pointerout",v&&t!==XN&&(S=t.relatedTarget||t.fromElement)&&(_y(S)||S[Hm]))break e;if((y||v)&&(v=f.window===f?f:(v=f.ownerDocument)?v.defaultView||v.parentWindow:window,y?(S=t.relatedTarget||t.toElement,y=h,S=S?_y(S):null,S!==null&&(M=_x(S),S!==M||S.tag!==5&&S.tag!==6)&&(S=null)):(y=null,S=h),y!==S)){if(C=Lj,H="onMouseLeave",E="onMouseEnter",L="mouse",(n==="pointerout"||n==="pointerover")&&(C=Bj,H="onPointerLeave",E="onPointerEnter",L="pointer"),M=y==null?v:fb(y),k=S==null?v:fb(S),v=new C(H,L+"leave",y,t,f),v.target=M,v.relatedTarget=k,H=null,_y(f)===h&&(C=new C(E,L+"enter",S,t,f),C.target=k,C.relatedTarget=M,H=C),M=H,y&&S)t:{for(C=y,E=S,L=0,k=C;k;k=o1(k))L++;for(k=0,H=E;H;H=o1(H))k++;for(;0<L-k;)C=o1(C),L--;for(;0<k-L;)E=o1(E),k--;for(;L--;){if(C===E||E!==null&&C===E.alternate)break t;C=o1(C),E=o1(E)}C=null}else C=null;y!==null&&Wj(p,v,y,C,!1),S!==null&&M!==null&&Wj(p,M,S,C,!0)}}e:{if(v=h?fb(h):window,y=v.nodeName&&v.nodeName.toLowerCase(),y==="select"||y==="input"&&v.type==="file")var X=_me;else if(Fj(v))if($Q)X=wme;else{X=xme;var Z=yme}else(y=v.nodeName)&&y.toLowerCase()==="input"&&(v.type==="checkbox"||v.type==="radio")&&(X=bme);if(X&&(X=X(n,h))){WQ(p,X,t,f);break e}Z&&Z(n,v,h),n==="focusout"&&(Z=v._wrapperState)&&Z.controlled&&v.type==="number"&&VN(v,"number",v.value)}switch(Z=h?fb(h):window,n){case"focusin":(Fj(Z)||Z.contentEditable==="true")&&(ub=Z,e4=h,$A=null);break;case"focusout":$A=e4=ub=null;break;case"mousedown":t4=!0;break;case"contextmenu":case"mouseup":case"dragend":t4=!1,Vj(p,t,f);break;case"selectionchange":if(Tme)break;case"keydown":case"keyup":Vj(p,t,f)}var Q;if(gU)e:{switch(n){case"compositionstart":var re="onCompositionStart";break e;case"compositionend":re="onCompositionEnd";break e;case"compositionupdate":re="onCompositionUpdate";break e}re=void 0}else cb?HQ(n,t)&&(re="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(re="onCompositionStart");re&&(VQ&&t.locale!=="ko"&&(cb||re!=="onCompositionStart"?re==="onCompositionEnd"&&cb&&(Q=GQ()):(Gv=f,dU="value"in Gv?Gv.value:Gv.textContent,cb=!0)),Z=LR(h,re),0<Z.length&&(re=new Dj(re,n,null,t,f),p.push({event:re,listeners:Z}),Q?re.data=Q:(Q=jQ(t),Q!==null&&(re.data=Q)))),(Q=dme?pme(n,t):mme(n,t))&&(h=LR(h,"onBeforeInput"),0<h.length&&(f=new Dj("onBeforeInput","beforeinput",null,t,f),p.push({event:f,listeners:h}),f.data=Q))}nee(p,e)})}function NT(n,e,t){return{instance:n,listener:e,currentTarget:t}}function LR(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=PT(n,t),s!=null&&r.unshift(NT(n,s,i)),s=PT(n,e),s!=null&&r.push(NT(n,s,i))),n=n.return}return r}function o1(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Wj(n,e,t,r,i){for(var s=e._reactName,o=[];t!==null&&t!==r;){var l=t,a=l.alternate,h=l.stateNode;if(a!==null&&a===r)break;l.tag===5&&h!==null&&(l=h,i?(a=PT(t,s),a!=null&&o.unshift(NT(t,a,l))):i||(a=PT(t,s),a!=null&&o.push(NT(t,a,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var Ime=/\r\n?/g,Rme=/\u0000|\uFFFD/g;function $j(n){return(typeof n=="string"?n:""+n).replace(Ime,`
`).replace(Rme,"")}function IC(n,e,t){if(e=$j(e),$j(n)!==e&&t)throw Error(Zn(425))}function DR(){}var n4=null,r4=null;function i4(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var s4=typeof setTimeout=="function"?setTimeout:void 0,Pme=typeof clearTimeout=="function"?clearTimeout:void 0,Xj=typeof Promise=="function"?Promise:void 0,Lme=typeof queueMicrotask=="function"?queueMicrotask:typeof Xj<"u"?function(n){return Xj.resolve(null).then(n).catch(Dme)}:s4;function Dme(n){setTimeout(function(){throw n})}function pO(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),BT(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);BT(e)}function e0(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function qj(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var bw=Math.random().toString(36).slice(2),Jd="__reactFiber$"+bw,zT="__reactProps$"+bw,Hm="__reactContainer$"+bw,a4="__reactEvents$"+bw,Bme="__reactListeners$"+bw,kme="__reactHandles$"+bw;function _y(n){var e=n[Jd];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Hm]||t[Jd]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=qj(n);n!==null;){if(t=n[Jd])return t;n=qj(n)}return e}n=t,t=n.parentNode}return null}function GM(n){return n=n[Jd]||n[Hm],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function fb(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Zn(33))}function WL(n){return n[zT]||null}var o4=[],db=-1;function C0(n){return{current:n}}function va(n){0>db||(n.current=o4[db],o4[db]=null,db--)}function ia(n,e){db++,o4[db]=n.current,n.current=e}var f0={},Kl=C0(f0),uu=C0(!1),qy=f0;function Kb(n,e){var t=n.type.contextTypes;if(!t)return f0;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in t)i[s]=e[s];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function hu(n){return n=n.childContextTypes,n!=null}function BR(){va(uu),va(Kl)}function Zj(n,e,t){if(Kl.current!==f0)throw Error(Zn(168));ia(Kl,e),ia(uu,t)}function iee(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Zn(108,ype(n)||"Unknown",i));return ja({},t,r)}function kR(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||f0,qy=Kl.current,ia(Kl,n),ia(uu,uu.current),!0}function Yj(n,e,t){var r=n.stateNode;if(!r)throw Error(Zn(169));t?(n=iee(n,e,qy),r.__reactInternalMemoizedMergedChildContext=n,va(uu),va(Kl),ia(Kl,n)):va(uu),ia(uu,t)}var Tm=null,$L=!1,mO=!1;function see(n){Tm===null?Tm=[n]:Tm.push(n)}function Ome(n){$L=!0,see(n)}function I0(){if(!mO&&Tm!==null){mO=!0;var n=0,e=Ns;try{var t=Tm;for(Ns=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Tm=null,$L=!1}catch(i){throw Tm!==null&&(Tm=Tm.slice(n+1)),RQ(cU,I0),i}finally{Ns=e,mO=!1}}return null}var pb=[],mb=0,OR=null,FR=0,xh=[],bh=0,Zy=null,Rm=1,Pm="";function oy(n,e){pb[mb++]=FR,pb[mb++]=OR,OR=n,FR=e}function aee(n,e,t){xh[bh++]=Rm,xh[bh++]=Pm,xh[bh++]=Zy,Zy=n;var r=Rm;n=Pm;var i=32-$f(r)-1;r&=~(1<<i),t+=1;var s=32-$f(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Rm=1<<32-$f(e)+i|t<<i|r,Pm=s+n}else Rm=1<<s|t<<i|r,Pm=n}function _U(n){n.return!==null&&(oy(n,1),aee(n,1,0))}function yU(n){for(;n===OR;)OR=pb[--mb],pb[mb]=null,FR=pb[--mb],pb[mb]=null;for(;n===Zy;)Zy=xh[--bh],xh[bh]=null,Pm=xh[--bh],xh[bh]=null,Rm=xh[--bh],xh[bh]=null}var Ou=null,ku=null,Ma=!1,zf=null;function oee(n,e){var t=Mh(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Kj(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Ou=n,ku=e0(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Ou=n,ku=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Zy!==null?{id:Rm,overflow:Pm}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Mh(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Ou=n,ku=null,!0):!1;default:return!1}}function l4(n){return(n.mode&1)!==0&&(n.flags&128)===0}function c4(n){if(Ma){var e=ku;if(e){var t=e;if(!Kj(n,e)){if(l4(n))throw Error(Zn(418));e=e0(t.nextSibling);var r=Ou;e&&Kj(n,e)?oee(r,t):(n.flags=n.flags&-4097|2,Ma=!1,Ou=n)}}else{if(l4(n))throw Error(Zn(418));n.flags=n.flags&-4097|2,Ma=!1,Ou=n}}}function Jj(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Ou=n}function RC(n){if(n!==Ou)return!1;if(!Ma)return Jj(n),Ma=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!i4(n.type,n.memoizedProps)),e&&(e=ku)){if(l4(n))throw lee(),Error(Zn(418));for(;e;)oee(n,e),e=e0(e.nextSibling)}if(Jj(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Zn(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ku=e0(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ku=null}}else ku=Ou?e0(n.stateNode.nextSibling):null;return!0}function lee(){for(var n=ku;n;)n=e0(n.nextSibling)}function Jb(){ku=Ou=null,Ma=!1}function xU(n){zf===null?zf=[n]:zf.push(n)}var Fme=rg.ReactCurrentBatchConfig;function kf(n,e){if(n&&n.defaultProps){e=ja({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}var NR=C0(null),zR=null,gb=null,bU=null;function wU(){bU=gb=zR=null}function SU(n){var e=NR.current;va(NR),n._currentValue=e}function u4(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function kb(n,e){zR=n,bU=gb=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(au=!0),n.firstContext=null)}function Dh(n){var e=n._currentValue;if(bU!==n)if(n={context:n,memoizedValue:e,next:null},gb===null){if(zR===null)throw Error(Zn(308));gb=n,zR.dependencies={lanes:0,firstContext:n}}else gb=gb.next=n;return e}var yy=null;function AU(n){yy===null?yy=[n]:yy.push(n)}function cee(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,AU(e)):(t.next=i.next,i.next=t),e.interleaved=t,jm(n,r)}function jm(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Bv=!1;function TU(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function uee(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Fm(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function t0(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,vs&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,jm(n,t)}return i=r.interleaved,i===null?(e.next=e,AU(r)):(e.next=i.next,i.next=e),r.interleaved=e,jm(n,t)}function ZI(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,uU(n,t)}}function Qj(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?i=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?i=s=e:s=s.next=e}else i=s=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function UR(n,e,t,r){var i=n.updateQueue;Bv=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var a=l,h=a.next;a.next=null,o===null?s=h:o.next=h,o=a;var f=n.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=h:l.next=h,f.lastBaseUpdate=a))}if(s!==null){var p=i.baseState;o=0,f=h=a=null,l=s;do{var v=l.lane,y=l.eventTime;if((r&v)===v){f!==null&&(f=f.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var S=n,C=l;switch(v=e,y=t,C.tag){case 1:if(S=C.payload,typeof S=="function"){p=S.call(y,p,v);break e}p=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=C.payload,v=typeof S=="function"?S.call(y,p,v):S,v==null)break e;p=ja({},p,v);break e;case 2:Bv=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,v=i.effects,v===null?i.effects=[l]:v.push(l))}else y={eventTime:y,lane:v,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(h=f=y,a=p):f=f.next=y,o|=v;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;v=l,l=v.next,v.next=null,i.lastBaseUpdate=v,i.shared.pending=null}}while(!0);if(f===null&&(a=p),i.baseState=a,i.firstBaseUpdate=h,i.lastBaseUpdate=f,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Ky|=o,n.lanes=o,n.memoizedState=p}}function e7(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(Zn(191,i));i.call(r)}}}var hee=new cQ.Component().refs;function h4(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:ja({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var XL={isMounted:function(n){return(n=n._reactInternals)?_x(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Cc(),i=r0(n),s=Fm(r,i);s.payload=e,t!=null&&(s.callback=t),e=t0(n,s,i),e!==null&&(Xf(e,n,i,r),ZI(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Cc(),i=r0(n),s=Fm(r,i);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=t0(n,s,i),e!==null&&(Xf(e,n,i,r),ZI(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Cc(),r=r0(n),i=Fm(t,r);i.tag=2,e!=null&&(i.callback=e),e=t0(n,i,r),e!==null&&(Xf(e,n,r,t),ZI(e,n,r))}};function t7(n,e,t,r,i,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!OT(t,r)||!OT(i,s):!0}function fee(n,e,t){var r=!1,i=f0,s=e.contextType;return typeof s=="object"&&s!==null?s=Dh(s):(i=hu(e)?qy:Kl.current,r=e.contextTypes,s=(r=r!=null)?Kb(n,i):f0),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=XL,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=s),e}function n7(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&XL.enqueueReplaceState(e,e.state,null)}function f4(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs=hee,TU(n);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Dh(s):(s=hu(e)?qy:Kl.current,i.context=Kb(n,s)),i.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(h4(n,e,s,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&XL.enqueueReplaceState(i,i.state,null),UR(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function CS(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Zn(309));var r=t.stateNode}if(!r)throw Error(Zn(147,n));var i=r,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;l===hee&&(l=i.refs={}),o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(Zn(284));if(!t._owner)throw Error(Zn(290,n))}return n}function PC(n,e){throw n=Object.prototype.toString.call(e),Error(Zn(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function r7(n){var e=n._init;return e(n._payload)}function dee(n){function e(E,L){if(n){var k=E.deletions;k===null?(E.deletions=[L],E.flags|=16):k.push(L)}}function t(E,L){if(!n)return null;for(;L!==null;)e(E,L),L=L.sibling;return null}function r(E,L){for(E=new Map;L!==null;)L.key!==null?E.set(L.key,L):E.set(L.index,L),L=L.sibling;return E}function i(E,L){return E=i0(E,L),E.index=0,E.sibling=null,E}function s(E,L,k){return E.index=k,n?(k=E.alternate,k!==null?(k=k.index,k<L?(E.flags|=2,L):k):(E.flags|=2,L)):(E.flags|=1048576,L)}function o(E){return n&&E.alternate===null&&(E.flags|=2),E}function l(E,L,k,H){return L===null||L.tag!==6?(L=wO(k,E.mode,H),L.return=E,L):(L=i(L,k),L.return=E,L)}function a(E,L,k,H){var X=k.type;return X===lb?f(E,L,k.props.children,H,k.key):L!==null&&(L.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Dv&&r7(X)===L.type)?(H=i(L,k.props),H.ref=CS(E,L,k),H.return=E,H):(H=tR(k.type,k.key,k.props,null,E.mode,H),H.ref=CS(E,L,k),H.return=E,H)}function h(E,L,k,H){return L===null||L.tag!==4||L.stateNode.containerInfo!==k.containerInfo||L.stateNode.implementation!==k.implementation?(L=SO(k,E.mode,H),L.return=E,L):(L=i(L,k.children||[]),L.return=E,L)}function f(E,L,k,H,X){return L===null||L.tag!==7?(L=By(k,E.mode,H,X),L.return=E,L):(L=i(L,k),L.return=E,L)}function p(E,L,k){if(typeof L=="string"&&L!==""||typeof L=="number")return L=wO(""+L,E.mode,k),L.return=E,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case xC:return k=tR(L.type,L.key,L.props,null,E.mode,k),k.ref=CS(E,null,L),k.return=E,k;case ob:return L=SO(L,E.mode,k),L.return=E,L;case Dv:var H=L._init;return p(E,H(L._payload),k)}if(AA(L)||SS(L))return L=By(L,E.mode,k,null),L.return=E,L;PC(E,L)}return null}function v(E,L,k,H){var X=L!==null?L.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return X!==null?null:l(E,L,""+k,H);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case xC:return k.key===X?a(E,L,k,H):null;case ob:return k.key===X?h(E,L,k,H):null;case Dv:return X=k._init,v(E,L,X(k._payload),H)}if(AA(k)||SS(k))return X!==null?null:f(E,L,k,H,null);PC(E,k)}return null}function y(E,L,k,H,X){if(typeof H=="string"&&H!==""||typeof H=="number")return E=E.get(k)||null,l(L,E,""+H,X);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case xC:return E=E.get(H.key===null?k:H.key)||null,a(L,E,H,X);case ob:return E=E.get(H.key===null?k:H.key)||null,h(L,E,H,X);case Dv:var Z=H._init;return y(E,L,k,Z(H._payload),X)}if(AA(H)||SS(H))return E=E.get(k)||null,f(L,E,H,X,null);PC(L,H)}return null}function S(E,L,k,H){for(var X=null,Z=null,Q=L,re=L=0,ie=null;Q!==null&&re<k.length;re++){Q.index>re?(ie=Q,Q=null):ie=Q.sibling;var oe=v(E,Q,k[re],H);if(oe===null){Q===null&&(Q=ie);break}n&&Q&&oe.alternate===null&&e(E,Q),L=s(oe,L,re),Z===null?X=oe:Z.sibling=oe,Z=oe,Q=ie}if(re===k.length)return t(E,Q),Ma&&oy(E,re),X;if(Q===null){for(;re<k.length;re++)Q=p(E,k[re],H),Q!==null&&(L=s(Q,L,re),Z===null?X=Q:Z.sibling=Q,Z=Q);return Ma&&oy(E,re),X}for(Q=r(E,Q);re<k.length;re++)ie=y(Q,E,re,k[re],H),ie!==null&&(n&&ie.alternate!==null&&Q.delete(ie.key===null?re:ie.key),L=s(ie,L,re),Z===null?X=ie:Z.sibling=ie,Z=ie);return n&&Q.forEach(function(fe){return e(E,fe)}),Ma&&oy(E,re),X}function C(E,L,k,H){var X=SS(k);if(typeof X!="function")throw Error(Zn(150));if(k=X.call(k),k==null)throw Error(Zn(151));for(var Z=X=null,Q=L,re=L=0,ie=null,oe=k.next();Q!==null&&!oe.done;re++,oe=k.next()){Q.index>re?(ie=Q,Q=null):ie=Q.sibling;var fe=v(E,Q,oe.value,H);if(fe===null){Q===null&&(Q=ie);break}n&&Q&&fe.alternate===null&&e(E,Q),L=s(fe,L,re),Z===null?X=fe:Z.sibling=fe,Z=fe,Q=ie}if(oe.done)return t(E,Q),Ma&&oy(E,re),X;if(Q===null){for(;!oe.done;re++,oe=k.next())oe=p(E,oe.value,H),oe!==null&&(L=s(oe,L,re),Z===null?X=oe:Z.sibling=oe,Z=oe);return Ma&&oy(E,re),X}for(Q=r(E,Q);!oe.done;re++,oe=k.next())oe=y(Q,E,re,oe.value,H),oe!==null&&(n&&oe.alternate!==null&&Q.delete(oe.key===null?re:oe.key),L=s(oe,L,re),Z===null?X=oe:Z.sibling=oe,Z=oe);return n&&Q.forEach(function(Se){return e(E,Se)}),Ma&&oy(E,re),X}function M(E,L,k,H){if(typeof k=="object"&&k!==null&&k.type===lb&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case xC:e:{for(var X=k.key,Z=L;Z!==null;){if(Z.key===X){if(X=k.type,X===lb){if(Z.tag===7){t(E,Z.sibling),L=i(Z,k.props.children),L.return=E,E=L;break e}}else if(Z.elementType===X||typeof X=="object"&&X!==null&&X.$$typeof===Dv&&r7(X)===Z.type){t(E,Z.sibling),L=i(Z,k.props),L.ref=CS(E,Z,k),L.return=E,E=L;break e}t(E,Z);break}else e(E,Z);Z=Z.sibling}k.type===lb?(L=By(k.props.children,E.mode,H,k.key),L.return=E,E=L):(H=tR(k.type,k.key,k.props,null,E.mode,H),H.ref=CS(E,L,k),H.return=E,E=H)}return o(E);case ob:e:{for(Z=k.key;L!==null;){if(L.key===Z)if(L.tag===4&&L.stateNode.containerInfo===k.containerInfo&&L.stateNode.implementation===k.implementation){t(E,L.sibling),L=i(L,k.children||[]),L.return=E,E=L;break e}else{t(E,L);break}else e(E,L);L=L.sibling}L=SO(k,E.mode,H),L.return=E,E=L}return o(E);case Dv:return Z=k._init,M(E,L,Z(k._payload),H)}if(AA(k))return S(E,L,k,H);if(SS(k))return C(E,L,k,H);PC(E,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,L!==null&&L.tag===6?(t(E,L.sibling),L=i(L,k),L.return=E,E=L):(t(E,L),L=wO(k,E.mode,H),L.return=E,E=L),o(E)):t(E,L)}return M}var Qb=dee(!0),pee=dee(!1),VM={},lp=C0(VM),UT=C0(VM),GT=C0(VM);function xy(n){if(n===VM)throw Error(Zn(174));return n}function MU(n,e){switch(ia(GT,e),ia(UT,n),ia(lp,VM),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:jN(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=jN(e,n)}va(lp),ia(lp,e)}function ew(){va(lp),va(UT),va(GT)}function mee(n){xy(GT.current);var e=xy(lp.current),t=jN(e,n.type);e!==t&&(ia(UT,n),ia(lp,t))}function EU(n){UT.current===n&&(va(lp),va(UT))}var Ua=C0(0);function GR(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gO=[];function CU(){for(var n=0;n<gO.length;n++)gO[n]._workInProgressVersionPrimary=null;gO.length=0}var YI=rg.ReactCurrentDispatcher,vO=rg.ReactCurrentBatchConfig,Yy=0,Va=null,Go=null,rl=null,VR=!1,XA=!1,VT=0,Nme=0;function Bl(){throw Error(Zn(321))}function IU(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Yf(n[t],e[t]))return!1;return!0}function RU(n,e,t,r,i,s){if(Yy=s,Va=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,YI.current=n===null||n.memoizedState===null?Vme:Hme,n=t(r,i),XA){s=0;do{if(XA=!1,VT=0,25<=s)throw Error(Zn(301));s+=1,rl=Go=null,e.updateQueue=null,YI.current=jme,n=t(r,i)}while(XA)}if(YI.current=HR,e=Go!==null&&Go.next!==null,Yy=0,rl=Go=Va=null,VR=!1,e)throw Error(Zn(300));return n}function PU(){var n=VT!==0;return VT=0,n}function Kd(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rl===null?Va.memoizedState=rl=n:rl=rl.next=n,rl}function Bh(){if(Go===null){var n=Va.alternate;n=n!==null?n.memoizedState:null}else n=Go.next;var e=rl===null?Va.memoizedState:rl.next;if(e!==null)rl=e,Go=n;else{if(n===null)throw Error(Zn(310));Go=n,n={memoizedState:Go.memoizedState,baseState:Go.baseState,baseQueue:Go.baseQueue,queue:Go.queue,next:null},rl===null?Va.memoizedState=rl=n:rl=rl.next=n}return rl}function HT(n,e){return typeof e=="function"?e(n):e}function _O(n){var e=Bh(),t=e.queue;if(t===null)throw Error(Zn(311));t.lastRenderedReducer=n;var r=Go,i=r.baseQueue,s=t.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,t.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,a=null,h=s;do{var f=h.lane;if((Yy&f)===f)a!==null&&(a=a.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:n(r,h.action);else{var p={lane:f,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};a===null?(l=a=p,o=r):a=a.next=p,Va.lanes|=f,Ky|=f}h=h.next}while(h!==null&&h!==s);a===null?o=r:a.next=l,Yf(r,e.memoizedState)||(au=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=a,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do s=i.lane,Va.lanes|=s,Ky|=s,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function yO(n){var e=Bh(),t=e.queue;if(t===null)throw Error(Zn(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,s=e.memoizedState;if(i!==null){t.pending=null;var o=i=i.next;do s=n(s,o.action),o=o.next;while(o!==i);Yf(s,e.memoizedState)||(au=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,r]}function gee(){}function vee(n,e){var t=Va,r=Bh(),i=e(),s=!Yf(r.memoizedState,i);if(s&&(r.memoizedState=i,au=!0),r=r.queue,LU(xee.bind(null,t,r,n),[n]),r.getSnapshot!==e||s||rl!==null&&rl.memoizedState.tag&1){if(t.flags|=2048,jT(9,yee.bind(null,t,r,i,e),void 0,null),il===null)throw Error(Zn(349));Yy&30||_ee(t,e,i)}return i}function _ee(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Va.updateQueue,e===null?(e={lastEffect:null,stores:null},Va.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function yee(n,e,t,r){e.value=t,e.getSnapshot=r,bee(e)&&wee(n)}function xee(n,e,t){return t(function(){bee(e)&&wee(n)})}function bee(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Yf(n,t)}catch{return!0}}function wee(n){var e=jm(n,1);e!==null&&Xf(e,n,1,-1)}function i7(n){var e=Kd();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:HT,lastRenderedState:n},e.queue=n,n=n.dispatch=Gme.bind(null,Va,n),[e.memoizedState,n]}function jT(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Va.updateQueue,e===null?(e={lastEffect:null,stores:null},Va.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function See(){return Bh().memoizedState}function KI(n,e,t,r){var i=Kd();Va.flags|=n,i.memoizedState=jT(1|e,t,void 0,r===void 0?null:r)}function qL(n,e,t,r){var i=Bh();r=r===void 0?null:r;var s=void 0;if(Go!==null){var o=Go.memoizedState;if(s=o.destroy,r!==null&&IU(r,o.deps)){i.memoizedState=jT(e,t,s,r);return}}Va.flags|=n,i.memoizedState=jT(1|e,t,s,r)}function s7(n,e){return KI(8390656,8,n,e)}function LU(n,e){return qL(2048,8,n,e)}function Aee(n,e){return qL(4,2,n,e)}function Tee(n,e){return qL(4,4,n,e)}function Mee(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Eee(n,e,t){return t=t!=null?t.concat([n]):null,qL(4,4,Mee.bind(null,e,n),t)}function DU(){}function Cee(n,e){var t=Bh();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&IU(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function Iee(n,e){var t=Bh();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&IU(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function Ree(n,e,t){return Yy&21?(Yf(t,e)||(t=DQ(),Va.lanes|=t,Ky|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,au=!0),n.memoizedState=t)}function zme(n,e){var t=Ns;Ns=t!==0&&4>t?t:4,n(!0);var r=vO.transition;vO.transition={};try{n(!1),e()}finally{Ns=t,vO.transition=r}}function Pee(){return Bh().memoizedState}function Ume(n,e,t){var r=r0(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},Lee(n))Dee(e,t);else if(t=cee(n,e,t,r),t!==null){var i=Cc();Xf(t,n,r,i),Bee(t,e,r)}}function Gme(n,e,t){var r=r0(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(Lee(n))Dee(e,i);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,t);if(i.hasEagerState=!0,i.eagerState=l,Yf(l,o)){var a=e.interleaved;a===null?(i.next=i,AU(e)):(i.next=a.next,a.next=i),e.interleaved=i;return}}catch{}finally{}t=cee(n,e,i,r),t!==null&&(i=Cc(),Xf(t,n,r,i),Bee(t,e,r))}}function Lee(n){var e=n.alternate;return n===Va||e!==null&&e===Va}function Dee(n,e){XA=VR=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Bee(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,uU(n,t)}}var HR={readContext:Dh,useCallback:Bl,useContext:Bl,useEffect:Bl,useImperativeHandle:Bl,useInsertionEffect:Bl,useLayoutEffect:Bl,useMemo:Bl,useReducer:Bl,useRef:Bl,useState:Bl,useDebugValue:Bl,useDeferredValue:Bl,useTransition:Bl,useMutableSource:Bl,useSyncExternalStore:Bl,useId:Bl,unstable_isNewReconciler:!1},Vme={readContext:Dh,useCallback:function(n,e){return Kd().memoizedState=[n,e===void 0?null:e],n},useContext:Dh,useEffect:s7,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,KI(4194308,4,Mee.bind(null,e,n),t)},useLayoutEffect:function(n,e){return KI(4194308,4,n,e)},useInsertionEffect:function(n,e){return KI(4,2,n,e)},useMemo:function(n,e){var t=Kd();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Kd();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=Ume.bind(null,Va,n),[r.memoizedState,n]},useRef:function(n){var e=Kd();return n={current:n},e.memoizedState=n},useState:i7,useDebugValue:DU,useDeferredValue:function(n){return Kd().memoizedState=n},useTransition:function(){var n=i7(!1),e=n[0];return n=zme.bind(null,n[1]),Kd().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Va,i=Kd();if(Ma){if(t===void 0)throw Error(Zn(407));t=t()}else{if(t=e(),il===null)throw Error(Zn(349));Yy&30||_ee(r,e,t)}i.memoizedState=t;var s={value:t,getSnapshot:e};return i.queue=s,s7(xee.bind(null,r,s,n),[n]),r.flags|=2048,jT(9,yee.bind(null,r,s,t,e),void 0,null),t},useId:function(){var n=Kd(),e=il.identifierPrefix;if(Ma){var t=Pm,r=Rm;t=(r&~(1<<32-$f(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=VT++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Nme++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Hme={readContext:Dh,useCallback:Cee,useContext:Dh,useEffect:LU,useImperativeHandle:Eee,useInsertionEffect:Aee,useLayoutEffect:Tee,useMemo:Iee,useReducer:_O,useRef:See,useState:function(){return _O(HT)},useDebugValue:DU,useDeferredValue:function(n){var e=Bh();return Ree(e,Go.memoizedState,n)},useTransition:function(){var n=_O(HT)[0],e=Bh().memoizedState;return[n,e]},useMutableSource:gee,useSyncExternalStore:vee,useId:Pee,unstable_isNewReconciler:!1},jme={readContext:Dh,useCallback:Cee,useContext:Dh,useEffect:LU,useImperativeHandle:Eee,useInsertionEffect:Aee,useLayoutEffect:Tee,useMemo:Iee,useReducer:yO,useRef:See,useState:function(){return yO(HT)},useDebugValue:DU,useDeferredValue:function(n){var e=Bh();return Go===null?e.memoizedState=n:Ree(e,Go.memoizedState,n)},useTransition:function(){var n=yO(HT)[0],e=Bh().memoizedState;return[n,e]},useMutableSource:gee,useSyncExternalStore:vee,useId:Pee,unstable_isNewReconciler:!1};function tw(n,e){try{var t="",r=e;do t+=_pe(r),r=r.return;while(r);var i=t}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:i,digest:null}}function xO(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function d4(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Wme=typeof WeakMap=="function"?WeakMap:Map;function kee(n,e,t){t=Fm(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){WR||(WR=!0,S4=r),d4(n,e)},t}function Oee(n,e,t){t=Fm(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){d4(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){d4(n,e),typeof r!="function"&&(n0===null?n0=new Set([this]):n0.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function a7(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new Wme;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=sge.bind(null,n,e,t),e.then(n,n))}function o7(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function l7(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Fm(-1,1),e.tag=2,t0(t,e,1))),t.lanes|=1),n)}var $me=rg.ReactCurrentOwner,au=!1;function bc(n,e,t,r){e.child=n===null?pee(e,null,t,r):Qb(e,n.child,t,r)}function c7(n,e,t,r,i){t=t.render;var s=e.ref;return kb(e,i),r=RU(n,e,t,r,s,i),t=PU(),n!==null&&!au?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Wm(n,e,i)):(Ma&&t&&_U(e),e.flags|=1,bc(n,e,r,i),e.child)}function u7(n,e,t,r,i){if(n===null){var s=t.type;return typeof s=="function"&&!GU(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,Fee(n,e,s,r,i)):(n=tR(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&i)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:OT,t(o,r)&&n.ref===e.ref)return Wm(n,e,i)}return e.flags|=1,n=i0(s,r),n.ref=e.ref,n.return=e,e.child=n}function Fee(n,e,t,r,i){if(n!==null){var s=n.memoizedProps;if(OT(s,r)&&n.ref===e.ref)if(au=!1,e.pendingProps=r=s,(n.lanes&i)!==0)n.flags&131072&&(au=!0);else return e.lanes=n.lanes,Wm(n,e,i)}return p4(n,e,t,r,i)}function Nee(n,e,t){var r=e.pendingProps,i=r.children,s=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ia(_b,Lu),Lu|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ia(_b,Lu),Lu|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:t,ia(_b,Lu),Lu|=r}else s!==null?(r=s.baseLanes|t,e.memoizedState=null):r=t,ia(_b,Lu),Lu|=r;return bc(n,e,i,t),e.child}function zee(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function p4(n,e,t,r,i){var s=hu(t)?qy:Kl.current;return s=Kb(e,s),kb(e,i),t=RU(n,e,t,r,s,i),r=PU(),n!==null&&!au?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Wm(n,e,i)):(Ma&&r&&_U(e),e.flags|=1,bc(n,e,t,i),e.child)}function h7(n,e,t,r,i){if(hu(t)){var s=!0;kR(e)}else s=!1;if(kb(e,i),e.stateNode===null)JI(n,e),fee(e,t,r),f4(e,t,r,i),r=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var a=o.context,h=t.contextType;typeof h=="object"&&h!==null?h=Dh(h):(h=hu(t)?qy:Kl.current,h=Kb(e,h));var f=t.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||a!==h)&&n7(e,o,r,h),Bv=!1;var v=e.memoizedState;o.state=v,UR(e,r,o,i),a=e.memoizedState,l!==r||v!==a||uu.current||Bv?(typeof f=="function"&&(h4(e,t,f,r),a=e.memoizedState),(l=Bv||t7(e,t,l,r,v,a,h))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=a),o.props=r,o.state=a,o.context=h,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,uee(n,e),l=e.memoizedProps,h=e.type===e.elementType?l:kf(e.type,l),o.props=h,p=e.pendingProps,v=o.context,a=t.contextType,typeof a=="object"&&a!==null?a=Dh(a):(a=hu(t)?qy:Kl.current,a=Kb(e,a));var y=t.getDerivedStateFromProps;(f=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||v!==a)&&n7(e,o,r,a),Bv=!1,v=e.memoizedState,o.state=v,UR(e,r,o,i);var S=e.memoizedState;l!==p||v!==S||uu.current||Bv?(typeof y=="function"&&(h4(e,t,y,r),S=e.memoizedState),(h=Bv||t7(e,t,h,r,v,S,a)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,S,a),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,S,a)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),o.props=r,o.state=S,o.context=a,r=h):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&v===n.memoizedState||(e.flags|=1024),r=!1)}return m4(n,e,t,r,s,i)}function m4(n,e,t,r,i,s){zee(n,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Yj(e,t,!1),Wm(n,e,s);r=e.stateNode,$me.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&o?(e.child=Qb(e,n.child,null,s),e.child=Qb(e,null,l,s)):bc(n,e,l,s),e.memoizedState=r.state,i&&Yj(e,t,!0),e.child}function Uee(n){var e=n.stateNode;e.pendingContext?Zj(n,e.pendingContext,e.pendingContext!==e.context):e.context&&Zj(n,e.context,!1),MU(n,e.containerInfo)}function f7(n,e,t,r,i){return Jb(),xU(i),e.flags|=256,bc(n,e,t,r),e.child}var g4={dehydrated:null,treeContext:null,retryLane:0};function v4(n){return{baseLanes:n,cachePool:null,transitions:null}}function Gee(n,e,t){var r=e.pendingProps,i=Ua.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),ia(Ua,i&1),n===null)return c4(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,n=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=KL(o,r,0,null),n=By(n,r,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=v4(t),e.memoizedState=g4,n):BU(e,o));if(i=n.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return Xme(n,e,o,r,l,i,t);if(s){s=r.fallback,o=e.mode,i=n.child,l=i.sibling;var a={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=a,e.deletions=null):(r=i0(i,a),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=i0(l,s):(s=By(s,o,t,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=n.child.memoizedState,o=o===null?v4(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=g4,r}return s=n.child,n=s.sibling,r=i0(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function BU(n,e){return e=KL({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function LC(n,e,t,r){return r!==null&&xU(r),Qb(e,n.child,null,t),n=BU(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Xme(n,e,t,r,i,s,o){if(t)return e.flags&256?(e.flags&=-257,r=xO(Error(Zn(422))),LC(n,e,o,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=KL({mode:"visible",children:r.children},i,0,null),s=By(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Qb(e,n.child,null,o),e.child.memoizedState=v4(o),e.memoizedState=g4,s);if(!(e.mode&1))return LC(n,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(Zn(419)),r=xO(s,r,void 0),LC(n,e,o,r)}if(l=(o&n.childLanes)!==0,au||l){if(r=il,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,jm(n,i),Xf(r,n,i,-1))}return UU(),r=xO(Error(Zn(421))),LC(n,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=age.bind(null,n),i._reactRetry=e,null):(n=s.treeContext,ku=e0(i.nextSibling),Ou=e,Ma=!0,zf=null,n!==null&&(xh[bh++]=Rm,xh[bh++]=Pm,xh[bh++]=Zy,Rm=n.id,Pm=n.overflow,Zy=e),e=BU(e,r.children),e.flags|=4096,e)}function d7(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),u4(n.return,e,t)}function bO(n,e,t,r,i){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=t,s.tailMode=i)}function Vee(n,e,t){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(bc(n,e,r.children,t),r=Ua.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&d7(n,t,e);else if(n.tag===19)d7(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(ia(Ua,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&GR(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),bO(e,!1,i,t,s);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&GR(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}bO(e,!0,t,null,s);break;case"together":bO(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function JI(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Wm(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ky|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(Zn(153));if(e.child!==null){for(n=e.child,t=i0(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=i0(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function qme(n,e,t){switch(e.tag){case 3:Uee(e),Jb();break;case 5:mee(e);break;case 1:hu(e.type)&&kR(e);break;case 4:MU(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ia(NR,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ia(Ua,Ua.current&1),e.flags|=128,null):t&e.child.childLanes?Gee(n,e,t):(ia(Ua,Ua.current&1),n=Wm(n,e,t),n!==null?n.sibling:null);ia(Ua,Ua.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Vee(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ia(Ua,Ua.current),r)break;return null;case 22:case 23:return e.lanes=0,Nee(n,e,t)}return Wm(n,e,t)}var Hee,_4,jee,Wee;Hee=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};_4=function(){};jee=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,xy(lp.current);var s=null;switch(t){case"input":i=UN(n,i),r=UN(n,r),s=[];break;case"select":i=ja({},i,{value:void 0}),r=ja({},r,{value:void 0}),s=[];break;case"textarea":i=HN(n,i),r=HN(n,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=DR)}WN(t,r);var o;t=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var l=i[h];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(IT.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var a=r[h];if(l=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&a!==l&&(a!=null||l!=null))if(h==="style")if(l){for(o in l)!l.hasOwnProperty(o)||a&&a.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in a)a.hasOwnProperty(o)&&l[o]!==a[o]&&(t||(t={}),t[o]=a[o])}else t||(s||(s=[]),s.push(h,t)),t=a;else h==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,l=l?l.__html:void 0,a!=null&&l!==a&&(s=s||[]).push(h,a)):h==="children"?typeof a!="string"&&typeof a!="number"||(s=s||[]).push(h,""+a):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(IT.hasOwnProperty(h)?(a!=null&&h==="onScroll"&&ma("scroll",n),s||l===a||(s=[])):(s=s||[]).push(h,a))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};Wee=function(n,e,t,r){t!==r&&(e.flags|=4)};function IS(n,e){if(!Ma)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function kl(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Zme(n,e,t){var r=e.pendingProps;switch(yU(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kl(e),null;case 1:return hu(e.type)&&BR(),kl(e),null;case 3:return r=e.stateNode,ew(),va(uu),va(Kl),CU(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(RC(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,zf!==null&&(M4(zf),zf=null))),_4(n,e),kl(e),null;case 5:EU(e);var i=xy(GT.current);if(t=e.type,n!==null&&e.stateNode!=null)jee(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Zn(166));return kl(e),null}if(n=xy(lp.current),RC(e)){r=e.stateNode,t=e.type;var s=e.memoizedProps;switch(r[Jd]=e,r[zT]=s,n=(e.mode&1)!==0,t){case"dialog":ma("cancel",r),ma("close",r);break;case"iframe":case"object":case"embed":ma("load",r);break;case"video":case"audio":for(i=0;i<MA.length;i++)ma(MA[i],r);break;case"source":ma("error",r);break;case"img":case"image":case"link":ma("error",r),ma("load",r);break;case"details":ma("toggle",r);break;case"input":wj(r,s),ma("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ma("invalid",r);break;case"textarea":Aj(r,s),ma("invalid",r)}WN(t,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&IC(r.textContent,l,n),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&IC(r.textContent,l,n),i=["children",""+l]):IT.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ma("scroll",r)}switch(t){case"input":bC(r),Sj(r,s,!0);break;case"textarea":bC(r),Tj(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=DR)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=_Q(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=o.createElement(t,{is:r.is}):(n=o.createElement(t),t==="select"&&(o=n,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):n=o.createElementNS(n,t),n[Jd]=e,n[zT]=r,Hee(n,e,!1,!1),e.stateNode=n;e:{switch(o=$N(t,r),t){case"dialog":ma("cancel",n),ma("close",n),i=r;break;case"iframe":case"object":case"embed":ma("load",n),i=r;break;case"video":case"audio":for(i=0;i<MA.length;i++)ma(MA[i],n);i=r;break;case"source":ma("error",n),i=r;break;case"img":case"image":case"link":ma("error",n),ma("load",n),i=r;break;case"details":ma("toggle",n),i=r;break;case"input":wj(n,r),i=UN(n,r),ma("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=ja({},r,{value:void 0}),ma("invalid",n);break;case"textarea":Aj(n,r),i=HN(n,r),ma("invalid",n);break;default:i=r}WN(t,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var a=l[s];s==="style"?bQ(n,a):s==="dangerouslySetInnerHTML"?(a=a?a.__html:void 0,a!=null&&yQ(n,a)):s==="children"?typeof a=="string"?(t!=="textarea"||a!=="")&&RT(n,a):typeof a=="number"&&RT(n,""+a):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(IT.hasOwnProperty(s)?a!=null&&s==="onScroll"&&ma("scroll",n):a!=null&&iU(n,s,a,o))}switch(t){case"input":bC(n),Sj(n,r,!1);break;case"textarea":bC(n),Tj(n);break;case"option":r.value!=null&&n.setAttribute("value",""+h0(r.value));break;case"select":n.multiple=!!r.multiple,s=r.value,s!=null?Pb(n,!!r.multiple,s,!1):r.defaultValue!=null&&Pb(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=DR)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return kl(e),null;case 6:if(n&&e.stateNode!=null)Wee(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Zn(166));if(t=xy(GT.current),xy(lp.current),RC(e)){if(r=e.stateNode,t=e.memoizedProps,r[Jd]=e,(s=r.nodeValue!==t)&&(n=Ou,n!==null))switch(n.tag){case 3:IC(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&IC(r.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[Jd]=e,e.stateNode=r}return kl(e),null;case 13:if(va(Ua),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ma&&ku!==null&&e.mode&1&&!(e.flags&128))lee(),Jb(),e.flags|=98560,s=!1;else if(s=RC(e),r!==null&&r.dehydrated!==null){if(n===null){if(!s)throw Error(Zn(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Zn(317));s[Jd]=e}else Jb(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;kl(e),s=!1}else zf!==null&&(M4(zf),zf=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Ua.current&1?Ho===0&&(Ho=3):UU())),e.updateQueue!==null&&(e.flags|=4),kl(e),null);case 4:return ew(),_4(n,e),n===null&&FT(e.stateNode.containerInfo),kl(e),null;case 10:return SU(e.type._context),kl(e),null;case 17:return hu(e.type)&&BR(),kl(e),null;case 19:if(va(Ua),s=e.memoizedState,s===null)return kl(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)IS(s,!1);else{if(Ho!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=GR(n),o!==null){for(e.flags|=128,IS(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)s=t,n=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ia(Ua,Ua.current&1|2),e.child}n=n.sibling}s.tail!==null&&po()>nw&&(e.flags|=128,r=!0,IS(s,!1),e.lanes=4194304)}else{if(!r)if(n=GR(o),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),IS(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Ma)return kl(e),null}else 2*po()-s.renderingStartTime>nw&&t!==1073741824&&(e.flags|=128,r=!0,IS(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=po(),e.sibling=null,t=Ua.current,ia(Ua,r?t&1|2:t&1),e):(kl(e),null);case 22:case 23:return zU(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Lu&1073741824&&(kl(e),e.subtreeFlags&6&&(e.flags|=8192)):kl(e),null;case 24:return null;case 25:return null}throw Error(Zn(156,e.tag))}function Yme(n,e){switch(yU(e),e.tag){case 1:return hu(e.type)&&BR(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ew(),va(uu),va(Kl),CU(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return EU(e),null;case 13:if(va(Ua),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Zn(340));Jb()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return va(Ua),null;case 4:return ew(),null;case 10:return SU(e.type._context),null;case 22:case 23:return zU(),null;case 24:return null;default:return null}}var DC=!1,jl=!1,Kme=typeof WeakSet=="function"?WeakSet:Set,Er=null;function vb(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Qa(n,e,r)}else t.current=null}function y4(n,e,t){try{t()}catch(r){Qa(n,e,r)}}var p7=!1;function Jme(n,e){if(n4=RR,n=ZQ(),vU(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,l=-1,a=-1,h=0,f=0,p=n,v=null;t:for(;;){for(var y;p!==t||i!==0&&p.nodeType!==3||(l=o+i),p!==s||r!==0&&p.nodeType!==3||(a=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(y=p.firstChild)!==null;)v=p,p=y;for(;;){if(p===n)break t;if(v===t&&++h===i&&(l=o),v===s&&++f===r&&(a=o),(y=p.nextSibling)!==null)break;p=v,v=p.parentNode}p=y}t=l===-1||a===-1?null:{start:l,end:a}}else t=null}t=t||{start:0,end:0}}else t=null;for(r4={focusedElem:n,selectionRange:t},RR=!1,Er=e;Er!==null;)if(e=Er,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,Er=n;else for(;Er!==null;){e=Er;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var C=S.memoizedProps,M=S.memoizedState,E=e.stateNode,L=E.getSnapshotBeforeUpdate(e.elementType===e.type?C:kf(e.type,C),M);E.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Zn(163))}}catch(H){Qa(e,e.return,H)}if(n=e.sibling,n!==null){n.return=e.return,Er=n;break}Er=e.return}return S=p7,p7=!1,S}function qA(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var s=i.destroy;i.destroy=void 0,s!==void 0&&y4(e,t,s)}i=i.next}while(i!==r)}}function ZL(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function x4(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function $ee(n){var e=n.alternate;e!==null&&(n.alternate=null,$ee(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Jd],delete e[zT],delete e[a4],delete e[Bme],delete e[kme])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Xee(n){return n.tag===5||n.tag===3||n.tag===4}function m7(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Xee(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function b4(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=DR));else if(r!==4&&(n=n.child,n!==null))for(b4(n,e,t),n=n.sibling;n!==null;)b4(n,e,t),n=n.sibling}function w4(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(w4(n,e,t),n=n.sibling;n!==null;)w4(n,e,t),n=n.sibling}var _l=null,Nf=!1;function cv(n,e,t){for(t=t.child;t!==null;)qee(n,e,t),t=t.sibling}function qee(n,e,t){if(op&&typeof op.onCommitFiberUnmount=="function")try{op.onCommitFiberUnmount(GL,t)}catch{}switch(t.tag){case 5:jl||vb(t,e);case 6:var r=_l,i=Nf;_l=null,cv(n,e,t),_l=r,Nf=i,_l!==null&&(Nf?(n=_l,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):_l.removeChild(t.stateNode));break;case 18:_l!==null&&(Nf?(n=_l,t=t.stateNode,n.nodeType===8?pO(n.parentNode,t):n.nodeType===1&&pO(n,t),BT(n)):pO(_l,t.stateNode));break;case 4:r=_l,i=Nf,_l=t.stateNode.containerInfo,Nf=!0,cv(n,e,t),_l=r,Nf=i;break;case 0:case 11:case 14:case 15:if(!jl&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&y4(t,e,o),i=i.next}while(i!==r)}cv(n,e,t);break;case 1:if(!jl&&(vb(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(l){Qa(t,e,l)}cv(n,e,t);break;case 21:cv(n,e,t);break;case 22:t.mode&1?(jl=(r=jl)||t.memoizedState!==null,cv(n,e,t),jl=r):cv(n,e,t);break;default:cv(n,e,t)}}function g7(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Kme),e.forEach(function(r){var i=oge.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Mf(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var s=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:_l=l.stateNode,Nf=!1;break e;case 3:_l=l.stateNode.containerInfo,Nf=!0;break e;case 4:_l=l.stateNode.containerInfo,Nf=!0;break e}l=l.return}if(_l===null)throw Error(Zn(160));qee(s,o,i),_l=null,Nf=!1;var a=i.alternate;a!==null&&(a.return=null),i.return=null}catch(h){Qa(i,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Zee(e,n),e=e.sibling}function Zee(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Mf(e,n),Hd(n),r&4){try{qA(3,n,n.return),ZL(3,n)}catch(C){Qa(n,n.return,C)}try{qA(5,n,n.return)}catch(C){Qa(n,n.return,C)}}break;case 1:Mf(e,n),Hd(n),r&512&&t!==null&&vb(t,t.return);break;case 5:if(Mf(e,n),Hd(n),r&512&&t!==null&&vb(t,t.return),n.flags&32){var i=n.stateNode;try{RT(i,"")}catch(C){Qa(n,n.return,C)}}if(r&4&&(i=n.stateNode,i!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,l=n.type,a=n.updateQueue;if(n.updateQueue=null,a!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&gQ(i,s),$N(l,o);var h=$N(l,s);for(o=0;o<a.length;o+=2){var f=a[o],p=a[o+1];f==="style"?bQ(i,p):f==="dangerouslySetInnerHTML"?yQ(i,p):f==="children"?RT(i,p):iU(i,f,p,h)}switch(l){case"input":GN(i,s);break;case"textarea":vQ(i,s);break;case"select":var v=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?Pb(i,!!s.multiple,y,!1):v!==!!s.multiple&&(s.defaultValue!=null?Pb(i,!!s.multiple,s.defaultValue,!0):Pb(i,!!s.multiple,s.multiple?[]:"",!1))}i[zT]=s}catch(C){Qa(n,n.return,C)}}break;case 6:if(Mf(e,n),Hd(n),r&4){if(n.stateNode===null)throw Error(Zn(162));i=n.stateNode,s=n.memoizedProps;try{i.nodeValue=s}catch(C){Qa(n,n.return,C)}}break;case 3:if(Mf(e,n),Hd(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{BT(e.containerInfo)}catch(C){Qa(n,n.return,C)}break;case 4:Mf(e,n),Hd(n);break;case 13:Mf(e,n),Hd(n),i=n.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(FU=po())),r&4&&g7(n);break;case 22:if(f=t!==null&&t.memoizedState!==null,n.mode&1?(jl=(h=jl)||f,Mf(e,n),jl=h):Mf(e,n),Hd(n),r&8192){if(h=n.memoizedState!==null,(n.stateNode.isHidden=h)&&!f&&n.mode&1)for(Er=n,f=n.child;f!==null;){for(p=Er=f;Er!==null;){switch(v=Er,y=v.child,v.tag){case 0:case 11:case 14:case 15:qA(4,v,v.return);break;case 1:vb(v,v.return);var S=v.stateNode;if(typeof S.componentWillUnmount=="function"){r=v,t=v.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(C){Qa(r,t,C)}}break;case 5:vb(v,v.return);break;case 22:if(v.memoizedState!==null){_7(p);continue}}y!==null?(y.return=v,Er=y):_7(p)}f=f.sibling}e:for(f=null,p=n;;){if(p.tag===5){if(f===null){f=p;try{i=p.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=p.stateNode,a=p.memoizedProps.style,o=a!=null&&a.hasOwnProperty("display")?a.display:null,l.style.display=xQ("display",o))}catch(C){Qa(n,n.return,C)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(C){Qa(n,n.return,C)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===n)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===n)break e;for(;p.sibling===null;){if(p.return===null||p.return===n)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Mf(e,n),Hd(n),r&4&&g7(n);break;case 21:break;default:Mf(e,n),Hd(n)}}function Hd(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Xee(t)){var r=t;break e}t=t.return}throw Error(Zn(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(RT(i,""),r.flags&=-33);var s=m7(n);w4(n,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=m7(n);b4(n,l,o);break;default:throw Error(Zn(161))}}catch(a){Qa(n,n.return,a)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Qme(n,e,t){Er=n,Yee(n)}function Yee(n,e,t){for(var r=(n.mode&1)!==0;Er!==null;){var i=Er,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||DC;if(!o){var l=i.alternate,a=l!==null&&l.memoizedState!==null||jl;l=DC;var h=jl;if(DC=o,(jl=a)&&!h)for(Er=i;Er!==null;)o=Er,a=o.child,o.tag===22&&o.memoizedState!==null?y7(i):a!==null?(a.return=o,Er=a):y7(i);for(;s!==null;)Er=s,Yee(s),s=s.sibling;Er=i,DC=l,jl=h}v7(n)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Er=s):v7(n)}}function v7(n){for(;Er!==null;){var e=Er;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jl||ZL(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jl)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:kf(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&e7(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}e7(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var a=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":a.autoFocus&&t.focus();break;case"img":a.src&&(t.src=a.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var f=h.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&BT(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Zn(163))}jl||e.flags&512&&x4(e)}catch(v){Qa(e,e.return,v)}}if(e===n){Er=null;break}if(t=e.sibling,t!==null){t.return=e.return,Er=t;break}Er=e.return}}function _7(n){for(;Er!==null;){var e=Er;if(e===n){Er=null;break}var t=e.sibling;if(t!==null){t.return=e.return,Er=t;break}Er=e.return}}function y7(n){for(;Er!==null;){var e=Er;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{ZL(4,e)}catch(a){Qa(e,t,a)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(a){Qa(e,i,a)}}var s=e.return;try{x4(e)}catch(a){Qa(e,s,a)}break;case 5:var o=e.return;try{x4(e)}catch(a){Qa(e,o,a)}}}catch(a){Qa(e,e.return,a)}if(e===n){Er=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Er=l;break}Er=e.return}}var ege=Math.ceil,jR=rg.ReactCurrentDispatcher,kU=rg.ReactCurrentOwner,Ch=rg.ReactCurrentBatchConfig,vs=0,il=null,So=null,wl=0,Lu=0,_b=C0(0),Ho=0,WT=null,Ky=0,YL=0,OU=0,ZA=null,nu=null,FU=0,nw=1/0,xm=null,WR=!1,S4=null,n0=null,BC=!1,Vv=null,$R=0,YA=0,A4=null,QI=-1,eR=0;function Cc(){return vs&6?po():QI!==-1?QI:QI=po()}function r0(n){return n.mode&1?vs&2&&wl!==0?wl&-wl:Fme.transition!==null?(eR===0&&(eR=DQ()),eR):(n=Ns,n!==0||(n=window.event,n=n===void 0?16:UQ(n.type)),n):1}function Xf(n,e,t,r){if(50<YA)throw YA=0,A4=null,Error(Zn(185));zM(n,t,r),(!(vs&2)||n!==il)&&(n===il&&(!(vs&2)&&(YL|=t),Ho===4&&Nv(n,wl)),fu(n,r),t===1&&vs===0&&!(e.mode&1)&&(nw=po()+500,$L&&I0()))}function fu(n,e){var t=n.callbackNode;Fpe(n,e);var r=IR(n,n===il?wl:0);if(r===0)t!==null&&Cj(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Cj(t),e===1)n.tag===0?Ome(x7.bind(null,n)):see(x7.bind(null,n)),Lme(function(){!(vs&6)&&I0()}),t=null;else{switch(BQ(r)){case 1:t=cU;break;case 4:t=PQ;break;case 16:t=CR;break;case 536870912:t=LQ;break;default:t=CR}t=ite(t,Kee.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function Kee(n,e){if(QI=-1,eR=0,vs&6)throw Error(Zn(327));var t=n.callbackNode;if(Ob()&&n.callbackNode!==t)return null;var r=IR(n,n===il?wl:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=XR(n,r);else{e=r;var i=vs;vs|=2;var s=Qee();(il!==n||wl!==e)&&(xm=null,nw=po()+500,Dy(n,e));do try{rge();break}catch(l){Jee(n,l)}while(!0);wU(),jR.current=s,vs=i,So!==null?e=0:(il=null,wl=0,e=Ho)}if(e!==0){if(e===2&&(i=KN(n),i!==0&&(r=i,e=T4(n,i))),e===1)throw t=WT,Dy(n,0),Nv(n,r),fu(n,po()),t;if(e===6)Nv(n,r);else{if(i=n.current.alternate,!(r&30)&&!tge(i)&&(e=XR(n,r),e===2&&(s=KN(n),s!==0&&(r=s,e=T4(n,s))),e===1))throw t=WT,Dy(n,0),Nv(n,r),fu(n,po()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(Zn(345));case 2:ly(n,nu,xm);break;case 3:if(Nv(n,r),(r&130023424)===r&&(e=FU+500-po(),10<e)){if(IR(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){Cc(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=s4(ly.bind(null,n,nu,xm),e);break}ly(n,nu,xm);break;case 4:if(Nv(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var o=31-$f(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=po()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ege(r/1960))-r,10<r){n.timeoutHandle=s4(ly.bind(null,n,nu,xm),r);break}ly(n,nu,xm);break;case 5:ly(n,nu,xm);break;default:throw Error(Zn(329))}}}return fu(n,po()),n.callbackNode===t?Kee.bind(null,n):null}function T4(n,e){var t=ZA;return n.current.memoizedState.isDehydrated&&(Dy(n,e).flags|=256),n=XR(n,e),n!==2&&(e=nu,nu=t,e!==null&&M4(e)),n}function M4(n){nu===null?nu=n:nu.push.apply(nu,n)}function tge(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],s=i.getSnapshot;i=i.value;try{if(!Yf(s(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Nv(n,e){for(e&=~OU,e&=~YL,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-$f(e),r=1<<t;n[t]=-1,e&=~r}}function x7(n){if(vs&6)throw Error(Zn(327));Ob();var e=IR(n,0);if(!(e&1))return fu(n,po()),null;var t=XR(n,e);if(n.tag!==0&&t===2){var r=KN(n);r!==0&&(e=r,t=T4(n,r))}if(t===1)throw t=WT,Dy(n,0),Nv(n,e),fu(n,po()),t;if(t===6)throw Error(Zn(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,ly(n,nu,xm),fu(n,po()),null}function NU(n,e){var t=vs;vs|=1;try{return n(e)}finally{vs=t,vs===0&&(nw=po()+500,$L&&I0())}}function Jy(n){Vv!==null&&Vv.tag===0&&!(vs&6)&&Ob();var e=vs;vs|=1;var t=Ch.transition,r=Ns;try{if(Ch.transition=null,Ns=1,n)return n()}finally{Ns=r,Ch.transition=t,vs=e,!(vs&6)&&I0()}}function zU(){Lu=_b.current,va(_b)}function Dy(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Pme(t)),So!==null)for(t=So.return;t!==null;){var r=t;switch(yU(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&BR();break;case 3:ew(),va(uu),va(Kl),CU();break;case 5:EU(r);break;case 4:ew();break;case 13:va(Ua);break;case 19:va(Ua);break;case 10:SU(r.type._context);break;case 22:case 23:zU()}t=t.return}if(il=n,So=n=i0(n.current,null),wl=Lu=e,Ho=0,WT=null,OU=YL=Ky=0,nu=ZA=null,yy!==null){for(e=0;e<yy.length;e++)if(t=yy[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,s=t.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}t.pending=r}yy=null}return n}function Jee(n,e){do{var t=So;try{if(wU(),YI.current=HR,VR){for(var r=Va.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}VR=!1}if(Yy=0,rl=Go=Va=null,XA=!1,VT=0,kU.current=null,t===null||t.return===null){Ho=1,WT=e,So=null;break}e:{var s=n,o=t.return,l=t,a=e;if(e=wl,l.flags|=32768,a!==null&&typeof a=="object"&&typeof a.then=="function"){var h=a,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var v=f.alternate;v?(f.updateQueue=v.updateQueue,f.memoizedState=v.memoizedState,f.lanes=v.lanes):(f.updateQueue=null,f.memoizedState=null)}var y=o7(o);if(y!==null){y.flags&=-257,l7(y,o,l,s,e),y.mode&1&&a7(s,h,e),e=y,a=h;var S=e.updateQueue;if(S===null){var C=new Set;C.add(a),e.updateQueue=C}else S.add(a);break e}else{if(!(e&1)){a7(s,h,e),UU();break e}a=Error(Zn(426))}}else if(Ma&&l.mode&1){var M=o7(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),l7(M,o,l,s,e),xU(tw(a,l));break e}}s=a=tw(a,l),Ho!==4&&(Ho=2),ZA===null?ZA=[s]:ZA.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var E=kee(s,a,e);Qj(s,E);break e;case 1:l=a;var L=s.type,k=s.stateNode;if(!(s.flags&128)&&(typeof L.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(n0===null||!n0.has(k)))){s.flags|=65536,e&=-e,s.lanes|=e;var H=Oee(s,l,e);Qj(s,H);break e}}s=s.return}while(s!==null)}tte(t)}catch(X){e=X,So===t&&t!==null&&(So=t=t.return);continue}break}while(!0)}function Qee(){var n=jR.current;return jR.current=HR,n===null?HR:n}function UU(){(Ho===0||Ho===3||Ho===2)&&(Ho=4),il===null||!(Ky&268435455)&&!(YL&268435455)||Nv(il,wl)}function XR(n,e){var t=vs;vs|=2;var r=Qee();(il!==n||wl!==e)&&(xm=null,Dy(n,e));do try{nge();break}catch(i){Jee(n,i)}while(!0);if(wU(),vs=t,jR.current=r,So!==null)throw Error(Zn(261));return il=null,wl=0,Ho}function nge(){for(;So!==null;)ete(So)}function rge(){for(;So!==null&&!Cpe();)ete(So)}function ete(n){var e=rte(n.alternate,n,Lu);n.memoizedProps=n.pendingProps,e===null?tte(n):So=e,kU.current=null}function tte(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Yme(t,e),t!==null){t.flags&=32767,So=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ho=6,So=null;return}}else if(t=Zme(t,e,Lu),t!==null){So=t;return}if(e=e.sibling,e!==null){So=e;return}So=e=n}while(e!==null);Ho===0&&(Ho=5)}function ly(n,e,t){var r=Ns,i=Ch.transition;try{Ch.transition=null,Ns=1,ige(n,e,t,r)}finally{Ch.transition=i,Ns=r}return null}function ige(n,e,t,r){do Ob();while(Vv!==null);if(vs&6)throw Error(Zn(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Zn(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(Npe(n,s),n===il&&(So=il=null,wl=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||BC||(BC=!0,ite(CR,function(){return Ob(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=Ch.transition,Ch.transition=null;var o=Ns;Ns=1;var l=vs;vs|=4,kU.current=null,Jme(n,t),Zee(t,n),Ame(r4),RR=!!n4,r4=n4=null,n.current=t,Qme(t),Ipe(),vs=l,Ns=o,Ch.transition=s}else n.current=t;if(BC&&(BC=!1,Vv=n,$R=i),s=n.pendingLanes,s===0&&(n0=null),Lpe(t.stateNode),fu(n,po()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(WR)throw WR=!1,n=S4,S4=null,n;return $R&1&&n.tag!==0&&Ob(),s=n.pendingLanes,s&1?n===A4?YA++:(YA=0,A4=n):YA=0,I0(),null}function Ob(){if(Vv!==null){var n=BQ($R),e=Ch.transition,t=Ns;try{if(Ch.transition=null,Ns=16>n?16:n,Vv===null)var r=!1;else{if(n=Vv,Vv=null,$R=0,vs&6)throw Error(Zn(331));var i=vs;for(vs|=4,Er=n.current;Er!==null;){var s=Er,o=s.child;if(Er.flags&16){var l=s.deletions;if(l!==null){for(var a=0;a<l.length;a++){var h=l[a];for(Er=h;Er!==null;){var f=Er;switch(f.tag){case 0:case 11:case 15:qA(8,f,s)}var p=f.child;if(p!==null)p.return=f,Er=p;else for(;Er!==null;){f=Er;var v=f.sibling,y=f.return;if($ee(f),f===h){Er=null;break}if(v!==null){v.return=y,Er=v;break}Er=y}}}var S=s.alternate;if(S!==null){var C=S.child;if(C!==null){S.child=null;do{var M=C.sibling;C.sibling=null,C=M}while(C!==null)}}Er=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Er=o;else e:for(;Er!==null;){if(s=Er,s.flags&2048)switch(s.tag){case 0:case 11:case 15:qA(9,s,s.return)}var E=s.sibling;if(E!==null){E.return=s.return,Er=E;break e}Er=s.return}}var L=n.current;for(Er=L;Er!==null;){o=Er;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,Er=k;else e:for(o=L;Er!==null;){if(l=Er,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ZL(9,l)}}catch(X){Qa(l,l.return,X)}if(l===o){Er=null;break e}var H=l.sibling;if(H!==null){H.return=l.return,Er=H;break e}Er=l.return}}if(vs=i,I0(),op&&typeof op.onPostCommitFiberRoot=="function")try{op.onPostCommitFiberRoot(GL,n)}catch{}r=!0}return r}finally{Ns=t,Ch.transition=e}}return!1}function b7(n,e,t){e=tw(t,e),e=kee(n,e,1),n=t0(n,e,1),e=Cc(),n!==null&&(zM(n,1,e),fu(n,e))}function Qa(n,e,t){if(n.tag===3)b7(n,n,t);else for(;e!==null;){if(e.tag===3){b7(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(n0===null||!n0.has(r))){n=tw(t,n),n=Oee(e,n,1),e=t0(e,n,1),n=Cc(),e!==null&&(zM(e,1,n),fu(e,n));break}}e=e.return}}function sge(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Cc(),n.pingedLanes|=n.suspendedLanes&t,il===n&&(wl&t)===t&&(Ho===4||Ho===3&&(wl&130023424)===wl&&500>po()-FU?Dy(n,0):OU|=t),fu(n,e)}function nte(n,e){e===0&&(n.mode&1?(e=AC,AC<<=1,!(AC&130023424)&&(AC=4194304)):e=1);var t=Cc();n=jm(n,e),n!==null&&(zM(n,e,t),fu(n,t))}function age(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),nte(n,t)}function oge(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(Zn(314))}r!==null&&r.delete(e),nte(n,t)}var rte;rte=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||uu.current)au=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return au=!1,qme(n,e,t);au=!!(n.flags&131072)}else au=!1,Ma&&e.flags&1048576&&aee(e,FR,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;JI(n,e),n=e.pendingProps;var i=Kb(e,Kl.current);kb(e,t),i=RU(null,e,r,n,i,t);var s=PU();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,hu(r)?(s=!0,kR(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,TU(e),i.updater=XL,e.stateNode=i,i._reactInternals=e,f4(e,r,n,t),e=m4(null,e,r,!0,s,t)):(e.tag=0,Ma&&s&&_U(e),bc(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(JI(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=cge(r),n=kf(r,n),i){case 0:e=p4(null,e,r,n,t);break e;case 1:e=h7(null,e,r,n,t);break e;case 11:e=c7(null,e,r,n,t);break e;case 14:e=u7(null,e,r,kf(r.type,n),t);break e}throw Error(Zn(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:kf(r,i),p4(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:kf(r,i),h7(n,e,r,i,t);case 3:e:{if(Uee(e),n===null)throw Error(Zn(387));r=e.pendingProps,s=e.memoizedState,i=s.element,uee(n,e),UR(e,r,null,t);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=tw(Error(Zn(423)),e),e=f7(n,e,r,t,i);break e}else if(r!==i){i=tw(Error(Zn(424)),e),e=f7(n,e,r,t,i);break e}else for(ku=e0(e.stateNode.containerInfo.firstChild),Ou=e,Ma=!0,zf=null,t=pee(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Jb(),r===i){e=Wm(n,e,t);break e}bc(n,e,r,t)}e=e.child}return e;case 5:return mee(e),n===null&&c4(e),r=e.type,i=e.pendingProps,s=n!==null?n.memoizedProps:null,o=i.children,i4(r,i)?o=null:s!==null&&i4(r,s)&&(e.flags|=32),zee(n,e),bc(n,e,o,t),e.child;case 6:return n===null&&c4(e),null;case 13:return Gee(n,e,t);case 4:return MU(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Qb(e,null,r,t):bc(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:kf(r,i),c7(n,e,r,i,t);case 7:return bc(n,e,e.pendingProps,t),e.child;case 8:return bc(n,e,e.pendingProps.children,t),e.child;case 12:return bc(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ia(NR,r._currentValue),r._currentValue=o,s!==null)if(Yf(s.value,o)){if(s.children===i.children&&!uu.current){e=Wm(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var a=l.firstContext;a!==null;){if(a.context===r){if(s.tag===1){a=Fm(-1,t&-t),a.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var f=h.pending;f===null?a.next=a:(a.next=f.next,f.next=a),h.pending=a}}s.lanes|=t,a=s.alternate,a!==null&&(a.lanes|=t),u4(s.return,t,e),l.lanes|=t;break}a=a.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Zn(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),u4(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}bc(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,kb(e,t),i=Dh(i),r=r(i),e.flags|=1,bc(n,e,r,t),e.child;case 14:return r=e.type,i=kf(r,e.pendingProps),i=kf(r.type,i),u7(n,e,r,i,t);case 15:return Fee(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:kf(r,i),JI(n,e),e.tag=1,hu(r)?(n=!0,kR(e)):n=!1,kb(e,t),fee(e,r,i),f4(e,r,i,t),m4(null,e,r,!0,n,t);case 19:return Vee(n,e,t);case 22:return Nee(n,e,t)}throw Error(Zn(156,e.tag))};function ite(n,e){return RQ(n,e)}function lge(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mh(n,e,t,r){return new lge(n,e,t,r)}function GU(n){return n=n.prototype,!(!n||!n.isReactComponent)}function cge(n){if(typeof n=="function")return GU(n)?1:0;if(n!=null){if(n=n.$$typeof,n===aU)return 11;if(n===oU)return 14}return 2}function i0(n,e){var t=n.alternate;return t===null?(t=Mh(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function tR(n,e,t,r,i,s){var o=2;if(r=n,typeof n=="function")GU(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case lb:return By(t.children,i,s,e);case sU:o=8,i|=8;break;case ON:return n=Mh(12,t,e,i|2),n.elementType=ON,n.lanes=s,n;case FN:return n=Mh(13,t,e,i),n.elementType=FN,n.lanes=s,n;case NN:return n=Mh(19,t,e,i),n.elementType=NN,n.lanes=s,n;case dQ:return KL(t,i,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case hQ:o=10;break e;case fQ:o=9;break e;case aU:o=11;break e;case oU:o=14;break e;case Dv:o=16,r=null;break e}throw Error(Zn(130,n==null?n:typeof n,""))}return e=Mh(o,t,e,i),e.elementType=n,e.type=r,e.lanes=s,e}function By(n,e,t,r){return n=Mh(7,n,r,e),n.lanes=t,n}function KL(n,e,t,r){return n=Mh(22,n,r,e),n.elementType=dQ,n.lanes=t,n.stateNode={isHidden:!1},n}function wO(n,e,t){return n=Mh(6,n,null,e),n.lanes=t,n}function SO(n,e,t){return e=Mh(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function uge(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rO(0),this.expirationTimes=rO(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rO(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function VU(n,e,t,r,i,s,o,l,a){return n=new uge(n,e,t,l,a),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Mh(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},TU(s),n}function hge(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ob,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function ste(n){if(!n)return f0;n=n._reactInternals;e:{if(_x(n)!==n||n.tag!==1)throw Error(Zn(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(hu(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Zn(171))}if(n.tag===1){var t=n.type;if(hu(t))return iee(n,t,e)}return e}function ate(n,e,t,r,i,s,o,l,a){return n=VU(t,r,!0,n,i,s,o,l,a),n.context=ste(null),t=n.current,r=Cc(),i=r0(t),s=Fm(r,i),s.callback=e??null,t0(t,s,i),n.current.lanes=i,zM(n,i,r),fu(n,r),n}function JL(n,e,t,r){var i=e.current,s=Cc(),o=r0(i);return t=ste(t),e.context===null?e.context=t:e.pendingContext=t,e=Fm(s,o),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=t0(i,e,o),n!==null&&(Xf(n,i,o,s),ZI(n,i,o)),o}function qR(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function w7(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function HU(n,e){w7(n,e),(n=n.alternate)&&w7(n,e)}function fge(){return null}var ote=typeof reportError=="function"?reportError:function(n){console.error(n)};function jU(n){this._internalRoot=n}QL.prototype.render=jU.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Zn(409));JL(n,e,null,null)};QL.prototype.unmount=jU.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Jy(function(){JL(null,n,null,null)}),e[Hm]=null}};function QL(n){this._internalRoot=n}QL.prototype.unstable_scheduleHydration=function(n){if(n){var e=FQ();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Fv.length&&e!==0&&e<Fv[t].priority;t++);Fv.splice(t,0,n),t===0&&zQ(n)}};function WU(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function eD(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function S7(){}function dge(n,e,t,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=qR(o);s.call(h)}}var o=ate(e,r,n,0,null,!1,!1,"",S7);return n._reactRootContainer=o,n[Hm]=o.current,FT(n.nodeType===8?n.parentNode:n),Jy(),o}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var h=qR(a);l.call(h)}}var a=VU(n,0,!1,null,null,!1,!1,"",S7);return n._reactRootContainer=a,n[Hm]=a.current,FT(n.nodeType===8?n.parentNode:n),Jy(function(){JL(e,a,t,r)}),a}function tD(n,e,t,r,i){var s=t._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var a=qR(o);l.call(a)}}JL(e,o,n,i)}else o=dge(t,e,n,i,r);return qR(o)}kQ=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=TA(e.pendingLanes);t!==0&&(uU(e,t|1),fu(e,po()),!(vs&6)&&(nw=po()+500,I0()))}break;case 13:Jy(function(){var r=jm(n,1);if(r!==null){var i=Cc();Xf(r,n,1,i)}}),HU(n,1)}};hU=function(n){if(n.tag===13){var e=jm(n,134217728);if(e!==null){var t=Cc();Xf(e,n,134217728,t)}HU(n,134217728)}};OQ=function(n){if(n.tag===13){var e=r0(n),t=jm(n,e);if(t!==null){var r=Cc();Xf(t,n,e,r)}HU(n,e)}};FQ=function(){return Ns};NQ=function(n,e){var t=Ns;try{return Ns=n,e()}finally{Ns=t}};qN=function(n,e,t){switch(e){case"input":if(GN(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=WL(r);if(!i)throw Error(Zn(90));mQ(r),GN(r,i)}}}break;case"textarea":vQ(n,t);break;case"select":e=t.value,e!=null&&Pb(n,!!t.multiple,e,!1)}};AQ=NU;TQ=Jy;var pge={usingClientEntryPoint:!1,Events:[GM,fb,WL,wQ,SQ,NU]},RS={findFiberByHostInstance:_y,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},mge={bundleType:RS.bundleType,version:RS.version,rendererPackageName:RS.rendererPackageName,rendererConfig:RS.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:rg.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=CQ(n),n===null?null:n.stateNode},findFiberByHostInstance:RS.findFiberByHostInstance||fge,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kC.isDisabled&&kC.supportsFiber)try{GL=kC.inject(mge),op=kC}catch{}}Vu.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pge;Vu.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!WU(e))throw Error(Zn(200));return hge(n,e,null,t)};Vu.createRoot=function(n,e){if(!WU(n))throw Error(Zn(299));var t=!1,r="",i=ote;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=VU(n,1,!1,null,null,t,!1,r,i),n[Hm]=e.current,FT(n.nodeType===8?n.parentNode:n),new jU(e)};Vu.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Zn(188)):(n=Object.keys(n).join(","),Error(Zn(268,n)));return n=CQ(e),n=n===null?null:n.stateNode,n};Vu.flushSync=function(n){return Jy(n)};Vu.hydrate=function(n,e,t){if(!eD(e))throw Error(Zn(200));return tD(null,n,e,!0,t)};Vu.hydrateRoot=function(n,e,t){if(!WU(n))throw Error(Zn(405));var r=t!=null&&t.hydratedSources||null,i=!1,s="",o=ote;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=ate(e,null,n,1,t??null,i,!1,s,o),n[Hm]=e.current,FT(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new QL(e)};Vu.render=function(n,e,t){if(!eD(e))throw Error(Zn(200));return tD(null,n,e,!1,t)};Vu.unmountComponentAtNode=function(n){if(!eD(n))throw Error(Zn(40));return n._reactRootContainer?(Jy(function(){tD(null,null,n,!1,function(){n._reactRootContainer=null,n[Hm]=null})}),!0):!1};Vu.unstable_batchedUpdates=NU;Vu.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!eD(t))throw Error(Zn(200));if(n==null||n._reactInternals===void 0)throw Error(Zn(38));return tD(n,e,t,!1,r)};Vu.version="18.2.0-next-9e3b772b8-20220608";function lte(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(lte)}catch(n){console.error(n)}}lte(),aQ.exports=Vu;var qf=aQ.exports,cte,A7=qf;cte=BN.createRoot=A7.createRoot,BN.hydrateRoot=A7.hydrateRoot;/**
 * @remix-run/router v1.14.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $T(){return $T=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},$T.apply(this,arguments)}var Hv;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Hv||(Hv={}));const T7="popstate";function gge(n){n===void 0&&(n={});function e(r,i){let{pathname:s,search:o,hash:l}=r.location;return E4("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){return typeof i=="string"?i:ZR(i)}return _ge(e,t,null,n)}function ro(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function $U(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function vge(){return Math.random().toString(36).substr(2,8)}function M7(n,e){return{usr:n.state,key:n.key,idx:e}}function E4(n,e,t,r){return t===void 0&&(t=null),$T({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?ww(e):e,{state:t,key:e&&e.key||r||vge()})}function ZR(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function ww(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function _ge(n,e,t,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,l=Hv.Pop,a=null,h=f();h==null&&(h=0,o.replaceState($T({},o.state,{idx:h}),""));function f(){return(o.state||{idx:null}).idx}function p(){l=Hv.Pop;let M=f(),E=M==null?null:M-h;h=M,a&&a({action:l,location:C.location,delta:E})}function v(M,E){l=Hv.Push;let L=E4(C.location,M,E);h=f()+1;let k=M7(L,h),H=C.createHref(L);try{o.pushState(k,"",H)}catch(X){if(X instanceof DOMException&&X.name==="DataCloneError")throw X;i.location.assign(H)}s&&a&&a({action:l,location:C.location,delta:1})}function y(M,E){l=Hv.Replace;let L=E4(C.location,M,E);h=f();let k=M7(L,h),H=C.createHref(L);o.replaceState(k,"",H),s&&a&&a({action:l,location:C.location,delta:0})}function S(M){let E=i.location.origin!=="null"?i.location.origin:i.location.href,L=typeof M=="string"?M:ZR(M);return ro(E,"No window.location.(origin|href) available to create URL for href: "+L),new URL(L,E)}let C={get action(){return l},get location(){return n(i,o)},listen(M){if(a)throw new Error("A history only accepts one active listener");return i.addEventListener(T7,p),a=M,()=>{i.removeEventListener(T7,p),a=null}},createHref(M){return e(i,M)},createURL:S,encodeLocation(M){let E=S(M);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:v,replace:y,go(M){return o.go(M)}};return C}var E7;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(E7||(E7={}));function yge(n,e,t){t===void 0&&(t="/");let r=typeof e=="string"?ww(e):e,i=XT(r.pathname||"/",t);if(i==null)return null;let s=ute(n);xge(s);let o=null;for(let l=0;o==null&&l<s.length;++l)o=Ige(s[l],Pge(i));return o}function ute(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let i=(s,o,l)=>{let a={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};a.relativePath.startsWith("/")&&(ro(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(r.length));let h=s0([r,a.relativePath]),f=t.concat(a);s.children&&s.children.length>0&&(ro(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),ute(s.children,e,f,h)),!(s.path==null&&!s.index)&&e.push({path:h,score:Ege(h,s.index),routesMeta:f})};return n.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let a of hte(s.path))i(s,o,a)}),e}function hte(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,i=t.endsWith("?"),s=t.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=hte(r.join("/")),l=[];return l.push(...o.map(a=>a===""?s:[s,a].join("/"))),i&&l.push(...o),l.map(a=>n.startsWith("/")&&a===""?"/":a)}function xge(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Cge(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const bge=/^:\w+$/,wge=3,Sge=2,Age=1,Tge=10,Mge=-2,C7=n=>n==="*";function Ege(n,e){let t=n.split("/"),r=t.length;return t.some(C7)&&(r+=Mge),e&&(r+=Sge),t.filter(i=>!C7(i)).reduce((i,s)=>i+(bge.test(s)?wge:s===""?Age:Tge),r)}function Cge(n,e){return n.length===e.length&&n.slice(0,-1).every((r,i)=>r===e[i])?n[n.length-1]-e[e.length-1]:0}function Ige(n,e){let{routesMeta:t}=n,r={},i="/",s=[];for(let o=0;o<t.length;++o){let l=t[o],a=o===t.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=C4({path:l.relativePath,caseSensitive:l.caseSensitive,end:a},h);if(!f)return null;Object.assign(r,f.params);let p=l.route;s.push({params:r,pathname:s0([i,f.pathname]),pathnameBase:Oge(s0([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=s0([i,f.pathnameBase]))}return s}function C4(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Rge(n.path,n.caseSensitive,n.end),i=e.match(t);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:r.reduce((h,f,p)=>{let{paramName:v,isOptional:y}=f;if(v==="*"){let C=l[p]||"";o=s.slice(0,s.length-C.length).replace(/(.)\/+$/,"$1")}const S=l[p];return y&&!S?h[v]=void 0:h[v]=Lge(S||"",v),h},{}),pathname:s,pathnameBase:o,pattern:n}}function Rge(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),$U(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],i="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(o,l,a)=>(r.push({paramName:l,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),i+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?i+="\\/*$":n!==""&&n!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function Pge(n){try{return decodeURI(n)}catch(e){return $U(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Lge(n,e){try{return decodeURIComponent(n)}catch(t){return $U(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+t+").")),n}}function XT(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function Dge(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:i=""}=typeof n=="string"?ww(n):n;return{pathname:t?t.startsWith("/")?t:Bge(t,e):e,search:Fge(r),hash:Nge(i)}}function Bge(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(i=>{i===".."?t.length>1&&t.pop():i!=="."&&t.push(i)}),t.length>1?t.join("/"):"/"}function AO(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function kge(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function fte(n,e){let t=kge(n);return e?t.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function dte(n,e,t,r){r===void 0&&(r=!1);let i;typeof n=="string"?i=ww(n):(i=$T({},n),ro(!i.pathname||!i.pathname.includes("?"),AO("?","pathname","search",i)),ro(!i.pathname||!i.pathname.includes("#"),AO("#","pathname","hash",i)),ro(!i.search||!i.search.includes("#"),AO("#","search","hash",i)));let s=n===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),p-=1;i.pathname=v.join("/")}l=p>=0?e[p]:"/"}let a=Dge(i,l),h=o&&o!=="/"&&o.endsWith("/"),f=(s||o===".")&&t.endsWith("/");return!a.pathname.endsWith("/")&&(h||f)&&(a.pathname+="/"),a}const s0=n=>n.join("/").replace(/\/\/+/g,"/"),Oge=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Fge=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Nge=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function zge(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const pte=["post","put","patch","delete"];new Set(pte);const Uge=["get",...pte];new Set(Uge);/**
 * React Router v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qT(){return qT=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},qT.apply(this,arguments)}const nD=Ae.createContext(null),mte=Ae.createContext(null),R0=Ae.createContext(null),rD=Ae.createContext(null),yx=Ae.createContext({outlet:null,matches:[],isDataRoute:!1}),gte=Ae.createContext(null);function Gge(n,e){let{relative:t}=e===void 0?{}:e;HM()||ro(!1);let{basename:r,navigator:i}=Ae.useContext(R0),{hash:s,pathname:o,search:l}=iD(n,{relative:t}),a=o;return r!=="/"&&(a=o==="/"?r:s0([r,o])),i.createHref({pathname:a,search:l,hash:s})}function HM(){return Ae.useContext(rD)!=null}function jM(){return HM()||ro(!1),Ae.useContext(rD).location}function vte(n){Ae.useContext(R0).static||Ae.useLayoutEffect(n)}function Vge(){let{isDataRoute:n}=Ae.useContext(yx);return n?tve():Hge()}function Hge(){HM()||ro(!1);let n=Ae.useContext(nD),{basename:e,future:t,navigator:r}=Ae.useContext(R0),{matches:i}=Ae.useContext(yx),{pathname:s}=jM(),o=JSON.stringify(fte(i,t.v7_relativeSplatPath)),l=Ae.useRef(!1);return vte(()=>{l.current=!0}),Ae.useCallback(function(h,f){if(f===void 0&&(f={}),!l.current)return;if(typeof h=="number"){r.go(h);return}let p=dte(h,JSON.parse(o),s,f.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:s0([e,p.pathname])),(f.replace?r.replace:r.push)(p,f.state,f)},[e,r,o,s,n])}function iD(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=Ae.useContext(R0),{matches:i}=Ae.useContext(yx),{pathname:s}=jM(),o=JSON.stringify(fte(i,r.v7_relativeSplatPath));return Ae.useMemo(()=>dte(n,JSON.parse(o),s,t==="path"),[n,o,s,t])}function jge(n,e){return Wge(n,e)}function Wge(n,e,t,r){HM()||ro(!1);let{navigator:i}=Ae.useContext(R0),{matches:s}=Ae.useContext(yx),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let a=o?o.pathnameBase:"/";o&&o.route;let h=jM(),f;if(e){var p;let M=typeof e=="string"?ww(e):e;a==="/"||(p=M.pathname)!=null&&p.startsWith(a)||ro(!1),f=M}else f=h;let v=f.pathname||"/",y=a==="/"?v:v.slice(a.length)||"/",S=yge(n,{pathname:y}),C=Yge(S&&S.map(M=>Object.assign({},M,{params:Object.assign({},l,M.params),pathname:s0([a,i.encodeLocation?i.encodeLocation(M.pathname).pathname:M.pathname]),pathnameBase:M.pathnameBase==="/"?a:s0([a,i.encodeLocation?i.encodeLocation(M.pathnameBase).pathname:M.pathnameBase])})),s,t,r);return e&&C?Ae.createElement(rD.Provider,{value:{location:qT({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Hv.Pop}},C):C}function $ge(){let n=eve(),e=zge(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Ae.createElement(Ae.Fragment,null,Ae.createElement("h2",null,"Unexpected Application Error!"),Ae.createElement("h3",{style:{fontStyle:"italic"}},e),t?Ae.createElement("pre",{style:i},t):null,null)}const Xge=Ae.createElement($ge,null);class qge extends Ae.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?Ae.createElement(yx.Provider,{value:this.props.routeContext},Ae.createElement(gte.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Zge(n){let{routeContext:e,match:t,children:r}=n,i=Ae.useContext(nD);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),Ae.createElement(yx.Provider,{value:e},r)}function Yge(n,e,t,r){var i;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var s;if((s=t)!=null&&s.errors)n=t.matches;else return null}let o=n,l=(i=t)==null?void 0:i.errors;if(l!=null){let f=o.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id]));f>=0||ro(!1),o=o.slice(0,Math.min(o.length,f+1))}let a=!1,h=-1;if(t&&r&&r.v7_partialHydration)for(let f=0;f<o.length;f++){let p=o[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:v,errors:y}=t,S=p.route.loader&&v[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||S){a=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((f,p,v)=>{let y,S=!1,C=null,M=null;t&&(y=l&&p.route.id?l[p.route.id]:void 0,C=p.route.errorElement||Xge,a&&(h<0&&v===0?(S=!0,M=null):h===v&&(S=!0,M=p.route.hydrateFallbackElement||null)));let E=e.concat(o.slice(0,v+1)),L=()=>{let k;return y?k=C:S?k=M:p.route.Component?k=Ae.createElement(p.route.Component,null):p.route.element?k=p.route.element:k=f,Ae.createElement(Zge,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:t!=null},children:k})};return t&&(p.route.ErrorBoundary||p.route.errorElement||v===0)?Ae.createElement(qge,{location:t.location,revalidation:t.revalidation,component:C,error:y,children:L(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):L()},null)}var _te=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(_te||{}),YR=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(YR||{});function Kge(n){let e=Ae.useContext(nD);return e||ro(!1),e}function Jge(n){let e=Ae.useContext(mte);return e||ro(!1),e}function Qge(n){let e=Ae.useContext(yx);return e||ro(!1),e}function yte(n){let e=Qge(),t=e.matches[e.matches.length-1];return t.route.id||ro(!1),t.route.id}function eve(){var n;let e=Ae.useContext(gte),t=Jge(YR.UseRouteError),r=yte(YR.UseRouteError);return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function tve(){let{router:n}=Kge(_te.UseNavigateStable),e=yte(YR.UseNavigateStable),t=Ae.useRef(!1);return vte(()=>{t.current=!0}),Ae.useCallback(function(i,s){s===void 0&&(s={}),t.current&&(typeof i=="number"?n.navigate(i):n.navigate(i,qT({fromRouteId:e},s)))},[n,e])}function Yd(n){ro(!1)}function nve(n){let{basename:e="/",children:t=null,location:r,navigationType:i=Hv.Pop,navigator:s,static:o=!1,future:l}=n;HM()&&ro(!1);let a=e.replace(/^\/*/,"/"),h=Ae.useMemo(()=>({basename:a,navigator:s,static:o,future:qT({v7_relativeSplatPath:!1},l)}),[a,l,s,o]);typeof r=="string"&&(r=ww(r));let{pathname:f="/",search:p="",hash:v="",state:y=null,key:S="default"}=r,C=Ae.useMemo(()=>{let M=XT(f,a);return M==null?null:{location:{pathname:M,search:p,hash:v,state:y,key:S},navigationType:i}},[a,f,p,v,y,S,i]);return C==null?null:Ae.createElement(R0.Provider,{value:h},Ae.createElement(rD.Provider,{children:t,value:C}))}function rve(n){let{children:e,location:t}=n;return jge(I4(e),t)}new Promise(()=>{});function I4(n,e){e===void 0&&(e=[]);let t=[];return Ae.Children.forEach(n,(r,i)=>{if(!Ae.isValidElement(r))return;let s=[...e,i];if(r.type===Ae.Fragment){t.push.apply(t,I4(r.props.children,s));return}r.type!==Yd&&ro(!1),!r.props.index||!r.props.children||ro(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=I4(r.props.children,s)),t.push(o)}),t}/**
 * React Router DOM v6.21.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function KR(){return KR=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},KR.apply(this,arguments)}function xte(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}function ive(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function sve(n,e){return n.button===0&&(!e||e==="_self")&&!ive(n)}const ave=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],ove=["aria-current","caseSensitive","className","end","style","to","unstable_viewTransition","children"],lve=Ae.createContext({isTransitioning:!1}),cve="startTransition",I7=AR[cve];function uve(n){let{basename:e,children:t,future:r,window:i}=n,s=Ae.useRef();s.current==null&&(s.current=gge({window:i,v5Compat:!0}));let o=s.current,[l,a]=Ae.useState({action:o.action,location:o.location}),{v7_startTransition:h}=r||{},f=Ae.useCallback(p=>{h&&I7?I7(()=>a(p)):a(p)},[a,h]);return Ae.useLayoutEffect(()=>o.listen(f),[o,f]),Ae.createElement(nve,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:r})}const hve=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fve=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,jv=Ae.forwardRef(function(e,t){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:l,target:a,to:h,preventScrollReset:f,unstable_viewTransition:p}=e,v=xte(e,ave),{basename:y}=Ae.useContext(R0),S,C=!1;if(typeof h=="string"&&fve.test(h)&&(S=h,hve))try{let k=new URL(window.location.href),H=h.startsWith("//")?new URL(k.protocol+h):new URL(h),X=XT(H.pathname,y);H.origin===k.origin&&X!=null?h=X+H.search+H.hash:C=!0}catch{}let M=Gge(h,{relative:i}),E=pve(h,{replace:o,state:l,target:a,preventScrollReset:f,relative:i,unstable_viewTransition:p});function L(k){r&&r(k),k.defaultPrevented||E(k)}return Ae.createElement("a",KR({},v,{href:S||M,onClick:C||s?r:L,ref:t,target:a}))}),OC=Ae.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:l,to:a,unstable_viewTransition:h,children:f}=e,p=xte(e,ove),v=iD(a,{relative:p.relative}),y=jM(),S=Ae.useContext(mte),{navigator:C}=Ae.useContext(R0),M=S!=null&&mve(v)&&h===!0,E=C.encodeLocation?C.encodeLocation(v).pathname:v.pathname,L=y.pathname,k=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;i||(L=L.toLowerCase(),k=k?k.toLowerCase():null,E=E.toLowerCase());const H=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let X=L===E||!o&&L.startsWith(E)&&L.charAt(H)==="/",Z=k!=null&&(k===E||!o&&k.startsWith(E)&&k.charAt(E.length)==="/"),Q={isActive:X,isPending:Z,isTransitioning:M},re=X?r:void 0,ie;typeof s=="function"?ie=s(Q):ie=[s,X?"active":null,Z?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let oe=typeof l=="function"?l(Q):l;return Ae.createElement(jv,KR({},p,{"aria-current":re,className:ie,ref:t,style:oe,to:a,unstable_viewTransition:h}),typeof f=="function"?f(Q):f)});var R4;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(R4||(R4={}));var R7;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(R7||(R7={}));function dve(n){let e=Ae.useContext(nD);return e||ro(!1),e}function pve(n,e){let{target:t,replace:r,state:i,preventScrollReset:s,relative:o,unstable_viewTransition:l}=e===void 0?{}:e,a=Vge(),h=jM(),f=iD(n,{relative:o});return Ae.useCallback(p=>{if(sve(p,t)){p.preventDefault();let v=r!==void 0?r:ZR(h)===ZR(f);a(n,{replace:v,state:i,preventScrollReset:s,relative:o,unstable_viewTransition:l})}},[h,a,f,r,i,t,n,s,o,l])}function mve(n,e){e===void 0&&(e={});let t=Ae.useContext(lve);t==null&&ro(!1);let{basename:r}=dve(R4.useViewTransitionState),i=iD(n,{relative:e.relative});if(!t.isTransitioning)return!1;let s=XT(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=XT(t.nextLocation.pathname,r)||t.nextLocation.pathname;return C4(i.pathname,o)!=null||C4(i.pathname,s)!=null}function ZT(){return ZT=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ZT.apply(null,arguments)}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const WM="166",cy={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},uy={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},bte=0,P4=1,wte=2,gve=3,Ste=0,sD=1,KA=2,Of=3,kh=0,Ic=1,Ac=2,cp=0,ky=1,rw=2,L4=3,D4=4,Ate=5,zv=100,Tte=101,Mte=102,Ete=103,Cte=104,Ite=200,Rte=201,Pte=202,Lte=203,JR=204,QR=205,Dte=206,Bte=207,kte=208,Ote=209,Fte=210,Nte=211,zte=212,Ute=213,Gte=214,Vte=0,Hte=1,jte=2,YT=3,Wte=4,$te=5,Xte=6,qte=7,$M=0,Zte=1,Yte=2,up=0,Kte=1,Jte=2,aD=3,oD=4,Qte=5,ene=6,tne=7,B4="attached",nne="detached",lD=300,$m=301,d0=302,KT=303,JT=304,Sw=306,Oh=1e3,ou=1001,Qy=1002,Ao=1003,XM=1004,vve=1004,Wv=1005,_ve=1005,Ca=1006,Oy=1007,yve=1007,lu=1008,xve=1008,Kf=1009,XU=1010,qU=1011,iw=1012,cD=1013,Xm=1014,Mc=1015,Ih=1016,uD=1017,hD=1018,ex=1020,ZU=35902,YU=1021,KU=1022,Xl=1023,JU=1024,QU=1025,Fy=1026,tx=1027,qM=1028,ZM=1029,e6=1030,fD=1031,bve=1032,dD=1033,JA=33776,QA=33777,eT=33778,tT=33779,eP=35840,tP=35841,nP=35842,rP=35843,iP=36196,sP=37492,aP=37496,oP=37808,lP=37809,cP=37810,uP=37811,hP=37812,fP=37813,dP=37814,pP=37815,mP=37816,gP=37817,vP=37818,_P=37819,yP=37820,xP=37821,nT=36492,bP=36494,wP=36495,t6=36283,SP=36284,AP=36285,TP=36286,rne=2200,ine=2201,sne=2202,nx=2300,p0=2301,nR=2302,by=2400,wy=2401,QT=2402,pD=2500,n6=2501,r6=0,YM=1,rx=2,ane=3200,one=3201,P0=0,lne=1,Em="",Ta="srgb",jo="srgb-linear",mD="display-p3",KM="display-p3-linear",eM="linear",na="srgb",tM="rec709",nM="p3",wve=0,hy=7680,Sve=7681,Ave=7682,Tve=7683,Mve=34055,Eve=34056,Cve=5386,Ive=512,Rve=513,Pve=514,Lve=515,Dve=516,Bve=517,kve=518,k4=519,cne=512,une=513,hne=514,i6=515,fne=516,dne=517,pne=518,mne=519,rM=35044,Ove=35048,Fve=35040,Nve=35045,zve=35049,Uve=35041,Gve=35046,Vve=35050,Hve=35042,jve="100",O4="300 es",tp=2e3,iM=2001;class xp{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,e);e.target=null}}}const Ol=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let P7=1234567;const Ny=Math.PI/180,sw=180/Math.PI;function Fu(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Ol[n&255]+Ol[n>>8&255]+Ol[n>>16&255]+Ol[n>>24&255]+"-"+Ol[e&255]+Ol[e>>8&255]+"-"+Ol[e>>16&15|64]+Ol[e>>24&255]+"-"+Ol[t&63|128]+Ol[t>>8&255]+"-"+Ol[t>>16&255]+Ol[t>>24&255]+Ol[r&255]+Ol[r>>8&255]+Ol[r>>16&255]+Ol[r>>24&255]).toLowerCase()}function to(n,e,t){return Math.max(e,Math.min(t,n))}function s6(n,e){return(n%e+e)%e}function Wve(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function $ve(n,e,t){return n!==e?(t-n)/(e-n):0}function rT(n,e,t){return(1-t)*n+t*e}function Xve(n,e,t,r){return rT(n,e,1-Math.exp(-t*r))}function qve(n,e=1){return e-Math.abs(s6(n,e*2)-e)}function Zve(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function Yve(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function Kve(n,e){return n+Math.floor(Math.random()*(e-n+1))}function Jve(n,e){return n+Math.random()*(e-n)}function Qve(n){return n*(.5-Math.random())}function e0e(n){n!==void 0&&(P7=n);let e=P7+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function t0e(n){return n*Ny}function n0e(n){return n*sw}function r0e(n){return(n&n-1)===0&&n!==0}function i0e(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function s0e(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function a0e(n,e,t,r,i){const s=Math.cos,o=Math.sin,l=s(t/2),a=o(t/2),h=s((e+r)/2),f=o((e+r)/2),p=s((e-r)/2),v=o((e-r)/2),y=s((r-e)/2),S=o((r-e)/2);switch(i){case"XYX":n.set(l*f,a*p,a*v,l*h);break;case"YZY":n.set(a*v,l*f,a*p,l*h);break;case"ZXZ":n.set(a*p,a*v,l*f,l*h);break;case"XZX":n.set(l*f,a*S,a*y,l*h);break;case"YXY":n.set(a*y,l*f,a*S,l*h);break;case"ZYZ":n.set(a*S,a*y,l*f,l*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Tc(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ai(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const ra={DEG2RAD:Ny,RAD2DEG:sw,generateUUID:Fu,clamp:to,euclideanModulo:s6,mapLinear:Wve,inverseLerp:$ve,lerp:rT,damp:Xve,pingpong:qve,smoothstep:Zve,smootherstep:Yve,randInt:Kve,randFloat:Jve,randFloatSpread:Qve,seededRandom:e0e,degToRad:t0e,radToDeg:n0e,isPowerOfTwo:r0e,ceilPowerOfTwo:i0e,floorPowerOfTwo:s0e,setQuaternionFromProperEuler:a0e,normalize:Ai,denormalize:Tc};class nn{constructor(e=0,t=0){nn.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(to(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*r-o*i+e.x,this.y=s*i+o*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Si{constructor(e,t,r,i,s,o,l,a,h){Si.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,l,a,h)}set(e,t,r,i,s,o,l,a,h){const f=this.elements;return f[0]=e,f[1]=i,f[2]=l,f[3]=t,f[4]=s,f[5]=a,f[6]=r,f[7]=o,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],l=r[3],a=r[6],h=r[1],f=r[4],p=r[7],v=r[2],y=r[5],S=r[8],C=i[0],M=i[3],E=i[6],L=i[1],k=i[4],H=i[7],X=i[2],Z=i[5],Q=i[8];return s[0]=o*C+l*L+a*X,s[3]=o*M+l*k+a*Z,s[6]=o*E+l*H+a*Q,s[1]=h*C+f*L+p*X,s[4]=h*M+f*k+p*Z,s[7]=h*E+f*H+p*Q,s[2]=v*C+y*L+S*X,s[5]=v*M+y*k+S*Z,s[8]=v*E+y*H+S*Q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],l=e[5],a=e[6],h=e[7],f=e[8];return t*o*f-t*l*h-r*s*f+r*l*a+i*s*h-i*o*a}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],l=e[5],a=e[6],h=e[7],f=e[8],p=f*o-l*h,v=l*a-f*s,y=h*s-o*a,S=t*p+r*v+i*y;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const C=1/S;return e[0]=p*C,e[1]=(i*h-f*r)*C,e[2]=(l*r-i*o)*C,e[3]=v*C,e[4]=(f*t-i*a)*C,e[5]=(i*s-l*t)*C,e[6]=y*C,e[7]=(r*a-h*t)*C,e[8]=(o*t-r*s)*C,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,o,l){const a=Math.cos(s),h=Math.sin(s);return this.set(r*a,r*h,-r*(a*o+h*l)+o+e,-i*h,i*a,-i*(-h*o+a*l)+l+t,0,0,1),this}scale(e,t){return this.premultiply(TO.makeScale(e,t)),this}rotate(e){return this.premultiply(TO.makeRotation(-e)),this}translate(e,t){return this.premultiply(TO.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const TO=new Si;function gne(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const o0e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function yb(n,e){return new o0e[n](e)}function sM(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function vne(){const n=sM("canvas");return n.style.display="block",n}const L7={};function a6(n){n in L7||(L7[n]=!0,console.warn(n))}function l0e(n,e,t){return new Promise(function(r,i){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:i();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:r()}}setTimeout(s,t)})}const D7=new Si().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),B7=new Si().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),FC={[jo]:{transfer:eM,primaries:tM,toReference:n=>n,fromReference:n=>n},[Ta]:{transfer:na,primaries:tM,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[KM]:{transfer:eM,primaries:nM,toReference:n=>n.applyMatrix3(B7),fromReference:n=>n.applyMatrix3(D7)},[mD]:{transfer:na,primaries:nM,toReference:n=>n.convertSRGBToLinear().applyMatrix3(B7),fromReference:n=>n.applyMatrix3(D7).convertLinearToSRGB()}},c0e=new Set([jo,KM]),gs={enabled:!0,_workingColorSpace:jo,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!c0e.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const r=FC[e].toReference,i=FC[t].fromReference;return i(r(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return FC[n].primaries},getTransfer:function(n){return n===Em?eM:FC[n].transfer}};function Fb(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function MO(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let l1;class _ne{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{l1===void 0&&(l1=sM("canvas")),l1.width=e.width,l1.height=e.height;const r=l1.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=l1}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=sM("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=Fb(s[o]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Fb(t[r]/255)*255):t[r]=Fb(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let u0e=0;class Sy{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:u0e++}),this.uuid=Fu(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,l=i.length;o<l;o++)i[o].isDataTexture?s.push(EO(i[o].image)):s.push(EO(i[o]))}else s=EO(i);r.url=s}return t||(e.images[this.uuid]=r),r}}function EO(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?_ne.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let h0e=0;class Xs extends xp{constructor(e=Xs.DEFAULT_IMAGE,t=Xs.DEFAULT_MAPPING,r=ou,i=ou,s=Ca,o=lu,l=Xl,a=Kf,h=Xs.DEFAULT_ANISOTROPY,f=Em){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:h0e++}),this.uuid=Fu(),this.name="",this.source=new Sy(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=h,this.format=l,this.internalFormat=null,this.type=a,this.offset=new nn(0,0),this.repeat=new nn(1,1),this.center=new nn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Si,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==lD)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Oh:e.x=e.x-Math.floor(e.x);break;case ou:e.x=e.x<0?0:1;break;case Qy:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Oh:e.y=e.y-Math.floor(e.y);break;case ou:e.y=e.y<0?0:1;break;case Qy:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Xs.DEFAULT_IMAGE=null;Xs.DEFAULT_MAPPING=lD;Xs.DEFAULT_ANISOTROPY=1;class Rs{constructor(e=0,t=0,r=0,i=1){Rs.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*t+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*t+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*t+o[7]*r+o[11]*i+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const a=e.elements,h=a[0],f=a[4],p=a[8],v=a[1],y=a[5],S=a[9],C=a[2],M=a[6],E=a[10];if(Math.abs(f-v)<.01&&Math.abs(p-C)<.01&&Math.abs(S-M)<.01){if(Math.abs(f+v)<.1&&Math.abs(p+C)<.1&&Math.abs(S+M)<.1&&Math.abs(h+y+E-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(h+1)/2,H=(y+1)/2,X=(E+1)/2,Z=(f+v)/4,Q=(p+C)/4,re=(S+M)/4;return k>H&&k>X?k<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(k),i=Z/r,s=Q/r):H>X?H<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(H),r=Z/i,s=re/i):X<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(X),r=Q/s,i=re/s),this.set(r,i,s,t),this}let L=Math.sqrt((M-S)*(M-S)+(p-C)*(p-C)+(v-f)*(v-f));return Math.abs(L)<.001&&(L=1),this.x=(M-S)/L,this.y=(p-C)/L,this.z=(v-f)/L,this.w=Math.acos((h+y+E-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class yne extends xp{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Rs(0,0,e,t),this.scissorTest=!1,this.viewport=new Rs(0,0,e,t);const i={width:e,height:t,depth:1};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ca,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},r);const s=new Xs(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);s.flipY=!1,s.generateMipmaps=r.generateMipmaps,s.internalFormat=r.internalFormat,this.textures=[];const o=r.count;for(let l=0;l<o;l++)this.textures[l]=s.clone(),this.textures[l].isRenderTargetTexture=!0;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let r=0,i=e.textures.length;r<i;r++)this.textures[r]=e.textures[r].clone(),this.textures[r].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Sy(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Sl extends yne{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class gD extends Xs{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Ao,this.minFilter=Ao,this.wrapR=ou,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class f0e extends Sl{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new gD(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class o6 extends Xs{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=Ao,this.minFilter=Ao,this.wrapR=ou,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class d0e extends Sl{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new o6(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class Mo{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,o,l){let a=r[i+0],h=r[i+1],f=r[i+2],p=r[i+3];const v=s[o+0],y=s[o+1],S=s[o+2],C=s[o+3];if(l===0){e[t+0]=a,e[t+1]=h,e[t+2]=f,e[t+3]=p;return}if(l===1){e[t+0]=v,e[t+1]=y,e[t+2]=S,e[t+3]=C;return}if(p!==C||a!==v||h!==y||f!==S){let M=1-l;const E=a*v+h*y+f*S+p*C,L=E>=0?1:-1,k=1-E*E;if(k>Number.EPSILON){const X=Math.sqrt(k),Z=Math.atan2(X,E*L);M=Math.sin(M*Z)/X,l=Math.sin(l*Z)/X}const H=l*L;if(a=a*M+v*H,h=h*M+y*H,f=f*M+S*H,p=p*M+C*H,M===1-l){const X=1/Math.sqrt(a*a+h*h+f*f+p*p);a*=X,h*=X,f*=X,p*=X}}e[t]=a,e[t+1]=h,e[t+2]=f,e[t+3]=p}static multiplyQuaternionsFlat(e,t,r,i,s,o){const l=r[i],a=r[i+1],h=r[i+2],f=r[i+3],p=s[o],v=s[o+1],y=s[o+2],S=s[o+3];return e[t]=l*S+f*p+a*y-h*v,e[t+1]=a*S+f*v+h*p-l*y,e[t+2]=h*S+f*y+l*v-a*p,e[t+3]=f*S-l*p-a*v-h*y,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,o=e._order,l=Math.cos,a=Math.sin,h=l(r/2),f=l(i/2),p=l(s/2),v=a(r/2),y=a(i/2),S=a(s/2);switch(o){case"XYZ":this._x=v*f*p+h*y*S,this._y=h*y*p-v*f*S,this._z=h*f*S+v*y*p,this._w=h*f*p-v*y*S;break;case"YXZ":this._x=v*f*p+h*y*S,this._y=h*y*p-v*f*S,this._z=h*f*S-v*y*p,this._w=h*f*p+v*y*S;break;case"ZXY":this._x=v*f*p-h*y*S,this._y=h*y*p+v*f*S,this._z=h*f*S+v*y*p,this._w=h*f*p-v*y*S;break;case"ZYX":this._x=v*f*p-h*y*S,this._y=h*y*p+v*f*S,this._z=h*f*S-v*y*p,this._w=h*f*p+v*y*S;break;case"YZX":this._x=v*f*p+h*y*S,this._y=h*y*p+v*f*S,this._z=h*f*S-v*y*p,this._w=h*f*p-v*y*S;break;case"XZY":this._x=v*f*p-h*y*S,this._y=h*y*p-v*f*S,this._z=h*f*S+v*y*p,this._w=h*f*p+v*y*S;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],o=t[1],l=t[5],a=t[9],h=t[2],f=t[6],p=t[10],v=r+l+p;if(v>0){const y=.5/Math.sqrt(v+1);this._w=.25/y,this._x=(f-a)*y,this._y=(s-h)*y,this._z=(o-i)*y}else if(r>l&&r>p){const y=2*Math.sqrt(1+r-l-p);this._w=(f-a)/y,this._x=.25*y,this._y=(i+o)/y,this._z=(s+h)/y}else if(l>p){const y=2*Math.sqrt(1+l-r-p);this._w=(s-h)/y,this._x=(i+o)/y,this._y=.25*y,this._z=(a+f)/y}else{const y=2*Math.sqrt(1+p-r-l);this._w=(o-i)/y,this._x=(s+h)/y,this._y=(a+f)/y,this._z=.25*y}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(to(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,o=e._w,l=t._x,a=t._y,h=t._z,f=t._w;return this._x=r*f+o*l+i*h-s*a,this._y=i*f+o*a+s*l-r*h,this._z=s*f+o*h+r*a-i*l,this._w=o*f-r*l-i*a-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,o=this._w;let l=o*e._w+r*e._x+i*e._y+s*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const a=1-l*l;if(a<=Number.EPSILON){const y=1-t;return this._w=y*o+t*this._w,this._x=y*r+t*this._x,this._y=y*i+t*this._y,this._z=y*s+t*this._z,this.normalize(),this}const h=Math.sqrt(a),f=Math.atan2(h,l),p=Math.sin((1-t)*f)/h,v=Math.sin(t*f)/h;return this._w=o*p+this._w*v,this._x=r*p+this._x*v,this._y=i*p+this._y*v,this._z=s*p+this._z*v,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ze{constructor(e=0,t=0,r=0){Ze.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(k7.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(k7.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,o=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,o=e.y,l=e.z,a=e.w,h=2*(o*i-l*r),f=2*(l*t-s*i),p=2*(s*r-o*t);return this.x=t+a*h+o*p-l*f,this.y=r+a*f+l*h-s*p,this.z=i+a*p+s*f-o*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,o=t.x,l=t.y,a=t.z;return this.x=i*a-s*l,this.y=s*o-r*a,this.z=r*l-i*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return CO.copy(this).projectOnVector(e),this.sub(CO)}reflect(e){return this.sub(CO.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(to(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const CO=new Ze,k7=new Mo;class Al{constructor(e=new Ze(1/0,1/0,1/0),t=new Ze(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(Ef.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(Ef.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=Ef.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,l=s.count;o<l;o++)e.isMesh===!0?e.getVertexPosition(o,Ef):Ef.fromBufferAttribute(s,o),Ef.applyMatrix4(e.matrixWorld),this.expandByPoint(Ef);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),NC.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),NC.copy(r.boundingBox)),NC.applyMatrix4(e.matrixWorld),this.union(NC)}const i=e.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Ef),Ef.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(PS),zC.subVectors(this.max,PS),c1.subVectors(e.a,PS),u1.subVectors(e.b,PS),h1.subVectors(e.c,PS),uv.subVectors(u1,c1),hv.subVectors(h1,u1),w_.subVectors(c1,h1);let t=[0,-uv.z,uv.y,0,-hv.z,hv.y,0,-w_.z,w_.y,uv.z,0,-uv.x,hv.z,0,-hv.x,w_.z,0,-w_.x,-uv.y,uv.x,0,-hv.y,hv.x,0,-w_.y,w_.x,0];return!IO(t,c1,u1,h1,zC)||(t=[1,0,0,0,1,0,0,0,1],!IO(t,c1,u1,h1,zC))?!1:(UC.crossVectors(uv,hv),t=[UC.x,UC.y,UC.z],IO(t,c1,u1,h1,zC))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ef).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ef).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(hm[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),hm[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),hm[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),hm[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),hm[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),hm[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),hm[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),hm[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(hm),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hm=[new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze],Ef=new Ze,NC=new Al,c1=new Ze,u1=new Ze,h1=new Ze,uv=new Ze,hv=new Ze,w_=new Ze,PS=new Ze,zC=new Ze,UC=new Ze,S_=new Ze;function IO(n,e,t,r,i){for(let s=0,o=n.length-3;s<=o;s+=3){S_.fromArray(n,s);const l=i.x*Math.abs(S_.x)+i.y*Math.abs(S_.y)+i.z*Math.abs(S_.z),a=e.dot(S_),h=t.dot(S_),f=r.dot(S_);if(Math.max(-Math.max(a,h,f),Math.min(a,h,f))>l)return!1}return!0}const p0e=new Al,LS=new Ze,RO=new Ze;class sl{constructor(e=new Ze,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):p0e.setFromPoints(e).getCenter(r);let i=0;for(let s=0,o=e.length;s<o;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;LS.subVectors(e,this.center);const t=LS.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(LS,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(RO.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(LS.copy(e.center).add(RO)),this.expandByPoint(LS.copy(e.center).sub(RO))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const fm=new Ze,PO=new Ze,GC=new Ze,fv=new Ze,LO=new Ze,VC=new Ze,DO=new Ze;class xx{constructor(e=new Ze,t=new Ze(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,fm)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=fm.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(fm.copy(this.origin).addScaledVector(this.direction,t),fm.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){PO.copy(e).add(t).multiplyScalar(.5),GC.copy(t).sub(e).normalize(),fv.copy(this.origin).sub(PO);const s=e.distanceTo(t)*.5,o=-this.direction.dot(GC),l=fv.dot(this.direction),a=-fv.dot(GC),h=fv.lengthSq(),f=Math.abs(1-o*o);let p,v,y,S;if(f>0)if(p=o*a-l,v=o*l-a,S=s*f,p>=0)if(v>=-S)if(v<=S){const C=1/f;p*=C,v*=C,y=p*(p+o*v+2*l)+v*(o*p+v+2*a)+h}else v=s,p=Math.max(0,-(o*v+l)),y=-p*p+v*(v+2*a)+h;else v=-s,p=Math.max(0,-(o*v+l)),y=-p*p+v*(v+2*a)+h;else v<=-S?(p=Math.max(0,-(-o*s+l)),v=p>0?-s:Math.min(Math.max(-s,-a),s),y=-p*p+v*(v+2*a)+h):v<=S?(p=0,v=Math.min(Math.max(-s,-a),s),y=v*(v+2*a)+h):(p=Math.max(0,-(o*s+l)),v=p>0?s:Math.min(Math.max(-s,-a),s),y=-p*p+v*(v+2*a)+h);else v=o>0?-s:s,p=Math.max(0,-(o*v+l)),y=-p*p+v*(v+2*a)+h;return r&&r.copy(this.origin).addScaledVector(this.direction,p),i&&i.copy(PO).addScaledVector(GC,v),y}intersectSphere(e,t){fm.subVectors(e.center,this.origin);const r=fm.dot(this.direction),i=fm.dot(fm)-r*r,s=e.radius*e.radius;if(i>s)return null;const o=Math.sqrt(s-i),l=r-o,a=r+o;return a<0?null:l<0?this.at(a,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,o,l,a;const h=1/this.direction.x,f=1/this.direction.y,p=1/this.direction.z,v=this.origin;return h>=0?(r=(e.min.x-v.x)*h,i=(e.max.x-v.x)*h):(r=(e.max.x-v.x)*h,i=(e.min.x-v.x)*h),f>=0?(s=(e.min.y-v.y)*f,o=(e.max.y-v.y)*f):(s=(e.max.y-v.y)*f,o=(e.min.y-v.y)*f),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),p>=0?(l=(e.min.z-v.z)*p,a=(e.max.z-v.z)*p):(l=(e.max.z-v.z)*p,a=(e.min.z-v.z)*p),r>a||l>i)||((l>r||r!==r)&&(r=l),(a<i||i!==i)&&(i=a),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,fm)!==null}intersectTriangle(e,t,r,i,s){LO.subVectors(t,e),VC.subVectors(r,e),DO.crossVectors(LO,VC);let o=this.direction.dot(DO),l;if(o>0){if(i)return null;l=1}else if(o<0)l=-1,o=-o;else return null;fv.subVectors(this.origin,e);const a=l*this.direction.dot(VC.crossVectors(fv,VC));if(a<0)return null;const h=l*this.direction.dot(LO.cross(fv));if(h<0||a+h>o)return null;const f=-l*fv.dot(DO);return f<0?null:this.at(f/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Gr{constructor(e,t,r,i,s,o,l,a,h,f,p,v,y,S,C,M){Gr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,o,l,a,h,f,p,v,y,S,C,M)}set(e,t,r,i,s,o,l,a,h,f,p,v,y,S,C,M){const E=this.elements;return E[0]=e,E[4]=t,E[8]=r,E[12]=i,E[1]=s,E[5]=o,E[9]=l,E[13]=a,E[2]=h,E[6]=f,E[10]=p,E[14]=v,E[3]=y,E[7]=S,E[11]=C,E[15]=M,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Gr().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/f1.setFromMatrixColumn(e,0).length(),s=1/f1.setFromMatrixColumn(e,1).length(),o=1/f1.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*o,t[9]=r[9]*o,t[10]=r[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,o=Math.cos(r),l=Math.sin(r),a=Math.cos(i),h=Math.sin(i),f=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const v=o*f,y=o*p,S=l*f,C=l*p;t[0]=a*f,t[4]=-a*p,t[8]=h,t[1]=y+S*h,t[5]=v-C*h,t[9]=-l*a,t[2]=C-v*h,t[6]=S+y*h,t[10]=o*a}else if(e.order==="YXZ"){const v=a*f,y=a*p,S=h*f,C=h*p;t[0]=v+C*l,t[4]=S*l-y,t[8]=o*h,t[1]=o*p,t[5]=o*f,t[9]=-l,t[2]=y*l-S,t[6]=C+v*l,t[10]=o*a}else if(e.order==="ZXY"){const v=a*f,y=a*p,S=h*f,C=h*p;t[0]=v-C*l,t[4]=-o*p,t[8]=S+y*l,t[1]=y+S*l,t[5]=o*f,t[9]=C-v*l,t[2]=-o*h,t[6]=l,t[10]=o*a}else if(e.order==="ZYX"){const v=o*f,y=o*p,S=l*f,C=l*p;t[0]=a*f,t[4]=S*h-y,t[8]=v*h+C,t[1]=a*p,t[5]=C*h+v,t[9]=y*h-S,t[2]=-h,t[6]=l*a,t[10]=o*a}else if(e.order==="YZX"){const v=o*a,y=o*h,S=l*a,C=l*h;t[0]=a*f,t[4]=C-v*p,t[8]=S*p+y,t[1]=p,t[5]=o*f,t[9]=-l*f,t[2]=-h*f,t[6]=y*p+S,t[10]=v-C*p}else if(e.order==="XZY"){const v=o*a,y=o*h,S=l*a,C=l*h;t[0]=a*f,t[4]=-p,t[8]=h*f,t[1]=v*p+C,t[5]=o*f,t[9]=y*p-S,t[2]=S*p-y,t[6]=l*f,t[10]=C*p+v}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(m0e,e,g0e)}lookAt(e,t,r){const i=this.elements;return Iu.subVectors(e,t),Iu.lengthSq()===0&&(Iu.z=1),Iu.normalize(),dv.crossVectors(r,Iu),dv.lengthSq()===0&&(Math.abs(r.z)===1?Iu.x+=1e-4:Iu.z+=1e-4,Iu.normalize(),dv.crossVectors(r,Iu)),dv.normalize(),HC.crossVectors(Iu,dv),i[0]=dv.x,i[4]=HC.x,i[8]=Iu.x,i[1]=dv.y,i[5]=HC.y,i[9]=Iu.y,i[2]=dv.z,i[6]=HC.z,i[10]=Iu.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,o=r[0],l=r[4],a=r[8],h=r[12],f=r[1],p=r[5],v=r[9],y=r[13],S=r[2],C=r[6],M=r[10],E=r[14],L=r[3],k=r[7],H=r[11],X=r[15],Z=i[0],Q=i[4],re=i[8],ie=i[12],oe=i[1],fe=i[5],Se=i[9],Ee=i[13],Ie=i[2],He=i[6],Re=i[10],st=i[14],_e=i[3],We=i[7],Ue=i[11],vt=i[15];return s[0]=o*Z+l*oe+a*Ie+h*_e,s[4]=o*Q+l*fe+a*He+h*We,s[8]=o*re+l*Se+a*Re+h*Ue,s[12]=o*ie+l*Ee+a*st+h*vt,s[1]=f*Z+p*oe+v*Ie+y*_e,s[5]=f*Q+p*fe+v*He+y*We,s[9]=f*re+p*Se+v*Re+y*Ue,s[13]=f*ie+p*Ee+v*st+y*vt,s[2]=S*Z+C*oe+M*Ie+E*_e,s[6]=S*Q+C*fe+M*He+E*We,s[10]=S*re+C*Se+M*Re+E*Ue,s[14]=S*ie+C*Ee+M*st+E*vt,s[3]=L*Z+k*oe+H*Ie+X*_e,s[7]=L*Q+k*fe+H*He+X*We,s[11]=L*re+k*Se+H*Re+X*Ue,s[15]=L*ie+k*Ee+H*st+X*vt,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],o=e[1],l=e[5],a=e[9],h=e[13],f=e[2],p=e[6],v=e[10],y=e[14],S=e[3],C=e[7],M=e[11],E=e[15];return S*(+s*a*p-i*h*p-s*l*v+r*h*v+i*l*y-r*a*y)+C*(+t*a*y-t*h*v+s*o*v-i*o*y+i*h*f-s*a*f)+M*(+t*h*p-t*l*y-s*o*p+r*o*y+s*l*f-r*h*f)+E*(-i*l*f-t*a*p+t*l*v+i*o*p-r*o*v+r*a*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],o=e[4],l=e[5],a=e[6],h=e[7],f=e[8],p=e[9],v=e[10],y=e[11],S=e[12],C=e[13],M=e[14],E=e[15],L=p*M*h-C*v*h+C*a*y-l*M*y-p*a*E+l*v*E,k=S*v*h-f*M*h-S*a*y+o*M*y+f*a*E-o*v*E,H=f*C*h-S*p*h+S*l*y-o*C*y-f*l*E+o*p*E,X=S*p*a-f*C*a-S*l*v+o*C*v+f*l*M-o*p*M,Z=t*L+r*k+i*H+s*X;if(Z===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Q=1/Z;return e[0]=L*Q,e[1]=(C*v*s-p*M*s-C*i*y+r*M*y+p*i*E-r*v*E)*Q,e[2]=(l*M*s-C*a*s+C*i*h-r*M*h-l*i*E+r*a*E)*Q,e[3]=(p*a*s-l*v*s-p*i*h+r*v*h+l*i*y-r*a*y)*Q,e[4]=k*Q,e[5]=(f*M*s-S*v*s+S*i*y-t*M*y-f*i*E+t*v*E)*Q,e[6]=(S*a*s-o*M*s-S*i*h+t*M*h+o*i*E-t*a*E)*Q,e[7]=(o*v*s-f*a*s+f*i*h-t*v*h-o*i*y+t*a*y)*Q,e[8]=H*Q,e[9]=(S*p*s-f*C*s-S*r*y+t*C*y+f*r*E-t*p*E)*Q,e[10]=(o*C*s-S*l*s+S*r*h-t*C*h-o*r*E+t*l*E)*Q,e[11]=(f*l*s-o*p*s-f*r*h+t*p*h+o*r*y-t*l*y)*Q,e[12]=X*Q,e[13]=(f*C*i-S*p*i+S*r*v-t*C*v-f*r*M+t*p*M)*Q,e[14]=(S*l*i-o*C*i-S*r*a+t*C*a+o*r*M-t*l*M)*Q,e[15]=(o*p*i-f*l*i+f*r*a-t*p*a-o*r*v+t*l*v)*Q,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,o=e.x,l=e.y,a=e.z,h=s*o,f=s*l;return this.set(h*o+r,h*l-i*a,h*a+i*l,0,h*l+i*a,f*l+r,f*a-i*o,0,h*a-i*l,f*a+i*o,s*a*a+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,o){return this.set(1,r,s,0,e,1,o,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,o=t._y,l=t._z,a=t._w,h=s+s,f=o+o,p=l+l,v=s*h,y=s*f,S=s*p,C=o*f,M=o*p,E=l*p,L=a*h,k=a*f,H=a*p,X=r.x,Z=r.y,Q=r.z;return i[0]=(1-(C+E))*X,i[1]=(y+H)*X,i[2]=(S-k)*X,i[3]=0,i[4]=(y-H)*Z,i[5]=(1-(v+E))*Z,i[6]=(M+L)*Z,i[7]=0,i[8]=(S+k)*Q,i[9]=(M-L)*Q,i[10]=(1-(v+C))*Q,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=f1.set(i[0],i[1],i[2]).length();const o=f1.set(i[4],i[5],i[6]).length(),l=f1.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],Cf.copy(this);const h=1/s,f=1/o,p=1/l;return Cf.elements[0]*=h,Cf.elements[1]*=h,Cf.elements[2]*=h,Cf.elements[4]*=f,Cf.elements[5]*=f,Cf.elements[6]*=f,Cf.elements[8]*=p,Cf.elements[9]*=p,Cf.elements[10]*=p,t.setFromRotationMatrix(Cf),r.x=s,r.y=o,r.z=l,this}makePerspective(e,t,r,i,s,o,l=tp){const a=this.elements,h=2*s/(t-e),f=2*s/(r-i),p=(t+e)/(t-e),v=(r+i)/(r-i);let y,S;if(l===tp)y=-(o+s)/(o-s),S=-2*o*s/(o-s);else if(l===iM)y=-o/(o-s),S=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return a[0]=h,a[4]=0,a[8]=p,a[12]=0,a[1]=0,a[5]=f,a[9]=v,a[13]=0,a[2]=0,a[6]=0,a[10]=y,a[14]=S,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,s,o,l=tp){const a=this.elements,h=1/(t-e),f=1/(r-i),p=1/(o-s),v=(t+e)*h,y=(r+i)*f;let S,C;if(l===tp)S=(o+s)*p,C=-2*p;else if(l===iM)S=s*p,C=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return a[0]=2*h,a[4]=0,a[8]=0,a[12]=-v,a[1]=0,a[5]=2*f,a[9]=0,a[13]=-y,a[2]=0,a[6]=0,a[10]=C,a[14]=-S,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const f1=new Ze,Cf=new Gr,m0e=new Ze(0,0,0),g0e=new Ze(1,1,1),dv=new Ze,HC=new Ze,Iu=new Ze,O7=new Gr,F7=new Mo;class Gu{constructor(e=0,t=0,r=0,i=Gu.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],o=i[4],l=i[8],a=i[1],h=i[5],f=i[9],p=i[2],v=i[6],y=i[10];switch(t){case"XYZ":this._y=Math.asin(to(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-f,y),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(v,h),this._z=0);break;case"YXZ":this._x=Math.asin(-to(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(l,y),this._z=Math.atan2(a,h)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(to(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-p,y),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(a,s));break;case"ZYX":this._y=Math.asin(-to(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(v,y),this._z=Math.atan2(a,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(to(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(l,y));break;case"XZY":this._z=Math.asin(-to(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(v,h),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-f,y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return O7.makeRotationFromQuaternion(e),this.setFromRotationMatrix(O7,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return F7.setFromEuler(this),this.setFromQuaternion(F7,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Gu.DEFAULT_ORDER="XYZ";class zy{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let v0e=0;const N7=new Ze,d1=new Mo,dm=new Gr,jC=new Ze,DS=new Ze,_0e=new Ze,y0e=new Mo,z7=new Ze(1,0,0),U7=new Ze(0,1,0),G7=new Ze(0,0,1),V7={type:"added"},x0e={type:"removed"},p1={type:"childadded",child:null},BO={type:"childremoved",child:null};class Pi extends xp{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:v0e++}),this.uuid=Fu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Pi.DEFAULT_UP.clone();const e=new Ze,t=new Gu,r=new Mo,i=new Ze(1,1,1);function s(){r.setFromEuler(t,!1)}function o(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Gr},normalMatrix:{value:new Si}}),this.matrix=new Gr,this.matrixWorld=new Gr,this.matrixAutoUpdate=Pi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Pi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new zy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return d1.setFromAxisAngle(e,t),this.quaternion.multiply(d1),this}rotateOnWorldAxis(e,t){return d1.setFromAxisAngle(e,t),this.quaternion.premultiply(d1),this}rotateX(e){return this.rotateOnAxis(z7,e)}rotateY(e){return this.rotateOnAxis(U7,e)}rotateZ(e){return this.rotateOnAxis(G7,e)}translateOnAxis(e,t){return N7.copy(e).applyQuaternion(this.quaternion),this.position.add(N7.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(z7,e)}translateY(e){return this.translateOnAxis(U7,e)}translateZ(e){return this.translateOnAxis(G7,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(dm.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?jC.copy(e):jC.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),DS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?dm.lookAt(DS,jC,this.up):dm.lookAt(jC,DS,this.up),this.quaternion.setFromRotationMatrix(dm),i&&(dm.extractRotation(i.matrixWorld),d1.setFromRotationMatrix(dm),this.quaternion.premultiply(d1.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(V7),p1.child=e,this.dispatchEvent(p1),p1.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(x0e),BO.child=e,this.dispatchEvent(BO),BO.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),dm.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),dm.multiply(e.parent.matrixWorld)),e.applyMatrix4(dm),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(V7),p1.child=e,this.dispatchEvent(p1),p1.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(DS,e,_0e),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(DS,y0e,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(l,a){return l[a.uuid]===void 0&&(l[a.uuid]=a.toJSON(e)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const a=l.shapes;if(Array.isArray(a))for(let h=0,f=a.length;h<f;h++){const p=a[h];s(e.shapes,p)}else s(e.shapes,a)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let a=0,h=this.material.length;a<h;a++)l.push(s(e.materials,this.material[a]));i.material=l}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let l=0;l<this.children.length;l++)i.children.push(this.children[l].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let l=0;l<this.animations.length;l++){const a=this.animations[l];i.animations.push(s(e.animations,a))}}if(t){const l=o(e.geometries),a=o(e.materials),h=o(e.textures),f=o(e.images),p=o(e.shapes),v=o(e.skeletons),y=o(e.animations),S=o(e.nodes);l.length>0&&(r.geometries=l),a.length>0&&(r.materials=a),h.length>0&&(r.textures=h),f.length>0&&(r.images=f),p.length>0&&(r.shapes=p),v.length>0&&(r.skeletons=v),y.length>0&&(r.animations=y),S.length>0&&(r.nodes=S)}return r.object=i,r;function o(l){const a=[];for(const h in l){const f=l[h];delete f.metadata,a.push(f)}return a}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}Pi.DEFAULT_UP=new Ze(0,1,0);Pi.DEFAULT_MATRIX_AUTO_UPDATE=!0;Pi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const If=new Ze,pm=new Ze,kO=new Ze,mm=new Ze,m1=new Ze,g1=new Ze,H7=new Ze,OO=new Ze,FO=new Ze,NO=new Ze;let $v=class J1{constructor(e=new Ze,t=new Ze,r=new Ze){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),If.subVectors(e,t),i.cross(If);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){If.subVectors(i,t),pm.subVectors(r,t),kO.subVectors(e,t);const o=If.dot(If),l=If.dot(pm),a=If.dot(kO),h=pm.dot(pm),f=pm.dot(kO),p=o*h-l*l;if(p===0)return s.set(0,0,0),null;const v=1/p,y=(h*a-l*f)*v,S=(o*f-l*a)*v;return s.set(1-y-S,S,y)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,mm)===null?!1:mm.x>=0&&mm.y>=0&&mm.x+mm.y<=1}static getInterpolation(e,t,r,i,s,o,l,a){return this.getBarycoord(e,t,r,i,mm)===null?(a.x=0,a.y=0,"z"in a&&(a.z=0),"w"in a&&(a.w=0),null):(a.setScalar(0),a.addScaledVector(s,mm.x),a.addScaledVector(o,mm.y),a.addScaledVector(l,mm.z),a)}static isFrontFacing(e,t,r,i){return If.subVectors(r,t),pm.subVectors(e,t),If.cross(pm).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return If.subVectors(this.c,this.b),pm.subVectors(this.a,this.b),If.cross(pm).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return J1.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return J1.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return J1.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return J1.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return J1.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let o,l;m1.subVectors(i,r),g1.subVectors(s,r),OO.subVectors(e,r);const a=m1.dot(OO),h=g1.dot(OO);if(a<=0&&h<=0)return t.copy(r);FO.subVectors(e,i);const f=m1.dot(FO),p=g1.dot(FO);if(f>=0&&p<=f)return t.copy(i);const v=a*p-f*h;if(v<=0&&a>=0&&f<=0)return o=a/(a-f),t.copy(r).addScaledVector(m1,o);NO.subVectors(e,s);const y=m1.dot(NO),S=g1.dot(NO);if(S>=0&&y<=S)return t.copy(s);const C=y*h-a*S;if(C<=0&&h>=0&&S<=0)return l=h/(h-S),t.copy(r).addScaledVector(g1,l);const M=f*S-y*p;if(M<=0&&p-f>=0&&y-S>=0)return H7.subVectors(s,i),l=(p-f)/(p-f+(y-S)),t.copy(i).addScaledVector(H7,l);const E=1/(M+C+v);return o=C*E,l=v*E,t.copy(r).addScaledVector(m1,o).addScaledVector(g1,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}};const xne={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pv={h:0,s:0,l:0},WC={h:0,s:0,l:0};function zO(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}let Vn=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ta){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,gs.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=gs.workingColorSpace){return this.r=e,this.g=t,this.b=r,gs.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=gs.workingColorSpace){if(e=s6(e,1),t=to(t,0,1),r=to(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,o=2*r-s;this.r=zO(o,s,e+1/3),this.g=zO(o,s,e),this.b=zO(o,s,e-1/3)}return gs.toWorkingColorSpace(this,i),this}setStyle(e,t=Ta){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=i[1],l=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ta){const r=xne[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Fb(e.r),this.g=Fb(e.g),this.b=Fb(e.b),this}copyLinearToSRGB(e){return this.r=MO(e.r),this.g=MO(e.g),this.b=MO(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ta){return gs.fromWorkingColorSpace(Fl.copy(this),e),Math.round(to(Fl.r*255,0,255))*65536+Math.round(to(Fl.g*255,0,255))*256+Math.round(to(Fl.b*255,0,255))}getHexString(e=Ta){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=gs.workingColorSpace){gs.fromWorkingColorSpace(Fl.copy(this),t);const r=Fl.r,i=Fl.g,s=Fl.b,o=Math.max(r,i,s),l=Math.min(r,i,s);let a,h;const f=(l+o)/2;if(l===o)a=0,h=0;else{const p=o-l;switch(h=f<=.5?p/(o+l):p/(2-o-l),o){case r:a=(i-s)/p+(i<s?6:0);break;case i:a=(s-r)/p+2;break;case s:a=(r-i)/p+4;break}a/=6}return e.h=a,e.s=h,e.l=f,e}getRGB(e,t=gs.workingColorSpace){return gs.fromWorkingColorSpace(Fl.copy(this),t),e.r=Fl.r,e.g=Fl.g,e.b=Fl.b,e}getStyle(e=Ta){gs.fromWorkingColorSpace(Fl.copy(this),e);const t=Fl.r,r=Fl.g,i=Fl.b;return e!==Ta?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(pv),this.setHSL(pv.h+e,pv.s+t,pv.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(pv),e.getHSL(WC);const r=rT(pv.h,WC.h,t),i=rT(pv.s,WC.s,t),s=rT(pv.l,WC.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const Fl=new Vn;Vn.NAMES=xne;let b0e=0;class ya extends xp{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:b0e++}),this.uuid=Fu(),this.name="",this.type="Material",this.blending=ky,this.side=kh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=JR,this.blendDst=QR,this.blendEquation=zv,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Vn(0,0,0),this.blendAlpha=0,this.depthFunc=YT,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=k4,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=hy,this.stencilZFail=hy,this.stencilZPass=hy,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==ky&&(r.blending=this.blending),this.side!==kh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==JR&&(r.blendSrc=this.blendSrc),this.blendDst!==QR&&(r.blendDst=this.blendDst),this.blendEquation!==zv&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==YT&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==k4&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==hy&&(r.stencilFail=this.stencilFail),this.stencilZFail!==hy&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==hy&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const l in s){const a=s[l];delete a.metadata,o.push(a)}return o}if(t){const s=i(e.textures),o=i(e.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}}class _a extends ya{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Gu,this.combine=$M,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Cm=w0e();function w0e(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let a=0;a<256;++a){const h=a-127;h<-27?(r[a]=0,r[a|256]=32768,i[a]=24,i[a|256]=24):h<-14?(r[a]=1024>>-h-14,r[a|256]=1024>>-h-14|32768,i[a]=-h-1,i[a|256]=-h-1):h<=15?(r[a]=h+15<<10,r[a|256]=h+15<<10|32768,i[a]=13,i[a|256]=13):h<128?(r[a]=31744,r[a|256]=64512,i[a]=24,i[a|256]=24):(r[a]=31744,r[a|256]=64512,i[a]=13,i[a|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),l=new Uint32Array(64);for(let a=1;a<1024;++a){let h=a<<13,f=0;for(;!(h&8388608);)h<<=1,f-=8388608;h&=-8388609,f+=947912704,s[a]=h|f}for(let a=1024;a<2048;++a)s[a]=939524096+(a-1024<<13);for(let a=1;a<31;++a)o[a]=a<<23;o[31]=1199570944,o[32]=2147483648;for(let a=33;a<63;++a)o[a]=2147483648+(a-32<<23);o[63]=3347054592;for(let a=1;a<64;++a)a!==32&&(l[a]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:o,offsetTable:l}}function tu(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=to(n,-65504,65504),Cm.floatView[0]=n;const e=Cm.uint32View[0],t=e>>23&511;return Cm.baseTable[t]+((e&8388607)>>Cm.shiftTable[t])}function EA(n){const e=n>>10;return Cm.uint32View[0]=Cm.mantissaTable[Cm.offsetTable[e]+(n&1023)]+Cm.exponentTable[e],Cm.floatView[0]}const S0e={toHalfFloat:tu,fromHalfFloat:EA},wo=new Ze,$C=new nn;class ki{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=rM,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Mc,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return a6("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)$C.fromBufferAttribute(this,t),$C.applyMatrix3(e),this.setXY(t,$C.x,$C.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)wo.fromBufferAttribute(this,t),wo.applyMatrix3(e),this.setXYZ(t,wo.x,wo.y,wo.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)wo.fromBufferAttribute(this,t),wo.applyMatrix4(e),this.setXYZ(t,wo.x,wo.y,wo.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)wo.fromBufferAttribute(this,t),wo.applyNormalMatrix(e),this.setXYZ(t,wo.x,wo.y,wo.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)wo.fromBufferAttribute(this,t),wo.transformDirection(e),this.setXYZ(t,wo.x,wo.y,wo.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Tc(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Ai(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Tc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Tc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Tc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Tc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array),i=Ai(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array),i=Ai(i,this.array),s=Ai(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==rM&&(e.usage=this.usage),e}}class A0e extends ki{constructor(e,t,r){super(new Int8Array(e),t,r)}}class T0e extends ki{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class M0e extends ki{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class E0e extends ki{constructor(e,t,r){super(new Int16Array(e),t,r)}}class l6 extends ki{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class C0e extends ki{constructor(e,t,r){super(new Int32Array(e),t,r)}}class c6 extends ki{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class I0e extends ki{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=EA(this.array[e*this.itemSize]);return this.normalized&&(t=Tc(t,this.array)),t}setX(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize]=tu(t),this}getY(e){let t=EA(this.array[e*this.itemSize+1]);return this.normalized&&(t=Tc(t,this.array)),t}setY(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+1]=tu(t),this}getZ(e){let t=EA(this.array[e*this.itemSize+2]);return this.normalized&&(t=Tc(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+2]=tu(t),this}getW(e){let t=EA(this.array[e*this.itemSize+3]);return this.normalized&&(t=Tc(t,this.array)),t}setW(e,t){return this.normalized&&(t=Ai(t,this.array)),this.array[e*this.itemSize+3]=tu(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array)),this.array[e+0]=tu(t),this.array[e+1]=tu(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array),i=Ai(i,this.array)),this.array[e+0]=tu(t),this.array[e+1]=tu(r),this.array[e+2]=tu(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array),i=Ai(i,this.array),s=Ai(s,this.array)),this.array[e+0]=tu(t),this.array[e+1]=tu(r),this.array[e+2]=tu(i),this.array[e+3]=tu(s),this}}class or extends ki{constructor(e,t,r){super(new Float32Array(e),t,r)}}let R0e=0;const uh=new Gr,UO=new Pi,v1=new Ze,Ru=new Al,BS=new Al,nl=new Ze;class Xr extends xp{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:R0e++}),this.uuid=Fu(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(gne(e)?c6:l6)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Si().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return uh.makeRotationFromQuaternion(e),this.applyMatrix4(uh),this}rotateX(e){return uh.makeRotationX(e),this.applyMatrix4(uh),this}rotateY(e){return uh.makeRotationY(e),this.applyMatrix4(uh),this}rotateZ(e){return uh.makeRotationZ(e),this.applyMatrix4(uh),this}translate(e,t,r){return uh.makeTranslation(e,t,r),this.applyMatrix4(uh),this}scale(e,t,r){return uh.makeScale(e,t,r),this.applyMatrix4(uh),this}lookAt(e){return UO.lookAt(e),UO.updateMatrix(),this.applyMatrix4(UO.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(v1).negate(),this.translate(v1.x,v1.y,v1.z),this}setFromPoints(e){const t=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new or(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Al);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Ze(-1/0,-1/0,-1/0),new Ze(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];Ru.setFromBufferAttribute(s),this.morphTargetsRelative?(nl.addVectors(this.boundingBox.min,Ru.min),this.boundingBox.expandByPoint(nl),nl.addVectors(this.boundingBox.max,Ru.max),this.boundingBox.expandByPoint(nl)):(this.boundingBox.expandByPoint(Ru.min),this.boundingBox.expandByPoint(Ru.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Ze,1/0);return}if(e){const r=this.boundingSphere.center;if(Ru.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const l=t[s];BS.setFromBufferAttribute(l),this.morphTargetsRelative?(nl.addVectors(Ru.min,BS.min),Ru.expandByPoint(nl),nl.addVectors(Ru.max,BS.max),Ru.expandByPoint(nl)):(Ru.expandByPoint(BS.min),Ru.expandByPoint(BS.max))}Ru.getCenter(r);let i=0;for(let s=0,o=e.count;s<o;s++)nl.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(nl));if(t)for(let s=0,o=t.length;s<o;s++){const l=t[s],a=this.morphTargetsRelative;for(let h=0,f=l.count;h<f;h++)nl.fromBufferAttribute(l,h),a&&(v1.fromBufferAttribute(e,h),nl.add(v1)),i=Math.max(i,r.distanceToSquared(nl))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ki(new Float32Array(4*r.count),4));const o=this.getAttribute("tangent"),l=[],a=[];for(let re=0;re<r.count;re++)l[re]=new Ze,a[re]=new Ze;const h=new Ze,f=new Ze,p=new Ze,v=new nn,y=new nn,S=new nn,C=new Ze,M=new Ze;function E(re,ie,oe){h.fromBufferAttribute(r,re),f.fromBufferAttribute(r,ie),p.fromBufferAttribute(r,oe),v.fromBufferAttribute(s,re),y.fromBufferAttribute(s,ie),S.fromBufferAttribute(s,oe),f.sub(h),p.sub(h),y.sub(v),S.sub(v);const fe=1/(y.x*S.y-S.x*y.y);isFinite(fe)&&(C.copy(f).multiplyScalar(S.y).addScaledVector(p,-y.y).multiplyScalar(fe),M.copy(p).multiplyScalar(y.x).addScaledVector(f,-S.x).multiplyScalar(fe),l[re].add(C),l[ie].add(C),l[oe].add(C),a[re].add(M),a[ie].add(M),a[oe].add(M))}let L=this.groups;L.length===0&&(L=[{start:0,count:e.count}]);for(let re=0,ie=L.length;re<ie;++re){const oe=L[re],fe=oe.start,Se=oe.count;for(let Ee=fe,Ie=fe+Se;Ee<Ie;Ee+=3)E(e.getX(Ee+0),e.getX(Ee+1),e.getX(Ee+2))}const k=new Ze,H=new Ze,X=new Ze,Z=new Ze;function Q(re){X.fromBufferAttribute(i,re),Z.copy(X);const ie=l[re];k.copy(ie),k.sub(X.multiplyScalar(X.dot(ie))).normalize(),H.crossVectors(Z,ie);const fe=H.dot(a[re])<0?-1:1;o.setXYZW(re,k.x,k.y,k.z,fe)}for(let re=0,ie=L.length;re<ie;++re){const oe=L[re],fe=oe.start,Se=oe.count;for(let Ee=fe,Ie=fe+Se;Ee<Ie;Ee+=3)Q(e.getX(Ee+0)),Q(e.getX(Ee+1)),Q(e.getX(Ee+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new ki(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let v=0,y=r.count;v<y;v++)r.setXYZ(v,0,0,0);const i=new Ze,s=new Ze,o=new Ze,l=new Ze,a=new Ze,h=new Ze,f=new Ze,p=new Ze;if(e)for(let v=0,y=e.count;v<y;v+=3){const S=e.getX(v+0),C=e.getX(v+1),M=e.getX(v+2);i.fromBufferAttribute(t,S),s.fromBufferAttribute(t,C),o.fromBufferAttribute(t,M),f.subVectors(o,s),p.subVectors(i,s),f.cross(p),l.fromBufferAttribute(r,S),a.fromBufferAttribute(r,C),h.fromBufferAttribute(r,M),l.add(f),a.add(f),h.add(f),r.setXYZ(S,l.x,l.y,l.z),r.setXYZ(C,a.x,a.y,a.z),r.setXYZ(M,h.x,h.y,h.z)}else for(let v=0,y=t.count;v<y;v+=3)i.fromBufferAttribute(t,v+0),s.fromBufferAttribute(t,v+1),o.fromBufferAttribute(t,v+2),f.subVectors(o,s),p.subVectors(i,s),f.cross(p),r.setXYZ(v+0,f.x,f.y,f.z),r.setXYZ(v+1,f.x,f.y,f.z),r.setXYZ(v+2,f.x,f.y,f.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)nl.fromBufferAttribute(e,t),nl.normalize(),e.setXYZ(t,nl.x,nl.y,nl.z)}toNonIndexed(){function e(l,a){const h=l.array,f=l.itemSize,p=l.normalized,v=new h.constructor(a.length*f);let y=0,S=0;for(let C=0,M=a.length;C<M;C++){l.isInterleavedBufferAttribute?y=a[C]*l.data.stride+l.offset:y=a[C]*f;for(let E=0;E<f;E++)v[S++]=h[y++]}return new ki(v,f,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Xr,r=this.index.array,i=this.attributes;for(const l in i){const a=i[l],h=e(a,r);t.setAttribute(l,h)}const s=this.morphAttributes;for(const l in s){const a=[],h=s[l];for(let f=0,p=h.length;f<p;f++){const v=h[f],y=e(v,r);a.push(y)}t.morphAttributes[l]=a}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,a=o.length;l<a;l++){const h=o[l];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const a=this.parameters;for(const h in a)a[h]!==void 0&&(e[h]=a[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const a in r){const h=r[a];e.data.attributes[a]=h.toJSON(e.data)}const i={};let s=!1;for(const a in this.morphAttributes){const h=this.morphAttributes[a],f=[];for(let p=0,v=h.length;p<v;p++){const y=h[p];f.push(y.toJSON(e.data))}f.length>0&&(i[a]=f,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(e.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(t));const i=e.attributes;for(const h in i){const f=i[h];this.setAttribute(h,f.clone(t))}const s=e.morphAttributes;for(const h in s){const f=[],p=s[h];for(let v=0,y=p.length;v<y;v++)f.push(p[v].clone(t));this.morphAttributes[h]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,f=o.length;h<f;h++){const p=o[h];this.addGroup(p.start,p.count,p.materialIndex)}const l=e.boundingBox;l!==null&&(this.boundingBox=l.clone());const a=e.boundingSphere;return a!==null&&(this.boundingSphere=a.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const j7=new Gr,A_=new xx,XC=new sl,W7=new Ze,_1=new Ze,y1=new Ze,x1=new Ze,GO=new Ze,qC=new Ze,ZC=new nn,YC=new nn,KC=new nn,$7=new Ze,X7=new Ze,q7=new Ze,JC=new Ze,QC=new Ze;class Ri extends Pi{constructor(e=new Xr,t=new _a){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const l=this.morphTargetInfluences;if(s&&l){qC.set(0,0,0);for(let a=0,h=s.length;a<h;a++){const f=l[a],p=s[a];f!==0&&(GO.fromBufferAttribute(p,e),o?qC.addScaledVector(GO,f):qC.addScaledVector(GO.sub(t),f))}t.add(qC)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),XC.copy(r.boundingSphere),XC.applyMatrix4(s),A_.copy(e.ray).recast(e.near),!(XC.containsPoint(A_.origin)===!1&&(A_.intersectSphere(XC,W7)===null||A_.origin.distanceToSquared(W7)>(e.far-e.near)**2))&&(j7.copy(s).invert(),A_.copy(e.ray).applyMatrix4(j7),!(r.boundingBox!==null&&A_.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,A_)))}_computeIntersections(e,t,r){let i;const s=this.geometry,o=this.material,l=s.index,a=s.attributes.position,h=s.attributes.uv,f=s.attributes.uv1,p=s.attributes.normal,v=s.groups,y=s.drawRange;if(l!==null)if(Array.isArray(o))for(let S=0,C=v.length;S<C;S++){const M=v[S],E=o[M.materialIndex],L=Math.max(M.start,y.start),k=Math.min(l.count,Math.min(M.start+M.count,y.start+y.count));for(let H=L,X=k;H<X;H+=3){const Z=l.getX(H),Q=l.getX(H+1),re=l.getX(H+2);i=e2(this,E,e,r,h,f,p,Z,Q,re),i&&(i.faceIndex=Math.floor(H/3),i.face.materialIndex=M.materialIndex,t.push(i))}}else{const S=Math.max(0,y.start),C=Math.min(l.count,y.start+y.count);for(let M=S,E=C;M<E;M+=3){const L=l.getX(M),k=l.getX(M+1),H=l.getX(M+2);i=e2(this,o,e,r,h,f,p,L,k,H),i&&(i.faceIndex=Math.floor(M/3),t.push(i))}}else if(a!==void 0)if(Array.isArray(o))for(let S=0,C=v.length;S<C;S++){const M=v[S],E=o[M.materialIndex],L=Math.max(M.start,y.start),k=Math.min(a.count,Math.min(M.start+M.count,y.start+y.count));for(let H=L,X=k;H<X;H+=3){const Z=H,Q=H+1,re=H+2;i=e2(this,E,e,r,h,f,p,Z,Q,re),i&&(i.faceIndex=Math.floor(H/3),i.face.materialIndex=M.materialIndex,t.push(i))}}else{const S=Math.max(0,y.start),C=Math.min(a.count,y.start+y.count);for(let M=S,E=C;M<E;M+=3){const L=M,k=M+1,H=M+2;i=e2(this,o,e,r,h,f,p,L,k,H),i&&(i.faceIndex=Math.floor(M/3),t.push(i))}}}}function P0e(n,e,t,r,i,s,o,l){let a;if(e.side===Ic?a=r.intersectTriangle(o,s,i,!0,l):a=r.intersectTriangle(i,s,o,e.side===kh,l),a===null)return null;QC.copy(l),QC.applyMatrix4(n.matrixWorld);const h=t.ray.origin.distanceTo(QC);return h<t.near||h>t.far?null:{distance:h,point:QC.clone(),object:n}}function e2(n,e,t,r,i,s,o,l,a,h){n.getVertexPosition(l,_1),n.getVertexPosition(a,y1),n.getVertexPosition(h,x1);const f=P0e(n,e,t,r,_1,y1,x1,JC);if(f){i&&(ZC.fromBufferAttribute(i,l),YC.fromBufferAttribute(i,a),KC.fromBufferAttribute(i,h),f.uv=$v.getInterpolation(JC,_1,y1,x1,ZC,YC,KC,new nn)),s&&(ZC.fromBufferAttribute(s,l),YC.fromBufferAttribute(s,a),KC.fromBufferAttribute(s,h),f.uv1=$v.getInterpolation(JC,_1,y1,x1,ZC,YC,KC,new nn)),o&&($7.fromBufferAttribute(o,l),X7.fromBufferAttribute(o,a),q7.fromBufferAttribute(o,h),f.normal=$v.getInterpolation(JC,_1,y1,x1,$7,X7,q7,new Ze),f.normal.dot(r.direction)>0&&f.normal.multiplyScalar(-1));const p={a:l,b:a,c:h,normal:new Ze,materialIndex:0};$v.getNormal(_1,y1,x1,p.normal),f.face=p}return f}class bp extends Xr{constructor(e=1,t=1,r=1,i=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:o};const l=this;i=Math.floor(i),s=Math.floor(s),o=Math.floor(o);const a=[],h=[],f=[],p=[];let v=0,y=0;S("z","y","x",-1,-1,r,t,e,o,s,0),S("z","y","x",1,-1,r,t,-e,o,s,1),S("x","z","y",1,1,e,r,t,i,o,2),S("x","z","y",1,-1,e,r,-t,i,o,3),S("x","y","z",1,-1,e,t,r,i,s,4),S("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(a),this.setAttribute("position",new or(h,3)),this.setAttribute("normal",new or(f,3)),this.setAttribute("uv",new or(p,2));function S(C,M,E,L,k,H,X,Z,Q,re,ie){const oe=H/Q,fe=X/re,Se=H/2,Ee=X/2,Ie=Z/2,He=Q+1,Re=re+1;let st=0,_e=0;const We=new Ze;for(let Ue=0;Ue<Re;Ue++){const vt=Ue*fe-Ee;for(let xt=0;xt<He;xt++){const Vt=xt*oe-Se;We[C]=Vt*L,We[M]=vt*k,We[E]=Ie,h.push(We.x,We.y,We.z),We[C]=0,We[M]=0,We[E]=Z>0?1:-1,f.push(We.x,We.y,We.z),p.push(xt/Q),p.push(1-Ue/re),st+=1}}for(let Ue=0;Ue<re;Ue++)for(let vt=0;vt<Q;vt++){const xt=v+vt+He*Ue,Vt=v+vt+He*(Ue+1),lt=v+(vt+1)+He*(Ue+1),Ht=v+(vt+1)+He*Ue;a.push(xt,Vt,Ht),a.push(Vt,lt,Ht),_e+=6}l.addGroup(y,_e,ie),y+=_e,v+=st}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bp(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function aw(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function xc(n){const e={};for(let t=0;t<n.length;t++){const r=aw(n[t]);for(const i in r)e[i]=r[i]}return e}function L0e(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function bne(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:gs.workingColorSpace}const qm={clone:aw,merge:xc};var D0e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,B0e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ia extends ya{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=D0e,this.fragmentShader=B0e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=aw(e.uniforms),this.uniformsGroups=L0e(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?t.uniforms[i]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[i]={type:"m4",value:o.toArray()}:t.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class JM extends Pi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Gr,this.projectionMatrix=new Gr,this.projectionMatrixInverse=new Gr,this.coordinateSystem=tp}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const mv=new Ze,Z7=new nn,Y7=new nn;class ts extends JM{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=sw*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Ny*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return sw*2*Math.atan(Math.tan(Ny*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){mv.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(mv.x,mv.y).multiplyScalar(-e/mv.z),mv.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(mv.x,mv.y).multiplyScalar(-e/mv.z)}getViewSize(e,t){return this.getViewBounds(e,Z7,Y7),t.subVectors(Y7,Z7)}setViewOffset(e,t,r,i,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Ny*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const a=o.fullWidth,h=o.fullHeight;s+=o.offsetX*i/a,t-=o.offsetY*r/h,i*=o.width/a,r*=o.height/h}const l=this.filmOffset;l!==0&&(s+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const b1=-90,w1=1;class wne extends Pi{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new ts(b1,w1,e,t);i.layers=this.layers,this.add(i);const s=new ts(b1,w1,e,t);s.layers=this.layers,this.add(s);const o=new ts(b1,w1,e,t);o.layers=this.layers,this.add(o);const l=new ts(b1,w1,e,t);l.layers=this.layers,this.add(l);const a=new ts(b1,w1,e,t);a.layers=this.layers,this.add(a);const h=new ts(b1,w1,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,o,l,a]=t;for(const h of t)this.remove(h);if(e===tp)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),l.up.set(0,1,0),l.lookAt(0,0,1),a.up.set(0,1,0),a.lookAt(0,0,-1);else if(e===iM)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),l.up.set(0,-1,0),l.lookAt(0,0,1),a.up.set(0,-1,0),a.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,l,a,h,f]=this.children,p=e.getRenderTarget(),v=e.getActiveCubeFace(),y=e.getActiveMipmapLevel(),S=e.xr.enabled;e.xr.enabled=!1;const C=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,o),e.setRenderTarget(r,2,i),e.render(t,l),e.setRenderTarget(r,3,i),e.render(t,a),e.setRenderTarget(r,4,i),e.render(t,h),r.texture.generateMipmaps=C,e.setRenderTarget(r,5,i),e.render(t,f),e.setRenderTarget(p,v,y),e.xr.enabled=S,r.texture.needsPMREMUpdate=!0}}class QM extends Xs{constructor(e,t,r,i,s,o,l,a,h,f){e=e!==void 0?e:[],t=t!==void 0?t:$m,super(e,t,r,i,s,o,l,a,h,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Sne extends Sl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new QM(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ca}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new bp(5,5,5),s=new Ia({name:"CubemapFromEquirect",uniforms:aw(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Ic,blending:cp});s.uniforms.tEquirect.value=t;const o=new Ri(i,s),l=t.minFilter;return t.minFilter===lu&&(t.minFilter=Ca),new wne(1,10,this).update(e,o),t.minFilter=l,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,r,i){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,r,i);e.setRenderTarget(s)}}const VO=new Ze,k0e=new Ze,O0e=new Si;let Mm=class{constructor(e=new Ze(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=VO.subVectors(r,t).cross(k0e.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(VO),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||O0e.getNormalMatrix(e),i=this.coplanarPoint(VO).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const T_=new sl,t2=new Ze;class eE{constructor(e=new Mm,t=new Mm,r=new Mm,i=new Mm,s=new Mm,o=new Mm){this.planes=[e,t,r,i,s,o]}set(e,t,r,i,s,o){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(r),l[3].copy(i),l[4].copy(s),l[5].copy(o),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=tp){const r=this.planes,i=e.elements,s=i[0],o=i[1],l=i[2],a=i[3],h=i[4],f=i[5],p=i[6],v=i[7],y=i[8],S=i[9],C=i[10],M=i[11],E=i[12],L=i[13],k=i[14],H=i[15];if(r[0].setComponents(a-s,v-h,M-y,H-E).normalize(),r[1].setComponents(a+s,v+h,M+y,H+E).normalize(),r[2].setComponents(a+o,v+f,M+S,H+L).normalize(),r[3].setComponents(a-o,v-f,M-S,H-L).normalize(),r[4].setComponents(a-l,v-p,M-C,H-k).normalize(),t===tp)r[5].setComponents(a+l,v+p,M+C,H+k).normalize();else if(t===iM)r[5].setComponents(l,p,C,k).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),T_.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),T_.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(T_)}intersectsSprite(e){return T_.center.set(0,0,0),T_.radius=.7071067811865476,T_.applyMatrix4(e.matrixWorld),this.intersectsSphere(T_)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(t2.x=i.normal.x>0?e.max.x:e.min.x,t2.y=i.normal.y>0?e.max.y:e.min.y,t2.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(t2)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Ane(){let n=null,e=!1,t=null,r=null;function i(s,o){t(s,o),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function F0e(n){const e=new WeakMap;function t(l,a){const h=l.array,f=l.usage,p=h.byteLength,v=n.createBuffer();n.bindBuffer(a,v),n.bufferData(a,h,f),l.onUploadCallback();let y;if(h instanceof Float32Array)y=n.FLOAT;else if(h instanceof Uint16Array)l.isFloat16BufferAttribute?y=n.HALF_FLOAT:y=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)y=n.SHORT;else if(h instanceof Uint32Array)y=n.UNSIGNED_INT;else if(h instanceof Int32Array)y=n.INT;else if(h instanceof Int8Array)y=n.BYTE;else if(h instanceof Uint8Array)y=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)y=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:v,type:y,bytesPerElement:h.BYTES_PER_ELEMENT,version:l.version,size:p}}function r(l,a,h){const f=a.array,p=a._updateRange,v=a.updateRanges;if(n.bindBuffer(h,l),p.count===-1&&v.length===0&&n.bufferSubData(h,0,f),v.length!==0){for(let y=0,S=v.length;y<S;y++){const C=v[y];n.bufferSubData(h,C.start*f.BYTES_PER_ELEMENT,f,C.start,C.count)}a.clearUpdateRanges()}p.count!==-1&&(n.bufferSubData(h,p.offset*f.BYTES_PER_ELEMENT,f,p.offset,p.count),p.count=-1),a.onUploadCallback()}function i(l){return l.isInterleavedBufferAttribute&&(l=l.data),e.get(l)}function s(l){l.isInterleavedBufferAttribute&&(l=l.data);const a=e.get(l);a&&(n.deleteBuffer(a.buffer),e.delete(l))}function o(l,a){if(l.isGLBufferAttribute){const f=e.get(l);(!f||f.version<l.version)&&e.set(l,{buffer:l.buffer,type:l.type,bytesPerElement:l.elementSize,version:l.version});return}l.isInterleavedBufferAttribute&&(l=l.data);const h=e.get(l);if(h===void 0)e.set(l,t(l,a));else if(h.version<l.version){if(h.size!==l.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(h.buffer,l,a),h.version=l.version}}return{get:i,remove:s,update:o}}class ig extends Xr{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,o=t/2,l=Math.floor(r),a=Math.floor(i),h=l+1,f=a+1,p=e/l,v=t/a,y=[],S=[],C=[],M=[];for(let E=0;E<f;E++){const L=E*v-o;for(let k=0;k<h;k++){const H=k*p-s;S.push(H,-L,0),C.push(0,0,1),M.push(k/l),M.push(1-E/a)}}for(let E=0;E<a;E++)for(let L=0;L<l;L++){const k=L+h*E,H=L+h*(E+1),X=L+1+h*(E+1),Z=L+1+h*E;y.push(k,H,Z),y.push(H,X,Z)}this.setIndex(y),this.setAttribute("position",new or(S,3)),this.setAttribute("normal",new or(C,3)),this.setAttribute("uv",new or(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ig(e.width,e.height,e.widthSegments,e.heightSegments)}}var N0e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,z0e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,U0e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,G0e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,V0e=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,H0e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,j0e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,W0e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,$0e=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,X0e=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,q0e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Z0e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Y0e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,K0e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,J0e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Q0e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,e_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,t_e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,n_e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,r_e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,i_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,s_e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,a_e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,o_e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,l_e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,c_e=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,u_e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,h_e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,f_e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,d_e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,p_e="gl_FragColor = linearToOutputTexel( gl_FragColor );",m_e=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,g_e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,v_e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,__e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,y_e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,x_e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,b_e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,w_e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,S_e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,A_e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,T_e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,M_e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,E_e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,C_e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,I_e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,R_e=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,P_e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,L_e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,D_e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,B_e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,k_e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,O_e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,F_e=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,N_e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,z_e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,U_e=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,G_e=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,V_e=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,H_e=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,j_e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,W_e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,$_e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,X_e=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,q_e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Z_e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Y_e=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,K_e=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,J_e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Q_e=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,eye=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,tye=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,nye=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,rye=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,iye=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,sye=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,aye=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,oye=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,lye=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,cye=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,uye=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,hye=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,fye=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,dye=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,pye=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,mye=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,gye=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,vye=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,_ye=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,yye=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,xye=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,bye=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,wye=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Sye=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Aye=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Tye=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Mye=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Eye=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Cye=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Iye=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Rye=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Pye=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Lye=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Dye=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Bye=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,kye=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Oye=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Fye=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Nye=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,zye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Uye=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Gye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Vye=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Hye=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,jye=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Wye=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,$ye=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Xye=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,qye=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Zye=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Yye=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Kye=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Jye=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Qye=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,exe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,txe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,nxe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rxe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,ixe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,sxe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,axe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oxe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,lxe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,cxe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,uxe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hxe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fxe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,dxe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pxe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,mxe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,gxe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Ei={alphahash_fragment:N0e,alphahash_pars_fragment:z0e,alphamap_fragment:U0e,alphamap_pars_fragment:G0e,alphatest_fragment:V0e,alphatest_pars_fragment:H0e,aomap_fragment:j0e,aomap_pars_fragment:W0e,batching_pars_vertex:$0e,batching_vertex:X0e,begin_vertex:q0e,beginnormal_vertex:Z0e,bsdfs:Y0e,iridescence_fragment:K0e,bumpmap_pars_fragment:J0e,clipping_planes_fragment:Q0e,clipping_planes_pars_fragment:e_e,clipping_planes_pars_vertex:t_e,clipping_planes_vertex:n_e,color_fragment:r_e,color_pars_fragment:i_e,color_pars_vertex:s_e,color_vertex:a_e,common:o_e,cube_uv_reflection_fragment:l_e,defaultnormal_vertex:c_e,displacementmap_pars_vertex:u_e,displacementmap_vertex:h_e,emissivemap_fragment:f_e,emissivemap_pars_fragment:d_e,colorspace_fragment:p_e,colorspace_pars_fragment:m_e,envmap_fragment:g_e,envmap_common_pars_fragment:v_e,envmap_pars_fragment:__e,envmap_pars_vertex:y_e,envmap_physical_pars_fragment:R_e,envmap_vertex:x_e,fog_vertex:b_e,fog_pars_vertex:w_e,fog_fragment:S_e,fog_pars_fragment:A_e,gradientmap_pars_fragment:T_e,lightmap_pars_fragment:M_e,lights_lambert_fragment:E_e,lights_lambert_pars_fragment:C_e,lights_pars_begin:I_e,lights_toon_fragment:P_e,lights_toon_pars_fragment:L_e,lights_phong_fragment:D_e,lights_phong_pars_fragment:B_e,lights_physical_fragment:k_e,lights_physical_pars_fragment:O_e,lights_fragment_begin:F_e,lights_fragment_maps:N_e,lights_fragment_end:z_e,logdepthbuf_fragment:U_e,logdepthbuf_pars_fragment:G_e,logdepthbuf_pars_vertex:V_e,logdepthbuf_vertex:H_e,map_fragment:j_e,map_pars_fragment:W_e,map_particle_fragment:$_e,map_particle_pars_fragment:X_e,metalnessmap_fragment:q_e,metalnessmap_pars_fragment:Z_e,morphinstance_vertex:Y_e,morphcolor_vertex:K_e,morphnormal_vertex:J_e,morphtarget_pars_vertex:Q_e,morphtarget_vertex:eye,normal_fragment_begin:tye,normal_fragment_maps:nye,normal_pars_fragment:rye,normal_pars_vertex:iye,normal_vertex:sye,normalmap_pars_fragment:aye,clearcoat_normal_fragment_begin:oye,clearcoat_normal_fragment_maps:lye,clearcoat_pars_fragment:cye,iridescence_pars_fragment:uye,opaque_fragment:hye,packing:fye,premultiplied_alpha_fragment:dye,project_vertex:pye,dithering_fragment:mye,dithering_pars_fragment:gye,roughnessmap_fragment:vye,roughnessmap_pars_fragment:_ye,shadowmap_pars_fragment:yye,shadowmap_pars_vertex:xye,shadowmap_vertex:bye,shadowmask_pars_fragment:wye,skinbase_vertex:Sye,skinning_pars_vertex:Aye,skinning_vertex:Tye,skinnormal_vertex:Mye,specularmap_fragment:Eye,specularmap_pars_fragment:Cye,tonemapping_fragment:Iye,tonemapping_pars_fragment:Rye,transmission_fragment:Pye,transmission_pars_fragment:Lye,uv_pars_fragment:Dye,uv_pars_vertex:Bye,uv_vertex:kye,worldpos_vertex:Oye,background_vert:Fye,background_frag:Nye,backgroundCube_vert:zye,backgroundCube_frag:Uye,cube_vert:Gye,cube_frag:Vye,depth_vert:Hye,depth_frag:jye,distanceRGBA_vert:Wye,distanceRGBA_frag:$ye,equirect_vert:Xye,equirect_frag:qye,linedashed_vert:Zye,linedashed_frag:Yye,meshbasic_vert:Kye,meshbasic_frag:Jye,meshlambert_vert:Qye,meshlambert_frag:exe,meshmatcap_vert:txe,meshmatcap_frag:nxe,meshnormal_vert:rxe,meshnormal_frag:ixe,meshphong_vert:sxe,meshphong_frag:axe,meshphysical_vert:oxe,meshphysical_frag:lxe,meshtoon_vert:cxe,meshtoon_frag:uxe,points_vert:hxe,points_frag:fxe,shadow_vert:dxe,shadow_frag:pxe,sprite_vert:mxe,sprite_frag:gxe},hr={common:{diffuse:{value:new Vn(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Si},alphaMap:{value:null},alphaMapTransform:{value:new Si},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Si}},envmap:{envMap:{value:null},envMapRotation:{value:new Si},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Si}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Si}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Si},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Si},normalScale:{value:new nn(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Si},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Si}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Si}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Si}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Vn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Vn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Si},alphaTest:{value:0},uvTransform:{value:new Si}},sprite:{diffuse:{value:new Vn(16777215)},opacity:{value:1},center:{value:new nn(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Si},alphaMap:{value:null},alphaMapTransform:{value:new Si},alphaTest:{value:0}}},Uf={basic:{uniforms:xc([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.fog]),vertexShader:Ei.meshbasic_vert,fragmentShader:Ei.meshbasic_frag},lambert:{uniforms:xc([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)}}]),vertexShader:Ei.meshlambert_vert,fragmentShader:Ei.meshlambert_frag},phong:{uniforms:xc([hr.common,hr.specularmap,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)},specular:{value:new Vn(1118481)},shininess:{value:30}}]),vertexShader:Ei.meshphong_vert,fragmentShader:Ei.meshphong_frag},standard:{uniforms:xc([hr.common,hr.envmap,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.roughnessmap,hr.metalnessmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ei.meshphysical_vert,fragmentShader:Ei.meshphysical_frag},toon:{uniforms:xc([hr.common,hr.aomap,hr.lightmap,hr.emissivemap,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.gradientmap,hr.fog,hr.lights,{emissive:{value:new Vn(0)}}]),vertexShader:Ei.meshtoon_vert,fragmentShader:Ei.meshtoon_frag},matcap:{uniforms:xc([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,hr.fog,{matcap:{value:null}}]),vertexShader:Ei.meshmatcap_vert,fragmentShader:Ei.meshmatcap_frag},points:{uniforms:xc([hr.points,hr.fog]),vertexShader:Ei.points_vert,fragmentShader:Ei.points_frag},dashed:{uniforms:xc([hr.common,hr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ei.linedashed_vert,fragmentShader:Ei.linedashed_frag},depth:{uniforms:xc([hr.common,hr.displacementmap]),vertexShader:Ei.depth_vert,fragmentShader:Ei.depth_frag},normal:{uniforms:xc([hr.common,hr.bumpmap,hr.normalmap,hr.displacementmap,{opacity:{value:1}}]),vertexShader:Ei.meshnormal_vert,fragmentShader:Ei.meshnormal_frag},sprite:{uniforms:xc([hr.sprite,hr.fog]),vertexShader:Ei.sprite_vert,fragmentShader:Ei.sprite_frag},background:{uniforms:{uvTransform:{value:new Si},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Ei.background_vert,fragmentShader:Ei.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Si}},vertexShader:Ei.backgroundCube_vert,fragmentShader:Ei.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ei.cube_vert,fragmentShader:Ei.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ei.equirect_vert,fragmentShader:Ei.equirect_frag},distanceRGBA:{uniforms:xc([hr.common,hr.displacementmap,{referencePosition:{value:new Ze},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ei.distanceRGBA_vert,fragmentShader:Ei.distanceRGBA_frag},shadow:{uniforms:xc([hr.lights,hr.fog,{color:{value:new Vn(0)},opacity:{value:1}}]),vertexShader:Ei.shadow_vert,fragmentShader:Ei.shadow_frag}};Uf.physical={uniforms:xc([Uf.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Si},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Si},clearcoatNormalScale:{value:new nn(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Si},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Si},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Si},sheen:{value:0},sheenColor:{value:new Vn(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Si},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Si},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Si},transmissionSamplerSize:{value:new nn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Si},attenuationDistance:{value:0},attenuationColor:{value:new Vn(0)},specularColor:{value:new Vn(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Si},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Si},anisotropyVector:{value:new nn},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Si}}]),vertexShader:Ei.meshphysical_vert,fragmentShader:Ei.meshphysical_frag};const n2={r:0,b:0,g:0},M_=new Gu,vxe=new Gr;function _xe(n,e,t,r,i,s,o){const l=new Vn(0);let a=s===!0?0:1,h,f,p=null,v=0,y=null;function S(L){let k=L.isScene===!0?L.background:null;return k&&k.isTexture&&(k=(L.backgroundBlurriness>0?t:e).get(k)),k}function C(L){let k=!1;const H=S(L);H===null?E(l,a):H&&H.isColor&&(E(H,1),k=!0);const X=n.xr.getEnvironmentBlendMode();X==="additive"?r.buffers.color.setClear(0,0,0,1,o):X==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,o),(n.autoClear||k)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function M(L,k){const H=S(k);H&&(H.isCubeTexture||H.mapping===Sw)?(f===void 0&&(f=new Ri(new bp(1,1,1),new Ia({name:"BackgroundCubeMaterial",uniforms:aw(Uf.backgroundCube.uniforms),vertexShader:Uf.backgroundCube.vertexShader,fragmentShader:Uf.backgroundCube.fragmentShader,side:Ic,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(X,Z,Q){this.matrixWorld.copyPosition(Q.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(f)),M_.copy(k.backgroundRotation),M_.x*=-1,M_.y*=-1,M_.z*=-1,H.isCubeTexture&&H.isRenderTargetTexture===!1&&(M_.y*=-1,M_.z*=-1),f.material.uniforms.envMap.value=H,f.material.uniforms.flipEnvMap.value=H.isCubeTexture&&H.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=k.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=k.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(vxe.makeRotationFromEuler(M_)),f.material.toneMapped=gs.getTransfer(H.colorSpace)!==na,(p!==H||v!==H.version||y!==n.toneMapping)&&(f.material.needsUpdate=!0,p=H,v=H.version,y=n.toneMapping),f.layers.enableAll(),L.unshift(f,f.geometry,f.material,0,0,null)):H&&H.isTexture&&(h===void 0&&(h=new Ri(new ig(2,2),new Ia({name:"BackgroundMaterial",uniforms:aw(Uf.background.uniforms),vertexShader:Uf.background.vertexShader,fragmentShader:Uf.background.fragmentShader,side:kh,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(h)),h.material.uniforms.t2D.value=H,h.material.uniforms.backgroundIntensity.value=k.backgroundIntensity,h.material.toneMapped=gs.getTransfer(H.colorSpace)!==na,H.matrixAutoUpdate===!0&&H.updateMatrix(),h.material.uniforms.uvTransform.value.copy(H.matrix),(p!==H||v!==H.version||y!==n.toneMapping)&&(h.material.needsUpdate=!0,p=H,v=H.version,y=n.toneMapping),h.layers.enableAll(),L.unshift(h,h.geometry,h.material,0,0,null))}function E(L,k){L.getRGB(n2,bne(n)),r.buffers.color.setClear(n2.r,n2.g,n2.b,k,o)}return{getClearColor:function(){return l},setClearColor:function(L,k=1){l.set(L),a=k,E(l,a)},getClearAlpha:function(){return a},setClearAlpha:function(L){a=L,E(l,a)},render:C,addToRenderList:M}}function yxe(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},i=v(null);let s=i,o=!1;function l(oe,fe,Se,Ee,Ie){let He=!1;const Re=p(Ee,Se,fe);s!==Re&&(s=Re,h(s.object)),He=y(oe,Ee,Se,Ie),He&&S(oe,Ee,Se,Ie),Ie!==null&&e.update(Ie,n.ELEMENT_ARRAY_BUFFER),(He||o)&&(o=!1,H(oe,fe,Se,Ee),Ie!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(Ie).buffer))}function a(){return n.createVertexArray()}function h(oe){return n.bindVertexArray(oe)}function f(oe){return n.deleteVertexArray(oe)}function p(oe,fe,Se){const Ee=Se.wireframe===!0;let Ie=r[oe.id];Ie===void 0&&(Ie={},r[oe.id]=Ie);let He=Ie[fe.id];He===void 0&&(He={},Ie[fe.id]=He);let Re=He[Ee];return Re===void 0&&(Re=v(a()),He[Ee]=Re),Re}function v(oe){const fe=[],Se=[],Ee=[];for(let Ie=0;Ie<t;Ie++)fe[Ie]=0,Se[Ie]=0,Ee[Ie]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:fe,enabledAttributes:Se,attributeDivisors:Ee,object:oe,attributes:{},index:null}}function y(oe,fe,Se,Ee){const Ie=s.attributes,He=fe.attributes;let Re=0;const st=Se.getAttributes();for(const _e in st)if(st[_e].location>=0){const Ue=Ie[_e];let vt=He[_e];if(vt===void 0&&(_e==="instanceMatrix"&&oe.instanceMatrix&&(vt=oe.instanceMatrix),_e==="instanceColor"&&oe.instanceColor&&(vt=oe.instanceColor)),Ue===void 0||Ue.attribute!==vt||vt&&Ue.data!==vt.data)return!0;Re++}return s.attributesNum!==Re||s.index!==Ee}function S(oe,fe,Se,Ee){const Ie={},He=fe.attributes;let Re=0;const st=Se.getAttributes();for(const _e in st)if(st[_e].location>=0){let Ue=He[_e];Ue===void 0&&(_e==="instanceMatrix"&&oe.instanceMatrix&&(Ue=oe.instanceMatrix),_e==="instanceColor"&&oe.instanceColor&&(Ue=oe.instanceColor));const vt={};vt.attribute=Ue,Ue&&Ue.data&&(vt.data=Ue.data),Ie[_e]=vt,Re++}s.attributes=Ie,s.attributesNum=Re,s.index=Ee}function C(){const oe=s.newAttributes;for(let fe=0,Se=oe.length;fe<Se;fe++)oe[fe]=0}function M(oe){E(oe,0)}function E(oe,fe){const Se=s.newAttributes,Ee=s.enabledAttributes,Ie=s.attributeDivisors;Se[oe]=1,Ee[oe]===0&&(n.enableVertexAttribArray(oe),Ee[oe]=1),Ie[oe]!==fe&&(n.vertexAttribDivisor(oe,fe),Ie[oe]=fe)}function L(){const oe=s.newAttributes,fe=s.enabledAttributes;for(let Se=0,Ee=fe.length;Se<Ee;Se++)fe[Se]!==oe[Se]&&(n.disableVertexAttribArray(Se),fe[Se]=0)}function k(oe,fe,Se,Ee,Ie,He,Re){Re===!0?n.vertexAttribIPointer(oe,fe,Se,Ie,He):n.vertexAttribPointer(oe,fe,Se,Ee,Ie,He)}function H(oe,fe,Se,Ee){C();const Ie=Ee.attributes,He=Se.getAttributes(),Re=fe.defaultAttributeValues;for(const st in He){const _e=He[st];if(_e.location>=0){let We=Ie[st];if(We===void 0&&(st==="instanceMatrix"&&oe.instanceMatrix&&(We=oe.instanceMatrix),st==="instanceColor"&&oe.instanceColor&&(We=oe.instanceColor)),We!==void 0){const Ue=We.normalized,vt=We.itemSize,xt=e.get(We);if(xt===void 0)continue;const Vt=xt.buffer,lt=xt.type,Ht=xt.bytesPerElement,Qt=lt===n.INT||lt===n.UNSIGNED_INT||We.gpuType===cD;if(We.isInterleavedBufferAttribute){const rn=We.data,jn=rn.stride,Bn=We.offset;if(rn.isInstancedInterleavedBuffer){for(let Tn=0;Tn<_e.locationSize;Tn++)E(_e.location+Tn,rn.meshPerAttribute);oe.isInstancedMesh!==!0&&Ee._maxInstanceCount===void 0&&(Ee._maxInstanceCount=rn.meshPerAttribute*rn.count)}else for(let Tn=0;Tn<_e.locationSize;Tn++)M(_e.location+Tn);n.bindBuffer(n.ARRAY_BUFFER,Vt);for(let Tn=0;Tn<_e.locationSize;Tn++)k(_e.location+Tn,vt/_e.locationSize,lt,Ue,jn*Ht,(Bn+vt/_e.locationSize*Tn)*Ht,Qt)}else{if(We.isInstancedBufferAttribute){for(let rn=0;rn<_e.locationSize;rn++)E(_e.location+rn,We.meshPerAttribute);oe.isInstancedMesh!==!0&&Ee._maxInstanceCount===void 0&&(Ee._maxInstanceCount=We.meshPerAttribute*We.count)}else for(let rn=0;rn<_e.locationSize;rn++)M(_e.location+rn);n.bindBuffer(n.ARRAY_BUFFER,Vt);for(let rn=0;rn<_e.locationSize;rn++)k(_e.location+rn,vt/_e.locationSize,lt,Ue,vt*Ht,vt/_e.locationSize*rn*Ht,Qt)}}else if(Re!==void 0){const Ue=Re[st];if(Ue!==void 0)switch(Ue.length){case 2:n.vertexAttrib2fv(_e.location,Ue);break;case 3:n.vertexAttrib3fv(_e.location,Ue);break;case 4:n.vertexAttrib4fv(_e.location,Ue);break;default:n.vertexAttrib1fv(_e.location,Ue)}}}}L()}function X(){re();for(const oe in r){const fe=r[oe];for(const Se in fe){const Ee=fe[Se];for(const Ie in Ee)f(Ee[Ie].object),delete Ee[Ie];delete fe[Se]}delete r[oe]}}function Z(oe){if(r[oe.id]===void 0)return;const fe=r[oe.id];for(const Se in fe){const Ee=fe[Se];for(const Ie in Ee)f(Ee[Ie].object),delete Ee[Ie];delete fe[Se]}delete r[oe.id]}function Q(oe){for(const fe in r){const Se=r[fe];if(Se[oe.id]===void 0)continue;const Ee=Se[oe.id];for(const Ie in Ee)f(Ee[Ie].object),delete Ee[Ie];delete Se[oe.id]}}function re(){ie(),o=!0,s!==i&&(s=i,h(s.object))}function ie(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:l,reset:re,resetDefaultState:ie,dispose:X,releaseStatesOfGeometry:Z,releaseStatesOfProgram:Q,initAttributes:C,enableAttribute:M,disableUnusedAttributes:L}}function xxe(n,e,t){let r;function i(h){r=h}function s(h,f){n.drawArrays(r,h,f),t.update(f,r,1)}function o(h,f,p){p!==0&&(n.drawArraysInstanced(r,h,f,p),t.update(f,r,p))}function l(h,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,h,0,f,0,p);let y=0;for(let S=0;S<p;S++)y+=f[S];t.update(y,r,1)}function a(h,f,p,v){if(p===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let S=0;S<h.length;S++)o(h[S],f[S],v[S]);else{y.multiDrawArraysInstancedWEBGL(r,h,0,f,0,v,0,p);let S=0;for(let C=0;C<p;C++)S+=f[C];for(let C=0;C<v.length;C++)t.update(S,r,v[C])}}this.setMode=i,this.render=s,this.renderInstances=o,this.renderMultiDraw=l,this.renderMultiDrawInstances=a}function bxe(n,e,t,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const Z=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(Z.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(Z){return!(Z!==Xl&&r.convert(Z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function l(Z){const Q=Z===Ih&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(Z!==Kf&&r.convert(Z)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&Z!==Mc&&!Q)}function a(Z){if(Z==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";Z="mediump"}return Z==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=t.precision!==void 0?t.precision:"highp";const f=a(h);f!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",f,"instead."),h=f);const p=t.logarithmicDepthBuffer===!0,v=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),y=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),S=n.getParameter(n.MAX_TEXTURE_SIZE),C=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),M=n.getParameter(n.MAX_VERTEX_ATTRIBS),E=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),L=n.getParameter(n.MAX_VARYING_VECTORS),k=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),H=y>0,X=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:a,textureFormatReadable:o,textureTypeReadable:l,precision:h,logarithmicDepthBuffer:p,maxTextures:v,maxVertexTextures:y,maxTextureSize:S,maxCubemapSize:C,maxAttributes:M,maxVertexUniforms:E,maxVaryings:L,maxFragmentUniforms:k,vertexTextures:H,maxSamples:X}}function wxe(n){const e=this;let t=null,r=0,i=!1,s=!1;const o=new Mm,l=new Si,a={value:null,needsUpdate:!1};this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(p,v){const y=p.length!==0||v||r!==0||i;return i=v,r=p.length,y},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(p,v){t=f(p,v,0)},this.setState=function(p,v,y){const S=p.clippingPlanes,C=p.clipIntersection,M=p.clipShadows,E=n.get(p);if(!i||S===null||S.length===0||s&&!M)s?f(null):h();else{const L=s?0:r,k=L*4;let H=E.clippingState||null;a.value=H,H=f(S,v,k,y);for(let X=0;X!==k;++X)H[X]=t[X];E.clippingState=H,this.numIntersection=C?this.numPlanes:0,this.numPlanes+=L}};function h(){a.value!==t&&(a.value=t,a.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function f(p,v,y,S){const C=p!==null?p.length:0;let M=null;if(C!==0){if(M=a.value,S!==!0||M===null){const E=y+C*4,L=v.matrixWorldInverse;l.getNormalMatrix(L),(M===null||M.length<E)&&(M=new Float32Array(E));for(let k=0,H=y;k!==C;++k,H+=4)o.copy(p[k]).applyMatrix4(L,l),o.normal.toArray(M,H),M[H+3]=o.constant}a.value=M,a.needsUpdate=!0}return e.numPlanes=C,e.numIntersection=0,M}}function Sxe(n){let e=new WeakMap;function t(o,l){return l===KT?o.mapping=$m:l===JT&&(o.mapping=d0),o}function r(o){if(o&&o.isTexture){const l=o.mapping;if(l===KT||l===JT)if(e.has(o)){const a=e.get(o).texture;return t(a,o.mapping)}else{const a=o.image;if(a&&a.height>0){const h=new Sne(a.height);return h.fromEquirectangularTexture(n,o),e.set(o,h),o.addEventListener("dispose",i),t(h.texture,o.mapping)}else return null}}return o}function i(o){const l=o.target;l.removeEventListener("dispose",i);const a=e.get(l);a!==void 0&&(e.delete(l),a.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class nd extends JM{constructor(e=-1,t=1,r=1,i=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,o=r+e,l=i+t,a=i-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,o=s+h*this.view.width,l-=f*this.view.offsetY,a=l-f*this.view.height}this.projectionMatrix.makeOrthographic(s,o,l,a,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const xb=4,K7=[.125,.215,.35,.446,.526,.582],gy=20,HO=new nd,J7=new Vn;let jO=null,WO=0,$O=0,XO=!1;const fy=(1+Math.sqrt(5))/2,S1=1/fy,Q7=[new Ze(-fy,S1,0),new Ze(fy,S1,0),new Ze(-S1,0,fy),new Ze(S1,0,fy),new Ze(0,fy,-S1),new Ze(0,fy,S1),new Ze(-1,1,-1),new Ze(1,1,-1),new Ze(-1,1,1),new Ze(1,1,1)];class F4{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){jO=this._renderer.getRenderTarget(),WO=this._renderer.getActiveCubeFace(),$O=this._renderer.getActiveMipmapLevel(),XO=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=nW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=tW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(jO,WO,$O),this._renderer.xr.enabled=XO,e.scissorTest=!1,r2(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===$m||e.mapping===d0?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),jO=this._renderer.getRenderTarget(),WO=this._renderer.getActiveCubeFace(),$O=this._renderer.getActiveMipmapLevel(),XO=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Ca,minFilter:Ca,generateMipmaps:!1,type:Ih,format:Xl,colorSpace:jo,depthBuffer:!1},i=eW(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=eW(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Axe(s)),this._blurMaterial=Txe(s,e,t)}return i}_compileMaterial(e){const t=new Ri(this._lodPlanes[0],e);this._renderer.compile(t,HO)}_sceneToCubeUV(e,t,r,i){const l=new ts(90,1,t,r),a=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,p=f.autoClear,v=f.toneMapping;f.getClearColor(J7),f.toneMapping=up,f.autoClear=!1;const y=new _a({name:"PMREM.Background",side:Ic,depthWrite:!1,depthTest:!1}),S=new Ri(new bp,y);let C=!1;const M=e.background;M?M.isColor&&(y.color.copy(M),e.background=null,C=!0):(y.color.copy(J7),C=!0);for(let E=0;E<6;E++){const L=E%3;L===0?(l.up.set(0,a[E],0),l.lookAt(h[E],0,0)):L===1?(l.up.set(0,0,a[E]),l.lookAt(0,h[E],0)):(l.up.set(0,a[E],0),l.lookAt(0,0,h[E]));const k=this._cubeSize;r2(i,L*k,E>2?k:0,k,k),f.setRenderTarget(i),C&&f.render(S,l),f.render(e,l)}S.geometry.dispose(),S.material.dispose(),f.toneMapping=v,f.autoClear=p,e.background=M}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===$m||e.mapping===d0;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=nW()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=tW());const s=i?this._cubemapMaterial:this._equirectMaterial,o=new Ri(this._lodPlanes[0],s),l=s.uniforms;l.envMap.value=e;const a=this._cubeSize;r2(t,0,0,3*a,2*a),r.setRenderTarget(t),r.render(o,HO)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),l=Q7[(i-s-1)%Q7.length];this._blur(e,s-1,s,o,l)}t.autoClear=r}_blur(e,t,r,i,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,r,i,"latitudinal",s),this._halfBlur(o,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,o,l){const a=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,p=new Ri(this._lodPlanes[i],h),v=h.uniforms,y=this._sizeLods[r]-1,S=isFinite(s)?Math.PI/(2*y):2*Math.PI/(2*gy-1),C=s/S,M=isFinite(s)?1+Math.floor(f*C):gy;M>gy&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${M} samples when the maximum is set to ${gy}`);const E=[];let L=0;for(let Q=0;Q<gy;++Q){const re=Q/C,ie=Math.exp(-re*re/2);E.push(ie),Q===0?L+=ie:Q<M&&(L+=2*ie)}for(let Q=0;Q<E.length;Q++)E[Q]=E[Q]/L;v.envMap.value=e.texture,v.samples.value=M,v.weights.value=E,v.latitudinal.value=o==="latitudinal",l&&(v.poleAxis.value=l);const{_lodMax:k}=this;v.dTheta.value=S,v.mipInt.value=k-r;const H=this._sizeLods[i],X=3*H*(i>k-xb?i-k+xb:0),Z=4*(this._cubeSize-H);r2(t,X,Z,3*H,2*H),a.setRenderTarget(t),a.render(p,HO)}}function Axe(n){const e=[],t=[],r=[];let i=n;const s=n-xb+1+K7.length;for(let o=0;o<s;o++){const l=Math.pow(2,i);t.push(l);let a=1/l;o>n-xb?a=K7[o-n+xb-1]:o===0&&(a=0),r.push(a);const h=1/(l-2),f=-h,p=1+h,v=[f,f,p,f,p,p,f,f,p,p,f,p],y=6,S=6,C=3,M=2,E=1,L=new Float32Array(C*S*y),k=new Float32Array(M*S*y),H=new Float32Array(E*S*y);for(let Z=0;Z<y;Z++){const Q=Z%3*2/3-1,re=Z>2?0:-1,ie=[Q,re,0,Q+2/3,re,0,Q+2/3,re+1,0,Q,re,0,Q+2/3,re+1,0,Q,re+1,0];L.set(ie,C*S*Z),k.set(v,M*S*Z);const oe=[Z,Z,Z,Z,Z,Z];H.set(oe,E*S*Z)}const X=new Xr;X.setAttribute("position",new ki(L,C)),X.setAttribute("uv",new ki(k,M)),X.setAttribute("faceIndex",new ki(H,E)),e.push(X),i>xb&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function eW(n,e,t){const r=new Sl(n,e,t);return r.texture.mapping=Sw,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function r2(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function Txe(n,e,t){const r=new Float32Array(gy),i=new Ze(0,1,0);return new Ia({name:"SphericalGaussianBlur",defines:{n:gy,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:u6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:cp,depthTest:!1,depthWrite:!1})}function tW(){return new Ia({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:u6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:cp,depthTest:!1,depthWrite:!1})}function nW(){return new Ia({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:u6(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:cp,depthTest:!1,depthWrite:!1})}function u6(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Mxe(n){let e=new WeakMap,t=null;function r(l){if(l&&l.isTexture){const a=l.mapping,h=a===KT||a===JT,f=a===$m||a===d0;if(h||f){let p=e.get(l);const v=p!==void 0?p.texture.pmremVersion:0;if(l.isRenderTargetTexture&&l.pmremVersion!==v)return t===null&&(t=new F4(n)),p=h?t.fromEquirectangular(l,p):t.fromCubemap(l,p),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),p.texture;if(p!==void 0)return p.texture;{const y=l.image;return h&&y&&y.height>0||f&&y&&i(y)?(t===null&&(t=new F4(n)),p=h?t.fromEquirectangular(l):t.fromCubemap(l),p.texture.pmremVersion=l.pmremVersion,e.set(l,p),l.addEventListener("dispose",s),p.texture):null}}}return l}function i(l){let a=0;const h=6;for(let f=0;f<h;f++)l[f]!==void 0&&a++;return a===h}function s(l){const a=l.target;a.removeEventListener("dispose",s);const h=e.get(a);h!==void 0&&(e.delete(a),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:o}}function Exe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const i=t(r);return i===null&&a6("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function Cxe(n,e,t,r){const i={},s=new WeakMap;function o(p){const v=p.target;v.index!==null&&e.remove(v.index);for(const S in v.attributes)e.remove(v.attributes[S]);for(const S in v.morphAttributes){const C=v.morphAttributes[S];for(let M=0,E=C.length;M<E;M++)e.remove(C[M])}v.removeEventListener("dispose",o),delete i[v.id];const y=s.get(v);y&&(e.remove(y),s.delete(v)),r.releaseStatesOfGeometry(v),v.isInstancedBufferGeometry===!0&&delete v._maxInstanceCount,t.memory.geometries--}function l(p,v){return i[v.id]===!0||(v.addEventListener("dispose",o),i[v.id]=!0,t.memory.geometries++),v}function a(p){const v=p.attributes;for(const S in v)e.update(v[S],n.ARRAY_BUFFER);const y=p.morphAttributes;for(const S in y){const C=y[S];for(let M=0,E=C.length;M<E;M++)e.update(C[M],n.ARRAY_BUFFER)}}function h(p){const v=[],y=p.index,S=p.attributes.position;let C=0;if(y!==null){const L=y.array;C=y.version;for(let k=0,H=L.length;k<H;k+=3){const X=L[k+0],Z=L[k+1],Q=L[k+2];v.push(X,Z,Z,Q,Q,X)}}else if(S!==void 0){const L=S.array;C=S.version;for(let k=0,H=L.length/3-1;k<H;k+=3){const X=k+0,Z=k+1,Q=k+2;v.push(X,Z,Z,Q,Q,X)}}else return;const M=new(gne(v)?c6:l6)(v,1);M.version=C;const E=s.get(p);E&&e.remove(E),s.set(p,M)}function f(p){const v=s.get(p);if(v){const y=p.index;y!==null&&v.version<y.version&&h(p)}else h(p);return s.get(p)}return{get:l,update:a,getWireframeAttribute:f}}function Ixe(n,e,t){let r;function i(v){r=v}let s,o;function l(v){s=v.type,o=v.bytesPerElement}function a(v,y){n.drawElements(r,y,s,v*o),t.update(y,r,1)}function h(v,y,S){S!==0&&(n.drawElementsInstanced(r,y,s,v*o,S),t.update(y,r,S))}function f(v,y,S){if(S===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,y,0,s,v,0,S);let M=0;for(let E=0;E<S;E++)M+=y[E];t.update(M,r,1)}function p(v,y,S,C){if(S===0)return;const M=e.get("WEBGL_multi_draw");if(M===null)for(let E=0;E<v.length;E++)h(v[E]/o,y[E],C[E]);else{M.multiDrawElementsInstancedWEBGL(r,y,0,s,v,0,C,0,S);let E=0;for(let L=0;L<S;L++)E+=y[L];for(let L=0;L<C.length;L++)t.update(E,r,C[L])}}this.setMode=i,this.setIndex=l,this.render=a,this.renderInstances=h,this.renderMultiDraw=f,this.renderMultiDrawInstances=p}function Rxe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,o,l){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=l*(s/3);break;case n.LINES:t.lines+=l*(s/2);break;case n.LINE_STRIP:t.lines+=l*(s-1);break;case n.LINE_LOOP:t.lines+=l*s;break;case n.POINTS:t.points+=l*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function Pxe(n,e,t){const r=new WeakMap,i=new Rs;function s(o,l,a){const h=o.morphTargetInfluences,f=l.morphAttributes.position||l.morphAttributes.normal||l.morphAttributes.color,p=f!==void 0?f.length:0;let v=r.get(l);if(v===void 0||v.count!==p){let oe=function(){re.dispose(),r.delete(l),l.removeEventListener("dispose",oe)};var y=oe;v!==void 0&&v.texture.dispose();const S=l.morphAttributes.position!==void 0,C=l.morphAttributes.normal!==void 0,M=l.morphAttributes.color!==void 0,E=l.morphAttributes.position||[],L=l.morphAttributes.normal||[],k=l.morphAttributes.color||[];let H=0;S===!0&&(H=1),C===!0&&(H=2),M===!0&&(H=3);let X=l.attributes.position.count*H,Z=1;X>e.maxTextureSize&&(Z=Math.ceil(X/e.maxTextureSize),X=e.maxTextureSize);const Q=new Float32Array(X*Z*4*p),re=new gD(Q,X,Z,p);re.type=Mc,re.needsUpdate=!0;const ie=H*4;for(let fe=0;fe<p;fe++){const Se=E[fe],Ee=L[fe],Ie=k[fe],He=X*Z*4*fe;for(let Re=0;Re<Se.count;Re++){const st=Re*ie;S===!0&&(i.fromBufferAttribute(Se,Re),Q[He+st+0]=i.x,Q[He+st+1]=i.y,Q[He+st+2]=i.z,Q[He+st+3]=0),C===!0&&(i.fromBufferAttribute(Ee,Re),Q[He+st+4]=i.x,Q[He+st+5]=i.y,Q[He+st+6]=i.z,Q[He+st+7]=0),M===!0&&(i.fromBufferAttribute(Ie,Re),Q[He+st+8]=i.x,Q[He+st+9]=i.y,Q[He+st+10]=i.z,Q[He+st+11]=Ie.itemSize===4?i.w:1)}}v={count:p,texture:re,size:new nn(X,Z)},r.set(l,v),l.addEventListener("dispose",oe)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)a.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let S=0;for(let M=0;M<h.length;M++)S+=h[M];const C=l.morphTargetsRelative?1:1-S;a.getUniforms().setValue(n,"morphTargetBaseInfluence",C),a.getUniforms().setValue(n,"morphTargetInfluences",h)}a.getUniforms().setValue(n,"morphTargetsTexture",v.texture,t),a.getUniforms().setValue(n,"morphTargetsTextureSize",v.size)}return{update:s}}function Lxe(n,e,t,r){let i=new WeakMap;function s(a){const h=r.render.frame,f=a.geometry,p=e.get(a,f);if(i.get(p)!==h&&(e.update(p),i.set(p,h)),a.isInstancedMesh&&(a.hasEventListener("dispose",l)===!1&&a.addEventListener("dispose",l),i.get(a)!==h&&(t.update(a.instanceMatrix,n.ARRAY_BUFFER),a.instanceColor!==null&&t.update(a.instanceColor,n.ARRAY_BUFFER),i.set(a,h))),a.isSkinnedMesh){const v=a.skeleton;i.get(v)!==h&&(v.update(),i.set(v,h))}return p}function o(){i=new WeakMap}function l(a){const h=a.target;h.removeEventListener("dispose",l),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:o}}class h6 extends Xs{constructor(e,t,r,i,s,o,l,a,h,f=Fy){if(f!==Fy&&f!==tx)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&f===Fy&&(r=Xm),r===void 0&&f===tx&&(r=ex),super(null,i,s,o,l,a,f,r,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=l!==void 0?l:Ao,this.minFilter=a!==void 0?a:Ao,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const Tne=new Xs,rW=new h6(1,1),Mne=new gD,Ene=new o6,Cne=new QM,iW=[],sW=[],aW=new Float32Array(16),oW=new Float32Array(9),lW=new Float32Array(4);function Aw(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=iW[i];if(s===void 0&&(s=new Float32Array(i),iW[i]=s),e!==0){r.toArray(s,0);for(let o=1,l=0;o!==e;++o)l+=t,n[o].toArray(s,l)}return s}function Wo(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function $o(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function vD(n,e){let t=sW[e];t===void 0&&(t=new Int32Array(e),sW[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function Dxe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Bxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wo(t,e))return;n.uniform2fv(this.addr,e),$o(t,e)}}function kxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Wo(t,e))return;n.uniform3fv(this.addr,e),$o(t,e)}}function Oxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wo(t,e))return;n.uniform4fv(this.addr,e),$o(t,e)}}function Fxe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Wo(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),$o(t,e)}else{if(Wo(t,r))return;lW.set(r),n.uniformMatrix2fv(this.addr,!1,lW),$o(t,r)}}function Nxe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Wo(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),$o(t,e)}else{if(Wo(t,r))return;oW.set(r),n.uniformMatrix3fv(this.addr,!1,oW),$o(t,r)}}function zxe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Wo(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),$o(t,e)}else{if(Wo(t,r))return;aW.set(r),n.uniformMatrix4fv(this.addr,!1,aW),$o(t,r)}}function Uxe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function Gxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wo(t,e))return;n.uniform2iv(this.addr,e),$o(t,e)}}function Vxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Wo(t,e))return;n.uniform3iv(this.addr,e),$o(t,e)}}function Hxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wo(t,e))return;n.uniform4iv(this.addr,e),$o(t,e)}}function jxe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function Wxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Wo(t,e))return;n.uniform2uiv(this.addr,e),$o(t,e)}}function $xe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Wo(t,e))return;n.uniform3uiv(this.addr,e),$o(t,e)}}function Xxe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Wo(t,e))return;n.uniform4uiv(this.addr,e),$o(t,e)}}function qxe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);let s;this.type===n.SAMPLER_2D_SHADOW?(rW.compareFunction=i6,s=rW):s=Tne,t.setTexture2D(e||s,i)}function Zxe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||Ene,i)}function Yxe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||Cne,i)}function Kxe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||Mne,i)}function Jxe(n){switch(n){case 5126:return Dxe;case 35664:return Bxe;case 35665:return kxe;case 35666:return Oxe;case 35674:return Fxe;case 35675:return Nxe;case 35676:return zxe;case 5124:case 35670:return Uxe;case 35667:case 35671:return Gxe;case 35668:case 35672:return Vxe;case 35669:case 35673:return Hxe;case 5125:return jxe;case 36294:return Wxe;case 36295:return $xe;case 36296:return Xxe;case 35678:case 36198:case 36298:case 36306:case 35682:return qxe;case 35679:case 36299:case 36307:return Zxe;case 35680:case 36300:case 36308:case 36293:return Yxe;case 36289:case 36303:case 36311:case 36292:return Kxe}}function Qxe(n,e){n.uniform1fv(this.addr,e)}function e1e(n,e){const t=Aw(e,this.size,2);n.uniform2fv(this.addr,t)}function t1e(n,e){const t=Aw(e,this.size,3);n.uniform3fv(this.addr,t)}function n1e(n,e){const t=Aw(e,this.size,4);n.uniform4fv(this.addr,t)}function r1e(n,e){const t=Aw(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function i1e(n,e){const t=Aw(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function s1e(n,e){const t=Aw(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function a1e(n,e){n.uniform1iv(this.addr,e)}function o1e(n,e){n.uniform2iv(this.addr,e)}function l1e(n,e){n.uniform3iv(this.addr,e)}function c1e(n,e){n.uniform4iv(this.addr,e)}function u1e(n,e){n.uniform1uiv(this.addr,e)}function h1e(n,e){n.uniform2uiv(this.addr,e)}function f1e(n,e){n.uniform3uiv(this.addr,e)}function d1e(n,e){n.uniform4uiv(this.addr,e)}function p1e(n,e,t){const r=this.cache,i=e.length,s=vD(t,i);Wo(r,s)||(n.uniform1iv(this.addr,s),$o(r,s));for(let o=0;o!==i;++o)t.setTexture2D(e[o]||Tne,s[o])}function m1e(n,e,t){const r=this.cache,i=e.length,s=vD(t,i);Wo(r,s)||(n.uniform1iv(this.addr,s),$o(r,s));for(let o=0;o!==i;++o)t.setTexture3D(e[o]||Ene,s[o])}function g1e(n,e,t){const r=this.cache,i=e.length,s=vD(t,i);Wo(r,s)||(n.uniform1iv(this.addr,s),$o(r,s));for(let o=0;o!==i;++o)t.setTextureCube(e[o]||Cne,s[o])}function v1e(n,e,t){const r=this.cache,i=e.length,s=vD(t,i);Wo(r,s)||(n.uniform1iv(this.addr,s),$o(r,s));for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||Mne,s[o])}function _1e(n){switch(n){case 5126:return Qxe;case 35664:return e1e;case 35665:return t1e;case 35666:return n1e;case 35674:return r1e;case 35675:return i1e;case 35676:return s1e;case 5124:case 35670:return a1e;case 35667:case 35671:return o1e;case 35668:case 35672:return l1e;case 35669:case 35673:return c1e;case 5125:return u1e;case 36294:return h1e;case 36295:return f1e;case 36296:return d1e;case 35678:case 36198:case 36298:case 36306:case 35682:return p1e;case 35679:case 36299:case 36307:return m1e;case 35680:case 36300:case 36308:case 36293:return g1e;case 36289:case 36303:case 36311:case 36292:return v1e}}class y1e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=Jxe(t.type)}}class x1e{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=_1e(t.type)}}class b1e{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,o=i.length;s!==o;++s){const l=i[s];l.setValue(e,t[l.id],r)}}}const qO=/(\w+)(\])?(\[|\.)?/g;function cW(n,e){n.seq.push(e),n.map[e.id]=e}function w1e(n,e,t){const r=n.name,i=r.length;for(qO.lastIndex=0;;){const s=qO.exec(r),o=qO.lastIndex;let l=s[1];const a=s[2]==="]",h=s[3];if(a&&(l=l|0),h===void 0||h==="["&&o+2===i){cW(t,h===void 0?new y1e(l,n,e):new x1e(l,n,e));break}else{let p=t.map[l];p===void 0&&(p=new b1e(l),cW(t,p)),t=p}}}class rR{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),o=e.getUniformLocation(t,s.name);w1e(s,o,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,o=t.length;s!==o;++s){const l=t[s],a=r[l.id];a.needsUpdate!==!1&&l.setValue(e,a.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const o=e[i];o.id in t&&r.push(o)}return r}}function uW(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const S1e=37297;let A1e=0;function T1e(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=i;o<s;o++){const l=o+1;r.push(`${l===e?">":" "} ${l}: ${t[o]}`)}return r.join(`
`)}function M1e(n){const e=gs.getPrimaries(gs.workingColorSpace),t=gs.getPrimaries(n);let r;switch(e===t?r="":e===nM&&t===tM?r="LinearDisplayP3ToLinearSRGB":e===tM&&t===nM&&(r="LinearSRGBToLinearDisplayP3"),n){case jo:case KM:return[r,"LinearTransferOETF"];case Ta:case mD:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[r,"LinearTransferOETF"]}}function hW(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+T1e(n.getShaderSource(e),o)}else return i}function E1e(n,e){const t=M1e(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function C1e(n,e){let t;switch(e){case Kte:t="Linear";break;case Jte:t="Reinhard";break;case aD:t="OptimizedCineon";break;case oD:t="ACESFilmic";break;case ene:t="AgX";break;case tne:t="Neutral";break;case Qte:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function I1e(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(CA).join(`
`)}function R1e(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function P1e(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),o=s.name;let l=1;s.type===n.FLOAT_MAT2&&(l=2),s.type===n.FLOAT_MAT3&&(l=3),s.type===n.FLOAT_MAT4&&(l=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:l}}return t}function CA(n){return n!==""}function fW(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function dW(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const L1e=/^[ \t]*#include +<([\w\d./]+)>/gm;function N4(n){return n.replace(L1e,B1e)}const D1e=new Map;function B1e(n,e){let t=Ei[e];if(t===void 0){const r=D1e.get(e);if(r!==void 0)t=Ei[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return N4(t)}const k1e=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pW(n){return n.replace(k1e,O1e)}function O1e(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function mW(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function F1e(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===sD?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===KA?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Of&&(e="SHADOWMAP_TYPE_VSM"),e}function N1e(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case $m:case d0:e="ENVMAP_TYPE_CUBE";break;case Sw:e="ENVMAP_TYPE_CUBE_UV";break}return e}function z1e(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case d0:e="ENVMAP_MODE_REFRACTION";break}return e}function U1e(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case $M:e="ENVMAP_BLENDING_MULTIPLY";break;case Zte:e="ENVMAP_BLENDING_MIX";break;case Yte:e="ENVMAP_BLENDING_ADD";break}return e}function G1e(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:r,maxMip:t}}function V1e(n,e,t,r){const i=n.getContext(),s=t.defines;let o=t.vertexShader,l=t.fragmentShader;const a=F1e(t),h=N1e(t),f=z1e(t),p=U1e(t),v=G1e(t),y=I1e(t),S=R1e(s),C=i.createProgram();let M,E,L=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(M=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(CA).join(`
`),M.length>0&&(M+=`
`),E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S].filter(CA).join(`
`),E.length>0&&(E+=`
`)):(M=[mW(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(CA).join(`
`),E=[mW(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",t.envMap?"#define "+p:"",v?"#define CUBEUV_TEXEL_WIDTH "+v.texelWidth:"",v?"#define CUBEUV_TEXEL_HEIGHT "+v.texelHeight:"",v?"#define CUBEUV_MAX_MIP "+v.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+a:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==up?"#define TONE_MAPPING":"",t.toneMapping!==up?Ei.tonemapping_pars_fragment:"",t.toneMapping!==up?C1e("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Ei.colorspace_pars_fragment,E1e("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(CA).join(`
`)),o=N4(o),o=fW(o,t),o=dW(o,t),l=N4(l),l=fW(l,t),l=dW(l,t),o=pW(o),l=pW(l),t.isRawShaderMaterial!==!0&&(L=`#version 300 es
`,M=[y,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+M,E=["#define varying in",t.glslVersion===O4?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===O4?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const k=L+M+o,H=L+E+l,X=uW(i,i.VERTEX_SHADER,k),Z=uW(i,i.FRAGMENT_SHADER,H);i.attachShader(C,X),i.attachShader(C,Z),t.index0AttributeName!==void 0?i.bindAttribLocation(C,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(C,0,"position"),i.linkProgram(C);function Q(fe){if(n.debug.checkShaderErrors){const Se=i.getProgramInfoLog(C).trim(),Ee=i.getShaderInfoLog(X).trim(),Ie=i.getShaderInfoLog(Z).trim();let He=!0,Re=!0;if(i.getProgramParameter(C,i.LINK_STATUS)===!1)if(He=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,C,X,Z);else{const st=hW(i,X,"vertex"),_e=hW(i,Z,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(C,i.VALIDATE_STATUS)+`

Material Name: `+fe.name+`
Material Type: `+fe.type+`

Program Info Log: `+Se+`
`+st+`
`+_e)}else Se!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Se):(Ee===""||Ie==="")&&(Re=!1);Re&&(fe.diagnostics={runnable:He,programLog:Se,vertexShader:{log:Ee,prefix:M},fragmentShader:{log:Ie,prefix:E}})}i.deleteShader(X),i.deleteShader(Z),re=new rR(i,C),ie=P1e(i,C)}let re;this.getUniforms=function(){return re===void 0&&Q(this),re};let ie;this.getAttributes=function(){return ie===void 0&&Q(this),ie};let oe=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return oe===!1&&(oe=i.getProgramParameter(C,S1e)),oe},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(C),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=A1e++,this.cacheKey=e,this.usedTimes=1,this.program=C,this.vertexShader=X,this.fragmentShader=Z,this}let H1e=0;class j1e{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),o=this._getShaderCacheForMaterial(e);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new W1e(e),t.set(e,r)),r}}class W1e{constructor(e){this.id=H1e++,this.code=e,this.usedTimes=0}}function $1e(n,e,t,r,i,s,o){const l=new zy,a=new j1e,h=new Set,f=[],p=i.logarithmicDepthBuffer,v=i.vertexTextures;let y=i.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function C(ie){return h.add(ie),ie===0?"uv":`uv${ie}`}function M(ie,oe,fe,Se,Ee){const Ie=Se.fog,He=Ee.geometry,Re=ie.isMeshStandardMaterial?Se.environment:null,st=(ie.isMeshStandardMaterial?t:e).get(ie.envMap||Re),_e=st&&st.mapping===Sw?st.image.height:null,We=S[ie.type];ie.precision!==null&&(y=i.getMaxPrecision(ie.precision),y!==ie.precision&&console.warn("THREE.WebGLProgram.getParameters:",ie.precision,"not supported, using",y,"instead."));const Ue=He.morphAttributes.position||He.morphAttributes.normal||He.morphAttributes.color,vt=Ue!==void 0?Ue.length:0;let xt=0;He.morphAttributes.position!==void 0&&(xt=1),He.morphAttributes.normal!==void 0&&(xt=2),He.morphAttributes.color!==void 0&&(xt=3);let Vt,lt,Ht,Qt;if(We){const hi=Uf[We];Vt=hi.vertexShader,lt=hi.fragmentShader}else Vt=ie.vertexShader,lt=ie.fragmentShader,a.update(ie),Ht=a.getVertexShaderID(ie),Qt=a.getFragmentShaderID(ie);const rn=n.getRenderTarget(),jn=Ee.isInstancedMesh===!0,Bn=Ee.isBatchedMesh===!0,Tn=!!ie.map,Le=!!ie.matcap,qe=!!st,mn=!!ie.aoMap,cn=!!ie.lightMap,St=!!ie.bumpMap,Jt=!!ie.normalMap,kn=!!ie.displacementMap,Gn=!!ie.emissiveMap,sn=!!ie.metalnessMap,ot=!!ie.roughnessMap,Ge=ie.anisotropy>0,Xt=ie.clearcoat>0,An=ie.dispersion>0,Sn=ie.iridescence>0,jt=ie.sheen>0,mr=ie.transmission>0,Un=Ge&&!!ie.anisotropyMap,tr=Xt&&!!ie.clearcoatMap,Sr=Xt&&!!ie.clearcoatNormalMap,Ln=Xt&&!!ie.clearcoatRoughnessMap,ir=Sn&&!!ie.iridescenceMap,ui=Sn&&!!ie.iridescenceThicknessMap,Fr=jt&&!!ie.sheenColorMap,ar=jt&&!!ie.sheenRoughnessMap,Nr=!!ie.specularMap,Hr=!!ie.specularColorMap,xi=!!ie.specularIntensityMap,Fe=mr&&!!ie.transmissionMap,Lt=mr&&!!ie.thicknessMap,Kt=!!ie.gradientMap,un=!!ie.alphaMap,Cn=ie.alphaTest>0,Ar=!!ie.alphaHash,Vr=!!ie.extensions;let hs=up;ie.toneMapped&&(rn===null||rn.isXRRenderTarget===!0)&&(hs=n.toneMapping);const Ls={shaderID:We,shaderType:ie.type,shaderName:ie.name,vertexShader:Vt,fragmentShader:lt,defines:ie.defines,customVertexShaderID:Ht,customFragmentShaderID:Qt,isRawShaderMaterial:ie.isRawShaderMaterial===!0,glslVersion:ie.glslVersion,precision:y,batching:Bn,batchingColor:Bn&&Ee._colorsTexture!==null,instancing:jn,instancingColor:jn&&Ee.instanceColor!==null,instancingMorph:jn&&Ee.morphTexture!==null,supportsVertexTextures:v,outputColorSpace:rn===null?n.outputColorSpace:rn.isXRRenderTarget===!0?rn.texture.colorSpace:jo,alphaToCoverage:!!ie.alphaToCoverage,map:Tn,matcap:Le,envMap:qe,envMapMode:qe&&st.mapping,envMapCubeUVHeight:_e,aoMap:mn,lightMap:cn,bumpMap:St,normalMap:Jt,displacementMap:v&&kn,emissiveMap:Gn,normalMapObjectSpace:Jt&&ie.normalMapType===lne,normalMapTangentSpace:Jt&&ie.normalMapType===P0,metalnessMap:sn,roughnessMap:ot,anisotropy:Ge,anisotropyMap:Un,clearcoat:Xt,clearcoatMap:tr,clearcoatNormalMap:Sr,clearcoatRoughnessMap:Ln,dispersion:An,iridescence:Sn,iridescenceMap:ir,iridescenceThicknessMap:ui,sheen:jt,sheenColorMap:Fr,sheenRoughnessMap:ar,specularMap:Nr,specularColorMap:Hr,specularIntensityMap:xi,transmission:mr,transmissionMap:Fe,thicknessMap:Lt,gradientMap:Kt,opaque:ie.transparent===!1&&ie.blending===ky&&ie.alphaToCoverage===!1,alphaMap:un,alphaTest:Cn,alphaHash:Ar,combine:ie.combine,mapUv:Tn&&C(ie.map.channel),aoMapUv:mn&&C(ie.aoMap.channel),lightMapUv:cn&&C(ie.lightMap.channel),bumpMapUv:St&&C(ie.bumpMap.channel),normalMapUv:Jt&&C(ie.normalMap.channel),displacementMapUv:kn&&C(ie.displacementMap.channel),emissiveMapUv:Gn&&C(ie.emissiveMap.channel),metalnessMapUv:sn&&C(ie.metalnessMap.channel),roughnessMapUv:ot&&C(ie.roughnessMap.channel),anisotropyMapUv:Un&&C(ie.anisotropyMap.channel),clearcoatMapUv:tr&&C(ie.clearcoatMap.channel),clearcoatNormalMapUv:Sr&&C(ie.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ln&&C(ie.clearcoatRoughnessMap.channel),iridescenceMapUv:ir&&C(ie.iridescenceMap.channel),iridescenceThicknessMapUv:ui&&C(ie.iridescenceThicknessMap.channel),sheenColorMapUv:Fr&&C(ie.sheenColorMap.channel),sheenRoughnessMapUv:ar&&C(ie.sheenRoughnessMap.channel),specularMapUv:Nr&&C(ie.specularMap.channel),specularColorMapUv:Hr&&C(ie.specularColorMap.channel),specularIntensityMapUv:xi&&C(ie.specularIntensityMap.channel),transmissionMapUv:Fe&&C(ie.transmissionMap.channel),thicknessMapUv:Lt&&C(ie.thicknessMap.channel),alphaMapUv:un&&C(ie.alphaMap.channel),vertexTangents:!!He.attributes.tangent&&(Jt||Ge),vertexColors:ie.vertexColors,vertexAlphas:ie.vertexColors===!0&&!!He.attributes.color&&He.attributes.color.itemSize===4,pointsUvs:Ee.isPoints===!0&&!!He.attributes.uv&&(Tn||un),fog:!!Ie,useFog:ie.fog===!0,fogExp2:!!Ie&&Ie.isFogExp2,flatShading:ie.flatShading===!0,sizeAttenuation:ie.sizeAttenuation===!0,logarithmicDepthBuffer:p,skinning:Ee.isSkinnedMesh===!0,morphTargets:He.morphAttributes.position!==void 0,morphNormals:He.morphAttributes.normal!==void 0,morphColors:He.morphAttributes.color!==void 0,morphTargetsCount:vt,morphTextureStride:xt,numDirLights:oe.directional.length,numPointLights:oe.point.length,numSpotLights:oe.spot.length,numSpotLightMaps:oe.spotLightMap.length,numRectAreaLights:oe.rectArea.length,numHemiLights:oe.hemi.length,numDirLightShadows:oe.directionalShadowMap.length,numPointLightShadows:oe.pointShadowMap.length,numSpotLightShadows:oe.spotShadowMap.length,numSpotLightShadowsWithMaps:oe.numSpotLightShadowsWithMaps,numLightProbes:oe.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:ie.dithering,shadowMapEnabled:n.shadowMap.enabled&&fe.length>0,shadowMapType:n.shadowMap.type,toneMapping:hs,decodeVideoTexture:Tn&&ie.map.isVideoTexture===!0&&gs.getTransfer(ie.map.colorSpace)===na,premultipliedAlpha:ie.premultipliedAlpha,doubleSided:ie.side===Ac,flipSided:ie.side===Ic,useDepthPacking:ie.depthPacking>=0,depthPacking:ie.depthPacking||0,index0AttributeName:ie.index0AttributeName,extensionClipCullDistance:Vr&&ie.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Vr&&ie.extensions.multiDraw===!0||Bn)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:ie.customProgramCacheKey()};return Ls.vertexUv1s=h.has(1),Ls.vertexUv2s=h.has(2),Ls.vertexUv3s=h.has(3),h.clear(),Ls}function E(ie){const oe=[];if(ie.shaderID?oe.push(ie.shaderID):(oe.push(ie.customVertexShaderID),oe.push(ie.customFragmentShaderID)),ie.defines!==void 0)for(const fe in ie.defines)oe.push(fe),oe.push(ie.defines[fe]);return ie.isRawShaderMaterial===!1&&(L(oe,ie),k(oe,ie),oe.push(n.outputColorSpace)),oe.push(ie.customProgramCacheKey),oe.join()}function L(ie,oe){ie.push(oe.precision),ie.push(oe.outputColorSpace),ie.push(oe.envMapMode),ie.push(oe.envMapCubeUVHeight),ie.push(oe.mapUv),ie.push(oe.alphaMapUv),ie.push(oe.lightMapUv),ie.push(oe.aoMapUv),ie.push(oe.bumpMapUv),ie.push(oe.normalMapUv),ie.push(oe.displacementMapUv),ie.push(oe.emissiveMapUv),ie.push(oe.metalnessMapUv),ie.push(oe.roughnessMapUv),ie.push(oe.anisotropyMapUv),ie.push(oe.clearcoatMapUv),ie.push(oe.clearcoatNormalMapUv),ie.push(oe.clearcoatRoughnessMapUv),ie.push(oe.iridescenceMapUv),ie.push(oe.iridescenceThicknessMapUv),ie.push(oe.sheenColorMapUv),ie.push(oe.sheenRoughnessMapUv),ie.push(oe.specularMapUv),ie.push(oe.specularColorMapUv),ie.push(oe.specularIntensityMapUv),ie.push(oe.transmissionMapUv),ie.push(oe.thicknessMapUv),ie.push(oe.combine),ie.push(oe.fogExp2),ie.push(oe.sizeAttenuation),ie.push(oe.morphTargetsCount),ie.push(oe.morphAttributeCount),ie.push(oe.numDirLights),ie.push(oe.numPointLights),ie.push(oe.numSpotLights),ie.push(oe.numSpotLightMaps),ie.push(oe.numHemiLights),ie.push(oe.numRectAreaLights),ie.push(oe.numDirLightShadows),ie.push(oe.numPointLightShadows),ie.push(oe.numSpotLightShadows),ie.push(oe.numSpotLightShadowsWithMaps),ie.push(oe.numLightProbes),ie.push(oe.shadowMapType),ie.push(oe.toneMapping),ie.push(oe.numClippingPlanes),ie.push(oe.numClipIntersection),ie.push(oe.depthPacking)}function k(ie,oe){l.disableAll(),oe.supportsVertexTextures&&l.enable(0),oe.instancing&&l.enable(1),oe.instancingColor&&l.enable(2),oe.instancingMorph&&l.enable(3),oe.matcap&&l.enable(4),oe.envMap&&l.enable(5),oe.normalMapObjectSpace&&l.enable(6),oe.normalMapTangentSpace&&l.enable(7),oe.clearcoat&&l.enable(8),oe.iridescence&&l.enable(9),oe.alphaTest&&l.enable(10),oe.vertexColors&&l.enable(11),oe.vertexAlphas&&l.enable(12),oe.vertexUv1s&&l.enable(13),oe.vertexUv2s&&l.enable(14),oe.vertexUv3s&&l.enable(15),oe.vertexTangents&&l.enable(16),oe.anisotropy&&l.enable(17),oe.alphaHash&&l.enable(18),oe.batching&&l.enable(19),oe.dispersion&&l.enable(20),oe.batchingColor&&l.enable(21),ie.push(l.mask),l.disableAll(),oe.fog&&l.enable(0),oe.useFog&&l.enable(1),oe.flatShading&&l.enable(2),oe.logarithmicDepthBuffer&&l.enable(3),oe.skinning&&l.enable(4),oe.morphTargets&&l.enable(5),oe.morphNormals&&l.enable(6),oe.morphColors&&l.enable(7),oe.premultipliedAlpha&&l.enable(8),oe.shadowMapEnabled&&l.enable(9),oe.doubleSided&&l.enable(10),oe.flipSided&&l.enable(11),oe.useDepthPacking&&l.enable(12),oe.dithering&&l.enable(13),oe.transmission&&l.enable(14),oe.sheen&&l.enable(15),oe.opaque&&l.enable(16),oe.pointsUvs&&l.enable(17),oe.decodeVideoTexture&&l.enable(18),oe.alphaToCoverage&&l.enable(19),ie.push(l.mask)}function H(ie){const oe=S[ie.type];let fe;if(oe){const Se=Uf[oe];fe=qm.clone(Se.uniforms)}else fe=ie.uniforms;return fe}function X(ie,oe){let fe;for(let Se=0,Ee=f.length;Se<Ee;Se++){const Ie=f[Se];if(Ie.cacheKey===oe){fe=Ie,++fe.usedTimes;break}}return fe===void 0&&(fe=new V1e(n,oe,ie,s),f.push(fe)),fe}function Z(ie){if(--ie.usedTimes===0){const oe=f.indexOf(ie);f[oe]=f[f.length-1],f.pop(),ie.destroy()}}function Q(ie){a.remove(ie)}function re(){a.dispose()}return{getParameters:M,getProgramCacheKey:E,getUniforms:H,acquireProgram:X,releaseProgram:Z,releaseShaderCache:Q,programs:f,dispose:re}}function X1e(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function r(s,o,l){n.get(s)[o]=l}function i(){n=new WeakMap}return{get:e,remove:t,update:r,dispose:i}}function q1e(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function gW(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function vW(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function o(p,v,y,S,C,M){let E=n[e];return E===void 0?(E={id:p.id,object:p,geometry:v,material:y,groupOrder:S,renderOrder:p.renderOrder,z:C,group:M},n[e]=E):(E.id=p.id,E.object=p,E.geometry=v,E.material=y,E.groupOrder=S,E.renderOrder=p.renderOrder,E.z=C,E.group=M),e++,E}function l(p,v,y,S,C,M){const E=o(p,v,y,S,C,M);y.transmission>0?r.push(E):y.transparent===!0?i.push(E):t.push(E)}function a(p,v,y,S,C,M){const E=o(p,v,y,S,C,M);y.transmission>0?r.unshift(E):y.transparent===!0?i.unshift(E):t.unshift(E)}function h(p,v){t.length>1&&t.sort(p||q1e),r.length>1&&r.sort(v||gW),i.length>1&&i.sort(v||gW)}function f(){for(let p=e,v=n.length;p<v;p++){const y=n[p];if(y.id===null)break;y.id=null,y.object=null,y.geometry=null,y.material=null,y.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:l,unshift:a,finish:f,sort:h}}function Z1e(){let n=new WeakMap;function e(r,i){const s=n.get(r);let o;return s===void 0?(o=new vW,n.set(r,[o])):i>=s.length?(o=new vW,s.push(o)):o=s[i],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function Y1e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Ze,color:new Vn};break;case"SpotLight":t={position:new Ze,direction:new Ze,color:new Vn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Ze,color:new Vn,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Ze,skyColor:new Vn,groundColor:new Vn};break;case"RectAreaLight":t={color:new Vn,position:new Ze,halfWidth:new Ze,halfHeight:new Ze};break}return n[e.id]=t,t}}}function K1e(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nn,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let J1e=0;function Q1e(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function ebe(n){const e=new Y1e,t=K1e(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)r.probe.push(new Ze);const i=new Ze,s=new Gr,o=new Gr;function l(h){let f=0,p=0,v=0;for(let ie=0;ie<9;ie++)r.probe[ie].set(0,0,0);let y=0,S=0,C=0,M=0,E=0,L=0,k=0,H=0,X=0,Z=0,Q=0;h.sort(Q1e);for(let ie=0,oe=h.length;ie<oe;ie++){const fe=h[ie],Se=fe.color,Ee=fe.intensity,Ie=fe.distance,He=fe.shadow&&fe.shadow.map?fe.shadow.map.texture:null;if(fe.isAmbientLight)f+=Se.r*Ee,p+=Se.g*Ee,v+=Se.b*Ee;else if(fe.isLightProbe){for(let Re=0;Re<9;Re++)r.probe[Re].addScaledVector(fe.sh.coefficients[Re],Ee);Q++}else if(fe.isDirectionalLight){const Re=e.get(fe);if(Re.color.copy(fe.color).multiplyScalar(fe.intensity),fe.castShadow){const st=fe.shadow,_e=t.get(fe);_e.shadowIntensity=st.intensity,_e.shadowBias=st.bias,_e.shadowNormalBias=st.normalBias,_e.shadowRadius=st.radius,_e.shadowMapSize=st.mapSize,r.directionalShadow[y]=_e,r.directionalShadowMap[y]=He,r.directionalShadowMatrix[y]=fe.shadow.matrix,L++}r.directional[y]=Re,y++}else if(fe.isSpotLight){const Re=e.get(fe);Re.position.setFromMatrixPosition(fe.matrixWorld),Re.color.copy(Se).multiplyScalar(Ee),Re.distance=Ie,Re.coneCos=Math.cos(fe.angle),Re.penumbraCos=Math.cos(fe.angle*(1-fe.penumbra)),Re.decay=fe.decay,r.spot[C]=Re;const st=fe.shadow;if(fe.map&&(r.spotLightMap[X]=fe.map,X++,st.updateMatrices(fe),fe.castShadow&&Z++),r.spotLightMatrix[C]=st.matrix,fe.castShadow){const _e=t.get(fe);_e.shadowIntensity=st.intensity,_e.shadowBias=st.bias,_e.shadowNormalBias=st.normalBias,_e.shadowRadius=st.radius,_e.shadowMapSize=st.mapSize,r.spotShadow[C]=_e,r.spotShadowMap[C]=He,H++}C++}else if(fe.isRectAreaLight){const Re=e.get(fe);Re.color.copy(Se).multiplyScalar(Ee),Re.halfWidth.set(fe.width*.5,0,0),Re.halfHeight.set(0,fe.height*.5,0),r.rectArea[M]=Re,M++}else if(fe.isPointLight){const Re=e.get(fe);if(Re.color.copy(fe.color).multiplyScalar(fe.intensity),Re.distance=fe.distance,Re.decay=fe.decay,fe.castShadow){const st=fe.shadow,_e=t.get(fe);_e.shadowIntensity=st.intensity,_e.shadowBias=st.bias,_e.shadowNormalBias=st.normalBias,_e.shadowRadius=st.radius,_e.shadowMapSize=st.mapSize,_e.shadowCameraNear=st.camera.near,_e.shadowCameraFar=st.camera.far,r.pointShadow[S]=_e,r.pointShadowMap[S]=He,r.pointShadowMatrix[S]=fe.shadow.matrix,k++}r.point[S]=Re,S++}else if(fe.isHemisphereLight){const Re=e.get(fe);Re.skyColor.copy(fe.color).multiplyScalar(Ee),Re.groundColor.copy(fe.groundColor).multiplyScalar(Ee),r.hemi[E]=Re,E++}}M>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=hr.LTC_FLOAT_1,r.rectAreaLTC2=hr.LTC_FLOAT_2):(r.rectAreaLTC1=hr.LTC_HALF_1,r.rectAreaLTC2=hr.LTC_HALF_2)),r.ambient[0]=f,r.ambient[1]=p,r.ambient[2]=v;const re=r.hash;(re.directionalLength!==y||re.pointLength!==S||re.spotLength!==C||re.rectAreaLength!==M||re.hemiLength!==E||re.numDirectionalShadows!==L||re.numPointShadows!==k||re.numSpotShadows!==H||re.numSpotMaps!==X||re.numLightProbes!==Q)&&(r.directional.length=y,r.spot.length=C,r.rectArea.length=M,r.point.length=S,r.hemi.length=E,r.directionalShadow.length=L,r.directionalShadowMap.length=L,r.pointShadow.length=k,r.pointShadowMap.length=k,r.spotShadow.length=H,r.spotShadowMap.length=H,r.directionalShadowMatrix.length=L,r.pointShadowMatrix.length=k,r.spotLightMatrix.length=H+X-Z,r.spotLightMap.length=X,r.numSpotLightShadowsWithMaps=Z,r.numLightProbes=Q,re.directionalLength=y,re.pointLength=S,re.spotLength=C,re.rectAreaLength=M,re.hemiLength=E,re.numDirectionalShadows=L,re.numPointShadows=k,re.numSpotShadows=H,re.numSpotMaps=X,re.numLightProbes=Q,r.version=J1e++)}function a(h,f){let p=0,v=0,y=0,S=0,C=0;const M=f.matrixWorldInverse;for(let E=0,L=h.length;E<L;E++){const k=h[E];if(k.isDirectionalLight){const H=r.directional[p];H.direction.setFromMatrixPosition(k.matrixWorld),i.setFromMatrixPosition(k.target.matrixWorld),H.direction.sub(i),H.direction.transformDirection(M),p++}else if(k.isSpotLight){const H=r.spot[y];H.position.setFromMatrixPosition(k.matrixWorld),H.position.applyMatrix4(M),H.direction.setFromMatrixPosition(k.matrixWorld),i.setFromMatrixPosition(k.target.matrixWorld),H.direction.sub(i),H.direction.transformDirection(M),y++}else if(k.isRectAreaLight){const H=r.rectArea[S];H.position.setFromMatrixPosition(k.matrixWorld),H.position.applyMatrix4(M),o.identity(),s.copy(k.matrixWorld),s.premultiply(M),o.extractRotation(s),H.halfWidth.set(k.width*.5,0,0),H.halfHeight.set(0,k.height*.5,0),H.halfWidth.applyMatrix4(o),H.halfHeight.applyMatrix4(o),S++}else if(k.isPointLight){const H=r.point[v];H.position.setFromMatrixPosition(k.matrixWorld),H.position.applyMatrix4(M),v++}else if(k.isHemisphereLight){const H=r.hemi[C];H.direction.setFromMatrixPosition(k.matrixWorld),H.direction.transformDirection(M),C++}}}return{setup:l,setupView:a,state:r}}function _W(n){const e=new ebe(n),t=[],r=[];function i(f){h.camera=f,t.length=0,r.length=0}function s(f){t.push(f)}function o(f){r.push(f)}function l(){e.setup(t)}function a(f){e.setupView(t,f)}const h={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:h,setupLights:l,setupLightsView:a,pushLight:s,pushShadow:o}}function tbe(n){let e=new WeakMap;function t(i,s=0){const o=e.get(i);let l;return o===void 0?(l=new _W(n),e.set(i,[l])):s>=o.length?(l=new _W(n),o.push(l)):l=o[s],l}function r(){e=new WeakMap}return{get:t,dispose:r}}class f6 extends ya{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=ane,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class d6 extends ya{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const nbe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,rbe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function ibe(n,e,t){let r=new eE;const i=new nn,s=new nn,o=new Rs,l=new f6({depthPacking:one}),a=new d6,h={},f=t.maxTextureSize,p={[kh]:Ic,[Ic]:kh,[Ac]:Ac},v=new Ia({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new nn},radius:{value:4}},vertexShader:nbe,fragmentShader:rbe}),y=v.clone();y.defines.HORIZONTAL_PASS=1;const S=new Xr;S.setAttribute("position",new ki(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const C=new Ri(S,v),M=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=sD;let E=this.type;this.render=function(Z,Q,re){if(M.enabled===!1||M.autoUpdate===!1&&M.needsUpdate===!1||Z.length===0)return;const ie=n.getRenderTarget(),oe=n.getActiveCubeFace(),fe=n.getActiveMipmapLevel(),Se=n.state;Se.setBlending(cp),Se.buffers.color.setClear(1,1,1,1),Se.buffers.depth.setTest(!0),Se.setScissorTest(!1);const Ee=E!==Of&&this.type===Of,Ie=E===Of&&this.type!==Of;for(let He=0,Re=Z.length;He<Re;He++){const st=Z[He],_e=st.shadow;if(_e===void 0){console.warn("THREE.WebGLShadowMap:",st,"has no shadow.");continue}if(_e.autoUpdate===!1&&_e.needsUpdate===!1)continue;i.copy(_e.mapSize);const We=_e.getFrameExtents();if(i.multiply(We),s.copy(_e.mapSize),(i.x>f||i.y>f)&&(i.x>f&&(s.x=Math.floor(f/We.x),i.x=s.x*We.x,_e.mapSize.x=s.x),i.y>f&&(s.y=Math.floor(f/We.y),i.y=s.y*We.y,_e.mapSize.y=s.y)),_e.map===null||Ee===!0||Ie===!0){const vt=this.type!==Of?{minFilter:Ao,magFilter:Ao}:{};_e.map!==null&&_e.map.dispose(),_e.map=new Sl(i.x,i.y,vt),_e.map.texture.name=st.name+".shadowMap",_e.camera.updateProjectionMatrix()}n.setRenderTarget(_e.map),n.clear();const Ue=_e.getViewportCount();for(let vt=0;vt<Ue;vt++){const xt=_e.getViewport(vt);o.set(s.x*xt.x,s.y*xt.y,s.x*xt.z,s.y*xt.w),Se.viewport(o),_e.updateMatrices(st,vt),r=_e.getFrustum(),H(Q,re,_e.camera,st,this.type)}_e.isPointLightShadow!==!0&&this.type===Of&&L(_e,re),_e.needsUpdate=!1}E=this.type,M.needsUpdate=!1,n.setRenderTarget(ie,oe,fe)};function L(Z,Q){const re=e.update(C);v.defines.VSM_SAMPLES!==Z.blurSamples&&(v.defines.VSM_SAMPLES=Z.blurSamples,y.defines.VSM_SAMPLES=Z.blurSamples,v.needsUpdate=!0,y.needsUpdate=!0),Z.mapPass===null&&(Z.mapPass=new Sl(i.x,i.y)),v.uniforms.shadow_pass.value=Z.map.texture,v.uniforms.resolution.value=Z.mapSize,v.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.mapPass),n.clear(),n.renderBufferDirect(Q,null,re,v,C,null),y.uniforms.shadow_pass.value=Z.mapPass.texture,y.uniforms.resolution.value=Z.mapSize,y.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.map),n.clear(),n.renderBufferDirect(Q,null,re,y,C,null)}function k(Z,Q,re,ie){let oe=null;const fe=re.isPointLight===!0?Z.customDistanceMaterial:Z.customDepthMaterial;if(fe!==void 0)oe=fe;else if(oe=re.isPointLight===!0?a:l,n.localClippingEnabled&&Q.clipShadows===!0&&Array.isArray(Q.clippingPlanes)&&Q.clippingPlanes.length!==0||Q.displacementMap&&Q.displacementScale!==0||Q.alphaMap&&Q.alphaTest>0||Q.map&&Q.alphaTest>0){const Se=oe.uuid,Ee=Q.uuid;let Ie=h[Se];Ie===void 0&&(Ie={},h[Se]=Ie);let He=Ie[Ee];He===void 0&&(He=oe.clone(),Ie[Ee]=He,Q.addEventListener("dispose",X)),oe=He}if(oe.visible=Q.visible,oe.wireframe=Q.wireframe,ie===Of?oe.side=Q.shadowSide!==null?Q.shadowSide:Q.side:oe.side=Q.shadowSide!==null?Q.shadowSide:p[Q.side],oe.alphaMap=Q.alphaMap,oe.alphaTest=Q.alphaTest,oe.map=Q.map,oe.clipShadows=Q.clipShadows,oe.clippingPlanes=Q.clippingPlanes,oe.clipIntersection=Q.clipIntersection,oe.displacementMap=Q.displacementMap,oe.displacementScale=Q.displacementScale,oe.displacementBias=Q.displacementBias,oe.wireframeLinewidth=Q.wireframeLinewidth,oe.linewidth=Q.linewidth,re.isPointLight===!0&&oe.isMeshDistanceMaterial===!0){const Se=n.properties.get(oe);Se.light=re}return oe}function H(Z,Q,re,ie,oe){if(Z.visible===!1)return;if(Z.layers.test(Q.layers)&&(Z.isMesh||Z.isLine||Z.isPoints)&&(Z.castShadow||Z.receiveShadow&&oe===Of)&&(!Z.frustumCulled||r.intersectsObject(Z))){Z.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,Z.matrixWorld);const Ee=e.update(Z),Ie=Z.material;if(Array.isArray(Ie)){const He=Ee.groups;for(let Re=0,st=He.length;Re<st;Re++){const _e=He[Re],We=Ie[_e.materialIndex];if(We&&We.visible){const Ue=k(Z,We,ie,oe);Z.onBeforeShadow(n,Z,Q,re,Ee,Ue,_e),n.renderBufferDirect(re,null,Ee,Ue,Z,_e),Z.onAfterShadow(n,Z,Q,re,Ee,Ue,_e)}}}else if(Ie.visible){const He=k(Z,Ie,ie,oe);Z.onBeforeShadow(n,Z,Q,re,Ee,He,null),n.renderBufferDirect(re,null,Ee,He,Z,null),Z.onAfterShadow(n,Z,Q,re,Ee,He,null)}}const Se=Z.children;for(let Ee=0,Ie=Se.length;Ee<Ie;Ee++)H(Se[Ee],Q,re,ie,oe)}function X(Z){Z.target.removeEventListener("dispose",X);for(const re in h){const ie=h[re],oe=Z.target.uuid;oe in ie&&(ie[oe].dispose(),delete ie[oe])}}}function sbe(n){function e(){let Fe=!1;const Lt=new Rs;let Kt=null;const un=new Rs(0,0,0,0);return{setMask:function(Cn){Kt!==Cn&&!Fe&&(n.colorMask(Cn,Cn,Cn,Cn),Kt=Cn)},setLocked:function(Cn){Fe=Cn},setClear:function(Cn,Ar,Vr,hs,Ls){Ls===!0&&(Cn*=hs,Ar*=hs,Vr*=hs),Lt.set(Cn,Ar,Vr,hs),un.equals(Lt)===!1&&(n.clearColor(Cn,Ar,Vr,hs),un.copy(Lt))},reset:function(){Fe=!1,Kt=null,un.set(-1,0,0,0)}}}function t(){let Fe=!1,Lt=null,Kt=null,un=null;return{setTest:function(Cn){Cn?Qt(n.DEPTH_TEST):rn(n.DEPTH_TEST)},setMask:function(Cn){Lt!==Cn&&!Fe&&(n.depthMask(Cn),Lt=Cn)},setFunc:function(Cn){if(Kt!==Cn){switch(Cn){case Vte:n.depthFunc(n.NEVER);break;case Hte:n.depthFunc(n.ALWAYS);break;case jte:n.depthFunc(n.LESS);break;case YT:n.depthFunc(n.LEQUAL);break;case Wte:n.depthFunc(n.EQUAL);break;case $te:n.depthFunc(n.GEQUAL);break;case Xte:n.depthFunc(n.GREATER);break;case qte:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Kt=Cn}},setLocked:function(Cn){Fe=Cn},setClear:function(Cn){un!==Cn&&(n.clearDepth(Cn),un=Cn)},reset:function(){Fe=!1,Lt=null,Kt=null,un=null}}}function r(){let Fe=!1,Lt=null,Kt=null,un=null,Cn=null,Ar=null,Vr=null,hs=null,Ls=null;return{setTest:function(hi){Fe||(hi?Qt(n.STENCIL_TEST):rn(n.STENCIL_TEST))},setMask:function(hi){Lt!==hi&&!Fe&&(n.stencilMask(hi),Lt=hi)},setFunc:function(hi,Tt,xe){(Kt!==hi||un!==Tt||Cn!==xe)&&(n.stencilFunc(hi,Tt,xe),Kt=hi,un=Tt,Cn=xe)},setOp:function(hi,Tt,xe){(Ar!==hi||Vr!==Tt||hs!==xe)&&(n.stencilOp(hi,Tt,xe),Ar=hi,Vr=Tt,hs=xe)},setLocked:function(hi){Fe=hi},setClear:function(hi){Ls!==hi&&(n.clearStencil(hi),Ls=hi)},reset:function(){Fe=!1,Lt=null,Kt=null,un=null,Cn=null,Ar=null,Vr=null,hs=null,Ls=null}}}const i=new e,s=new t,o=new r,l=new WeakMap,a=new WeakMap;let h={},f={},p=new WeakMap,v=[],y=null,S=!1,C=null,M=null,E=null,L=null,k=null,H=null,X=null,Z=new Vn(0,0,0),Q=0,re=!1,ie=null,oe=null,fe=null,Se=null,Ee=null;const Ie=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let He=!1,Re=0;const st=n.getParameter(n.VERSION);st.indexOf("WebGL")!==-1?(Re=parseFloat(/^WebGL (\d)/.exec(st)[1]),He=Re>=1):st.indexOf("OpenGL ES")!==-1&&(Re=parseFloat(/^OpenGL ES (\d)/.exec(st)[1]),He=Re>=2);let _e=null,We={};const Ue=n.getParameter(n.SCISSOR_BOX),vt=n.getParameter(n.VIEWPORT),xt=new Rs().fromArray(Ue),Vt=new Rs().fromArray(vt);function lt(Fe,Lt,Kt,un){const Cn=new Uint8Array(4),Ar=n.createTexture();n.bindTexture(Fe,Ar),n.texParameteri(Fe,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Fe,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Vr=0;Vr<Kt;Vr++)Fe===n.TEXTURE_3D||Fe===n.TEXTURE_2D_ARRAY?n.texImage3D(Lt,0,n.RGBA,1,1,un,0,n.RGBA,n.UNSIGNED_BYTE,Cn):n.texImage2D(Lt+Vr,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,Cn);return Ar}const Ht={};Ht[n.TEXTURE_2D]=lt(n.TEXTURE_2D,n.TEXTURE_2D,1),Ht[n.TEXTURE_CUBE_MAP]=lt(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ht[n.TEXTURE_2D_ARRAY]=lt(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ht[n.TEXTURE_3D]=lt(n.TEXTURE_3D,n.TEXTURE_3D,1,1),i.setClear(0,0,0,1),s.setClear(1),o.setClear(0),Qt(n.DEPTH_TEST),s.setFunc(YT),St(!1),Jt(P4),Qt(n.CULL_FACE),mn(cp);function Qt(Fe){h[Fe]!==!0&&(n.enable(Fe),h[Fe]=!0)}function rn(Fe){h[Fe]!==!1&&(n.disable(Fe),h[Fe]=!1)}function jn(Fe,Lt){return f[Fe]!==Lt?(n.bindFramebuffer(Fe,Lt),f[Fe]=Lt,Fe===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=Lt),Fe===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=Lt),!0):!1}function Bn(Fe,Lt){let Kt=v,un=!1;if(Fe){Kt=p.get(Lt),Kt===void 0&&(Kt=[],p.set(Lt,Kt));const Cn=Fe.textures;if(Kt.length!==Cn.length||Kt[0]!==n.COLOR_ATTACHMENT0){for(let Ar=0,Vr=Cn.length;Ar<Vr;Ar++)Kt[Ar]=n.COLOR_ATTACHMENT0+Ar;Kt.length=Cn.length,un=!0}}else Kt[0]!==n.BACK&&(Kt[0]=n.BACK,un=!0);un&&n.drawBuffers(Kt)}function Tn(Fe){return y!==Fe?(n.useProgram(Fe),y=Fe,!0):!1}const Le={[zv]:n.FUNC_ADD,[Tte]:n.FUNC_SUBTRACT,[Mte]:n.FUNC_REVERSE_SUBTRACT};Le[Ete]=n.MIN,Le[Cte]=n.MAX;const qe={[Ite]:n.ZERO,[Rte]:n.ONE,[Pte]:n.SRC_COLOR,[JR]:n.SRC_ALPHA,[Fte]:n.SRC_ALPHA_SATURATE,[kte]:n.DST_COLOR,[Dte]:n.DST_ALPHA,[Lte]:n.ONE_MINUS_SRC_COLOR,[QR]:n.ONE_MINUS_SRC_ALPHA,[Ote]:n.ONE_MINUS_DST_COLOR,[Bte]:n.ONE_MINUS_DST_ALPHA,[Nte]:n.CONSTANT_COLOR,[zte]:n.ONE_MINUS_CONSTANT_COLOR,[Ute]:n.CONSTANT_ALPHA,[Gte]:n.ONE_MINUS_CONSTANT_ALPHA};function mn(Fe,Lt,Kt,un,Cn,Ar,Vr,hs,Ls,hi){if(Fe===cp){S===!0&&(rn(n.BLEND),S=!1);return}if(S===!1&&(Qt(n.BLEND),S=!0),Fe!==Ate){if(Fe!==C||hi!==re){if((M!==zv||k!==zv)&&(n.blendEquation(n.FUNC_ADD),M=zv,k=zv),hi)switch(Fe){case ky:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case rw:n.blendFunc(n.ONE,n.ONE);break;case L4:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case D4:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Fe);break}else switch(Fe){case ky:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case rw:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case L4:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case D4:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Fe);break}E=null,L=null,H=null,X=null,Z.set(0,0,0),Q=0,C=Fe,re=hi}return}Cn=Cn||Lt,Ar=Ar||Kt,Vr=Vr||un,(Lt!==M||Cn!==k)&&(n.blendEquationSeparate(Le[Lt],Le[Cn]),M=Lt,k=Cn),(Kt!==E||un!==L||Ar!==H||Vr!==X)&&(n.blendFuncSeparate(qe[Kt],qe[un],qe[Ar],qe[Vr]),E=Kt,L=un,H=Ar,X=Vr),(hs.equals(Z)===!1||Ls!==Q)&&(n.blendColor(hs.r,hs.g,hs.b,Ls),Z.copy(hs),Q=Ls),C=Fe,re=!1}function cn(Fe,Lt){Fe.side===Ac?rn(n.CULL_FACE):Qt(n.CULL_FACE);let Kt=Fe.side===Ic;Lt&&(Kt=!Kt),St(Kt),Fe.blending===ky&&Fe.transparent===!1?mn(cp):mn(Fe.blending,Fe.blendEquation,Fe.blendSrc,Fe.blendDst,Fe.blendEquationAlpha,Fe.blendSrcAlpha,Fe.blendDstAlpha,Fe.blendColor,Fe.blendAlpha,Fe.premultipliedAlpha),s.setFunc(Fe.depthFunc),s.setTest(Fe.depthTest),s.setMask(Fe.depthWrite),i.setMask(Fe.colorWrite);const un=Fe.stencilWrite;o.setTest(un),un&&(o.setMask(Fe.stencilWriteMask),o.setFunc(Fe.stencilFunc,Fe.stencilRef,Fe.stencilFuncMask),o.setOp(Fe.stencilFail,Fe.stencilZFail,Fe.stencilZPass)),Gn(Fe.polygonOffset,Fe.polygonOffsetFactor,Fe.polygonOffsetUnits),Fe.alphaToCoverage===!0?Qt(n.SAMPLE_ALPHA_TO_COVERAGE):rn(n.SAMPLE_ALPHA_TO_COVERAGE)}function St(Fe){ie!==Fe&&(Fe?n.frontFace(n.CW):n.frontFace(n.CCW),ie=Fe)}function Jt(Fe){Fe!==bte?(Qt(n.CULL_FACE),Fe!==oe&&(Fe===P4?n.cullFace(n.BACK):Fe===wte?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):rn(n.CULL_FACE),oe=Fe}function kn(Fe){Fe!==fe&&(He&&n.lineWidth(Fe),fe=Fe)}function Gn(Fe,Lt,Kt){Fe?(Qt(n.POLYGON_OFFSET_FILL),(Se!==Lt||Ee!==Kt)&&(n.polygonOffset(Lt,Kt),Se=Lt,Ee=Kt)):rn(n.POLYGON_OFFSET_FILL)}function sn(Fe){Fe?Qt(n.SCISSOR_TEST):rn(n.SCISSOR_TEST)}function ot(Fe){Fe===void 0&&(Fe=n.TEXTURE0+Ie-1),_e!==Fe&&(n.activeTexture(Fe),_e=Fe)}function Ge(Fe,Lt,Kt){Kt===void 0&&(_e===null?Kt=n.TEXTURE0+Ie-1:Kt=_e);let un=We[Kt];un===void 0&&(un={type:void 0,texture:void 0},We[Kt]=un),(un.type!==Fe||un.texture!==Lt)&&(_e!==Kt&&(n.activeTexture(Kt),_e=Kt),n.bindTexture(Fe,Lt||Ht[Fe]),un.type=Fe,un.texture=Lt)}function Xt(){const Fe=We[_e];Fe!==void 0&&Fe.type!==void 0&&(n.bindTexture(Fe.type,null),Fe.type=void 0,Fe.texture=void 0)}function An(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Sn(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function jt(){try{n.texSubImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function mr(){try{n.texSubImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Un(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function tr(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Sr(){try{n.texStorage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Ln(){try{n.texStorage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function ir(){try{n.texImage2D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function ui(){try{n.texImage3D.apply(n,arguments)}catch(Fe){console.error("THREE.WebGLState:",Fe)}}function Fr(Fe){xt.equals(Fe)===!1&&(n.scissor(Fe.x,Fe.y,Fe.z,Fe.w),xt.copy(Fe))}function ar(Fe){Vt.equals(Fe)===!1&&(n.viewport(Fe.x,Fe.y,Fe.z,Fe.w),Vt.copy(Fe))}function Nr(Fe,Lt){let Kt=a.get(Lt);Kt===void 0&&(Kt=new WeakMap,a.set(Lt,Kt));let un=Kt.get(Fe);un===void 0&&(un=n.getUniformBlockIndex(Lt,Fe.name),Kt.set(Fe,un))}function Hr(Fe,Lt){const un=a.get(Lt).get(Fe);l.get(Lt)!==un&&(n.uniformBlockBinding(Lt,un,Fe.__bindingPointIndex),l.set(Lt,un))}function xi(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},_e=null,We={},f={},p=new WeakMap,v=[],y=null,S=!1,C=null,M=null,E=null,L=null,k=null,H=null,X=null,Z=new Vn(0,0,0),Q=0,re=!1,ie=null,oe=null,fe=null,Se=null,Ee=null,xt.set(0,0,n.canvas.width,n.canvas.height),Vt.set(0,0,n.canvas.width,n.canvas.height),i.reset(),s.reset(),o.reset()}return{buffers:{color:i,depth:s,stencil:o},enable:Qt,disable:rn,bindFramebuffer:jn,drawBuffers:Bn,useProgram:Tn,setBlending:mn,setMaterial:cn,setFlipSided:St,setCullFace:Jt,setLineWidth:kn,setPolygonOffset:Gn,setScissorTest:sn,activeTexture:ot,bindTexture:Ge,unbindTexture:Xt,compressedTexImage2D:An,compressedTexImage3D:Sn,texImage2D:ir,texImage3D:ui,updateUBOMapping:Nr,uniformBlockBinding:Hr,texStorage2D:Sr,texStorage3D:Ln,texSubImage2D:jt,texSubImage3D:mr,compressedTexSubImage2D:Un,compressedTexSubImage3D:tr,scissor:Fr,viewport:ar,reset:xi}}function abe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function obe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function lbe(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function z4(n,e,t,r){const i=cbe(r);switch(t){case YU:return n*e;case JU:return n*e;case QU:return n*e*2;case qM:return n*e/i.components*i.byteLength;case ZM:return n*e/i.components*i.byteLength;case e6:return n*e*2/i.components*i.byteLength;case fD:return n*e*2/i.components*i.byteLength;case KU:return n*e*3/i.components*i.byteLength;case Xl:return n*e*4/i.components*i.byteLength;case dD:return n*e*4/i.components*i.byteLength;case JA:case QA:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case eT:case tT:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case tP:case rP:return Math.max(n,16)*Math.max(e,8)/4;case eP:case nP:return Math.max(n,8)*Math.max(e,8)/2;case iP:case sP:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case aP:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case oP:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case lP:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case cP:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case uP:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case hP:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case fP:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case dP:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case pP:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case mP:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case gP:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case vP:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case _P:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case yP:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case xP:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case nT:case bP:case wP:return Math.ceil(n/4)*Math.ceil(e/4)*16;case t6:case SP:return Math.ceil(n/4)*Math.ceil(e/4)*8;case AP:case TP:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function cbe(n){switch(n){case Kf:case XU:return{byteLength:1,components:1};case iw:case qU:case Ih:return{byteLength:2,components:1};case uD:case hD:return{byteLength:2,components:4};case Xm:case cD:case Mc:return{byteLength:4,components:1};case ZU:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}const ube={contain:abe,cover:obe,fill:lbe,getByteLength:z4};function hbe(n,e,t,r,i,s,o){const l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,a=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new nn,f=new WeakMap;let p;const v=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function S(ot,Ge){return y?new OffscreenCanvas(ot,Ge):sM("canvas")}function C(ot,Ge,Xt){let An=1;const Sn=sn(ot);if((Sn.width>Xt||Sn.height>Xt)&&(An=Xt/Math.max(Sn.width,Sn.height)),An<1)if(typeof HTMLImageElement<"u"&&ot instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ot instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ot instanceof ImageBitmap||typeof VideoFrame<"u"&&ot instanceof VideoFrame){const jt=Math.floor(An*Sn.width),mr=Math.floor(An*Sn.height);p===void 0&&(p=S(jt,mr));const Un=Ge?S(jt,mr):p;return Un.width=jt,Un.height=mr,Un.getContext("2d").drawImage(ot,0,0,jt,mr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Sn.width+"x"+Sn.height+") to ("+jt+"x"+mr+")."),Un}else return"data"in ot&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Sn.width+"x"+Sn.height+")."),ot;return ot}function M(ot){return ot.generateMipmaps&&ot.minFilter!==Ao&&ot.minFilter!==Ca}function E(ot){n.generateMipmap(ot)}function L(ot,Ge,Xt,An,Sn=!1){if(ot!==null){if(n[ot]!==void 0)return n[ot];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ot+"'")}let jt=Ge;if(Ge===n.RED&&(Xt===n.FLOAT&&(jt=n.R32F),Xt===n.HALF_FLOAT&&(jt=n.R16F),Xt===n.UNSIGNED_BYTE&&(jt=n.R8)),Ge===n.RED_INTEGER&&(Xt===n.UNSIGNED_BYTE&&(jt=n.R8UI),Xt===n.UNSIGNED_SHORT&&(jt=n.R16UI),Xt===n.UNSIGNED_INT&&(jt=n.R32UI),Xt===n.BYTE&&(jt=n.R8I),Xt===n.SHORT&&(jt=n.R16I),Xt===n.INT&&(jt=n.R32I)),Ge===n.RG&&(Xt===n.FLOAT&&(jt=n.RG32F),Xt===n.HALF_FLOAT&&(jt=n.RG16F),Xt===n.UNSIGNED_BYTE&&(jt=n.RG8)),Ge===n.RG_INTEGER&&(Xt===n.UNSIGNED_BYTE&&(jt=n.RG8UI),Xt===n.UNSIGNED_SHORT&&(jt=n.RG16UI),Xt===n.UNSIGNED_INT&&(jt=n.RG32UI),Xt===n.BYTE&&(jt=n.RG8I),Xt===n.SHORT&&(jt=n.RG16I),Xt===n.INT&&(jt=n.RG32I)),Ge===n.RGB&&Xt===n.UNSIGNED_INT_5_9_9_9_REV&&(jt=n.RGB9_E5),Ge===n.RGBA){const mr=Sn?eM:gs.getTransfer(An);Xt===n.FLOAT&&(jt=n.RGBA32F),Xt===n.HALF_FLOAT&&(jt=n.RGBA16F),Xt===n.UNSIGNED_BYTE&&(jt=mr===na?n.SRGB8_ALPHA8:n.RGBA8),Xt===n.UNSIGNED_SHORT_4_4_4_4&&(jt=n.RGBA4),Xt===n.UNSIGNED_SHORT_5_5_5_1&&(jt=n.RGB5_A1)}return(jt===n.R16F||jt===n.R32F||jt===n.RG16F||jt===n.RG32F||jt===n.RGBA16F||jt===n.RGBA32F)&&e.get("EXT_color_buffer_float"),jt}function k(ot,Ge){let Xt;return ot?Ge===null||Ge===Xm||Ge===ex?Xt=n.DEPTH24_STENCIL8:Ge===Mc?Xt=n.DEPTH32F_STENCIL8:Ge===iw&&(Xt=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):Ge===null||Ge===Xm||Ge===ex?Xt=n.DEPTH_COMPONENT24:Ge===Mc?Xt=n.DEPTH_COMPONENT32F:Ge===iw&&(Xt=n.DEPTH_COMPONENT16),Xt}function H(ot,Ge){return M(ot)===!0||ot.isFramebufferTexture&&ot.minFilter!==Ao&&ot.minFilter!==Ca?Math.log2(Math.max(Ge.width,Ge.height))+1:ot.mipmaps!==void 0&&ot.mipmaps.length>0?ot.mipmaps.length:ot.isCompressedTexture&&Array.isArray(ot.image)?Ge.mipmaps.length:1}function X(ot){const Ge=ot.target;Ge.removeEventListener("dispose",X),Q(Ge),Ge.isVideoTexture&&f.delete(Ge)}function Z(ot){const Ge=ot.target;Ge.removeEventListener("dispose",Z),ie(Ge)}function Q(ot){const Ge=r.get(ot);if(Ge.__webglInit===void 0)return;const Xt=ot.source,An=v.get(Xt);if(An){const Sn=An[Ge.__cacheKey];Sn.usedTimes--,Sn.usedTimes===0&&re(ot),Object.keys(An).length===0&&v.delete(Xt)}r.remove(ot)}function re(ot){const Ge=r.get(ot);n.deleteTexture(Ge.__webglTexture);const Xt=ot.source,An=v.get(Xt);delete An[Ge.__cacheKey],o.memory.textures--}function ie(ot){const Ge=r.get(ot);if(ot.depthTexture&&ot.depthTexture.dispose(),ot.isWebGLCubeRenderTarget)for(let An=0;An<6;An++){if(Array.isArray(Ge.__webglFramebuffer[An]))for(let Sn=0;Sn<Ge.__webglFramebuffer[An].length;Sn++)n.deleteFramebuffer(Ge.__webglFramebuffer[An][Sn]);else n.deleteFramebuffer(Ge.__webglFramebuffer[An]);Ge.__webglDepthbuffer&&n.deleteRenderbuffer(Ge.__webglDepthbuffer[An])}else{if(Array.isArray(Ge.__webglFramebuffer))for(let An=0;An<Ge.__webglFramebuffer.length;An++)n.deleteFramebuffer(Ge.__webglFramebuffer[An]);else n.deleteFramebuffer(Ge.__webglFramebuffer);if(Ge.__webglDepthbuffer&&n.deleteRenderbuffer(Ge.__webglDepthbuffer),Ge.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Ge.__webglMultisampledFramebuffer),Ge.__webglColorRenderbuffer)for(let An=0;An<Ge.__webglColorRenderbuffer.length;An++)Ge.__webglColorRenderbuffer[An]&&n.deleteRenderbuffer(Ge.__webglColorRenderbuffer[An]);Ge.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Ge.__webglDepthRenderbuffer)}const Xt=ot.textures;for(let An=0,Sn=Xt.length;An<Sn;An++){const jt=r.get(Xt[An]);jt.__webglTexture&&(n.deleteTexture(jt.__webglTexture),o.memory.textures--),r.remove(Xt[An])}r.remove(ot)}let oe=0;function fe(){oe=0}function Se(){const ot=oe;return ot>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+ot+" texture units while this GPU supports only "+i.maxTextures),oe+=1,ot}function Ee(ot){const Ge=[];return Ge.push(ot.wrapS),Ge.push(ot.wrapT),Ge.push(ot.wrapR||0),Ge.push(ot.magFilter),Ge.push(ot.minFilter),Ge.push(ot.anisotropy),Ge.push(ot.internalFormat),Ge.push(ot.format),Ge.push(ot.type),Ge.push(ot.generateMipmaps),Ge.push(ot.premultiplyAlpha),Ge.push(ot.flipY),Ge.push(ot.unpackAlignment),Ge.push(ot.colorSpace),Ge.join()}function Ie(ot,Ge){const Xt=r.get(ot);if(ot.isVideoTexture&&kn(ot),ot.isRenderTargetTexture===!1&&ot.version>0&&Xt.__version!==ot.version){const An=ot.image;if(An===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(An.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Vt(Xt,ot,Ge);return}}t.bindTexture(n.TEXTURE_2D,Xt.__webglTexture,n.TEXTURE0+Ge)}function He(ot,Ge){const Xt=r.get(ot);if(ot.version>0&&Xt.__version!==ot.version){Vt(Xt,ot,Ge);return}t.bindTexture(n.TEXTURE_2D_ARRAY,Xt.__webglTexture,n.TEXTURE0+Ge)}function Re(ot,Ge){const Xt=r.get(ot);if(ot.version>0&&Xt.__version!==ot.version){Vt(Xt,ot,Ge);return}t.bindTexture(n.TEXTURE_3D,Xt.__webglTexture,n.TEXTURE0+Ge)}function st(ot,Ge){const Xt=r.get(ot);if(ot.version>0&&Xt.__version!==ot.version){lt(Xt,ot,Ge);return}t.bindTexture(n.TEXTURE_CUBE_MAP,Xt.__webglTexture,n.TEXTURE0+Ge)}const _e={[Oh]:n.REPEAT,[ou]:n.CLAMP_TO_EDGE,[Qy]:n.MIRRORED_REPEAT},We={[Ao]:n.NEAREST,[XM]:n.NEAREST_MIPMAP_NEAREST,[Wv]:n.NEAREST_MIPMAP_LINEAR,[Ca]:n.LINEAR,[Oy]:n.LINEAR_MIPMAP_NEAREST,[lu]:n.LINEAR_MIPMAP_LINEAR},Ue={[cne]:n.NEVER,[mne]:n.ALWAYS,[une]:n.LESS,[i6]:n.LEQUAL,[hne]:n.EQUAL,[pne]:n.GEQUAL,[fne]:n.GREATER,[dne]:n.NOTEQUAL};function vt(ot,Ge){if(Ge.type===Mc&&e.has("OES_texture_float_linear")===!1&&(Ge.magFilter===Ca||Ge.magFilter===Oy||Ge.magFilter===Wv||Ge.magFilter===lu||Ge.minFilter===Ca||Ge.minFilter===Oy||Ge.minFilter===Wv||Ge.minFilter===lu)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(ot,n.TEXTURE_WRAP_S,_e[Ge.wrapS]),n.texParameteri(ot,n.TEXTURE_WRAP_T,_e[Ge.wrapT]),(ot===n.TEXTURE_3D||ot===n.TEXTURE_2D_ARRAY)&&n.texParameteri(ot,n.TEXTURE_WRAP_R,_e[Ge.wrapR]),n.texParameteri(ot,n.TEXTURE_MAG_FILTER,We[Ge.magFilter]),n.texParameteri(ot,n.TEXTURE_MIN_FILTER,We[Ge.minFilter]),Ge.compareFunction&&(n.texParameteri(ot,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(ot,n.TEXTURE_COMPARE_FUNC,Ue[Ge.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(Ge.magFilter===Ao||Ge.minFilter!==Wv&&Ge.minFilter!==lu||Ge.type===Mc&&e.has("OES_texture_float_linear")===!1)return;if(Ge.anisotropy>1||r.get(Ge).__currentAnisotropy){const Xt=e.get("EXT_texture_filter_anisotropic");n.texParameterf(ot,Xt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Ge.anisotropy,i.getMaxAnisotropy())),r.get(Ge).__currentAnisotropy=Ge.anisotropy}}}function xt(ot,Ge){let Xt=!1;ot.__webglInit===void 0&&(ot.__webglInit=!0,Ge.addEventListener("dispose",X));const An=Ge.source;let Sn=v.get(An);Sn===void 0&&(Sn={},v.set(An,Sn));const jt=Ee(Ge);if(jt!==ot.__cacheKey){Sn[jt]===void 0&&(Sn[jt]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,Xt=!0),Sn[jt].usedTimes++;const mr=Sn[ot.__cacheKey];mr!==void 0&&(Sn[ot.__cacheKey].usedTimes--,mr.usedTimes===0&&re(Ge)),ot.__cacheKey=jt,ot.__webglTexture=Sn[jt].texture}return Xt}function Vt(ot,Ge,Xt){let An=n.TEXTURE_2D;(Ge.isDataArrayTexture||Ge.isCompressedArrayTexture)&&(An=n.TEXTURE_2D_ARRAY),Ge.isData3DTexture&&(An=n.TEXTURE_3D);const Sn=xt(ot,Ge),jt=Ge.source;t.bindTexture(An,ot.__webglTexture,n.TEXTURE0+Xt);const mr=r.get(jt);if(jt.version!==mr.__version||Sn===!0){t.activeTexture(n.TEXTURE0+Xt);const Un=gs.getPrimaries(gs.workingColorSpace),tr=Ge.colorSpace===Em?null:gs.getPrimaries(Ge.colorSpace),Sr=Ge.colorSpace===Em||Un===tr?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ge.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ge.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ge.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Sr);let Ln=C(Ge.image,!1,i.maxTextureSize);Ln=Gn(Ge,Ln);const ir=s.convert(Ge.format,Ge.colorSpace),ui=s.convert(Ge.type);let Fr=L(Ge.internalFormat,ir,ui,Ge.colorSpace,Ge.isVideoTexture);vt(An,Ge);let ar;const Nr=Ge.mipmaps,Hr=Ge.isVideoTexture!==!0,xi=mr.__version===void 0||Sn===!0,Fe=jt.dataReady,Lt=H(Ge,Ln);if(Ge.isDepthTexture)Fr=k(Ge.format===tx,Ge.type),xi&&(Hr?t.texStorage2D(n.TEXTURE_2D,1,Fr,Ln.width,Ln.height):t.texImage2D(n.TEXTURE_2D,0,Fr,Ln.width,Ln.height,0,ir,ui,null));else if(Ge.isDataTexture)if(Nr.length>0){Hr&&xi&&t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Nr[0].width,Nr[0].height);for(let Kt=0,un=Nr.length;Kt<un;Kt++)ar=Nr[Kt],Hr?Fe&&t.texSubImage2D(n.TEXTURE_2D,Kt,0,0,ar.width,ar.height,ir,ui,ar.data):t.texImage2D(n.TEXTURE_2D,Kt,Fr,ar.width,ar.height,0,ir,ui,ar.data);Ge.generateMipmaps=!1}else Hr?(xi&&t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Ln.width,Ln.height),Fe&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,Ln.width,Ln.height,ir,ui,Ln.data)):t.texImage2D(n.TEXTURE_2D,0,Fr,Ln.width,Ln.height,0,ir,ui,Ln.data);else if(Ge.isCompressedTexture)if(Ge.isCompressedArrayTexture){Hr&&xi&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Lt,Fr,Nr[0].width,Nr[0].height,Ln.depth);for(let Kt=0,un=Nr.length;Kt<un;Kt++)if(ar=Nr[Kt],Ge.format!==Xl)if(ir!==null)if(Hr){if(Fe)if(Ge.layerUpdates.size>0){const Cn=z4(ar.width,ar.height,Ge.format,Ge.type);for(const Ar of Ge.layerUpdates){const Vr=ar.data.subarray(Ar*Cn/ar.data.BYTES_PER_ELEMENT,(Ar+1)*Cn/ar.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Kt,0,0,Ar,ar.width,ar.height,1,ir,Vr,0,0)}Ge.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Kt,0,0,0,ar.width,ar.height,Ln.depth,ir,ar.data,0,0)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Kt,Fr,ar.width,ar.height,Ln.depth,0,ar.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Hr?Fe&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Kt,0,0,0,ar.width,ar.height,Ln.depth,ir,ui,ar.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Kt,Fr,ar.width,ar.height,Ln.depth,0,ir,ui,ar.data)}else{Hr&&xi&&t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Nr[0].width,Nr[0].height);for(let Kt=0,un=Nr.length;Kt<un;Kt++)ar=Nr[Kt],Ge.format!==Xl?ir!==null?Hr?Fe&&t.compressedTexSubImage2D(n.TEXTURE_2D,Kt,0,0,ar.width,ar.height,ir,ar.data):t.compressedTexImage2D(n.TEXTURE_2D,Kt,Fr,ar.width,ar.height,0,ar.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Hr?Fe&&t.texSubImage2D(n.TEXTURE_2D,Kt,0,0,ar.width,ar.height,ir,ui,ar.data):t.texImage2D(n.TEXTURE_2D,Kt,Fr,ar.width,ar.height,0,ir,ui,ar.data)}else if(Ge.isDataArrayTexture)if(Hr){if(xi&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Lt,Fr,Ln.width,Ln.height,Ln.depth),Fe)if(Ge.layerUpdates.size>0){const Kt=z4(Ln.width,Ln.height,Ge.format,Ge.type);for(const un of Ge.layerUpdates){const Cn=Ln.data.subarray(un*Kt/Ln.data.BYTES_PER_ELEMENT,(un+1)*Kt/Ln.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,un,Ln.width,Ln.height,1,ir,ui,Cn)}Ge.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Ln.width,Ln.height,Ln.depth,ir,ui,Ln.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Fr,Ln.width,Ln.height,Ln.depth,0,ir,ui,Ln.data);else if(Ge.isData3DTexture)Hr?(xi&&t.texStorage3D(n.TEXTURE_3D,Lt,Fr,Ln.width,Ln.height,Ln.depth),Fe&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Ln.width,Ln.height,Ln.depth,ir,ui,Ln.data)):t.texImage3D(n.TEXTURE_3D,0,Fr,Ln.width,Ln.height,Ln.depth,0,ir,ui,Ln.data);else if(Ge.isFramebufferTexture){if(xi)if(Hr)t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Ln.width,Ln.height);else{let Kt=Ln.width,un=Ln.height;for(let Cn=0;Cn<Lt;Cn++)t.texImage2D(n.TEXTURE_2D,Cn,Fr,Kt,un,0,ir,ui,null),Kt>>=1,un>>=1}}else if(Nr.length>0){if(Hr&&xi){const Kt=sn(Nr[0]);t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Kt.width,Kt.height)}for(let Kt=0,un=Nr.length;Kt<un;Kt++)ar=Nr[Kt],Hr?Fe&&t.texSubImage2D(n.TEXTURE_2D,Kt,0,0,ir,ui,ar):t.texImage2D(n.TEXTURE_2D,Kt,Fr,ir,ui,ar);Ge.generateMipmaps=!1}else if(Hr){if(xi){const Kt=sn(Ln);t.texStorage2D(n.TEXTURE_2D,Lt,Fr,Kt.width,Kt.height)}Fe&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,ir,ui,Ln)}else t.texImage2D(n.TEXTURE_2D,0,Fr,ir,ui,Ln);M(Ge)&&E(An),mr.__version=jt.version,Ge.onUpdate&&Ge.onUpdate(Ge)}ot.__version=Ge.version}function lt(ot,Ge,Xt){if(Ge.image.length!==6)return;const An=xt(ot,Ge),Sn=Ge.source;t.bindTexture(n.TEXTURE_CUBE_MAP,ot.__webglTexture,n.TEXTURE0+Xt);const jt=r.get(Sn);if(Sn.version!==jt.__version||An===!0){t.activeTexture(n.TEXTURE0+Xt);const mr=gs.getPrimaries(gs.workingColorSpace),Un=Ge.colorSpace===Em?null:gs.getPrimaries(Ge.colorSpace),tr=Ge.colorSpace===Em||mr===Un?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Ge.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ge.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Ge.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,tr);const Sr=Ge.isCompressedTexture||Ge.image[0].isCompressedTexture,Ln=Ge.image[0]&&Ge.image[0].isDataTexture,ir=[];for(let un=0;un<6;un++)!Sr&&!Ln?ir[un]=C(Ge.image[un],!0,i.maxCubemapSize):ir[un]=Ln?Ge.image[un].image:Ge.image[un],ir[un]=Gn(Ge,ir[un]);const ui=ir[0],Fr=s.convert(Ge.format,Ge.colorSpace),ar=s.convert(Ge.type),Nr=L(Ge.internalFormat,Fr,ar,Ge.colorSpace),Hr=Ge.isVideoTexture!==!0,xi=jt.__version===void 0||An===!0,Fe=Sn.dataReady;let Lt=H(Ge,ui);vt(n.TEXTURE_CUBE_MAP,Ge);let Kt;if(Sr){Hr&&xi&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Lt,Nr,ui.width,ui.height);for(let un=0;un<6;un++){Kt=ir[un].mipmaps;for(let Cn=0;Cn<Kt.length;Cn++){const Ar=Kt[Cn];Ge.format!==Xl?Fr!==null?Hr?Fe&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn,0,0,Ar.width,Ar.height,Fr,Ar.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn,Nr,Ar.width,Ar.height,0,Ar.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn,0,0,Ar.width,Ar.height,Fr,ar,Ar.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn,Nr,Ar.width,Ar.height,0,Fr,ar,Ar.data)}}}else{if(Kt=Ge.mipmaps,Hr&&xi){Kt.length>0&&Lt++;const un=sn(ir[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Lt,Nr,un.width,un.height)}for(let un=0;un<6;un++)if(Ln){Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,0,0,ir[un].width,ir[un].height,Fr,ar,ir[un].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,Nr,ir[un].width,ir[un].height,0,Fr,ar,ir[un].data);for(let Cn=0;Cn<Kt.length;Cn++){const Vr=Kt[Cn].image[un].image;Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn+1,0,0,Vr.width,Vr.height,Fr,ar,Vr.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn+1,Nr,Vr.width,Vr.height,0,Fr,ar,Vr.data)}}else{Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,0,0,Fr,ar,ir[un]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,0,Nr,Fr,ar,ir[un]);for(let Cn=0;Cn<Kt.length;Cn++){const Ar=Kt[Cn];Hr?Fe&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn+1,0,0,Fr,ar,Ar.image[un]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+un,Cn+1,Nr,Fr,ar,Ar.image[un])}}}M(Ge)&&E(n.TEXTURE_CUBE_MAP),jt.__version=Sn.version,Ge.onUpdate&&Ge.onUpdate(Ge)}ot.__version=Ge.version}function Ht(ot,Ge,Xt,An,Sn,jt){const mr=s.convert(Xt.format,Xt.colorSpace),Un=s.convert(Xt.type),tr=L(Xt.internalFormat,mr,Un,Xt.colorSpace);if(!r.get(Ge).__hasExternalTextures){const Ln=Math.max(1,Ge.width>>jt),ir=Math.max(1,Ge.height>>jt);Sn===n.TEXTURE_3D||Sn===n.TEXTURE_2D_ARRAY?t.texImage3D(Sn,jt,tr,Ln,ir,Ge.depth,0,mr,Un,null):t.texImage2D(Sn,jt,tr,Ln,ir,0,mr,Un,null)}t.bindFramebuffer(n.FRAMEBUFFER,ot),Jt(Ge)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,An,Sn,r.get(Xt).__webglTexture,0,St(Ge)):(Sn===n.TEXTURE_2D||Sn>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Sn<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,An,Sn,r.get(Xt).__webglTexture,jt),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Qt(ot,Ge,Xt){if(n.bindRenderbuffer(n.RENDERBUFFER,ot),Ge.depthBuffer){const An=Ge.depthTexture,Sn=An&&An.isDepthTexture?An.type:null,jt=k(Ge.stencilBuffer,Sn),mr=Ge.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Un=St(Ge);Jt(Ge)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Un,jt,Ge.width,Ge.height):Xt?n.renderbufferStorageMultisample(n.RENDERBUFFER,Un,jt,Ge.width,Ge.height):n.renderbufferStorage(n.RENDERBUFFER,jt,Ge.width,Ge.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,mr,n.RENDERBUFFER,ot)}else{const An=Ge.textures;for(let Sn=0;Sn<An.length;Sn++){const jt=An[Sn],mr=s.convert(jt.format,jt.colorSpace),Un=s.convert(jt.type),tr=L(jt.internalFormat,mr,Un,jt.colorSpace),Sr=St(Ge);Xt&&Jt(Ge)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Sr,tr,Ge.width,Ge.height):Jt(Ge)?l.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Sr,tr,Ge.width,Ge.height):n.renderbufferStorage(n.RENDERBUFFER,tr,Ge.width,Ge.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function rn(ot,Ge){if(Ge&&Ge.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,ot),!(Ge.depthTexture&&Ge.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(Ge.depthTexture).__webglTexture||Ge.depthTexture.image.width!==Ge.width||Ge.depthTexture.image.height!==Ge.height)&&(Ge.depthTexture.image.width=Ge.width,Ge.depthTexture.image.height=Ge.height,Ge.depthTexture.needsUpdate=!0),Ie(Ge.depthTexture,0);const An=r.get(Ge.depthTexture).__webglTexture,Sn=St(Ge);if(Ge.depthTexture.format===Fy)Jt(Ge)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,An,0,Sn):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,An,0);else if(Ge.depthTexture.format===tx)Jt(Ge)?l.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,An,0,Sn):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,An,0);else throw new Error("Unknown depthTexture format")}function jn(ot){const Ge=r.get(ot),Xt=ot.isWebGLCubeRenderTarget===!0;if(ot.depthTexture&&!Ge.__autoAllocateDepthBuffer){if(Xt)throw new Error("target.depthTexture not supported in Cube render targets");rn(Ge.__webglFramebuffer,ot)}else if(Xt){Ge.__webglDepthbuffer=[];for(let An=0;An<6;An++)t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer[An]),Ge.__webglDepthbuffer[An]=n.createRenderbuffer(),Qt(Ge.__webglDepthbuffer[An],ot,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,Ge.__webglFramebuffer),Ge.__webglDepthbuffer=n.createRenderbuffer(),Qt(Ge.__webglDepthbuffer,ot,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Bn(ot,Ge,Xt){const An=r.get(ot);Ge!==void 0&&Ht(An.__webglFramebuffer,ot,ot.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Xt!==void 0&&jn(ot)}function Tn(ot){const Ge=ot.texture,Xt=r.get(ot),An=r.get(Ge);ot.addEventListener("dispose",Z);const Sn=ot.textures,jt=ot.isWebGLCubeRenderTarget===!0,mr=Sn.length>1;if(mr||(An.__webglTexture===void 0&&(An.__webglTexture=n.createTexture()),An.__version=Ge.version,o.memory.textures++),jt){Xt.__webglFramebuffer=[];for(let Un=0;Un<6;Un++)if(Ge.mipmaps&&Ge.mipmaps.length>0){Xt.__webglFramebuffer[Un]=[];for(let tr=0;tr<Ge.mipmaps.length;tr++)Xt.__webglFramebuffer[Un][tr]=n.createFramebuffer()}else Xt.__webglFramebuffer[Un]=n.createFramebuffer()}else{if(Ge.mipmaps&&Ge.mipmaps.length>0){Xt.__webglFramebuffer=[];for(let Un=0;Un<Ge.mipmaps.length;Un++)Xt.__webglFramebuffer[Un]=n.createFramebuffer()}else Xt.__webglFramebuffer=n.createFramebuffer();if(mr)for(let Un=0,tr=Sn.length;Un<tr;Un++){const Sr=r.get(Sn[Un]);Sr.__webglTexture===void 0&&(Sr.__webglTexture=n.createTexture(),o.memory.textures++)}if(ot.samples>0&&Jt(ot)===!1){Xt.__webglMultisampledFramebuffer=n.createFramebuffer(),Xt.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Xt.__webglMultisampledFramebuffer);for(let Un=0;Un<Sn.length;Un++){const tr=Sn[Un];Xt.__webglColorRenderbuffer[Un]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Xt.__webglColorRenderbuffer[Un]);const Sr=s.convert(tr.format,tr.colorSpace),Ln=s.convert(tr.type),ir=L(tr.internalFormat,Sr,Ln,tr.colorSpace,ot.isXRRenderTarget===!0),ui=St(ot);n.renderbufferStorageMultisample(n.RENDERBUFFER,ui,ir,ot.width,ot.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Un,n.RENDERBUFFER,Xt.__webglColorRenderbuffer[Un])}n.bindRenderbuffer(n.RENDERBUFFER,null),ot.depthBuffer&&(Xt.__webglDepthRenderbuffer=n.createRenderbuffer(),Qt(Xt.__webglDepthRenderbuffer,ot,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(jt){t.bindTexture(n.TEXTURE_CUBE_MAP,An.__webglTexture),vt(n.TEXTURE_CUBE_MAP,Ge);for(let Un=0;Un<6;Un++)if(Ge.mipmaps&&Ge.mipmaps.length>0)for(let tr=0;tr<Ge.mipmaps.length;tr++)Ht(Xt.__webglFramebuffer[Un][tr],ot,Ge,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Un,tr);else Ht(Xt.__webglFramebuffer[Un],ot,Ge,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Un,0);M(Ge)&&E(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(mr){for(let Un=0,tr=Sn.length;Un<tr;Un++){const Sr=Sn[Un],Ln=r.get(Sr);t.bindTexture(n.TEXTURE_2D,Ln.__webglTexture),vt(n.TEXTURE_2D,Sr),Ht(Xt.__webglFramebuffer,ot,Sr,n.COLOR_ATTACHMENT0+Un,n.TEXTURE_2D,0),M(Sr)&&E(n.TEXTURE_2D)}t.unbindTexture()}else{let Un=n.TEXTURE_2D;if((ot.isWebGL3DRenderTarget||ot.isWebGLArrayRenderTarget)&&(Un=ot.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Un,An.__webglTexture),vt(Un,Ge),Ge.mipmaps&&Ge.mipmaps.length>0)for(let tr=0;tr<Ge.mipmaps.length;tr++)Ht(Xt.__webglFramebuffer[tr],ot,Ge,n.COLOR_ATTACHMENT0,Un,tr);else Ht(Xt.__webglFramebuffer,ot,Ge,n.COLOR_ATTACHMENT0,Un,0);M(Ge)&&E(Un),t.unbindTexture()}ot.depthBuffer&&jn(ot)}function Le(ot){const Ge=ot.textures;for(let Xt=0,An=Ge.length;Xt<An;Xt++){const Sn=Ge[Xt];if(M(Sn)){const jt=ot.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,mr=r.get(Sn).__webglTexture;t.bindTexture(jt,mr),E(jt),t.unbindTexture()}}}const qe=[],mn=[];function cn(ot){if(ot.samples>0){if(Jt(ot)===!1){const Ge=ot.textures,Xt=ot.width,An=ot.height;let Sn=n.COLOR_BUFFER_BIT;const jt=ot.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,mr=r.get(ot),Un=Ge.length>1;if(Un)for(let tr=0;tr<Ge.length;tr++)t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,mr.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,mr.__webglFramebuffer);for(let tr=0;tr<Ge.length;tr++){if(ot.resolveDepthBuffer&&(ot.depthBuffer&&(Sn|=n.DEPTH_BUFFER_BIT),ot.stencilBuffer&&ot.resolveStencilBuffer&&(Sn|=n.STENCIL_BUFFER_BIT)),Un){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,mr.__webglColorRenderbuffer[tr]);const Sr=r.get(Ge[tr]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Sr,0)}n.blitFramebuffer(0,0,Xt,An,0,0,Xt,An,Sn,n.NEAREST),a===!0&&(qe.length=0,mn.length=0,qe.push(n.COLOR_ATTACHMENT0+tr),ot.depthBuffer&&ot.resolveDepthBuffer===!1&&(qe.push(jt),mn.push(jt),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,mn)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,qe))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Un)for(let tr=0;tr<Ge.length;tr++){t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.RENDERBUFFER,mr.__webglColorRenderbuffer[tr]);const Sr=r.get(Ge[tr]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,mr.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+tr,n.TEXTURE_2D,Sr,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,mr.__webglMultisampledFramebuffer)}else if(ot.depthBuffer&&ot.resolveDepthBuffer===!1&&a){const Ge=ot.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ge])}}}function St(ot){return Math.min(i.maxSamples,ot.samples)}function Jt(ot){const Ge=r.get(ot);return ot.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&Ge.__useRenderToTexture!==!1}function kn(ot){const Ge=o.render.frame;f.get(ot)!==Ge&&(f.set(ot,Ge),ot.update())}function Gn(ot,Ge){const Xt=ot.colorSpace,An=ot.format,Sn=ot.type;return ot.isCompressedTexture===!0||ot.isVideoTexture===!0||Xt!==jo&&Xt!==Em&&(gs.getTransfer(Xt)===na?(An!==Xl||Sn!==Kf)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Xt)),Ge}function sn(ot){return typeof HTMLImageElement<"u"&&ot instanceof HTMLImageElement?(h.width=ot.naturalWidth||ot.width,h.height=ot.naturalHeight||ot.height):typeof VideoFrame<"u"&&ot instanceof VideoFrame?(h.width=ot.displayWidth,h.height=ot.displayHeight):(h.width=ot.width,h.height=ot.height),h}this.allocateTextureUnit=Se,this.resetTextureUnits=fe,this.setTexture2D=Ie,this.setTexture2DArray=He,this.setTexture3D=Re,this.setTextureCube=st,this.rebindTextures=Bn,this.setupRenderTarget=Tn,this.updateRenderTargetMipmap=Le,this.updateMultisampleRenderTarget=cn,this.setupDepthRenderbuffer=jn,this.setupFrameBufferTexture=Ht,this.useMultisampledRTT=Jt}function Ine(n,e){function t(r,i=Em){let s;const o=gs.getTransfer(i);if(r===Kf)return n.UNSIGNED_BYTE;if(r===uD)return n.UNSIGNED_SHORT_4_4_4_4;if(r===hD)return n.UNSIGNED_SHORT_5_5_5_1;if(r===ZU)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===XU)return n.BYTE;if(r===qU)return n.SHORT;if(r===iw)return n.UNSIGNED_SHORT;if(r===cD)return n.INT;if(r===Xm)return n.UNSIGNED_INT;if(r===Mc)return n.FLOAT;if(r===Ih)return n.HALF_FLOAT;if(r===YU)return n.ALPHA;if(r===KU)return n.RGB;if(r===Xl)return n.RGBA;if(r===JU)return n.LUMINANCE;if(r===QU)return n.LUMINANCE_ALPHA;if(r===Fy)return n.DEPTH_COMPONENT;if(r===tx)return n.DEPTH_STENCIL;if(r===qM)return n.RED;if(r===ZM)return n.RED_INTEGER;if(r===e6)return n.RG;if(r===fD)return n.RG_INTEGER;if(r===dD)return n.RGBA_INTEGER;if(r===JA||r===QA||r===eT||r===tT)if(o===na)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===JA)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===QA)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===eT)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===tT)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===JA)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===QA)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===eT)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===tT)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===eP||r===tP||r===nP||r===rP)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===eP)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===tP)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===nP)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===rP)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===iP||r===sP||r===aP)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===iP||r===sP)return o===na?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===aP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===oP||r===lP||r===cP||r===uP||r===hP||r===fP||r===dP||r===pP||r===mP||r===gP||r===vP||r===_P||r===yP||r===xP)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===oP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===lP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===cP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===uP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===hP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===fP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===dP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===pP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===mP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===gP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===vP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===_P)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===yP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===xP)return o===na?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===nT||r===bP||r===wP)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===nT)return o===na?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===bP)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===wP)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===t6||r===SP||r===AP||r===TP)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===nT)return s.COMPRESSED_RED_RGTC1_EXT;if(r===SP)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===AP)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===TP)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===ex?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}class Rne extends ts{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}let ql=class extends Pi{constructor(){super(),this.isGroup=!0,this.type="Group"}};const fbe={type:"move"};class ZO{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ql,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ql,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ze,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ze),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ql,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ze,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ze),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,o=null;const l=this._targetRay,a=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){o=!0;for(const C of e.hand.values()){const M=t.getJointPose(C,r),E=this._getHandJoint(h,C);M!==null&&(E.matrix.fromArray(M.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.matrixWorldNeedsUpdate=!0,E.jointRadius=M.radius),E.visible=M!==null}const f=h.joints["index-finger-tip"],p=h.joints["thumb-tip"],v=f.position.distanceTo(p.position),y=.02,S=.005;h.inputState.pinching&&v>y+S?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&v<=y-S&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else a!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(a.matrix.fromArray(s.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,s.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(s.linearVelocity)):a.hasLinearVelocity=!1,s.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(s.angularVelocity)):a.hasAngularVelocity=!1));l!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(l.matrix.fromArray(i.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,i.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(i.linearVelocity)):l.hasLinearVelocity=!1,i.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(i.angularVelocity)):l.hasAngularVelocity=!1,this.dispatchEvent(fbe)))}return l!==null&&(l.visible=i!==null),a!==null&&(a.visible=s!==null),h!==null&&(h.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new ql;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}const dbe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,pbe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class mbe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const i=new Xs,s=e.properties.get(i);s.__webglTexture=t.texture,(t.depthNear!=r.depthNear||t.depthFar!=r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new Ia({vertexShader:dbe,fragmentShader:pbe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Ri(new ig(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class gbe extends xp{constructor(e,t){super();const r=this;let i=null,s=1,o=null,l="local-floor",a=1,h=null,f=null,p=null,v=null,y=null,S=null;const C=new mbe,M=t.getContextAttributes();let E=null,L=null;const k=[],H=[],X=new nn;let Z=null;const Q=new ts;Q.layers.enable(1),Q.viewport=new Rs;const re=new ts;re.layers.enable(2),re.viewport=new Rs;const ie=[Q,re],oe=new Rne;oe.layers.enable(1),oe.layers.enable(2);let fe=null,Se=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(lt){let Ht=k[lt];return Ht===void 0&&(Ht=new ZO,k[lt]=Ht),Ht.getTargetRaySpace()},this.getControllerGrip=function(lt){let Ht=k[lt];return Ht===void 0&&(Ht=new ZO,k[lt]=Ht),Ht.getGripSpace()},this.getHand=function(lt){let Ht=k[lt];return Ht===void 0&&(Ht=new ZO,k[lt]=Ht),Ht.getHandSpace()};function Ee(lt){const Ht=H.indexOf(lt.inputSource);if(Ht===-1)return;const Qt=k[Ht];Qt!==void 0&&(Qt.update(lt.inputSource,lt.frame,h||o),Qt.dispatchEvent({type:lt.type,data:lt.inputSource}))}function Ie(){i.removeEventListener("select",Ee),i.removeEventListener("selectstart",Ee),i.removeEventListener("selectend",Ee),i.removeEventListener("squeeze",Ee),i.removeEventListener("squeezestart",Ee),i.removeEventListener("squeezeend",Ee),i.removeEventListener("end",Ie),i.removeEventListener("inputsourceschange",He);for(let lt=0;lt<k.length;lt++){const Ht=H[lt];Ht!==null&&(H[lt]=null,k[lt].disconnect(Ht))}fe=null,Se=null,C.reset(),e.setRenderTarget(E),y=null,v=null,p=null,i=null,L=null,Vt.stop(),r.isPresenting=!1,e.setPixelRatio(Z),e.setSize(X.width,X.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(lt){s=lt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(lt){l=lt,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||o},this.setReferenceSpace=function(lt){h=lt},this.getBaseLayer=function(){return v!==null?v:y},this.getBinding=function(){return p},this.getFrame=function(){return S},this.getSession=function(){return i},this.setSession=async function(lt){if(i=lt,i!==null){if(E=e.getRenderTarget(),i.addEventListener("select",Ee),i.addEventListener("selectstart",Ee),i.addEventListener("selectend",Ee),i.addEventListener("squeeze",Ee),i.addEventListener("squeezestart",Ee),i.addEventListener("squeezeend",Ee),i.addEventListener("end",Ie),i.addEventListener("inputsourceschange",He),M.xrCompatible!==!0&&await t.makeXRCompatible(),Z=e.getPixelRatio(),e.getSize(X),i.renderState.layers===void 0){const Ht={antialias:M.antialias,alpha:!0,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:s};y=new XRWebGLLayer(i,t,Ht),i.updateRenderState({baseLayer:y}),e.setPixelRatio(1),e.setSize(y.framebufferWidth,y.framebufferHeight,!1),L=new Sl(y.framebufferWidth,y.framebufferHeight,{format:Xl,type:Kf,colorSpace:e.outputColorSpace,stencilBuffer:M.stencil})}else{let Ht=null,Qt=null,rn=null;M.depth&&(rn=M.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ht=M.stencil?tx:Fy,Qt=M.stencil?ex:Xm);const jn={colorFormat:t.RGBA8,depthFormat:rn,scaleFactor:s};p=new XRWebGLBinding(i,t),v=p.createProjectionLayer(jn),i.updateRenderState({layers:[v]}),e.setPixelRatio(1),e.setSize(v.textureWidth,v.textureHeight,!1),L=new Sl(v.textureWidth,v.textureHeight,{format:Xl,type:Kf,depthTexture:new h6(v.textureWidth,v.textureHeight,Qt,void 0,void 0,void 0,void 0,void 0,void 0,Ht),stencilBuffer:M.stencil,colorSpace:e.outputColorSpace,samples:M.antialias?4:0,resolveDepthBuffer:v.ignoreDepthValues===!1})}L.isXRRenderTarget=!0,this.setFoveation(a),h=null,o=await i.requestReferenceSpace(l),Vt.setContext(i),Vt.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return C.getDepthTexture()};function He(lt){for(let Ht=0;Ht<lt.removed.length;Ht++){const Qt=lt.removed[Ht],rn=H.indexOf(Qt);rn>=0&&(H[rn]=null,k[rn].disconnect(Qt))}for(let Ht=0;Ht<lt.added.length;Ht++){const Qt=lt.added[Ht];let rn=H.indexOf(Qt);if(rn===-1){for(let Bn=0;Bn<k.length;Bn++)if(Bn>=H.length){H.push(Qt),rn=Bn;break}else if(H[Bn]===null){H[Bn]=Qt,rn=Bn;break}if(rn===-1)break}const jn=k[rn];jn&&jn.connect(Qt)}}const Re=new Ze,st=new Ze;function _e(lt,Ht,Qt){Re.setFromMatrixPosition(Ht.matrixWorld),st.setFromMatrixPosition(Qt.matrixWorld);const rn=Re.distanceTo(st),jn=Ht.projectionMatrix.elements,Bn=Qt.projectionMatrix.elements,Tn=jn[14]/(jn[10]-1),Le=jn[14]/(jn[10]+1),qe=(jn[9]+1)/jn[5],mn=(jn[9]-1)/jn[5],cn=(jn[8]-1)/jn[0],St=(Bn[8]+1)/Bn[0],Jt=Tn*cn,kn=Tn*St,Gn=rn/(-cn+St),sn=Gn*-cn;Ht.matrixWorld.decompose(lt.position,lt.quaternion,lt.scale),lt.translateX(sn),lt.translateZ(Gn),lt.matrixWorld.compose(lt.position,lt.quaternion,lt.scale),lt.matrixWorldInverse.copy(lt.matrixWorld).invert();const ot=Tn+Gn,Ge=Le+Gn,Xt=Jt-sn,An=kn+(rn-sn),Sn=qe*Le/Ge*ot,jt=mn*Le/Ge*ot;lt.projectionMatrix.makePerspective(Xt,An,Sn,jt,ot,Ge),lt.projectionMatrixInverse.copy(lt.projectionMatrix).invert()}function We(lt,Ht){Ht===null?lt.matrixWorld.copy(lt.matrix):lt.matrixWorld.multiplyMatrices(Ht.matrixWorld,lt.matrix),lt.matrixWorldInverse.copy(lt.matrixWorld).invert()}this.updateCamera=function(lt){if(i===null)return;C.texture!==null&&(lt.near=C.depthNear,lt.far=C.depthFar),oe.near=re.near=Q.near=lt.near,oe.far=re.far=Q.far=lt.far,(fe!==oe.near||Se!==oe.far)&&(i.updateRenderState({depthNear:oe.near,depthFar:oe.far}),fe=oe.near,Se=oe.far,Q.near=fe,Q.far=Se,re.near=fe,re.far=Se,Q.updateProjectionMatrix(),re.updateProjectionMatrix(),lt.updateProjectionMatrix());const Ht=lt.parent,Qt=oe.cameras;We(oe,Ht);for(let rn=0;rn<Qt.length;rn++)We(Qt[rn],Ht);Qt.length===2?_e(oe,Q,re):oe.projectionMatrix.copy(Q.projectionMatrix),Ue(lt,oe,Ht)};function Ue(lt,Ht,Qt){Qt===null?lt.matrix.copy(Ht.matrixWorld):(lt.matrix.copy(Qt.matrixWorld),lt.matrix.invert(),lt.matrix.multiply(Ht.matrixWorld)),lt.matrix.decompose(lt.position,lt.quaternion,lt.scale),lt.updateMatrixWorld(!0),lt.projectionMatrix.copy(Ht.projectionMatrix),lt.projectionMatrixInverse.copy(Ht.projectionMatrixInverse),lt.isPerspectiveCamera&&(lt.fov=sw*2*Math.atan(1/lt.projectionMatrix.elements[5]),lt.zoom=1)}this.getCamera=function(){return oe},this.getFoveation=function(){if(!(v===null&&y===null))return a},this.setFoveation=function(lt){a=lt,v!==null&&(v.fixedFoveation=lt),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=lt)},this.hasDepthSensing=function(){return C.texture!==null},this.getDepthSensingMesh=function(){return C.getMesh(oe)};let vt=null;function xt(lt,Ht){if(f=Ht.getViewerPose(h||o),S=Ht,f!==null){const Qt=f.views;y!==null&&(e.setRenderTargetFramebuffer(L,y.framebuffer),e.setRenderTarget(L));let rn=!1;Qt.length!==oe.cameras.length&&(oe.cameras.length=0,rn=!0);for(let Bn=0;Bn<Qt.length;Bn++){const Tn=Qt[Bn];let Le=null;if(y!==null)Le=y.getViewport(Tn);else{const mn=p.getViewSubImage(v,Tn);Le=mn.viewport,Bn===0&&(e.setRenderTargetTextures(L,mn.colorTexture,v.ignoreDepthValues?void 0:mn.depthStencilTexture),e.setRenderTarget(L))}let qe=ie[Bn];qe===void 0&&(qe=new ts,qe.layers.enable(Bn),qe.viewport=new Rs,ie[Bn]=qe),qe.matrix.fromArray(Tn.transform.matrix),qe.matrix.decompose(qe.position,qe.quaternion,qe.scale),qe.projectionMatrix.fromArray(Tn.projectionMatrix),qe.projectionMatrixInverse.copy(qe.projectionMatrix).invert(),qe.viewport.set(Le.x,Le.y,Le.width,Le.height),Bn===0&&(oe.matrix.copy(qe.matrix),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale)),rn===!0&&oe.cameras.push(qe)}const jn=i.enabledFeatures;if(jn&&jn.includes("depth-sensing")){const Bn=p.getDepthInformation(Qt[0]);Bn&&Bn.isValid&&Bn.texture&&C.init(e,Bn,i.renderState)}}for(let Qt=0;Qt<k.length;Qt++){const rn=H[Qt],jn=k[Qt];rn!==null&&jn!==void 0&&jn.update(rn,Ht,h||o)}vt&&vt(lt,Ht),Ht.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:Ht}),S=null}const Vt=new Ane;Vt.setAnimationLoop(xt),this.setAnimationLoop=function(lt){vt=lt},this.dispose=function(){}}}const E_=new Gu,vbe=new Gr;function _be(n,e){function t(M,E){M.matrixAutoUpdate===!0&&M.updateMatrix(),E.value.copy(M.matrix)}function r(M,E){E.color.getRGB(M.fogColor.value,bne(n)),E.isFog?(M.fogNear.value=E.near,M.fogFar.value=E.far):E.isFogExp2&&(M.fogDensity.value=E.density)}function i(M,E,L,k,H){E.isMeshBasicMaterial||E.isMeshLambertMaterial?s(M,E):E.isMeshToonMaterial?(s(M,E),p(M,E)):E.isMeshPhongMaterial?(s(M,E),f(M,E)):E.isMeshStandardMaterial?(s(M,E),v(M,E),E.isMeshPhysicalMaterial&&y(M,E,H)):E.isMeshMatcapMaterial?(s(M,E),S(M,E)):E.isMeshDepthMaterial?s(M,E):E.isMeshDistanceMaterial?(s(M,E),C(M,E)):E.isMeshNormalMaterial?s(M,E):E.isLineBasicMaterial?(o(M,E),E.isLineDashedMaterial&&l(M,E)):E.isPointsMaterial?a(M,E,L,k):E.isSpriteMaterial?h(M,E):E.isShadowMaterial?(M.color.value.copy(E.color),M.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function s(M,E){M.opacity.value=E.opacity,E.color&&M.diffuse.value.copy(E.color),E.emissive&&M.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(M.map.value=E.map,t(E.map,M.mapTransform)),E.alphaMap&&(M.alphaMap.value=E.alphaMap,t(E.alphaMap,M.alphaMapTransform)),E.bumpMap&&(M.bumpMap.value=E.bumpMap,t(E.bumpMap,M.bumpMapTransform),M.bumpScale.value=E.bumpScale,E.side===Ic&&(M.bumpScale.value*=-1)),E.normalMap&&(M.normalMap.value=E.normalMap,t(E.normalMap,M.normalMapTransform),M.normalScale.value.copy(E.normalScale),E.side===Ic&&M.normalScale.value.negate()),E.displacementMap&&(M.displacementMap.value=E.displacementMap,t(E.displacementMap,M.displacementMapTransform),M.displacementScale.value=E.displacementScale,M.displacementBias.value=E.displacementBias),E.emissiveMap&&(M.emissiveMap.value=E.emissiveMap,t(E.emissiveMap,M.emissiveMapTransform)),E.specularMap&&(M.specularMap.value=E.specularMap,t(E.specularMap,M.specularMapTransform)),E.alphaTest>0&&(M.alphaTest.value=E.alphaTest);const L=e.get(E),k=L.envMap,H=L.envMapRotation;k&&(M.envMap.value=k,E_.copy(H),E_.x*=-1,E_.y*=-1,E_.z*=-1,k.isCubeTexture&&k.isRenderTargetTexture===!1&&(E_.y*=-1,E_.z*=-1),M.envMapRotation.value.setFromMatrix4(vbe.makeRotationFromEuler(E_)),M.flipEnvMap.value=k.isCubeTexture&&k.isRenderTargetTexture===!1?-1:1,M.reflectivity.value=E.reflectivity,M.ior.value=E.ior,M.refractionRatio.value=E.refractionRatio),E.lightMap&&(M.lightMap.value=E.lightMap,M.lightMapIntensity.value=E.lightMapIntensity,t(E.lightMap,M.lightMapTransform)),E.aoMap&&(M.aoMap.value=E.aoMap,M.aoMapIntensity.value=E.aoMapIntensity,t(E.aoMap,M.aoMapTransform))}function o(M,E){M.diffuse.value.copy(E.color),M.opacity.value=E.opacity,E.map&&(M.map.value=E.map,t(E.map,M.mapTransform))}function l(M,E){M.dashSize.value=E.dashSize,M.totalSize.value=E.dashSize+E.gapSize,M.scale.value=E.scale}function a(M,E,L,k){M.diffuse.value.copy(E.color),M.opacity.value=E.opacity,M.size.value=E.size*L,M.scale.value=k*.5,E.map&&(M.map.value=E.map,t(E.map,M.uvTransform)),E.alphaMap&&(M.alphaMap.value=E.alphaMap,t(E.alphaMap,M.alphaMapTransform)),E.alphaTest>0&&(M.alphaTest.value=E.alphaTest)}function h(M,E){M.diffuse.value.copy(E.color),M.opacity.value=E.opacity,M.rotation.value=E.rotation,E.map&&(M.map.value=E.map,t(E.map,M.mapTransform)),E.alphaMap&&(M.alphaMap.value=E.alphaMap,t(E.alphaMap,M.alphaMapTransform)),E.alphaTest>0&&(M.alphaTest.value=E.alphaTest)}function f(M,E){M.specular.value.copy(E.specular),M.shininess.value=Math.max(E.shininess,1e-4)}function p(M,E){E.gradientMap&&(M.gradientMap.value=E.gradientMap)}function v(M,E){M.metalness.value=E.metalness,E.metalnessMap&&(M.metalnessMap.value=E.metalnessMap,t(E.metalnessMap,M.metalnessMapTransform)),M.roughness.value=E.roughness,E.roughnessMap&&(M.roughnessMap.value=E.roughnessMap,t(E.roughnessMap,M.roughnessMapTransform)),E.envMap&&(M.envMapIntensity.value=E.envMapIntensity)}function y(M,E,L){M.ior.value=E.ior,E.sheen>0&&(M.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),M.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(M.sheenColorMap.value=E.sheenColorMap,t(E.sheenColorMap,M.sheenColorMapTransform)),E.sheenRoughnessMap&&(M.sheenRoughnessMap.value=E.sheenRoughnessMap,t(E.sheenRoughnessMap,M.sheenRoughnessMapTransform))),E.clearcoat>0&&(M.clearcoat.value=E.clearcoat,M.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(M.clearcoatMap.value=E.clearcoatMap,t(E.clearcoatMap,M.clearcoatMapTransform)),E.clearcoatRoughnessMap&&(M.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap,t(E.clearcoatRoughnessMap,M.clearcoatRoughnessMapTransform)),E.clearcoatNormalMap&&(M.clearcoatNormalMap.value=E.clearcoatNormalMap,t(E.clearcoatNormalMap,M.clearcoatNormalMapTransform),M.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),E.side===Ic&&M.clearcoatNormalScale.value.negate())),E.dispersion>0&&(M.dispersion.value=E.dispersion),E.iridescence>0&&(M.iridescence.value=E.iridescence,M.iridescenceIOR.value=E.iridescenceIOR,M.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],M.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(M.iridescenceMap.value=E.iridescenceMap,t(E.iridescenceMap,M.iridescenceMapTransform)),E.iridescenceThicknessMap&&(M.iridescenceThicknessMap.value=E.iridescenceThicknessMap,t(E.iridescenceThicknessMap,M.iridescenceThicknessMapTransform))),E.transmission>0&&(M.transmission.value=E.transmission,M.transmissionSamplerMap.value=L.texture,M.transmissionSamplerSize.value.set(L.width,L.height),E.transmissionMap&&(M.transmissionMap.value=E.transmissionMap,t(E.transmissionMap,M.transmissionMapTransform)),M.thickness.value=E.thickness,E.thicknessMap&&(M.thicknessMap.value=E.thicknessMap,t(E.thicknessMap,M.thicknessMapTransform)),M.attenuationDistance.value=E.attenuationDistance,M.attenuationColor.value.copy(E.attenuationColor)),E.anisotropy>0&&(M.anisotropyVector.value.set(E.anisotropy*Math.cos(E.anisotropyRotation),E.anisotropy*Math.sin(E.anisotropyRotation)),E.anisotropyMap&&(M.anisotropyMap.value=E.anisotropyMap,t(E.anisotropyMap,M.anisotropyMapTransform))),M.specularIntensity.value=E.specularIntensity,M.specularColor.value.copy(E.specularColor),E.specularColorMap&&(M.specularColorMap.value=E.specularColorMap,t(E.specularColorMap,M.specularColorMapTransform)),E.specularIntensityMap&&(M.specularIntensityMap.value=E.specularIntensityMap,t(E.specularIntensityMap,M.specularIntensityMapTransform))}function S(M,E){E.matcap&&(M.matcap.value=E.matcap)}function C(M,E){const L=e.get(E).light;M.referencePosition.value.setFromMatrixPosition(L.matrixWorld),M.nearDistance.value=L.shadow.camera.near,M.farDistance.value=L.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function ybe(n,e,t,r){let i={},s={},o=[];const l=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function a(L,k){const H=k.program;r.uniformBlockBinding(L,H)}function h(L,k){let H=i[L.id];H===void 0&&(S(L),H=f(L),i[L.id]=H,L.addEventListener("dispose",M));const X=k.program;r.updateUBOMapping(L,X);const Z=e.render.frame;s[L.id]!==Z&&(v(L),s[L.id]=Z)}function f(L){const k=p();L.__bindingPointIndex=k;const H=n.createBuffer(),X=L.__size,Z=L.usage;return n.bindBuffer(n.UNIFORM_BUFFER,H),n.bufferData(n.UNIFORM_BUFFER,X,Z),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,k,H),H}function p(){for(let L=0;L<l;L++)if(o.indexOf(L)===-1)return o.push(L),L;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function v(L){const k=i[L.id],H=L.uniforms,X=L.__cache;n.bindBuffer(n.UNIFORM_BUFFER,k);for(let Z=0,Q=H.length;Z<Q;Z++){const re=Array.isArray(H[Z])?H[Z]:[H[Z]];for(let ie=0,oe=re.length;ie<oe;ie++){const fe=re[ie];if(y(fe,Z,ie,X)===!0){const Se=fe.__offset,Ee=Array.isArray(fe.value)?fe.value:[fe.value];let Ie=0;for(let He=0;He<Ee.length;He++){const Re=Ee[He],st=C(Re);typeof Re=="number"||typeof Re=="boolean"?(fe.__data[0]=Re,n.bufferSubData(n.UNIFORM_BUFFER,Se+Ie,fe.__data)):Re.isMatrix3?(fe.__data[0]=Re.elements[0],fe.__data[1]=Re.elements[1],fe.__data[2]=Re.elements[2],fe.__data[3]=0,fe.__data[4]=Re.elements[3],fe.__data[5]=Re.elements[4],fe.__data[6]=Re.elements[5],fe.__data[7]=0,fe.__data[8]=Re.elements[6],fe.__data[9]=Re.elements[7],fe.__data[10]=Re.elements[8],fe.__data[11]=0):(Re.toArray(fe.__data,Ie),Ie+=st.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,Se,fe.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function y(L,k,H,X){const Z=L.value,Q=k+"_"+H;if(X[Q]===void 0)return typeof Z=="number"||typeof Z=="boolean"?X[Q]=Z:X[Q]=Z.clone(),!0;{const re=X[Q];if(typeof Z=="number"||typeof Z=="boolean"){if(re!==Z)return X[Q]=Z,!0}else if(re.equals(Z)===!1)return re.copy(Z),!0}return!1}function S(L){const k=L.uniforms;let H=0;const X=16;for(let Q=0,re=k.length;Q<re;Q++){const ie=Array.isArray(k[Q])?k[Q]:[k[Q]];for(let oe=0,fe=ie.length;oe<fe;oe++){const Se=ie[oe],Ee=Array.isArray(Se.value)?Se.value:[Se.value];for(let Ie=0,He=Ee.length;Ie<He;Ie++){const Re=Ee[Ie],st=C(Re),_e=H%X;_e!==0&&X-_e<st.boundary&&(H+=X-_e),Se.__data=new Float32Array(st.storage/Float32Array.BYTES_PER_ELEMENT),Se.__offset=H,H+=st.storage}}}const Z=H%X;return Z>0&&(H+=X-Z),L.__size=H,L.__cache={},this}function C(L){const k={boundary:0,storage:0};return typeof L=="number"||typeof L=="boolean"?(k.boundary=4,k.storage=4):L.isVector2?(k.boundary=8,k.storage=8):L.isVector3||L.isColor?(k.boundary=16,k.storage=12):L.isVector4?(k.boundary=16,k.storage=16):L.isMatrix3?(k.boundary=48,k.storage=48):L.isMatrix4?(k.boundary=64,k.storage=64):L.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",L),k}function M(L){const k=L.target;k.removeEventListener("dispose",M);const H=o.indexOf(k.__bindingPointIndex);o.splice(H,1),n.deleteBuffer(i[k.id]),delete i[k.id],delete s[k.id]}function E(){for(const L in i)n.deleteBuffer(i[L]);o=[],i={},s={}}return{bind:a,update:h,dispose:E}}class Jl{constructor(e={}){const{canvas:t=vne(),context:r=null,depth:i=!0,stencil:s=!1,alpha:o=!1,antialias:l=!1,premultipliedAlpha:a=!0,preserveDrawingBuffer:h=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:p=!1}=e;this.isWebGLRenderer=!0;let v;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=r.getContextAttributes().alpha}else v=o;const y=new Uint32Array(4),S=new Int32Array(4);let C=null,M=null;const E=[],L=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Ta,this.toneMapping=up,this.toneMappingExposure=1;const k=this;let H=!1,X=0,Z=0,Q=null,re=-1,ie=null;const oe=new Rs,fe=new Rs;let Se=null;const Ee=new Vn(0);let Ie=0,He=t.width,Re=t.height,st=1,_e=null,We=null;const Ue=new Rs(0,0,He,Re),vt=new Rs(0,0,He,Re);let xt=!1;const Vt=new eE;let lt=!1,Ht=!1;const Qt=new Gr,rn=new Ze,jn=new Rs,Bn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Tn=!1;function Le(){return Q===null?st:1}let qe=r;function mn(Ve,yt){return t.getContext(Ve,yt)}try{const Ve={alpha:!0,depth:i,stencil:s,antialias:l,premultipliedAlpha:a,preserveDrawingBuffer:h,powerPreference:f,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${WM}`),t.addEventListener("webglcontextlost",Kt,!1),t.addEventListener("webglcontextrestored",un,!1),t.addEventListener("webglcontextcreationerror",Cn,!1),qe===null){const yt="webgl2";if(qe=mn(yt,Ve),qe===null)throw mn(yt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(Ve){throw console.error("THREE.WebGLRenderer: "+Ve.message),Ve}let cn,St,Jt,kn,Gn,sn,ot,Ge,Xt,An,Sn,jt,mr,Un,tr,Sr,Ln,ir,ui,Fr,ar,Nr,Hr,xi;function Fe(){cn=new Exe(qe),cn.init(),Nr=new Ine(qe,cn),St=new bxe(qe,cn,e,Nr),Jt=new sbe(qe),kn=new Rxe(qe),Gn=new X1e,sn=new hbe(qe,cn,Jt,Gn,St,Nr,kn),ot=new Sxe(k),Ge=new Mxe(k),Xt=new F0e(qe),Hr=new yxe(qe,Xt),An=new Cxe(qe,Xt,kn,Hr),Sn=new Lxe(qe,An,Xt,kn),ui=new Pxe(qe,St,sn),Sr=new wxe(Gn),jt=new $1e(k,ot,Ge,cn,St,Hr,Sr),mr=new _be(k,Gn),Un=new Z1e,tr=new tbe(cn),ir=new _xe(k,ot,Ge,Jt,Sn,v,a),Ln=new ibe(k,Sn,St),xi=new ybe(qe,kn,St,Jt),Fr=new xxe(qe,cn,kn),ar=new Ixe(qe,cn,kn),kn.programs=jt.programs,k.capabilities=St,k.extensions=cn,k.properties=Gn,k.renderLists=Un,k.shadowMap=Ln,k.state=Jt,k.info=kn}Fe();const Lt=new gbe(k,qe);this.xr=Lt,this.getContext=function(){return qe},this.getContextAttributes=function(){return qe.getContextAttributes()},this.forceContextLoss=function(){const Ve=cn.get("WEBGL_lose_context");Ve&&Ve.loseContext()},this.forceContextRestore=function(){const Ve=cn.get("WEBGL_lose_context");Ve&&Ve.restoreContext()},this.getPixelRatio=function(){return st},this.setPixelRatio=function(Ve){Ve!==void 0&&(st=Ve,this.setSize(He,Re,!1))},this.getSize=function(Ve){return Ve.set(He,Re)},this.setSize=function(Ve,yt,Mt=!0){if(Lt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}He=Ve,Re=yt,t.width=Math.floor(Ve*st),t.height=Math.floor(yt*st),Mt===!0&&(t.style.width=Ve+"px",t.style.height=yt+"px"),this.setViewport(0,0,Ve,yt)},this.getDrawingBufferSize=function(Ve){return Ve.set(He*st,Re*st).floor()},this.setDrawingBufferSize=function(Ve,yt,Mt){He=Ve,Re=yt,st=Mt,t.width=Math.floor(Ve*Mt),t.height=Math.floor(yt*Mt),this.setViewport(0,0,Ve,yt)},this.getCurrentViewport=function(Ve){return Ve.copy(oe)},this.getViewport=function(Ve){return Ve.copy(Ue)},this.setViewport=function(Ve,yt,Mt,Et){Ve.isVector4?Ue.set(Ve.x,Ve.y,Ve.z,Ve.w):Ue.set(Ve,yt,Mt,Et),Jt.viewport(oe.copy(Ue).multiplyScalar(st).round())},this.getScissor=function(Ve){return Ve.copy(vt)},this.setScissor=function(Ve,yt,Mt,Et){Ve.isVector4?vt.set(Ve.x,Ve.y,Ve.z,Ve.w):vt.set(Ve,yt,Mt,Et),Jt.scissor(fe.copy(vt).multiplyScalar(st).round())},this.getScissorTest=function(){return xt},this.setScissorTest=function(Ve){Jt.setScissorTest(xt=Ve)},this.setOpaqueSort=function(Ve){_e=Ve},this.setTransparentSort=function(Ve){We=Ve},this.getClearColor=function(Ve){return Ve.copy(ir.getClearColor())},this.setClearColor=function(){ir.setClearColor.apply(ir,arguments)},this.getClearAlpha=function(){return ir.getClearAlpha()},this.setClearAlpha=function(){ir.setClearAlpha.apply(ir,arguments)},this.clear=function(Ve=!0,yt=!0,Mt=!0){let Et=0;if(Ve){let It=!1;if(Q!==null){const wn=Q.texture.format;It=wn===dD||wn===fD||wn===ZM}if(It){const wn=Q.texture.type,_n=wn===Kf||wn===Xm||wn===iw||wn===ex||wn===uD||wn===hD,zn=ir.getClearColor(),$n=ir.getClearAlpha(),lr=zn.r,gr=zn.g,dr=zn.b;_n?(y[0]=lr,y[1]=gr,y[2]=dr,y[3]=$n,qe.clearBufferuiv(qe.COLOR,0,y)):(S[0]=lr,S[1]=gr,S[2]=dr,S[3]=$n,qe.clearBufferiv(qe.COLOR,0,S))}else Et|=qe.COLOR_BUFFER_BIT}yt&&(Et|=qe.DEPTH_BUFFER_BIT),Mt&&(Et|=qe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),qe.clear(Et)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Kt,!1),t.removeEventListener("webglcontextrestored",un,!1),t.removeEventListener("webglcontextcreationerror",Cn,!1),Un.dispose(),tr.dispose(),Gn.dispose(),ot.dispose(),Ge.dispose(),Sn.dispose(),Hr.dispose(),xi.dispose(),jt.dispose(),Lt.dispose(),Lt.removeEventListener("sessionstart",xe),Lt.removeEventListener("sessionend",Ce),Xe.stop()};function Kt(Ve){Ve.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function un(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const Ve=kn.autoReset,yt=Ln.enabled,Mt=Ln.autoUpdate,Et=Ln.needsUpdate,It=Ln.type;Fe(),kn.autoReset=Ve,Ln.enabled=yt,Ln.autoUpdate=Mt,Ln.needsUpdate=Et,Ln.type=It}function Cn(Ve){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Ve.statusMessage)}function Ar(Ve){const yt=Ve.target;yt.removeEventListener("dispose",Ar),Vr(yt)}function Vr(Ve){hs(Ve),Gn.remove(Ve)}function hs(Ve){const yt=Gn.get(Ve).programs;yt!==void 0&&(yt.forEach(function(Mt){jt.releaseProgram(Mt)}),Ve.isShaderMaterial&&jt.releaseShaderCache(Ve))}this.renderBufferDirect=function(Ve,yt,Mt,Et,It,wn){yt===null&&(yt=Bn);const _n=It.isMesh&&It.matrixWorld.determinant()<0,zn=ln(Ve,yt,Mt,Et,It);Jt.setMaterial(Et,_n);let $n=Mt.index,lr=1;if(Et.wireframe===!0){if($n=An.getWireframeAttribute(Mt),$n===void 0)return;lr=2}const gr=Mt.drawRange,dr=Mt.attributes.position;let fi=gr.start*lr,Oi=(gr.start+gr.count)*lr;wn!==null&&(fi=Math.max(fi,wn.start*lr),Oi=Math.min(Oi,(wn.start+wn.count)*lr)),$n!==null?(fi=Math.max(fi,0),Oi=Math.min(Oi,$n.count)):dr!=null&&(fi=Math.max(fi,0),Oi=Math.min(Oi,dr.count));const ji=Oi-fi;if(ji<0||ji===1/0)return;Hr.setup(It,Et,zn,Mt,$n);let As,Cr=Fr;if($n!==null&&(As=Xt.get($n),Cr=ar,Cr.setIndex(As)),It.isMesh)Et.wireframe===!0?(Jt.setLineWidth(Et.wireframeLinewidth*Le()),Cr.setMode(qe.LINES)):Cr.setMode(qe.TRIANGLES);else if(It.isLine){let Qn=Et.linewidth;Qn===void 0&&(Qn=1),Jt.setLineWidth(Qn*Le()),It.isLineSegments?Cr.setMode(qe.LINES):It.isLineLoop?Cr.setMode(qe.LINE_LOOP):Cr.setMode(qe.LINE_STRIP)}else It.isPoints?Cr.setMode(qe.POINTS):It.isSprite&&Cr.setMode(qe.TRIANGLES);if(It.isBatchedMesh)if(It._multiDrawInstances!==null)Cr.renderMultiDrawInstances(It._multiDrawStarts,It._multiDrawCounts,It._multiDrawCount,It._multiDrawInstances);else if(cn.get("WEBGL_multi_draw"))Cr.renderMultiDraw(It._multiDrawStarts,It._multiDrawCounts,It._multiDrawCount);else{const Qn=It._multiDrawStarts,Yi=It._multiDrawCounts,qr=It._multiDrawCount,ys=$n?Xt.get($n).bytesPerElement:1,$a=Gn.get(Et).currentProgram.getUniforms();for(let Ds=0;Ds<qr;Ds++)$a.setValue(qe,"_gl_DrawID",Ds),Cr.render(Qn[Ds]/ys,Yi[Ds])}else if(It.isInstancedMesh)Cr.renderInstances(fi,ji,It.count);else if(Mt.isInstancedBufferGeometry){const Qn=Mt._maxInstanceCount!==void 0?Mt._maxInstanceCount:1/0,Yi=Math.min(Mt.instanceCount,Qn);Cr.renderInstances(fi,ji,Yi)}else Cr.render(fi,ji)};function Ls(Ve,yt,Mt){Ve.transparent===!0&&Ve.side===Ac&&Ve.forceSinglePass===!1?(Ve.side=Ic,Ve.needsUpdate=!0,Pt(Ve,yt,Mt),Ve.side=kh,Ve.needsUpdate=!0,Pt(Ve,yt,Mt),Ve.side=Ac):Pt(Ve,yt,Mt)}this.compile=function(Ve,yt,Mt=null){Mt===null&&(Mt=Ve),M=tr.get(Mt),M.init(yt),L.push(M),Mt.traverseVisible(function(It){It.isLight&&It.layers.test(yt.layers)&&(M.pushLight(It),It.castShadow&&M.pushShadow(It))}),Ve!==Mt&&Ve.traverseVisible(function(It){It.isLight&&It.layers.test(yt.layers)&&(M.pushLight(It),It.castShadow&&M.pushShadow(It))}),M.setupLights();const Et=new Set;return Ve.traverse(function(It){const wn=It.material;if(wn)if(Array.isArray(wn))for(let _n=0;_n<wn.length;_n++){const zn=wn[_n];Ls(zn,Mt,It),Et.add(zn)}else Ls(wn,Mt,It),Et.add(wn)}),L.pop(),M=null,Et},this.compileAsync=function(Ve,yt,Mt=null){const Et=this.compile(Ve,yt,Mt);return new Promise(It=>{function wn(){if(Et.forEach(function(_n){Gn.get(_n).currentProgram.isReady()&&Et.delete(_n)}),Et.size===0){It(Ve);return}setTimeout(wn,10)}cn.get("KHR_parallel_shader_compile")!==null?wn():setTimeout(wn,10)})};let hi=null;function Tt(Ve){hi&&hi(Ve)}function xe(){Xe.stop()}function Ce(){Xe.start()}const Xe=new Ane;Xe.setAnimationLoop(Tt),typeof self<"u"&&Xe.setContext(self),this.setAnimationLoop=function(Ve){hi=Ve,Lt.setAnimationLoop(Ve),Ve===null?Xe.stop():Xe.start()},Lt.addEventListener("sessionstart",xe),Lt.addEventListener("sessionend",Ce),this.render=function(Ve,yt){if(yt!==void 0&&yt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;if(Ve.matrixWorldAutoUpdate===!0&&Ve.updateMatrixWorld(),yt.parent===null&&yt.matrixWorldAutoUpdate===!0&&yt.updateMatrixWorld(),Lt.enabled===!0&&Lt.isPresenting===!0&&(Lt.cameraAutoUpdate===!0&&Lt.updateCamera(yt),yt=Lt.getCamera()),Ve.isScene===!0&&Ve.onBeforeRender(k,Ve,yt,Q),M=tr.get(Ve,L.length),M.init(yt),L.push(M),Qt.multiplyMatrices(yt.projectionMatrix,yt.matrixWorldInverse),Vt.setFromProjectionMatrix(Qt),Ht=this.localClippingEnabled,lt=Sr.init(this.clippingPlanes,Ht),C=Un.get(Ve,E.length),C.init(),E.push(C),Lt.enabled===!0&&Lt.isPresenting===!0){const wn=k.xr.getDepthSensingMesh();wn!==null&&nt(wn,yt,-1/0,k.sortObjects)}nt(Ve,yt,0,k.sortObjects),C.finish(),k.sortObjects===!0&&C.sort(_e,We),Tn=Lt.enabled===!1||Lt.isPresenting===!1||Lt.hasDepthSensing()===!1,Tn&&ir.addToRenderList(C,Ve),this.info.render.frame++,lt===!0&&Sr.beginShadows();const Mt=M.state.shadowsArray;Ln.render(Mt,Ve,yt),lt===!0&&Sr.endShadows(),this.info.autoReset===!0&&this.info.reset();const Et=C.opaque,It=C.transmissive;if(M.setupLights(),yt.isArrayCamera){const wn=yt.cameras;if(It.length>0)for(let _n=0,zn=wn.length;_n<zn;_n++){const $n=wn[_n];pt(Et,It,Ve,$n)}Tn&&ir.render(Ve);for(let _n=0,zn=wn.length;_n<zn;_n++){const $n=wn[_n];Je(C,Ve,$n,$n.viewport)}}else It.length>0&&pt(Et,It,Ve,yt),Tn&&ir.render(Ve),Je(C,Ve,yt);Q!==null&&(sn.updateMultisampleRenderTarget(Q),sn.updateRenderTargetMipmap(Q)),Ve.isScene===!0&&Ve.onAfterRender(k,Ve,yt),Hr.resetDefaultState(),re=-1,ie=null,L.pop(),L.length>0?(M=L[L.length-1],lt===!0&&Sr.setGlobalState(k.clippingPlanes,M.state.camera)):M=null,E.pop(),E.length>0?C=E[E.length-1]:C=null};function nt(Ve,yt,Mt,Et){if(Ve.visible===!1)return;if(Ve.layers.test(yt.layers)){if(Ve.isGroup)Mt=Ve.renderOrder;else if(Ve.isLOD)Ve.autoUpdate===!0&&Ve.update(yt);else if(Ve.isLight)M.pushLight(Ve),Ve.castShadow&&M.pushShadow(Ve);else if(Ve.isSprite){if(!Ve.frustumCulled||Vt.intersectsSprite(Ve)){Et&&jn.setFromMatrixPosition(Ve.matrixWorld).applyMatrix4(Qt);const _n=Sn.update(Ve),zn=Ve.material;zn.visible&&C.push(Ve,_n,zn,Mt,jn.z,null)}}else if((Ve.isMesh||Ve.isLine||Ve.isPoints)&&(!Ve.frustumCulled||Vt.intersectsObject(Ve))){const _n=Sn.update(Ve),zn=Ve.material;if(Et&&(Ve.boundingSphere!==void 0?(Ve.boundingSphere===null&&Ve.computeBoundingSphere(),jn.copy(Ve.boundingSphere.center)):(_n.boundingSphere===null&&_n.computeBoundingSphere(),jn.copy(_n.boundingSphere.center)),jn.applyMatrix4(Ve.matrixWorld).applyMatrix4(Qt)),Array.isArray(zn)){const $n=_n.groups;for(let lr=0,gr=$n.length;lr<gr;lr++){const dr=$n[lr],fi=zn[dr.materialIndex];fi&&fi.visible&&C.push(Ve,_n,fi,Mt,jn.z,dr)}}else zn.visible&&C.push(Ve,_n,zn,Mt,jn.z,null)}}const wn=Ve.children;for(let _n=0,zn=wn.length;_n<zn;_n++)nt(wn[_n],yt,Mt,Et)}function Je(Ve,yt,Mt,Et){const It=Ve.opaque,wn=Ve.transmissive,_n=Ve.transparent;M.setupLightsView(Mt),lt===!0&&Sr.setGlobalState(k.clippingPlanes,Mt),Et&&Jt.viewport(oe.copy(Et)),It.length>0&&Rt(It,yt,Mt),wn.length>0&&Rt(wn,yt,Mt),_n.length>0&&Rt(_n,yt,Mt),Jt.buffers.depth.setTest(!0),Jt.buffers.depth.setMask(!0),Jt.buffers.color.setMask(!0),Jt.setPolygonOffset(!1)}function pt(Ve,yt,Mt,Et){if((Mt.isScene===!0?Mt.overrideMaterial:null)!==null)return;M.state.transmissionRenderTarget[Et.id]===void 0&&(M.state.transmissionRenderTarget[Et.id]=new Sl(1,1,{generateMipmaps:!0,type:cn.has("EXT_color_buffer_half_float")||cn.has("EXT_color_buffer_float")?Ih:Kf,minFilter:lu,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:gs.workingColorSpace}));const wn=M.state.transmissionRenderTarget[Et.id],_n=Et.viewport||oe;wn.setSize(_n.z,_n.w);const zn=k.getRenderTarget();k.setRenderTarget(wn),k.getClearColor(Ee),Ie=k.getClearAlpha(),Ie<1&&k.setClearColor(16777215,.5),Tn?ir.render(Mt):k.clear();const $n=k.toneMapping;k.toneMapping=up;const lr=Et.viewport;if(Et.viewport!==void 0&&(Et.viewport=void 0),M.setupLightsView(Et),lt===!0&&Sr.setGlobalState(k.clippingPlanes,Et),Rt(Ve,Mt,Et),sn.updateMultisampleRenderTarget(wn),sn.updateRenderTargetMipmap(wn),cn.has("WEBGL_multisampled_render_to_texture")===!1){let gr=!1;for(let dr=0,fi=yt.length;dr<fi;dr++){const Oi=yt[dr],ji=Oi.object,As=Oi.geometry,Cr=Oi.material,Qn=Oi.group;if(Cr.side===Ac&&ji.layers.test(Et.layers)){const Yi=Cr.side;Cr.side=Ic,Cr.needsUpdate=!0,gt(ji,Mt,Et,As,Cr,Qn),Cr.side=Yi,Cr.needsUpdate=!0,gr=!0}}gr===!0&&(sn.updateMultisampleRenderTarget(wn),sn.updateRenderTargetMipmap(wn))}k.setRenderTarget(zn),k.setClearColor(Ee,Ie),lr!==void 0&&(Et.viewport=lr),k.toneMapping=$n}function Rt(Ve,yt,Mt){const Et=yt.isScene===!0?yt.overrideMaterial:null;for(let It=0,wn=Ve.length;It<wn;It++){const _n=Ve[It],zn=_n.object,$n=_n.geometry,lr=Et===null?_n.material:Et,gr=_n.group;zn.layers.test(Mt.layers)&&gt(zn,yt,Mt,$n,lr,gr)}}function gt(Ve,yt,Mt,Et,It,wn){Ve.onBeforeRender(k,yt,Mt,Et,It,wn),Ve.modelViewMatrix.multiplyMatrices(Mt.matrixWorldInverse,Ve.matrixWorld),Ve.normalMatrix.getNormalMatrix(Ve.modelViewMatrix),It.transparent===!0&&It.side===Ac&&It.forceSinglePass===!1?(It.side=Ic,It.needsUpdate=!0,k.renderBufferDirect(Mt,yt,Et,It,Ve,wn),It.side=kh,It.needsUpdate=!0,k.renderBufferDirect(Mt,yt,Et,It,Ve,wn),It.side=Ac):k.renderBufferDirect(Mt,yt,Et,It,Ve,wn),Ve.onAfterRender(k,yt,Mt,Et,It,wn)}function Pt(Ve,yt,Mt){yt.isScene!==!0&&(yt=Bn);const Et=Gn.get(Ve),It=M.state.lights,wn=M.state.shadowsArray,_n=It.state.version,zn=jt.getParameters(Ve,It.state,wn,yt,Mt),$n=jt.getProgramCacheKey(zn);let lr=Et.programs;Et.environment=Ve.isMeshStandardMaterial?yt.environment:null,Et.fog=yt.fog,Et.envMap=(Ve.isMeshStandardMaterial?Ge:ot).get(Ve.envMap||Et.environment),Et.envMapRotation=Et.environment!==null&&Ve.envMap===null?yt.environmentRotation:Ve.envMapRotation,lr===void 0&&(Ve.addEventListener("dispose",Ar),lr=new Map,Et.programs=lr);let gr=lr.get($n);if(gr!==void 0){if(Et.currentProgram===gr&&Et.lightsStateVersion===_n)return Bt(Ve,zn),gr}else zn.uniforms=jt.getUniforms(Ve),Ve.onBeforeCompile(zn,k),gr=jt.acquireProgram(zn,$n),lr.set($n,gr),Et.uniforms=zn.uniforms;const dr=Et.uniforms;return(!Ve.isShaderMaterial&&!Ve.isRawShaderMaterial||Ve.clipping===!0)&&(dr.clippingPlanes=Sr.uniform),Bt(Ve,zn),Et.needsLights=En(Ve),Et.lightsStateVersion=_n,Et.needsLights&&(dr.ambientLightColor.value=It.state.ambient,dr.lightProbe.value=It.state.probe,dr.directionalLights.value=It.state.directional,dr.directionalLightShadows.value=It.state.directionalShadow,dr.spotLights.value=It.state.spot,dr.spotLightShadows.value=It.state.spotShadow,dr.rectAreaLights.value=It.state.rectArea,dr.ltc_1.value=It.state.rectAreaLTC1,dr.ltc_2.value=It.state.rectAreaLTC2,dr.pointLights.value=It.state.point,dr.pointLightShadows.value=It.state.pointShadow,dr.hemisphereLights.value=It.state.hemi,dr.directionalShadowMap.value=It.state.directionalShadowMap,dr.directionalShadowMatrix.value=It.state.directionalShadowMatrix,dr.spotShadowMap.value=It.state.spotShadowMap,dr.spotLightMatrix.value=It.state.spotLightMatrix,dr.spotLightMap.value=It.state.spotLightMap,dr.pointShadowMap.value=It.state.pointShadowMap,dr.pointShadowMatrix.value=It.state.pointShadowMatrix),Et.currentProgram=gr,Et.uniformsList=null,gr}function zt(Ve){if(Ve.uniformsList===null){const yt=Ve.currentProgram.getUniforms();Ve.uniformsList=rR.seqWithValue(yt.seq,Ve.uniforms)}return Ve.uniformsList}function Bt(Ve,yt){const Mt=Gn.get(Ve);Mt.outputColorSpace=yt.outputColorSpace,Mt.batching=yt.batching,Mt.batchingColor=yt.batchingColor,Mt.instancing=yt.instancing,Mt.instancingColor=yt.instancingColor,Mt.instancingMorph=yt.instancingMorph,Mt.skinning=yt.skinning,Mt.morphTargets=yt.morphTargets,Mt.morphNormals=yt.morphNormals,Mt.morphColors=yt.morphColors,Mt.morphTargetsCount=yt.morphTargetsCount,Mt.numClippingPlanes=yt.numClippingPlanes,Mt.numIntersection=yt.numClipIntersection,Mt.vertexAlphas=yt.vertexAlphas,Mt.vertexTangents=yt.vertexTangents,Mt.toneMapping=yt.toneMapping}function ln(Ve,yt,Mt,Et,It){yt.isScene!==!0&&(yt=Bn),sn.resetTextureUnits();const wn=yt.fog,_n=Et.isMeshStandardMaterial?yt.environment:null,zn=Q===null?k.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:jo,$n=(Et.isMeshStandardMaterial?Ge:ot).get(Et.envMap||_n),lr=Et.vertexColors===!0&&!!Mt.attributes.color&&Mt.attributes.color.itemSize===4,gr=!!Mt.attributes.tangent&&(!!Et.normalMap||Et.anisotropy>0),dr=!!Mt.morphAttributes.position,fi=!!Mt.morphAttributes.normal,Oi=!!Mt.morphAttributes.color;let ji=up;Et.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(ji=k.toneMapping);const As=Mt.morphAttributes.position||Mt.morphAttributes.normal||Mt.morphAttributes.color,Cr=As!==void 0?As.length:0,Qn=Gn.get(Et),Yi=M.state.lights;if(lt===!0&&(Ht===!0||Ve!==ie)){const Ts=Ve===ie&&Et.id===re;Sr.setState(Et,Ve,Ts)}let qr=!1;Et.version===Qn.__version?(Qn.needsLights&&Qn.lightsStateVersion!==Yi.state.version||Qn.outputColorSpace!==zn||It.isBatchedMesh&&Qn.batching===!1||!It.isBatchedMesh&&Qn.batching===!0||It.isBatchedMesh&&Qn.batchingColor===!0&&It.colorTexture===null||It.isBatchedMesh&&Qn.batchingColor===!1&&It.colorTexture!==null||It.isInstancedMesh&&Qn.instancing===!1||!It.isInstancedMesh&&Qn.instancing===!0||It.isSkinnedMesh&&Qn.skinning===!1||!It.isSkinnedMesh&&Qn.skinning===!0||It.isInstancedMesh&&Qn.instancingColor===!0&&It.instanceColor===null||It.isInstancedMesh&&Qn.instancingColor===!1&&It.instanceColor!==null||It.isInstancedMesh&&Qn.instancingMorph===!0&&It.morphTexture===null||It.isInstancedMesh&&Qn.instancingMorph===!1&&It.morphTexture!==null||Qn.envMap!==$n||Et.fog===!0&&Qn.fog!==wn||Qn.numClippingPlanes!==void 0&&(Qn.numClippingPlanes!==Sr.numPlanes||Qn.numIntersection!==Sr.numIntersection)||Qn.vertexAlphas!==lr||Qn.vertexTangents!==gr||Qn.morphTargets!==dr||Qn.morphNormals!==fi||Qn.morphColors!==Oi||Qn.toneMapping!==ji||Qn.morphTargetsCount!==Cr)&&(qr=!0):(qr=!0,Qn.__version=Et.version);let ys=Qn.currentProgram;qr===!0&&(ys=Pt(Et,yt,It));let $a=!1,Ds=!1,fs=!1;const Li=ys.getUniforms(),oa=Qn.uniforms;if(Jt.useProgram(ys.program)&&($a=!0,Ds=!0,fs=!0),Et.id!==re&&(re=Et.id,Ds=!0),$a||ie!==Ve){Li.setValue(qe,"projectionMatrix",Ve.projectionMatrix),Li.setValue(qe,"viewMatrix",Ve.matrixWorldInverse);const Ts=Li.map.cameraPosition;Ts!==void 0&&Ts.setValue(qe,rn.setFromMatrixPosition(Ve.matrixWorld)),St.logarithmicDepthBuffer&&Li.setValue(qe,"logDepthBufFC",2/(Math.log(Ve.far+1)/Math.LN2)),(Et.isMeshPhongMaterial||Et.isMeshToonMaterial||Et.isMeshLambertMaterial||Et.isMeshBasicMaterial||Et.isMeshStandardMaterial||Et.isShaderMaterial)&&Li.setValue(qe,"isOrthographic",Ve.isOrthographicCamera===!0),ie!==Ve&&(ie=Ve,Ds=!0,fs=!0)}if(It.isSkinnedMesh){Li.setOptional(qe,It,"bindMatrix"),Li.setOptional(qe,It,"bindMatrixInverse");const Ts=It.skeleton;Ts&&(Ts.boneTexture===null&&Ts.computeBoneTexture(),Li.setValue(qe,"boneTexture",Ts.boneTexture,sn))}It.isBatchedMesh&&(Li.setOptional(qe,It,"batchingTexture"),Li.setValue(qe,"batchingTexture",It._matricesTexture,sn),Li.setOptional(qe,It,"batchingIdTexture"),Li.setValue(qe,"batchingIdTexture",It._indirectTexture,sn),Li.setOptional(qe,It,"batchingColorTexture"),It._colorsTexture!==null&&Li.setValue(qe,"batchingColorTexture",It._colorsTexture,sn));const Pa=Mt.morphAttributes;if((Pa.position!==void 0||Pa.normal!==void 0||Pa.color!==void 0)&&ui.update(It,Mt,ys),(Ds||Qn.receiveShadow!==It.receiveShadow)&&(Qn.receiveShadow=It.receiveShadow,Li.setValue(qe,"receiveShadow",It.receiveShadow)),Et.isMeshGouraudMaterial&&Et.envMap!==null&&(oa.envMap.value=$n,oa.flipEnvMap.value=$n.isCubeTexture&&$n.isRenderTargetTexture===!1?-1:1),Et.isMeshStandardMaterial&&Et.envMap===null&&yt.environment!==null&&(oa.envMapIntensity.value=yt.environmentIntensity),Ds&&(Li.setValue(qe,"toneMappingExposure",k.toneMappingExposure),Qn.needsLights&&Mn(oa,fs),wn&&Et.fog===!0&&mr.refreshFogUniforms(oa,wn),mr.refreshMaterialUniforms(oa,Et,st,Re,M.state.transmissionRenderTarget[Ve.id]),rR.upload(qe,zt(Qn),oa,sn)),Et.isShaderMaterial&&Et.uniformsNeedUpdate===!0&&(rR.upload(qe,zt(Qn),oa,sn),Et.uniformsNeedUpdate=!1),Et.isSpriteMaterial&&Li.setValue(qe,"center",It.center),Li.setValue(qe,"modelViewMatrix",It.modelViewMatrix),Li.setValue(qe,"normalMatrix",It.normalMatrix),Li.setValue(qe,"modelMatrix",It.matrixWorld),Et.isShaderMaterial||Et.isRawShaderMaterial){const Ts=Et.uniformsGroups;for(let Oc=0,Po=Ts.length;Oc<Po;Oc++){const ud=Ts[Oc];xi.update(ud,ys),xi.bind(ud,ys)}}return ys}function Mn(Ve,yt){Ve.ambientLightColor.needsUpdate=yt,Ve.lightProbe.needsUpdate=yt,Ve.directionalLights.needsUpdate=yt,Ve.directionalLightShadows.needsUpdate=yt,Ve.pointLights.needsUpdate=yt,Ve.pointLightShadows.needsUpdate=yt,Ve.spotLights.needsUpdate=yt,Ve.spotLightShadows.needsUpdate=yt,Ve.rectAreaLights.needsUpdate=yt,Ve.hemisphereLights.needsUpdate=yt}function En(Ve){return Ve.isMeshLambertMaterial||Ve.isMeshToonMaterial||Ve.isMeshPhongMaterial||Ve.isMeshStandardMaterial||Ve.isShadowMaterial||Ve.isShaderMaterial&&Ve.lights===!0}this.getActiveCubeFace=function(){return X},this.getActiveMipmapLevel=function(){return Z},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function(Ve,yt,Mt){Gn.get(Ve.texture).__webglTexture=yt,Gn.get(Ve.depthTexture).__webglTexture=Mt;const Et=Gn.get(Ve);Et.__hasExternalTextures=!0,Et.__autoAllocateDepthBuffer=Mt===void 0,Et.__autoAllocateDepthBuffer||cn.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Et.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(Ve,yt){const Mt=Gn.get(Ve);Mt.__webglFramebuffer=yt,Mt.__useDefaultFramebuffer=yt===void 0},this.setRenderTarget=function(Ve,yt=0,Mt=0){Q=Ve,X=yt,Z=Mt;let Et=!0,It=null,wn=!1,_n=!1;if(Ve){const $n=Gn.get(Ve);$n.__useDefaultFramebuffer!==void 0?(Jt.bindFramebuffer(qe.FRAMEBUFFER,null),Et=!1):$n.__webglFramebuffer===void 0?sn.setupRenderTarget(Ve):$n.__hasExternalTextures&&sn.rebindTextures(Ve,Gn.get(Ve.texture).__webglTexture,Gn.get(Ve.depthTexture).__webglTexture);const lr=Ve.texture;(lr.isData3DTexture||lr.isDataArrayTexture||lr.isCompressedArrayTexture)&&(_n=!0);const gr=Gn.get(Ve).__webglFramebuffer;Ve.isWebGLCubeRenderTarget?(Array.isArray(gr[yt])?It=gr[yt][Mt]:It=gr[yt],wn=!0):Ve.samples>0&&sn.useMultisampledRTT(Ve)===!1?It=Gn.get(Ve).__webglMultisampledFramebuffer:Array.isArray(gr)?It=gr[Mt]:It=gr,oe.copy(Ve.viewport),fe.copy(Ve.scissor),Se=Ve.scissorTest}else oe.copy(Ue).multiplyScalar(st).floor(),fe.copy(vt).multiplyScalar(st).floor(),Se=xt;if(Jt.bindFramebuffer(qe.FRAMEBUFFER,It)&&Et&&Jt.drawBuffers(Ve,It),Jt.viewport(oe),Jt.scissor(fe),Jt.setScissorTest(Se),wn){const $n=Gn.get(Ve.texture);qe.framebufferTexture2D(qe.FRAMEBUFFER,qe.COLOR_ATTACHMENT0,qe.TEXTURE_CUBE_MAP_POSITIVE_X+yt,$n.__webglTexture,Mt)}else if(_n){const $n=Gn.get(Ve.texture),lr=yt||0;qe.framebufferTextureLayer(qe.FRAMEBUFFER,qe.COLOR_ATTACHMENT0,$n.__webglTexture,Mt||0,lr)}re=-1},this.readRenderTargetPixels=function(Ve,yt,Mt,Et,It,wn,_n){if(!(Ve&&Ve.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let zn=Gn.get(Ve).__webglFramebuffer;if(Ve.isWebGLCubeRenderTarget&&_n!==void 0&&(zn=zn[_n]),zn){Jt.bindFramebuffer(qe.FRAMEBUFFER,zn);try{const $n=Ve.texture,lr=$n.format,gr=$n.type;if(!St.textureFormatReadable(lr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!St.textureTypeReadable(gr)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}yt>=0&&yt<=Ve.width-Et&&Mt>=0&&Mt<=Ve.height-It&&qe.readPixels(yt,Mt,Et,It,Nr.convert(lr),Nr.convert(gr),wn)}finally{const $n=Q!==null?Gn.get(Q).__webglFramebuffer:null;Jt.bindFramebuffer(qe.FRAMEBUFFER,$n)}}},this.readRenderTargetPixelsAsync=async function(Ve,yt,Mt,Et,It,wn,_n){if(!(Ve&&Ve.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let zn=Gn.get(Ve).__webglFramebuffer;if(Ve.isWebGLCubeRenderTarget&&_n!==void 0&&(zn=zn[_n]),zn){Jt.bindFramebuffer(qe.FRAMEBUFFER,zn);try{const $n=Ve.texture,lr=$n.format,gr=$n.type;if(!St.textureFormatReadable(lr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!St.textureTypeReadable(gr))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(yt>=0&&yt<=Ve.width-Et&&Mt>=0&&Mt<=Ve.height-It){const dr=qe.createBuffer();qe.bindBuffer(qe.PIXEL_PACK_BUFFER,dr),qe.bufferData(qe.PIXEL_PACK_BUFFER,wn.byteLength,qe.STREAM_READ),qe.readPixels(yt,Mt,Et,It,Nr.convert(lr),Nr.convert(gr),0),qe.flush();const fi=qe.fenceSync(qe.SYNC_GPU_COMMANDS_COMPLETE,0);await l0e(qe,fi,4);try{qe.bindBuffer(qe.PIXEL_PACK_BUFFER,dr),qe.getBufferSubData(qe.PIXEL_PACK_BUFFER,0,wn)}finally{qe.deleteBuffer(dr),qe.deleteSync(fi)}return wn}}finally{const $n=Q!==null?Gn.get(Q).__webglFramebuffer:null;Jt.bindFramebuffer(qe.FRAMEBUFFER,$n)}}},this.copyFramebufferToTexture=function(Ve,yt=null,Mt=0){Ve.isTexture!==!0&&(console.warn("WebGLRenderer: copyFramebufferToTexture function signature has changed."),yt=arguments[0]||null,Ve=arguments[1]);const Et=Math.pow(2,-Mt),It=Math.floor(Ve.image.width*Et),wn=Math.floor(Ve.image.height*Et),_n=yt!==null?yt.x:0,zn=yt!==null?yt.y:0;sn.setTexture2D(Ve,0),qe.copyTexSubImage2D(qe.TEXTURE_2D,Mt,0,0,_n,zn,It,wn),Jt.unbindTexture()},this.copyTextureToTexture=function(Ve,yt,Mt=null,Et=null,It=0){Ve.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture function signature has changed."),Et=arguments[0]||null,Ve=arguments[1],yt=arguments[2],It=arguments[3]||0,Mt=null);let wn,_n,zn,$n,lr,gr;Mt!==null?(wn=Mt.max.x-Mt.min.x,_n=Mt.max.y-Mt.min.y,zn=Mt.min.x,$n=Mt.min.y):(wn=Ve.image.width,_n=Ve.image.height,zn=0,$n=0),Et!==null?(lr=Et.x,gr=Et.y):(lr=0,gr=0);const dr=Nr.convert(yt.format),fi=Nr.convert(yt.type);sn.setTexture2D(yt,0),qe.pixelStorei(qe.UNPACK_FLIP_Y_WEBGL,yt.flipY),qe.pixelStorei(qe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,yt.premultiplyAlpha),qe.pixelStorei(qe.UNPACK_ALIGNMENT,yt.unpackAlignment);const Oi=qe.getParameter(qe.UNPACK_ROW_LENGTH),ji=qe.getParameter(qe.UNPACK_IMAGE_HEIGHT),As=qe.getParameter(qe.UNPACK_SKIP_PIXELS),Cr=qe.getParameter(qe.UNPACK_SKIP_ROWS),Qn=qe.getParameter(qe.UNPACK_SKIP_IMAGES),Yi=Ve.isCompressedTexture?Ve.mipmaps[It]:Ve.image;qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Yi.width),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,Yi.height),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,zn),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,$n),Ve.isDataTexture?qe.texSubImage2D(qe.TEXTURE_2D,It,lr,gr,wn,_n,dr,fi,Yi.data):Ve.isCompressedTexture?qe.compressedTexSubImage2D(qe.TEXTURE_2D,It,lr,gr,Yi.width,Yi.height,dr,Yi.data):qe.texSubImage2D(qe.TEXTURE_2D,It,lr,gr,wn,_n,dr,fi,Yi),qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Oi),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,ji),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,As),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,Cr),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,Qn),It===0&&yt.generateMipmaps&&qe.generateMipmap(qe.TEXTURE_2D),Jt.unbindTexture()},this.copyTextureToTexture3D=function(Ve,yt,Mt=null,Et=null,It=0){Ve.isTexture!==!0&&(console.warn("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Mt=arguments[0]||null,Et=arguments[1]||null,Ve=arguments[2],yt=arguments[3],It=arguments[4]||0);let wn,_n,zn,$n,lr,gr,dr,fi,Oi;const ji=Ve.isCompressedTexture?Ve.mipmaps[It]:Ve.image;Mt!==null?(wn=Mt.max.x-Mt.min.x,_n=Mt.max.y-Mt.min.y,zn=Mt.max.z-Mt.min.z,$n=Mt.min.x,lr=Mt.min.y,gr=Mt.min.z):(wn=ji.width,_n=ji.height,zn=ji.depth,$n=0,lr=0,gr=0),Et!==null?(dr=Et.x,fi=Et.y,Oi=Et.z):(dr=0,fi=0,Oi=0);const As=Nr.convert(yt.format),Cr=Nr.convert(yt.type);let Qn;if(yt.isData3DTexture)sn.setTexture3D(yt,0),Qn=qe.TEXTURE_3D;else if(yt.isDataArrayTexture||yt.isCompressedArrayTexture)sn.setTexture2DArray(yt,0),Qn=qe.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}qe.pixelStorei(qe.UNPACK_FLIP_Y_WEBGL,yt.flipY),qe.pixelStorei(qe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,yt.premultiplyAlpha),qe.pixelStorei(qe.UNPACK_ALIGNMENT,yt.unpackAlignment);const Yi=qe.getParameter(qe.UNPACK_ROW_LENGTH),qr=qe.getParameter(qe.UNPACK_IMAGE_HEIGHT),ys=qe.getParameter(qe.UNPACK_SKIP_PIXELS),$a=qe.getParameter(qe.UNPACK_SKIP_ROWS),Ds=qe.getParameter(qe.UNPACK_SKIP_IMAGES);qe.pixelStorei(qe.UNPACK_ROW_LENGTH,ji.width),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,ji.height),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,$n),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,lr),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,gr),Ve.isDataTexture||Ve.isData3DTexture?qe.texSubImage3D(Qn,It,dr,fi,Oi,wn,_n,zn,As,Cr,ji.data):yt.isCompressedArrayTexture?qe.compressedTexSubImage3D(Qn,It,dr,fi,Oi,wn,_n,zn,As,ji.data):qe.texSubImage3D(Qn,It,dr,fi,Oi,wn,_n,zn,As,Cr,ji),qe.pixelStorei(qe.UNPACK_ROW_LENGTH,Yi),qe.pixelStorei(qe.UNPACK_IMAGE_HEIGHT,qr),qe.pixelStorei(qe.UNPACK_SKIP_PIXELS,ys),qe.pixelStorei(qe.UNPACK_SKIP_ROWS,$a),qe.pixelStorei(qe.UNPACK_SKIP_IMAGES,Ds),It===0&&yt.generateMipmaps&&qe.generateMipmap(Qn),Jt.unbindTexture()},this.initRenderTarget=function(Ve){Gn.get(Ve).__webglFramebuffer===void 0&&sn.setupRenderTarget(Ve)},this.initTexture=function(Ve){Ve.isCubeTexture?sn.setTextureCube(Ve,0):Ve.isData3DTexture?sn.setTexture3D(Ve,0):Ve.isDataArrayTexture||Ve.isCompressedArrayTexture?sn.setTexture2DArray(Ve,0):sn.setTexture2D(Ve,0),Jt.unbindTexture()},this.resetState=function(){X=0,Z=0,Q=null,Jt.reset(),Hr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return tp}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===mD?"display-p3":"srgb",t.unpackColorSpace=gs.workingColorSpace===KM?"display-p3":"srgb"}}class tE{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Vn(e),this.density=t}clone(){return new tE(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class Tw{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Vn(e),this.near=t,this.far=r}clone(){return new Tw(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Ml extends Pi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Gu,this.environmentIntensity=1,this.environmentRotation=new Gu,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class Mw{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=rM,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Fu()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return a6("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Fu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const vc=new Ze;class Zm{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)vc.fromBufferAttribute(this,t),vc.applyMatrix4(e),this.setXYZ(t,vc.x,vc.y,vc.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)vc.fromBufferAttribute(this,t),vc.applyNormalMatrix(e),this.setXYZ(t,vc.x,vc.y,vc.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)vc.fromBufferAttribute(this,t),vc.transformDirection(e),this.setXYZ(t,vc.x,vc.y,vc.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=Tc(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=Ai(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Tc(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Tc(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Tc(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Tc(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array),i=Ai(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Ai(t,this.array),r=Ai(r,this.array),i=Ai(i,this.array),s=Ai(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new ki(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Zm(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class _D extends ya{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Vn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let A1;const kS=new Ze,T1=new Ze,M1=new Ze,E1=new nn,OS=new nn,Pne=new Gr,i2=new Ze,FS=new Ze,s2=new Ze,yW=new nn,YO=new nn,xW=new nn;class p6 extends Pi{constructor(e=new _D){if(super(),this.isSprite=!0,this.type="Sprite",A1===void 0){A1=new Xr;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new Mw(t,5);A1.setIndex([0,1,2,0,2,3]),A1.setAttribute("position",new Zm(r,3,0,!1)),A1.setAttribute("uv",new Zm(r,2,3,!1))}this.geometry=A1,this.material=e,this.center=new nn(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),T1.setFromMatrixScale(this.matrixWorld),Pne.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),M1.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&T1.multiplyScalar(-M1.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const o=this.center;a2(i2.set(-.5,-.5,0),M1,o,T1,i,s),a2(FS.set(.5,-.5,0),M1,o,T1,i,s),a2(s2.set(.5,.5,0),M1,o,T1,i,s),yW.set(0,0),YO.set(1,0),xW.set(1,1);let l=e.ray.intersectTriangle(i2,FS,s2,!1,kS);if(l===null&&(a2(FS.set(-.5,.5,0),M1,o,T1,i,s),YO.set(0,1),l=e.ray.intersectTriangle(i2,s2,FS,!1,kS),l===null))return;const a=e.ray.origin.distanceTo(kS);a<e.near||a>e.far||t.push({distance:a,point:kS.clone(),uv:$v.getInterpolation(kS,i2,FS,s2,yW,YO,xW,new nn),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function a2(n,e,t,r,i,s){E1.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(OS.x=s*E1.x-i*E1.y,OS.y=i*E1.x+s*E1.y):OS.copy(E1),n.copy(e),n.x+=OS.x,n.y+=OS.y,n.applyMatrix4(Pne)}const o2=new Ze,bW=new Ze;class Lne extends Pi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){o2.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(o2);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){o2.setFromMatrixPosition(e.matrixWorld),bW.setFromMatrixPosition(this.matrixWorld);const r=o2.distanceTo(bW)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let o=t[i].distance;if(t[i].object.visible&&(o-=o*t[i].hysteresis),r>=o)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const o=r[i];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const wW=new Ze,SW=new Rs,AW=new Rs,xbe=new Ze,TW=new Gr,l2=new Ze,KO=new sl,MW=new Gr,JO=new xx;class yD extends Ri{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=B4,this.bindMatrix=new Gr,this.bindMatrixInverse=new Gr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Al),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,l2),this.boundingBox.expandByPoint(l2)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new sl),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,l2),this.boundingSphere.expandByPoint(l2)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),KO.copy(this.boundingSphere),KO.applyMatrix4(i),e.ray.intersectsSphere(KO)!==!1&&(MW.copy(i).invert(),JO.copy(e.ray).applyMatrix4(MW),!(this.boundingBox!==null&&JO.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,JO)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Rs,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===B4?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===nne?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;SW.fromBufferAttribute(i.attributes.skinIndex,e),AW.fromBufferAttribute(i.attributes.skinWeight,e),wW.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=AW.getComponent(s);if(o!==0){const l=SW.getComponent(s);TW.multiplyMatrices(r.bones[l].matrixWorld,r.boneInverses[l]),t.addScaledVector(xbe.copy(wW).applyMatrix4(TW),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class nE extends Pi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Zf extends Xs{constructor(e=null,t=1,r=1,i,s,o,l,a,h=Ao,f=Ao,p,v){super(null,o,l,a,h,f,i,s,p,v),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const EW=new Gr,bbe=new Gr;class Ew{constructor(e=[],t=[]){this.uuid=Fu(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Gr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Gr;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const l=e[s]?e[s].matrixWorld:bbe;EW.multiplyMatrices(l,t[s]),EW.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new Ew(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Zf(t,e,e,Xl,Mc);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new nE),this.bones.push(o),this.boneInverses.push(new Gr().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const o=t[i];e.bones.push(o.uuid);const l=r[i];e.boneInverses.push(l.toArray())}return e}}class m0 extends ki{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const C1=new Gr,CW=new Gr,c2=[],IW=new Al,wbe=new Gr,NS=new Ri,zS=new sl;class xD extends Ri{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new m0(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,wbe)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Al),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,C1),IW.copy(e.boundingBox).applyMatrix4(C1),this.boundingBox.union(IW)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new sl),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,C1),zS.copy(e.boundingSphere).applyMatrix4(C1),this.boundingSphere.union(zS)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const r=t.morphTargetInfluences,i=this.morphTexture.source.data.data,s=r.length+1,o=e*s+1;for(let l=0;l<r.length;l++)r[l]=i[o+l]}raycast(e,t){const r=this.matrixWorld,i=this.count;if(NS.geometry=this.geometry,NS.material=this.material,NS.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),zS.copy(this.boundingSphere),zS.applyMatrix4(r),e.ray.intersectsSphere(zS)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,C1),CW.multiplyMatrices(r,C1),NS.matrixWorld=CW,NS.raycast(e,c2);for(let o=0,l=c2.length;o<l;o++){const a=c2[o];a.instanceId=s,a.object=this,t.push(a)}c2.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new m0(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const r=t.morphTargetInfluences,i=r.length+1;this.morphTexture===null&&(this.morphTexture=new Zf(new Float32Array(i*this.count),i,this.count,qM,Mc));const s=this.morphTexture.source.data.data;let o=0;for(let h=0;h<r.length;h++)o+=r[h];const l=this.geometry.morphTargetsRelative?1:1-o,a=i*e;s[a]=l,s.set(r,a+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function Sbe(n,e){return n.z-e.z}function Abe(n,e){return e.z-n.z}class Tbe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,r){const i=this.pool,s=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1,index:-1});const o=i[this.index];s.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=t,o.index=r}reset(){this.list.length=0,this.index=0}}const gv=new Gr,QO=new Gr,Mbe=new Gr,Ebe=new Vn(1,1,1),RW=new Gr,eF=new eE,u2=new Al,C_=new sl,US=new Ze,PW=new Ze,Cbe=new Ze,tF=new Tbe,Nl=new Ri,h2=[];function Ibe(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let o=0;o<r;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*r);e.needsUpdate=!0}class Dne extends Ri{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,t,r=t*2,i){super(new Xr,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new Zf(t,e,e,Xl,Mc);this._matricesTexture=r}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),r=new Zf(t,e,e,ZM,Xm);this._indirectTexture=r}_initColorsTexture(){let e=Math.sqrt(this._maxIndexCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),r=new Zf(t,e,e,Xl,Mc);r.colorSpace=gs.workingColorSpace,this._colorsTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:l,itemSize:a,normalized:h}=o,f=new l.constructor(r*a),p=new ki(f,a,h);t.setAttribute(s,p)}if(e.getIndex()!==null){const s=r>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new ki(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Al);const e=this._geometryCount,t=this.boundingBox,r=this._drawInfo;t.makeEmpty();for(let i=0;i<e;i++){if(r[i].active===!1)continue;const s=r[i].geometryIndex;this.getMatrixAt(i,gv),this.getBoundingBoxAt(s,u2).applyMatrix4(gv),t.union(u2)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new sl);const e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,gv),this.getBoundingSphereAt(s,C_).applyMatrix4(gv),e.union(C_)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});const t=this._drawInfo.length-1,r=this._matricesTexture,i=r.image.data;Mbe.toArray(i,t*16),r.needsUpdate=!0;const s=this._colorsTexture;return s&&(Ebe.toArray(s.image.data,t*4),s.needsUpdate=!0),t}addGeometry(e,t=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,l=this._drawRanges,a=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=t,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const h=e.getIndex(),f=h!==null;if(f&&(r===-1?i.indexCount=h.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const p=this._geometryCount;return this._geometryCount++,o.push(i),l.push({start:f?i.indexStart:i.vertexStart,count:-1}),a.push({boxInitialized:!1,box:new Al,sphereInitialized:!1,sphere:new sl}),this.setGeometryAt(p,e),p}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),o=t.getIndex(),l=this._reservedRanges[e];if(i&&o.count>l.indexCount||t.attributes.position.count>l.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const a=l.vertexStart,h=l.vertexCount;for(const y in r.attributes){const S=t.getAttribute(y),C=r.getAttribute(y);Ibe(S,C,a);const M=S.itemSize;for(let E=S.count,L=h;E<L;E++){const k=a+E;for(let H=0;H<M;H++)C.setComponent(k,H,0)}C.needsUpdate=!0,C.addUpdateRange(a*M,h*M)}if(i){const y=l.indexStart;for(let S=0;S<o.count;S++)s.setX(y+S,a+o.getX(S));for(let S=o.count,C=l.indexCount;S<C;S++)s.setX(y+S,a);s.needsUpdate=!0,s.addUpdateRange(y,l.indexCount)}const f=this._bounds[e];t.boundingBox!==null?(f.box.copy(t.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,t.boundingSphere!==null?(f.sphere.copy(t.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const p=this._drawRanges[e],v=t.getAttribute("position");return p.count=i?o.count:v.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const r=this._bounds[e],i=r.box,s=this.geometry;if(r.boxInitialized===!1){i.makeEmpty();const o=s.index,l=s.attributes.position,a=this._drawRanges[e];for(let h=a.start,f=a.start+a.count;h<f;h++){let p=h;o&&(p=o.getX(p)),i.expandByPoint(US.fromBufferAttribute(l,p))}r.boxInitialized=!0}return t.copy(i),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const r=this._bounds[e],i=r.sphere,s=this.geometry;if(r.sphereInitialized===!1){i.makeEmpty(),this.getBoundingBoxAt(e,u2),u2.getCenter(i.center);const o=s.index,l=s.attributes.position,a=this._drawRanges[e];let h=0;for(let f=a.start,p=a.start+a.count;f<p;f++){let v=f;o&&(v=o.getX(v)),US.fromBufferAttribute(l,v),h=Math.max(h,i.center.distanceToSquared(US))}i.radius=Math.sqrt(h),r.sphereInitialized=!0}return t.copy(i),t}setMatrixAt(e,t){const r=this._drawInfo,i=this._matricesTexture,s=this._matricesTexture.image.data;return e>=r.length||r[e].active===!1?this:(t.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,t){const r=this._drawInfo,i=this._matricesTexture.image.data;return e>=r.length||r[e].active===!1?null:t.fromArray(i,e*16)}setColorAt(e,t){this._colorsTexture===null&&this._initColorsTexture();const r=this._colorsTexture,i=this._colorsTexture.image.data,s=this._drawInfo;return e>=s.length||s[e].active===!1?this:(t.toArray(i,e*4),r.needsUpdate=!0,this)}getColorAt(e,t){const r=this._colorsTexture.image.data,i=this._drawInfo;return e>=i.length||i[e].active===!1?null:t.fromArray(r,e*4)}setVisibleAt(e,t){const r=this._drawInfo;return e>=r.length||r[e].active===!1||r[e].visible===t?this:(r[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?!1:t[e].visible}raycast(e,t){const r=this._drawInfo,i=this._drawRanges,s=this.matrixWorld,o=this.geometry;Nl.material=this.material,Nl.geometry.index=o.index,Nl.geometry.attributes=o.attributes,Nl.geometry.boundingBox===null&&(Nl.geometry.boundingBox=new Al),Nl.geometry.boundingSphere===null&&(Nl.geometry.boundingSphere=new sl);for(let l=0,a=r.length;l<a;l++){if(!r[l].visible||!r[l].active)continue;const h=r[l].geometryIndex,f=i[h];Nl.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(l,Nl.matrixWorld).premultiply(s),this.getBoundingBoxAt(h,Nl.geometry.boundingBox),this.getBoundingSphereAt(h,Nl.geometry.boundingSphere),Nl.raycast(e,h2);for(let p=0,v=h2.length;p<v;p++){const y=h2[p];y.object=this,y.batchId=l,t.push(y)}h2.length=0}Nl.material=null,Nl.geometry.index=null,Nl.geometry.attributes={},Nl.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._drawInfo=e._drawInfo.map(t=>({...t})),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=i.getIndex(),l=o===null?1:o.array.BYTES_PER_ELEMENT,a=this._drawInfo,h=this._multiDrawStarts,f=this._multiDrawCounts,p=this._drawRanges,v=this.perObjectFrustumCulled,y=this._indirectTexture,S=y.image.data;v&&(RW.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),eF.setFromProjectionMatrix(RW,e.coordinateSystem));let C=0;if(this.sortObjects){QO.copy(this.matrixWorld).invert(),US.setFromMatrixPosition(r.matrixWorld).applyMatrix4(QO),PW.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(QO);for(let L=0,k=a.length;L<k;L++)if(a[L].visible&&a[L].active){const H=a[L].geometryIndex;this.getMatrixAt(L,gv),this.getBoundingSphereAt(H,C_).applyMatrix4(gv);let X=!1;if(v&&(X=!eF.intersectsSphere(C_)),!X){const Z=Cbe.subVectors(C_.center,US).dot(PW);tF.push(p[H],Z,L)}}const M=tF.list,E=this.customSort;E===null?M.sort(s.transparent?Abe:Sbe):E.call(this,M,r);for(let L=0,k=M.length;L<k;L++){const H=M[L];h[C]=H.start*l,f[C]=H.count,S[C]=H.index,C++}tF.reset()}else for(let M=0,E=a.length;M<E;M++)if(a[M].visible&&a[M].active){const L=a[M].geometryIndex;let k=!1;if(v&&(this.getMatrixAt(M,gv),this.getBoundingSphereAt(L,C_).applyMatrix4(gv),k=!eF.intersectsSphere(C_)),!k){const H=p[L];h[C]=H.start*l,f[C]=H.count,S[C]=M,C++}}y.needsUpdate=!0,this._multiDrawCount=C,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,o){this.onBeforeRender(e,null,i,s,o)}}class Eo extends ya{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Vn(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const MP=new Ze,EP=new Ze,LW=new Gr,GS=new xx,f2=new sl,nF=new Ze,DW=new Ze;let Jf=class extends Pi{constructor(e=new Xr,t=new Eo){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)MP.fromBufferAttribute(t,i-1),EP.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=MP.distanceTo(EP);e.setAttribute("lineDistance",new or(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),f2.copy(r.boundingSphere),f2.applyMatrix4(i),f2.radius+=s,e.ray.intersectsSphere(f2)===!1)return;LW.copy(i).invert(),GS.copy(e.ray).applyMatrix4(LW);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),a=l*l,h=this.isLineSegments?2:1,f=r.index,v=r.attributes.position;if(f!==null){const y=Math.max(0,o.start),S=Math.min(f.count,o.start+o.count);for(let C=y,M=S-1;C<M;C+=h){const E=f.getX(C),L=f.getX(C+1),k=d2(this,e,GS,a,E,L);k&&t.push(k)}if(this.isLineLoop){const C=f.getX(S-1),M=f.getX(y),E=d2(this,e,GS,a,C,M);E&&t.push(E)}}else{const y=Math.max(0,o.start),S=Math.min(v.count,o.start+o.count);for(let C=y,M=S-1;C<M;C+=h){const E=d2(this,e,GS,a,C,C+1);E&&t.push(E)}if(this.isLineLoop){const C=d2(this,e,GS,a,S-1,y);C&&t.push(C)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}};function d2(n,e,t,r,i,s){const o=n.geometry.attributes.position;if(MP.fromBufferAttribute(o,i),EP.fromBufferAttribute(o,s),t.distanceSqToSegment(MP,EP,nF,DW)>r)return;nF.applyMatrix4(n.matrixWorld);const a=e.ray.origin.distanceTo(nF);if(!(a<e.near||a>e.far))return{distance:a,point:DW.clone().applyMatrix4(n.matrixWorld),index:i,face:null,faceIndex:null,object:n}}const BW=new Ze,kW=new Ze;class pu extends Jf{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)BW.fromBufferAttribute(t,i),kW.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+BW.distanceTo(kW);e.setAttribute("lineDistance",new or(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class bD extends Jf{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class cu extends ya{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Vn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const OW=new Gr,U4=new xx,p2=new sl,m2=new Ze;class Eh extends Pi{constructor(e=new Xr,t=new cu){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,o=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),p2.copy(r.boundingSphere),p2.applyMatrix4(i),p2.radius+=s,e.ray.intersectsSphere(p2)===!1)return;OW.copy(i).invert(),U4.copy(e.ray).applyMatrix4(OW);const l=s/((this.scale.x+this.scale.y+this.scale.z)/3),a=l*l,h=r.index,p=r.attributes.position;if(h!==null){const v=Math.max(0,o.start),y=Math.min(h.count,o.start+o.count);for(let S=v,C=y;S<C;S++){const M=h.getX(S);m2.fromBufferAttribute(p,M),FW(m2,M,a,i,e,t,this)}}else{const v=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let S=v,C=y;S<C;S++)m2.fromBufferAttribute(p,S),FW(m2,S,a,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}}function FW(n,e,t,r,i,s,o){const l=U4.distanceSqToPoint(n);if(l<t){const a=new Ze;U4.closestPointToPoint(n,a),a.applyMatrix4(r);const h=i.ray.origin.distanceTo(a);if(h<i.near||h>i.far)return;s.push({distance:h,distanceToRay:Math.sqrt(l),point:a,index:e,face:null,object:o})}}class Bne extends Xs{constructor(e,t,r,i,s,o,l,a,h){super(e,t,r,i,s,o,l,a,h),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:Ca,this.magFilter=s!==void 0?s:Ca,this.generateMipmaps=!1;const f=this;function p(){f.needsUpdate=!0,e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(p)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Rbe extends Xs{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ao,this.minFilter=Ao,this.generateMipmaps=!1,this.needsUpdate=!0}}class wD extends Xs{constructor(e,t,r,i,s,o,l,a,h,f,p,v){super(null,o,l,a,h,f,i,s,p,v),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Pbe extends wD{constructor(e,t,r,i,s,o){super(e,t,r,s,o),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=ou,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class Lbe extends wD{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,$m),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class G4 extends Xs{constructor(e,t,r,i,s,o,l,a,h){super(e,t,r,i,s,o,l,a,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class rd{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)r=this.getPoint(o/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const r=this.getLengths();let i=0;const s=r.length;let o;t?o=t:o=e*r[s-1];let l=0,a=s-1,h;for(;l<=a;)if(i=Math.floor(l+(a-l)/2),h=r[i]-o,h<0)l=i+1;else if(h>0)a=i-1;else{a=i;break}if(i=a,r[i]===o)return i/(s-1);const f=r[i],v=r[i+1]-f,y=(o-f)/v;return(i+y)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),l=this.getPoint(s),a=t||(o.isVector2?new nn:new Ze);return a.copy(l).sub(o).normalize(),a}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){const r=new Ze,i=[],s=[],o=[],l=new Ze,a=new Gr;for(let y=0;y<=e;y++){const S=y/e;i[y]=this.getTangentAt(S,new Ze)}s[0]=new Ze,o[0]=new Ze;let h=Number.MAX_VALUE;const f=Math.abs(i[0].x),p=Math.abs(i[0].y),v=Math.abs(i[0].z);f<=h&&(h=f,r.set(1,0,0)),p<=h&&(h=p,r.set(0,1,0)),v<=h&&r.set(0,0,1),l.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],l),o[0].crossVectors(i[0],s[0]);for(let y=1;y<=e;y++){if(s[y]=s[y-1].clone(),o[y]=o[y-1].clone(),l.crossVectors(i[y-1],i[y]),l.length()>Number.EPSILON){l.normalize();const S=Math.acos(to(i[y-1].dot(i[y]),-1,1));s[y].applyMatrix4(a.makeRotationAxis(l,S))}o[y].crossVectors(i[y],s[y])}if(t===!0){let y=Math.acos(to(s[0].dot(s[e]),-1,1));y/=e,i[0].dot(l.crossVectors(s[0],s[e]))>0&&(y=-y);for(let S=1;S<=e;S++)s[S].applyMatrix4(a.makeRotationAxis(i[S],y*S)),o[S].crossVectors(i[S],s[S])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class SD extends rd{constructor(e=0,t=0,r=1,i=1,s=0,o=Math.PI*2,l=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=l,this.aRotation=a}getPoint(e,t=new nn){const r=t,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const l=this.aStartAngle+e*s;let a=this.aX+this.xRadius*Math.cos(l),h=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const f=Math.cos(this.aRotation),p=Math.sin(this.aRotation),v=a-this.aX,y=h-this.aY;a=v*f-y*p+this.aX,h=v*p+y*f+this.aY}return r.set(a,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class kne extends SD{constructor(e,t,r,i,s,o){super(e,t,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function m6(){let n=0,e=0,t=0,r=0;function i(s,o,l,a){n=s,e=l,t=-3*s+3*o-2*l-a,r=2*s-2*o+l+a}return{initCatmullRom:function(s,o,l,a,h){i(o,l,h*(l-s),h*(a-o))},initNonuniformCatmullRom:function(s,o,l,a,h,f,p){let v=(o-s)/h-(l-s)/(h+f)+(l-o)/f,y=(l-o)/f-(a-o)/(f+p)+(a-l)/p;v*=f,y*=f,i(o,l,v,y)},calc:function(s){const o=s*s,l=o*s;return n+e*s+t*o+r*l}}}const g2=new Ze,rF=new m6,iF=new m6,sF=new m6;class One extends rd{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new Ze){const r=t,i=this.points,s=i.length,o=(s-(this.closed?0:1))*e;let l=Math.floor(o),a=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:a===0&&l===s-1&&(l=s-2,a=1);let h,f;this.closed||l>0?h=i[(l-1)%s]:(g2.subVectors(i[0],i[1]).add(i[0]),h=g2);const p=i[l%s],v=i[(l+1)%s];if(this.closed||l+2<s?f=i[(l+2)%s]:(g2.subVectors(i[s-1],i[s-2]).add(i[s-1]),f=g2),this.curveType==="centripetal"||this.curveType==="chordal"){const y=this.curveType==="chordal"?.5:.25;let S=Math.pow(h.distanceToSquared(p),y),C=Math.pow(p.distanceToSquared(v),y),M=Math.pow(v.distanceToSquared(f),y);C<1e-4&&(C=1),S<1e-4&&(S=C),M<1e-4&&(M=C),rF.initNonuniformCatmullRom(h.x,p.x,v.x,f.x,S,C,M),iF.initNonuniformCatmullRom(h.y,p.y,v.y,f.y,S,C,M),sF.initNonuniformCatmullRom(h.z,p.z,v.z,f.z,S,C,M)}else this.curveType==="catmullrom"&&(rF.initCatmullRom(h.x,p.x,v.x,f.x,this.tension),iF.initCatmullRom(h.y,p.y,v.y,f.y,this.tension),sF.initCatmullRom(h.z,p.z,v.z,f.z,this.tension));return r.set(rF.calc(a),iF.calc(a),sF.calc(a)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new Ze().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function NW(n,e,t,r,i){const s=(r-e)*.5,o=(i-t)*.5,l=n*n,a=n*l;return(2*t-2*r+s+o)*a+(-3*t+3*r-2*s-o)*l+s*n+t}function Dbe(n,e){const t=1-n;return t*t*e}function Bbe(n,e){return 2*(1-n)*n*e}function kbe(n,e){return n*n*e}function iT(n,e,t,r){return Dbe(n,e)+Bbe(n,t)+kbe(n,r)}function Obe(n,e){const t=1-n;return t*t*t*e}function Fbe(n,e){const t=1-n;return 3*t*t*n*e}function Nbe(n,e){return 3*(1-n)*n*n*e}function zbe(n,e){return n*n*n*e}function sT(n,e,t,r,i){return Obe(n,e)+Fbe(n,t)+Nbe(n,r)+zbe(n,i)}class g6 extends rd{constructor(e=new nn,t=new nn,r=new nn,i=new nn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new nn){const r=t,i=this.v0,s=this.v1,o=this.v2,l=this.v3;return r.set(sT(e,i.x,s.x,o.x,l.x),sT(e,i.y,s.y,o.y,l.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Fne extends rd{constructor(e=new Ze,t=new Ze,r=new Ze,i=new Ze){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new Ze){const r=t,i=this.v0,s=this.v1,o=this.v2,l=this.v3;return r.set(sT(e,i.x,s.x,o.x,l.x),sT(e,i.y,s.y,o.y,l.y),sT(e,i.z,s.z,o.z,l.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class v6 extends rd{constructor(e=new nn,t=new nn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new nn){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new nn){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Nne extends rd{constructor(e=new Ze,t=new Ze){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Ze){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ze){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _6 extends rd{constructor(e=new nn,t=new nn,r=new nn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new nn){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(iT(e,i.x,s.x,o.x),iT(e,i.y,s.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class y6 extends rd{constructor(e=new Ze,t=new Ze,r=new Ze){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new Ze){const r=t,i=this.v0,s=this.v1,o=this.v2;return r.set(iT(e,i.x,s.x,o.x),iT(e,i.y,s.y,o.y),iT(e,i.z,s.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class x6 extends rd{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new nn){const r=t,i=this.points,s=(i.length-1)*e,o=Math.floor(s),l=s-o,a=i[o===0?o:o-1],h=i[o],f=i[o>i.length-2?i.length-1:o+1],p=i[o>i.length-3?i.length-1:o+2];return r.set(NW(l,a.x,h.x,f.x,p.x),NW(l,a.y,h.y,f.y,p.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new nn().fromArray(i))}return this}}var CP=Object.freeze({__proto__:null,ArcCurve:kne,CatmullRomCurve3:One,CubicBezierCurve:g6,CubicBezierCurve3:Fne,EllipseCurve:SD,LineCurve:v6,LineCurve3:Nne,QuadraticBezierCurve:_6,QuadraticBezierCurve3:y6,SplineCurve:x6});class zne extends rd{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new CP[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,l=this.curves[s],a=l.getLength(),h=a===0?0:1-o/a;return l.getPointAt(h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],l=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,a=o.getPoints(l);for(let h=0;h<a.length;h++){const f=a[h];r&&r.equals(f)||(t.push(f),r=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new CP[i.type]().fromJSON(i))}return this}}let aM=class extends zne{constructor(e){super(),this.type="Path",this.currentPoint=new nn,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new v6(this.currentPoint.clone(),new nn(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new _6(this.currentPoint.clone(),new nn(e,t),new nn(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,o){const l=new g6(this.currentPoint.clone(),new nn(e,t),new nn(r,i),new nn(s,o));return this.curves.push(l),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new x6(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,o){const l=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(e+l,t+a,r,i,s,o),this}absarc(e,t,r,i,s,o){return this.absellipse(e,t,r,r,i,s,o),this}ellipse(e,t,r,i,s,o,l,a){const h=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+h,t+f,r,i,s,o,l,a),this}absellipse(e,t,r,i,s,o,l,a){const h=new SD(e,t,r,i,s,o,l,a);if(this.curves.length>0){const p=h.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(h);const f=h.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}};class rE extends Xr{constructor(e=[new nn(0,-.5),new nn(.5,0),new nn(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=to(i,0,Math.PI*2);const s=[],o=[],l=[],a=[],h=[],f=1/t,p=new Ze,v=new nn,y=new Ze,S=new Ze,C=new Ze;let M=0,E=0;for(let L=0;L<=e.length-1;L++)switch(L){case 0:M=e[L+1].x-e[L].x,E=e[L+1].y-e[L].y,y.x=E*1,y.y=-M,y.z=E*0,C.copy(y),y.normalize(),a.push(y.x,y.y,y.z);break;case e.length-1:a.push(C.x,C.y,C.z);break;default:M=e[L+1].x-e[L].x,E=e[L+1].y-e[L].y,y.x=E*1,y.y=-M,y.z=E*0,S.copy(y),y.x+=C.x,y.y+=C.y,y.z+=C.z,y.normalize(),a.push(y.x,y.y,y.z),C.copy(S)}for(let L=0;L<=t;L++){const k=r+L*f*i,H=Math.sin(k),X=Math.cos(k);for(let Z=0;Z<=e.length-1;Z++){p.x=e[Z].x*H,p.y=e[Z].y,p.z=e[Z].x*X,o.push(p.x,p.y,p.z),v.x=L/t,v.y=Z/(e.length-1),l.push(v.x,v.y);const Q=a[3*Z+0]*H,re=a[3*Z+1],ie=a[3*Z+0]*X;h.push(Q,re,ie)}}for(let L=0;L<t;L++)for(let k=0;k<e.length-1;k++){const H=k+L*e.length,X=H,Z=H+e.length,Q=H+e.length+1,re=H+1;s.push(X,Z,re),s.push(Q,re,Z)}this.setIndex(s),this.setAttribute("position",new or(o,3)),this.setAttribute("uv",new or(l,2)),this.setAttribute("normal",new or(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new rE(e.points,e.segments,e.phiStart,e.phiLength)}}class AD extends rE{constructor(e=1,t=1,r=4,i=8){const s=new aM;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:r,radialSegments:i}}static fromJSON(e){return new AD(e.radius,e.length,e.capSegments,e.radialSegments)}}class TD extends Xr{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],o=[],l=[],a=[],h=new Ze,f=new nn;o.push(0,0,0),l.push(0,0,1),a.push(.5,.5);for(let p=0,v=3;p<=t;p++,v+=3){const y=r+p/t*i;h.x=e*Math.cos(y),h.y=e*Math.sin(y),o.push(h.x,h.y,h.z),l.push(0,0,1),f.x=(o[v]/e+1)/2,f.y=(o[v+1]/e+1)/2,a.push(f.x,f.y)}for(let p=1;p<=t;p++)s.push(p,p+1,0);this.setIndex(s),this.setAttribute("position",new or(o,3)),this.setAttribute("normal",new or(l,3)),this.setAttribute("uv",new or(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new TD(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Cw extends Xr{constructor(e=1,t=1,r=1,i=32,s=1,o=!1,l=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:o,thetaStart:l,thetaLength:a};const h=this;i=Math.floor(i),s=Math.floor(s);const f=[],p=[],v=[],y=[];let S=0;const C=[],M=r/2;let E=0;L(),o===!1&&(e>0&&k(!0),t>0&&k(!1)),this.setIndex(f),this.setAttribute("position",new or(p,3)),this.setAttribute("normal",new or(v,3)),this.setAttribute("uv",new or(y,2));function L(){const H=new Ze,X=new Ze;let Z=0;const Q=(t-e)/r;for(let re=0;re<=s;re++){const ie=[],oe=re/s,fe=oe*(t-e)+e;for(let Se=0;Se<=i;Se++){const Ee=Se/i,Ie=Ee*a+l,He=Math.sin(Ie),Re=Math.cos(Ie);X.x=fe*He,X.y=-oe*r+M,X.z=fe*Re,p.push(X.x,X.y,X.z),H.set(He,Q,Re).normalize(),v.push(H.x,H.y,H.z),y.push(Ee,1-oe),ie.push(S++)}C.push(ie)}for(let re=0;re<i;re++)for(let ie=0;ie<s;ie++){const oe=C[ie][re],fe=C[ie+1][re],Se=C[ie+1][re+1],Ee=C[ie][re+1];f.push(oe,fe,Ee),f.push(fe,Se,Ee),Z+=6}h.addGroup(E,Z,0),E+=Z}function k(H){const X=S,Z=new nn,Q=new Ze;let re=0;const ie=H===!0?e:t,oe=H===!0?1:-1;for(let Se=1;Se<=i;Se++)p.push(0,M*oe,0),v.push(0,oe,0),y.push(.5,.5),S++;const fe=S;for(let Se=0;Se<=i;Se++){const Ie=Se/i*a+l,He=Math.cos(Ie),Re=Math.sin(Ie);Q.x=ie*Re,Q.y=M*oe,Q.z=ie*He,p.push(Q.x,Q.y,Q.z),v.push(0,oe,0),Z.x=He*.5+.5,Z.y=Re*.5*oe+.5,y.push(Z.x,Z.y),S++}for(let Se=0;Se<i;Se++){const Ee=X+Se,Ie=fe+Se;H===!0?f.push(Ie,Ie+1,Ee):f.push(Ie+1,Ie,Ee),re+=3}h.addGroup(E,re,H===!0?1:2),E+=re}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cw(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class MD extends Cw{constructor(e=1,t=1,r=32,i=1,s=!1,o=0,l=Math.PI*2){super(0,e,t,r,i,s,o,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:o,thetaLength:l}}static fromJSON(e){return new MD(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class L0 extends Xr{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],o=[];l(i),h(r),f(),this.setAttribute("position",new or(s,3)),this.setAttribute("normal",new or(s.slice(),3)),this.setAttribute("uv",new or(o,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function l(L){const k=new Ze,H=new Ze,X=new Ze;for(let Z=0;Z<t.length;Z+=3)y(t[Z+0],k),y(t[Z+1],H),y(t[Z+2],X),a(k,H,X,L)}function a(L,k,H,X){const Z=X+1,Q=[];for(let re=0;re<=Z;re++){Q[re]=[];const ie=L.clone().lerp(H,re/Z),oe=k.clone().lerp(H,re/Z),fe=Z-re;for(let Se=0;Se<=fe;Se++)Se===0&&re===Z?Q[re][Se]=ie:Q[re][Se]=ie.clone().lerp(oe,Se/fe)}for(let re=0;re<Z;re++)for(let ie=0;ie<2*(Z-re)-1;ie++){const oe=Math.floor(ie/2);ie%2===0?(v(Q[re][oe+1]),v(Q[re+1][oe]),v(Q[re][oe])):(v(Q[re][oe+1]),v(Q[re+1][oe+1]),v(Q[re+1][oe]))}}function h(L){const k=new Ze;for(let H=0;H<s.length;H+=3)k.x=s[H+0],k.y=s[H+1],k.z=s[H+2],k.normalize().multiplyScalar(L),s[H+0]=k.x,s[H+1]=k.y,s[H+2]=k.z}function f(){const L=new Ze;for(let k=0;k<s.length;k+=3){L.x=s[k+0],L.y=s[k+1],L.z=s[k+2];const H=M(L)/2/Math.PI+.5,X=E(L)/Math.PI+.5;o.push(H,1-X)}S(),p()}function p(){for(let L=0;L<o.length;L+=6){const k=o[L+0],H=o[L+2],X=o[L+4],Z=Math.max(k,H,X),Q=Math.min(k,H,X);Z>.9&&Q<.1&&(k<.2&&(o[L+0]+=1),H<.2&&(o[L+2]+=1),X<.2&&(o[L+4]+=1))}}function v(L){s.push(L.x,L.y,L.z)}function y(L,k){const H=L*3;k.x=e[H+0],k.y=e[H+1],k.z=e[H+2]}function S(){const L=new Ze,k=new Ze,H=new Ze,X=new Ze,Z=new nn,Q=new nn,re=new nn;for(let ie=0,oe=0;ie<s.length;ie+=9,oe+=6){L.set(s[ie+0],s[ie+1],s[ie+2]),k.set(s[ie+3],s[ie+4],s[ie+5]),H.set(s[ie+6],s[ie+7],s[ie+8]),Z.set(o[oe+0],o[oe+1]),Q.set(o[oe+2],o[oe+3]),re.set(o[oe+4],o[oe+5]),X.copy(L).add(k).add(H).divideScalar(3);const fe=M(X);C(Z,oe+0,L,fe),C(Q,oe+2,k,fe),C(re,oe+4,H,fe)}}function C(L,k,H,X){X<0&&L.x===1&&(o[k]=L.x-1),H.x===0&&H.z===0&&(o[k]=X/2/Math.PI+.5)}function M(L){return Math.atan2(L.z,-L.x)}function E(L){return Math.atan2(-L.y,Math.sqrt(L.x*L.x+L.z*L.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new L0(e.vertices,e.indices,e.radius,e.details)}}class ED extends L0{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ED(e.radius,e.detail)}}const v2=new Ze,_2=new Ze,aF=new Ze,y2=new $v;class Une extends Xr{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(Ny*t),o=e.getIndex(),l=e.getAttribute("position"),a=o?o.count:l.count,h=[0,0,0],f=["a","b","c"],p=new Array(3),v={},y=[];for(let S=0;S<a;S+=3){o?(h[0]=o.getX(S),h[1]=o.getX(S+1),h[2]=o.getX(S+2)):(h[0]=S,h[1]=S+1,h[2]=S+2);const{a:C,b:M,c:E}=y2;if(C.fromBufferAttribute(l,h[0]),M.fromBufferAttribute(l,h[1]),E.fromBufferAttribute(l,h[2]),y2.getNormal(aF),p[0]=`${Math.round(C.x*i)},${Math.round(C.y*i)},${Math.round(C.z*i)}`,p[1]=`${Math.round(M.x*i)},${Math.round(M.y*i)},${Math.round(M.z*i)}`,p[2]=`${Math.round(E.x*i)},${Math.round(E.y*i)},${Math.round(E.z*i)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let L=0;L<3;L++){const k=(L+1)%3,H=p[L],X=p[k],Z=y2[f[L]],Q=y2[f[k]],re=`${H}_${X}`,ie=`${X}_${H}`;ie in v&&v[ie]?(aF.dot(v[ie].normal)<=s&&(y.push(Z.x,Z.y,Z.z),y.push(Q.x,Q.y,Q.z)),v[ie]=null):re in v||(v[re]={index0:h[L],index1:h[k],normal:aF.clone()})}}for(const S in v)if(v[S]){const{index0:C,index1:M}=v[S];v2.fromBufferAttribute(l,C),_2.fromBufferAttribute(l,M),y.push(v2.x,v2.y,v2.z),y.push(_2.x,_2.y,_2.z)}this.setAttribute("position",new or(y,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Uy extends aM{constructor(e){super(e),this.uuid=Fu(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new aM().fromJSON(i))}return this}}const Ube={triangulate:function(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=Gne(n,0,i,t,!0);const o=[];if(!s||s.next===s.prev)return o;let l,a,h,f,p,v,y;if(r&&(s=Wbe(n,e,s,t)),n.length>80*t){l=h=n[0],a=f=n[1];for(let S=t;S<i;S+=t)p=n[S],v=n[S+1],p<l&&(l=p),v<a&&(a=v),p>h&&(h=p),v>f&&(f=v);y=Math.max(h-l,f-a),y=y!==0?32767/y:0}return oM(s,o,t,l,a,y,0),o}};function Gne(n,e,t,r,i){let s,o;if(i===nwe(n,e,t,r)>0)for(s=e;s<t;s+=r)o=zW(s,n[s],n[s+1],o);else for(s=t-r;s>=e;s-=r)o=zW(s,n[s],n[s+1],o);return o&&CD(o,o.next)&&(cM(o),o=o.next),o}function ix(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&(CD(t,t.next)||Ga(t.prev,t,t.next)===0)){if(cM(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function oM(n,e,t,r,i,s,o){if(!n)return;!o&&s&&Ybe(n,r,i,s);let l=n,a,h;for(;n.prev!==n.next;){if(a=n.prev,h=n.next,s?Vbe(n,r,i,s):Gbe(n)){e.push(a.i/t|0),e.push(n.i/t|0),e.push(h.i/t|0),cM(n),n=h.next,l=h.next;continue}if(n=h,n===l){o?o===1?(n=Hbe(ix(n),e,t),oM(n,e,t,r,i,s,2)):o===2&&jbe(n,e,t,r,i,s):oM(ix(n),e,t,r,i,s,1);break}}}function Gbe(n){const e=n.prev,t=n,r=n.next;if(Ga(e,t,r)>=0)return!1;const i=e.x,s=t.x,o=r.x,l=e.y,a=t.y,h=r.y,f=i<s?i<o?i:o:s<o?s:o,p=l<a?l<h?l:h:a<h?a:h,v=i>s?i>o?i:o:s>o?s:o,y=l>a?l>h?l:h:a>h?a:h;let S=r.next;for(;S!==e;){if(S.x>=f&&S.x<=v&&S.y>=p&&S.y<=y&&bb(i,l,s,a,o,h,S.x,S.y)&&Ga(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}function Vbe(n,e,t,r){const i=n.prev,s=n,o=n.next;if(Ga(i,s,o)>=0)return!1;const l=i.x,a=s.x,h=o.x,f=i.y,p=s.y,v=o.y,y=l<a?l<h?l:h:a<h?a:h,S=f<p?f<v?f:v:p<v?p:v,C=l>a?l>h?l:h:a>h?a:h,M=f>p?f>v?f:v:p>v?p:v,E=V4(y,S,e,t,r),L=V4(C,M,e,t,r);let k=n.prevZ,H=n.nextZ;for(;k&&k.z>=E&&H&&H.z<=L;){if(k.x>=y&&k.x<=C&&k.y>=S&&k.y<=M&&k!==i&&k!==o&&bb(l,f,a,p,h,v,k.x,k.y)&&Ga(k.prev,k,k.next)>=0||(k=k.prevZ,H.x>=y&&H.x<=C&&H.y>=S&&H.y<=M&&H!==i&&H!==o&&bb(l,f,a,p,h,v,H.x,H.y)&&Ga(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;k&&k.z>=E;){if(k.x>=y&&k.x<=C&&k.y>=S&&k.y<=M&&k!==i&&k!==o&&bb(l,f,a,p,h,v,k.x,k.y)&&Ga(k.prev,k,k.next)>=0)return!1;k=k.prevZ}for(;H&&H.z<=L;){if(H.x>=y&&H.x<=C&&H.y>=S&&H.y<=M&&H!==i&&H!==o&&bb(l,f,a,p,h,v,H.x,H.y)&&Ga(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function Hbe(n,e,t){let r=n;do{const i=r.prev,s=r.next.next;!CD(i,s)&&Vne(i,r,r.next,s)&&lM(i,s)&&lM(s,i)&&(e.push(i.i/t|0),e.push(r.i/t|0),e.push(s.i/t|0),cM(r),cM(r.next),r=n=s),r=r.next}while(r!==n);return ix(r)}function jbe(n,e,t,r,i,s){let o=n;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&Qbe(o,l)){let a=Hne(o,l);o=ix(o,o.next),a=ix(a,a.next),oM(o,e,t,r,i,s,0),oM(a,e,t,r,i,s,0);return}l=l.next}o=o.next}while(o!==n)}function Wbe(n,e,t,r){const i=[];let s,o,l,a,h;for(s=0,o=e.length;s<o;s++)l=e[s]*r,a=s<o-1?e[s+1]*r:n.length,h=Gne(n,l,a,r,!1),h===h.next&&(h.steiner=!0),i.push(Jbe(h));for(i.sort($be),s=0;s<i.length;s++)t=Xbe(i[s],t);return t}function $be(n,e){return n.x-e.x}function Xbe(n,e){const t=qbe(n,e);if(!t)return e;const r=Hne(t,n);return ix(r,r.next),ix(t,t.next)}function qbe(n,e){let t=e,r=-1/0,i;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const v=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=s&&v>r&&(r=v,i=t.x<t.next.x?t:t.next,v===s))return i}t=t.next}while(t!==e);if(!i)return null;const l=i,a=i.x,h=i.y;let f=1/0,p;t=i;do s>=t.x&&t.x>=a&&s!==t.x&&bb(o<h?s:r,o,a,h,o<h?r:s,o,t.x,t.y)&&(p=Math.abs(o-t.y)/(s-t.x),lM(t,n)&&(p<f||p===f&&(t.x>i.x||t.x===i.x&&Zbe(i,t)))&&(i=t,f=p)),t=t.next;while(t!==l);return i}function Zbe(n,e){return Ga(n.prev,n,e.prev)<0&&Ga(e.next,n,n.next)<0}function Ybe(n,e,t,r){let i=n;do i.z===0&&(i.z=V4(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,Kbe(i)}function Kbe(n){let e,t,r,i,s,o,l,a,h=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,r=t,l=0,e=0;e<h&&(l++,r=r.nextZ,!!r);e++);for(a=h;l>0||a>0&&r;)l!==0&&(a===0||!r||t.z<=r.z)?(i=t,t=t.nextZ,l--):(i=r,r=r.nextZ,a--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;t=r}s.nextZ=null,h*=2}while(o>1);return n}function V4(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Jbe(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function bb(n,e,t,r,i,s,o,l){return(i-o)*(e-l)>=(n-o)*(s-l)&&(n-o)*(r-l)>=(t-o)*(e-l)&&(t-o)*(s-l)>=(i-o)*(r-l)}function Qbe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!ewe(n,e)&&(lM(n,e)&&lM(e,n)&&twe(n,e)&&(Ga(n.prev,n,e.prev)||Ga(n,e.prev,e))||CD(n,e)&&Ga(n.prev,n,n.next)>0&&Ga(e.prev,e,e.next)>0)}function Ga(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function CD(n,e){return n.x===e.x&&n.y===e.y}function Vne(n,e,t,r){const i=b2(Ga(n,e,t)),s=b2(Ga(n,e,r)),o=b2(Ga(t,r,n)),l=b2(Ga(t,r,e));return!!(i!==s&&o!==l||i===0&&x2(n,t,e)||s===0&&x2(n,r,e)||o===0&&x2(t,n,r)||l===0&&x2(t,e,r))}function x2(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function b2(n){return n>0?1:n<0?-1:0}function ewe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&Vne(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function lM(n,e){return Ga(n.prev,n,n.next)<0?Ga(n,e,n.next)>=0&&Ga(n,n.prev,e)>=0:Ga(n,e,n.prev)<0||Ga(n,n.next,e)<0}function twe(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function Hne(n,e){const t=new H4(n.i,n.x,n.y),r=new H4(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function zW(n,e,t,r){const i=new H4(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function cM(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function H4(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function nwe(n,e,t,r){let i=0;for(let s=e,o=t-r;s<t;s+=r)i+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return i}class hp{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return hp.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];UW(e),GW(r,e);let o=e.length;t.forEach(UW);for(let a=0;a<t.length;a++)i.push(o),o+=t[a].length,GW(r,t[a]);const l=Ube.triangulate(r,i);for(let a=0;a<l.length;a+=3)s.push(l.slice(a,a+3));return s}}function UW(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function GW(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class ID extends Xr{constructor(e=new Uy([new nn(.5,.5),new nn(-.5,.5),new nn(-.5,-.5),new nn(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let l=0,a=e.length;l<a;l++){const h=e[l];o(h)}this.setAttribute("position",new or(i,3)),this.setAttribute("uv",new or(s,2)),this.computeVertexNormals();function o(l){const a=[],h=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1;let v=t.bevelEnabled!==void 0?t.bevelEnabled:!0,y=t.bevelThickness!==void 0?t.bevelThickness:.2,S=t.bevelSize!==void 0?t.bevelSize:y-.1,C=t.bevelOffset!==void 0?t.bevelOffset:0,M=t.bevelSegments!==void 0?t.bevelSegments:3;const E=t.extrudePath,L=t.UVGenerator!==void 0?t.UVGenerator:rwe;let k,H=!1,X,Z,Q,re;E&&(k=E.getSpacedPoints(f),H=!0,v=!1,X=E.computeFrenetFrames(f,!1),Z=new Ze,Q=new Ze,re=new Ze),v||(M=0,y=0,S=0,C=0);const ie=l.extractPoints(h);let oe=ie.shape;const fe=ie.holes;if(!hp.isClockWise(oe)){oe=oe.reverse();for(let qe=0,mn=fe.length;qe<mn;qe++){const cn=fe[qe];hp.isClockWise(cn)&&(fe[qe]=cn.reverse())}}const Ee=hp.triangulateShape(oe,fe),Ie=oe;for(let qe=0,mn=fe.length;qe<mn;qe++){const cn=fe[qe];oe=oe.concat(cn)}function He(qe,mn,cn){return mn||console.error("THREE.ExtrudeGeometry: vec does not exist"),qe.clone().addScaledVector(mn,cn)}const Re=oe.length,st=Ee.length;function _e(qe,mn,cn){let St,Jt,kn;const Gn=qe.x-mn.x,sn=qe.y-mn.y,ot=cn.x-qe.x,Ge=cn.y-qe.y,Xt=Gn*Gn+sn*sn,An=Gn*Ge-sn*ot;if(Math.abs(An)>Number.EPSILON){const Sn=Math.sqrt(Xt),jt=Math.sqrt(ot*ot+Ge*Ge),mr=mn.x-sn/Sn,Un=mn.y+Gn/Sn,tr=cn.x-Ge/jt,Sr=cn.y+ot/jt,Ln=((tr-mr)*Ge-(Sr-Un)*ot)/(Gn*Ge-sn*ot);St=mr+Gn*Ln-qe.x,Jt=Un+sn*Ln-qe.y;const ir=St*St+Jt*Jt;if(ir<=2)return new nn(St,Jt);kn=Math.sqrt(ir/2)}else{let Sn=!1;Gn>Number.EPSILON?ot>Number.EPSILON&&(Sn=!0):Gn<-Number.EPSILON?ot<-Number.EPSILON&&(Sn=!0):Math.sign(sn)===Math.sign(Ge)&&(Sn=!0),Sn?(St=-sn,Jt=Gn,kn=Math.sqrt(Xt)):(St=Gn,Jt=sn,kn=Math.sqrt(Xt/2))}return new nn(St/kn,Jt/kn)}const We=[];for(let qe=0,mn=Ie.length,cn=mn-1,St=qe+1;qe<mn;qe++,cn++,St++)cn===mn&&(cn=0),St===mn&&(St=0),We[qe]=_e(Ie[qe],Ie[cn],Ie[St]);const Ue=[];let vt,xt=We.concat();for(let qe=0,mn=fe.length;qe<mn;qe++){const cn=fe[qe];vt=[];for(let St=0,Jt=cn.length,kn=Jt-1,Gn=St+1;St<Jt;St++,kn++,Gn++)kn===Jt&&(kn=0),Gn===Jt&&(Gn=0),vt[St]=_e(cn[St],cn[kn],cn[Gn]);Ue.push(vt),xt=xt.concat(vt)}for(let qe=0;qe<M;qe++){const mn=qe/M,cn=y*Math.cos(mn*Math.PI/2),St=S*Math.sin(mn*Math.PI/2)+C;for(let Jt=0,kn=Ie.length;Jt<kn;Jt++){const Gn=He(Ie[Jt],We[Jt],St);rn(Gn.x,Gn.y,-cn)}for(let Jt=0,kn=fe.length;Jt<kn;Jt++){const Gn=fe[Jt];vt=Ue[Jt];for(let sn=0,ot=Gn.length;sn<ot;sn++){const Ge=He(Gn[sn],vt[sn],St);rn(Ge.x,Ge.y,-cn)}}}const Vt=S+C;for(let qe=0;qe<Re;qe++){const mn=v?He(oe[qe],xt[qe],Vt):oe[qe];H?(Q.copy(X.normals[0]).multiplyScalar(mn.x),Z.copy(X.binormals[0]).multiplyScalar(mn.y),re.copy(k[0]).add(Q).add(Z),rn(re.x,re.y,re.z)):rn(mn.x,mn.y,0)}for(let qe=1;qe<=f;qe++)for(let mn=0;mn<Re;mn++){const cn=v?He(oe[mn],xt[mn],Vt):oe[mn];H?(Q.copy(X.normals[qe]).multiplyScalar(cn.x),Z.copy(X.binormals[qe]).multiplyScalar(cn.y),re.copy(k[qe]).add(Q).add(Z),rn(re.x,re.y,re.z)):rn(cn.x,cn.y,p/f*qe)}for(let qe=M-1;qe>=0;qe--){const mn=qe/M,cn=y*Math.cos(mn*Math.PI/2),St=S*Math.sin(mn*Math.PI/2)+C;for(let Jt=0,kn=Ie.length;Jt<kn;Jt++){const Gn=He(Ie[Jt],We[Jt],St);rn(Gn.x,Gn.y,p+cn)}for(let Jt=0,kn=fe.length;Jt<kn;Jt++){const Gn=fe[Jt];vt=Ue[Jt];for(let sn=0,ot=Gn.length;sn<ot;sn++){const Ge=He(Gn[sn],vt[sn],St);H?rn(Ge.x,Ge.y+k[f-1].y,k[f-1].x+cn):rn(Ge.x,Ge.y,p+cn)}}}lt(),Ht();function lt(){const qe=i.length/3;if(v){let mn=0,cn=Re*mn;for(let St=0;St<st;St++){const Jt=Ee[St];jn(Jt[2]+cn,Jt[1]+cn,Jt[0]+cn)}mn=f+M*2,cn=Re*mn;for(let St=0;St<st;St++){const Jt=Ee[St];jn(Jt[0]+cn,Jt[1]+cn,Jt[2]+cn)}}else{for(let mn=0;mn<st;mn++){const cn=Ee[mn];jn(cn[2],cn[1],cn[0])}for(let mn=0;mn<st;mn++){const cn=Ee[mn];jn(cn[0]+Re*f,cn[1]+Re*f,cn[2]+Re*f)}}r.addGroup(qe,i.length/3-qe,0)}function Ht(){const qe=i.length/3;let mn=0;Qt(Ie,mn),mn+=Ie.length;for(let cn=0,St=fe.length;cn<St;cn++){const Jt=fe[cn];Qt(Jt,mn),mn+=Jt.length}r.addGroup(qe,i.length/3-qe,1)}function Qt(qe,mn){let cn=qe.length;for(;--cn>=0;){const St=cn;let Jt=cn-1;Jt<0&&(Jt=qe.length-1);for(let kn=0,Gn=f+M*2;kn<Gn;kn++){const sn=Re*kn,ot=Re*(kn+1),Ge=mn+St+sn,Xt=mn+Jt+sn,An=mn+Jt+ot,Sn=mn+St+ot;Bn(Ge,Xt,An,Sn)}}}function rn(qe,mn,cn){a.push(qe),a.push(mn),a.push(cn)}function jn(qe,mn,cn){Tn(qe),Tn(mn),Tn(cn);const St=i.length/3,Jt=L.generateTopUV(r,i,St-3,St-2,St-1);Le(Jt[0]),Le(Jt[1]),Le(Jt[2])}function Bn(qe,mn,cn,St){Tn(qe),Tn(mn),Tn(St),Tn(mn),Tn(cn),Tn(St);const Jt=i.length/3,kn=L.generateSideWallUV(r,i,Jt-6,Jt-3,Jt-2,Jt-1);Le(kn[0]),Le(kn[1]),Le(kn[3]),Le(kn[1]),Le(kn[2]),Le(kn[3])}function Tn(qe){i.push(a[qe*3+0]),i.push(a[qe*3+1]),i.push(a[qe*3+2])}function Le(qe){s.push(qe.x),s.push(qe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return iwe(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,o=e.shapes.length;s<o;s++){const l=t[e.shapes[s]];r.push(l)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new CP[i.type]().fromJSON(i)),new ID(r,e.options)}}const rwe={generateTopUV:function(n,e,t,r,i){const s=e[t*3],o=e[t*3+1],l=e[r*3],a=e[r*3+1],h=e[i*3],f=e[i*3+1];return[new nn(s,o),new nn(l,a),new nn(h,f)]},generateSideWallUV:function(n,e,t,r,i,s){const o=e[t*3],l=e[t*3+1],a=e[t*3+2],h=e[r*3],f=e[r*3+1],p=e[r*3+2],v=e[i*3],y=e[i*3+1],S=e[i*3+2],C=e[s*3],M=e[s*3+1],E=e[s*3+2];return Math.abs(l-f)<Math.abs(o-h)?[new nn(o,1-a),new nn(h,1-p),new nn(v,1-S),new nn(C,1-E)]:[new nn(l,1-a),new nn(f,1-p),new nn(y,1-S),new nn(M,1-E)]}};function iwe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class sx extends L0{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new sx(e.radius,e.detail)}}class iE extends L0{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new iE(e.radius,e.detail)}}class RD extends Xr{constructor(e=.5,t=1,r=32,i=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:o},r=Math.max(3,r),i=Math.max(1,i);const l=[],a=[],h=[],f=[];let p=e;const v=(t-e)/i,y=new Ze,S=new nn;for(let C=0;C<=i;C++){for(let M=0;M<=r;M++){const E=s+M/r*o;y.x=p*Math.cos(E),y.y=p*Math.sin(E),a.push(y.x,y.y,y.z),h.push(0,0,1),S.x=(y.x/t+1)/2,S.y=(y.y/t+1)/2,f.push(S.x,S.y)}p+=v}for(let C=0;C<i;C++){const M=C*(r+1);for(let E=0;E<r;E++){const L=E+M,k=L,H=L+r+1,X=L+r+2,Z=L+1;l.push(k,H,Z),l.push(H,X,Z)}}this.setIndex(l),this.setAttribute("position",new or(a,3)),this.setAttribute("normal",new or(h,3)),this.setAttribute("uv",new or(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new RD(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class PD extends Xr{constructor(e=new Uy([new nn(0,.5),new nn(-.5,-.5),new nn(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],o=[];let l=0,a=0;if(Array.isArray(e)===!1)h(e);else for(let f=0;f<e.length;f++)h(e[f]),this.addGroup(l,a,f),l+=a,a=0;this.setIndex(r),this.setAttribute("position",new or(i,3)),this.setAttribute("normal",new or(s,3)),this.setAttribute("uv",new or(o,2));function h(f){const p=i.length/3,v=f.extractPoints(t);let y=v.shape;const S=v.holes;hp.isClockWise(y)===!1&&(y=y.reverse());for(let M=0,E=S.length;M<E;M++){const L=S[M];hp.isClockWise(L)===!0&&(S[M]=L.reverse())}const C=hp.triangulateShape(y,S);for(let M=0,E=S.length;M<E;M++){const L=S[M];y=y.concat(L)}for(let M=0,E=y.length;M<E;M++){const L=y[M];i.push(L.x,L.y,0),s.push(0,0,1),o.push(L.x,L.y)}for(let M=0,E=C.length;M<E;M++){const L=C[M],k=L[0]+p,H=L[1]+p,X=L[2]+p;r.push(k,H,X),a+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return swe(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const o=t[e.shapes[i]];r.push(o)}return new PD(r,e.curveSegments)}}function swe(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class Nm extends Xr{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,o=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:o,thetaLength:l},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const a=Math.min(o+l,Math.PI);let h=0;const f=[],p=new Ze,v=new Ze,y=[],S=[],C=[],M=[];for(let E=0;E<=r;E++){const L=[],k=E/r;let H=0;E===0&&o===0?H=.5/t:E===r&&a===Math.PI&&(H=-.5/t);for(let X=0;X<=t;X++){const Z=X/t;p.x=-e*Math.cos(i+Z*s)*Math.sin(o+k*l),p.y=e*Math.cos(o+k*l),p.z=e*Math.sin(i+Z*s)*Math.sin(o+k*l),S.push(p.x,p.y,p.z),v.copy(p).normalize(),C.push(v.x,v.y,v.z),M.push(Z+H,1-k),L.push(h++)}f.push(L)}for(let E=0;E<r;E++)for(let L=0;L<t;L++){const k=f[E][L+1],H=f[E][L],X=f[E+1][L],Z=f[E+1][L+1];(E!==0||o>0)&&y.push(k,H,Z),(E!==r-1||a<Math.PI)&&y.push(H,X,Z)}this.setIndex(y),this.setAttribute("position",new or(S,3)),this.setAttribute("normal",new or(C,3)),this.setAttribute("uv",new or(M,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Nm(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class LD extends L0{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new LD(e.radius,e.detail)}}class sE extends Xr{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const o=[],l=[],a=[],h=[],f=new Ze,p=new Ze,v=new Ze;for(let y=0;y<=r;y++)for(let S=0;S<=i;S++){const C=S/i*s,M=y/r*Math.PI*2;p.x=(e+t*Math.cos(M))*Math.cos(C),p.y=(e+t*Math.cos(M))*Math.sin(C),p.z=t*Math.sin(M),l.push(p.x,p.y,p.z),f.x=e*Math.cos(C),f.y=e*Math.sin(C),v.subVectors(p,f).normalize(),a.push(v.x,v.y,v.z),h.push(S/i),h.push(y/r)}for(let y=1;y<=r;y++)for(let S=1;S<=i;S++){const C=(i+1)*y+S-1,M=(i+1)*(y-1)+S-1,E=(i+1)*(y-1)+S,L=(i+1)*y+S;o.push(C,M,L),o.push(M,E,L)}this.setIndex(o),this.setAttribute("position",new or(l,3)),this.setAttribute("normal",new or(a,3)),this.setAttribute("uv",new or(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sE(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class DD extends Xr{constructor(e=1,t=.4,r=64,i=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:o},r=Math.floor(r),i=Math.floor(i);const l=[],a=[],h=[],f=[],p=new Ze,v=new Ze,y=new Ze,S=new Ze,C=new Ze,M=new Ze,E=new Ze;for(let k=0;k<=r;++k){const H=k/r*s*Math.PI*2;L(H,s,o,e,y),L(H+.01,s,o,e,S),M.subVectors(S,y),E.addVectors(S,y),C.crossVectors(M,E),E.crossVectors(C,M),C.normalize(),E.normalize();for(let X=0;X<=i;++X){const Z=X/i*Math.PI*2,Q=-t*Math.cos(Z),re=t*Math.sin(Z);p.x=y.x+(Q*E.x+re*C.x),p.y=y.y+(Q*E.y+re*C.y),p.z=y.z+(Q*E.z+re*C.z),a.push(p.x,p.y,p.z),v.subVectors(p,y).normalize(),h.push(v.x,v.y,v.z),f.push(k/r),f.push(X/i)}}for(let k=1;k<=r;k++)for(let H=1;H<=i;H++){const X=(i+1)*(k-1)+(H-1),Z=(i+1)*k+(H-1),Q=(i+1)*k+H,re=(i+1)*(k-1)+H;l.push(X,Z,re),l.push(Z,Q,re)}this.setIndex(l),this.setAttribute("position",new or(a,3)),this.setAttribute("normal",new or(h,3)),this.setAttribute("uv",new or(f,2));function L(k,H,X,Z,Q){const re=Math.cos(k),ie=Math.sin(k),oe=X/H*k,fe=Math.cos(oe);Q.x=Z*(2+fe)*.5*re,Q.y=Z*(2+fe)*ie*.5,Q.z=Z*Math.sin(oe)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new DD(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class BD extends Xr{constructor(e=new y6(new Ze(-1,-1,0),new Ze(-1,1,0),new Ze(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const l=new Ze,a=new Ze,h=new nn;let f=new Ze;const p=[],v=[],y=[],S=[];C(),this.setIndex(S),this.setAttribute("position",new or(p,3)),this.setAttribute("normal",new or(v,3)),this.setAttribute("uv",new or(y,2));function C(){for(let k=0;k<t;k++)M(k);M(s===!1?t:0),L(),E()}function M(k){f=e.getPointAt(k/t,f);const H=o.normals[k],X=o.binormals[k];for(let Z=0;Z<=i;Z++){const Q=Z/i*Math.PI*2,re=Math.sin(Q),ie=-Math.cos(Q);a.x=ie*H.x+re*X.x,a.y=ie*H.y+re*X.y,a.z=ie*H.z+re*X.z,a.normalize(),v.push(a.x,a.y,a.z),l.x=f.x+r*a.x,l.y=f.y+r*a.y,l.z=f.z+r*a.z,p.push(l.x,l.y,l.z)}}function E(){for(let k=1;k<=t;k++)for(let H=1;H<=i;H++){const X=(i+1)*(k-1)+(H-1),Z=(i+1)*k+(H-1),Q=(i+1)*k+H,re=(i+1)*(k-1)+H;S.push(X,Z,re),S.push(Z,Q,re)}}function L(){for(let k=0;k<=t;k++)for(let H=0;H<=i;H++)h.x=k/t,h.y=H/i,y.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new BD(new CP[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class jne extends Xr{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new Ze,s=new Ze;if(e.index!==null){const o=e.attributes.position,l=e.index;let a=e.groups;a.length===0&&(a=[{start:0,count:l.count,materialIndex:0}]);for(let h=0,f=a.length;h<f;++h){const p=a[h],v=p.start,y=p.count;for(let S=v,C=v+y;S<C;S+=3)for(let M=0;M<3;M++){const E=l.getX(S+M),L=l.getX(S+(M+1)%3);i.fromBufferAttribute(o,E),s.fromBufferAttribute(o,L),VW(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let l=0,a=o.count/3;l<a;l++)for(let h=0;h<3;h++){const f=3*l+h,p=3*l+(h+1)%3;i.fromBufferAttribute(o,f),s.fromBufferAttribute(o,p),VW(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new or(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function VW(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var HW=Object.freeze({__proto__:null,BoxGeometry:bp,CapsuleGeometry:AD,CircleGeometry:TD,ConeGeometry:MD,CylinderGeometry:Cw,DodecahedronGeometry:ED,EdgesGeometry:Une,ExtrudeGeometry:ID,IcosahedronGeometry:sx,LatheGeometry:rE,OctahedronGeometry:iE,PlaneGeometry:ig,PolyhedronGeometry:L0,RingGeometry:RD,ShapeGeometry:PD,SphereGeometry:Nm,TetrahedronGeometry:LD,TorusGeometry:sE,TorusKnotGeometry:DD,TubeGeometry:BD,WireframeGeometry:jne});class Wne extends ya{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Vn(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class $ne extends Ia{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class mp extends ya{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Vn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=P0,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Gu,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Wa extends mp{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new nn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return to(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Vn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Vn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Vn(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class aE extends ya{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Vn(16777215),this.specular=new Vn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=P0,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Gu,this.combine=$M,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Xne extends ya{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Vn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=P0,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class qne extends ya{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=P0,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class oE extends ya{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Vn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=P0,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Gu,this.combine=$M,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Zne extends ya{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Vn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=P0,this.normalScale=new nn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class b6 extends Eo{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Ay(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Yne(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Kne(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function j4(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,o=0;o!==r;++s){const l=t[s]*e;for(let a=0;a!==e;++a)i[o++]=n[l+a]}return i}function w6(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let o=s[r];if(o!==void 0)if(Array.isArray(o))do o=s[r],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[i++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[r],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do o=s[r],o!==void 0&&(e.push(s.time),t.push(o)),s=n[i++];while(s!==void 0)}function awe(n,e,t,r,i=30){const s=n.clone();s.name=e;const o=[];for(let a=0;a<s.tracks.length;++a){const h=s.tracks[a],f=h.getValueSize(),p=[],v=[];for(let y=0;y<h.times.length;++y){const S=h.times[y]*i;if(!(S<t||S>=r)){p.push(h.times[y]);for(let C=0;C<f;++C)v.push(h.values[y*f+C])}}p.length!==0&&(h.times=Ay(p,h.times.constructor),h.values=Ay(v,h.values.constructor),o.push(h))}s.tracks=o;let l=1/0;for(let a=0;a<s.tracks.length;++a)l>s.tracks[a].times[0]&&(l=s.tracks[a].times[0]);for(let a=0;a<s.tracks.length;++a)s.tracks[a].shift(-1*l);return s.resetDuration(),s}function owe(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let o=0;o<i;++o){const l=t.tracks[o],a=l.ValueTypeName;if(a==="bool"||a==="string")continue;const h=n.tracks.find(function(E){return E.name===l.name&&E.ValueTypeName===a});if(h===void 0)continue;let f=0;const p=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=p/3);let v=0;const y=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(v=y/3);const S=l.times.length-1;let C;if(s<=l.times[0]){const E=f,L=p-f;C=l.values.slice(E,L)}else if(s>=l.times[S]){const E=S*p+f,L=E+p-f;C=l.values.slice(E,L)}else{const E=l.createInterpolant(),L=f,k=p-f;E.evaluate(s),C=E.resultBuffer.slice(L,k)}a==="quaternion"&&new Mo().fromArray(C).normalize().conjugate().toArray(C);const M=h.times.length;for(let E=0;E<M;++E){const L=E*y+v;if(a==="quaternion")Mo.multiplyQuaternionsFlat(h.values,L,C,0,h.values,L);else{const k=y-v*2;for(let H=0;H<k;++H)h.values[L+H]-=C[H]}}}return n.blendMode=n6,n}const lwe={convertArray:Ay,isTypedArray:Yne,getKeyframeOrder:Kne,sortedArray:j4,flattenJSON:w6,subclip:awe,makeClipAdditive:owe};class bx{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let o;n:{r:if(!(e<i)){for(let l=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===l)break;if(s=i,i=t[++r],e<i)break t}o=t.length;break n}if(!(e>=s)){const l=t[1];e<l&&(r=2,s=l);for(let a=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===a)break;if(i=s,s=t[--r-1],e>=s)break t}o=r,r=0;break n}break e}for(;r<o;){const l=r+o>>>1;e<t[l]?o=l:r=l+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let o=0;o!==i;++o)t[o]=r[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Jne extends bx{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:by,endingEnd:by}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,o=e+1,l=i[s],a=i[o];if(l===void 0)switch(this.getSettings_().endingStart){case wy:s=e,l=2*t-r;break;case QT:s=i.length-2,l=t+i[s]-i[s+1];break;default:s=e,l=r}if(a===void 0)switch(this.getSettings_().endingEnd){case wy:o=e,a=2*r-t;break;case QT:o=1,a=r+i[1]-i[0];break;default:o=e-1,a=t}const h=(r-t)*.5,f=this.valueSize;this._weightPrev=h/(t-l),this._weightNext=h/(a-r),this._offsetPrev=s*f,this._offsetNext=o*f}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,a=e*l,h=a-l,f=this._offsetPrev,p=this._offsetNext,v=this._weightPrev,y=this._weightNext,S=(r-t)/(i-t),C=S*S,M=C*S,E=-v*M+2*v*C-v*S,L=(1+v)*M+(-1.5-2*v)*C+(-.5+v)*S+1,k=(-1-y)*M+(1.5+y)*C+.5*S,H=y*M-y*C;for(let X=0;X!==l;++X)s[X]=E*o[f+X]+L*o[h+X]+k*o[a+X]+H*o[p+X];return s}}class S6 extends bx{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,a=e*l,h=a-l,f=(r-t)/(i-t),p=1-f;for(let v=0;v!==l;++v)s[v]=o[h+v]*p+o[a+v]*f;return s}}class Qne extends bx{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class id{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Ay(t,this.TimeBufferType),this.values=Ay(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:Ay(e.times,Array),values:Ay(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Qne(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new S6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Jne(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case nx:t=this.InterpolantFactoryMethodDiscrete;break;case p0:t=this.InterpolantFactoryMethodLinear;break;case nR:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return nx;case this.InterpolantFactoryMethodLinear:return p0;case this.InterpolantFactoryMethodSmooth:return nR}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,o=i-1;for(;s!==i&&r[s]<e;)++s;for(;o!==-1&&r[o]>t;)--o;if(++o,s!==0||o!==i){s>=o&&(o=Math.max(o,1),s=o-1);const l=this.getValueSize();this.times=r.slice(s,o),this.values=this.values.slice(s*l,o*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let l=0;l!==s;l++){const a=r[l];if(typeof a=="number"&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,a),e=!1;break}if(o!==null&&o>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,a,o),e=!1;break}o=a}if(i!==void 0&&Yne(i))for(let l=0,a=i.length;l!==a;++l){const h=i[l];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===nR,s=e.length-1;let o=1;for(let l=1;l<s;++l){let a=!1;const h=e[l],f=e[l+1];if(h!==f&&(l!==1||h!==e[0]))if(i)a=!0;else{const p=l*r,v=p-r,y=p+r;for(let S=0;S!==r;++S){const C=t[p+S];if(C!==t[v+S]||C!==t[y+S]){a=!0;break}}}if(a){if(l!==o){e[o]=e[l];const p=l*r,v=o*r;for(let y=0;y!==r;++y)t[v+y]=t[p+y]}++o}}if(s>0){e[o]=e[s];for(let l=s*r,a=o*r,h=0;h!==r;++h)t[a+h]=t[l+h];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}id.prototype.TimeBufferType=Float32Array;id.prototype.ValueBufferType=Float32Array;id.prototype.DefaultInterpolation=p0;class Sx extends id{constructor(e,t,r){super(e,t,r)}}Sx.prototype.ValueTypeName="bool";Sx.prototype.ValueBufferType=Array;Sx.prototype.DefaultInterpolation=nx;Sx.prototype.InterpolantFactoryMethodLinear=void 0;Sx.prototype.InterpolantFactoryMethodSmooth=void 0;class A6 extends id{}A6.prototype.ValueTypeName="color";class Ym extends id{}Ym.prototype.ValueTypeName="number";class ere extends bx{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,a=(r-t)/(i-t);let h=e*l;for(let f=h+l;h!==f;h+=4)Mo.slerpFlat(s,0,o,h-l,o,h,a);return s}}class Km extends id{InterpolantFactoryMethodLinear(e){return new ere(this.times,this.values,this.getValueSize(),e)}}Km.prototype.ValueTypeName="quaternion";Km.prototype.InterpolantFactoryMethodSmooth=void 0;class Ax extends id{constructor(e,t,r){super(e,t,r)}}Ax.prototype.ValueTypeName="string";Ax.prototype.ValueBufferType=Array;Ax.prototype.DefaultInterpolation=nx;Ax.prototype.InterpolantFactoryMethodLinear=void 0;Ax.prototype.InterpolantFactoryMethodSmooth=void 0;class Jm extends id{}Jm.prototype.ValueTypeName="vector";class ax{constructor(e="",t=-1,r=[],i=pD){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Fu(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let o=0,l=r.length;o!==l;++o)t.push(uwe(r[o]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=r.length;s!==o;++s)t.push(id.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,o=[];for(let l=0;l<s;l++){let a=[],h=[];a.push((l+s-1)%s,l,(l+1)%s),h.push(0,1,0);const f=Kne(a);a=j4(a,1,f),h=j4(h,1,f),!i&&a[0]===0&&(a.push(s),h.push(h[0])),o.push(new Ym(".morphTargetInfluences["+t[l].name+"]",a,h).scale(1/r))}return new this(e,-1,o)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let l=0,a=e.length;l<a;l++){const h=e[l],f=h.name.match(s);if(f&&f.length>1){const p=f[1];let v=i[p];v||(i[p]=v=[]),v.push(h)}}const o=[];for(const l in i)o.push(this.CreateFromMorphTargetSequence(l,i[l],t,r));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(p,v,y,S,C){if(y.length!==0){const M=[],E=[];w6(y,M,E,S),M.length!==0&&C.push(new p(v,M,E))}},i=[],s=e.name||"default",o=e.fps||30,l=e.blendMode;let a=e.length||-1;const h=e.hierarchy||[];for(let p=0;p<h.length;p++){const v=h[p].keys;if(!(!v||v.length===0))if(v[0].morphTargets){const y={};let S;for(S=0;S<v.length;S++)if(v[S].morphTargets)for(let C=0;C<v[S].morphTargets.length;C++)y[v[S].morphTargets[C]]=-1;for(const C in y){const M=[],E=[];for(let L=0;L!==v[S].morphTargets.length;++L){const k=v[S];M.push(k.time),E.push(k.morphTarget===C?1:0)}i.push(new Ym(".morphTargetInfluence["+C+"]",M,E))}a=y.length*o}else{const y=".bones["+t[p].name+"]";r(Jm,y+".position",v,"pos",i),r(Km,y+".quaternion",v,"rot",i),r(Jm,y+".scale",v,"scl",i)}}return i.length===0?null:new this(s,a,i,l)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function cwe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ym;case"vector":case"vector2":case"vector3":case"vector4":return Jm;case"color":return A6;case"quaternion":return Km;case"bool":case"boolean":return Sx;case"string":return Ax}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function uwe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=cwe(n.type);if(n.times===void 0){const t=[],r=[];w6(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Lm={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class lE{constructor(e,t,r){const i=this;let s=!1,o=0,l=0,a;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(f){l++,s===!1&&i.onStart!==void 0&&i.onStart(f,o,l),s=!0},this.itemEnd=function(f){o++,i.onProgress!==void 0&&i.onProgress(f,o,l),o===l&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(f){i.onError!==void 0&&i.onError(f)},this.resolveURL=function(f){return a?a(f):f},this.setURLModifier=function(f){return a=f,this},this.addHandler=function(f,p){return h.push(f,p),this},this.removeHandler=function(f){const p=h.indexOf(f);return p!==-1&&h.splice(p,2),this},this.getHandler=function(f){for(let p=0,v=h.length;p<v;p+=2){const y=h[p],S=h[p+1];if(y.global&&(y.lastIndex=0),y.test(f))return S}return null}}}const T6=new lE;let Ro=class{constructor(e){this.manager=e!==void 0?e:T6,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};Ro.DEFAULT_MATERIAL_NAME="__DEFAULT";const gm={};class hwe extends Error{constructor(e,t){super(e),this.response=t}}class Xo extends Ro{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Lm.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(gm[e]!==void 0){gm[e].push({onLoad:t,onProgress:r,onError:i});return}gm[e]=[],gm[e].push({onLoad:t,onProgress:r,onError:i});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),l=this.mimeType,a=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const f=gm[e],p=h.body.getReader(),v=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),y=v?parseInt(v):0,S=y!==0;let C=0;const M=new ReadableStream({start(E){L();function L(){p.read().then(({done:k,value:H})=>{if(k)E.close();else{C+=H.byteLength;const X=new ProgressEvent("progress",{lengthComputable:S,loaded:C,total:y});for(let Z=0,Q=f.length;Z<Q;Z++){const re=f[Z];re.onProgress&&re.onProgress(X)}E.enqueue(H),L()}},k=>{E.error(k)})}}});return new Response(M)}else throw new hwe(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(a){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(f=>new DOMParser().parseFromString(f,l));case"json":return h.json();default:if(l===void 0)return h.text();{const p=/charset="?([^;"\s]*)"?/i.exec(l),v=p&&p[1]?p[1].toLowerCase():void 0,y=new TextDecoder(v);return h.arrayBuffer().then(S=>y.decode(S))}}}).then(h=>{Lm.add(e,h);const f=gm[e];delete gm[e];for(let p=0,v=f.length;p<v;p++){const y=f[p];y.onLoad&&y.onLoad(h)}}).catch(h=>{const f=gm[e];if(f===void 0)throw this.manager.itemError(e),h;delete gm[e];for(let p=0,v=f.length;p<v;p++){const y=f[p];y.onError&&y.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class fwe extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Xo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(a){i?i(a):console.error(a),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=ax.parse(e[r]);t.push(i)}return t}}class dwe extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=[],l=new wD,a=new Xo(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(s.withCredentials);let h=0;function f(p){a.load(e[p],function(v){const y=s.parse(v,!0);o[p]={width:y.width,height:y.height,format:y.format,mipmaps:y.mipmaps},h+=1,h===6&&(y.mipmapCount===1&&(l.minFilter=Ca),l.image=o,l.format=y.format,l.needsUpdate=!0,t&&t(l))},r,i)}if(Array.isArray(e))for(let p=0,v=e.length;p<v;++p)f(p);else a.load(e,function(p){const v=s.parse(p,!0);if(v.isCubemap){const y=v.mipmaps.length/v.mipmapCount;for(let S=0;S<y;S++){o[S]={mipmaps:[]};for(let C=0;C<v.mipmapCount;C++)o[S].mipmaps.push(v.mipmaps[S*v.mipmapCount+C]),o[S].format=v.format,o[S].width=v.width,o[S].height=v.height}l.image=o}else l.image.width=v.width,l.image.height=v.height,l.mipmaps=v.mipmaps;v.mipmapCount===1&&(l.minFilter=Ca),l.format=v.format,l.needsUpdate=!0,t&&t(l)},r,i);return l}}class uM extends Ro{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Lm.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const l=sM("img");function a(){f(),Lm.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(p){f(),i&&i(p),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){l.removeEventListener("load",a,!1),l.removeEventListener("error",h,!1)}return l.addEventListener("load",a,!1),l.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(l.crossOrigin=this.crossOrigin),s.manager.itemStart(e),l.src=e,l}}class tre extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=new QM;s.colorSpace=Ta;const o=new uM(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let l=0;function a(h){o.load(e[h],function(f){s.images[h]=f,l++,l===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let h=0;h<e.length;++h)a(h);return s}}class pwe extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Zf,l=new Xo(this.manager);return l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setPath(this.path),l.setWithCredentials(s.withCredentials),l.load(e,function(a){let h;try{h=s.parse(a)}catch(f){if(i!==void 0)i(f);else{console.error(f);return}}h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:ou,o.wrapT=h.wrapT!==void 0?h.wrapT:ou,o.magFilter=h.magFilter!==void 0?h.magFilter:Ca,o.minFilter=h.minFilter!==void 0?h.minFilter:Ca,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0&&(o.colorSpace=h.colorSpace),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=lu),h.mipmapCount===1&&(o.minFilter=Ca),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h)},r,i),o}}class Qf extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=new Xs,o=new uM(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(l){s.image=l,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class D0 extends Pi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Vn(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class nre extends D0{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Pi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Vn(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const oF=new Gr,jW=new Ze,WW=new Ze;class M6{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new nn(512,512),this.map=null,this.mapPass=null,this.matrix=new Gr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new eE,this._frameExtents=new nn(1,1),this._viewportCount=1,this._viewports=[new Rs(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;jW.setFromMatrixPosition(e.matrixWorld),t.position.copy(jW),WW.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(WW),t.updateMatrixWorld(),oF.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(oF),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(oF)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class mwe extends M6{constructor(){super(new ts(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=sw*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class kD extends D0{constructor(e,t,r=0,i=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Pi.DEFAULT_UP),this.updateMatrix(),this.target=new Pi,this.distance=r,this.angle=i,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new mwe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const $W=new Gr,VS=new Ze,lF=new Ze;class gwe extends M6{constructor(){super(new ts(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new nn(4,2),this._viewportCount=6,this._viewports=[new Rs(2,1,1,1),new Rs(0,1,1,1),new Rs(3,1,1,1),new Rs(1,1,1,1),new Rs(3,0,1,1),new Rs(1,0,1,1)],this._cubeDirections=[new Ze(1,0,0),new Ze(-1,0,0),new Ze(0,0,1),new Ze(0,0,-1),new Ze(0,1,0),new Ze(0,-1,0)],this._cubeUps=[new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,0,1),new Ze(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),VS.setFromMatrixPosition(e.matrixWorld),r.position.copy(VS),lF.copy(r.position),lF.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(lF),r.updateMatrixWorld(),i.makeTranslation(-VS.x,-VS.y,-VS.z),$W.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix($W)}}class a0 extends D0{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new gwe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class vwe extends M6{constructor(){super(new nd(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class B0 extends D0{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Pi.DEFAULT_UP),this.updateMatrix(),this.target=new Pi,this.shadow=new vwe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Tx extends D0{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class rre extends D0{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class ire{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Ze)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*i),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*r),t.addScaledVector(o[4],1.092548*(r*i)),t.addScaledVector(o[5],1.092548*(i*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(r*s)),t.addScaledVector(o[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*i),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*r),t.addScaledVector(o[4],2*.429043*r*i),t.addScaledVector(o[5],2*.429043*i*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*r*s),t.addScaledVector(o[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class sre extends D0{constructor(e=new ire,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class OD extends Ro{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,o=new Xo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(a){i?i(a):console.error(a),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=OD.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Vn().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(i.uniforms[s]={},o.type){case"t":i.uniforms[s].value=r(o.value);break;case"c":i.uniforms[s].value=new Vn().setHex(o.value);break;case"v2":i.uniforms[s].value=new nn().fromArray(o.value);break;case"v3":i.uniforms[s].value=new Ze().fromArray(o.value);break;case"v4":i.uniforms[s].value=new Rs().fromArray(o.value);break;case"m3":i.uniforms[s].value=new Si().fromArray(o.value);break;case"m4":i.uniforms[s].value=new Gr().fromArray(o.value);break;default:i.uniforms[s].value=o.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new nn().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new nn().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:Wne,SpriteMaterial:_D,RawShaderMaterial:$ne,ShaderMaterial:Ia,PointsMaterial:cu,MeshPhysicalMaterial:Wa,MeshStandardMaterial:mp,MeshPhongMaterial:aE,MeshToonMaterial:Xne,MeshNormalMaterial:qne,MeshLambertMaterial:oE,MeshDepthMaterial:f6,MeshDistanceMaterial:d6,MeshBasicMaterial:_a,MeshMatcapMaterial:Zne,LineDashedMaterial:b6,LineBasicMaterial:Eo,Material:ya};return new t[e]}}class du{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let r=0,i=e.length;r<i;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class are extends Xr{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class ore extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Xo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(l){try{t(s.parse(JSON.parse(l)))}catch(a){i?i(a):console.error(a),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(y,S){if(t[S]!==void 0)return t[S];const M=y.interleavedBuffers[S],E=s(y,M.buffer),L=yb(M.type,E),k=new Mw(L,M.stride);return k.uuid=M.uuid,t[S]=k,k}function s(y,S){if(r[S]!==void 0)return r[S];const M=y.arrayBuffers[S],E=new Uint32Array(M).buffer;return r[S]=E,E}const o=e.isInstancedBufferGeometry?new are:new Xr,l=e.data.index;if(l!==void 0){const y=yb(l.type,l.array);o.setIndex(new ki(y,1))}const a=e.data.attributes;for(const y in a){const S=a[y];let C;if(S.isInterleavedBufferAttribute){const M=i(e.data,S.data);C=new Zm(M,S.itemSize,S.offset,S.normalized)}else{const M=yb(S.type,S.array),E=S.isInstancedBufferAttribute?m0:ki;C=new E(M,S.itemSize,S.normalized)}S.name!==void 0&&(C.name=S.name),S.usage!==void 0&&C.setUsage(S.usage),o.setAttribute(y,C)}const h=e.data.morphAttributes;if(h)for(const y in h){const S=h[y],C=[];for(let M=0,E=S.length;M<E;M++){const L=S[M];let k;if(L.isInterleavedBufferAttribute){const H=i(e.data,L.data);k=new Zm(H,L.itemSize,L.offset,L.normalized)}else{const H=yb(L.type,L.array);k=new ki(H,L.itemSize,L.normalized)}L.name!==void 0&&(k.name=L.name),C.push(k)}o.morphAttributes[y]=C}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let y=0,S=p.length;y!==S;++y){const C=p[y];o.addGroup(C.start,C.count,C.materialIndex)}const v=e.data.boundingSphere;if(v!==void 0){const y=new Ze;v.center!==void 0&&y.fromArray(v.center),o.boundingSphere=new sl(y,v.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class _we extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=this.path===""?du.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const l=new Xo(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(a){let h=null;try{h=JSON.parse(a)}catch(p){i!==void 0&&i(p),console.error("THREE:ObjectLoader: Can't parse "+e+".",p.message);return}const f=h.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(h,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?du.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new Xo(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),l=JSON.parse(o),a=l.metadata;if(a===void 0||a.type===void 0||a.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(l)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),l=this.parseTextures(e.textures,o),a=this.parseMaterials(e.materials,l),h=this.parseObject(e.object,s,a,l,r),f=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,f),this.bindLightTargets(h),t!==void 0){let p=!1;for(const v in o)if(o[v].data instanceof HTMLImageElement){p=!0;break}p===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),l=this.parseMaterials(e.materials,o),a=this.parseObject(e.object,i,l,o,t),h=this.parseSkeletons(e.skeletons,a);return this.bindSkeletons(a,h),this.bindLightTargets(a),a}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new Uy().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const l=new Ew().fromJSON(e[s],i);r[l.uuid]=l}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new ore;for(let s=0,o=e.length;s<o;s++){let l;const a=e[s];switch(a.type){case"BufferGeometry":case"InstancedBufferGeometry":l=i.parse(a);break;default:a.type in HW?l=HW[a.type].fromJSON(a,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${a.type}"`)}l.uuid=a.uuid,a.name!==void 0&&(l.name=a.name),a.userData!==void 0&&(l.userData=a.userData),r[a.uuid]=l}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new OD;s.setTextures(t);for(let o=0,l=e.length;o<l;o++){const a=e[o];r[a.uuid]===void 0&&(r[a.uuid]=s.parse(a)),i[a.uuid]=r[a.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=ax.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function o(a){return r.manager.itemStart(a),s.load(a,function(){r.manager.itemEnd(a)},void 0,function(){r.manager.itemError(a),r.manager.itemEnd(a)})}function l(a){if(typeof a=="string"){const h=a,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:r.resourcePath+h;return o(f)}else return a.data?{data:yb(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){const a=new lE(t);s=new uM(a),s.setCrossOrigin(this.crossOrigin);for(let h=0,f=e.length;h<f;h++){const p=e[h],v=p.url;if(Array.isArray(v)){const y=[];for(let S=0,C=v.length;S<C;S++){const M=v[S],E=l(M);E!==null&&(E instanceof HTMLImageElement?y.push(E):y.push(new Zf(E.data,E.width,E.height)))}i[p.uuid]=new Sy(y)}else{const y=l(p.url);i[p.uuid]=new Sy(y)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(o){if(typeof o=="string"){const l=o,a=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:t.resourcePath+l;return await i.loadAsync(a)}else return o.data?{data:yb(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){i=new uM(this.manager),i.setCrossOrigin(this.crossOrigin);for(let o=0,l=e.length;o<l;o++){const a=e[o],h=a.url;if(Array.isArray(h)){const f=[];for(let p=0,v=h.length;p<v;p++){const y=h[p],S=await s(y);S!==null&&(S instanceof HTMLImageElement?f.push(S):f.push(new Zf(S.data,S.width,S.height)))}r[a.uuid]=new Sy(f)}else{const f=await s(a.url);r[a.uuid]=new Sy(f)}}}return r}parseTextures(e,t){function r(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const i={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const l=e[s];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),t[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);const a=t[l.image],h=a.data;let f;Array.isArray(h)?(f=new QM,h.length===6&&(f.needsUpdate=!0)):(h&&h.data?f=new Zf:f=new Xs,h&&(f.needsUpdate=!0)),f.source=a,f.uuid=l.uuid,l.name!==void 0&&(f.name=l.name),l.mapping!==void 0&&(f.mapping=r(l.mapping,ywe)),l.channel!==void 0&&(f.channel=l.channel),l.offset!==void 0&&f.offset.fromArray(l.offset),l.repeat!==void 0&&f.repeat.fromArray(l.repeat),l.center!==void 0&&f.center.fromArray(l.center),l.rotation!==void 0&&(f.rotation=l.rotation),l.wrap!==void 0&&(f.wrapS=r(l.wrap[0],XW),f.wrapT=r(l.wrap[1],XW)),l.format!==void 0&&(f.format=l.format),l.internalFormat!==void 0&&(f.internalFormat=l.internalFormat),l.type!==void 0&&(f.type=l.type),l.colorSpace!==void 0&&(f.colorSpace=l.colorSpace),l.minFilter!==void 0&&(f.minFilter=r(l.minFilter,qW)),l.magFilter!==void 0&&(f.magFilter=r(l.magFilter,qW)),l.anisotropy!==void 0&&(f.anisotropy=l.anisotropy),l.flipY!==void 0&&(f.flipY=l.flipY),l.generateMipmaps!==void 0&&(f.generateMipmaps=l.generateMipmaps),l.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(f.unpackAlignment=l.unpackAlignment),l.compareFunction!==void 0&&(f.compareFunction=l.compareFunction),l.userData!==void 0&&(f.userData=l.userData),i[l.uuid]=f}return i}parseObject(e,t,r,i,s){let o;function l(v){return t[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",v),t[v]}function a(v){if(v!==void 0){if(Array.isArray(v)){const y=[];for(let S=0,C=v.length;S<C;S++){const M=v[S];r[M]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",M),y.push(r[M])}return y}return r[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),r[v]}}function h(v){return i[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",v),i[v]}let f,p;switch(e.type){case"Scene":o=new Ml,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new Vn(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new Tw(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new tE(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new ts(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new nd(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new Tx(e.color,e.intensity);break;case"DirectionalLight":o=new B0(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new a0(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new rre(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new kD(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new nre(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new sre().fromJSON(e);break;case"SkinnedMesh":f=l(e.geometry),p=a(e.material),o=new yD(f,p),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":f=l(e.geometry),p=a(e.material),o=new Ri(f,p);break;case"InstancedMesh":f=l(e.geometry),p=a(e.material);const v=e.count,y=e.instanceMatrix,S=e.instanceColor;o=new xD(f,p,v),o.instanceMatrix=new m0(new Float32Array(y.array),16),S!==void 0&&(o.instanceColor=new m0(new Float32Array(S.array),S.itemSize));break;case"BatchedMesh":f=l(e.geometry),p=a(e.material),o=new Dne(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,p),o.geometry=f,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(C=>{const M=new Al;M.min.fromArray(C.boxMin),M.max.fromArray(C.boxMax);const E=new sl;return E.radius=C.sphereRadius,E.center.fromArray(C.sphereCenter),{boxInitialized:C.boxInitialized,box:M,sphereInitialized:C.sphereInitialized,sphere:E}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=h(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=h(e.colorsTexture.uuid));break;case"LOD":o=new Lne;break;case"Line":o=new Jf(l(e.geometry),a(e.material));break;case"LineLoop":o=new bD(l(e.geometry),a(e.material));break;case"LineSegments":o=new pu(l(e.geometry),a(e.material));break;case"PointCloud":case"Points":o=new Eh(l(e.geometry),a(e.material));break;case"Sprite":o=new p6(a(e.material));break;case"Group":o=new ql;break;case"Bone":o=new nE;break;default:o=new Pi}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const v=e.children;for(let y=0;y<v.length;y++)o.add(this.parseObject(v[y],t,r,i,s))}if(e.animations!==void 0){const v=e.animations;for(let y=0;y<v.length;y++){const S=v[y];o.animations.push(s[S])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const v=e.levels;for(let y=0;y<v.length;y++){const S=v[y],C=o.getObjectByProperty("uuid",S.object);C!==void 0&&o.addLevel(C,S.distance,S.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const r=t.target,i=e.getObjectByProperty("uuid",r);i!==void 0?t.target=i:t.target=new Pi}})}}const ywe={UVMapping:lD,CubeReflectionMapping:$m,CubeRefractionMapping:d0,EquirectangularReflectionMapping:KT,EquirectangularRefractionMapping:JT,CubeUVReflectionMapping:Sw},XW={RepeatWrapping:Oh,ClampToEdgeWrapping:ou,MirroredRepeatWrapping:Qy},qW={NearestFilter:Ao,NearestMipmapNearestFilter:XM,NearestMipmapLinearFilter:Wv,LinearFilter:Ca,LinearMipmapNearestFilter:Oy,LinearMipmapLinearFilter:lu};class E6 extends Ro{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Lm.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(h=>{t&&t(h),s.manager.itemEnd(e)}).catch(h=>{i&&i(h)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const l={};l.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",l.headers=this.requestHeader;const a=fetch(e,l).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(h){return Lm.add(e,h),t&&t(h),s.manager.itemEnd(e),h}).catch(function(h){i&&i(h),Lm.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Lm.add(e,a),s.manager.itemStart(e)}}let w2;class C6{static getContext(){return w2===void 0&&(w2=new(window.AudioContext||window.webkitAudioContext)),w2}static setContext(e){w2=e}}class lre extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=new Xo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{const h=a.slice(0);C6.getContext().decodeAudioData(h,function(p){t(p)}).catch(l)}catch(h){l(h)}},r,i);function l(a){i?i(a):console.error(a),s.manager.itemError(e)}}}const ZW=new Gr,YW=new Gr,I_=new Gr;class xwe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ts,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ts,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,I_.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,o=t.near*Math.tan(Ny*t.fov*.5)/t.zoom;let l,a;YW.elements[12]=-i,ZW.elements[12]=i,l=-o*t.aspect+s,a=o*t.aspect+s,I_.elements[0]=2*t.near/(a-l),I_.elements[8]=(a+l)/(a-l),this.cameraL.projectionMatrix.copy(I_),l=-o*t.aspect-s,a=o*t.aspect-s,I_.elements[0]=2*t.near/(a-l),I_.elements[8]=(a+l)/(a-l),this.cameraR.projectionMatrix.copy(I_)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(YW),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ZW)}}class sg{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=KW(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=KW();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function KW(){return(typeof performance>"u"?Date:performance).now()}const R_=new Ze,JW=new Mo,bwe=new Ze,P_=new Ze;class cre extends Pi{constructor(){super(),this.type="AudioListener",this.context=C6.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new sg}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(R_,JW,bwe),P_.set(0,0,-1).applyQuaternion(JW),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(R_.x,i),t.positionY.linearRampToValueAtTime(R_.y,i),t.positionZ.linearRampToValueAtTime(R_.z,i),t.forwardX.linearRampToValueAtTime(P_.x,i),t.forwardY.linearRampToValueAtTime(P_.y,i),t.forwardZ.linearRampToValueAtTime(P_.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(R_.x,R_.y,R_.z),t.setOrientation(P_.x,P_.y,P_.z,r.x,r.y,r.z)}}let ure=class extends Pi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const L_=new Ze,QW=new Mo,wwe=new Ze,D_=new Ze;class hre extends ure{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(L_,QW,wwe),D_.set(0,0,1).applyQuaternion(QW);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(L_.x,r),t.positionY.linearRampToValueAtTime(L_.y,r),t.positionZ.linearRampToValueAtTime(L_.z,r),t.orientationX.linearRampToValueAtTime(D_.x,r),t.orientationY.linearRampToValueAtTime(D_.y,r),t.orientationZ.linearRampToValueAtTime(D_.z,r)}else t.setPosition(L_.x,L_.y,L_.z),t.setOrientation(D_.x,D_.y,D_.z)}}class Swe{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class fre{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,o;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let o=this.cumulativeWeight;if(o===0){for(let l=0;l!==i;++l)r[s+l]=r[l];o=t}else{o+=t;const l=t/o;this._mixBufferRegion(r,s,0,l,i)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const a=t*this._origIndex;this._mixBufferRegion(r,i,a,1-s,t)}o>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let a=t,h=t+t;a!==h;++a)if(r[a]!==r[a+t]){l.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,o=i;s!==o;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let o=0;o!==s;++o)e[t+o]=e[r+o]}_slerp(e,t,r,i){Mo.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const o=this._workIndex*s;Mo.multiplyQuaternionsFlat(e,o,e,t,e,r),Mo.slerpFlat(e,t,e,t,e,o,i)}_lerp(e,t,r,i,s){const o=1-i;for(let l=0;l!==s;++l){const a=t+l;e[a]=e[a]*o+e[r+l]*i}}_lerpAdditive(e,t,r,i,s){for(let o=0;o!==s;++o){const l=t+o;e[l]=e[l]+e[r+o]*i}}}const I6="\\[\\]\\.:\\/",Awe=new RegExp("["+I6+"]","g"),R6="[^"+I6+"]",Twe="[^"+I6.replace("\\.","")+"]",Mwe=/((?:WC+[\/:])*)/.source.replace("WC",R6),Ewe=/(WCOD+)?/.source.replace("WCOD",Twe),Cwe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",R6),Iwe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",R6),Rwe=new RegExp("^"+Mwe+Ewe+Cwe+Iwe+"$"),Pwe=["material","materials","bones","map"];class Lwe{constructor(e,t,r){const i=r||es.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class es{constructor(e,t,r){this.path=t,this.parsedPath=r||es.parseTrackName(t),this.node=es.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new es.Composite(e,t,r):new es(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Awe,"")}static parseTrackName(e){const t=Rwe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);Pwe.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let o=0;o<s.length;o++){const l=s[o];if(l.name===t||l.uuid===t)return l;const a=r(l.children);if(a)return a}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=es.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let h=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===h){h=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[i];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",e);return}let l=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?l=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let a=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}a=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(a=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(a=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[a],this.setValue=this.SetterByBindingTypeAndVersioning[a][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}es.Composite=Lwe;es.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};es.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};es.prototype.GetterByBindingType=[es.prototype._getValue_direct,es.prototype._getValue_array,es.prototype._getValue_arrayElement,es.prototype._getValue_toArray];es.prototype.SetterByBindingTypeAndVersioning=[[es.prototype._setValue_direct,es.prototype._setValue_direct_setNeedsUpdate,es.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[es.prototype._setValue_array,es.prototype._setValue_array_setNeedsUpdate,es.prototype._setValue_array_setMatrixWorldNeedsUpdate],[es.prototype._setValue_arrayElement,es.prototype._setValue_arrayElement_setNeedsUpdate,es.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[es.prototype._setValue_fromArray,es.prototype._setValue_fromArray_setNeedsUpdate,es.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Dwe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Fu(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,o=s.length;let l,a=e.length,h=this.nCachedObjects_;for(let f=0,p=arguments.length;f!==p;++f){const v=arguments[f],y=v.uuid;let S=t[y];if(S===void 0){S=a++,t[y]=S,e.push(v);for(let C=0,M=o;C!==M;++C)s[C].push(new es(v,r[C],i[C]))}else if(S<h){l=e[S];const C=--h,M=e[C];t[M.uuid]=S,e[S]=M,t[y]=C,e[C]=v;for(let E=0,L=o;E!==L;++E){const k=s[E],H=k[C];let X=k[S];k[S]=H,X===void 0&&(X=new es(v,r[E],i[E])),k[C]=X}}else e[S]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let o=0,l=arguments.length;o!==l;++o){const a=arguments[o],h=a.uuid,f=t[h];if(f!==void 0&&f>=s){const p=s++,v=e[p];t[v.uuid]=f,e[f]=v,t[h]=p,e[p]=a;for(let y=0,S=i;y!==S;++y){const C=r[y],M=C[p],E=C[f];C[f]=M,C[p]=E}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,o=e.length;for(let l=0,a=arguments.length;l!==a;++l){const h=arguments[l],f=h.uuid,p=t[f];if(p!==void 0)if(delete t[f],p<s){const v=--s,y=e[v],S=--o,C=e[S];t[y.uuid]=p,e[p]=y,t[C.uuid]=v,e[v]=C,e.pop();for(let M=0,E=i;M!==E;++M){const L=r[M],k=L[v],H=L[S];L[p]=k,L[v]=H,L.pop()}}else{const v=--o,y=e[v];v>0&&(t[y.uuid]=p),e[p]=y,e.pop();for(let S=0,C=i;S!==C;++S){const M=r[S];M[p]=M[v],M.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const o=this._paths,l=this._parsedPaths,a=this._objects,h=a.length,f=this.nCachedObjects_,p=new Array(h);i=s.length,r[e]=i,o.push(e),l.push(t),s.push(p);for(let v=f,y=a.length;v!==y;++v){const S=a[v];p[v]=new es(S,e,t)}return p}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,o=this._bindings,l=o.length-1,a=o[l],h=e[l];t[h]=r,o[r]=a,o.pop(),s[r]=s[l],s.pop(),i[r]=i[l],i.pop()}}}class dre{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,o=s.length,l=new Array(o),a={endingStart:by,endingEnd:by};for(let h=0;h!==o;++h){const f=s[h].createInterpolant(null);l[h]=f,f.settings=a}this._interpolantSettings=a,this._interpolants=l,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ine,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r){if(e.fadeOut(t),this.fadeIn(t),r){const i=this._clip.duration,s=e._clip.duration,o=s/i,l=i/s;e.warp(1,o,t),this.warp(l,1,t)}return this}crossFadeTo(e,t,r){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,o=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=i._lendControlInterpolant(),this._timeScaleInterpolant=l);const a=l.parameterPositions,h=l.sampleValues;return a[0]=s,a[1]=s+r,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const a=(e-s)*r;a<0||r===0?t=0:(this._startTime=null,t=r*a)}t*=this._updateTimeScale(e);const o=this._updateTime(t),l=this._updateWeight(e);if(l>0){const a=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case n6:for(let f=0,p=a.length;f!==p;++f)a[f].evaluate(o),h[f].accumulateAdditive(l);break;case pD:default:for(let f=0,p=a.length;f!==p;++f)a[f].evaluate(o),h[f].accumulate(i,l)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const o=r===sne;if(e===0)return s===-1?i:o&&(s&1)===1?t-i:i;if(r===rne){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),i>=t||i<0){const l=Math.floor(i/t);i-=t*l,s+=Math.abs(l);const a=this.repetitions-s;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(a===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=i;if(o&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=wy,i.endingEnd=wy):(e?i.endingStart=this.zeroSlopeAtStart?wy:by:i.endingStart=QT,t?i.endingEnd=this.zeroSlopeAtEnd?wy:by:i.endingEnd=QT)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let o=this._weightInterpolant;o===null&&(o=i._lendControlInterpolant(),this._weightInterpolant=o);const l=o.parameterPositions,a=o.sampleValues;return l[0]=s,a[0]=t,l[1]=s+e,a[1]=r,this}}const Bwe=new Float32Array(1);class pre extends xp{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,o=e._propertyBindings,l=e._interpolants,a=r.uuid,h=this._bindingsByRootAndName;let f=h[a];f===void 0&&(f={},h[a]=f);for(let p=0;p!==s;++p){const v=i[p],y=v.name;let S=f[y];if(S!==void 0)++S.referenceCount,o[p]=S;else{if(S=o[p],S!==void 0){S._cacheIndex===null&&(++S.referenceCount,this._addInactiveBinding(S,a,y));continue}const C=t&&t._propertyBindings[p].binding.parsedPath;S=new fre(es.create(r,y,C),v.ValueTypeName,v.getValueSize()),++S.referenceCount,this._addInactiveBinding(S,a,y),o[p]=S}l[p].resultBuffer=S.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const l=o.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=i.length,i.push(e),o.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,l=o[s],a=l.knownActions,h=a[a.length-1],f=e._byClipCacheIndex;h._byClipCacheIndex=f,a[f]=h,a.pop(),e._byClipCacheIndex=null;const p=l.actionByRoot,v=(e._localRoot||this._root).uuid;delete p[v],a.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let o=i[t];o===void 0&&(o={},i[t]=o),o[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,o=this._bindingsByRootAndName,l=o[i],a=t[t.length-1],h=e._cacheIndex;a._cacheIndex=h,t[h]=a,t.pop(),delete l[s],Object.keys(l).length===0&&delete o[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new S6(new Float32Array(2),new Float32Array(2),1,Bwe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let o=typeof e=="string"?ax.findByName(i,e):e;const l=o!==null?o.uuid:e,a=this._actionsByClip[l];let h=null;if(r===void 0&&(o!==null?r=o.blendMode:r=pD),a!==void 0){const p=a.actionByRoot[s];if(p!==void 0&&p.blendMode===r)return p;h=a.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const f=new dre(this,o,t,r);return this._bindAction(f,h),this._addInactiveAction(f,l,s),f}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?ax.findByName(r,e):e,o=s?s.uuid:e,l=this._actionsByClip[o];return l!==void 0&&l.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==r;++h)t[h]._update(i,e,s,o);const l=this._bindings,a=this._nActiveBindings;for(let h=0;h!==a;++h)l[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const o=s.knownActions;for(let l=0,a=o.length;l!==a;++l){const h=o[l];this._deactivateAction(h);const f=h._cacheIndex,p=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,p._cacheIndex=f,t[f]=p,t.pop(),this._removeInactiveBindingsForAction(h)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const o in r){const l=r[o].actionByRoot,a=l[t];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const o in s){const l=s[o];l.restoreOriginalState(),this._removeInactiveBinding(l)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class P6{constructor(e){this.value=e}clone(){return new P6(this.value.clone===void 0?this.value:this.value.clone())}}let kwe=0;class Owe extends xp{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:kwe++}),this.name="",this.usage=rM,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Fwe extends Mw{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class Nwe{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const e$=new Gr;class FD{constructor(e,t,r=0,i=1/0){this.ray=new xx(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new zy,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return e$.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(e$),this}intersectObject(e,t=!0,r=[]){return W4(e,this,r,t),r.sort(t$),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)W4(e[i],this,r,t);return r.sort(t$),r}}function t$(n,e){return n.distance-e.distance}function W4(n,e,t,r){let i=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(i=!1),i===!0&&r===!0){const s=n.children;for(let o=0,l=s.length;o<l;o++)W4(s[o],e,t,!0)}}class hM{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(to(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class zwe{constructor(e=1,t=0,r=0){return this.radius=e,this.theta=t,this.y=r,this}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}const n$=new nn;class Uwe{constructor(e=new nn(1/0,1/0),t=new nn(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=n$.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,n$).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const r$=new Ze,S2=new Ze;class Gwe{constructor(e=new Ze,t=new Ze){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){r$.subVectors(e,this.start),S2.subVectors(this.end,this.start);const r=S2.dot(S2);let s=S2.dot(r$)/r;return t&&(s=to(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const i$=new Ze;class Vwe extends Pi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new Xr,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,l=1,a=32;o<a;o++,l++){const h=o/a*Math.PI*2,f=l/a*Math.PI*2;i.push(Math.cos(h),Math.sin(h),1,Math.cos(f),Math.sin(f),1)}r.setAttribute("position",new or(i,3));const s=new Eo({fog:!1,toneMapped:!1});this.cone=new pu(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),i$.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(i$),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const vv=new Ze,A2=new Gr,cF=new Gr;class Hwe extends pu{constructor(e){const t=mre(e),r=new Xr,i=[],s=[],o=new Vn(0,0,1),l=new Vn(0,1,0);for(let h=0;h<t.length;h++){const f=t[h];f.parent&&f.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(o.r,o.g,o.b),s.push(l.r,l.g,l.b))}r.setAttribute("position",new or(i,3)),r.setAttribute("color",new or(s,3));const a=new Eo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");cF.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const l=t[s];l.parent&&l.parent.isBone&&(A2.multiplyMatrices(cF,l.matrixWorld),vv.setFromMatrixPosition(A2),i.setXYZ(o,vv.x,vv.y,vv.z),A2.multiplyMatrices(cF,l.parent.matrixWorld),vv.setFromMatrixPosition(A2),i.setXYZ(o+1,vv.x,vv.y,vv.z),o+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function mre(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,mre(n.children[t]));return e}class jwe extends Ri{constructor(e,t,r){const i=new Nm(t,4,2),s=new _a({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Wwe=new Ze,s$=new Vn,a$=new Vn;class $we extends Pi{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new iE(t);i.rotateY(Math.PI*.5),this.material=new _a({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),o=new Float32Array(s.count*3);i.setAttribute("color",new ki(o,3)),this.add(new Ri(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");s$.copy(this.light.color),a$.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?s$:a$;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(Wwe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Xwe extends pu{constructor(e=10,t=10,r=4473924,i=8947848){r=new Vn(r),i=new Vn(i);const s=t/2,o=e/t,l=e/2,a=[],h=[];for(let v=0,y=0,S=-l;v<=t;v++,S+=o){a.push(-l,0,S,l,0,S),a.push(S,0,-l,S,0,l);const C=v===s?r:i;C.toArray(h,y),y+=3,C.toArray(h,y),y+=3,C.toArray(h,y),y+=3,C.toArray(h,y),y+=3}const f=new Xr;f.setAttribute("position",new or(a,3)),f.setAttribute("color",new or(h,3));const p=new Eo({vertexColors:!0,toneMapped:!1});super(f,p),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class qwe extends pu{constructor(e=10,t=16,r=8,i=64,s=4473924,o=8947848){s=new Vn(s),o=new Vn(o);const l=[],a=[];if(t>1)for(let p=0;p<t;p++){const v=p/t*(Math.PI*2),y=Math.sin(v)*e,S=Math.cos(v)*e;l.push(0,0,0),l.push(y,0,S);const C=p&1?s:o;a.push(C.r,C.g,C.b),a.push(C.r,C.g,C.b)}for(let p=0;p<r;p++){const v=p&1?s:o,y=e-e/r*p;for(let S=0;S<i;S++){let C=S/i*(Math.PI*2),M=Math.sin(C)*y,E=Math.cos(C)*y;l.push(M,0,E),a.push(v.r,v.g,v.b),C=(S+1)/i*(Math.PI*2),M=Math.sin(C)*y,E=Math.cos(C)*y,l.push(M,0,E),a.push(v.r,v.g,v.b)}}const h=new Xr;h.setAttribute("position",new or(l,3)),h.setAttribute("color",new or(a,3));const f=new Eo({vertexColors:!0,toneMapped:!1});super(h,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const o$=new Ze,T2=new Ze,l$=new Ze;class Zwe extends Pi{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Xr;i.setAttribute("position",new or([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Eo({fog:!1,toneMapped:!1});this.lightPlane=new Jf(i,s),this.add(this.lightPlane),i=new Xr,i.setAttribute("position",new or([0,0,0,0,0,1],3)),this.targetLine=new Jf(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),o$.setFromMatrixPosition(this.light.matrixWorld),T2.setFromMatrixPosition(this.light.target.matrixWorld),l$.subVectors(T2,o$),this.lightPlane.lookAt(T2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(T2),this.targetLine.scale.z=l$.length()}}const M2=new Ze,Ja=new JM;class Ywe extends pu{constructor(e){const t=new Xr,r=new Eo({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],o={};l("n1","n2"),l("n2","n4"),l("n4","n3"),l("n3","n1"),l("f1","f2"),l("f2","f4"),l("f4","f3"),l("f3","f1"),l("n1","f1"),l("n2","f2"),l("n3","f3"),l("n4","f4"),l("p","n1"),l("p","n2"),l("p","n3"),l("p","n4"),l("u1","u2"),l("u2","u3"),l("u3","u1"),l("c","t"),l("p","c"),l("cn1","cn2"),l("cn3","cn4"),l("cf1","cf2"),l("cf3","cf4");function l(S,C){a(S),a(C)}function a(S){i.push(0,0,0),s.push(0,0,0),o[S]===void 0&&(o[S]=[]),o[S].push(i.length/3-1)}t.setAttribute("position",new or(i,3)),t.setAttribute("color",new or(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const h=new Vn(16755200),f=new Vn(16711680),p=new Vn(43775),v=new Vn(16777215),y=new Vn(3355443);this.setColors(h,f,p,v,y)}setColors(e,t,r,i,s){const l=this.geometry.getAttribute("color");l.setXYZ(0,e.r,e.g,e.b),l.setXYZ(1,e.r,e.g,e.b),l.setXYZ(2,e.r,e.g,e.b),l.setXYZ(3,e.r,e.g,e.b),l.setXYZ(4,e.r,e.g,e.b),l.setXYZ(5,e.r,e.g,e.b),l.setXYZ(6,e.r,e.g,e.b),l.setXYZ(7,e.r,e.g,e.b),l.setXYZ(8,e.r,e.g,e.b),l.setXYZ(9,e.r,e.g,e.b),l.setXYZ(10,e.r,e.g,e.b),l.setXYZ(11,e.r,e.g,e.b),l.setXYZ(12,e.r,e.g,e.b),l.setXYZ(13,e.r,e.g,e.b),l.setXYZ(14,e.r,e.g,e.b),l.setXYZ(15,e.r,e.g,e.b),l.setXYZ(16,e.r,e.g,e.b),l.setXYZ(17,e.r,e.g,e.b),l.setXYZ(18,e.r,e.g,e.b),l.setXYZ(19,e.r,e.g,e.b),l.setXYZ(20,e.r,e.g,e.b),l.setXYZ(21,e.r,e.g,e.b),l.setXYZ(22,e.r,e.g,e.b),l.setXYZ(23,e.r,e.g,e.b),l.setXYZ(24,t.r,t.g,t.b),l.setXYZ(25,t.r,t.g,t.b),l.setXYZ(26,t.r,t.g,t.b),l.setXYZ(27,t.r,t.g,t.b),l.setXYZ(28,t.r,t.g,t.b),l.setXYZ(29,t.r,t.g,t.b),l.setXYZ(30,t.r,t.g,t.b),l.setXYZ(31,t.r,t.g,t.b),l.setXYZ(32,r.r,r.g,r.b),l.setXYZ(33,r.r,r.g,r.b),l.setXYZ(34,r.r,r.g,r.b),l.setXYZ(35,r.r,r.g,r.b),l.setXYZ(36,r.r,r.g,r.b),l.setXYZ(37,r.r,r.g,r.b),l.setXYZ(38,i.r,i.g,i.b),l.setXYZ(39,i.r,i.g,i.b),l.setXYZ(40,s.r,s.g,s.b),l.setXYZ(41,s.r,s.g,s.b),l.setXYZ(42,s.r,s.g,s.b),l.setXYZ(43,s.r,s.g,s.b),l.setXYZ(44,s.r,s.g,s.b),l.setXYZ(45,s.r,s.g,s.b),l.setXYZ(46,s.r,s.g,s.b),l.setXYZ(47,s.r,s.g,s.b),l.setXYZ(48,s.r,s.g,s.b),l.setXYZ(49,s.r,s.g,s.b),l.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;Ja.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),ho("c",t,e,Ja,0,0,-1),ho("t",t,e,Ja,0,0,1),ho("n1",t,e,Ja,-r,-i,-1),ho("n2",t,e,Ja,r,-i,-1),ho("n3",t,e,Ja,-r,i,-1),ho("n4",t,e,Ja,r,i,-1),ho("f1",t,e,Ja,-r,-i,1),ho("f2",t,e,Ja,r,-i,1),ho("f3",t,e,Ja,-r,i,1),ho("f4",t,e,Ja,r,i,1),ho("u1",t,e,Ja,r*.7,i*1.1,-1),ho("u2",t,e,Ja,-r*.7,i*1.1,-1),ho("u3",t,e,Ja,0,i*2,-1),ho("cf1",t,e,Ja,-r,0,1),ho("cf2",t,e,Ja,r,0,1),ho("cf3",t,e,Ja,0,-i,1),ho("cf4",t,e,Ja,0,i,1),ho("cn1",t,e,Ja,-r,0,-1),ho("cn2",t,e,Ja,r,0,-1),ho("cn3",t,e,Ja,0,-i,-1),ho("cn4",t,e,Ja,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ho(n,e,t,r,i,s,o){M2.set(i,s,o).unproject(r);const l=e[n];if(l!==void 0){const a=t.getAttribute("position");for(let h=0,f=l.length;h<f;h++)a.setXYZ(l[h],M2.x,M2.y,M2.z)}}const E2=new Al;class Kwe extends pu{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new Xr;s.setIndex(new ki(r,1)),s.setAttribute("position",new ki(i,3)),super(s,new Eo({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&E2.setFromObject(this.object),E2.isEmpty())return;const t=E2.min,r=E2.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Jwe extends pu{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Xr;s.setIndex(new ki(r,1)),s.setAttribute("position",new or(i,3)),super(s,new Eo({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Qwe extends Jf{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Xr;o.setAttribute("position",new or(s,3)),o.computeBoundingSphere(),super(o,new Eo({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const l=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],a=new Xr;a.setAttribute("position",new or(l,3)),a.computeBoundingSphere(),this.add(new Ri(a,new _a({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const c$=new Ze;let C2,uF;class eSe extends Pi{constructor(e=new Ze(0,0,1),t=new Ze(0,0,0),r=1,i=16776960,s=r*.2,o=s*.2){super(),this.type="ArrowHelper",C2===void 0&&(C2=new Xr,C2.setAttribute("position",new or([0,0,0,0,1,0],3)),uF=new Cw(0,.5,1,5,1),uF.translate(0,-.5,0)),this.position.copy(t),this.line=new Jf(C2,new Eo({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ri(uF,new _a({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{c$.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(c$,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class tSe extends pu{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Xr;i.setAttribute("position",new or(t,3)),i.setAttribute("color",new or(r,3));const s=new Eo({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new Vn,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class nSe{constructor(){this.type="ShapePath",this.color=new Vn,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new aM,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,o){return this.currentPath.bezierCurveTo(e,t,r,i,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(E){const L=[];for(let k=0,H=E.length;k<H;k++){const X=E[k],Z=new Uy;Z.curves=X.curves,L.push(Z)}return L}function r(E,L){const k=L.length;let H=!1;for(let X=k-1,Z=0;Z<k;X=Z++){let Q=L[X],re=L[Z],ie=re.x-Q.x,oe=re.y-Q.y;if(Math.abs(oe)>Number.EPSILON){if(oe<0&&(Q=L[Z],ie=-ie,re=L[X],oe=-oe),E.y<Q.y||E.y>re.y)continue;if(E.y===Q.y){if(E.x===Q.x)return!0}else{const fe=oe*(E.x-Q.x)-ie*(E.y-Q.y);if(fe===0)return!0;if(fe<0)continue;H=!H}}else{if(E.y!==Q.y)continue;if(re.x<=E.x&&E.x<=Q.x||Q.x<=E.x&&E.x<=re.x)return!0}}return H}const i=hp.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,l,a;const h=[];if(s.length===1)return l=s[0],a=new Uy,a.curves=l.curves,h.push(a),h;let f=!i(s[0].getPoints());f=e?!f:f;const p=[],v=[];let y=[],S=0,C;v[S]=void 0,y[S]=[];for(let E=0,L=s.length;E<L;E++)l=s[E],C=l.getPoints(),o=i(C),o=e?!o:o,o?(!f&&v[S]&&S++,v[S]={s:new Uy,p:C},v[S].s.curves=l.curves,f&&S++,y[S]=[]):y[S].push({h:l,p:C[0]});if(!v[0])return t(s);if(v.length>1){let E=!1,L=0;for(let k=0,H=v.length;k<H;k++)p[k]=[];for(let k=0,H=v.length;k<H;k++){const X=y[k];for(let Z=0;Z<X.length;Z++){const Q=X[Z];let re=!0;for(let ie=0;ie<v.length;ie++)r(Q.p,v[ie].p)&&(k!==ie&&L++,re?(re=!1,p[ie].push(Q)):E=!0);re&&p[k].push(Q)}}L>0&&E===!1&&(y=p)}let M;for(let E=0,L=v.length;E<L;E++){a=v[E].s,h.push(a),M=y[E];for(let k=0,H=M.length;k<H;k++)a.holes.push(M[k].h)}return h}}class rSe extends Sl{constructor(e=1,t=1,r=1,i={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...i,count:r}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:WM}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=WM);const gre=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:oD,AddEquation:zv,AddOperation:Yte,AdditiveAnimationBlendMode:n6,AdditiveBlending:rw,AgXToneMapping:ene,AlphaFormat:YU,AlwaysCompare:mne,AlwaysDepth:Hte,AlwaysStencilFunc:k4,AmbientLight:Tx,AnimationAction:dre,AnimationClip:ax,AnimationLoader:fwe,AnimationMixer:pre,AnimationObjectGroup:Dwe,AnimationUtils:lwe,ArcCurve:kne,ArrayCamera:Rne,ArrowHelper:eSe,AttachedBindMode:B4,Audio:ure,AudioAnalyser:Swe,AudioContext:C6,AudioListener:cre,AudioLoader:lre,AxesHelper:tSe,BackSide:Ic,BasicDepthPacking:ane,BasicShadowMap:Ste,BatchedMesh:Dne,Bone:nE,BooleanKeyframeTrack:Sx,Box2:Uwe,Box3:Al,Box3Helper:Jwe,BoxGeometry:bp,BoxHelper:Kwe,BufferAttribute:ki,BufferGeometry:Xr,BufferGeometryLoader:ore,ByteType:XU,Cache:Lm,Camera:JM,CameraHelper:Ywe,CanvasTexture:G4,CapsuleGeometry:AD,CatmullRomCurve3:One,CineonToneMapping:aD,CircleGeometry:TD,ClampToEdgeWrapping:ou,Clock:sg,Color:Vn,ColorKeyframeTrack:A6,ColorManagement:gs,CompressedArrayTexture:Pbe,CompressedCubeTexture:Lbe,CompressedTexture:wD,CompressedTextureLoader:dwe,ConeGeometry:MD,ConstantAlphaFactor:Ute,ConstantColorFactor:Nte,CubeCamera:wne,CubeReflectionMapping:$m,CubeRefractionMapping:d0,CubeTexture:QM,CubeTextureLoader:tre,CubeUVReflectionMapping:Sw,CubicBezierCurve:g6,CubicBezierCurve3:Fne,CubicInterpolant:Jne,CullFaceBack:P4,CullFaceFront:wte,CullFaceFrontBack:gve,CullFaceNone:bte,Curve:rd,CurvePath:zne,CustomBlending:Ate,CustomToneMapping:Qte,CylinderGeometry:Cw,Cylindrical:zwe,Data3DTexture:o6,DataArrayTexture:gD,DataTexture:Zf,DataTextureLoader:pwe,DataUtils:S0e,DecrementStencilOp:Tve,DecrementWrapStencilOp:Eve,DefaultLoadingManager:T6,DepthFormat:Fy,DepthStencilFormat:tx,DepthTexture:h6,DetachedBindMode:nne,DirectionalLight:B0,DirectionalLightHelper:Zwe,DiscreteInterpolant:Qne,DisplayP3ColorSpace:mD,DodecahedronGeometry:ED,DoubleSide:Ac,DstAlphaFactor:Dte,DstColorFactor:kte,DynamicCopyUsage:Vve,DynamicDrawUsage:Ove,DynamicReadUsage:zve,EdgesGeometry:Une,EllipseCurve:SD,EqualCompare:hne,EqualDepth:Wte,EqualStencilFunc:Pve,EquirectangularReflectionMapping:KT,EquirectangularRefractionMapping:JT,Euler:Gu,EventDispatcher:xp,ExtrudeGeometry:ID,FileLoader:Xo,Float16BufferAttribute:I0e,Float32BufferAttribute:or,FloatType:Mc,Fog:Tw,FogExp2:tE,FramebufferTexture:Rbe,FrontSide:kh,Frustum:eE,GLBufferAttribute:Nwe,GLSL1:jve,GLSL3:O4,GreaterCompare:fne,GreaterDepth:Xte,GreaterEqualCompare:pne,GreaterEqualDepth:$te,GreaterEqualStencilFunc:kve,GreaterStencilFunc:Dve,GridHelper:Xwe,Group:ql,HalfFloatType:Ih,HemisphereLight:nre,HemisphereLightHelper:$we,IcosahedronGeometry:sx,ImageBitmapLoader:E6,ImageLoader:uM,ImageUtils:_ne,IncrementStencilOp:Ave,IncrementWrapStencilOp:Mve,InstancedBufferAttribute:m0,InstancedBufferGeometry:are,InstancedInterleavedBuffer:Fwe,InstancedMesh:xD,Int16BufferAttribute:E0e,Int32BufferAttribute:C0e,Int8BufferAttribute:A0e,IntType:cD,InterleavedBuffer:Mw,InterleavedBufferAttribute:Zm,Interpolant:bx,InterpolateDiscrete:nx,InterpolateLinear:p0,InterpolateSmooth:nR,InvertStencilOp:Cve,KeepStencilOp:hy,KeyframeTrack:id,LOD:Lne,LatheGeometry:rE,Layers:zy,LessCompare:une,LessDepth:jte,LessEqualCompare:i6,LessEqualDepth:YT,LessEqualStencilFunc:Lve,LessStencilFunc:Rve,Light:D0,LightProbe:sre,Line:Jf,Line3:Gwe,LineBasicMaterial:Eo,LineCurve:v6,LineCurve3:Nne,LineDashedMaterial:b6,LineLoop:bD,LineSegments:pu,LinearDisplayP3ColorSpace:KM,LinearFilter:Ca,LinearInterpolant:S6,LinearMipMapLinearFilter:xve,LinearMipMapNearestFilter:yve,LinearMipmapLinearFilter:lu,LinearMipmapNearestFilter:Oy,LinearSRGBColorSpace:jo,LinearToneMapping:Kte,LinearTransfer:eM,Loader:Ro,LoaderUtils:du,LoadingManager:lE,LoopOnce:rne,LoopPingPong:sne,LoopRepeat:ine,LuminanceAlphaFormat:QU,LuminanceFormat:JU,MOUSE:cy,Material:ya,MaterialLoader:OD,MathUtils:ra,Matrix3:Si,Matrix4:Gr,MaxEquation:Cte,Mesh:Ri,MeshBasicMaterial:_a,MeshDepthMaterial:f6,MeshDistanceMaterial:d6,MeshLambertMaterial:oE,MeshMatcapMaterial:Zne,MeshNormalMaterial:qne,MeshPhongMaterial:aE,MeshPhysicalMaterial:Wa,MeshStandardMaterial:mp,MeshToonMaterial:Xne,MinEquation:Ete,MirroredRepeatWrapping:Qy,MixOperation:Zte,MultiplyBlending:D4,MultiplyOperation:$M,NearestFilter:Ao,NearestMipMapLinearFilter:_ve,NearestMipMapNearestFilter:vve,NearestMipmapLinearFilter:Wv,NearestMipmapNearestFilter:XM,NeutralToneMapping:tne,NeverCompare:cne,NeverDepth:Vte,NeverStencilFunc:Ive,NoBlending:cp,NoColorSpace:Em,NoToneMapping:up,NormalAnimationBlendMode:pD,NormalBlending:ky,NotEqualCompare:dne,NotEqualDepth:qte,NotEqualStencilFunc:Bve,NumberKeyframeTrack:Ym,Object3D:Pi,ObjectLoader:_we,ObjectSpaceNormalMap:lne,OctahedronGeometry:iE,OneFactor:Rte,OneMinusConstantAlphaFactor:Gte,OneMinusConstantColorFactor:zte,OneMinusDstAlphaFactor:Bte,OneMinusDstColorFactor:Ote,OneMinusSrcAlphaFactor:QR,OneMinusSrcColorFactor:Lte,OrthographicCamera:nd,P3Primaries:nM,PCFShadowMap:sD,PCFSoftShadowMap:KA,PMREMGenerator:F4,Path:aM,PerspectiveCamera:ts,Plane:Mm,PlaneGeometry:ig,PlaneHelper:Qwe,PointLight:a0,PointLightHelper:jwe,Points:Eh,PointsMaterial:cu,PolarGridHelper:qwe,PolyhedronGeometry:L0,PositionalAudio:hre,PropertyBinding:es,PropertyMixer:fre,QuadraticBezierCurve:_6,QuadraticBezierCurve3:y6,Quaternion:Mo,QuaternionKeyframeTrack:Km,QuaternionLinearInterpolant:ere,RED_GREEN_RGTC2_Format:AP,RED_RGTC1_Format:t6,REVISION:WM,RGBADepthPacking:one,RGBAFormat:Xl,RGBAIntegerFormat:dD,RGBA_ASTC_10x10_Format:_P,RGBA_ASTC_10x5_Format:mP,RGBA_ASTC_10x6_Format:gP,RGBA_ASTC_10x8_Format:vP,RGBA_ASTC_12x10_Format:yP,RGBA_ASTC_12x12_Format:xP,RGBA_ASTC_4x4_Format:oP,RGBA_ASTC_5x4_Format:lP,RGBA_ASTC_5x5_Format:cP,RGBA_ASTC_6x5_Format:uP,RGBA_ASTC_6x6_Format:hP,RGBA_ASTC_8x5_Format:fP,RGBA_ASTC_8x6_Format:dP,RGBA_ASTC_8x8_Format:pP,RGBA_BPTC_Format:nT,RGBA_ETC2_EAC_Format:aP,RGBA_PVRTC_2BPPV1_Format:rP,RGBA_PVRTC_4BPPV1_Format:nP,RGBA_S3TC_DXT1_Format:QA,RGBA_S3TC_DXT3_Format:eT,RGBA_S3TC_DXT5_Format:tT,RGBFormat:KU,RGBIntegerFormat:bve,RGB_BPTC_SIGNED_Format:bP,RGB_BPTC_UNSIGNED_Format:wP,RGB_ETC1_Format:iP,RGB_ETC2_Format:sP,RGB_PVRTC_2BPPV1_Format:tP,RGB_PVRTC_4BPPV1_Format:eP,RGB_S3TC_DXT1_Format:JA,RGFormat:e6,RGIntegerFormat:fD,RawShaderMaterial:$ne,Ray:xx,Raycaster:FD,Rec709Primaries:tM,RectAreaLight:rre,RedFormat:qM,RedIntegerFormat:ZM,ReinhardToneMapping:Jte,RenderTarget:yne,RepeatWrapping:Oh,ReplaceStencilOp:Sve,ReverseSubtractEquation:Mte,RingGeometry:RD,SIGNED_RED_GREEN_RGTC2_Format:TP,SIGNED_RED_RGTC1_Format:SP,SRGBColorSpace:Ta,SRGBTransfer:na,Scene:Ml,ShaderChunk:Ei,ShaderLib:Uf,ShaderMaterial:Ia,ShadowMaterial:Wne,Shape:Uy,ShapeGeometry:PD,ShapePath:nSe,ShapeUtils:hp,ShortType:qU,Skeleton:Ew,SkeletonHelper:Hwe,SkinnedMesh:yD,Source:Sy,Sphere:sl,SphereGeometry:Nm,Spherical:hM,SphericalHarmonics3:ire,SplineCurve:x6,SpotLight:kD,SpotLightHelper:Vwe,Sprite:p6,SpriteMaterial:_D,SrcAlphaFactor:JR,SrcAlphaSaturateFactor:Fte,SrcColorFactor:Pte,StaticCopyUsage:Gve,StaticDrawUsage:rM,StaticReadUsage:Nve,StereoCamera:xwe,StreamCopyUsage:Hve,StreamDrawUsage:Fve,StreamReadUsage:Uve,StringKeyframeTrack:Ax,SubtractEquation:Tte,SubtractiveBlending:L4,TOUCH:uy,TangentSpaceNormalMap:P0,TetrahedronGeometry:LD,Texture:Xs,TextureLoader:Qf,TextureUtils:ube,TorusGeometry:sE,TorusKnotGeometry:DD,Triangle:$v,TriangleFanDrawMode:rx,TriangleStripDrawMode:YM,TrianglesDrawMode:r6,TubeGeometry:BD,UVMapping:lD,Uint16BufferAttribute:l6,Uint32BufferAttribute:c6,Uint8BufferAttribute:T0e,Uint8ClampedBufferAttribute:M0e,Uniform:P6,UniformsGroup:Owe,UniformsLib:hr,UniformsUtils:qm,UnsignedByteType:Kf,UnsignedInt248Type:ex,UnsignedInt5999Type:ZU,UnsignedIntType:Xm,UnsignedShort4444Type:uD,UnsignedShort5551Type:hD,UnsignedShortType:iw,VSMShadowMap:Of,Vector2:nn,Vector3:Ze,Vector4:Rs,VectorKeyframeTrack:Jm,VideoTexture:Bne,WebGL3DRenderTarget:d0e,WebGLArrayRenderTarget:f0e,WebGLCoordinateSystem:tp,WebGLCubeRenderTarget:Sne,WebGLMultipleRenderTargets:rSe,WebGLRenderTarget:Sl,WebGLRenderer:Jl,WebGLUtils:Ine,WebGPUCoordinateSystem:iM,WireframeGeometry:jne,WrapAroundEnding:QT,ZeroCurvatureEnding:by,ZeroFactor:Ite,ZeroSlopeEnding:wy,ZeroStencilOp:wve,createCanvasElement:vne},Symbol.toStringTag,{value:"Module"}));var vre={exports:{}},Mx={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Mx.ConcurrentRoot=1;Mx.ContinuousEventPriority=4;Mx.DefaultEventPriority=16;Mx.DiscreteEventPriority=1;Mx.IdleEventPriority=536870912;Mx.LegacyRoot=0;vre.exports=Mx;var wb=vre.exports;function iSe(n){let e;const t=new Set,r=(h,f)=>{const p=typeof h=="function"?h(e):h;if(p!==e){const v=e;e=f?p:Object.assign({},e,p),t.forEach(y=>y(e,v))}},i=()=>e,s=(h,f=i,p=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let v=f(e);function y(){const S=f(e);if(!p(v,S)){const C=v;h(v=S,C)}}return t.add(y),()=>t.delete(y)},a={setState:r,getState:i,subscribe:(h,f,p)=>f||p?s(h,f,p):(t.add(h),()=>t.delete(h)),destroy:()=>t.clear()};return e=n(r,i,a),a}const sSe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),u$=sSe?Ae.useEffect:Ae.useLayoutEffect;function aSe(n){const e=typeof n=="function"?iSe(n):n,t=(r=e.getState,i=Object.is)=>{const[,s]=Ae.useReducer(M=>M+1,0),o=e.getState(),l=Ae.useRef(o),a=Ae.useRef(r),h=Ae.useRef(i),f=Ae.useRef(!1),p=Ae.useRef();p.current===void 0&&(p.current=r(o));let v,y=!1;(l.current!==o||a.current!==r||h.current!==i||f.current)&&(v=r(o),y=!i(p.current,v)),u$(()=>{y&&(p.current=v),l.current=o,a.current=r,h.current=i,f.current=!1});const S=Ae.useRef(o);u$(()=>{const M=()=>{try{const L=e.getState(),k=a.current(L);h.current(p.current,k)||(l.current=L,p.current=k,s())}catch{f.current=!0,s()}},E=e.subscribe(M);return e.getState()!==S.current&&M(),E},[]);const C=y?v:p.current;return Ae.useDebugValue(C),C};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[t,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},t}var _re={exports:{}},hF={exports:{}},fF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h$;function oSe(){return h$||(h$=1,function(n){function e(_e,We){var Ue=_e.length;_e.push(We);e:for(;0<Ue;){var vt=Ue-1>>>1,xt=_e[vt];if(0<i(xt,We))_e[vt]=We,_e[Ue]=xt,Ue=vt;else break e}}function t(_e){return _e.length===0?null:_e[0]}function r(_e){if(_e.length===0)return null;var We=_e[0],Ue=_e.pop();if(Ue!==We){_e[0]=Ue;e:for(var vt=0,xt=_e.length,Vt=xt>>>1;vt<Vt;){var lt=2*(vt+1)-1,Ht=_e[lt],Qt=lt+1,rn=_e[Qt];if(0>i(Ht,Ue))Qt<xt&&0>i(rn,Ht)?(_e[vt]=rn,_e[Qt]=Ue,vt=Qt):(_e[vt]=Ht,_e[lt]=Ue,vt=lt);else if(Qt<xt&&0>i(rn,Ue))_e[vt]=rn,_e[Qt]=Ue,vt=Qt;else break e}}return We}function i(_e,We){var Ue=_e.sortIndex-We.sortIndex;return Ue!==0?Ue:_e.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var a=[],h=[],f=1,p=null,v=3,y=!1,S=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(_e){for(var We=t(h);We!==null;){if(We.callback===null)r(h);else if(We.startTime<=_e)r(h),We.sortIndex=We.expirationTime,e(a,We);else break;We=t(h)}}function H(_e){if(C=!1,k(_e),!S)if(t(a)!==null)S=!0,Re(X);else{var We=t(h);We!==null&&st(H,We.startTime-_e)}}function X(_e,We){S=!1,C&&(C=!1,E(re),re=-1),y=!0;var Ue=v;try{for(k(We),p=t(a);p!==null&&(!(p.expirationTime>We)||_e&&!fe());){var vt=p.callback;if(typeof vt=="function"){p.callback=null,v=p.priorityLevel;var xt=vt(p.expirationTime<=We);We=n.unstable_now(),typeof xt=="function"?p.callback=xt:p===t(a)&&r(a),k(We)}else r(a);p=t(a)}if(p!==null)var Vt=!0;else{var lt=t(h);lt!==null&&st(H,lt.startTime-We),Vt=!1}return Vt}finally{p=null,v=Ue,y=!1}}var Z=!1,Q=null,re=-1,ie=5,oe=-1;function fe(){return!(n.unstable_now()-oe<ie)}function Se(){if(Q!==null){var _e=n.unstable_now();oe=_e;var We=!0;try{We=Q(!0,_e)}finally{We?Ee():(Z=!1,Q=null)}}else Z=!1}var Ee;if(typeof L=="function")Ee=function(){L(Se)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,He=Ie.port2;Ie.port1.onmessage=Se,Ee=function(){He.postMessage(null)}}else Ee=function(){M(Se,0)};function Re(_e){Q=_e,Z||(Z=!0,Ee())}function st(_e,We){re=M(function(){_e(n.unstable_now())},We)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(_e){_e.callback=null},n.unstable_continueExecution=function(){S||y||(S=!0,Re(X))},n.unstable_forceFrameRate=function(_e){0>_e||125<_e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<_e?Math.floor(1e3/_e):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(_e){switch(v){case 1:case 2:case 3:var We=3;break;default:We=v}var Ue=v;v=We;try{return _e()}finally{v=Ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(_e,We){switch(_e){case 1:case 2:case 3:case 4:case 5:break;default:_e=3}var Ue=v;v=_e;try{return We()}finally{v=Ue}},n.unstable_scheduleCallback=function(_e,We,Ue){var vt=n.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?vt+Ue:vt):Ue=vt,_e){case 1:var xt=-1;break;case 2:xt=250;break;case 5:xt=1073741823;break;case 4:xt=1e4;break;default:xt=5e3}return xt=Ue+xt,_e={id:f++,callback:We,priorityLevel:_e,startTime:Ue,expirationTime:xt,sortIndex:-1},Ue>vt?(_e.sortIndex=Ue,e(h,_e),t(a)===null&&_e===t(h)&&(C?(E(re),re=-1):C=!0,st(H,Ue-vt))):(_e.sortIndex=xt,e(a,_e),S||y||(S=!0,Re(X))),_e},n.unstable_shouldYield=fe,n.unstable_wrapCallback=function(_e){var We=v;return function(){var Ue=v;v=We;try{return _e.apply(this,arguments)}finally{v=Ue}}}}(fF)),fF}var f$;function lSe(){return f$||(f$=1,hF.exports=oSe()),hF.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cSe=function(e){var t={},r=Ae,i=lSe(),s=Object.assign;function o(D){for(var O="https://reactjs.org/docs/error-decoder.html?invariant="+D,Y=1;Y<arguments.length;Y++)O+="&args[]="+encodeURIComponent(arguments[Y]);return"Minified React error #"+D+"; visit "+O+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,a=Symbol.for("react.element"),h=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),X=Symbol.iterator;function Z(D){return D===null||typeof D!="object"?null:(D=X&&D[X]||D["@@iterator"],typeof D=="function"?D:null)}function Q(D){if(D==null)return null;if(typeof D=="function")return D.displayName||D.name||null;if(typeof D=="string")return D;switch(D){case f:return"Fragment";case h:return"Portal";case v:return"Profiler";case p:return"StrictMode";case M:return"Suspense";case E:return"SuspenseList"}if(typeof D=="object")switch(D.$$typeof){case S:return(D.displayName||"Context")+".Consumer";case y:return(D._context.displayName||"Context")+".Provider";case C:var O=D.render;return D=D.displayName,D||(D=O.displayName||O.name||"",D=D!==""?"ForwardRef("+D+")":"ForwardRef"),D;case L:return O=D.displayName||null,O!==null?O:Q(D.type)||"Memo";case k:O=D._payload,D=D._init;try{return Q(D(O))}catch{}}return null}function re(D){var O=D.type;switch(D.tag){case 24:return"Cache";case 9:return(O.displayName||"Context")+".Consumer";case 10:return(O._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return D=O.render,D=D.displayName||D.name||"",O.displayName||(D!==""?"ForwardRef("+D+")":"ForwardRef");case 7:return"Fragment";case 5:return O;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(O);case 8:return O===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof O=="function")return O.displayName||O.name||null;if(typeof O=="string")return O}return null}function ie(D){var O=D,Y=D;if(D.alternate)for(;O.return;)O=O.return;else{D=O;do O=D,O.flags&4098&&(Y=O.return),D=O.return;while(D)}return O.tag===3?Y:null}function oe(D){if(ie(D)!==D)throw Error(o(188))}function fe(D){var O=D.alternate;if(!O){if(O=ie(D),O===null)throw Error(o(188));return O!==D?null:D}for(var Y=D,se=O;;){var pe=Y.return;if(pe===null)break;var Te=pe.alternate;if(Te===null){if(se=pe.return,se!==null){Y=se;continue}break}if(pe.child===Te.child){for(Te=pe.child;Te;){if(Te===Y)return oe(pe),D;if(Te===se)return oe(pe),O;Te=Te.sibling}throw Error(o(188))}if(Y.return!==se.return)Y=pe,se=Te;else{for(var dt=!1,Ot=pe.child;Ot;){if(Ot===Y){dt=!0,Y=pe,se=Te;break}if(Ot===se){dt=!0,se=pe,Y=Te;break}Ot=Ot.sibling}if(!dt){for(Ot=Te.child;Ot;){if(Ot===Y){dt=!0,Y=Te,se=pe;break}if(Ot===se){dt=!0,se=Te,Y=pe;break}Ot=Ot.sibling}if(!dt)throw Error(o(189))}}if(Y.alternate!==se)throw Error(o(190))}if(Y.tag!==3)throw Error(o(188));return Y.stateNode.current===Y?D:O}function Se(D){return D=fe(D),D!==null?Ee(D):null}function Ee(D){if(D.tag===5||D.tag===6)return D;for(D=D.child;D!==null;){var O=Ee(D);if(O!==null)return O;D=D.sibling}return null}function Ie(D){if(D.tag===5||D.tag===6)return D;for(D=D.child;D!==null;){if(D.tag!==4){var O=Ie(D);if(O!==null)return O}D=D.sibling}return null}var He=Array.isArray,Re=e.getPublicInstance,st=e.getRootHostContext,_e=e.getChildHostContext,We=e.prepareForCommit,Ue=e.resetAfterCommit,vt=e.createInstance,xt=e.appendInitialChild,Vt=e.finalizeInitialChildren,lt=e.prepareUpdate,Ht=e.shouldSetTextContent,Qt=e.createTextInstance,rn=e.scheduleTimeout,jn=e.cancelTimeout,Bn=e.noTimeout,Tn=e.isPrimaryRenderer,Le=e.supportsMutation,qe=e.supportsPersistence,mn=e.supportsHydration,cn=e.getInstanceFromNode,St=e.preparePortalMount,Jt=e.getCurrentEventPriority,kn=e.detachDeletedInstance,Gn=e.supportsMicrotasks,sn=e.scheduleMicrotask,ot=e.supportsTestSelectors,Ge=e.findFiberRoot,Xt=e.getBoundingRect,An=e.getTextContent,Sn=e.isHiddenSubtree,jt=e.matchAccessibilityRole,mr=e.setFocusIfFocusable,Un=e.setupIntersectionObserver,tr=e.appendChild,Sr=e.appendChildToContainer,Ln=e.commitTextUpdate,ir=e.commitMount,ui=e.commitUpdate,Fr=e.insertBefore,ar=e.insertInContainerBefore,Nr=e.removeChild,Hr=e.removeChildFromContainer,xi=e.resetTextContent,Fe=e.hideInstance,Lt=e.hideTextInstance,Kt=e.unhideInstance,un=e.unhideTextInstance,Cn=e.clearContainer,Ar=e.cloneInstance,Vr=e.createContainerChildSet,hs=e.appendChildToContainerChildSet,Ls=e.finalizeContainerChildren,hi=e.replaceContainerChildren,Tt=e.cloneHiddenInstance,xe=e.cloneHiddenTextInstance,Ce=e.canHydrateInstance,Xe=e.canHydrateTextInstance,nt=e.canHydrateSuspenseInstance,Je=e.isSuspenseInstancePending,pt=e.isSuspenseInstanceFallback,Rt=e.registerSuspenseInstanceRetry,gt=e.getNextHydratableSibling,Pt=e.getFirstHydratableChild,zt=e.getFirstHydratableChildWithinContainer,Bt=e.getFirstHydratableChildWithinSuspenseInstance,ln=e.hydrateInstance,Mn=e.hydrateTextInstance,En=e.hydrateSuspenseInstance,Ve=e.getNextHydratableInstanceAfterSuspenseInstance,yt=e.commitHydratedContainer,Mt=e.commitHydratedSuspenseInstance,Et=e.clearSuspenseBoundary,It=e.clearSuspenseBoundaryFromContainer,wn=e.shouldDeleteUnhydratedTailInstances,_n=e.didNotMatchHydratedContainerTextInstance,zn=e.didNotMatchHydratedTextInstance,$n;function lr(D){if($n===void 0)try{throw Error()}catch(Y){var O=Y.stack.trim().match(/\n( *(at )?)/);$n=O&&O[1]||""}return`
`+$n+D}var gr=!1;function dr(D,O){if(!D||gr)return"";gr=!0;var Y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(O)if(O=function(){throw Error()},Object.defineProperty(O.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(O,[])}catch(Wn){var se=Wn}Reflect.construct(D,[],O)}else{try{O.call()}catch(Wn){se=Wn}D.call(O.prototype)}else{try{throw Error()}catch(Wn){se=Wn}D()}}catch(Wn){if(Wn&&se&&typeof Wn.stack=="string"){for(var pe=Wn.stack.split(`
`),Te=se.stack.split(`
`),dt=pe.length-1,Ot=Te.length-1;1<=dt&&0<=Ot&&pe[dt]!==Te[Ot];)Ot--;for(;1<=dt&&0<=Ot;dt--,Ot--)if(pe[dt]!==Te[Ot]){if(dt!==1||Ot!==1)do if(dt--,Ot--,0>Ot||pe[dt]!==Te[Ot]){var vn=`
`+pe[dt].replace(" at new "," at ");return D.displayName&&vn.includes("<anonymous>")&&(vn=vn.replace("<anonymous>",D.displayName)),vn}while(1<=dt&&0<=Ot);break}}}finally{gr=!1,Error.prepareStackTrace=Y}return(D=D?D.displayName||D.name:"")?lr(D):""}var fi=Object.prototype.hasOwnProperty,Oi=[],ji=-1;function As(D){return{current:D}}function Cr(D){0>ji||(D.current=Oi[ji],Oi[ji]=null,ji--)}function Qn(D,O){ji++,Oi[ji]=D.current,D.current=O}var Yi={},qr=As(Yi),ys=As(!1),$a=Yi;function Ds(D,O){var Y=D.type.contextTypes;if(!Y)return Yi;var se=D.stateNode;if(se&&se.__reactInternalMemoizedUnmaskedChildContext===O)return se.__reactInternalMemoizedMaskedChildContext;var pe={},Te;for(Te in Y)pe[Te]=O[Te];return se&&(D=D.stateNode,D.__reactInternalMemoizedUnmaskedChildContext=O,D.__reactInternalMemoizedMaskedChildContext=pe),pe}function fs(D){return D=D.childContextTypes,D!=null}function Li(){Cr(ys),Cr(qr)}function oa(D,O,Y){if(qr.current!==Yi)throw Error(o(168));Qn(qr,O),Qn(ys,Y)}function Pa(D,O,Y){var se=D.stateNode;if(O=O.childContextTypes,typeof se.getChildContext!="function")return Y;se=se.getChildContext();for(var pe in se)if(!(pe in O))throw Error(o(108,re(D)||"Unknown",pe));return s({},Y,se)}function Ts(D){return D=(D=D.stateNode)&&D.__reactInternalMemoizedMergedChildContext||Yi,$a=qr.current,Qn(qr,D),Qn(ys,ys.current),!0}function Oc(D,O,Y){var se=D.stateNode;if(!se)throw Error(o(169));Y?(D=Pa(D,O,$a),se.__reactInternalMemoizedMergedChildContext=D,Cr(ys),Cr(qr),Qn(qr,D)):Cr(ys),Qn(ys,Y)}var Po=Math.clz32?Math.clz32:cg,ud=Math.log,Fc=Math.LN2;function cg(D){return D>>>=0,D===0?32:31-(ud(D)/Fc|0)|0}var Ep=64,ug=4194304;function Xa(D){switch(D&-D){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return D&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return D&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return D}}function Ql(D,O){var Y=D.pendingLanes;if(Y===0)return 0;var se=0,pe=D.suspendedLanes,Te=D.pingedLanes,dt=Y&268435455;if(dt!==0){var Ot=dt&~pe;Ot!==0?se=Xa(Ot):(Te&=dt,Te!==0&&(se=Xa(Te)))}else dt=Y&~pe,dt!==0?se=Xa(dt):Te!==0&&(se=Xa(Te));if(se===0)return 0;if(O!==0&&O!==se&&!(O&pe)&&(pe=se&-se,Te=O&-O,pe>=Te||pe===16&&(Te&4194240)!==0))return O;if(se&4&&(se|=Y&16),O=D.entangledLanes,O!==0)for(D=D.entanglements,O&=se;0<O;)Y=31-Po(O),pe=1<<Y,se|=D[Y],O&=~pe;return se}function Cp(D,O){switch(D){case 1:case 2:case 4:return O+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return O+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hd(D,O){for(var Y=D.suspendedLanes,se=D.pingedLanes,pe=D.expirationTimes,Te=D.pendingLanes;0<Te;){var dt=31-Po(Te),Ot=1<<dt,vn=pe[dt];vn===-1?(!(Ot&Y)||Ot&se)&&(pe[dt]=Cp(Ot,O)):vn<=O&&(D.expiredLanes|=Ot),Te&=~Ot}}function Ip(D){return D=D.pendingLanes&-1073741825,D!==0?D:D&1073741824?1073741824:0}function ju(D){for(var O=[],Y=0;31>Y;Y++)O.push(D);return O}function Hh(D,O,Y){D.pendingLanes|=O,O!==536870912&&(D.suspendedLanes=0,D.pingedLanes=0),D=D.eventTimes,O=31-Po(O),D[O]=Y}function si(D,O){var Y=D.pendingLanes&~O;D.pendingLanes=O,D.suspendedLanes=0,D.pingedLanes=0,D.expiredLanes&=O,D.mutableReadLanes&=O,D.entangledLanes&=O,O=D.entanglements;var se=D.eventTimes;for(D=D.expirationTimes;0<Y;){var pe=31-Po(Y),Te=1<<pe;O[pe]=0,se[pe]=-1,D[pe]=-1,Y&=~Te}}function Rp(D,O){var Y=D.entangledLanes|=O;for(D=D.entanglements;Y;){var se=31-Po(Y),pe=1<<se;pe&O|D[se]&O&&(D[se]|=O),Y&=~pe}}var vr=0;function Rx(D){return D&=-D,1<D?4<D?D&268435455?16:536870912:4:1}var cr=i.unstable_scheduleCallback,fd=i.unstable_cancelCallback,jh=i.unstable_shouldYield,dd=i.unstable_requestPaint,bs=i.unstable_now,pd=i.unstable_ImmediatePriority,ec=i.unstable_UserBlockingPriority,On=i.unstable_NormalPriority,ei=i.unstable_IdlePriority,Zr=null,Gs=null;function vo(D){if(Gs&&typeof Gs.onCommitFiberRoot=="function")try{Gs.onCommitFiberRoot(Zr,D,void 0,(D.current.flags&128)===128)}catch{}}function ni(D,O){return D===O&&(D!==0||1/D===1/O)||D!==D&&O!==O}var ll=typeof Object.is=="function"?Object.is:ni,qo=null,gu=!1,so=!1;function Ms(D){qo===null?qo=[D]:qo.push(D)}function Px(D){gu=!0,Ms(D)}function Lo(){if(!so&&qo!==null){so=!0;var D=0,O=vr;try{var Y=qo;for(vr=1;D<Y.length;D++){var se=Y[D];do se=se(!0);while(se!==null)}qo=null,gu=!1}catch(pe){throw qo!==null&&(qo=qo.slice(D+1)),cr(pd,Lo),pe}finally{vr=O,so=!1}}return null}var md=l.ReactCurrentBatchConfig;function cl(D,O){if(ll(D,O))return!0;if(typeof D!="object"||D===null||typeof O!="object"||O===null)return!1;var Y=Object.keys(D),se=Object.keys(O);if(Y.length!==se.length)return!1;for(se=0;se<Y.length;se++){var pe=Y[se];if(!fi.call(O,pe)||!ll(D[pe],O[pe]))return!1}return!0}function hg(D){switch(D.tag){case 5:return lr(D.type);case 16:return lr("Lazy");case 13:return lr("Suspense");case 19:return lr("SuspenseList");case 0:case 2:case 15:return D=dr(D.type,!1),D;case 11:return D=dr(D.type.render,!1),D;case 1:return D=dr(D.type,!0),D;default:return""}}function Vs(D,O){if(D&&D.defaultProps){O=s({},O),D=D.defaultProps;for(var Y in D)O[Y]===void 0&&(O[Y]=D[Y]);return O}return O}var La=As(null),qa=null,Wh=null,Nc=null;function Bs(){Nc=Wh=qa=null}function _o(D,O,Y){Tn?(Qn(La,O._currentValue),O._currentValue=Y):(Qn(La,O._currentValue2),O._currentValue2=Y)}function ul(D){var O=La.current;Cr(La),Tn?D._currentValue=O:D._currentValue2=O}function Zs(D,O,Y){for(;D!==null;){var se=D.alternate;if((D.childLanes&O)!==O?(D.childLanes|=O,se!==null&&(se.childLanes|=O)):se!==null&&(se.childLanes&O)!==O&&(se.childLanes|=O),D===Y)break;D=D.return}}function Wu(D,O){qa=D,Nc=Wh=null,D=D.dependencies,D!==null&&D.firstContext!==null&&(D.lanes&O&&(ba=!0),D.firstContext=null)}function Ys(D){var O=Tn?D._currentValue:D._currentValue2;if(Nc!==D)if(D={context:D,memoizedValue:O,next:null},Wh===null){if(qa===null)throw Error(o(308));Wh=D,qa.dependencies={lanes:0,firstContext:D}}else Wh=Wh.next=D;return O}var Do=null,Zo=!1;function vu(D){D.updateQueue={baseState:D.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Pp(D,O){D=D.updateQueue,O.updateQueue===D&&(O.updateQueue={baseState:D.baseState,firstBaseUpdate:D.firstBaseUpdate,lastBaseUpdate:D.lastBaseUpdate,shared:D.shared,effects:D.effects})}function ao(D,O){return{eventTime:D,lane:O,tag:0,payload:null,callback:null,next:null}}function $u(D,O){var Y=D.updateQueue;Y!==null&&(Y=Y.shared,Js!==null&&D.mode&1&&!(di&2)?(D=Y.interleaved,D===null?(O.next=O,Do===null?Do=[Y]:Do.push(Y)):(O.next=D.next,D.next=O),Y.interleaved=O):(D=Y.pending,D===null?O.next=O:(O.next=D.next,D.next=O),Y.pending=O))}function Lp(D,O,Y){if(O=O.updateQueue,O!==null&&(O=O.shared,(Y&4194240)!==0)){var se=O.lanes;se&=D.pendingLanes,Y|=se,O.lanes=Y,Rp(D,Y)}}function Bo(D,O){var Y=D.updateQueue,se=D.alternate;if(se!==null&&(se=se.updateQueue,Y===se)){var pe=null,Te=null;if(Y=Y.firstBaseUpdate,Y!==null){do{var dt={eventTime:Y.eventTime,lane:Y.lane,tag:Y.tag,payload:Y.payload,callback:Y.callback,next:null};Te===null?pe=Te=dt:Te=Te.next=dt,Y=Y.next}while(Y!==null);Te===null?pe=Te=O:Te=Te.next=O}else pe=Te=O;Y={baseState:se.baseState,firstBaseUpdate:pe,lastBaseUpdate:Te,shared:se.shared,effects:se.effects},D.updateQueue=Y;return}D=Y.lastBaseUpdate,D===null?Y.firstBaseUpdate=O:D.next=O,Y.lastBaseUpdate=O}function fg(D,O,Y,se){var pe=D.updateQueue;Zo=!1;var Te=pe.firstBaseUpdate,dt=pe.lastBaseUpdate,Ot=pe.shared.pending;if(Ot!==null){pe.shared.pending=null;var vn=Ot,Wn=vn.next;vn.next=null,dt===null?Te=Wn:dt.next=Wn,dt=vn;var br=D.alternate;br!==null&&(br=br.updateQueue,Ot=br.lastBaseUpdate,Ot!==dt&&(Ot===null?br.firstBaseUpdate=Wn:Ot.next=Wn,br.lastBaseUpdate=vn))}if(Te!==null){var oi=pe.baseState;dt=0,br=Wn=vn=null,Ot=Te;do{var zr=Ot.lane,ps=Ot.eventTime;if((se&zr)===zr){br!==null&&(br=br.next={eventTime:ps,lane:0,tag:Ot.tag,payload:Ot.payload,callback:Ot.callback,next:null});e:{var Ir=D,ha=Ot;switch(zr=O,ps=Y,ha.tag){case 1:if(Ir=ha.payload,typeof Ir=="function"){oi=Ir.call(ps,oi,zr);break e}oi=Ir;break e;case 3:Ir.flags=Ir.flags&-65537|128;case 0:if(Ir=ha.payload,zr=typeof Ir=="function"?Ir.call(ps,oi,zr):Ir,zr==null)break e;oi=s({},oi,zr);break e;case 2:Zo=!0}}Ot.callback!==null&&Ot.lane!==0&&(D.flags|=64,zr=pe.effects,zr===null?pe.effects=[Ot]:zr.push(Ot))}else ps={eventTime:ps,lane:zr,tag:Ot.tag,payload:Ot.payload,callback:Ot.callback,next:null},br===null?(Wn=br=ps,vn=oi):br=br.next=ps,dt|=zr;if(Ot=Ot.next,Ot===null){if(Ot=pe.shared.pending,Ot===null)break;zr=Ot,Ot=zr.next,zr.next=null,pe.lastBaseUpdate=zr,pe.shared.pending=null}}while(!0);if(br===null&&(vn=oi),pe.baseState=vn,pe.firstBaseUpdate=Wn,pe.lastBaseUpdate=br,O=pe.shared.interleaved,O!==null){pe=O;do dt|=pe.lane,pe=pe.next;while(pe!==O)}else Te===null&&(pe.shared.lanes=0);ff|=dt,D.lanes=dt,D.memoizedState=oi}}function Dp(D,O,Y){if(D=O.effects,O.effects=null,D!==null)for(O=0;O<D.length;O++){var se=D[O],pe=se.callback;if(pe!==null){if(se.callback=null,se=Y,typeof pe!="function")throw Error(o(191,pe));pe.call(se)}}}var U0=new r.Component().refs;function Xu(D,O,Y,se){O=D.memoizedState,Y=Y(se,O),Y=Y==null?O:s({},O,Y),D.memoizedState=Y,D.lanes===0&&(D.updateQueue.baseState=Y)}var _u={isMounted:function(D){return(D=D._reactInternals)?ie(D)===D:!1},enqueueSetState:function(D,O,Y){D=D._reactInternals;var se=Qs(),pe=fc(D),Te=ao(se,pe);Te.payload=O,Y!=null&&(Te.callback=Y),$u(D,Te),O=el(D,pe,se),O!==null&&Lp(O,D,pe)},enqueueReplaceState:function(D,O,Y){D=D._reactInternals;var se=Qs(),pe=fc(D),Te=ao(se,pe);Te.tag=1,Te.payload=O,Y!=null&&(Te.callback=Y),$u(D,Te),O=el(D,pe,se),O!==null&&Lp(O,D,pe)},enqueueForceUpdate:function(D,O){D=D._reactInternals;var Y=Qs(),se=fc(D),pe=ao(Y,se);pe.tag=2,O!=null&&(pe.callback=O),$u(D,pe),O=el(D,se,Y),O!==null&&Lp(O,D,se)}};function Lx(D,O,Y,se,pe,Te,dt){return D=D.stateNode,typeof D.shouldComponentUpdate=="function"?D.shouldComponentUpdate(se,Te,dt):O.prototype&&O.prototype.isPureReactComponent?!cl(Y,se)||!cl(pe,Te):!0}function gd(D,O,Y){var se=!1,pe=Yi,Te=O.contextType;return typeof Te=="object"&&Te!==null?Te=Ys(Te):(pe=fs(O)?$a:qr.current,se=O.contextTypes,Te=(se=se!=null)?Ds(D,pe):Yi),O=new O(Y,Te),D.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,O.updater=_u,D.stateNode=O,O._reactInternals=D,se&&(D=D.stateNode,D.__reactInternalMemoizedUnmaskedChildContext=pe,D.__reactInternalMemoizedMaskedChildContext=Te),O}function qu(D,O,Y,se){D=O.state,typeof O.componentWillReceiveProps=="function"&&O.componentWillReceiveProps(Y,se),typeof O.UNSAFE_componentWillReceiveProps=="function"&&O.UNSAFE_componentWillReceiveProps(Y,se),O.state!==D&&_u.enqueueReplaceState(O,O.state,null)}function G0(D,O,Y,se){var pe=D.stateNode;pe.props=Y,pe.state=D.memoizedState,pe.refs=U0,vu(D);var Te=O.contextType;typeof Te=="object"&&Te!==null?pe.context=Ys(Te):(Te=fs(O)?$a:qr.current,pe.context=Ds(D,Te)),pe.state=D.memoizedState,Te=O.getDerivedStateFromProps,typeof Te=="function"&&(Xu(D,O,Te,Y),pe.state=D.memoizedState),typeof O.getDerivedStateFromProps=="function"||typeof pe.getSnapshotBeforeUpdate=="function"||typeof pe.UNSAFE_componentWillMount!="function"&&typeof pe.componentWillMount!="function"||(O=pe.state,typeof pe.componentWillMount=="function"&&pe.componentWillMount(),typeof pe.UNSAFE_componentWillMount=="function"&&pe.UNSAFE_componentWillMount(),O!==pe.state&&_u.enqueueReplaceState(pe,pe.state,null),fg(D,Y,pe,se),pe.state=D.memoizedState),typeof pe.componentDidMount=="function"&&(D.flags|=4194308)}var tc=[],$h=0,Xh=null,yo=0,Mr=[],Xn=0,yu=null,pr=1,nc="";function rc(D,O){tc[$h++]=yo,tc[$h++]=Xh,Xh=D,yo=O}function _r(D,O,Y){Mr[Xn++]=pr,Mr[Xn++]=nc,Mr[Xn++]=yu,yu=D;var se=pr;D=nc;var pe=32-Po(se)-1;se&=~(1<<pe),Y+=1;var Te=32-Po(O)+pe;if(30<Te){var dt=pe-pe%5;Te=(se&(1<<dt)-1).toString(32),se>>=dt,pe-=dt,pr=1<<32-Po(O)+pe|Y<<pe|se,nc=Te+D}else pr=1<<Te|Y<<pe|se,nc=D}function Bp(D){D.return!==null&&(rc(D,1),_r(D,1,0))}function vd(D){for(;D===Xh;)Xh=tc[--$h],tc[$h]=null,yo=tc[--$h],tc[$h]=null;for(;D===yu;)yu=Mr[--Xn],Mr[Xn]=null,nc=Mr[--Xn],Mr[Xn]=null,pr=Mr[--Xn],Mr[Xn]=null}var ko=null,xa=null,ns=!1,la=!1,Yo=null;function qh(D,O){var Y=tl(5,null,null,0);Y.elementType="DELETED",Y.stateNode=O,Y.return=D,O=D.deletions,O===null?(D.deletions=[Y],D.flags|=16):O.push(Y)}function Zh(D,O){switch(D.tag){case 5:return O=Ce(O,D.type,D.pendingProps),O!==null?(D.stateNode=O,ko=D,xa=Pt(O),!0):!1;case 6:return O=Xe(O,D.pendingProps),O!==null?(D.stateNode=O,ko=D,xa=null,!0):!1;case 13:if(O=nt(O),O!==null){var Y=yu!==null?{id:pr,overflow:nc}:null;return D.memoizedState={dehydrated:O,treeContext:Y,retryLane:1073741824},Y=tl(18,null,null,0),Y.stateNode=O,Y.return=D,D.child=Y,ko=D,xa=null,!0}return!1;default:return!1}}function _d(D){return(D.mode&1)!==0&&(D.flags&128)===0}function ic(D){if(ns){var O=xa;if(O){var Y=O;if(!Zh(D,O)){if(_d(D))throw Error(o(418));O=gt(Y);var se=ko;O&&Zh(D,O)?qh(se,Y):(D.flags=D.flags&-4097|2,ns=!1,ko=D)}}else{if(_d(D))throw Error(o(418));D.flags=D.flags&-4097|2,ns=!1,ko=D}}}function xs(D){for(D=D.return;D!==null&&D.tag!==5&&D.tag!==3&&D.tag!==13;)D=D.return;ko=D}function Yh(D){if(!mn||D!==ko)return!1;if(!ns)return xs(D),ns=!0,!1;if(D.tag!==3&&(D.tag!==5||wn(D.type)&&!Ht(D.type,D.memoizedProps))){var O=xa;if(O){if(_d(D)){for(D=xa;D;)D=gt(D);throw Error(o(418))}for(;O;)qh(D,O),O=gt(O)}}if(xs(D),D.tag===13){if(!mn)throw Error(o(316));if(D=D.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(o(317));xa=Ve(D)}else xa=ko?gt(D.stateNode):null;return!0}function yn(){mn&&(xa=ko=null,la=ns=!1)}function dg(D){Yo===null?Yo=[D]:Yo.push(D)}function zc(D,O,Y){if(D=Y.ref,D!==null&&typeof D!="function"&&typeof D!="object"){if(Y._owner){if(Y=Y._owner,Y){if(Y.tag!==1)throw Error(o(309));var se=Y.stateNode}if(!se)throw Error(o(147,D));var pe=se,Te=""+D;return O!==null&&O.ref!==null&&typeof O.ref=="function"&&O.ref._stringRef===Te?O.ref:(O=function(dt){var Ot=pe.refs;Ot===U0&&(Ot=pe.refs={}),dt===null?delete Ot[Te]:Ot[Te]=dt},O._stringRef=Te,O)}if(typeof D!="string")throw Error(o(284));if(!Y._owner)throw Error(o(290,D))}return D}function Kh(D,O){throw D=Object.prototype.toString.call(O),Error(o(31,D==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":D))}function kp(D){var O=D._init;return O(D._payload)}function Op(D){function O($t,Nt){if(D){var an=$t.deletions;an===null?($t.deletions=[Nt],$t.flags|=16):an.push(Nt)}}function Y($t,Nt){if(!D)return null;for(;Nt!==null;)O($t,Nt),Nt=Nt.sibling;return null}function se($t,Nt){for($t=new Map;Nt!==null;)Nt.key!==null?$t.set(Nt.key,Nt):$t.set(Nt.index,Nt),Nt=Nt.sibling;return $t}function pe($t,Nt){return $t=Mu($t,Nt),$t.index=0,$t.sibling=null,$t}function Te($t,Nt,an){return $t.index=an,D?(an=$t.alternate,an!==null?(an=an.index,an<Nt?($t.flags|=2,Nt):an):($t.flags|=2,Nt)):($t.flags|=1048576,Nt)}function dt($t){return D&&$t.alternate===null&&($t.flags|=2),$t}function Ot($t,Nt,an,rr){return Nt===null||Nt.tag!==6?(Nt=om(an,$t.mode,rr),Nt.return=$t,Nt):(Nt=pe(Nt,an),Nt.return=$t,Nt)}function vn($t,Nt,an,rr){var Rr=an.type;return Rr===f?br($t,Nt,an.props.children,rr,an.key):Nt!==null&&(Nt.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===k&&kp(Rr)===Nt.type)?(rr=pe(Nt,an.props),rr.ref=zc($t,Nt,an),rr.return=$t,rr):(rr=sm(an.type,an.key,an.props,null,$t.mode,rr),rr.ref=zc($t,Nt,an),rr.return=$t,rr)}function Wn($t,Nt,an,rr){return Nt===null||Nt.tag!==4||Nt.stateNode.containerInfo!==an.containerInfo||Nt.stateNode.implementation!==an.implementation?(Nt=h_(an,$t.mode,rr),Nt.return=$t,Nt):(Nt=pe(Nt,an.children||[]),Nt.return=$t,Nt)}function br($t,Nt,an,rr,Rr){return Nt===null||Nt.tag!==7?(Nt=sh(an,$t.mode,rr,Rr),Nt.return=$t,Nt):(Nt=pe(Nt,an),Nt.return=$t,Nt)}function oi($t,Nt,an){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number")return Nt=om(""+Nt,$t.mode,an),Nt.return=$t,Nt;if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case a:return an=sm(Nt.type,Nt.key,Nt.props,null,$t.mode,an),an.ref=zc($t,null,Nt),an.return=$t,an;case h:return Nt=h_(Nt,$t.mode,an),Nt.return=$t,Nt;case k:var rr=Nt._init;return oi($t,rr(Nt._payload),an)}if(He(Nt)||Z(Nt))return Nt=sh(Nt,$t.mode,an,null),Nt.return=$t,Nt;Kh($t,Nt)}return null}function zr($t,Nt,an,rr){var Rr=Nt!==null?Nt.key:null;if(typeof an=="string"&&an!==""||typeof an=="number")return Rr!==null?null:Ot($t,Nt,""+an,rr);if(typeof an=="object"&&an!==null){switch(an.$$typeof){case a:return an.key===Rr?vn($t,Nt,an,rr):null;case h:return an.key===Rr?Wn($t,Nt,an,rr):null;case k:return Rr=an._init,zr($t,Nt,Rr(an._payload),rr)}if(He(an)||Z(an))return Rr!==null?null:br($t,Nt,an,rr,null);Kh($t,an)}return null}function ps($t,Nt,an,rr,Rr){if(typeof rr=="string"&&rr!==""||typeof rr=="number")return $t=$t.get(an)||null,Ot(Nt,$t,""+rr,Rr);if(typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case a:return $t=$t.get(rr.key===null?an:rr.key)||null,vn(Nt,$t,rr,Rr);case h:return $t=$t.get(rr.key===null?an:rr.key)||null,Wn(Nt,$t,rr,Rr);case k:var vi=rr._init;return ps($t,Nt,an,vi(rr._payload),Rr)}if(He(rr)||Z(rr))return $t=$t.get(an)||null,br(Nt,$t,rr,Rr,null);Kh(Nt,rr)}return null}function Ir($t,Nt,an,rr){for(var Rr=null,vi=null,li=Nt,zi=Nt=0,b=null;li!==null&&zi<an.length;zi++){li.index>zi?(b=li,li=null):b=li.sibling;var u=zr($t,li,an[zi],rr);if(u===null){li===null&&(li=b);break}D&&li&&u.alternate===null&&O($t,li),Nt=Te(u,Nt,zi),vi===null?Rr=u:vi.sibling=u,vi=u,li=b}if(zi===an.length)return Y($t,li),ns&&rc($t,zi),Rr;if(li===null){for(;zi<an.length;zi++)li=oi($t,an[zi],rr),li!==null&&(Nt=Te(li,Nt,zi),vi===null?Rr=li:vi.sibling=li,vi=li);return ns&&rc($t,zi),Rr}for(li=se($t,li);zi<an.length;zi++)b=ps(li,$t,zi,an[zi],rr),b!==null&&(D&&b.alternate!==null&&li.delete(b.key===null?zi:b.key),Nt=Te(b,Nt,zi),vi===null?Rr=b:vi.sibling=b,vi=b);return D&&li.forEach(function(m){return O($t,m)}),ns&&rc($t,zi),Rr}function ha($t,Nt,an,rr){var Rr=Z(an);if(typeof Rr!="function")throw Error(o(150));if(an=Rr.call(an),an==null)throw Error(o(151));for(var vi=Rr=null,li=Nt,zi=Nt=0,b=null,u=an.next();li!==null&&!u.done;zi++,u=an.next()){li.index>zi?(b=li,li=null):b=li.sibling;var m=zr($t,li,u.value,rr);if(m===null){li===null&&(li=b);break}D&&li&&m.alternate===null&&O($t,li),Nt=Te(m,Nt,zi),vi===null?Rr=m:vi.sibling=m,vi=m,li=b}if(u.done)return Y($t,li),ns&&rc($t,zi),Rr;if(li===null){for(;!u.done;zi++,u=an.next())u=oi($t,u.value,rr),u!==null&&(Nt=Te(u,Nt,zi),vi===null?Rr=u:vi.sibling=u,vi=u);return ns&&rc($t,zi),Rr}for(li=se($t,li);!u.done;zi++,u=an.next())u=ps(li,$t,zi,u.value,rr),u!==null&&(D&&u.alternate!==null&&li.delete(u.key===null?zi:u.key),Nt=Te(u,Nt,zi),vi===null?Rr=u:vi.sibling=u,vi=u);return D&&li.forEach(function(w){return O($t,w)}),ns&&rc($t,zi),Rr}function fa($t,Nt,an,rr){if(typeof an=="object"&&an!==null&&an.type===f&&an.key===null&&(an=an.props.children),typeof an=="object"&&an!==null){switch(an.$$typeof){case a:e:{for(var Rr=an.key,vi=Nt;vi!==null;){if(vi.key===Rr){if(Rr=an.type,Rr===f){if(vi.tag===7){Y($t,vi.sibling),Nt=pe(vi,an.props.children),Nt.return=$t,$t=Nt;break e}}else if(vi.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===k&&kp(Rr)===vi.type){Y($t,vi.sibling),Nt=pe(vi,an.props),Nt.ref=zc($t,vi,an),Nt.return=$t,$t=Nt;break e}Y($t,vi);break}else O($t,vi);vi=vi.sibling}an.type===f?(Nt=sh(an.props.children,$t.mode,rr,an.key),Nt.return=$t,$t=Nt):(rr=sm(an.type,an.key,an.props,null,$t.mode,rr),rr.ref=zc($t,Nt,an),rr.return=$t,$t=rr)}return dt($t);case h:e:{for(vi=an.key;Nt!==null;){if(Nt.key===vi)if(Nt.tag===4&&Nt.stateNode.containerInfo===an.containerInfo&&Nt.stateNode.implementation===an.implementation){Y($t,Nt.sibling),Nt=pe(Nt,an.children||[]),Nt.return=$t,$t=Nt;break e}else{Y($t,Nt);break}else O($t,Nt);Nt=Nt.sibling}Nt=h_(an,$t.mode,rr),Nt.return=$t,$t=Nt}return dt($t);case k:return vi=an._init,fa($t,Nt,vi(an._payload),rr)}if(He(an))return Ir($t,Nt,an,rr);if(Z(an))return ha($t,Nt,an,rr);Kh($t,an)}return typeof an=="string"&&an!==""||typeof an=="number"?(an=""+an,Nt!==null&&Nt.tag===6?(Y($t,Nt.sibling),Nt=pe(Nt,an),Nt.return=$t,$t=Nt):(Y($t,Nt),Nt=om(an,$t.mode,rr),Nt.return=$t,$t=Nt),dt($t)):Y($t,Nt)}return fa}var Ko=Op(!0),pg=Op(!1),oo={},Oo=As(oo),Uc=As(oo),Jh=As(oo);function sc(D){if(D===oo)throw Error(o(174));return D}function Fo(D,O){Qn(Jh,O),Qn(Uc,D),Qn(Oo,oo),D=st(O),Cr(Oo),Qn(Oo,D)}function Qh(){Cr(Oo),Cr(Uc),Cr(Jh)}function mg(D){var O=sc(Jh.current),Y=sc(Oo.current);O=_e(Y,D.type,O),Y!==O&&(Qn(Uc,D),Qn(Oo,O))}function Fp(D){Uc.current===D&&(Cr(Oo),Cr(Uc))}var Es=As(0);function Np(D){for(var O=D;O!==null;){if(O.tag===13){var Y=O.memoizedState;if(Y!==null&&(Y=Y.dehydrated,Y===null||Je(Y)||pt(Y)))return O}else if(O.tag===19&&O.memoizedProps.revealOrder!==void 0){if(O.flags&128)return O}else if(O.child!==null){O.child.return=O,O=O.child;continue}if(O===D)break;for(;O.sibling===null;){if(O.return===null||O.return===D)return null;O=O.return}O.sibling.return=O.return,O=O.sibling}return null}var gg=[];function vg(){for(var D=0;D<gg.length;D++){var O=gg[D];Tn?O._workInProgressVersionPrimary=null:O._workInProgressVersionSecondary=null}gg.length=0}var zp=l.ReactCurrentDispatcher,Jo=l.ReactCurrentBatchConfig,ef=0,Cs=null,Da=null,Ks=null,xu=!1,bu=!1,Zu=0,Yu=0;function Hs(){throw Error(o(321))}function Kr(D,O){if(O===null)return!1;for(var Y=0;Y<O.length&&Y<D.length;Y++)if(!ll(D[Y],O[Y]))return!1;return!0}function Ku(D,O,Y,se,pe,Te){if(ef=Te,Cs=O,O.memoizedState=null,O.updateQueue=null,O.lanes=0,zp.current=D===null||D.memoizedState===null?Y0:jp,D=Y(se,pe),bu){Te=0;do{if(bu=!1,Zu=0,25<=Te)throw Error(o(301));Te+=1,Ks=Da=null,O.updateQueue=null,zp.current=Cg,D=Y(se,pe)}while(bu)}if(zp.current=rf,O=Da!==null&&Da.next!==null,ef=0,Ks=Da=Cs=null,xu=!1,O)throw Error(o(300));return D}function tf(){var D=Zu!==0;return Zu=0,D}function Cl(){var D={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ks===null?Cs.memoizedState=Ks=D:Ks=Ks.next=D,Ks}function hl(){if(Da===null){var D=Cs.alternate;D=D!==null?D.memoizedState:null}else D=Da.next;var O=Ks===null?Cs.memoizedState:Ks.next;if(O!==null)Ks=O,Da=D;else{if(D===null)throw Error(o(310));Da=D,D={memoizedState:Da.memoizedState,baseState:Da.baseState,baseQueue:Da.baseQueue,queue:Da.queue,next:null},Ks===null?Cs.memoizedState=Ks=D:Ks=Ks.next=D}return Ks}function ac(D,O){return typeof O=="function"?O(D):O}function bi(D){var O=hl(),Y=O.queue;if(Y===null)throw Error(o(311));Y.lastRenderedReducer=D;var se=Da,pe=se.baseQueue,Te=Y.pending;if(Te!==null){if(pe!==null){var dt=pe.next;pe.next=Te.next,Te.next=dt}se.baseQueue=pe=Te,Y.pending=null}if(pe!==null){Te=pe.next,se=se.baseState;var Ot=dt=null,vn=null,Wn=Te;do{var br=Wn.lane;if((ef&br)===br)vn!==null&&(vn=vn.next={lane:0,action:Wn.action,hasEagerState:Wn.hasEagerState,eagerState:Wn.eagerState,next:null}),se=Wn.hasEagerState?Wn.eagerState:D(se,Wn.action);else{var oi={lane:br,action:Wn.action,hasEagerState:Wn.hasEagerState,eagerState:Wn.eagerState,next:null};vn===null?(Ot=vn=oi,dt=se):vn=vn.next=oi,Cs.lanes|=br,ff|=br}Wn=Wn.next}while(Wn!==null&&Wn!==Te);vn===null?dt=se:vn.next=Ot,ll(se,O.memoizedState)||(ba=!0),O.memoizedState=se,O.baseState=dt,O.baseQueue=vn,Y.lastRenderedState=se}if(D=Y.interleaved,D!==null){pe=D;do Te=pe.lane,Cs.lanes|=Te,ff|=Te,pe=pe.next;while(pe!==D)}else pe===null&&(Y.lanes=0);return[O.memoizedState,Y.dispatch]}function yd(D){var O=hl(),Y=O.queue;if(Y===null)throw Error(o(311));Y.lastRenderedReducer=D;var se=Y.dispatch,pe=Y.pending,Te=O.memoizedState;if(pe!==null){Y.pending=null;var dt=pe=pe.next;do Te=D(Te,dt.action),dt=dt.next;while(dt!==pe);ll(Te,O.memoizedState)||(ba=!0),O.memoizedState=Te,O.baseQueue===null&&(O.baseState=Te),Y.lastRenderedState=Te}return[Te,se]}function V0(){}function _g(D,O){var Y=Cs,se=hl(),pe=O(),Te=!ll(se.memoizedState,pe);if(Te&&(se.memoizedState=pe,ba=!0),se=se.queue,nf(H0.bind(null,Y,se,D),[D]),se.getSnapshot!==O||Te||Ks!==null&&Ks.memoizedState.tag&1){if(Y.flags|=2048,Gc(9,xd.bind(null,Y,se,pe,O),void 0,null),Js===null)throw Error(o(349));ef&30||Up(Y,O,pe)}return pe}function Up(D,O,Y){D.flags|=16384,D={getSnapshot:O,value:Y},O=Cs.updateQueue,O===null?(O={lastEffect:null,stores:null},Cs.updateQueue=O,O.stores=[D]):(Y=O.stores,Y===null?O.stores=[D]:Y.push(D))}function xd(D,O,Y,se){O.value=Y,O.getSnapshot=se,j0(O)&&el(D,1,-1)}function H0(D,O,Y){return Y(function(){j0(O)&&el(D,1,-1)})}function j0(D){var O=D.getSnapshot;D=D.value;try{var Y=O();return!ll(D,Y)}catch{return!0}}function yg(D){var O=Cl();return typeof D=="function"&&(D=D()),O.memoizedState=O.baseState=D,D={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ac,lastRenderedState:D},O.queue=D,D=D.dispatch=Z0.bind(null,Cs,D),[O.memoizedState,D]}function Gc(D,O,Y,se){return D={tag:D,create:O,destroy:Y,deps:se,next:null},O=Cs.updateQueue,O===null?(O={lastEffect:null,stores:null},Cs.updateQueue=O,O.lastEffect=D.next=D):(Y=O.lastEffect,Y===null?O.lastEffect=D.next=D:(se=Y.next,Y.next=D,D.next=se,O.lastEffect=D)),D}function W0(){return hl().memoizedState}function xg(D,O,Y,se){var pe=Cl();Cs.flags|=D,pe.memoizedState=Gc(1|O,Y,void 0,se===void 0?null:se)}function bg(D,O,Y,se){var pe=hl();se=se===void 0?null:se;var Te=void 0;if(Da!==null){var dt=Da.memoizedState;if(Te=dt.destroy,se!==null&&Kr(se,dt.deps)){pe.memoizedState=Gc(O,Y,Te,se);return}}Cs.flags|=D,pe.memoizedState=Gc(1|O,Y,Te,se)}function $0(D,O){return xg(8390656,8,D,O)}function nf(D,O){return bg(2048,8,D,O)}function wg(D,O){return bg(4,2,D,O)}function Sg(D,O){return bg(4,4,D,O)}function Ag(D,O){if(typeof O=="function")return D=D(),O(D),function(){O(null)};if(O!=null)return D=D(),O.current=D,function(){O.current=null}}function X0(D,O,Y){return Y=Y!=null?Y.concat([D]):null,bg(4,4,Ag.bind(null,O,D),Y)}function Tg(){}function Dx(D,O){var Y=hl();O=O===void 0?null:O;var se=Y.memoizedState;return se!==null&&O!==null&&Kr(O,se[1])?se[0]:(Y.memoizedState=[D,O],D)}function bd(D,O){var Y=hl();O=O===void 0?null:O;var se=Y.memoizedState;return se!==null&&O!==null&&Kr(O,se[1])?se[0]:(D=D(),Y.memoizedState=[D,O],D)}function Gp(D,O){var Y=vr;vr=Y!==0&&4>Y?Y:4,D(!0);var se=Jo.transition;Jo.transition={};try{D(!1),O()}finally{vr=Y,Jo.transition=se}}function q0(){return hl().memoizedState}function fl(D,O,Y){var se=fc(D);Y={lane:se,action:Y,hasEagerState:!1,eagerState:null,next:null},Vp(D)?Hp(O,Y):(Mg(D,O,Y),Y=Qs(),D=el(D,se,Y),D!==null&&Eg(D,O,se))}function Z0(D,O,Y){var se=fc(D),pe={lane:se,action:Y,hasEagerState:!1,eagerState:null,next:null};if(Vp(D))Hp(O,pe);else{Mg(D,O,pe);var Te=D.alternate;if(D.lanes===0&&(Te===null||Te.lanes===0)&&(Te=O.lastRenderedReducer,Te!==null))try{var dt=O.lastRenderedState,Ot=Te(dt,Y);if(pe.hasEagerState=!0,pe.eagerState=Ot,ll(Ot,dt))return}catch{}finally{}Y=Qs(),D=el(D,se,Y),D!==null&&Eg(D,O,se)}}function Vp(D){var O=D.alternate;return D===Cs||O!==null&&O===Cs}function Hp(D,O){bu=xu=!0;var Y=D.pending;Y===null?O.next=O:(O.next=Y.next,Y.next=O),D.pending=O}function Mg(D,O,Y){Js!==null&&D.mode&1&&!(di&2)?(D=O.interleaved,D===null?(Y.next=Y,Do===null?Do=[O]:Do.push(O)):(Y.next=D.next,D.next=Y),O.interleaved=Y):(D=O.pending,D===null?Y.next=Y:(Y.next=D.next,D.next=Y),O.pending=Y)}function Eg(D,O,Y){if(Y&4194240){var se=O.lanes;se&=D.pendingLanes,Y|=se,O.lanes=Y,Rp(D,Y)}}var rf={readContext:Ys,useCallback:Hs,useContext:Hs,useEffect:Hs,useImperativeHandle:Hs,useInsertionEffect:Hs,useLayoutEffect:Hs,useMemo:Hs,useReducer:Hs,useRef:Hs,useState:Hs,useDebugValue:Hs,useDeferredValue:Hs,useTransition:Hs,useMutableSource:Hs,useSyncExternalStore:Hs,useId:Hs,unstable_isNewReconciler:!1},Y0={readContext:Ys,useCallback:function(D,O){return Cl().memoizedState=[D,O===void 0?null:O],D},useContext:Ys,useEffect:$0,useImperativeHandle:function(D,O,Y){return Y=Y!=null?Y.concat([D]):null,xg(4194308,4,Ag.bind(null,O,D),Y)},useLayoutEffect:function(D,O){return xg(4194308,4,D,O)},useInsertionEffect:function(D,O){return xg(4,2,D,O)},useMemo:function(D,O){var Y=Cl();return O=O===void 0?null:O,D=D(),Y.memoizedState=[D,O],D},useReducer:function(D,O,Y){var se=Cl();return O=Y!==void 0?Y(O):O,se.memoizedState=se.baseState=O,D={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:D,lastRenderedState:O},se.queue=D,D=D.dispatch=fl.bind(null,Cs,D),[se.memoizedState,D]},useRef:function(D){var O=Cl();return D={current:D},O.memoizedState=D},useState:yg,useDebugValue:Tg,useDeferredValue:function(D){var O=yg(D),Y=O[0],se=O[1];return $0(function(){var pe=Jo.transition;Jo.transition={};try{se(D)}finally{Jo.transition=pe}},[D]),Y},useTransition:function(){var D=yg(!1),O=D[0];return D=Gp.bind(null,D[1]),Cl().memoizedState=D,[O,D]},useMutableSource:function(){},useSyncExternalStore:function(D,O,Y){var se=Cs,pe=Cl();if(ns){if(Y===void 0)throw Error(o(407));Y=Y()}else{if(Y=O(),Js===null)throw Error(o(349));ef&30||Up(se,O,Y)}pe.memoizedState=Y;var Te={value:Y,getSnapshot:O};return pe.queue=Te,$0(H0.bind(null,se,Te,D),[D]),se.flags|=2048,Gc(9,xd.bind(null,se,Te,Y,O),void 0,null),Y},useId:function(){var D=Cl(),O=Js.identifierPrefix;if(ns){var Y=nc,se=pr;Y=(se&~(1<<32-Po(se)-1)).toString(32)+Y,O=":"+O+"R"+Y,Y=Zu++,0<Y&&(O+="H"+Y.toString(32)),O+=":"}else Y=Yu++,O=":"+O+"r"+Y.toString(32)+":";return D.memoizedState=O},unstable_isNewReconciler:!1},jp={readContext:Ys,useCallback:Dx,useContext:Ys,useEffect:nf,useImperativeHandle:X0,useInsertionEffect:wg,useLayoutEffect:Sg,useMemo:bd,useReducer:bi,useRef:W0,useState:function(){return bi(ac)},useDebugValue:Tg,useDeferredValue:function(D){var O=bi(ac),Y=O[0],se=O[1];return nf(function(){var pe=Jo.transition;Jo.transition={};try{se(D)}finally{Jo.transition=pe}},[D]),Y},useTransition:function(){var D=bi(ac)[0],O=hl().memoizedState;return[D,O]},useMutableSource:V0,useSyncExternalStore:_g,useId:q0,unstable_isNewReconciler:!1},Cg={readContext:Ys,useCallback:Dx,useContext:Ys,useEffect:nf,useImperativeHandle:X0,useInsertionEffect:wg,useLayoutEffect:Sg,useMemo:bd,useReducer:yd,useRef:W0,useState:function(){return yd(ac)},useDebugValue:Tg,useDeferredValue:function(D){var O=yd(ac),Y=O[0],se=O[1];return nf(function(){var pe=Jo.transition;Jo.transition={};try{se(D)}finally{Jo.transition=pe}},[D]),Y},useTransition:function(){var D=yd(ac)[0],O=hl().memoizedState;return[D,O]},useMutableSource:V0,useSyncExternalStore:_g,useId:q0,unstable_isNewReconciler:!1};function Wp(D,O){try{var Y="",se=O;do Y+=hg(se),se=se.return;while(se);var pe=Y}catch(Te){pe=`
Error generating stack: `+Te.message+`
`+Te.stack}return{value:D,source:O,stack:pe}}function Ig(D,O){try{console.error(O.value)}catch(Y){setTimeout(function(){throw Y})}}var wd=typeof WeakMap=="function"?WeakMap:Map;function Bx(D,O,Y){Y=ao(-1,Y),Y.tag=3,Y.payload={element:null};var se=O.value;return Y.callback=function(){Qo||(Qo=!0,o_=se),Ig(D,O)},Y}function K0(D,O,Y){Y=ao(-1,Y),Y.tag=3;var se=D.type.getDerivedStateFromError;if(typeof se=="function"){var pe=O.value;Y.payload=function(){return se(pe)},Y.callback=function(){Ig(D,O)}}var Te=D.stateNode;return Te!==null&&typeof Te.componentDidCatch=="function"&&(Y.callback=function(){Ig(D,O),typeof se!="function"&&(js===null?js=new Set([this]):js.add(this));var dt=O.stack;this.componentDidCatch(O.value,{componentStack:dt!==null?dt:""})}),Y}function J0(D,O,Y){var se=D.pingCache;if(se===null){se=D.pingCache=new wd;var pe=new Set;se.set(O,pe)}else pe=se.get(O),pe===void 0&&(pe=new Set,se.set(O,pe));pe.has(Y)||(pe.add(Y),D=Wg.bind(null,D,O,Y),O.then(D,D))}function sf(D){do{var O;if((O=D.tag===13)&&(O=D.memoizedState,O=O!==null?O.dehydrated!==null:!0),O)return D;D=D.return}while(D!==null);return null}function Q0(D,O,Y,se,pe){return D.mode&1?(D.flags|=65536,D.lanes=pe,D):(D===O?D.flags|=65536:(D.flags|=128,Y.flags|=131072,Y.flags&=-52805,Y.tag===1&&(Y.alternate===null?Y.tag=17:(O=ao(-1,1),O.tag=2,$u(Y,O))),Y.lanes|=1),D)}function oc(D){D.flags|=4}function Rg(D,O){if(D!==null&&D.child===O.child)return!0;if(O.flags&16)return!1;for(D=O.child;D!==null;){if(D.flags&12854||D.subtreeFlags&12854)return!1;D=D.sibling}return!0}var wu,Ju,Su,$p;if(Le)wu=function(D,O){for(var Y=O.child;Y!==null;){if(Y.tag===5||Y.tag===6)xt(D,Y.stateNode);else if(Y.tag!==4&&Y.child!==null){Y.child.return=Y,Y=Y.child;continue}if(Y===O)break;for(;Y.sibling===null;){if(Y.return===null||Y.return===O)return;Y=Y.return}Y.sibling.return=Y.return,Y=Y.sibling}},Ju=function(){},Su=function(D,O,Y,se,pe){if(D=D.memoizedProps,D!==se){var Te=O.stateNode,dt=sc(Oo.current);Y=lt(Te,Y,D,se,pe,dt),(O.updateQueue=Y)&&oc(O)}},$p=function(D,O,Y,se){Y!==se&&oc(O)};else if(qe){wu=function(D,O,Y,se){for(var pe=O.child;pe!==null;){if(pe.tag===5){var Te=pe.stateNode;Y&&se&&(Te=Tt(Te,pe.type,pe.memoizedProps,pe)),xt(D,Te)}else if(pe.tag===6)Te=pe.stateNode,Y&&se&&(Te=xe(Te,pe.memoizedProps,pe)),xt(D,Te);else if(pe.tag!==4){if(pe.tag===22&&pe.memoizedState!==null)Te=pe.child,Te!==null&&(Te.return=pe),wu(D,pe,!0,!0);else if(pe.child!==null){pe.child.return=pe,pe=pe.child;continue}}if(pe===O)break;for(;pe.sibling===null;){if(pe.return===null||pe.return===O)return;pe=pe.return}pe.sibling.return=pe.return,pe=pe.sibling}};var Pg=function(D,O,Y,se){for(var pe=O.child;pe!==null;){if(pe.tag===5){var Te=pe.stateNode;Y&&se&&(Te=Tt(Te,pe.type,pe.memoizedProps,pe)),hs(D,Te)}else if(pe.tag===6)Te=pe.stateNode,Y&&se&&(Te=xe(Te,pe.memoizedProps,pe)),hs(D,Te);else if(pe.tag!==4){if(pe.tag===22&&pe.memoizedState!==null)Te=pe.child,Te!==null&&(Te.return=pe),Pg(D,pe,!0,!0);else if(pe.child!==null){pe.child.return=pe,pe=pe.child;continue}}if(pe===O)break;for(;pe.sibling===null;){if(pe.return===null||pe.return===O)return;pe=pe.return}pe.sibling.return=pe.return,pe=pe.sibling}};Ju=function(D,O){var Y=O.stateNode;if(!Rg(D,O)){D=Y.containerInfo;var se=Vr(D);Pg(se,O,!1,!1),Y.pendingChildren=se,oc(O),Ls(D,se)}},Su=function(D,O,Y,se,pe){var Te=D.stateNode,dt=D.memoizedProps;if((D=Rg(D,O))&&dt===se)O.stateNode=Te;else{var Ot=O.stateNode,vn=sc(Oo.current),Wn=null;dt!==se&&(Wn=lt(Ot,Y,dt,se,pe,vn)),D&&Wn===null?O.stateNode=Te:(Te=Ar(Te,Wn,Y,dt,se,O,D,Ot),Vt(Te,Y,se,pe,vn)&&oc(O),O.stateNode=Te,D?oc(O):wu(Te,O,!1,!1))}},$p=function(D,O,Y,se){Y!==se?(D=sc(Jh.current),Y=sc(Oo.current),O.stateNode=Qt(se,D,Y,O),oc(O)):O.stateNode=D.stateNode}}else Ju=function(){},Su=function(){},$p=function(){};function af(D,O){if(!ns)switch(D.tailMode){case"hidden":O=D.tail;for(var Y=null;O!==null;)O.alternate!==null&&(Y=O),O=O.sibling;Y===null?D.tail=null:Y.sibling=null;break;case"collapsed":Y=D.tail;for(var se=null;Y!==null;)Y.alternate!==null&&(se=Y),Y=Y.sibling;se===null?O||D.tail===null?D.tail=null:D.tail.sibling=null:se.sibling=null}}function Za(D){var O=D.alternate!==null&&D.alternate.child===D.child,Y=0,se=0;if(O)for(var pe=D.child;pe!==null;)Y|=pe.lanes|pe.childLanes,se|=pe.subtreeFlags&14680064,se|=pe.flags&14680064,pe.return=D,pe=pe.sibling;else for(pe=D.child;pe!==null;)Y|=pe.lanes|pe.childLanes,se|=pe.subtreeFlags,se|=pe.flags,pe.return=D,pe=pe.sibling;return D.subtreeFlags|=se,D.childLanes=Y,O}function of(D,O,Y){var se=O.pendingProps;switch(vd(O),O.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Za(O),null;case 1:return fs(O.type)&&Li(),Za(O),null;case 3:return se=O.stateNode,Qh(),Cr(ys),Cr(qr),vg(),se.pendingContext&&(se.context=se.pendingContext,se.pendingContext=null),(D===null||D.child===null)&&(Yh(O)?oc(O):D===null||D.memoizedState.isDehydrated&&!(O.flags&256)||(O.flags|=1024,Yo!==null&&(Dd(Yo),Yo=null))),Ju(D,O),Za(O),null;case 5:Fp(O),Y=sc(Jh.current);var pe=O.type;if(D!==null&&O.stateNode!=null)Su(D,O,pe,se,Y),D.ref!==O.ref&&(O.flags|=512,O.flags|=2097152);else{if(!se){if(O.stateNode===null)throw Error(o(166));return Za(O),null}if(D=sc(Oo.current),Yh(O)){if(!mn)throw Error(o(175));D=ln(O.stateNode,O.type,O.memoizedProps,Y,D,O,!la),O.updateQueue=D,D!==null&&oc(O)}else{var Te=vt(pe,se,Y,D,O);wu(Te,O,!1,!1),O.stateNode=Te,Vt(Te,pe,se,Y,D)&&oc(O)}O.ref!==null&&(O.flags|=512,O.flags|=2097152)}return Za(O),null;case 6:if(D&&O.stateNode!=null)$p(D,O,D.memoizedProps,se);else{if(typeof se!="string"&&O.stateNode===null)throw Error(o(166));if(D=sc(Jh.current),Y=sc(Oo.current),Yh(O)){if(!mn)throw Error(o(176));if(D=O.stateNode,se=O.memoizedProps,(Y=Mn(D,se,O,!la))&&(pe=ko,pe!==null))switch(Te=(pe.mode&1)!==0,pe.tag){case 3:_n(pe.stateNode.containerInfo,D,se,Te);break;case 5:zn(pe.type,pe.memoizedProps,pe.stateNode,D,se,Te)}Y&&oc(O)}else O.stateNode=Qt(se,D,Y,O)}return Za(O),null;case 13:if(Cr(Es),se=O.memoizedState,ns&&xa!==null&&O.mode&1&&!(O.flags&128)){for(D=xa;D;)D=gt(D);return yn(),O.flags|=98560,O}if(se!==null&&se.dehydrated!==null){if(se=Yh(O),D===null){if(!se)throw Error(o(318));if(!mn)throw Error(o(344));if(D=O.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(o(317));En(D,O)}else yn(),!(O.flags&128)&&(O.memoizedState=null),O.flags|=4;return Za(O),null}return Yo!==null&&(Dd(Yo),Yo=null),O.flags&128?(O.lanes=Y,O):(se=se!==null,Y=!1,D===null?Yh(O):Y=D.memoizedState!==null,se&&!Y&&(O.child.flags|=8192,O.mode&1&&(D===null||Es.current&1?Oa===0&&(Oa=3):wa())),O.updateQueue!==null&&(O.flags|=4),Za(O),null);case 4:return Qh(),Ju(D,O),D===null&&St(O.stateNode.containerInfo),Za(O),null;case 10:return ul(O.type._context),Za(O),null;case 17:return fs(O.type)&&Li(),Za(O),null;case 19:if(Cr(Es),pe=O.memoizedState,pe===null)return Za(O),null;if(se=(O.flags&128)!==0,Te=pe.rendering,Te===null)if(se)af(pe,!1);else{if(Oa!==0||D!==null&&D.flags&128)for(D=O.child;D!==null;){if(Te=Np(D),Te!==null){for(O.flags|=128,af(pe,!1),D=Te.updateQueue,D!==null&&(O.updateQueue=D,O.flags|=4),O.subtreeFlags=0,D=Y,se=O.child;se!==null;)Y=se,pe=D,Y.flags&=14680066,Te=Y.alternate,Te===null?(Y.childLanes=0,Y.lanes=pe,Y.child=null,Y.subtreeFlags=0,Y.memoizedProps=null,Y.memoizedState=null,Y.updateQueue=null,Y.dependencies=null,Y.stateNode=null):(Y.childLanes=Te.childLanes,Y.lanes=Te.lanes,Y.child=Te.child,Y.subtreeFlags=0,Y.deletions=null,Y.memoizedProps=Te.memoizedProps,Y.memoizedState=Te.memoizedState,Y.updateQueue=Te.updateQueue,Y.type=Te.type,pe=Te.dependencies,Y.dependencies=pe===null?null:{lanes:pe.lanes,firstContext:pe.firstContext}),se=se.sibling;return Qn(Es,Es.current&1|2),O.child}D=D.sibling}pe.tail!==null&&bs()>rh&&(O.flags|=128,se=!0,af(pe,!1),O.lanes=4194304)}else{if(!se)if(D=Np(Te),D!==null){if(O.flags|=128,se=!0,D=D.updateQueue,D!==null&&(O.updateQueue=D,O.flags|=4),af(pe,!0),pe.tail===null&&pe.tailMode==="hidden"&&!Te.alternate&&!ns)return Za(O),null}else 2*bs()-pe.renderingStartTime>rh&&Y!==1073741824&&(O.flags|=128,se=!0,af(pe,!1),O.lanes=4194304);pe.isBackwards?(Te.sibling=O.child,O.child=Te):(D=pe.last,D!==null?D.sibling=Te:O.child=Te,pe.last=Te)}return pe.tail!==null?(O=pe.tail,pe.rendering=O,pe.tail=O.sibling,pe.renderingStartTime=bs(),O.sibling=null,D=Es.current,Qn(Es,se?D&1|2:D&1),O):(Za(O),null);case 22:case 23:return ih(),se=O.memoizedState!==null,D!==null&&D.memoizedState!==null!==se&&(O.flags|=8192),se&&O.mode&1?ka&1073741824&&(Za(O),Le&&O.subtreeFlags&6&&(O.flags|=8192)):Za(O),null;case 24:return null;case 25:return null}throw Error(o(156,O.tag))}var kx=l.ReactCurrentOwner,ba=!1;function lo(D,O,Y,se){O.child=D===null?pg(O,null,Y,se):Ko(O,D.child,Y,se)}function Xp(D,O,Y,se,pe){Y=Y.render;var Te=O.ref;return Wu(O,pe),se=Ku(D,O,Y,se,Te,pe),Y=tf(),D!==null&&!ba?(O.updateQueue=D.updateQueue,O.flags&=-2053,D.lanes&=~pe,Il(D,O,pe)):(ns&&Y&&Bp(O),O.flags|=1,lo(D,O,se,pe),O.child)}function Lg(D,O,Y,se,pe){if(D===null){var Te=Y.type;return typeof Te=="function"&&!qg(Te)&&Te.defaultProps===void 0&&Y.compare===null&&Y.defaultProps===void 0?(O.tag=15,O.type=Te,e_(D,O,Te,se,pe)):(D=sm(Y.type,null,se,O,O.mode,pe),D.ref=O.ref,D.return=O,O.child=D)}if(Te=D.child,!(D.lanes&pe)){var dt=Te.memoizedProps;if(Y=Y.compare,Y=Y!==null?Y:cl,Y(dt,se)&&D.ref===O.ref)return Il(D,O,pe)}return O.flags|=1,D=Mu(Te,se),D.ref=O.ref,D.return=O,O.child=D}function e_(D,O,Y,se,pe){if(D!==null&&cl(D.memoizedProps,se)&&D.ref===O.ref)if(ba=!1,(D.lanes&pe)!==0)D.flags&131072&&(ba=!0);else return O.lanes=D.lanes,Il(D,O,pe);return Bg(D,O,Y,se,pe)}function Dg(D,O,Y){var se=O.pendingProps,pe=se.children,Te=D!==null?D.memoizedState:null;if(se.mode==="hidden")if(!(O.mode&1))O.memoizedState={baseLanes:0,cachePool:null},Qn(uc,ka),ka|=Y;else if(Y&1073741824)O.memoizedState={baseLanes:0,cachePool:null},se=Te!==null?Te.baseLanes:Y,Qn(uc,ka),ka|=se;else return D=Te!==null?Te.baseLanes|Y:Y,O.lanes=O.childLanes=1073741824,O.memoizedState={baseLanes:D,cachePool:null},O.updateQueue=null,Qn(uc,ka),ka|=D,null;else Te!==null?(se=Te.baseLanes|Y,O.memoizedState=null):se=Y,Qn(uc,ka),ka|=se;return lo(D,O,pe,Y),O.child}function qp(D,O){var Y=O.ref;(D===null&&Y!==null||D!==null&&D.ref!==Y)&&(O.flags|=512,O.flags|=2097152)}function Bg(D,O,Y,se,pe){var Te=fs(Y)?$a:qr.current;return Te=Ds(O,Te),Wu(O,pe),Y=Ku(D,O,Y,se,Te,pe),se=tf(),D!==null&&!ba?(O.updateQueue=D.updateQueue,O.flags&=-2053,D.lanes&=~pe,Il(D,O,pe)):(ns&&se&&Bp(O),O.flags|=1,lo(D,O,Y,pe),O.child)}function t_(D,O,Y,se,pe){if(fs(Y)){var Te=!0;Ts(O)}else Te=!1;if(Wu(O,pe),O.stateNode===null)D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),gd(O,Y,se),G0(O,Y,se,pe),se=!0;else if(D===null){var dt=O.stateNode,Ot=O.memoizedProps;dt.props=Ot;var vn=dt.context,Wn=Y.contextType;typeof Wn=="object"&&Wn!==null?Wn=Ys(Wn):(Wn=fs(Y)?$a:qr.current,Wn=Ds(O,Wn));var br=Y.getDerivedStateFromProps,oi=typeof br=="function"||typeof dt.getSnapshotBeforeUpdate=="function";oi||typeof dt.UNSAFE_componentWillReceiveProps!="function"&&typeof dt.componentWillReceiveProps!="function"||(Ot!==se||vn!==Wn)&&qu(O,dt,se,Wn),Zo=!1;var zr=O.memoizedState;dt.state=zr,fg(O,se,dt,pe),vn=O.memoizedState,Ot!==se||zr!==vn||ys.current||Zo?(typeof br=="function"&&(Xu(O,Y,br,se),vn=O.memoizedState),(Ot=Zo||Lx(O,Y,Ot,se,zr,vn,Wn))?(oi||typeof dt.UNSAFE_componentWillMount!="function"&&typeof dt.componentWillMount!="function"||(typeof dt.componentWillMount=="function"&&dt.componentWillMount(),typeof dt.UNSAFE_componentWillMount=="function"&&dt.UNSAFE_componentWillMount()),typeof dt.componentDidMount=="function"&&(O.flags|=4194308)):(typeof dt.componentDidMount=="function"&&(O.flags|=4194308),O.memoizedProps=se,O.memoizedState=vn),dt.props=se,dt.state=vn,dt.context=Wn,se=Ot):(typeof dt.componentDidMount=="function"&&(O.flags|=4194308),se=!1)}else{dt=O.stateNode,Pp(D,O),Ot=O.memoizedProps,Wn=O.type===O.elementType?Ot:Vs(O.type,Ot),dt.props=Wn,oi=O.pendingProps,zr=dt.context,vn=Y.contextType,typeof vn=="object"&&vn!==null?vn=Ys(vn):(vn=fs(Y)?$a:qr.current,vn=Ds(O,vn));var ps=Y.getDerivedStateFromProps;(br=typeof ps=="function"||typeof dt.getSnapshotBeforeUpdate=="function")||typeof dt.UNSAFE_componentWillReceiveProps!="function"&&typeof dt.componentWillReceiveProps!="function"||(Ot!==oi||zr!==vn)&&qu(O,dt,se,vn),Zo=!1,zr=O.memoizedState,dt.state=zr,fg(O,se,dt,pe);var Ir=O.memoizedState;Ot!==oi||zr!==Ir||ys.current||Zo?(typeof ps=="function"&&(Xu(O,Y,ps,se),Ir=O.memoizedState),(Wn=Zo||Lx(O,Y,Wn,se,zr,Ir,vn)||!1)?(br||typeof dt.UNSAFE_componentWillUpdate!="function"&&typeof dt.componentWillUpdate!="function"||(typeof dt.componentWillUpdate=="function"&&dt.componentWillUpdate(se,Ir,vn),typeof dt.UNSAFE_componentWillUpdate=="function"&&dt.UNSAFE_componentWillUpdate(se,Ir,vn)),typeof dt.componentDidUpdate=="function"&&(O.flags|=4),typeof dt.getSnapshotBeforeUpdate=="function"&&(O.flags|=1024)):(typeof dt.componentDidUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=4),typeof dt.getSnapshotBeforeUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=1024),O.memoizedProps=se,O.memoizedState=Ir),dt.props=se,dt.state=Ir,dt.context=vn,se=Wn):(typeof dt.componentDidUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=4),typeof dt.getSnapshotBeforeUpdate!="function"||Ot===D.memoizedProps&&zr===D.memoizedState||(O.flags|=1024),se=!1)}return lf(D,O,Y,se,Te,pe)}function lf(D,O,Y,se,pe,Te){qp(D,O);var dt=(O.flags&128)!==0;if(!se&&!dt)return pe&&Oc(O,Y,!1),Il(D,O,Te);se=O.stateNode,kx.current=O;var Ot=dt&&typeof Y.getDerivedStateFromError!="function"?null:se.render();return O.flags|=1,D!==null&&dt?(O.child=Ko(O,D.child,null,Te),O.child=Ko(O,null,Ot,Te)):lo(D,O,Ot,Te),O.memoizedState=se.state,pe&&Oc(O,Y,!0),O.child}function Ox(D){var O=D.stateNode;O.pendingContext?oa(D,O.pendingContext,O.pendingContext!==O.context):O.context&&oa(D,O.context,!1),Fo(D,O.containerInfo)}function n_(D,O,Y,se,pe){return yn(),dg(pe),O.flags|=256,lo(D,O,Y,se),O.child}var Zp={dehydrated:null,treeContext:null,retryLane:0};function kg(D){return{baseLanes:D,cachePool:null}}function Yp(D,O,Y){var se=O.pendingProps,pe=Es.current,Te=!1,dt=(O.flags&128)!==0,Ot;if((Ot=dt)||(Ot=D!==null&&D.memoizedState===null?!1:(pe&2)!==0),Ot?(Te=!0,O.flags&=-129):(D===null||D.memoizedState!==null)&&(pe|=1),Qn(Es,pe&1),D===null)return ic(O),D=O.memoizedState,D!==null&&(D=D.dehydrated,D!==null)?(O.mode&1?pt(D)?O.lanes=8:O.lanes=1073741824:O.lanes=1,null):(pe=se.children,D=se.fallback,Te?(se=O.mode,Te=O.child,pe={mode:"hidden",children:pe},!(se&1)&&Te!==null?(Te.childLanes=0,Te.pendingProps=pe):Te=am(pe,se,0,null),D=sh(D,se,Y,null),Te.return=O,D.return=O,Te.sibling=D,O.child=Te,O.child.memoizedState=kg(Y),O.memoizedState=Zp,D):Sd(O,pe));if(pe=D.memoizedState,pe!==null){if(Ot=pe.dehydrated,Ot!==null){if(dt)return O.flags&256?(O.flags&=-257,dl(D,O,Y,Error(o(422)))):O.memoizedState!==null?(O.child=D.child,O.flags|=128,null):(Te=se.fallback,pe=O.mode,se=am({mode:"visible",children:se.children},pe,0,null),Te=sh(Te,pe,Y,null),Te.flags|=2,se.return=O,Te.return=O,se.sibling=Te,O.child=se,O.mode&1&&Ko(O,D.child,null,Y),O.child.memoizedState=kg(Y),O.memoizedState=Zp,Te);if(!(O.mode&1))O=dl(D,O,Y,null);else if(pt(Ot))O=dl(D,O,Y,Error(o(419)));else if(se=(Y&D.childLanes)!==0,ba||se){if(se=Js,se!==null){switch(Y&-Y){case 4:Te=2;break;case 16:Te=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Te=32;break;case 536870912:Te=268435456;break;default:Te=0}se=Te&(se.suspendedLanes|Y)?0:Te,se!==0&&se!==pe.retryLane&&(pe.retryLane=se,el(D,se,-1))}wa(),O=dl(D,O,Y,Error(o(421)))}else Je(Ot)?(O.flags|=128,O.child=D.child,O=Gx.bind(null,D),Rt(Ot,O),O=null):(Y=pe.treeContext,mn&&(xa=Bt(Ot),ko=O,ns=!0,Yo=null,la=!1,Y!==null&&(Mr[Xn++]=pr,Mr[Xn++]=nc,Mr[Xn++]=yu,pr=Y.id,nc=Y.overflow,yu=O)),O=Sd(O,O.pendingProps.children),O.flags|=4096);return O}return Te?(se=Og(D,O,se.children,se.fallback,Y),Te=O.child,pe=D.child.memoizedState,Te.memoizedState=pe===null?kg(Y):{baseLanes:pe.baseLanes|Y,cachePool:null},Te.childLanes=D.childLanes&~Y,O.memoizedState=Zp,se):(Y=Ad(D,O,se.children,Y),O.memoizedState=null,Y)}return Te?(se=Og(D,O,se.children,se.fallback,Y),Te=O.child,pe=D.child.memoizedState,Te.memoizedState=pe===null?kg(Y):{baseLanes:pe.baseLanes|Y,cachePool:null},Te.childLanes=D.childLanes&~Y,O.memoizedState=Zp,se):(Y=Ad(D,O,se.children,Y),O.memoizedState=null,Y)}function Sd(D,O){return O=am({mode:"visible",children:O},D.mode,0,null),O.return=D,D.child=O}function Ad(D,O,Y,se){var pe=D.child;return D=pe.sibling,Y=Mu(pe,{mode:"visible",children:Y}),!(O.mode&1)&&(Y.lanes=se),Y.return=O,Y.sibling=null,D!==null&&(se=O.deletions,se===null?(O.deletions=[D],O.flags|=16):se.push(D)),O.child=Y}function Og(D,O,Y,se,pe){var Te=O.mode;D=D.child;var dt=D.sibling,Ot={mode:"hidden",children:Y};return!(Te&1)&&O.child!==D?(Y=O.child,Y.childLanes=0,Y.pendingProps=Ot,O.deletions=null):(Y=Mu(D,Ot),Y.subtreeFlags=D.subtreeFlags&14680064),dt!==null?se=Mu(dt,se):(se=sh(se,Te,pe,null),se.flags|=2),se.return=O,Y.return=O,Y.sibling=se,O.child=Y,se}function dl(D,O,Y,se){return se!==null&&dg(se),Ko(O,D.child,null,Y),D=Sd(O,O.pendingProps.children),D.flags|=2,O.memoizedState=null,D}function r_(D,O,Y){D.lanes|=O;var se=D.alternate;se!==null&&(se.lanes|=O),Zs(D.return,O,Y)}function Td(D,O,Y,se,pe){var Te=D.memoizedState;Te===null?D.memoizedState={isBackwards:O,rendering:null,renderingStartTime:0,last:se,tail:Y,tailMode:pe}:(Te.isBackwards=O,Te.rendering=null,Te.renderingStartTime=0,Te.last=se,Te.tail=Y,Te.tailMode=pe)}function Kp(D,O,Y){var se=O.pendingProps,pe=se.revealOrder,Te=se.tail;if(lo(D,O,se.children,Y),se=Es.current,se&2)se=se&1|2,O.flags|=128;else{if(D!==null&&D.flags&128)e:for(D=O.child;D!==null;){if(D.tag===13)D.memoizedState!==null&&r_(D,Y,O);else if(D.tag===19)r_(D,Y,O);else if(D.child!==null){D.child.return=D,D=D.child;continue}if(D===O)break e;for(;D.sibling===null;){if(D.return===null||D.return===O)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}se&=1}if(Qn(Es,se),!(O.mode&1))O.memoizedState=null;else switch(pe){case"forwards":for(Y=O.child,pe=null;Y!==null;)D=Y.alternate,D!==null&&Np(D)===null&&(pe=Y),Y=Y.sibling;Y=pe,Y===null?(pe=O.child,O.child=null):(pe=Y.sibling,Y.sibling=null),Td(O,!1,pe,Y,Te);break;case"backwards":for(Y=null,pe=O.child,O.child=null;pe!==null;){if(D=pe.alternate,D!==null&&Np(D)===null){O.child=pe;break}D=pe.sibling,pe.sibling=Y,Y=pe,pe=D}Td(O,!0,Y,null,Te);break;case"together":Td(O,!1,null,null,void 0);break;default:O.memoizedState=null}return O.child}function Il(D,O,Y){if(D!==null&&(O.dependencies=D.dependencies),ff|=O.lanes,!(Y&O.childLanes))return null;if(D!==null&&O.child!==D.child)throw Error(o(153));if(O.child!==null){for(D=O.child,Y=Mu(D,D.pendingProps),O.child=Y,Y.return=O;D.sibling!==null;)D=D.sibling,Y=Y.sibling=Mu(D,D.pendingProps),Y.return=O;Y.sibling=null}return O.child}function i_(D,O,Y){switch(O.tag){case 3:Ox(O),yn();break;case 5:mg(O);break;case 1:fs(O.type)&&Ts(O);break;case 4:Fo(O,O.stateNode.containerInfo);break;case 10:_o(O,O.type._context,O.memoizedProps.value);break;case 13:var se=O.memoizedState;if(se!==null)return se.dehydrated!==null?(Qn(Es,Es.current&1),O.flags|=128,null):Y&O.child.childLanes?Yp(D,O,Y):(Qn(Es,Es.current&1),D=Il(D,O,Y),D!==null?D.sibling:null);Qn(Es,Es.current&1);break;case 19:if(se=(Y&O.childLanes)!==0,D.flags&128){if(se)return Kp(D,O,Y);O.flags|=128}var pe=O.memoizedState;if(pe!==null&&(pe.rendering=null,pe.tail=null,pe.lastEffect=null),Qn(Es,Es.current),se)break;return null;case 22:case 23:return O.lanes=0,Dg(D,O,Y)}return Il(D,O,Y)}function Fx(D,O){switch(vd(O),O.tag){case 1:return fs(O.type)&&Li(),D=O.flags,D&65536?(O.flags=D&-65537|128,O):null;case 3:return Qh(),Cr(ys),Cr(qr),vg(),D=O.flags,D&65536&&!(D&128)?(O.flags=D&-65537|128,O):null;case 5:return Fp(O),null;case 13:if(Cr(Es),D=O.memoizedState,D!==null&&D.dehydrated!==null){if(O.alternate===null)throw Error(o(340));yn()}return D=O.flags,D&65536?(O.flags=D&-65537|128,O):null;case 19:return Cr(Es),null;case 4:return Qh(),null;case 10:return ul(O.type._context),null;case 22:case 23:return ih(),null;case 24:return null;default:return null}}var Vc=!1,Rl=!1,Fn=typeof WeakSet=="function"?WeakSet:Set,sr=null;function Jp(D,O){var Y=D.ref;if(Y!==null)if(typeof Y=="function")try{Y(null)}catch(se){co(D,O,se)}else Y.current=null}function xo(D,O,Y){try{Y()}catch(se){co(D,O,se)}}var Qu=!1;function Yn(D,O){for(We(D.containerInfo),sr=O;sr!==null;)if(D=sr,O=D.child,(D.subtreeFlags&1028)!==0&&O!==null)O.return=D,sr=O;else for(;sr!==null;){D=sr;try{var Y=D.alternate;if(D.flags&1024)switch(D.tag){case 0:case 11:case 15:break;case 1:if(Y!==null){var se=Y.memoizedProps,pe=Y.memoizedState,Te=D.stateNode,dt=Te.getSnapshotBeforeUpdate(D.elementType===D.type?se:Vs(D.type,se),pe);Te.__reactInternalSnapshotBeforeUpdate=dt}break;case 3:Le&&Cn(D.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Ot){co(D,D.return,Ot)}if(O=D.sibling,O!==null){O.return=D.return,sr=O;break}sr=D.return}return Y=Qu,Qu=!1,Y}function Hc(D,O,Y){var se=O.updateQueue;if(se=se!==null?se.lastEffect:null,se!==null){var pe=se=se.next;do{if((pe.tag&D)===D){var Te=pe.destroy;pe.destroy=void 0,Te!==void 0&&xo(O,Y,Te)}pe=pe.next}while(pe!==se)}}function Qp(D,O){if(O=O.updateQueue,O=O!==null?O.lastEffect:null,O!==null){var Y=O=O.next;do{if((Y.tag&D)===D){var se=Y.create;Y.destroy=se()}Y=Y.next}while(Y!==O)}}function Md(D){var O=D.ref;if(O!==null){var Y=D.stateNode;switch(D.tag){case 5:D=Re(Y);break;default:D=Y}typeof O=="function"?O(D):O.current=D}}function em(D,O,Y){if(Gs&&typeof Gs.onCommitFiberUnmount=="function")try{Gs.onCommitFiberUnmount(Zr,O)}catch{}switch(O.tag){case 0:case 11:case 14:case 15:if(D=O.updateQueue,D!==null&&(D=D.lastEffect,D!==null)){var se=D=D.next;do{var pe=se,Te=pe.destroy;pe=pe.tag,Te!==void 0&&(pe&2||pe&4)&&xo(O,Y,Te),se=se.next}while(se!==D)}break;case 1:if(Jp(O,Y),D=O.stateNode,typeof D.componentWillUnmount=="function")try{D.props=O.memoizedProps,D.state=O.memoizedState,D.componentWillUnmount()}catch(dt){co(O,Y,dt)}break;case 5:Jp(O,Y);break;case 4:Le?uf(D,O,Y):qe&&qe&&(O=O.stateNode.containerInfo,Y=Vr(O),hi(O,Y))}}function Ed(D,O,Y){for(var se=O;;)if(em(D,se,Y),se.child===null||Le&&se.tag===4){if(se===O)break;for(;se.sibling===null;){if(se.return===null||se.return===O)return;se=se.return}se.sibling.return=se.return,se=se.sibling}else se.child.return=se,se=se.child}function Fg(D){var O=D.alternate;O!==null&&(D.alternate=null,Fg(O)),D.child=null,D.deletions=null,D.sibling=null,D.tag===5&&(O=D.stateNode,O!==null&&kn(O)),D.stateNode=null,D.return=null,D.dependencies=null,D.memoizedProps=null,D.memoizedState=null,D.pendingProps=null,D.stateNode=null,D.updateQueue=null}function Nx(D){return D.tag===5||D.tag===3||D.tag===4}function zx(D){e:for(;;){for(;D.sibling===null;){if(D.return===null||Nx(D.return))return null;D=D.return}for(D.sibling.return=D.return,D=D.sibling;D.tag!==5&&D.tag!==6&&D.tag!==18;){if(D.flags&2||D.child===null||D.tag===4)continue e;D.child.return=D,D=D.child}if(!(D.flags&2))return D.stateNode}}function Cd(D){if(Le){e:{for(var O=D.return;O!==null;){if(Nx(O))break e;O=O.return}throw Error(o(160))}var Y=O;switch(Y.tag){case 5:O=Y.stateNode,Y.flags&32&&(xi(O),Y.flags&=-33),Y=zx(D),Id(D,Y,O);break;case 3:case 4:O=Y.stateNode.containerInfo,Y=zx(D),cf(D,Y,O);break;default:throw Error(o(161))}}}function cf(D,O,Y){var se=D.tag;if(se===5||se===6)D=D.stateNode,O?ar(Y,D,O):Sr(Y,D);else if(se!==4&&(D=D.child,D!==null))for(cf(D,O,Y),D=D.sibling;D!==null;)cf(D,O,Y),D=D.sibling}function Id(D,O,Y){var se=D.tag;if(se===5||se===6)D=D.stateNode,O?Fr(Y,D,O):tr(Y,D);else if(se!==4&&(D=D.child,D!==null))for(Id(D,O,Y),D=D.sibling;D!==null;)Id(D,O,Y),D=D.sibling}function uf(D,O,Y){for(var se=O,pe=!1,Te,dt;;){if(!pe){pe=se.return;e:for(;;){if(pe===null)throw Error(o(160));switch(Te=pe.stateNode,pe.tag){case 5:dt=!1;break e;case 3:Te=Te.containerInfo,dt=!0;break e;case 4:Te=Te.containerInfo,dt=!0;break e}pe=pe.return}pe=!0}if(se.tag===5||se.tag===6)Ed(D,se,Y),dt?Hr(Te,se.stateNode):Nr(Te,se.stateNode);else if(se.tag===18)dt?It(Te,se.stateNode):Et(Te,se.stateNode);else if(se.tag===4){if(se.child!==null){Te=se.stateNode.containerInfo,dt=!0,se.child.return=se,se=se.child;continue}}else if(em(D,se,Y),se.child!==null){se.child.return=se,se=se.child;continue}if(se===O)break;for(;se.sibling===null;){if(se.return===null||se.return===O)return;se=se.return,se.tag===4&&(pe=!1)}se.sibling.return=se.return,se=se.sibling}}function ca(D,O){if(Le){switch(O.tag){case 0:case 11:case 14:case 15:Hc(3,O,O.return),Qp(3,O),Hc(5,O,O.return);return;case 1:return;case 5:var Y=O.stateNode;if(Y!=null){var se=O.memoizedProps;D=D!==null?D.memoizedProps:se;var pe=O.type,Te=O.updateQueue;O.updateQueue=null,Te!==null&&ui(Y,Te,pe,D,se,O)}return;case 6:if(O.stateNode===null)throw Error(o(162));Y=O.memoizedProps,Ln(O.stateNode,D!==null?D.memoizedProps:Y,Y);return;case 3:mn&&D!==null&&D.memoizedState.isDehydrated&&yt(O.stateNode.containerInfo);return;case 12:return;case 13:lc(O);return;case 19:lc(O);return;case 17:return}throw Error(o(163))}switch(O.tag){case 0:case 11:case 14:case 15:Hc(3,O,O.return),Qp(3,O),Hc(5,O,O.return);return;case 12:return;case 13:lc(O);return;case 19:lc(O);return;case 3:mn&&D!==null&&D.memoizedState.isDehydrated&&yt(O.stateNode.containerInfo);break;case 22:case 23:return}e:if(qe){switch(O.tag){case 1:case 5:case 6:break e;case 3:case 4:O=O.stateNode,hi(O.containerInfo,O.pendingChildren);break e}throw Error(o(163))}}function lc(D){var O=D.updateQueue;if(O!==null){D.updateQueue=null;var Y=D.stateNode;Y===null&&(Y=D.stateNode=new Fn),O.forEach(function(se){var pe=$g.bind(null,D,se);Y.has(se)||(Y.add(se),se.then(pe,pe))})}}function Ux(D,O){for(sr=O;sr!==null;){O=sr;var Y=O.deletions;if(Y!==null)for(var se=0;se<Y.length;se++){var pe=Y[se];try{var Te=D;Le?uf(Te,pe,O):Ed(Te,pe,O);var dt=pe.alternate;dt!==null&&(dt.return=null),pe.return=null}catch(Rr){co(pe,O,Rr)}}if(Y=O.child,O.subtreeFlags&12854&&Y!==null)Y.return=O,sr=Y;else for(;sr!==null;){O=sr;try{var Ot=O.flags;if(Ot&32&&Le&&xi(O.stateNode),Ot&512){var vn=O.alternate;if(vn!==null){var Wn=vn.ref;Wn!==null&&(typeof Wn=="function"?Wn(null):Wn.current=null)}}if(Ot&8192)switch(O.tag){case 13:if(O.memoizedState!==null){var br=O.alternate;(br===null||br.memoizedState===null)&&(pf=bs())}break;case 22:var oi=O.memoizedState!==null,zr=O.alternate,ps=zr!==null&&zr.memoizedState!==null;if(Y=O,Le){e:if(se=Y,pe=oi,Te=null,Le)for(var Ir=se;;){if(Ir.tag===5){if(Te===null){Te=Ir;var ha=Ir.stateNode;pe?Fe(ha):Kt(Ir.stateNode,Ir.memoizedProps)}}else if(Ir.tag===6){if(Te===null){var fa=Ir.stateNode;pe?Lt(fa):un(fa,Ir.memoizedProps)}}else if((Ir.tag!==22&&Ir.tag!==23||Ir.memoizedState===null||Ir===se)&&Ir.child!==null){Ir.child.return=Ir,Ir=Ir.child;continue}if(Ir===se)break;for(;Ir.sibling===null;){if(Ir.return===null||Ir.return===se)break e;Te===Ir&&(Te=null),Ir=Ir.return}Te===Ir&&(Te=null),Ir.sibling.return=Ir.return,Ir=Ir.sibling}}if(oi&&!ps&&Y.mode&1){sr=Y;for(var $t=Y.child;$t!==null;){for(Y=sr=$t;sr!==null;){se=sr;var Nt=se.child;switch(se.tag){case 0:case 11:case 14:case 15:Hc(4,se,se.return);break;case 1:Jp(se,se.return);var an=se.stateNode;if(typeof an.componentWillUnmount=="function"){var rr=se.return;try{an.props=se.memoizedProps,an.state=se.memoizedState,an.componentWillUnmount()}catch(Rr){co(se,rr,Rr)}}break;case 5:Jp(se,se.return);break;case 22:if(se.memoizedState!==null){Ug(Y);continue}}Nt!==null?(Nt.return=se,sr=Nt):Ug(Y)}$t=$t.sibling}}}switch(Ot&4102){case 2:Cd(O),O.flags&=-3;break;case 6:Cd(O),O.flags&=-3,ca(O.alternate,O);break;case 4096:O.flags&=-4097;break;case 4100:O.flags&=-4097,ca(O.alternate,O);break;case 4:ca(O.alternate,O)}}catch(Rr){co(O,O.return,Rr)}if(Y=O.sibling,Y!==null){Y.return=O.return,sr=Y;break}sr=O.return}}}function s_(D,O,Y){sr=D,Ng(D)}function Ng(D,O,Y){for(var se=(D.mode&1)!==0;sr!==null;){var pe=sr,Te=pe.child;if(pe.tag===22&&se){var dt=pe.memoizedState!==null||Vc;if(!dt){var Ot=pe.alternate,vn=Ot!==null&&Ot.memoizedState!==null||Rl;Ot=Vc;var Wn=Rl;if(Vc=dt,(Rl=vn)&&!Wn)for(sr=pe;sr!==null;)dt=sr,vn=dt.child,dt.tag===22&&dt.memoizedState!==null?No(pe):vn!==null?(vn.return=dt,sr=vn):No(pe);for(;Te!==null;)sr=Te,Ng(Te),Te=Te.sibling;sr=pe,Vc=Ot,Rl=Wn}zg(D)}else pe.subtreeFlags&8772&&Te!==null?(Te.return=pe,sr=Te):zg(D)}}function zg(D){for(;sr!==null;){var O=sr;if(O.flags&8772){var Y=O.alternate;try{if(O.flags&8772)switch(O.tag){case 0:case 11:case 15:Rl||Qp(5,O);break;case 1:var se=O.stateNode;if(O.flags&4&&!Rl)if(Y===null)se.componentDidMount();else{var pe=O.elementType===O.type?Y.memoizedProps:Vs(O.type,Y.memoizedProps);se.componentDidUpdate(pe,Y.memoizedState,se.__reactInternalSnapshotBeforeUpdate)}var Te=O.updateQueue;Te!==null&&Dp(O,Te,se);break;case 3:var dt=O.updateQueue;if(dt!==null){if(Y=null,O.child!==null)switch(O.child.tag){case 5:Y=Re(O.child.stateNode);break;case 1:Y=O.child.stateNode}Dp(O,dt,Y)}break;case 5:var Ot=O.stateNode;Y===null&&O.flags&4&&ir(Ot,O.type,O.memoizedProps,O);break;case 6:break;case 4:break;case 12:break;case 13:if(mn&&O.memoizedState===null){var vn=O.alternate;if(vn!==null){var Wn=vn.memoizedState;if(Wn!==null){var br=Wn.dehydrated;br!==null&&Mt(br)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Rl||O.flags&512&&Md(O)}catch(oi){co(O,O.return,oi)}}if(O===D){sr=null;break}if(Y=O.sibling,Y!==null){Y.return=O.return,sr=Y;break}sr=O.return}}function Ug(D){for(;sr!==null;){var O=sr;if(O===D){sr=null;break}var Y=O.sibling;if(Y!==null){Y.return=O.return,sr=Y;break}sr=O.return}}function No(D){for(;sr!==null;){var O=sr;try{switch(O.tag){case 0:case 11:case 15:var Y=O.return;try{Qp(4,O)}catch(vn){co(O,Y,vn)}break;case 1:var se=O.stateNode;if(typeof se.componentDidMount=="function"){var pe=O.return;try{se.componentDidMount()}catch(vn){co(O,pe,vn)}}var Te=O.return;try{Md(O)}catch(vn){co(O,Te,vn)}break;case 5:var dt=O.return;try{Md(O)}catch(vn){co(O,dt,vn)}}}catch(vn){co(O,O.return,vn)}if(O===D){sr=null;break}var Ot=O.sibling;if(Ot!==null){Ot.return=O.return,sr=Ot;break}sr=O.return}}var ds=0,hf=1,Rd=2,tm=3,nm=4;if(typeof Symbol=="function"&&Symbol.for){var Pd=Symbol.for;ds=Pd("selector.component"),hf=Pd("selector.has_pseudo_class"),Rd=Pd("selector.role"),tm=Pd("selector.test_id"),nm=Pd("selector.text")}function a_(D){var O=cn(D);if(O!=null){if(typeof O.memoizedProps["data-testname"]!="string")throw Error(o(364));return O}if(D=Ge(D),D===null)throw Error(o(362));return D.stateNode.current}function eh(D,O){switch(O.$$typeof){case ds:if(D.type===O.value)return!0;break;case hf:e:{O=O.value,D=[D,0];for(var Y=0;Y<D.length;){var se=D[Y++],pe=D[Y++],Te=O[pe];if(se.tag!==5||!Sn(se)){for(;Te!=null&&eh(se,Te);)pe++,Te=O[pe];if(pe===O.length){O=!0;break e}else for(se=se.child;se!==null;)D.push(se,pe),se=se.sibling}}O=!1}return O;case Rd:if(D.tag===5&&jt(D.stateNode,O.value))return!0;break;case nm:if((D.tag===5||D.tag===6)&&(D=An(D),D!==null&&0<=D.indexOf(O.value)))return!0;break;case tm:if(D.tag===5&&(D=D.memoizedProps["data-testname"],typeof D=="string"&&D.toLowerCase()===O.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function th(D){switch(D.$$typeof){case ds:return"<"+(Q(D.value)||"Unknown")+">";case hf:return":has("+(th(D)||"")+")";case Rd:return'[role="'+D.value+'"]';case nm:return'"'+D.value+'"';case tm:return'[data-testname="'+D.value+'"]';default:throw Error(o(365))}}function gn(D,O){var Y=[];D=[D,0];for(var se=0;se<D.length;){var pe=D[se++],Te=D[se++],dt=O[Te];if(pe.tag!==5||!Sn(pe)){for(;dt!=null&&eh(pe,dt);)Te++,dt=O[Te];if(Te===O.length)Y.push(pe);else for(pe=pe.child;pe!==null;)D.push(pe,Te),pe=pe.sibling}}return Y}function Kn(D,O){if(!ot)throw Error(o(363));D=a_(D),D=gn(D,O),O=[],D=Array.from(D);for(var Y=0;Y<D.length;){var se=D[Y++];if(se.tag===5)Sn(se)||O.push(se.stateNode);else for(se=se.child;se!==null;)D.push(se),se=se.sibling}return O}var cc=Math.ceil,Wi=l.ReactCurrentDispatcher,At=l.ReactCurrentOwner,ks=l.ReactCurrentBatchConfig,di=0,Js=null,rs=null,Ba=0,ka=0,uc=As(0),Oa=0,rm=null,ff=0,df=0,Ld=0,nh=null,Ya=null,pf=0,rh=1/0;function mf(){rh=bs()+500}var Qo=!1,o_=null,js=null,Gg=!1,Pl=null,Fi=0,Qr=0,Vg=null,hc=-1,gf=0;function Qs(){return di&6?bs():hc!==-1?hc:hc=bs()}function fc(D){return D.mode&1?di&2&&Ba!==0?Ba&-Ba:md.transition!==null?(gf===0&&(D=Ep,Ep<<=1,!(Ep&4194240)&&(Ep=64),gf=D),gf):(D=vr,D!==0?D:Jt()):1}function el(D,O,Y){if(50<Qr)throw Qr=0,Vg=null,Error(o(185));var se=Ll(D,O);return se===null?null:(Hh(se,O,Y),(!(di&2)||se!==Js)&&(se===Js&&(!(di&2)&&(df|=O),Oa===4&&Wc(se,Ba)),ua(se,Y),O===1&&di===0&&!(D.mode&1)&&(mf(),gu&&Lo())),se)}function Ll(D,O){D.lanes|=O;var Y=D.alternate;for(Y!==null&&(Y.lanes|=O),Y=D,D=D.return;D!==null;)D.childLanes|=O,Y=D.alternate,Y!==null&&(Y.childLanes|=O),Y=D,D=D.return;return Y.tag===3?Y.stateNode:null}function ua(D,O){var Y=D.callbackNode;hd(D,O);var se=Ql(D,D===Js?Ba:0);if(se===0)Y!==null&&fd(Y),D.callbackNode=null,D.callbackPriority=0;else if(O=se&-se,D.callbackPriority!==O){if(Y!=null&&fd(Y),O===1)D.tag===0?Px(Hg.bind(null,D)):Ms(Hg.bind(null,D)),Gn?sn(function(){di===0&&Lo()}):cr(pd,Lo),Y=null;else{switch(Rx(se)){case 1:Y=pd;break;case 4:Y=ec;break;case 16:Y=On;break;case 536870912:Y=ei;break;default:Y=On}Y=Xg(Y,jc.bind(null,D))}D.callbackPriority=O,D.callbackNode=Y}}function jc(D,O){if(hc=-1,gf=0,di&6)throw Error(o(327));var Y=D.callbackNode;if(pc()&&D.callbackNode!==Y)return null;var se=Ql(D,D===Js?Ba:0);if(se===0)return null;if(se&30||se&D.expiredLanes||O)O=Bd(D,se);else{O=se;var pe=di;di|=2;var Te=vf();(Js!==D||Ba!==O)&&(mf(),pl(D,O));do try{kd();break}catch(Ot){bo(D,Ot)}while(!0);Bs(),Wi.current=Te,di=pe,rs!==null?O=0:(Js=null,Ba=0,O=Oa)}if(O!==0){if(O===2&&(pe=Ip(D),pe!==0&&(se=pe,O=Au(D,pe))),O===1)throw Y=rm,pl(D,0),Wc(D,se),ua(D,bs()),Y;if(O===6)Wc(D,se);else{if(pe=D.current.alternate,!(se&30)&&!l_(pe)&&(O=Bd(D,se),O===2&&(Te=Ip(D),Te!==0&&(se=Te,O=Au(D,Te))),O===1))throw Y=rm,pl(D,0),Wc(D,se),ua(D,bs()),Y;switch(D.finishedWork=pe,D.finishedLanes=se,O){case 0:case 1:throw Error(o(345));case 2:dc(D,Ya);break;case 3:if(Wc(D,se),(se&130023424)===se&&(O=pf+500-bs(),10<O)){if(Ql(D,0)!==0)break;if(pe=D.suspendedLanes,(pe&se)!==se){Qs(),D.pingedLanes|=D.suspendedLanes&pe;break}D.timeoutHandle=rn(dc.bind(null,D,Ya),O);break}dc(D,Ya);break;case 4:if(Wc(D,se),(se&4194240)===se)break;for(O=D.eventTimes,pe=-1;0<se;){var dt=31-Po(se);Te=1<<dt,dt=O[dt],dt>pe&&(pe=dt),se&=~Te}if(se=pe,se=bs()-se,se=(120>se?120:480>se?480:1080>se?1080:1920>se?1920:3e3>se?3e3:4320>se?4320:1960*cc(se/1960))-se,10<se){D.timeoutHandle=rn(dc.bind(null,D,Ya),se);break}dc(D,Ya);break;case 5:dc(D,Ya);break;default:throw Error(o(329))}}}return ua(D,bs()),D.callbackNode===Y?jc.bind(null,D):null}function Au(D,O){var Y=nh;return D.current.memoizedState.isDehydrated&&(pl(D,O).flags|=256),D=Bd(D,O),D!==2&&(O=Ya,Ya=Y,O!==null&&Dd(O)),D}function Dd(D){Ya===null?Ya=D:Ya.push.apply(Ya,D)}function l_(D){for(var O=D;;){if(O.flags&16384){var Y=O.updateQueue;if(Y!==null&&(Y=Y.stores,Y!==null))for(var se=0;se<Y.length;se++){var pe=Y[se],Te=pe.getSnapshot;pe=pe.value;try{if(!ll(Te(),pe))return!1}catch{return!1}}}if(Y=O.child,O.subtreeFlags&16384&&Y!==null)Y.return=O,O=Y;else{if(O===D)break;for(;O.sibling===null;){if(O.return===null||O.return===D)return!0;O=O.return}O.sibling.return=O.return,O=O.sibling}}return!0}function Wc(D,O){for(O&=~Ld,O&=~df,D.suspendedLanes|=O,D.pingedLanes&=~O,D=D.expirationTimes;0<O;){var Y=31-Po(O),se=1<<Y;D[Y]=-1,O&=~se}}function Hg(D){if(di&6)throw Error(o(327));pc();var O=Ql(D,0);if(!(O&1))return ua(D,bs()),null;var Y=Bd(D,O);if(D.tag!==0&&Y===2){var se=Ip(D);se!==0&&(O=se,Y=Au(D,se))}if(Y===1)throw Y=rm,pl(D,0),Wc(D,O),ua(D,bs()),Y;if(Y===6)throw Error(o(345));return D.finishedWork=D.current.alternate,D.finishedLanes=O,dc(D,Ya),ua(D,bs()),null}function Tu(D){Pl!==null&&Pl.tag===0&&!(di&6)&&pc();var O=di;di|=1;var Y=ks.transition,se=vr;try{if(ks.transition=null,vr=1,D)return D()}finally{vr=se,ks.transition=Y,di=O,!(di&6)&&Lo()}}function ih(){ka=uc.current,Cr(uc)}function pl(D,O){D.finishedWork=null,D.finishedLanes=0;var Y=D.timeoutHandle;if(Y!==Bn&&(D.timeoutHandle=Bn,jn(Y)),rs!==null)for(Y=rs.return;Y!==null;){var se=Y;switch(vd(se),se.tag){case 1:se=se.type.childContextTypes,se!=null&&Li();break;case 3:Qh(),Cr(ys),Cr(qr),vg();break;case 5:Fp(se);break;case 4:Qh();break;case 13:Cr(Es);break;case 19:Cr(Es);break;case 10:ul(se.type._context);break;case 22:case 23:ih()}Y=Y.return}if(Js=D,rs=D=Mu(D.current,null),Ba=ka=O,Oa=0,rm=null,Ld=df=ff=0,Ya=nh=null,Do!==null){for(O=0;O<Do.length;O++)if(Y=Do[O],se=Y.interleaved,se!==null){Y.interleaved=null;var pe=se.next,Te=Y.pending;if(Te!==null){var dt=Te.next;Te.next=pe,se.next=dt}Y.pending=se}Do=null}return D}function bo(D,O){do{var Y=rs;try{if(Bs(),zp.current=rf,xu){for(var se=Cs.memoizedState;se!==null;){var pe=se.queue;pe!==null&&(pe.pending=null),se=se.next}xu=!1}if(ef=0,Ks=Da=Cs=null,bu=!1,Zu=0,At.current=null,Y===null||Y.return===null){Oa=1,rm=O,rs=null;break}e:{var Te=D,dt=Y.return,Ot=Y,vn=O;if(O=Ba,Ot.flags|=32768,vn!==null&&typeof vn=="object"&&typeof vn.then=="function"){var Wn=vn,br=Ot,oi=br.tag;if(!(br.mode&1)&&(oi===0||oi===11||oi===15)){var zr=br.alternate;zr?(br.updateQueue=zr.updateQueue,br.memoizedState=zr.memoizedState,br.lanes=zr.lanes):(br.updateQueue=null,br.memoizedState=null)}var ps=sf(dt);if(ps!==null){ps.flags&=-257,Q0(ps,dt,Ot,Te,O),ps.mode&1&&J0(Te,Wn,O),O=ps,vn=Wn;var Ir=O.updateQueue;if(Ir===null){var ha=new Set;ha.add(vn),O.updateQueue=ha}else Ir.add(vn);break e}else{if(!(O&1)){J0(Te,Wn,O),wa();break e}vn=Error(o(426))}}else if(ns&&Ot.mode&1){var fa=sf(dt);if(fa!==null){!(fa.flags&65536)&&(fa.flags|=256),Q0(fa,dt,Ot,Te,O),dg(vn);break e}}Te=vn,Oa!==4&&(Oa=2),nh===null?nh=[Te]:nh.push(Te),vn=Wp(vn,Ot),Ot=dt;do{switch(Ot.tag){case 3:Ot.flags|=65536,O&=-O,Ot.lanes|=O;var $t=Bx(Ot,vn,O);Bo(Ot,$t);break e;case 1:Te=vn;var Nt=Ot.type,an=Ot.stateNode;if(!(Ot.flags&128)&&(typeof Nt.getDerivedStateFromError=="function"||an!==null&&typeof an.componentDidCatch=="function"&&(js===null||!js.has(an)))){Ot.flags|=65536,O&=-O,Ot.lanes|=O;var rr=K0(Ot,Te,O);Bo(Ot,rr);break e}}Ot=Ot.return}while(Ot!==null)}jg(Y)}catch(Rr){O=Rr,rs===Y&&Y!==null&&(rs=Y=Y.return);continue}break}while(!0)}function vf(){var D=Wi.current;return Wi.current=rf,D===null?rf:D}function wa(){(Oa===0||Oa===3||Oa===2)&&(Oa=4),Js===null||!(ff&268435455)&&!(df&268435455)||Wc(Js,Ba)}function Bd(D,O){var Y=di;di|=2;var se=vf();Js===D&&Ba===O||pl(D,O);do try{c_();break}catch(pe){bo(D,pe)}while(!0);if(Bs(),di=Y,Wi.current=se,rs!==null)throw Error(o(261));return Js=null,Ba=0,Oa}function c_(){for(;rs!==null;)$c(rs)}function kd(){for(;rs!==null&&!jh();)$c(rs)}function $c(D){var O=Fd(D.alternate,D,ka);D.memoizedProps=D.pendingProps,O===null?jg(D):rs=O,At.current=null}function jg(D){var O=D;do{var Y=O.alternate;if(D=O.return,O.flags&32768){if(Y=Fx(Y,O),Y!==null){Y.flags&=32767,rs=Y;return}if(D!==null)D.flags|=32768,D.subtreeFlags=0,D.deletions=null;else{Oa=6,rs=null;return}}else if(Y=of(Y,O,ka),Y!==null){rs=Y;return}if(O=O.sibling,O!==null){rs=O;return}rs=O=D}while(O!==null);Oa===0&&(Oa=5)}function dc(D,O){var Y=vr,se=ks.transition;try{ks.transition=null,vr=1,u_(D,O,Y)}finally{ks.transition=se,vr=Y}return null}function u_(D,O,Y){do pc();while(Pl!==null);if(di&6)throw Error(o(327));var se=D.finishedWork,pe=D.finishedLanes;if(se===null)return null;if(D.finishedWork=null,D.finishedLanes=0,se===D.current)throw Error(o(177));D.callbackNode=null,D.callbackPriority=0;var Te=se.lanes|se.childLanes;if(si(D,Te),D===Js&&(rs=Js=null,Ba=0),!(se.subtreeFlags&2064)&&!(se.flags&2064)||Gg||(Gg=!0,Xg(On,function(){return pc(),null})),Te=(se.flags&15990)!==0,se.subtreeFlags&15990||Te){Te=ks.transition,ks.transition=null;var dt=vr;vr=1;var Ot=di;di|=4,At.current=null,Yn(D,se),Ux(D,se),Ue(D.containerInfo),D.current=se,s_(se),dd(),di=Ot,vr=dt,ks.transition=Te}else D.current=se;if(Gg&&(Gg=!1,Pl=D,Fi=pe),Te=D.pendingLanes,Te===0&&(js=null),vo(se.stateNode),ua(D,bs()),O!==null)for(Y=D.onRecoverableError,se=0;se<O.length;se++)Y(O[se]);if(Qo)throw Qo=!1,D=o_,o_=null,D;return Fi&1&&D.tag!==0&&pc(),Te=D.pendingLanes,Te&1?D===Vg?Qr++:(Qr=0,Vg=D):Qr=0,Lo(),null}function pc(){if(Pl!==null){var D=Rx(Fi),O=ks.transition,Y=vr;try{if(ks.transition=null,vr=16>D?16:D,Pl===null)var se=!1;else{if(D=Pl,Pl=null,Fi=0,di&6)throw Error(o(331));var pe=di;for(di|=4,sr=D.current;sr!==null;){var Te=sr,dt=Te.child;if(sr.flags&16){var Ot=Te.deletions;if(Ot!==null){for(var vn=0;vn<Ot.length;vn++){var Wn=Ot[vn];for(sr=Wn;sr!==null;){var br=sr;switch(br.tag){case 0:case 11:case 15:Hc(8,br,Te)}var oi=br.child;if(oi!==null)oi.return=br,sr=oi;else for(;sr!==null;){br=sr;var zr=br.sibling,ps=br.return;if(Fg(br),br===Wn){sr=null;break}if(zr!==null){zr.return=ps,sr=zr;break}sr=ps}}}var Ir=Te.alternate;if(Ir!==null){var ha=Ir.child;if(ha!==null){Ir.child=null;do{var fa=ha.sibling;ha.sibling=null,ha=fa}while(ha!==null)}}sr=Te}}if(Te.subtreeFlags&2064&&dt!==null)dt.return=Te,sr=dt;else e:for(;sr!==null;){if(Te=sr,Te.flags&2048)switch(Te.tag){case 0:case 11:case 15:Hc(9,Te,Te.return)}var $t=Te.sibling;if($t!==null){$t.return=Te.return,sr=$t;break e}sr=Te.return}}var Nt=D.current;for(sr=Nt;sr!==null;){dt=sr;var an=dt.child;if(dt.subtreeFlags&2064&&an!==null)an.return=dt,sr=an;else e:for(dt=Nt;sr!==null;){if(Ot=sr,Ot.flags&2048)try{switch(Ot.tag){case 0:case 11:case 15:Qp(9,Ot)}}catch(Rr){co(Ot,Ot.return,Rr)}if(Ot===dt){sr=null;break e}var rr=Ot.sibling;if(rr!==null){rr.return=Ot.return,sr=rr;break e}sr=Ot.return}}if(di=pe,Lo(),Gs&&typeof Gs.onPostCommitFiberRoot=="function")try{Gs.onPostCommitFiberRoot(Zr,D)}catch{}se=!0}return se}finally{vr=Y,ks.transition=O}}return!1}function Od(D,O,Y){O=Wp(Y,O),O=Bx(D,O,1),$u(D,O),O=Qs(),D=Ll(D,1),D!==null&&(Hh(D,1,O),ua(D,O))}function co(D,O,Y){if(D.tag===3)Od(D,D,Y);else for(;O!==null;){if(O.tag===3){Od(O,D,Y);break}else if(O.tag===1){var se=O.stateNode;if(typeof O.type.getDerivedStateFromError=="function"||typeof se.componentDidCatch=="function"&&(js===null||!js.has(se))){D=Wp(Y,D),D=K0(O,D,1),$u(O,D),D=Qs(),O=Ll(O,1),O!==null&&(Hh(O,1,D),ua(O,D));break}}O=O.return}}function Wg(D,O,Y){var se=D.pingCache;se!==null&&se.delete(O),O=Qs(),D.pingedLanes|=D.suspendedLanes&Y,Js===D&&(Ba&Y)===Y&&(Oa===4||Oa===3&&(Ba&130023424)===Ba&&500>bs()-pf?pl(D,0):Ld|=Y),ua(D,O)}function im(D,O){O===0&&(D.mode&1?(O=ug,ug<<=1,!(ug&130023424)&&(ug=4194304)):O=1);var Y=Qs();D=Ll(D,O),D!==null&&(Hh(D,O,Y),ua(D,Y))}function Gx(D){var O=D.memoizedState,Y=0;O!==null&&(Y=O.retryLane),im(D,Y)}function $g(D,O){var Y=0;switch(D.tag){case 13:var se=D.stateNode,pe=D.memoizedState;pe!==null&&(Y=pe.retryLane);break;case 19:se=D.stateNode;break;default:throw Error(o(314))}se!==null&&se.delete(O),im(D,Y)}var Fd;Fd=function(D,O,Y){if(D!==null)if(D.memoizedProps!==O.pendingProps||ys.current)ba=!0;else{if(!(D.lanes&Y)&&!(O.flags&128))return ba=!1,i_(D,O,Y);ba=!!(D.flags&131072)}else ba=!1,ns&&O.flags&1048576&&_r(O,yo,O.index);switch(O.lanes=0,O.tag){case 2:var se=O.type;D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),D=O.pendingProps;var pe=Ds(O,qr.current);Wu(O,Y),pe=Ku(null,O,se,D,pe,Y);var Te=tf();return O.flags|=1,typeof pe=="object"&&pe!==null&&typeof pe.render=="function"&&pe.$$typeof===void 0?(O.tag=1,O.memoizedState=null,O.updateQueue=null,fs(se)?(Te=!0,Ts(O)):Te=!1,O.memoizedState=pe.state!==null&&pe.state!==void 0?pe.state:null,vu(O),pe.updater=_u,O.stateNode=pe,pe._reactInternals=O,G0(O,se,D,Y),O=lf(null,O,se,!0,Te,Y)):(O.tag=0,ns&&Te&&Bp(O),lo(null,O,pe,Y),O=O.child),O;case 16:se=O.elementType;e:{switch(D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),D=O.pendingProps,pe=se._init,se=pe(se._payload),O.type=se,pe=O.tag=Zg(se),D=Vs(se,D),pe){case 0:O=Bg(null,O,se,D,Y);break e;case 1:O=t_(null,O,se,D,Y);break e;case 11:O=Xp(null,O,se,D,Y);break e;case 14:O=Lg(null,O,se,Vs(se.type,D),Y);break e}throw Error(o(306,se,""))}return O;case 0:return se=O.type,pe=O.pendingProps,pe=O.elementType===se?pe:Vs(se,pe),Bg(D,O,se,pe,Y);case 1:return se=O.type,pe=O.pendingProps,pe=O.elementType===se?pe:Vs(se,pe),t_(D,O,se,pe,Y);case 3:e:{if(Ox(O),D===null)throw Error(o(387));se=O.pendingProps,Te=O.memoizedState,pe=Te.element,Pp(D,O),fg(O,se,null,Y);var dt=O.memoizedState;if(se=dt.element,mn&&Te.isDehydrated)if(Te={element:se,isDehydrated:!1,cache:dt.cache,transitions:dt.transitions},O.updateQueue.baseState=Te,O.memoizedState=Te,O.flags&256){pe=Error(o(423)),O=n_(D,O,se,Y,pe);break e}else if(se!==pe){pe=Error(o(424)),O=n_(D,O,se,Y,pe);break e}else for(mn&&(xa=zt(O.stateNode.containerInfo),ko=O,ns=!0,Yo=null,la=!1),Y=pg(O,null,se,Y),O.child=Y;Y;)Y.flags=Y.flags&-3|4096,Y=Y.sibling;else{if(yn(),se===pe){O=Il(D,O,Y);break e}lo(D,O,se,Y)}O=O.child}return O;case 5:return mg(O),D===null&&ic(O),se=O.type,pe=O.pendingProps,Te=D!==null?D.memoizedProps:null,dt=pe.children,Ht(se,pe)?dt=null:Te!==null&&Ht(se,Te)&&(O.flags|=32),qp(D,O),lo(D,O,dt,Y),O.child;case 6:return D===null&&ic(O),null;case 13:return Yp(D,O,Y);case 4:return Fo(O,O.stateNode.containerInfo),se=O.pendingProps,D===null?O.child=Ko(O,null,se,Y):lo(D,O,se,Y),O.child;case 11:return se=O.type,pe=O.pendingProps,pe=O.elementType===se?pe:Vs(se,pe),Xp(D,O,se,pe,Y);case 7:return lo(D,O,O.pendingProps,Y),O.child;case 8:return lo(D,O,O.pendingProps.children,Y),O.child;case 12:return lo(D,O,O.pendingProps.children,Y),O.child;case 10:e:{if(se=O.type._context,pe=O.pendingProps,Te=O.memoizedProps,dt=pe.value,_o(O,se,dt),Te!==null)if(ll(Te.value,dt)){if(Te.children===pe.children&&!ys.current){O=Il(D,O,Y);break e}}else for(Te=O.child,Te!==null&&(Te.return=O);Te!==null;){var Ot=Te.dependencies;if(Ot!==null){dt=Te.child;for(var vn=Ot.firstContext;vn!==null;){if(vn.context===se){if(Te.tag===1){vn=ao(-1,Y&-Y),vn.tag=2;var Wn=Te.updateQueue;if(Wn!==null){Wn=Wn.shared;var br=Wn.pending;br===null?vn.next=vn:(vn.next=br.next,br.next=vn),Wn.pending=vn}}Te.lanes|=Y,vn=Te.alternate,vn!==null&&(vn.lanes|=Y),Zs(Te.return,Y,O),Ot.lanes|=Y;break}vn=vn.next}}else if(Te.tag===10)dt=Te.type===O.type?null:Te.child;else if(Te.tag===18){if(dt=Te.return,dt===null)throw Error(o(341));dt.lanes|=Y,Ot=dt.alternate,Ot!==null&&(Ot.lanes|=Y),Zs(dt,Y,O),dt=Te.sibling}else dt=Te.child;if(dt!==null)dt.return=Te;else for(dt=Te;dt!==null;){if(dt===O){dt=null;break}if(Te=dt.sibling,Te!==null){Te.return=dt.return,dt=Te;break}dt=dt.return}Te=dt}lo(D,O,pe.children,Y),O=O.child}return O;case 9:return pe=O.type,se=O.pendingProps.children,Wu(O,Y),pe=Ys(pe),se=se(pe),O.flags|=1,lo(D,O,se,Y),O.child;case 14:return se=O.type,pe=Vs(se,O.pendingProps),pe=Vs(se.type,pe),Lg(D,O,se,pe,Y);case 15:return e_(D,O,O.type,O.pendingProps,Y);case 17:return se=O.type,pe=O.pendingProps,pe=O.elementType===se?pe:Vs(se,pe),D!==null&&(D.alternate=null,O.alternate=null,O.flags|=2),O.tag=1,fs(se)?(D=!0,Ts(O)):D=!1,Wu(O,Y),gd(O,se,pe),G0(O,se,pe,Y),lf(null,O,se,!0,D,Y);case 19:return Kp(D,O,Y);case 22:return Dg(D,O,Y)}throw Error(o(156,O.tag))};function Xg(D,O){return cr(D,O)}function Vx(D,O,Y,se){this.tag=D,this.key=Y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=O,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=se,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tl(D,O,Y,se){return new Vx(D,O,Y,se)}function qg(D){return D=D.prototype,!(!D||!D.isReactComponent)}function Zg(D){if(typeof D=="function")return qg(D)?1:0;if(D!=null){if(D=D.$$typeof,D===C)return 11;if(D===L)return 14}return 2}function Mu(D,O){var Y=D.alternate;return Y===null?(Y=tl(D.tag,O,D.key,D.mode),Y.elementType=D.elementType,Y.type=D.type,Y.stateNode=D.stateNode,Y.alternate=D,D.alternate=Y):(Y.pendingProps=O,Y.type=D.type,Y.flags=0,Y.subtreeFlags=0,Y.deletions=null),Y.flags=D.flags&14680064,Y.childLanes=D.childLanes,Y.lanes=D.lanes,Y.child=D.child,Y.memoizedProps=D.memoizedProps,Y.memoizedState=D.memoizedState,Y.updateQueue=D.updateQueue,O=D.dependencies,Y.dependencies=O===null?null:{lanes:O.lanes,firstContext:O.firstContext},Y.sibling=D.sibling,Y.index=D.index,Y.ref=D.ref,Y}function sm(D,O,Y,se,pe,Te){var dt=2;if(se=D,typeof D=="function")qg(D)&&(dt=1);else if(typeof D=="string")dt=5;else e:switch(D){case f:return sh(Y.children,pe,Te,O);case p:dt=8,pe|=8;break;case v:return D=tl(12,Y,O,pe|2),D.elementType=v,D.lanes=Te,D;case M:return D=tl(13,Y,O,pe),D.elementType=M,D.lanes=Te,D;case E:return D=tl(19,Y,O,pe),D.elementType=E,D.lanes=Te,D;case H:return am(Y,pe,Te,O);default:if(typeof D=="object"&&D!==null)switch(D.$$typeof){case y:dt=10;break e;case S:dt=9;break e;case C:dt=11;break e;case L:dt=14;break e;case k:dt=16,se=null;break e}throw Error(o(130,D==null?D:typeof D,""))}return O=tl(dt,Y,O,pe),O.elementType=D,O.type=se,O.lanes=Te,O}function sh(D,O,Y,se){return D=tl(7,D,se,O),D.lanes=Y,D}function am(D,O,Y,se){return D=tl(22,D,se,O),D.elementType=H,D.lanes=Y,D.stateNode={},D}function om(D,O,Y){return D=tl(6,D,null,O),D.lanes=Y,D}function h_(D,O,Y){return O=tl(4,D.children!==null?D.children:[],D.key,O),O.lanes=Y,O.stateNode={containerInfo:D.containerInfo,pendingChildren:null,implementation:D.implementation},O}function Hw(D,O,Y,se,pe){this.tag=O,this.containerInfo=D,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Bn,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ju(0),this.expirationTimes=ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ju(0),this.identifierPrefix=se,this.onRecoverableError=pe,mn&&(this.mutableSourceEagerHydrationData=null)}function ws(D,O,Y,se,pe,Te,dt,Ot,vn){return D=new Hw(D,O,Y,Ot,vn),O===1?(O=1,Te===!0&&(O|=8)):O=0,Te=tl(3,null,null,O),D.current=Te,Te.stateNode=D,Te.memoizedState={element:se,isDehydrated:Y,cache:null,transitions:null},vu(Te),D}function f_(D){if(!D)return Yi;D=D._reactInternals;e:{if(ie(D)!==D||D.tag!==1)throw Error(o(170));var O=D;do{switch(O.tag){case 3:O=O.stateNode.context;break e;case 1:if(fs(O.type)){O=O.stateNode.__reactInternalMemoizedMergedChildContext;break e}}O=O.return}while(O!==null);throw Error(o(171))}if(D.tag===1){var Y=D.type;if(fs(Y))return Pa(D,Y,O)}return O}function Hx(D){var O=D._reactInternals;if(O===void 0)throw typeof D.render=="function"?Error(o(188)):(D=Object.keys(D).join(","),Error(o(268,D)));return D=Se(O),D===null?null:D.stateNode}function jx(D,O){if(D=D.memoizedState,D!==null&&D.dehydrated!==null){var Y=D.retryLane;D.retryLane=Y!==0&&Y<O?Y:O}}function _f(D,O){jx(D,O),(D=D.alternate)&&jx(D,O)}function Wx(D){return D=Se(D),D===null?null:D.stateNode}function Nd(){return null}return t.attemptContinuousHydration=function(D){if(D.tag===13){var O=Qs();el(D,134217728,O),_f(D,134217728)}},t.attemptHydrationAtCurrentPriority=function(D){if(D.tag===13){var O=Qs(),Y=fc(D);el(D,Y,O),_f(D,Y)}},t.attemptSynchronousHydration=function(D){switch(D.tag){case 3:var O=D.stateNode;if(O.current.memoizedState.isDehydrated){var Y=Xa(O.pendingLanes);Y!==0&&(Rp(O,Y|1),ua(O,bs()),!(di&6)&&(mf(),Lo()))}break;case 13:var se=Qs();Tu(function(){return el(D,1,se)}),_f(D,1)}},t.batchedUpdates=function(D,O){var Y=di;di|=1;try{return D(O)}finally{di=Y,di===0&&(mf(),gu&&Lo())}},t.createComponentSelector=function(D){return{$$typeof:ds,value:D}},t.createContainer=function(D,O,Y,se,pe,Te,dt){return ws(D,O,!1,null,Y,se,pe,Te,dt)},t.createHasPseudoClassSelector=function(D){return{$$typeof:hf,value:D}},t.createHydrationContainer=function(D,O,Y,se,pe,Te,dt,Ot,vn){return D=ws(Y,se,!0,D,pe,Te,dt,Ot,vn),D.context=f_(null),Y=D.current,se=Qs(),pe=fc(Y),Te=ao(se,pe),Te.callback=O??null,$u(Y,Te),D.current.lanes=pe,Hh(D,pe,se),ua(D,se),D},t.createPortal=function(D,O,Y){var se=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:se==null?null:""+se,children:D,containerInfo:O,implementation:Y}},t.createRoleSelector=function(D){return{$$typeof:Rd,value:D}},t.createTestNameSelector=function(D){return{$$typeof:tm,value:D}},t.createTextSelector=function(D){return{$$typeof:nm,value:D}},t.deferredUpdates=function(D){var O=vr,Y=ks.transition;try{return ks.transition=null,vr=16,D()}finally{vr=O,ks.transition=Y}},t.discreteUpdates=function(D,O,Y,se,pe){var Te=vr,dt=ks.transition;try{return ks.transition=null,vr=1,D(O,Y,se,pe)}finally{vr=Te,ks.transition=dt,di===0&&mf()}},t.findAllNodes=Kn,t.findBoundingRects=function(D,O){if(!ot)throw Error(o(363));O=Kn(D,O),D=[];for(var Y=0;Y<O.length;Y++)D.push(Xt(O[Y]));for(O=D.length-1;0<O;O--){Y=D[O];for(var se=Y.x,pe=se+Y.width,Te=Y.y,dt=Te+Y.height,Ot=O-1;0<=Ot;Ot--)if(O!==Ot){var vn=D[Ot],Wn=vn.x,br=Wn+vn.width,oi=vn.y,zr=oi+vn.height;if(se>=Wn&&Te>=oi&&pe<=br&&dt<=zr){D.splice(O,1);break}else if(se!==Wn||Y.width!==vn.width||zr<Te||oi>dt){if(!(Te!==oi||Y.height!==vn.height||br<se||Wn>pe)){Wn>se&&(vn.width+=Wn-se,vn.x=se),br<pe&&(vn.width=pe-Wn),D.splice(O,1);break}}else{oi>Te&&(vn.height+=oi-Te,vn.y=Te),zr<dt&&(vn.height=dt-oi),D.splice(O,1);break}}}return D},t.findHostInstance=Hx,t.findHostInstanceWithNoPortals=function(D){return D=fe(D),D=D!==null?Ie(D):null,D===null?null:D.stateNode},t.findHostInstanceWithWarning=function(D){return Hx(D)},t.flushControlled=function(D){var O=di;di|=1;var Y=ks.transition,se=vr;try{ks.transition=null,vr=1,D()}finally{vr=se,ks.transition=Y,di=O,di===0&&(mf(),Lo())}},t.flushPassiveEffects=pc,t.flushSync=Tu,t.focusWithin=function(D,O){if(!ot)throw Error(o(363));for(D=a_(D),O=gn(D,O),O=Array.from(O),D=0;D<O.length;){var Y=O[D++];if(!Sn(Y)){if(Y.tag===5&&mr(Y.stateNode))return!0;for(Y=Y.child;Y!==null;)O.push(Y),Y=Y.sibling}}return!1},t.getCurrentUpdatePriority=function(){return vr},t.getFindAllNodesFailureDescription=function(D,O){if(!ot)throw Error(o(363));var Y=0,se=[];D=[a_(D),0];for(var pe=0;pe<D.length;){var Te=D[pe++],dt=D[pe++],Ot=O[dt];if((Te.tag!==5||!Sn(Te))&&(eh(Te,Ot)&&(se.push(th(Ot)),dt++,dt>Y&&(Y=dt)),dt<O.length))for(Te=Te.child;Te!==null;)D.push(Te,dt),Te=Te.sibling}if(Y<O.length){for(D=[];Y<O.length;Y++)D.push(th(O[Y]));return`findAllNodes was able to match part of the selector:
  `+(se.join(" > ")+`

No matching component was found for:
  `)+D.join(" > ")}return null},t.getPublicRootInstance=function(D){if(D=D.current,!D.child)return null;switch(D.child.tag){case 5:return Re(D.child.stateNode);default:return D.child.stateNode}},t.injectIntoDevTools=function(D){if(D={bundleType:D.bundleType,version:D.version,rendererPackageName:D.rendererPackageName,rendererConfig:D.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:l.ReactCurrentDispatcher,findHostInstanceByFiber:Wx,findFiberByHostInstance:D.findFiberByHostInstance||Nd,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")D=!1;else{var O=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(O.isDisabled||!O.supportsFiber)D=!0;else{try{Zr=O.inject(D),Gs=O}catch{}D=!!O.checkDCE}}return D},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(D,O,Y,se){if(!ot)throw Error(o(363));D=Kn(D,O);var pe=Un(D,Y,se).disconnect;return{disconnect:function(){pe()}}},t.registerMutableSourceForHydration=function(D,O){var Y=O._getVersion;Y=Y(O._source),D.mutableSourceEagerHydrationData==null?D.mutableSourceEagerHydrationData=[O,Y]:D.mutableSourceEagerHydrationData.push(O,Y)},t.runWithPriority=function(D,O){var Y=vr;try{return vr=D,O()}finally{vr=Y}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(D,O,Y,se){var pe=O.current,Te=Qs(),dt=fc(pe);return Y=f_(Y),O.context===null?O.context=Y:O.pendingContext=Y,O=ao(Te,dt),O.payload={element:D},se=se===void 0?null:se,se!==null&&(O.callback=se),$u(pe,O),D=el(pe,dt,Te),D!==null&&Lp(D,pe,dt),dt},t};_re.exports=cSe;var uSe=_re.exports;const hSe=zL(uSe);var yre={exports:{}},xre={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(_e,We){var Ue=_e.length;_e.push(We);e:for(;0<Ue;){var vt=Ue-1>>>1,xt=_e[vt];if(0<i(xt,We))_e[vt]=We,_e[Ue]=xt,Ue=vt;else break e}}function t(_e){return _e.length===0?null:_e[0]}function r(_e){if(_e.length===0)return null;var We=_e[0],Ue=_e.pop();if(Ue!==We){_e[0]=Ue;e:for(var vt=0,xt=_e.length,Vt=xt>>>1;vt<Vt;){var lt=2*(vt+1)-1,Ht=_e[lt],Qt=lt+1,rn=_e[Qt];if(0>i(Ht,Ue))Qt<xt&&0>i(rn,Ht)?(_e[vt]=rn,_e[Qt]=Ue,vt=Qt):(_e[vt]=Ht,_e[lt]=Ue,vt=lt);else if(Qt<xt&&0>i(rn,Ue))_e[vt]=rn,_e[Qt]=Ue,vt=Qt;else break e}}return We}function i(_e,We){var Ue=_e.sortIndex-We.sortIndex;return Ue!==0?Ue:_e.id-We.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var a=[],h=[],f=1,p=null,v=3,y=!1,S=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(_e){for(var We=t(h);We!==null;){if(We.callback===null)r(h);else if(We.startTime<=_e)r(h),We.sortIndex=We.expirationTime,e(a,We);else break;We=t(h)}}function H(_e){if(C=!1,k(_e),!S)if(t(a)!==null)S=!0,Re(X);else{var We=t(h);We!==null&&st(H,We.startTime-_e)}}function X(_e,We){S=!1,C&&(C=!1,E(re),re=-1),y=!0;var Ue=v;try{for(k(We),p=t(a);p!==null&&(!(p.expirationTime>We)||_e&&!fe());){var vt=p.callback;if(typeof vt=="function"){p.callback=null,v=p.priorityLevel;var xt=vt(p.expirationTime<=We);We=n.unstable_now(),typeof xt=="function"?p.callback=xt:p===t(a)&&r(a),k(We)}else r(a);p=t(a)}if(p!==null)var Vt=!0;else{var lt=t(h);lt!==null&&st(H,lt.startTime-We),Vt=!1}return Vt}finally{p=null,v=Ue,y=!1}}var Z=!1,Q=null,re=-1,ie=5,oe=-1;function fe(){return!(n.unstable_now()-oe<ie)}function Se(){if(Q!==null){var _e=n.unstable_now();oe=_e;var We=!0;try{We=Q(!0,_e)}finally{We?Ee():(Z=!1,Q=null)}}else Z=!1}var Ee;if(typeof L=="function")Ee=function(){L(Se)};else if(typeof MessageChannel<"u"){var Ie=new MessageChannel,He=Ie.port2;Ie.port1.onmessage=Se,Ee=function(){He.postMessage(null)}}else Ee=function(){M(Se,0)};function Re(_e){Q=_e,Z||(Z=!0,Ee())}function st(_e,We){re=M(function(){_e(n.unstable_now())},We)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(_e){_e.callback=null},n.unstable_continueExecution=function(){S||y||(S=!0,Re(X))},n.unstable_forceFrameRate=function(_e){0>_e||125<_e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<_e?Math.floor(1e3/_e):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_getFirstCallbackNode=function(){return t(a)},n.unstable_next=function(_e){switch(v){case 1:case 2:case 3:var We=3;break;default:We=v}var Ue=v;v=We;try{return _e()}finally{v=Ue}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(_e,We){switch(_e){case 1:case 2:case 3:case 4:case 5:break;default:_e=3}var Ue=v;v=_e;try{return We()}finally{v=Ue}},n.unstable_scheduleCallback=function(_e,We,Ue){var vt=n.unstable_now();switch(typeof Ue=="object"&&Ue!==null?(Ue=Ue.delay,Ue=typeof Ue=="number"&&0<Ue?vt+Ue:vt):Ue=vt,_e){case 1:var xt=-1;break;case 2:xt=250;break;case 5:xt=1073741823;break;case 4:xt=1e4;break;default:xt=5e3}return xt=Ue+xt,_e={id:f++,callback:We,priorityLevel:_e,startTime:Ue,expirationTime:xt,sortIndex:-1},Ue>vt?(_e.sortIndex=Ue,e(h,_e),t(a)===null&&_e===t(h)&&(C?(E(re),re=-1):C=!0,st(H,Ue-vt))):(_e.sortIndex=xt,e(a,_e),S||y||(S=!0,Re(X))),_e},n.unstable_shouldYield=fe,n.unstable_wrapCallback=function(_e){var We=v;return function(){var Ue=v;v=We;try{return _e.apply(this,arguments)}finally{v=Ue}}}})(xre);yre.exports=xre;var d$=yre.exports;const fSe=n=>typeof n=="object"&&typeof n.then=="function",Ty=[];function bre(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function wre(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of Ty)if(bre(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=Ty.indexOf(i);s!==-1&&Ty.splice(s,1)},promise:(fSe(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(Ty.push(i),!t)throw i.promise}const dSe=(n,e,t)=>wre(n,e,!1,t),pSe=(n,e,t)=>void wre(n,e,!0,t),mSe=n=>{if(n===void 0||n.length===0)Ty.splice(0,Ty.length);else{const e=Ty.find(t=>bre(n,t.keys,t.equal));e&&e.remove()}},L6={},gSe=n=>void Object.assign(L6,n);function vSe(n,e){function t(f,{args:p=[],attach:v,...y},S){let C=`${f[0].toUpperCase()}${f.slice(1)}`,M;if(f==="primitive"){if(y.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const E=y.object;M=Q1(E,{type:f,root:S,attach:v,primitive:!0})}else{const E=L6[C];if(!E)throw new Error(`R3F: ${C} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(p))throw new Error("R3F: The args prop must be an array!");M=Q1(new E(...p),{type:f,root:S,attach:v,memoizedProps:{args:p}})}return M.__r3f.attach===void 0&&(M instanceof Xr?M.__r3f.attach="geometry":M instanceof ya&&(M.__r3f.attach="material")),C!=="inject"&&mF(M,y),M}function r(f,p){let v=!1;if(p){var y,S;(y=p.__r3f)!=null&&y.attach?pF(f,p,p.__r3f.attach):p.isObject3D&&f.isObject3D&&(f.add(p),v=!0),v||(S=f.__r3f)==null||S.objects.push(p),p.__r3f||Q1(p,{}),p.__r3f.parent=f,X4(p),eb(p)}}function i(f,p,v){let y=!1;if(p){var S,C;if((S=p.__r3f)!=null&&S.attach)pF(f,p,p.__r3f.attach);else if(p.isObject3D&&f.isObject3D){p.parent=f,p.dispatchEvent({type:"added"});const M=f.children.filter(L=>L!==p),E=M.indexOf(v);f.children=[...M.slice(0,E),p,...M.slice(E)],y=!0}y||(C=f.__r3f)==null||C.objects.push(p),p.__r3f||Q1(p,{}),p.__r3f.parent=f,X4(p),eb(p)}}function s(f,p,v=!1){f&&[...f].forEach(y=>o(p,y,v))}function o(f,p,v){if(p){var y,S,C;if(p.__r3f&&(p.__r3f.parent=null),(y=f.__r3f)!=null&&y.objects&&(f.__r3f.objects=f.__r3f.objects.filter(H=>H!==p)),(S=p.__r3f)!=null&&S.attach)_$(f,p,p.__r3f.attach);else if(p.isObject3D&&f.isObject3D){var M;f.remove(p),(M=p.__r3f)!=null&&M.root&&MSe(p.__r3f.root,p)}const L=(C=p.__r3f)==null?void 0:C.primitive,k=!L&&(v===void 0?p.dispose!==null:v);if(!L){var E;s((E=p.__r3f)==null?void 0:E.objects,p,k),s(p.children,p,k)}if(delete p.__r3f,k&&p.dispose&&p.type!=="Scene"){const H=()=>{try{p.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?d$.unstable_scheduleCallback(d$.unstable_IdlePriority,H):H()}eb(f)}}function l(f,p,v,y){var S;const C=(S=f.__r3f)==null?void 0:S.parent;if(!C)return;const M=t(p,v,f.__r3f.root);if(f.children){for(const E of f.children)E.__r3f&&r(M,E);f.children=f.children.filter(E=>!E.__r3f)}f.__r3f.objects.forEach(E=>r(M,E)),f.__r3f.objects=[],f.__r3f.autoRemovedBeforeAppend||o(C,f),M.parent&&(M.__r3f.autoRemovedBeforeAppend=!0),r(C,M),M.raycast&&M.__r3f.eventCount&&M.__r3f.root.getState().internal.interaction.push(M),[y,y.alternate].forEach(E=>{E!==null&&(E.stateNode=M,E.ref&&(typeof E.ref=="function"?E.ref(M):E.ref.current=M))})}const a=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:hSe({createInstance:t,removeChild:o,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(f,p)=>{if(!p)return;const v=f.getState().scene;v.__r3f&&(v.__r3f.root=f,r(v,p))},removeChildFromContainer:(f,p)=>{p&&o(f.getState().scene,p)},insertInContainerBefore:(f,p,v)=>{if(!p||!v)return;const y=f.getState().scene;y.__r3f&&i(y,p,v)},getRootHostContext:()=>null,getChildHostContext:f=>f,finalizeInitialChildren(f){var p;return!!((p=f==null?void 0:f.__r3f)!=null?p:{}).handlers},prepareUpdate(f,p,v,y){var S;if(((S=f==null?void 0:f.__r3f)!=null?S:{}).primitive&&y.object&&y.object!==f)return[!0];{const{args:M=[],children:E,...L}=y,{args:k=[],children:H,...X}=v;if(!Array.isArray(M))throw new Error("R3F: the args prop must be an array!");if(M.some((Q,re)=>Q!==k[re]))return[!0];const Z=Ire(f,L,X,!0);return Z.changes.length?[!1,Z]:null}},commitUpdate(f,[p,v],y,S,C,M){p?l(f,y,C,M):mF(f,v)},commitMount(f,p,v,y){var S;const C=(S=f.__r3f)!=null?S:{};f.raycast&&C.handlers&&C.eventCount&&f.__r3f.root.getState().internal.interaction.push(f)},getPublicInstance:f=>f,prepareForCommit:()=>null,preparePortalMount:f=>Q1(f.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(f){var p;const{attach:v,parent:y}=(p=f.__r3f)!=null?p:{};v&&y&&_$(y,f,v),f.isObject3D&&(f.visible=!1),eb(f)},unhideInstance(f,p){var v;const{attach:y,parent:S}=(v=f.__r3f)!=null?v:{};y&&S&&pF(S,f,y),(f.isObject3D&&p.visible==null||p.visible)&&(f.visible=!0),eb(f)},createTextInstance:a,hideTextInstance:a,unhideTextInstance:a,getCurrentEventPriority:()=>e?e():wb.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&ga.fun(performance.now)?performance.now:ga.fun(Date.now)?Date.now:()=>0,scheduleTimeout:ga.fun(setTimeout)?setTimeout:void 0,cancelTimeout:ga.fun(clearTimeout)?clearTimeout:void 0}),applyProps:mF}}var p$,m$;const dF=n=>"colorSpace"in n||"outputColorSpace"in n,Sre=()=>{var n;return(n=L6.ColorManagement)!=null?n:null},Are=n=>n&&n.isOrthographicCamera,_Se=n=>n&&n.hasOwnProperty("current"),cE=typeof window<"u"&&((p$=window.document)!=null&&p$.createElement||((m$=window.navigator)==null?void 0:m$.product)==="ReactNative")?Ae.useLayoutEffect:Ae.useEffect;function Tre(n){const e=Ae.useRef(n);return cE(()=>void(e.current=n),[n]),e}function ySe({set:n}){return cE(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class Mre extends Ae.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}Mre.getDerivedStateFromError=()=>({error:!0});const Ere="__default",g$=new Map,xSe=n=>n&&!!n.memoized&&!!n.changes;function Cre(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const HS=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()},ga={obj:n=>n===Object(n)&&!ga.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(ga.str(n)||ga.num(n))return n===e;const s=ga.obj(n);if(s&&r==="reference")return n===e;const o=ga.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let l;for(l in n)if(!(l in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(l in i?e:n)if(!ga.equ(n[l],e[l],{strict:i,objects:"reference"}))return!1}else for(l in i?e:n)if(n[l]!==e[l])return!1;if(ga.und(l)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function bSe(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function wSe(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Q1(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function $4(n,e){let t=n;if(e.includes("-")){const r=e.split("-"),i=r.pop();return t=r.reduce((s,o)=>s[o],n),{target:t,key:i}}else return{target:t,key:e}}const v$=/-\d+$/;function pF(n,e,t){if(ga.str(t)){if(v$.test(t)){const s=t.replace(v$,""),{target:o,key:l}=$4(n,s);Array.isArray(o[l])||(o[l]=[])}const{target:r,key:i}=$4(n,t);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=t(n,e)}function _$(n,e,t){var r,i;if(ga.str(t)){const{target:s,key:o}=$4(n,t),l=e.__r3f.previousAttach;l===void 0?delete s[o]:s[o]=l}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(n,e);(i=e.__r3f)==null||delete i.previousAttach}function Ire(n,{children:e,key:t,ref:r,...i},{children:s,key:o,ref:l,...a}={},h=!1){var f;const p=(f=n==null?void 0:n.__r3f)!=null?f:{},v=Object.entries(i),y=[];if(h){const C=Object.keys(a);for(let M=0;M<C.length;M++)i.hasOwnProperty(C[M])||v.unshift([C[M],Ere+"remove"])}v.forEach(([C,M])=>{var E;if((E=n.__r3f)!=null&&E.primitive&&C==="object"||ga.equ(M,a[C]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(C))return y.push([C,M,!0,[]]);let L=[];C.includes("-")&&(L=C.split("-")),y.push([C,M,!1,L]);for(const k in i){const H=i[k];k.startsWith(`${C}-`)&&y.push([k,H,!1,k.split("-")])}});const S={...i};return p.memoizedProps&&p.memoizedProps.args&&(S.args=p.memoizedProps.args),p.memoizedProps&&p.memoizedProps.attach&&(S.attach=p.memoizedProps.attach),{memoized:S,changes:y}}const SSe=typeof process<"u"&&!1;function mF(n,e){var t,r,i;const s=(t=n.__r3f)!=null?t:{},o=s.root,l=(r=o==null||o.getState==null?void 0:o.getState())!=null?r:{},{memoized:a,changes:h}=xSe(e)?e:Ire(n,e),f=s.eventCount;n.__r3f&&(n.__r3f.memoizedProps=a);for(let v=0;v<h.length;v++){let[y,S,C,M]=h[v];if(dF(n)){const H="srgb",X="srgb-linear";y==="encoding"?(y="colorSpace",S=S===3001?H:X):y==="outputEncoding"&&(y="outputColorSpace",S=S===3001?H:X)}let E=n,L=E[y];if(M.length&&(L=M.reduce((k,H)=>k[H],n),!(L&&L.set))){const[k,...H]=M.reverse();E=H.reverse().reduce((X,Z)=>X[Z],n),y=k}if(S===Ere+"remove")if(E.constructor){let k=g$.get(E.constructor);k||(k=new E.constructor,g$.set(E.constructor,k)),S=k[y]}else S=0;if(C)S?s.handlers[y]=S:delete s.handlers[y],s.eventCount=Object.keys(s.handlers).length;else if(L&&L.set&&(L.copy||L instanceof zy)){if(Array.isArray(S))L.fromArray?L.fromArray(S):L.set(...S);else if(L.copy&&S&&S.constructor&&(SSe?L.constructor.name===S.constructor.name:L.constructor===S.constructor))L.copy(S);else if(S!==void 0){const k=L instanceof Vn;!k&&L.setScalar?L.setScalar(S):L instanceof zy&&S instanceof zy?L.mask=S.mask:L.set(S),!Sre()&&!l.linear&&k&&L.convertSRGBToLinear()}}else if(E[y]=S,E[y]instanceof Xs&&E[y].format===Xl&&E[y].type===Kf){const k=E[y];dF(k)&&dF(l.gl)?k.colorSpace=l.gl.outputColorSpace:k.encoding=l.gl.outputEncoding}eb(n)}if(s.parent&&l.internal&&n.raycast&&f!==s.eventCount){const v=l.internal.interaction.indexOf(n);v>-1&&l.internal.interaction.splice(v,1),s.eventCount&&l.internal.interaction.push(n)}return!(h.length===1&&h[0][0]==="onUpdate")&&h.length&&(i=n.__r3f)!=null&&i.parent&&X4(n),n}function eb(n){var e,t;const r=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();r&&r.internal.frames===0&&r.invalidate()}function X4(n){n.onUpdate==null||n.onUpdate(n)}function ASe(n,e){n.manual||(Are(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function I2(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function TSe(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return wb.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return wb.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return wb.ContinuousEventPriority;default:return wb.DefaultEventPriority}}function Rre(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function MSe(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{Rre(t.capturedMap,e,r,i)})}function ESe(n){function e(a){const{internal:h}=n.getState(),f=a.offsetX-h.initialClick[0],p=a.offsetY-h.initialClick[1];return Math.round(Math.sqrt(f*f+p*p))}function t(a){return a.filter(h=>["Move","Over","Enter","Out","Leave"].some(f=>{var p;return(p=h.__r3f)==null?void 0:p.handlers["onPointer"+f]}))}function r(a,h){const f=n.getState(),p=new Set,v=[],y=h?h(f.internal.interaction):f.internal.interaction;for(let E=0;E<y.length;E++){const L=HS(y[E]);L&&(L.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(a,f);function S(E){const L=HS(E);if(!L||!L.events.enabled||L.raycaster.camera===null)return[];if(L.raycaster.camera===void 0){var k;L.events.compute==null||L.events.compute(a,L,(k=L.previousRoot)==null?void 0:k.getState()),L.raycaster.camera===void 0&&(L.raycaster.camera=null)}return L.raycaster.camera?L.raycaster.intersectObject(E,!0):[]}let C=y.flatMap(S).sort((E,L)=>{const k=HS(E.object),H=HS(L.object);return!k||!H?E.distance-L.distance:H.events.priority-k.events.priority||E.distance-L.distance}).filter(E=>{const L=I2(E);return p.has(L)?!1:(p.add(L),!0)});f.events.filter&&(C=f.events.filter(C,f));for(const E of C){let L=E.object;for(;L;){var M;(M=L.__r3f)!=null&&M.eventCount&&v.push({...E,eventObject:L}),L=L.parent}}if("pointerId"in a&&f.internal.capturedMap.has(a.pointerId))for(let E of f.internal.capturedMap.get(a.pointerId).values())p.has(I2(E.intersection))||v.push(E.intersection);return v}function i(a,h,f,p){const v=n.getState();if(a.length){const y={stopped:!1};for(const S of a){const C=HS(S.object)||v,{raycaster:M,pointer:E,camera:L,internal:k}=C,H=new Ze(E.x,E.y,0).unproject(L),X=oe=>{var fe,Se;return(fe=(Se=k.capturedMap.get(oe))==null?void 0:Se.has(S.eventObject))!=null?fe:!1},Z=oe=>{const fe={intersection:S,target:h.target};k.capturedMap.has(oe)?k.capturedMap.get(oe).set(S.eventObject,fe):k.capturedMap.set(oe,new Map([[S.eventObject,fe]])),h.target.setPointerCapture(oe)},Q=oe=>{const fe=k.capturedMap.get(oe);fe&&Rre(k.capturedMap,S.eventObject,fe,oe)};let re={};for(let oe in h){let fe=h[oe];typeof fe!="function"&&(re[oe]=fe)}let ie={...S,...re,pointer:E,intersections:a,stopped:y.stopped,delta:f,unprojectedPoint:H,ray:M.ray,camera:L,stopPropagation(){const oe="pointerId"in h&&k.capturedMap.get(h.pointerId);if((!oe||oe.has(S.eventObject))&&(ie.stopped=y.stopped=!0,k.hovered.size&&Array.from(k.hovered.values()).find(fe=>fe.eventObject===S.eventObject))){const fe=a.slice(0,a.indexOf(S));s([...fe,S])}},target:{hasPointerCapture:X,setPointerCapture:Z,releasePointerCapture:Q},currentTarget:{hasPointerCapture:X,setPointerCapture:Z,releasePointerCapture:Q},nativeEvent:h};if(p(ie),y.stopped===!0)break}}return a}function s(a){const{internal:h}=n.getState();for(const f of h.hovered.values())if(!a.length||!a.find(p=>p.object===f.object&&p.index===f.index&&p.instanceId===f.instanceId)){const v=f.eventObject.__r3f,y=v==null?void 0:v.handlers;if(h.hovered.delete(I2(f)),v!=null&&v.eventCount){const S={...f,intersections:a};y.onPointerOut==null||y.onPointerOut(S),y.onPointerLeave==null||y.onPointerLeave(S)}}}function o(a,h){for(let f=0;f<h.length;f++){const p=h[f].__r3f;p==null||p.handlers.onPointerMissed==null||p.handlers.onPointerMissed(a)}}function l(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return h=>{const{internal:f}=n.getState();"pointerId"in h&&f.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(h.pointerId)&&(f.capturedMap.delete(h.pointerId),s([]))})}}return function(f){const{onPointerMissed:p,internal:v}=n.getState();v.lastEvent.current=f;const y=a==="onPointerMove",S=a==="onClick"||a==="onContextMenu"||a==="onDoubleClick",M=r(f,y?t:void 0),E=S?e(f):0;a==="onPointerDown"&&(v.initialClick=[f.offsetX,f.offsetY],v.initialHits=M.map(k=>k.eventObject)),S&&!M.length&&E<=2&&(o(f,v.interaction),p&&p(f)),y&&s(M);function L(k){const H=k.eventObject,X=H.__r3f,Z=X==null?void 0:X.handlers;if(X!=null&&X.eventCount)if(y){if(Z.onPointerOver||Z.onPointerEnter||Z.onPointerOut||Z.onPointerLeave){const Q=I2(k),re=v.hovered.get(Q);re?re.stopped&&k.stopPropagation():(v.hovered.set(Q,k),Z.onPointerOver==null||Z.onPointerOver(k),Z.onPointerEnter==null||Z.onPointerEnter(k))}Z.onPointerMove==null||Z.onPointerMove(k)}else{const Q=Z[a];Q?(!S||v.initialHits.includes(H))&&(o(f,v.interaction.filter(re=>!v.initialHits.includes(re))),Q(k)):S&&v.initialHits.includes(H)&&o(f,v.interaction.filter(re=>!v.initialHits.includes(re)))}}i(M,f,E,L)}}return{handlePointer:l}}const Pre=n=>!!(n!=null&&n.render),Lre=Ae.createContext(null),CSe=(n,e)=>{const t=aSe((l,a)=>{const h=new Ze,f=new Ze,p=new Ze;function v(E=a().camera,L=f,k=a().size){const{width:H,height:X,top:Z,left:Q}=k,re=H/X;L instanceof Ze?p.copy(L):p.set(...L);const ie=E.getWorldPosition(h).distanceTo(p);if(Are(E))return{width:H/E.zoom,height:X/E.zoom,top:Z,left:Q,factor:1,distance:ie,aspect:re};{const oe=E.fov*Math.PI/180,fe=2*Math.tan(oe/2)*ie,Se=fe*(H/X);return{width:Se,height:fe,top:Z,left:Q,factor:H/Se,distance:ie,aspect:re}}}let y;const S=E=>l(L=>({performance:{...L.performance,current:E}})),C=new nn;return{set:l,get:a,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(E=1)=>n(a(),E),advance:(E,L)=>e(E,L,a()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new sg,pointer:C,mouse:C,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const E=a();y&&clearTimeout(y),E.performance.current!==E.performance.min&&S(E.performance.min),y=setTimeout(()=>S(a().performance.max),E.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:E=>l(L=>({...L,events:{...L.events,...E}})),setSize:(E,L,k,H,X)=>{const Z=a().camera,Q={width:E,height:L,top:H||0,left:X||0,updateStyle:k};l(re=>({size:Q,viewport:{...re.viewport,...v(Z,f,Q)}}))},setDpr:E=>l(L=>{const k=Cre(E);return{viewport:{...L.viewport,dpr:k,initialDpr:L.viewport.initialDpr||k}}}),setFrameloop:(E="always")=>{const L=a().clock;L.stop(),L.elapsedTime=0,E!=="never"&&(L.start(),L.elapsedTime=0),l(()=>({frameloop:E}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:Ae.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(E,L,k)=>{const H=a().internal;return H.priority=H.priority+(L>0?1:0),H.subscribers.push({ref:E,priority:L,store:k}),H.subscribers=H.subscribers.sort((X,Z)=>X.priority-Z.priority),()=>{const X=a().internal;X!=null&&X.subscribers&&(X.priority=X.priority-(L>0?1:0),X.subscribers=X.subscribers.filter(Z=>Z.ref!==E))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,o=r.camera;return t.subscribe(()=>{const{camera:l,size:a,viewport:h,gl:f,set:p}=t.getState();if(a.width!==i.width||a.height!==i.height||h.dpr!==s){var v;i=a,s=h.dpr,ASe(l,a),f.setPixelRatio(h.dpr);const y=(v=a.updateStyle)!=null?v:typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(a.width,a.height,y)}l!==o&&(o=l,p(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(l)}})))}),t.subscribe(l=>n(l)),t};function ISe(n,e){const t={callback:n};return e.add(t),()=>void e.delete(t)}let R2,Dre=new Set,RSe=new Set,PSe=new Set;const LSe=n=>ISe(n,Dre);function gF(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function jS(n,e){switch(n){case"before":return gF(Dre,e);case"after":return gF(RSe,e);case"tail":return gF(PSe,e)}}let vF,_F;function yF(n,e,t){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),vF=e.internal.subscribers,R2=0;R2<vF.length;R2++)_F=vF[R2],_F.ref.current(_F.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function DSe(n){let e=!1,t,r,i;function s(a){r=requestAnimationFrame(s),e=!0,t=0,jS("before",a);for(const f of n.values()){var h;i=f.store.getState(),i.internal.active&&(i.frameloop==="always"||i.internal.frames>0)&&!((h=i.gl.xr)!=null&&h.isPresenting)&&(t+=yF(a,i))}if(jS("after",a),t===0)return jS("tail",a),e=!1,cancelAnimationFrame(r)}function o(a,h=1){var f;if(!a)return n.forEach(p=>o(p.store.getState()),h);(f=a.gl.xr)!=null&&f.isPresenting||!a.internal.active||a.frameloop==="never"||(a.internal.frames=Math.min(60,a.internal.frames+h),e||(e=!0,requestAnimationFrame(s)))}function l(a,h=!0,f,p){if(h&&jS("before",a),f)yF(a,f,p);else for(const v of n.values())yF(a,v.store.getState());h&&jS("after",a)}return{loop:s,invalidate:o,advance:l}}function Bre(){const n=Ae.useContext(Lre);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function kre(n=t=>t,e){return Bre()(n,e)}function uE(n,e=0){const t=Bre(),r=t.getState().internal.subscribe,i=Tre(n);return cE(()=>r(i,e,t),[e,r,t]),null}const y$=new WeakMap;function Ore(n,e){return function(t,...r){let i=y$.get(t);return i||(i=new t,y$.set(t,i)),n&&n(i),Promise.all(r.map(s=>new Promise((o,l)=>i.load(s,a=>{a.scene&&Object.assign(a,bSe(a.scene)),o(a)},e,a=>l(new Error(`Could not load ${s}: ${a==null?void 0:a.message}`)))))).finally(()=>i.dispose==null?void 0:i.dispose())}}function hE(n,e,t,r){const i=Array.isArray(e)?e:[e],s=dSe(Ore(t,r),[n,...i],{equal:ga.equ});return Array.isArray(e)?s:s[0]}hE.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return pSe(Ore(t),[n,...r])};hE.clear=function(n,e){const t=Array.isArray(e)?e:[e];return mSe([n,...t])};const ow=new Map,{invalidate:x$,advance:b$}=DSe(ow),{reconciler:IP,applyProps:dy}=vSe(ow,TSe),I1={objects:"shallow",strict:!1},BSe=(n,e)=>{const t=typeof n=="function"?n(e):n;return Pre(t)?t:new Jl({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function kSe(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:o,updateStyle:l=t}=e;return{width:r,height:i,top:s,left:o,updateStyle:l}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:r,height:i,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function OSe(n){const e=ow.get(n),t=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||CSe(x$,b$),o=t||IP.createContainer(s,wb.ConcurrentRoot,null,!1,null,"",i,null);e||ow.set(n,{fiber:o,store:s});let l,a=!1,h;return{configure(f={}){let{gl:p,size:v,scene:y,events:S,onCreated:C,shadows:M=!1,linear:E=!1,flat:L=!1,legacy:k=!1,orthographic:H=!1,frameloop:X="always",dpr:Z=[1,2],performance:Q,raycaster:re,camera:ie,onPointerMissed:oe}=f,fe=s.getState(),Se=fe.gl;fe.gl||fe.set({gl:Se=BSe(p,n)});let Ee=fe.raycaster;Ee||fe.set({raycaster:Ee=new FD});const{params:Ie,...He}=re||{};if(ga.equ(He,Ee,I1)||dy(Ee,{...He}),ga.equ(Ie,Ee.params,I1)||dy(Ee,{params:{...Ee.params,...Ie}}),!fe.camera||fe.camera===h&&!ga.equ(h,ie,I1)){h=ie;const xt=ie instanceof JM,Vt=xt?ie:H?new nd(0,0,0,0,.1,1e3):new ts(75,0,.1,1e3);xt||(Vt.position.z=5,ie&&dy(Vt,ie),!fe.camera&&!(ie!=null&&ie.rotation)&&Vt.lookAt(0,0,0)),fe.set({camera:Vt}),Ee.camera=Vt}if(!fe.scene){let xt;y instanceof Ml?xt=y:(xt=new Ml,y&&dy(xt,y)),fe.set({scene:Q1(xt)})}if(!fe.xr){var Re;const xt=(Ht,Qt)=>{const rn=s.getState();rn.frameloop!=="never"&&b$(Ht,!0,rn,Qt)},Vt=()=>{const Ht=s.getState();Ht.gl.xr.enabled=Ht.gl.xr.isPresenting,Ht.gl.xr.setAnimationLoop(Ht.gl.xr.isPresenting?xt:null),Ht.gl.xr.isPresenting||x$(Ht)},lt={connect(){const Ht=s.getState().gl;Ht.xr.addEventListener("sessionstart",Vt),Ht.xr.addEventListener("sessionend",Vt)},disconnect(){const Ht=s.getState().gl;Ht.xr.removeEventListener("sessionstart",Vt),Ht.xr.removeEventListener("sessionend",Vt)}};typeof((Re=Se.xr)==null?void 0:Re.addEventListener)=="function"&&lt.connect(),fe.set({xr:lt})}if(Se.shadowMap){const xt=Se.shadowMap.enabled,Vt=Se.shadowMap.type;if(Se.shadowMap.enabled=!!M,ga.boo(M))Se.shadowMap.type=KA;else if(ga.str(M)){var st;const lt={basic:Ste,percentage:sD,soft:KA,variance:Of};Se.shadowMap.type=(st=lt[M])!=null?st:KA}else ga.obj(M)&&Object.assign(Se.shadowMap,M);(xt!==Se.shadowMap.enabled||Vt!==Se.shadowMap.type)&&(Se.shadowMap.needsUpdate=!0)}const _e=Sre();_e&&("enabled"in _e?_e.enabled=!k:"legacyMode"in _e&&(_e.legacyMode=k)),dy(Se,{outputEncoding:E?3e3:3001,toneMapping:L?up:oD}),fe.legacy!==k&&fe.set(()=>({legacy:k})),fe.linear!==E&&fe.set(()=>({linear:E})),fe.flat!==L&&fe.set(()=>({flat:L})),p&&!ga.fun(p)&&!Pre(p)&&!ga.equ(p,Se,I1)&&dy(Se,p),S&&!fe.events.handlers&&fe.set({events:S(s)});const vt=kSe(n,v);return ga.equ(vt,fe.size,I1)||fe.setSize(vt.width,vt.height,vt.updateStyle,vt.top,vt.left),Z&&fe.viewport.dpr!==Cre(Z)&&fe.setDpr(Z),fe.frameloop!==X&&fe.setFrameloop(X),fe.onPointerMissed||fe.set({onPointerMissed:oe}),Q&&!ga.equ(Q,fe.performance,I1)&&fe.set(xt=>({performance:{...xt.performance,...Q}})),l=C,a=!0,this},render(f){return a||this.configure(),IP.updateContainer(Ae.createElement(FSe,{store:s,children:f,onCreated:l,rootElement:n}),o,null,()=>{}),s},unmount(){Fre(n)}}}function FSe({store:n,children:e,onCreated:t,rootElement:r}){return cE(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),Ae.createElement(Lre.Provider,{value:n},e)}function Fre(n,e){const t=ow.get(n),r=t==null?void 0:t.fiber;if(r){const i=t==null?void 0:t.store.getState();i&&(i.internal.active=!1),IP.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,o,l,a;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(l=i.gl)==null||l.forceContextLoss==null||l.forceContextLoss(),(a=i.gl)!=null&&a.xr&&i.xr.disconnect(),wSe(i),ow.delete(n)}catch{}},500)})}}IP.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:Ae.version});function q4(n,e,t){var r,i,s,o,l;e==null&&(e=100);function a(){var f=Date.now()-o;f<e&&f>=0?r=setTimeout(a,e-f):(r=null,t||(l=n.apply(s,i),s=i=null))}var h=function(){s=this,i=arguments,o=Date.now();var f=t&&!r;return r||(r=setTimeout(a,e)),f&&(l=n.apply(s,i),s=i=null),l};return h.clear=function(){r&&(clearTimeout(r),r=null)},h.flush=function(){r&&(l=n.apply(s,i),s=i=null,clearTimeout(r),r=null)},h}q4.debounce=q4;var NSe=q4;const w$=zL(NSe);function zSe(n){let{debounce:e,scroll:t,polyfill:r,offsetSize:i}=n===void 0?{debounce:0,scroll:!1,offsetSize:!1}:n;const s=r||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,l]=Ae.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=Ae.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),h=e?typeof e=="number"?e:e.scroll:null,f=e?typeof e=="number"?e:e.resize:null,p=Ae.useRef(!1);Ae.useEffect(()=>(p.current=!0,()=>void(p.current=!1)));const[v,y,S]=Ae.useMemo(()=>{const L=()=>{if(!a.current.element)return;const{left:k,top:H,width:X,height:Z,bottom:Q,right:re,x:ie,y:oe}=a.current.element.getBoundingClientRect(),fe={left:k,top:H,width:X,height:Z,bottom:Q,right:re,x:ie,y:oe};a.current.element instanceof HTMLElement&&i&&(fe.height=a.current.element.offsetHeight,fe.width=a.current.element.offsetWidth),Object.freeze(fe),p.current&&!HSe(a.current.lastBounds,fe)&&l(a.current.lastBounds=fe)};return[L,f?w$(L,f):L,h?w$(L,h):L]},[l,i,h,f]);function C(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(L=>L.removeEventListener("scroll",S,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null)}function M(){a.current.element&&(a.current.resizeObserver=new s(S),a.current.resizeObserver.observe(a.current.element),t&&a.current.scrollContainers&&a.current.scrollContainers.forEach(L=>L.addEventListener("scroll",S,{capture:!0,passive:!0})))}const E=L=>{!L||L===a.current.element||(C(),a.current.element=L,a.current.scrollContainers=Nre(L),M())};return GSe(S,!!t),USe(y),Ae.useEffect(()=>{C(),M()},[t,S,y]),Ae.useEffect(()=>C,[]),[E,o,v]}function USe(n){Ae.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function GSe(n,e){Ae.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function Nre(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...Nre(n.parentElement)]}const VSe=["x","y","top","bottom","left","right","width","height"],HSe=(n,e)=>VSe.every(t=>n[t]===e[t]);var jSe=Object.defineProperty,WSe=Object.defineProperties,$Se=Object.getOwnPropertyDescriptors,S$=Object.getOwnPropertySymbols,XSe=Object.prototype.hasOwnProperty,qSe=Object.prototype.propertyIsEnumerable,A$=(n,e,t)=>e in n?jSe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,T$=(n,e)=>{for(var t in e||(e={}))XSe.call(e,t)&&A$(n,t,e[t]);if(S$)for(var t of S$(e))qSe.call(e,t)&&A$(n,t,e[t]);return n},ZSe=(n,e)=>WSe(n,$Se(e));function zre(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=n.child;for(;r;){const i=zre(r,e,t);if(i)return i;r=r.sibling}}function Ure(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const D6=Ure(Ae.createContext(null));class Gre extends Ae.Component{render(){return Ae.createElement(D6.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:M$,ReactCurrentDispatcher:E$}=Ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function YSe(){const n=Ae.useContext(D6);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Ae.useId();return Ae.useMemo(()=>{for(const r of[M$==null?void 0:M$.current,n,n==null?void 0:n.alternate]){if(!r)continue;const i=zre(r,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(i)return i}},[n,e])}function KSe(){var n,e;const t=YSe(),[r]=Ae.useState(()=>new Map);r.clear();let i=t;for(;i;){const s=(n=i.type)==null?void 0:n._context;s&&s!==D6&&!r.has(s)&&r.set(s,(e=E$==null?void 0:E$.current)==null?void 0:e.readContext(Ure(s))),i=i.return}return r}function JSe(){const n=KSe();return Ae.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>Ae.createElement(e,null,Ae.createElement(t.Provider,ZSe(T$({},r),{value:n.get(t)}))),e=>Ae.createElement(Gre,T$({},e))),[n])}const xF={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function QSe(n){const{handlePointer:e}=ESe(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(xF).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{var r;const{set:i,events:s}=n.getState();s.disconnect==null||s.disconnect(),i(o=>({events:{...o.events,connected:t}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([o,l])=>{const[a,h]=xF[o];t.addEventListener(a,l,{passive:h})})},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,o])=>{if(r&&r.connected instanceof HTMLElement){const[l]=xF[s];r.connected.removeEventListener(l,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}const eAe=Ae.forwardRef(function({children:e,fallback:t,resize:r,style:i,gl:s,events:o=QSe,eventSource:l,eventPrefix:a,shadows:h,linear:f,flat:p,legacy:v,orthographic:y,frameloop:S,dpr:C,performance:M,raycaster:E,camera:L,scene:k,onPointerMissed:H,onCreated:X,...Z},Q){Ae.useMemo(()=>gSe(gre),[]);const re=JSe(),[ie,oe]=zSe({scroll:!0,debounce:{scroll:50,resize:0},...r}),fe=Ae.useRef(null),Se=Ae.useRef(null);Ae.useImperativeHandle(Q,()=>fe.current);const Ee=Tre(H),[Ie,He]=Ae.useState(!1),[Re,st]=Ae.useState(!1);if(Ie)throw Ie;if(Re)throw Re;const _e=Ae.useRef(null);cE(()=>{const Ue=fe.current;oe.width>0&&oe.height>0&&Ue&&(_e.current||(_e.current=OSe(Ue)),_e.current.configure({gl:s,events:o,shadows:h,linear:f,flat:p,legacy:v,orthographic:y,frameloop:S,dpr:C,performance:M,raycaster:E,camera:L,scene:k,size:oe,onPointerMissed:(...vt)=>Ee.current==null?void 0:Ee.current(...vt),onCreated:vt=>{vt.events.connect==null||vt.events.connect(l?_Se(l)?l.current:l:Se.current),a&&vt.setEvents({compute:(xt,Vt)=>{const lt=xt[a+"X"],Ht=xt[a+"Y"];Vt.pointer.set(lt/Vt.size.width*2-1,-(Ht/Vt.size.height)*2+1),Vt.raycaster.setFromCamera(Vt.pointer,Vt.camera)}}),X==null||X(vt)}}),_e.current.render(Ae.createElement(re,null,Ae.createElement(Mre,{set:st},Ae.createElement(Ae.Suspense,{fallback:Ae.createElement(ySe,{set:He})},e)))))}),Ae.useEffect(()=>{const Ue=fe.current;if(Ue)return()=>Fre(Ue)},[]);const We=l?"none":"auto";return Ae.createElement("div",ZT({ref:Se,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:We,...i}},Z),Ae.createElement("div",{ref:ie,style:{width:"100%",height:"100%"}},Ae.createElement("canvas",{ref:fe,style:{display:"block"}},t)))}),Vre=Ae.forwardRef(function(e,t){return Ae.createElement(Gre,null,Ae.createElement(eAe,ZT({},e,{ref:t})))}),fE=new Ze,B6=new Ze,tAe=new Ze,C$=new nn;function nAe(n,e,t){const r=fE.setFromMatrixPosition(n.matrixWorld);r.project(e);const i=t.width/2,s=t.height/2;return[r.x*i+i,-(r.y*s)+s]}function rAe(n,e){const t=fE.setFromMatrixPosition(n.matrixWorld),r=B6.setFromMatrixPosition(e.matrixWorld),i=t.sub(r),s=e.getWorldDirection(tAe);return i.angleTo(s)>Math.PI/2}function iAe(n,e,t,r){const i=fE.setFromMatrixPosition(n.matrixWorld),s=i.clone();s.project(e),C$.set(s.x,s.y),t.setFromCamera(C$,e);const o=t.intersectObjects(r,!0);if(o.length){const l=o[0].distance;return i.distanceTo(t.ray.origin)<l}return!0}function sAe(n,e){if(e instanceof nd)return e.zoom;if(e instanceof ts){const t=fE.setFromMatrixPosition(n.matrixWorld),r=B6.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,s=t.distanceTo(r);return 1/(2*Math.tan(i/2)*s)}else return 1}function aAe(n,e,t){if(e instanceof ts||e instanceof nd){const r=fE.setFromMatrixPosition(n.matrixWorld),i=B6.setFromMatrixPosition(e.matrixWorld),s=r.distanceTo(i),o=(t[1]-t[0])/(e.far-e.near),l=t[1]-o*e.far;return Math.round(o*s+l)}}const Z4=n=>Math.abs(n)<1e-10?0:n;function Hre(n,e,t=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=Z4(e[i]*n.elements[i])+(i!==15?",":")");return t+r}const oAe=(n=>e=>Hre(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),lAe=(n=>(e,t)=>Hre(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]);function cAe(n){return n&&typeof n=="object"&&"current"in n}const uAe=Ae.forwardRef(({children:n,eps:e=.001,style:t,className:r,prepend:i,center:s,fullscreen:o,portal:l,distanceFactor:a,sprite:h=!1,transform:f=!1,occlude:p,onOcclude:v,castShadow:y,receiveShadow:S,material:C,geometry:M,zIndexRange:E=[16777271,0],calculatePosition:L=nAe,as:k="div",wrapperClass:H,pointerEvents:X="auto",...Z},Q)=>{const{gl:re,camera:ie,scene:oe,size:fe,raycaster:Se,events:Ee,viewport:Ie}=kre(),[He]=Ae.useState(()=>document.createElement(k)),Re=Ae.useRef(),st=Ae.useRef(null),_e=Ae.useRef(0),We=Ae.useRef([0,0]),Ue=Ae.useRef(null),vt=Ae.useRef(null),xt=(l==null?void 0:l.current)||Ee.connected||re.domElement.parentNode,Vt=Ae.useRef(null),lt=Ae.useRef(!1),Ht=Ae.useMemo(()=>p&&p!=="blending"||Array.isArray(p)&&p.length&&cAe(p[0]),[p]);Ae.useLayoutEffect(()=>{const Tn=re.domElement;p&&p==="blending"?(Tn.style.zIndex=`${Math.floor(E[0]/2)}`,Tn.style.position="absolute",Tn.style.pointerEvents="none"):(Tn.style.zIndex=null,Tn.style.position=null,Tn.style.pointerEvents=null)},[p]),Ae.useLayoutEffect(()=>{if(st.current){const Tn=Re.current=cte(He);if(oe.updateMatrixWorld(),f)He.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Le=L(st.current,ie,fe);He.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Le[0]}px,${Le[1]}px,0);transform-origin:0 0;`}return xt&&(i?xt.prepend(He):xt.appendChild(He)),()=>{xt&&xt.removeChild(He),Tn.unmount()}}},[xt,f]),Ae.useLayoutEffect(()=>{H&&(He.className=H)},[H]);const Qt=Ae.useMemo(()=>f?{position:"absolute",top:0,left:0,width:fe.width,height:fe.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-fe.height/2,left:-fe.width/2,width:fe.width,height:fe.height},...t},[t,s,o,fe,f]),rn=Ae.useMemo(()=>({position:"absolute",pointerEvents:X}),[X]);Ae.useLayoutEffect(()=>{if(lt.current=!1,f){var Tn;(Tn=Re.current)==null||Tn.render(Ae.createElement("div",{ref:Ue,style:Qt},Ae.createElement("div",{ref:vt,style:rn},Ae.createElement("div",{ref:Q,className:r,style:t,children:n}))))}else{var Le;(Le=Re.current)==null||Le.render(Ae.createElement("div",{ref:Q,style:Qt,className:r,children:n}))}});const jn=Ae.useRef(!0);uE(Tn=>{if(st.current){ie.updateMatrixWorld(),st.current.updateWorldMatrix(!0,!1);const Le=f?We.current:L(st.current,ie,fe);if(f||Math.abs(_e.current-ie.zoom)>e||Math.abs(We.current[0]-Le[0])>e||Math.abs(We.current[1]-Le[1])>e){const qe=rAe(st.current,ie);let mn=!1;Ht&&(Array.isArray(p)?mn=p.map(kn=>kn.current):p!=="blending"&&(mn=[oe]));const cn=jn.current;if(mn){const kn=iAe(st.current,ie,Se,mn);jn.current=kn&&!qe}else jn.current=!qe;cn!==jn.current&&(v?v(!jn.current):He.style.display=jn.current?"block":"none");const St=Math.floor(E[0]/2),Jt=p?Ht?[E[0],St]:[St-1,0]:E;if(He.style.zIndex=`${aAe(st.current,ie,Jt)}`,f){const[kn,Gn]=[fe.width/2,fe.height/2],sn=ie.projectionMatrix.elements[5]*Gn,{isOrthographicCamera:ot,top:Ge,left:Xt,bottom:An,right:Sn}=ie,jt=oAe(ie.matrixWorldInverse),mr=ot?`scale(${sn})translate(${Z4(-(Sn+Xt)/2)}px,${Z4((Ge+An)/2)}px)`:`translateZ(${sn}px)`;let Un=st.current.matrixWorld;h&&(Un=ie.matrixWorldInverse.clone().transpose().copyPosition(Un).scale(st.current.scale),Un.elements[3]=Un.elements[7]=Un.elements[11]=0,Un.elements[15]=1),He.style.width=fe.width+"px",He.style.height=fe.height+"px",He.style.perspective=ot?"":`${sn}px`,Ue.current&&vt.current&&(Ue.current.style.transform=`${mr}${jt}translate(${kn}px,${Gn}px)`,vt.current.style.transform=lAe(Un,1/((a||10)/400)))}else{const kn=a===void 0?1:sAe(st.current,ie)*a;He.style.transform=`translate3d(${Le[0]}px,${Le[1]}px,0) scale(${kn})`}We.current=Le,_e.current=ie.zoom}}if(!Ht&&Vt.current&&!lt.current)if(f){if(Ue.current){const Le=Ue.current.children[0];if(Le!=null&&Le.clientWidth&&Le!=null&&Le.clientHeight){const{isOrthographicCamera:qe}=ie;if(qe||M)Z.scale&&(Array.isArray(Z.scale)?Z.scale instanceof Ze?Vt.current.scale.copy(Z.scale.clone().divideScalar(1)):Vt.current.scale.set(1/Z.scale[0],1/Z.scale[1],1/Z.scale[2]):Vt.current.scale.setScalar(1/Z.scale));else{const mn=(a||10)/400,cn=Le.clientWidth*mn,St=Le.clientHeight*mn;Vt.current.scale.set(cn,St,1)}lt.current=!0}}}else{const Le=He.children[0];if(Le!=null&&Le.clientWidth&&Le!=null&&Le.clientHeight){const qe=1/Ie.factor,mn=Le.clientWidth*qe,cn=Le.clientHeight*qe;Vt.current.scale.set(mn,cn,1),lt.current=!0}Vt.current.lookAt(Tn.camera.position)}});const Bn=Ae.useMemo(()=>({vertexShader:f?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[f]);return Ae.createElement("group",ZT({},Z,{ref:st}),p&&!Ht&&Ae.createElement("mesh",{castShadow:y,receiveShadow:S,ref:Vt},M||Ae.createElement("planeGeometry",null),C||Ae.createElement("shaderMaterial",{side:Ac,vertexShader:Bn.vertexShader,fragmentShader:Bn.fragmentShader})))});function I$(n,e){if(e===r6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===rx||e===YM){let t=n.getIndex();if(t===null){const o=[],l=n.getAttribute("position");if(l!==void 0){for(let a=0;a<l.count;a++)o.push(a);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(t)if(e===rx)for(let o=1;o<=r;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const hAe=parseInt(WM.replace(/\D+/g,""));function RP(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,r=n.length;t<r;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}}const My="srgb",zm="srgb-linear",R$=3001,fAe=3e3;let k6=class extends Ro{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new vAe(t)}),this.register(function(t){return new _Ae(t)}),this.register(function(t){return new EAe(t)}),this.register(function(t){return new CAe(t)}),this.register(function(t){return new IAe(t)}),this.register(function(t){return new xAe(t)}),this.register(function(t){return new bAe(t)}),this.register(function(t){return new wAe(t)}),this.register(function(t){return new SAe(t)}),this.register(function(t){return new gAe(t)}),this.register(function(t){return new AAe(t)}),this.register(function(t){return new yAe(t)}),this.register(function(t){return new MAe(t)}),this.register(function(t){return new TAe(t)}),this.register(function(t){return new pAe(t)}),this.register(function(t){return new RAe(t)}),this.register(function(t){return new PAe(t)})}load(e,t,r,i){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const h=du.extractUrlBase(e);o=du.resolveURL(h,this.path)}else o=du.extractUrlBase(e);this.manager.itemStart(e);const l=function(h){i?i(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},a=new Xo(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(h){try{s.parse(h,o,function(f){t(f),s.manager.itemEnd(e)},l)}catch(f){l(f)}},r,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;const o={},l={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(RP(new Uint8Array(e.slice(0,4)))===jre){try{o[Vi.KHR_BINARY_GLTF]=new LAe(e)}catch(f){i&&i(f);return}s=JSON.parse(o[Vi.KHR_BINARY_GLTF].content)}else s=JSON.parse(RP(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const a=new WAe(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});a.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const f=this.pluginCallbacks[h](a);f.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[f.name]=f,o[f.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const f=s.extensionsUsed[h],p=s.extensionsRequired||[];switch(f){case Vi.KHR_MATERIALS_UNLIT:o[f]=new mAe;break;case Vi.KHR_DRACO_MESH_COMPRESSION:o[f]=new DAe(s,this.dracoLoader);break;case Vi.KHR_TEXTURE_TRANSFORM:o[f]=new BAe;break;case Vi.KHR_MESH_QUANTIZATION:o[f]=new kAe;break;default:p.indexOf(f)>=0&&l[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}a.setExtensions(o),a.setPlugins(l),a.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}};function dAe(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Vi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let pAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,a=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const f=new Vn(16777215);a.color!==void 0&&f.setRGB(a.color[0],a.color[1],a.color[2],zm);const p=a.range!==void 0?a.range:0;switch(a.type){case"directional":h=new B0(f),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new a0(f),h.distance=p;break;case"spot":h=new kD(f),h.distance=p,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,h.angle=a.spot.outerConeAngle,h.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return h.position.set(0,0,0),h.decay=2,bm(h,a),a.intensity!==void 0&&(h.intensity=a.intensity),h.name=t.createUniqueName(a.name||"light_"+e),i=Promise.resolve(h),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,s=r.json.nodes[e],l=(s.extensions&&s.extensions[this.name]||{}).light;return l===void 0?null:this._loadLight(l).then(function(a){return r._getNodeRef(t.cache,l,a)})}},mAe=class{constructor(){this.name=Vi.KHR_MATERIALS_UNLIT}getMaterialType(){return _a}extendParams(e,t,r){const i=[];e.color=new Vn(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],zm),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,My))}return Promise.all(i)}},gAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}},vAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const l=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new nn(l,l)}return Promise.all(s)}},_Ae=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}},yAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}},xAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Vn(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const l=o.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],zm)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,My)),o.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}},bAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}},wAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const l=o.attenuationColor||[1,1,1];return t.attenuationColor=new Vn().setRGB(l[0],l[1],l[2],zm),Promise.all(s)}},SAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}},AAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));const l=o.specularColorFactor||[1,1,1];return t.specularColor=new Vn().setRGB(l[0],l[1],l[2],zm),o.specularColorTexture!==void 0&&s.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,My)),Promise.all(s)}},TAe=class{constructor(e){this.parser=e,this.name=Vi.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(r.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}},MAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(r.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}},EAe=class{constructor(e){this.parser=e,this.name=Vi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}},CAe=class{constructor(e){this.parser=e,this.name=Vi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=i.images[o.source];let a=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(a=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,o.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},IAe=class{constructor(e){this.parser=e,this.name=Vi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=i.images[o.source];let a=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(a=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,o.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}},RAe=class{constructor(e){this.name=Vi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(l){const a=i.byteOffset||0,h=i.byteLength||0,f=i.count,p=i.byteStride,v=new Uint8Array(l,a,h);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(f,p,v,i.mode,i.filter).then(function(y){return y.buffer}):o.ready.then(function(){const y=new ArrayBuffer(f*p);return o.decodeGltfBuffer(new Uint8Array(y),f,p,v,i.mode,i.filter),y})})}else return null}},PAe=class{constructor(e){this.name=Vi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const h of i.primitives)if(h.mode!==mh.TRIANGLES&&h.mode!==mh.TRIANGLE_STRIP&&h.mode!==mh.TRIANGLE_FAN&&h.mode!==void 0)return null;const o=r.extensions[this.name].attributes,l=[],a={};for(const h in o)l.push(this.parser.getDependency("accessor",o[h]).then(f=>(a[h]=f,a[h])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(h=>{const f=h.pop(),p=f.isGroup?f.children:[f],v=h[0].count,y=[];for(const S of p){const C=new Gr,M=new Ze,E=new Mo,L=new Ze(1,1,1),k=new xD(S.geometry,S.material,v);for(let H=0;H<v;H++)a.TRANSLATION&&M.fromBufferAttribute(a.TRANSLATION,H),a.ROTATION&&E.fromBufferAttribute(a.ROTATION,H),a.SCALE&&L.fromBufferAttribute(a.SCALE,H),k.setMatrixAt(H,C.compose(M,E,L));for(const H in a)if(H==="_COLOR_0"){const X=a[H];k.instanceColor=new m0(X.array,X.itemSize,X.normalized)}else H!=="TRANSLATION"&&H!=="ROTATION"&&H!=="SCALE"&&S.geometry.setAttribute(H,a[H]);Pi.prototype.copy.call(k,S),this.parser.assignFinalMaterial(k),y.push(k)}return f.isGroup?(f.clear(),f.add(...y),f):y[0]}))}};const jre="glTF",WS=12,P$={JSON:1313821514,BIN:5130562};let LAe=class{constructor(e){this.name=Vi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,WS);if(this.header={magic:RP(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==jre)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-WS,i=new DataView(e,WS);let s=0;for(;s<r;){const o=i.getUint32(s,!0);s+=4;const l=i.getUint32(s,!0);if(s+=4,l===P$.JSON){const a=new Uint8Array(e,WS+s,o);this.content=RP(a)}else if(l===P$.BIN){const a=WS+s;this.body=e.slice(a,a+o)}s+=o}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}},DAe=class{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Vi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,l={},a={},h={};for(const f in o){const p=Y4[f]||f.toLowerCase();l[p]=o[f]}for(const f in e.attributes){const p=Y4[f]||f.toLowerCase();if(o[f]!==void 0){const v=r.accessors[e.attributes[f]],y=Nb[v.componentType];h[p]=y.name,a[p]=v.normalized===!0}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(p,v){i.decodeDracoFile(f,function(y){for(const S in y.attributes){const C=y.attributes[S],M=a[S];M!==void 0&&(C.normalized=M)}p(y)},l,h,zm,v)})})}},BAe=class{constructor(){this.name=Vi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}},kAe=class{constructor(){this.name=Vi.KHR_MESH_QUANTIZATION}},Wre=class extends bx{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)t[o]=r[s+o];return t}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,a=l*2,h=l*3,f=i-t,p=(r-t)/f,v=p*p,y=v*p,S=e*h,C=S-h,M=-2*y+3*v,E=y-v,L=1-M,k=E-v+p;for(let H=0;H!==l;H++){const X=o[C+H+l],Z=o[C+H+a]*f,Q=o[S+H+l],re=o[S+H]*f;s[H]=L*X+k*Z+M*Q+E*re}return s}};const OAe=new Mo;let FAe=class extends Wre{interpolate_(e,t,r,i){const s=super.interpolate_(e,t,r,i);return OAe.fromArray(s).normalize().toArray(s),s}};const mh={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Nb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},L$={9728:Ao,9729:Ca,9984:XM,9985:Oy,9986:Wv,9987:lu},D$={33071:ou,33648:Qy,10497:Oh},bF={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Y4={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",...hAe>=152?{TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3"}:{TEXCOORD_0:"uv",TEXCOORD_1:"uv2"},COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},_v={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},NAe={CUBICSPLINE:void 0,LINEAR:p0,STEP:nx},wF={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function zAe(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new mp({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:kh})),n.DefaultMaterial}function B_(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function bm(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function UAe(n,e,t){let r=!1,i=!1,s=!1;for(let h=0,f=e.length;h<f;h++){const p=e[h];if(p.POSITION!==void 0&&(r=!0),p.NORMAL!==void 0&&(i=!0),p.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(n);const o=[],l=[],a=[];for(let h=0,f=e.length;h<f;h++){const p=e[h];if(r){const v=p.POSITION!==void 0?t.getDependency("accessor",p.POSITION):n.attributes.position;o.push(v)}if(i){const v=p.NORMAL!==void 0?t.getDependency("accessor",p.NORMAL):n.attributes.normal;l.push(v)}if(s){const v=p.COLOR_0!==void 0?t.getDependency("accessor",p.COLOR_0):n.attributes.color;a.push(v)}}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(a)]).then(function(h){const f=h[0],p=h[1],v=h[2];return r&&(n.morphAttributes.position=f),i&&(n.morphAttributes.normal=p),s&&(n.morphAttributes.color=v),n.morphTargetsRelative=!0,n})}function GAe(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function VAe(n){let e;const t=n.extensions&&n.extensions[Vi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+SF(t.attributes):e=n.indices+":"+SF(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,i=n.targets.length;r<i;r++)e+=":"+SF(n.targets[r]);return e}function SF(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function K4(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function HAe(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const jAe=new Gr;let WAe=class{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new dAe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=!1,s=-1;typeof navigator<"u"&&typeof navigator.userAgent<"u"&&(r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,i=navigator.userAgent.indexOf("Firefox")>-1,s=i?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||r||i&&s<98?this.textureLoader=new Qf(this.options.manager):this.textureLoader=new E6(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Xo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(o){const l={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:r,userData:{}};return B_(s,l,i),bm(l,i),Promise.all(r._invokeAll(function(a){return a.afterRoot&&a.afterRoot(l)})).then(function(){for(const a of l.scenes)a.updateMatrixWorld();e(l)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const o=t[i].joints;for(let l=0,a=o.length;l<a;l++)e[o[l]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(r[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),s=(o,l)=>{const a=this.associations.get(o);a!=null&&this.associations.set(l,a);for(const[h,f]of o.children.entries())s(f,l.children[h])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,o){return r.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Vi.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){r.load(du.resolveURL(t.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,s=t.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=bF[i.type],l=Nb[i.componentType],a=i.normalized===!0,h=new l(i.count*o);return Promise.resolve(new ki(h,o,a))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const l=o[0],a=bF[i.type],h=Nb[i.componentType],f=h.BYTES_PER_ELEMENT,p=f*a,v=i.byteOffset||0,y=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,S=i.normalized===!0;let C,M;if(y&&y!==p){const E=Math.floor(v/y),L="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+E+":"+i.count;let k=t.cache.get(L);k||(C=new h(l,E*y,i.count*y/f),k=new Mw(C,y/f),t.cache.add(L,k)),M=new Zm(k,a,v%y/f,S)}else l===null?C=new h(i.count*a):C=new h(l,v,i.count*a),M=new ki(C,a,S);if(i.sparse!==void 0){const E=bF.SCALAR,L=Nb[i.sparse.indices.componentType],k=i.sparse.indices.byteOffset||0,H=i.sparse.values.byteOffset||0,X=new L(o[1],k,i.sparse.count*E),Z=new h(o[2],H,i.sparse.count*a);l!==null&&(M=new ki(M.array.slice(),M.itemSize,M.normalized));for(let Q=0,re=X.length;Q<re;Q++){const ie=X[Q];if(M.setX(ie,Z[Q*a]),a>=2&&M.setY(ie,Z[Q*a+1]),a>=3&&M.setZ(ie,Z[Q*a+2]),a>=4&&M.setW(ie,Z[Q*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const t=this.json,r=this.options,s=t.textures[e].source,o=t.images[s];let l=this.textureLoader;if(o.uri){const a=r.manager.getHandler(o.uri);a!==null&&(l=a)}return this.loadTextureImage(e,s,l)}loadTextureImage(e,t,r){const i=this,s=this.json,o=s.textures[e],l=s.images[t],a=(l.uri||l.bufferView)+":"+o.sampler;if(this.textureCache[a])return this.textureCache[a];const h=this.loadImageSource(t,r).then(function(f){f.flipY=!1,f.name=o.name||l.name||"",f.name===""&&typeof l.uri=="string"&&l.uri.startsWith("data:image/")===!1&&(f.name=l.uri);const v=(s.samplers||{})[o.sampler]||{};return f.magFilter=L$[v.magFilter]||Ca,f.minFilter=L$[v.minFilter]||lu,f.wrapS=D$[v.wrapS]||Oh,f.wrapT=D$[v.wrapT]||Oh,i.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[a]=h,h}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(p=>p.clone());const o=i.images[e],l=self.URL||self.webkitURL;let a=o.uri||"",h=!1;if(o.bufferView!==void 0)a=r.getDependency("bufferView",o.bufferView).then(function(p){h=!0;const v=new Blob([p],{type:o.mimeType});return a=l.createObjectURL(v),a});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(a).then(function(p){return new Promise(function(v,y){let S=v;t.isImageBitmapLoader===!0&&(S=function(C){const M=new Xs(C);M.needsUpdate=!0,v(M)}),t.load(du.resolveURL(p,s.path),S,void 0,y)})}).then(function(p){return h===!0&&l.revokeObjectURL(a),bm(p,o),p.userData.mimeType=o.mimeType||HAe(o.uri),p}).catch(function(p){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),p});return this.sourceCache[e]=f,f}assignTexture(e,t,r,i){const s=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(o=o.clone(),o.channel=r.texCoord),s.extensions[Vi.KHR_TEXTURE_TRANSFORM]){const l=r.extensions!==void 0?r.extensions[Vi.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const a=s.associations.get(o);o=s.extensions[Vi.KHR_TEXTURE_TRANSFORM].extendTexture(o,l),s.associations.set(o,a)}}return i!==void 0&&(typeof i=="number"&&(i=i===R$?My:zm),"colorSpace"in o?o.colorSpace=i:o.encoding=i===My?R$:fAe),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const l="PointsMaterial:"+r.uuid;let a=this.cache.get(l);a||(a=new cu,ya.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,a.sizeAttenuation=!1,this.cache.add(l,a)),r=a}else if(e.isLine){const l="LineBasicMaterial:"+r.uuid;let a=this.cache.get(l);a||(a=new Eo,ya.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,this.cache.add(l,a)),r=a}if(i||s||o){let l="ClonedMaterial:"+r.uuid+":";i&&(l+="derivative-tangents:"),s&&(l+="vertex-colors:"),o&&(l+="flat-shading:");let a=this.cache.get(l);a||(a=r.clone(),s&&(a.vertexColors=!0),o&&(a.flatShading=!0),i&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(l,a),this.associations.set(a,this.associations.get(r))),r=a}e.material=r}getMaterialType(){return mp}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let o;const l={},a=s.extensions||{},h=[];if(a[Vi.KHR_MATERIALS_UNLIT]){const p=i[Vi.KHR_MATERIALS_UNLIT];o=p.getMaterialType(),h.push(p.extendParams(l,s,t))}else{const p=s.pbrMetallicRoughness||{};if(l.color=new Vn(1,1,1),l.opacity=1,Array.isArray(p.baseColorFactor)){const v=p.baseColorFactor;l.color.setRGB(v[0],v[1],v[2],zm),l.opacity=v[3]}p.baseColorTexture!==void 0&&h.push(t.assignTexture(l,"map",p.baseColorTexture,My)),l.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,l.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(l,"metalnessMap",p.metallicRoughnessTexture)),h.push(t.assignTexture(l,"roughnessMap",p.metallicRoughnessTexture))),o=this._invokeOne(function(v){return v.getMaterialType&&v.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(v){return v.extendMaterialParams&&v.extendMaterialParams(e,l)})))}s.doubleSided===!0&&(l.side=Ac);const f=s.alphaMode||wF.OPAQUE;if(f===wF.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,f===wF.MASK&&(l.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==_a&&(h.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new nn(1,1),s.normalTexture.scale!==void 0)){const p=s.normalTexture.scale;l.normalScale.set(p,p)}if(s.occlusionTexture!==void 0&&o!==_a&&(h.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==_a){const p=s.emissiveFactor;l.emissive=new Vn().setRGB(p[0],p[1],p[2],zm)}return s.emissiveTexture!==void 0&&o!==_a&&h.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,My)),Promise.all(h).then(function(){const p=new o(l);return s.name&&(p.name=s.name),bm(p,s),t.associations.set(p,{materials:e}),s.extensions&&B_(i,p,s),p})}createUniqueName(e){const t=es.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(l){return r[Vi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(a){return B$(a,l,t)})}const o=[];for(let l=0,a=e.length;l<a;l++){const h=e[l],f=VAe(h),p=i[f];if(p)o.push(p.promise);else{let v;h.extensions&&h.extensions[Vi.KHR_DRACO_MESH_COMPRESSION]?v=s(h):v=B$(new Xr,h,t),i[f]={primitive:h,promise:v},o.push(v)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.json,i=this.extensions,s=r.meshes[e],o=s.primitives,l=[];for(let a=0,h=o.length;a<h;a++){const f=o[a].material===void 0?zAe(this.cache):this.getDependency("material",o[a].material);l.push(f)}return l.push(t.loadGeometries(o)),Promise.all(l).then(function(a){const h=a.slice(0,a.length-1),f=a[a.length-1],p=[];for(let y=0,S=f.length;y<S;y++){const C=f[y],M=o[y];let E;const L=h[y];if(M.mode===mh.TRIANGLES||M.mode===mh.TRIANGLE_STRIP||M.mode===mh.TRIANGLE_FAN||M.mode===void 0)E=s.isSkinnedMesh===!0?new yD(C,L):new Ri(C,L),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),M.mode===mh.TRIANGLE_STRIP?E.geometry=I$(E.geometry,YM):M.mode===mh.TRIANGLE_FAN&&(E.geometry=I$(E.geometry,rx));else if(M.mode===mh.LINES)E=new pu(C,L);else if(M.mode===mh.LINE_STRIP)E=new Jf(C,L);else if(M.mode===mh.LINE_LOOP)E=new bD(C,L);else if(M.mode===mh.POINTS)E=new Eh(C,L);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(E.geometry.morphAttributes).length>0&&GAe(E,s),E.name=t.createUniqueName(s.name||"mesh_"+e),bm(E,s),M.extensions&&B_(i,E,M),t.assignFinalMaterial(E),p.push(E)}for(let y=0,S=p.length;y<S;y++)t.associations.set(p[y],{meshes:e,primitives:y});if(p.length===1)return s.extensions&&B_(i,p[0],s),p[0];const v=new ql;s.extensions&&B_(i,v,s),t.associations.set(v,{meshes:e});for(let y=0,S=p.length;y<S;y++)v.add(p[y]);return v})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new ts(ra.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new nd(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),bm(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,s=t.joints.length;i<s;i++)r.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),o=i,l=[],a=[];for(let h=0,f=o.length;h<f;h++){const p=o[h];if(p){l.push(p);const v=new Gr;s!==null&&v.fromArray(s.array,h*16),a.push(v)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new Ew(l,a)})}loadAnimation(e){const t=this.json,r=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,o=[],l=[],a=[],h=[],f=[];for(let p=0,v=i.channels.length;p<v;p++){const y=i.channels[p],S=i.samplers[y.sampler],C=y.target,M=C.node,E=i.parameters!==void 0?i.parameters[S.input]:S.input,L=i.parameters!==void 0?i.parameters[S.output]:S.output;C.node!==void 0&&(o.push(this.getDependency("node",M)),l.push(this.getDependency("accessor",E)),a.push(this.getDependency("accessor",L)),h.push(S),f.push(C))}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(a),Promise.all(h),Promise.all(f)]).then(function(p){const v=p[0],y=p[1],S=p[2],C=p[3],M=p[4],E=[];for(let L=0,k=v.length;L<k;L++){const H=v[L],X=y[L],Z=S[L],Q=C[L],re=M[L];if(H===void 0)continue;H.updateMatrix&&H.updateMatrix();const ie=r._createAnimationTracks(H,X,Z,Q,re);if(ie)for(let oe=0;oe<ie.length;oe++)E.push(ie[oe])}return new ax(s,void 0,E)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const o=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(l){if(l.isMesh)for(let a=0,h=i.weights.length;a<h;a++)l.morphTargetInfluences[a]=i.weights[a]}),o})}loadNode(e){const t=this.json,r=this,i=t.nodes[e],s=r._loadNodeShallow(e),o=[],l=i.children||[];for(let h=0,f=l.length;h<f;h++)o.push(r.getDependency("node",l[h]));const a=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(o),a]).then(function(h){const f=h[0],p=h[1],v=h[2];v!==null&&f.traverse(function(y){y.isSkinnedMesh&&y.bind(v,jAe)});for(let y=0,S=p.length;y<S;y++)f.add(p[y]);return f})}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?i.createUniqueName(s.name):"",l=[],a=i._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return a&&l.push(a),s.camera!==void 0&&l.push(i.getDependency("camera",s.camera).then(function(h){return i._getNodeRef(i.cameraCache,s.camera,h)})),i._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){l.push(h)}),this.nodeCache[e]=Promise.all(l).then(function(h){let f;if(s.isBone===!0?f=new nE:h.length>1?f=new ql:h.length===1?f=h[0]:f=new Pi,f!==h[0])for(let p=0,v=h.length;p<v;p++)f.add(h[p]);if(s.name&&(f.userData.name=s.name,f.name=o),bm(f,s),s.extensions&&B_(r,f,s),s.matrix!==void 0){const p=new Gr;p.fromArray(s.matrix),f.applyMatrix4(p)}else s.translation!==void 0&&f.position.fromArray(s.translation),s.rotation!==void 0&&f.quaternion.fromArray(s.rotation),s.scale!==void 0&&f.scale.fromArray(s.scale);return i.associations.has(f)||i.associations.set(f,{}),i.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new ql;r.name&&(s.name=i.createUniqueName(r.name)),bm(s,r),r.extensions&&B_(t,s,r);const o=r.nodes||[],l=[];for(let a=0,h=o.length;a<h;a++)l.push(i.getDependency("node",o[a]));return Promise.all(l).then(function(a){for(let f=0,p=a.length;f<p;f++)s.add(a[f]);const h=f=>{const p=new Map;for(const[v,y]of i.associations)(v instanceof ya||v instanceof Xs)&&p.set(v,y);return f.traverse(v=>{const y=i.associations.get(v);y!=null&&p.set(v,y)}),p};return i.associations=h(s),s})}_createAnimationTracks(e,t,r,i,s){const o=[],l=e.name?e.name:e.uuid,a=[];_v[s.path]===_v.weights?e.traverse(function(v){v.morphTargetInfluences&&a.push(v.name?v.name:v.uuid)}):a.push(l);let h;switch(_v[s.path]){case _v.weights:h=Ym;break;case _v.rotation:h=Km;break;case _v.position:case _v.scale:h=Jm;break;default:switch(r.itemSize){case 1:h=Ym;break;case 2:case 3:default:h=Jm;break}break}const f=i.interpolation!==void 0?NAe[i.interpolation]:p0,p=this._getArrayFromAccessor(r);for(let v=0,y=a.length;v<y;v++){const S=new h(a[v]+"."+_v[s.path],t.array,p,f);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(S),o.push(S)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=K4(t.constructor),i=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)i[s]=t[s]*r;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof Km?FAe:Wre;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function $Ae(n,e,t){const r=e.attributes,i=new Al;if(r.POSITION!==void 0){const l=t.json.accessors[r.POSITION],a=l.min,h=l.max;if(a!==void 0&&h!==void 0){if(i.set(new Ze(a[0],a[1],a[2]),new Ze(h[0],h[1],h[2])),l.normalized){const f=K4(Nb[l.componentType]);i.min.multiplyScalar(f),i.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const l=new Ze,a=new Ze;for(let h=0,f=s.length;h<f;h++){const p=s[h];if(p.POSITION!==void 0){const v=t.json.accessors[p.POSITION],y=v.min,S=v.max;if(y!==void 0&&S!==void 0){if(a.setX(Math.max(Math.abs(y[0]),Math.abs(S[0]))),a.setY(Math.max(Math.abs(y[1]),Math.abs(S[1]))),a.setZ(Math.max(Math.abs(y[2]),Math.abs(S[2]))),v.normalized){const C=K4(Nb[v.componentType]);a.multiplyScalar(C)}l.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(l)}n.boundingBox=i;const o=new sl;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=o}function B$(n,e,t){const r=e.attributes,i=[];function s(o,l){return t.getDependency("accessor",o).then(function(a){n.setAttribute(l,a)})}for(const o in r){const l=Y4[o]||o.toLowerCase();l in n.attributes||i.push(s(r[o],l))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});i.push(o)}return bm(n,e),$Ae(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?UAe(n,e.targets,t):n})}const AF=new WeakMap;let XAe=class extends Ro{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){const s=new Xo(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const l={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,l).then(t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){const s={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,s).then(t)}decodeGeometry(e,t){for(const a in t.attributeTypes){const h=t.attributeTypes[a];h.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[a]=h.name)}const r=JSON.stringify(t);if(AF.has(e)){const a=AF.get(e);if(a.key===r)return a.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,o=e.byteLength,l=this._getWorker(s,o).then(a=>(i=a,new Promise((h,f)=>{i._callbacks[s]={resolve:h,reject:f},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(a=>this._createGeometry(a.geometry));return l.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),AF.set(e,{key:r,promise:l}),l}_createGeometry(e){const t=new Xr;e.index&&t.setIndex(new ki(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r],s=i.name,o=i.array,l=i.itemSize;t.setAttribute(s,new ki(o,l))}return t}_loadLibrary(e,t){const r=new Xo(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,s)=>{r.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=qAe.toString(),o=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const o=s.data;switch(o.type){case"decode":i._callbacks[o.id].resolve(o);break;case"error":i._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}};function qAe(){let n,e;onmessage=function(o){const l=o.data;switch(l.type){case"init":n=l.decoderConfig,e=new Promise(function(f){n.onModuleLoaded=function(p){f({draco:p})},DracoDecoderModule(n)});break;case"decode":const a=l.buffer,h=l.taskConfig;e.then(f=>{const p=f.draco,v=new p.Decoder,y=new p.DecoderBuffer;y.Init(new Int8Array(a),a.byteLength);try{const S=t(p,v,y,h),C=S.attributes.map(M=>M.array.buffer);S.index&&C.push(S.index.array.buffer),self.postMessage({type:"decode",id:l.id,geometry:S},C)}catch(S){console.error(S),self.postMessage({type:"error",id:l.id,error:S.message})}finally{p.destroy(y),p.destroy(v)}});break}};function t(o,l,a,h){const f=h.attributeIDs,p=h.attributeTypes;let v,y;const S=l.GetEncodedGeometryType(a);if(S===o.TRIANGULAR_MESH)v=new o.Mesh,y=l.DecodeBufferToMesh(a,v);else if(S===o.POINT_CLOUD)v=new o.PointCloud,y=l.DecodeBufferToPointCloud(a,v);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||v.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const C={index:null,attributes:[]};for(const M in f){const E=self[p[M]];let L,k;if(h.useUniqueIDs)k=f[M],L=l.GetAttributeByUniqueId(v,k);else{if(k=l.GetAttributeId(v,o[f[M]]),k===-1)continue;L=l.GetAttribute(v,k)}C.attributes.push(i(o,l,v,M,E,L))}return S===o.TRIANGULAR_MESH&&(C.index=r(o,l,v)),o.destroy(v),C}function r(o,l,a){const f=a.num_faces()*3,p=f*4,v=o._malloc(p);l.GetTrianglesUInt32Array(a,p,v);const y=new Uint32Array(o.HEAPF32.buffer,v,f).slice();return o._free(v),{array:y,itemSize:1}}function i(o,l,a,h,f,p){const v=p.num_components(),S=a.num_points()*v,C=S*f.BYTES_PER_ELEMENT,M=s(o,f),E=o._malloc(C);l.GetAttributeDataArrayForAllPoints(a,p,M,C,E);const L=new f(o.HEAPF32.buffer,E,S).slice();return o._free(E),{name:h,array:L,itemSize:v}}function s(o,l){switch(l){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let P2;const TF=()=>{if(P2)return P2;const n="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",t=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),r=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let i=n;WebAssembly.validate(t)&&(i=e);let s;const o=WebAssembly.instantiate(l(i),{}).then(p=>{s=p.instance,s.exports.__wasm_call_ctors()});function l(p){const v=new Uint8Array(p.length);for(let S=0;S<p.length;++S){const C=p.charCodeAt(S);v[S]=C>96?C-71:C>64?C-65:C>47?C+4:C>46?63:62}let y=0;for(let S=0;S<p.length;++S)v[y++]=v[S]<60?r[v[S]]:(v[S]-60)*64+v[++S];return v.buffer.slice(0,y)}function a(p,v,y,S,C,M){const E=s.exports.sbrk,L=y+3&-4,k=E(L*S),H=E(C.length),X=new Uint8Array(s.exports.memory.buffer);X.set(C,H);const Z=p(k,y,S,H,C.length);if(Z===0&&M&&M(k,L,S),v.set(X.subarray(k,k+y*S)),E(k-E(0)),Z!==0)throw new Error(`Malformed buffer data: ${Z}`)}const h={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},f={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return P2={ready:o,supported:!0,decodeVertexBuffer(p,v,y,S,C){a(s.exports.meshopt_decodeVertexBuffer,p,v,y,S,s.exports[h[C]])},decodeIndexBuffer(p,v,y,S){a(s.exports.meshopt_decodeIndexBuffer,p,v,y,S)},decodeIndexSequence(p,v,y,S){a(s.exports.meshopt_decodeIndexSequence,p,v,y,S)},decodeGltfBuffer(p,v,y,S,C,M){a(s.exports[f[C]],p,v,y,S,s.exports[h[M]])}},P2};let L2=null,$re="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Xre(n,e,t){return r=>{t&&t(r),n&&(L2||(L2=new XAe),L2.setDecoderPath(typeof n=="string"?n:$re),r.setDRACOLoader(L2)),e&&r.setMeshoptDecoder(typeof TF=="function"?TF():TF)}}function ag(n,e=!0,t=!0,r){return hE(k6,n,Xre(e,t,r))}ag.preload=(n,e=!0,t=!0,r)=>hE.preload(k6,n,Xre(e,t,r));ag.clear=n=>hE.clear(k6,n);ag.setDecoderPath=n=>{$re=n};function O6(n,e){const t=Ae.useRef(),[r]=Ae.useState(()=>e?e instanceof Pi?{current:e}:e:t),[i]=Ae.useState(()=>new pre(void 0));Ae.useLayoutEffect(()=>{e&&(r.current=e instanceof Pi?e:e.current),i._root=r.current});const s=Ae.useRef({}),o=Ae.useMemo(()=>{const l={};return n.forEach(a=>Object.defineProperty(l,a.name,{enumerable:!0,get(){if(r.current)return s.current[a.name]||(s.current[a.name]=i.clipAction(a,r.current))},configurable:!0})),{ref:r,clips:n,actions:l,names:n.map(a=>a.name),mixer:i}},[n]);return uE((l,a)=>i.update(a)),Ae.useEffect(()=>{const l=r.current;return()=>{s.current={},i.stopAllAction(),Object.values(o.actions).forEach(a=>{l&&i.uncacheAction(a,l)})}},[n]),o}var qre={exports:{}},ZAe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",YAe=ZAe,KAe=YAe;function Zre(){}function Yre(){}Yre.resetWarningCache=Zre;var JAe=function(){function n(r,i,s,o,l,a){if(a!==KAe){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Yre,resetWarningCache:Zre};return t.PropTypes=t,t};qre.exports=JAe();var Kre=qre.exports;const F6=()=>me.jsx(uAe,{children:me.jsx("div",{className:"flex justify-center items-center ",children:me.jsx("div",{className:"w-20 h-20 border-4 border-opacity-20 border-blue-500 border-t-indigo-800 rounded-full animate-spin"})})}),QAe=(n,e,t,r)=>{var s,o,l,a;const i=[t,{code:e,...r||{}}];if((o=(s=n==null?void 0:n.services)==null?void 0:s.logger)!=null&&o.forward)return n.services.logger.forward(i,"warn","react-i18next::",!0);Gy(i[0])&&(i[0]=`react-i18next:: ${i[0]}`),(a=(l=n==null?void 0:n.services)==null?void 0:l.logger)!=null&&a.warn?n.services.logger.warn(...i):console!=null&&console.warn&&console.warn(...i)},k$={},J4=(n,e,t,r)=>{Gy(t)&&k$[t]||(Gy(t)&&(k$[t]=new Date),QAe(n,e,t,r))},Jre=(n,e)=>()=>{if(n.isInitialized)e();else{const t=()=>{setTimeout(()=>{n.off("initialized",t)},0),e()};n.on("initialized",t)}},Q4=(n,e,t)=>{n.loadNamespaces(e,Jre(n,t))},O$=(n,e,t,r)=>{if(Gy(t)&&(t=[t]),n.options.preload&&n.options.preload.indexOf(e)>-1)return Q4(n,t,r);t.forEach(i=>{n.options.ns.indexOf(i)<0&&n.options.ns.push(i)}),n.loadLanguages(e,Jre(n,r))},eTe=(n,e,t={})=>!e.languages||!e.languages.length?(J4(e,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:e.languages}),!0):e.hasLoadedNamespace(n,{lng:t.lng,precheck:(r,i)=>{var s;if(((s=t.bindI18n)==null?void 0:s.indexOf("languageChanging"))>-1&&r.services.backendConnector.backend&&r.isLanguageChangingTo&&!i(r.isLanguageChangingTo,n))return!1}}),Gy=n=>typeof n=="string",tTe=n=>typeof n=="object"&&n!==null,nTe=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,rTe={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},iTe=n=>rTe[n],sTe=n=>n.replace(nTe,iTe);let aTe={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:sTe};const oTe=()=>aTe;let lTe;const cTe=()=>lTe,Qre=Ae.createContext();class uTe{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const hTe=(n,e)=>{const t=Ae.useRef();return Ae.useEffect(()=>{t.current=n},[n,e]),t.current},eie=(n,e,t,r)=>n.getFixedT(e,t,r),fTe=(n,e,t,r)=>Ae.useCallback(eie(n,e,t,r),[n,e,t,r]),Iw=(n,e={})=>{var H,X,Z,Q;const{i18n:t}=e,{i18n:r,defaultNS:i}=Ae.useContext(Qre)||{},s=t||r||cTe();if(s&&!s.reportNamespaces&&(s.reportNamespaces=new uTe),!s){J4(s,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const re=(oe,fe)=>Gy(fe)?fe:tTe(fe)&&Gy(fe.defaultValue)?fe.defaultValue:Array.isArray(oe)?oe[oe.length-1]:oe,ie=[re,{},!1];return ie.t=re,ie.i18n={},ie.ready=!1,ie}(H=s.options.react)!=null&&H.wait&&J4(s,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const o={...oTe(),...s.options.react,...e},{useSuspense:l,keyPrefix:a}=o;let h=i||((X=s.options)==null?void 0:X.defaultNS);h=Gy(h)?[h]:h||["translation"],(Q=(Z=s.reportNamespaces).addUsedNamespaces)==null||Q.call(Z,h);const f=(s.isInitialized||s.initializedStoreOnce)&&h.every(re=>eTe(re,s,o)),p=fTe(s,e.lng||null,o.nsMode==="fallback"?h:h[0],a),v=()=>p,y=()=>eie(s,e.lng||null,o.nsMode==="fallback"?h:h[0],a),[S,C]=Ae.useState(v);let M=h.join();e.lng&&(M=`${e.lng}${M}`);const E=hTe(M),L=Ae.useRef(!0);Ae.useEffect(()=>{const{bindI18n:re,bindI18nStore:ie}=o;L.current=!0,!f&&!l&&(e.lng?O$(s,e.lng,h,()=>{L.current&&C(y)}):Q4(s,h,()=>{L.current&&C(y)})),f&&E&&E!==M&&L.current&&C(y);const oe=()=>{L.current&&C(y)};return re&&(s==null||s.on(re,oe)),ie&&(s==null||s.store.on(ie,oe)),()=>{L.current=!1,s&&(re==null||re.split(" ").forEach(fe=>s.off(fe,oe))),ie&&s&&ie.split(" ").forEach(fe=>s.store.off(fe,oe))}},[s,M]),Ae.useEffect(()=>{L.current&&f&&C(v)},[s,a,f]);const k=[S,s,f];if(k.t=S,k.i18n=s,k.ready=f,f||!f&&!l)return k;throw new Promise(re=>{e.lng?O$(s,e.lng,h,()=>re()):Q4(s,h,()=>re())})};function dTe({i18n:n,defaultNS:e,children:t}){const r=Ae.useMemo(()=>({i18n:n,defaultNS:e}),[n,e]);return Ae.createElement(Qre.Provider,{value:r},t)}const pTe=()=>{const{t:n}=Iw();return me.jsxs("header",{className:"header",children:[me.jsx(OC,{to:"/",className:"w-10 h-10 rounded-lg bg-white items-center justify-center flex font-bold shadow-md",children:me.jsx("p",{className:"blue-gradient_text",children:"AH"})}),me.jsxs("nav",{className:"flex text-xl gap-10 font-medium shadow-text",children:[me.jsx(OC,{to:"/about",className:({isActive:e})=>e?"text-blue-500":"text-black",children:n("aboutMe.title")}),me.jsx(OC,{to:"/projects",className:({isActive:e})=>e?"text-blue-500":"text-black",children:n("projects.title")}),me.jsx(OC,{to:"/arts",className:({isActive:e})=>e?"text-blue-500":"text-black",children:n("gallery.title")})]})]})},tie="data:image/svg+xml,%3csvg%20width='14'%20height='15'%20viewBox='0%200%2014%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M1.16602%207.49984H12.8327M12.8327%207.49984L6.99935%201.6665M12.8327%207.49984L6.99935%2013.3332'%20stroke='%23406AFF'%20stroke-width='1.66667'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",mTe="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='%23E53F31'%20class='size-6'%3e%3cpath%20d='m11.645%2020.91-.007-.003-.022-.012a15.247%2015.247%200%200%201-.383-.218%2025.18%2025.18%200%200%201-4.244-3.17C4.688%2015.36%202.25%2012.174%202.25%208.25%202.25%205.322%204.714%203%207.688%203A5.5%205.5%200%200%201%2012%205.052%205.5%205.5%200%200%201%2016.313%203c2.973%200%205.437%202.322%205.437%205.25%200%203.925-2.438%207.111-4.739%209.256a25.175%2025.175%200%200%201-4.244%203.17%2015.247%2015.247%200%200%201-.383.219l-.022.012-.007.004-.003.001a.752.752%200%200%201-.704%200l-.003-.001Z'%20/%3e%3c/svg%3e",nie="data:image/svg+xml,%3csvg%20width='30'%20height='26'%20viewBox='0%200%2030%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9.43398%200.519531C7.04842%200.519531%204.97388%202.15491%204.41692%204.47454L3.82415%206.94336C3.61485%207.81502%202.8353%208.42956%201.93886%208.42956H1.1432C0.511828%208.42956%200%208.94138%200%209.57276V10.1213C0%2010.4497%200.26624%2010.716%200.594663%2010.716C0.923086%2010.716%201.18933%2010.9822%201.18933%2011.3106V23.7748C1.18933%2024.7176%201.95362%2025.4819%202.89644%2025.4819H3.39499C4.06246%2025.4819%204.60355%2024.9408%204.60355%2024.2734C4.60355%2023.6059%205.14464%2023.0648%205.81211%2023.0648H24.1879C24.8554%2023.0648%2025.3965%2023.6059%2025.3965%2024.2734C25.3965%2024.9408%2025.9375%2025.4819%2026.605%2025.4819H27.1026C28.045%2025.4819%2028.8089%2024.718%2028.8089%2023.7757V11.3115C28.8089%2010.9826%2029.0755%2010.716%2029.4044%2010.716C29.7334%2010.716%2030%2010.4493%2030%2010.1204V9.57276C30%208.94138%2029.4882%208.42956%2028.8568%208.42956H28.0611C27.1647%208.42956%2026.3851%207.81502%2026.1758%206.94336L25.5831%204.47455C25.0261%202.15491%2022.9516%200.519531%2020.566%200.519531H9.43398ZM6.3784%202.05753H21.1095C22.5826%202.05753%2023.8637%203.06746%2024.2075%204.49991C24.6885%206.50344%2023.1699%208.42971%2021.1095%208.42971H8.88978C6.82933%208.42971%205.31075%206.50345%205.7917%204.49992L6.37791%202.05792C6.37796%202.05769%206.37817%202.05753%206.3784%202.05753ZM2.1772%2014.1881C2.1772%2013.4422%202.92028%2012.9244%203.61999%2013.1828L6.23786%2014.1496C6.65872%2014.305%206.9382%2014.7062%206.9382%2015.1548C6.9382%2015.9007%206.19512%2016.4184%205.49542%2016.16L2.87754%2015.1933C2.45668%2015.0378%202.1772%2014.6367%202.1772%2014.1881ZM26.3776%2013.1825C27.0774%2012.9243%2027.8204%2013.4421%2027.8204%2014.188C27.8204%2014.6367%2027.541%2015.0379%2027.1201%2015.1934L24.5052%2016.1594C23.8051%2016.4181%2023.0614%2015.9001%2023.0614%2015.1537C23.0614%2014.7047%2023.3412%2014.3032%2023.7624%2014.1477L26.3776%2013.1825ZM10.3958%2019.7689C10.3958%2019.1381%2010.9073%2018.6266%2011.5381%2018.6266H18.4584C19.0892%2018.6266%2019.6007%2019.1381%2019.6007%2019.7689C19.6007%2020.3998%2019.0892%2020.9112%2018.4584%2020.9112H11.5381C10.9072%2020.9112%2010.3958%2020.3998%2010.3958%2019.7689Z'%20fill='url(%23paint0_linear_1478_17766)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_17766'%20x1='10.6108'%20y1='3.85718'%20x2='14.2717'%20y2='25.6045'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20offset='0.0001'%20stop-color='%23fff'/%3e%3cstop%20offset='1'%20stop-color='%23fff'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",gTe="data:image/svg+xml,%3csvg%20width='30'%20height='27'%20viewBox='0%200%2030%2027'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M23.1209%2012.7698C23.2693%2013.028%2023.3474%2013.3207%2023.3474%2013.6186C23.3474%2013.9165%2023.2693%2014.2092%2023.1209%2014.4675L19.7823%2020.2271C19.6331%2020.4842%2019.4191%2020.6977%2019.1615%2020.8461C18.904%2020.9946%2018.612%2021.0728%2018.3147%2021.073L11.6733%2021.073C11.3781%2021.0707%2011.0886%2020.9915%2010.8333%2020.8432C10.578%2020.6948%2010.3659%2020.4825%2010.2177%2020.2271L6.87911%2014.4675C6.73069%2014.2092%206.65258%2013.9165%206.65258%2013.6186C6.65258%2013.3207%206.73069%2013.028%206.87911%2012.7698L8.72327%209.58956L12.8271%2016.6075C12.8946%2016.7277%2012.9933%2016.8274%2013.1126%2016.8963C13.232%2016.9652%2013.3677%2017.0007%2013.5055%2016.9991L16.4945%2016.9991C16.6323%2017.0007%2016.768%2016.9652%2016.8874%2016.8963C17.0067%2016.8274%2017.1054%2016.7277%2017.1729%2016.6075L18.6674%2013.9982C18.7351%2013.881%2018.7707%2013.748%2018.7707%2013.6126C18.7707%2013.4773%2018.7351%2013.3443%2018.6674%2013.2271L11.9304%201.5703C11.6966%201.16601%2011.3606%200.830295%2010.9562%200.596843C10.5517%200.363393%2010.0929%200.240408%209.62593%200.24023L9.02217%200.24023C8.48786%200.240028%207.96292%200.380525%207.50015%200.647588C7.03738%200.914653%206.65309%201.29887%206.38594%201.76159L0.408109%2012.1003C0.140762%2012.5627%20-6.08137e-07%2013.0874%20-5.84788e-07%2013.6216C-5.61439e-07%2014.1558%200.140762%2014.6805%200.408109%2015.143L6.38594%2025.4816C6.65347%2025.9438%207.03793%2026.3274%207.50067%2026.5939C7.96342%2026.8605%208.48816%2027.0005%209.02217%2027L20.9778%2027C21.5121%2027.0002%2022.0371%2026.8597%2022.4998%2026.5926C22.9626%2026.3256%2023.3469%2025.9414%2023.6141%2025.4786L29.5919%2015.14C29.8592%2014.6775%2030%2014.1528%2030%2013.6186C30%2013.0845%2029.8592%2012.5597%2029.5919%2012.0973L23.6141%201.7586C23.3469%201.29588%2022.9626%200.911664%2022.4998%200.644599C22.0371%200.377534%2021.5121%200.237039%2020.9778%200.237243L15.8967%200.237243L23.1209%2012.7698Z'%20fill='%23fff'/%3e%3c/svg%3e",vTe="data:image/svg+xml,%3csvg%20width='26'%20height='26'%20viewBox='0%200%2026%2026'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20opacity='0.4'%20d='M20.4578%206.19733L18.1703%203.90983C16.2391%201.97858%2015.2741%201.01233%2014.0203%200.653583C12.7666%200.293583%2011.4353%200.601083%208.77406%201.21608L7.23906%201.56983C4.99906%202.08608%203.87906%202.34483%203.11156%203.11108C2.34531%203.87858%202.08656%204.99858%201.57031%207.23858L1.21531%208.77358C0.601557%2011.4361%200.294057%2012.7661%200.652807%2014.0198C1.01281%2015.2736%201.97906%2016.2386%203.91031%2018.1698L6.19781%2020.4573C9.56031%2023.8211%2011.2403%2025.4998%2013.3278%2025.4998C15.4166%2025.4998%2017.0966%2023.8186%2020.4578%2020.4573C23.8216%2017.0961%2025.5003%2015.4161%2025.5003%2013.3273C25.5003%2011.2398%2023.8191%209.55858%2020.4578%206.19733Z'%20fill='%23fff'/%3e%3cpath%20d='M11.9333%2015.9103C11.0921%2015.0703%2011.0996%2013.8628%2011.6021%2012.9066C11.4774%2012.7264%2011.4197%2012.5083%2011.4391%2012.2901C11.4584%2012.0719%2011.5536%2011.8673%2011.7081%2011.7119C11.8625%2011.5566%2012.0666%2011.4602%2012.2847%2011.4396C12.5028%2011.419%2012.7212%2011.4754%2012.9021%2011.5991C13.3271%2011.3741%2013.7933%2011.2541%2014.2583%2011.2591C14.507%2011.2614%2014.7445%2011.3624%2014.9187%2011.5399C15.0929%2011.7173%2015.1894%2011.9567%2015.1871%2012.2053C15.1848%2012.454%2015.0838%2012.6915%2014.9063%2012.8657C14.7289%2013.0399%2014.4895%2013.1364%2014.2408%2013.1341C13.9514%2013.1448%2013.6779%2013.2692%2013.4796%2013.4803C12.9958%2013.9641%2013.1233%2014.4491%2013.2583%2014.5853C13.3958%2014.7216%2013.8796%2014.8478%2014.3633%2014.3641C15.3433%2013.3841%2017.0358%2013.0591%2018.1208%2014.1428C18.9621%2014.9841%2018.9546%2016.1916%2018.4508%2017.1478C18.5748%2017.328%2018.6318%2017.5458%2018.6121%2017.7636C18.5924%2017.9814%2018.4972%2018.1854%2018.3429%2018.3404C18.1887%2018.4954%2017.9851%2018.5916%2017.7674%2018.6124C17.5497%2018.6331%2017.3316%2018.5771%2017.1508%2018.4541C16.5899%2018.7617%2015.9392%2018.8643%2015.3108%2018.7441C15.1902%2018.7193%2015.0756%2018.671%2014.9736%2018.6019C14.8716%2018.5328%2014.7843%2018.4444%2014.7165%2018.3415C14.6487%2018.2387%2014.6018%2018.1235%2014.5785%2018.0025C14.5553%2017.8816%2014.5561%2017.7572%2014.5808%2017.6366C14.6056%2017.5159%2014.6539%2017.4013%2014.723%2017.2994C14.7921%2017.1974%2014.8806%2017.11%2014.9834%2017.0422C15.0862%2016.9744%2015.2014%2016.9276%2015.3224%2016.9043C15.4433%2016.881%2015.5677%2016.8818%2015.6883%2016.9066C15.9096%2016.9528%2016.2671%2016.8803%2016.5733%2016.5741C17.0583%2016.0891%2016.9308%2015.6053%2016.7946%2015.4691C16.6583%2015.3328%2016.1746%2015.2066%2015.6896%2015.6903C14.7096%2016.6703%2013.0171%2016.9953%2011.9333%2015.9103ZM10.5258%2010.8666C10.7646%2010.636%2010.9551%2010.3601%2011.0861%2010.0551C11.2171%209.75008%2011.2861%209.42203%2011.289%209.09008C11.2919%208.75813%2011.2286%208.42894%2011.1029%208.12169C10.9772%207.81445%2010.7916%207.53532%2010.5568%207.30059C10.3221%207.06586%2010.043%206.88023%209.73573%206.75453C9.42849%206.62882%209.09929%206.56557%208.76734%206.56845C8.43539%206.57134%208.10734%206.6403%207.80233%206.77133C7.49732%206.90235%207.22146%207.0928%206.99084%207.33158C6.53545%207.80309%206.28346%208.43459%206.28916%209.09008C6.29485%209.74558%206.55778%2010.3726%207.0213%2010.8361C7.48482%2011.2996%208.11185%2011.5626%208.76734%2011.5683C9.42283%2011.574%2010.0543%2011.322%2010.5258%2010.8666Z'%20fill='%23fff'/%3e%3c/svg%3e",_Te="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27.8333%2015C27.8333%2022.0877%2022.0877%2027.8333%2015%2027.8333C7.91234%2027.8333%202.16666%2022.0877%202.16666%2015C2.16666%207.91234%207.91234%202.16666%2015%202.16666C22.0877%202.16666%2027.8333%207.91234%2027.8333%2015ZM30%2015C30%2023.2843%2023.2843%2030%2015%2030C6.71573%2030%200%2023.2843%200%2015C0%206.71573%206.71573%200%2015%200C23.2843%200%2030%206.71573%2030%2015ZM23.2763%208.27633C23.2763%209.13333%2022.5816%209.82806%2021.7246%209.82806C20.8676%209.82806%2020.1729%209.13333%2020.1729%208.27633C20.1729%207.41934%2020.8676%206.72461%2021.7246%206.72461C22.5816%206.72461%2023.2763%207.41934%2023.2763%208.27633ZM10.4879%2016.2086C11.1556%2018.7005%2013.717%2020.1793%2016.2089%2019.5116C18.7008%2018.8439%2020.1796%2016.2825%2019.5119%2013.7906C18.8442%2011.2987%2016.2828%209.81989%2013.7909%2010.4876C11.299%2011.1553%209.82015%2013.7167%2010.4879%2016.2086ZM8.39503%2016.7694C9.37244%2020.4171%2013.1219%2022.5819%2016.7696%2021.6045C20.4174%2020.627%2022.5821%2016.8776%2021.6047%2013.2298C20.6273%209.58209%2016.8779%207.41735%2013.2301%208.39476C9.58236%209.37218%207.41762%2013.1216%208.39503%2016.7694Z'%20fill='url(%23paint0_linear_1478_19845)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_19845'%20x1='15'%20y1='0'%20x2='15'%20y2='30'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23fff'/%3e%3cstop%20offset='0.461458'%20stop-color='%23fff'/%3e%3cstop%20offset='1'%20stop-color='%23fff'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",yTe="/about_portfolio/assets/soundoff-B_dVLsfG.png",xTe="/about_portfolio/assets/soundon-4GJHmOjh.png",bTe="/about_portfolio/assets/summiz-B_i5HBJv.svg",wTe="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M27.8333%2015C27.8333%2022.0877%2022.0877%2027.8333%2015%2027.8333C7.91234%2027.8333%202.16666%2022.0877%202.16666%2015C2.16666%207.91234%207.91234%202.16666%2015%202.16666C22.0877%202.16666%2027.8333%207.91234%2027.8333%2015ZM30%2015C30%2023.2843%2023.2843%2030%2015%2030C6.71573%2030%200%2023.2843%200%2015C0%206.71573%206.71573%200%2015%200C23.2843%200%2030%206.71573%2030%2015ZM23.2763%208.27633C23.2763%209.13333%2022.5816%209.82806%2021.7246%209.82806C20.8676%209.82806%2020.1729%209.13333%2020.1729%208.27633C20.1729%207.41934%2020.8676%206.72461%2021.7246%206.72461C22.5816%206.72461%2023.2763%207.41934%2023.2763%208.27633ZM15.164%2012.8405L15.354%2010.3432L15.5183%208.18279C14.78%208.12663%2014.0416%208.19103%2013.3312%208.36978C12.7441%208.5175%2012.1761%208.74331%2011.643%209.0437C10.4647%209.7076%209.50982%2010.706%208.899%2011.9126C8.28818%2013.1192%208.04887%2014.4798%208.21134%2015.8224C8.37381%2017.165%208.93076%2018.4293%209.81176%2019.4553C10.6928%2020.4814%2011.8582%2021.2232%2013.1608%2021.5869C14.4634%2021.9506%2015.8446%2021.9198%2017.1297%2021.4986C18.4148%2021.0773%2019.5461%2020.2844%2020.3806%2019.2201C20.7582%2018.7386%2021.0673%2018.2113%2021.3021%2017.6533C21.5862%2016.9784%2021.7615%2016.2585%2021.8177%2015.5205L21.8178%2015.5196L19.6574%2015.3553L17.1601%2015.1653L14.9997%2015.0009L15.164%2012.8405ZM18.9617%2017.4752L14.8353%2017.1614L12.6749%2016.997L12.8392%2014.8366L13.1531%2010.7102C13.0009%2010.7757%2012.8519%2010.8495%2012.7066%2010.9313C11.9017%2011.3849%2011.2494%2012.0669%2010.8321%2012.8912C10.4148%2013.7154%2010.2513%2014.6449%2010.3623%2015.5621C10.4733%2016.4793%2010.8538%2017.343%2011.4556%2018.0439C12.0575%2018.7449%2012.8536%2019.2516%2013.7435%2019.5C14.6333%2019.7485%2015.5768%2019.7275%2016.4547%2019.4397C17.3327%2019.1519%2018.1055%2018.6103%2018.6756%2017.8832C18.7785%2017.752%2018.8739%2017.6158%2018.9617%2017.4752Z'%20fill='url(%23paint0_linear_1478_16881)'/%3e%3cdefs%3e%3clinearGradient%20id='paint0_linear_1478_16881'%20x1='15'%20y1='0'%20x2='15'%20y2='30'%20gradientUnits='userSpaceOnUse'%3e%3cstop%20stop-color='%23FFF'/%3e%3cstop%20offset='0.461458'%20stop-color='%23FFF'/%3e%3cstop%20offset='1'%20stop-color='%23FFF'/%3e%3c/linearGradient%3e%3c/defs%3e%3c/svg%3e",STe="/about_portfolio/assets/lllw1-Bb4i6zS6.png",ATe="/about_portfolio/assets/jssh-wN1B_wBU.png",TTe="/about_portfolio/assets/swm-BA91m20b.png",MTe="/about_portfolio/assets/ar-Cn-GxoY6.png",F$={type:"change"},MF={type:"start"},N$={type:"end"},D2=new xx,z$=new Mm,ETe=Math.cos(70*ra.DEG2RAD);class k0 extends xp{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Ze,this.cursor=new Ze,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:cy.ROTATE,MIDDLE:cy.DOLLY,RIGHT:cy.PAN},this.touches={ONE:uy.ROTATE,TWO:uy.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return l.phi},this.getAzimuthalAngle=function(){return l.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Fe){Fe.addEventListener("keydown",tr),this._domElementKeyEvents=Fe},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",tr),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(F$),r.update(),s=i.NONE},this.update=function(){const Fe=new Ze,Lt=new Mo().setFromUnitVectors(e.up,new Ze(0,1,0)),Kt=Lt.clone().invert(),un=new Ze,Cn=new Mo,Ar=new Ze,Vr=2*Math.PI;return function(Ls=null){const hi=r.object.position;Fe.copy(hi).sub(r.target),Fe.applyQuaternion(Lt),l.setFromVector3(Fe),r.autoRotate&&s===i.NONE&&Se(oe(Ls)),r.enableDamping?(l.theta+=a.theta*r.dampingFactor,l.phi+=a.phi*r.dampingFactor):(l.theta+=a.theta,l.phi+=a.phi);let Tt=r.minAzimuthAngle,xe=r.maxAzimuthAngle;isFinite(Tt)&&isFinite(xe)&&(Tt<-Math.PI?Tt+=Vr:Tt>Math.PI&&(Tt-=Vr),xe<-Math.PI?xe+=Vr:xe>Math.PI&&(xe-=Vr),Tt<=xe?l.theta=Math.max(Tt,Math.min(xe,l.theta)):l.theta=l.theta>(Tt+xe)/2?Math.max(Tt,l.theta):Math.min(xe,l.theta)),l.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,l.phi)),l.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(f,r.dampingFactor):r.target.add(f),r.target.sub(r.cursor),r.target.clampLength(r.minTargetRadius,r.maxTargetRadius),r.target.add(r.cursor);let Ce=!1;if(r.zoomToCursor&&Z||r.object.isOrthographicCamera)l.radius=Ue(l.radius);else{const Xe=l.radius;l.radius=Ue(l.radius*h),Ce=Xe!=l.radius}if(Fe.setFromSpherical(l),Fe.applyQuaternion(Kt),hi.copy(r.target).add(Fe),r.object.lookAt(r.target),r.enableDamping===!0?(a.theta*=1-r.dampingFactor,a.phi*=1-r.dampingFactor,f.multiplyScalar(1-r.dampingFactor)):(a.set(0,0,0),f.set(0,0,0)),r.zoomToCursor&&Z){let Xe=null;if(r.object.isPerspectiveCamera){const nt=Fe.length();Xe=Ue(nt*h);const Je=nt-Xe;r.object.position.addScaledVector(H,Je),r.object.updateMatrixWorld(),Ce=!!Je}else if(r.object.isOrthographicCamera){const nt=new Ze(X.x,X.y,0);nt.unproject(r.object);const Je=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),r.object.updateProjectionMatrix(),Ce=Je!==r.object.zoom;const pt=new Ze(X.x,X.y,0);pt.unproject(r.object),r.object.position.sub(pt).add(nt),r.object.updateMatrixWorld(),Xe=Fe.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;Xe!==null&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Xe).add(r.object.position):(D2.origin.copy(r.object.position),D2.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(D2.direction))<ETe?e.lookAt(r.target):(z$.setFromNormalAndCoplanarPoint(r.object.up,r.target),D2.intersectPlane(z$,r.target))))}else if(r.object.isOrthographicCamera){const Xe=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/h)),Xe!==r.object.zoom&&(r.object.updateProjectionMatrix(),Ce=!0)}return h=1,Z=!1,Ce||un.distanceToSquared(r.object.position)>o||8*(1-Cn.dot(r.object.quaternion))>o||Ar.distanceToSquared(r.target)>o?(r.dispatchEvent(F$),un.copy(r.object.position),Cn.copy(r.object.quaternion),Ar.copy(r.target),!0):!1}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",ir),r.domElement.removeEventListener("pointerdown",sn),r.domElement.removeEventListener("pointercancel",Ge),r.domElement.removeEventListener("wheel",Sn),r.domElement.removeEventListener("pointermove",ot),r.domElement.removeEventListener("pointerup",Ge),r.domElement.getRootNode().removeEventListener("keydown",mr,{capture:!0}),r._domElementKeyEvents!==null&&(r._domElementKeyEvents.removeEventListener("keydown",tr),r._domElementKeyEvents=null)};const r=this,i={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=i.NONE;const o=1e-6,l=new hM,a=new hM;let h=1;const f=new Ze,p=new nn,v=new nn,y=new nn,S=new nn,C=new nn,M=new nn,E=new nn,L=new nn,k=new nn,H=new Ze,X=new nn;let Z=!1;const Q=[],re={};let ie=!1;function oe(Fe){return Fe!==null?2*Math.PI/60*r.autoRotateSpeed*Fe:2*Math.PI/60/60*r.autoRotateSpeed}function fe(Fe){const Lt=Math.abs(Fe*.01);return Math.pow(.95,r.zoomSpeed*Lt)}function Se(Fe){a.theta-=Fe}function Ee(Fe){a.phi-=Fe}const Ie=function(){const Fe=new Ze;return function(Kt,un){Fe.setFromMatrixColumn(un,0),Fe.multiplyScalar(-Kt),f.add(Fe)}}(),He=function(){const Fe=new Ze;return function(Kt,un){r.screenSpacePanning===!0?Fe.setFromMatrixColumn(un,1):(Fe.setFromMatrixColumn(un,0),Fe.crossVectors(r.object.up,Fe)),Fe.multiplyScalar(Kt),f.add(Fe)}}(),Re=function(){const Fe=new Ze;return function(Kt,un){const Cn=r.domElement;if(r.object.isPerspectiveCamera){const Ar=r.object.position;Fe.copy(Ar).sub(r.target);let Vr=Fe.length();Vr*=Math.tan(r.object.fov/2*Math.PI/180),Ie(2*Kt*Vr/Cn.clientHeight,r.object.matrix),He(2*un*Vr/Cn.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(Ie(Kt*(r.object.right-r.object.left)/r.object.zoom/Cn.clientWidth,r.object.matrix),He(un*(r.object.top-r.object.bottom)/r.object.zoom/Cn.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function st(Fe){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?h/=Fe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function _e(Fe){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?h*=Fe:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function We(Fe,Lt){if(!r.zoomToCursor)return;Z=!0;const Kt=r.domElement.getBoundingClientRect(),un=Fe-Kt.left,Cn=Lt-Kt.top,Ar=Kt.width,Vr=Kt.height;X.x=un/Ar*2-1,X.y=-(Cn/Vr)*2+1,H.set(X.x,X.y,1).unproject(r.object).sub(r.object.position).normalize()}function Ue(Fe){return Math.max(r.minDistance,Math.min(r.maxDistance,Fe))}function vt(Fe){p.set(Fe.clientX,Fe.clientY)}function xt(Fe){We(Fe.clientX,Fe.clientX),E.set(Fe.clientX,Fe.clientY)}function Vt(Fe){S.set(Fe.clientX,Fe.clientY)}function lt(Fe){v.set(Fe.clientX,Fe.clientY),y.subVectors(v,p).multiplyScalar(r.rotateSpeed);const Lt=r.domElement;Se(2*Math.PI*y.x/Lt.clientHeight),Ee(2*Math.PI*y.y/Lt.clientHeight),p.copy(v),r.update()}function Ht(Fe){L.set(Fe.clientX,Fe.clientY),k.subVectors(L,E),k.y>0?st(fe(k.y)):k.y<0&&_e(fe(k.y)),E.copy(L),r.update()}function Qt(Fe){C.set(Fe.clientX,Fe.clientY),M.subVectors(C,S).multiplyScalar(r.panSpeed),Re(M.x,M.y),S.copy(C),r.update()}function rn(Fe){We(Fe.clientX,Fe.clientY),Fe.deltaY<0?_e(fe(Fe.deltaY)):Fe.deltaY>0&&st(fe(Fe.deltaY)),r.update()}function jn(Fe){let Lt=!1;switch(Fe.code){case r.keys.UP:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Ee(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(0,r.keyPanSpeed),Lt=!0;break;case r.keys.BOTTOM:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Ee(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(0,-r.keyPanSpeed),Lt=!0;break;case r.keys.LEFT:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Se(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(r.keyPanSpeed,0),Lt=!0;break;case r.keys.RIGHT:Fe.ctrlKey||Fe.metaKey||Fe.shiftKey?Se(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):Re(-r.keyPanSpeed,0),Lt=!0;break}Lt&&(Fe.preventDefault(),r.update())}function Bn(Fe){if(Q.length===1)p.set(Fe.pageX,Fe.pageY);else{const Lt=Hr(Fe),Kt=.5*(Fe.pageX+Lt.x),un=.5*(Fe.pageY+Lt.y);p.set(Kt,un)}}function Tn(Fe){if(Q.length===1)S.set(Fe.pageX,Fe.pageY);else{const Lt=Hr(Fe),Kt=.5*(Fe.pageX+Lt.x),un=.5*(Fe.pageY+Lt.y);S.set(Kt,un)}}function Le(Fe){const Lt=Hr(Fe),Kt=Fe.pageX-Lt.x,un=Fe.pageY-Lt.y,Cn=Math.sqrt(Kt*Kt+un*un);E.set(0,Cn)}function qe(Fe){r.enableZoom&&Le(Fe),r.enablePan&&Tn(Fe)}function mn(Fe){r.enableZoom&&Le(Fe),r.enableRotate&&Bn(Fe)}function cn(Fe){if(Q.length==1)v.set(Fe.pageX,Fe.pageY);else{const Kt=Hr(Fe),un=.5*(Fe.pageX+Kt.x),Cn=.5*(Fe.pageY+Kt.y);v.set(un,Cn)}y.subVectors(v,p).multiplyScalar(r.rotateSpeed);const Lt=r.domElement;Se(2*Math.PI*y.x/Lt.clientHeight),Ee(2*Math.PI*y.y/Lt.clientHeight),p.copy(v)}function St(Fe){if(Q.length===1)C.set(Fe.pageX,Fe.pageY);else{const Lt=Hr(Fe),Kt=.5*(Fe.pageX+Lt.x),un=.5*(Fe.pageY+Lt.y);C.set(Kt,un)}M.subVectors(C,S).multiplyScalar(r.panSpeed),Re(M.x,M.y),S.copy(C)}function Jt(Fe){const Lt=Hr(Fe),Kt=Fe.pageX-Lt.x,un=Fe.pageY-Lt.y,Cn=Math.sqrt(Kt*Kt+un*un);L.set(0,Cn),k.set(0,Math.pow(L.y/E.y,r.zoomSpeed)),st(k.y),E.copy(L);const Ar=(Fe.pageX+Lt.x)*.5,Vr=(Fe.pageY+Lt.y)*.5;We(Ar,Vr)}function kn(Fe){r.enableZoom&&Jt(Fe),r.enablePan&&St(Fe)}function Gn(Fe){r.enableZoom&&Jt(Fe),r.enableRotate&&cn(Fe)}function sn(Fe){r.enabled!==!1&&(Q.length===0&&(r.domElement.setPointerCapture(Fe.pointerId),r.domElement.addEventListener("pointermove",ot),r.domElement.addEventListener("pointerup",Ge)),!ar(Fe)&&(ui(Fe),Fe.pointerType==="touch"?Sr(Fe):Xt(Fe)))}function ot(Fe){r.enabled!==!1&&(Fe.pointerType==="touch"?Ln(Fe):An(Fe))}function Ge(Fe){switch(Fr(Fe),Q.length){case 0:r.domElement.releasePointerCapture(Fe.pointerId),r.domElement.removeEventListener("pointermove",ot),r.domElement.removeEventListener("pointerup",Ge),r.dispatchEvent(N$),s=i.NONE;break;case 1:const Lt=Q[0],Kt=re[Lt];Sr({pointerId:Lt,pageX:Kt.x,pageY:Kt.y});break}}function Xt(Fe){let Lt;switch(Fe.button){case 0:Lt=r.mouseButtons.LEFT;break;case 1:Lt=r.mouseButtons.MIDDLE;break;case 2:Lt=r.mouseButtons.RIGHT;break;default:Lt=-1}switch(Lt){case cy.DOLLY:if(r.enableZoom===!1)return;xt(Fe),s=i.DOLLY;break;case cy.ROTATE:if(Fe.ctrlKey||Fe.metaKey||Fe.shiftKey){if(r.enablePan===!1)return;Vt(Fe),s=i.PAN}else{if(r.enableRotate===!1)return;vt(Fe),s=i.ROTATE}break;case cy.PAN:if(Fe.ctrlKey||Fe.metaKey||Fe.shiftKey){if(r.enableRotate===!1)return;vt(Fe),s=i.ROTATE}else{if(r.enablePan===!1)return;Vt(Fe),s=i.PAN}break;default:s=i.NONE}s!==i.NONE&&r.dispatchEvent(MF)}function An(Fe){switch(s){case i.ROTATE:if(r.enableRotate===!1)return;lt(Fe);break;case i.DOLLY:if(r.enableZoom===!1)return;Ht(Fe);break;case i.PAN:if(r.enablePan===!1)return;Qt(Fe);break}}function Sn(Fe){r.enabled===!1||r.enableZoom===!1||s!==i.NONE||(Fe.preventDefault(),r.dispatchEvent(MF),rn(jt(Fe)),r.dispatchEvent(N$))}function jt(Fe){const Lt=Fe.deltaMode,Kt={clientX:Fe.clientX,clientY:Fe.clientY,deltaY:Fe.deltaY};switch(Lt){case 1:Kt.deltaY*=16;break;case 2:Kt.deltaY*=100;break}return Fe.ctrlKey&&!ie&&(Kt.deltaY*=10),Kt}function mr(Fe){Fe.key==="Control"&&(ie=!0,r.domElement.getRootNode().addEventListener("keyup",Un,{passive:!0,capture:!0}))}function Un(Fe){Fe.key==="Control"&&(ie=!1,r.domElement.getRootNode().removeEventListener("keyup",Un,{passive:!0,capture:!0}))}function tr(Fe){r.enabled===!1||r.enablePan===!1||jn(Fe)}function Sr(Fe){switch(Nr(Fe),Q.length){case 1:switch(r.touches.ONE){case uy.ROTATE:if(r.enableRotate===!1)return;Bn(Fe),s=i.TOUCH_ROTATE;break;case uy.PAN:if(r.enablePan===!1)return;Tn(Fe),s=i.TOUCH_PAN;break;default:s=i.NONE}break;case 2:switch(r.touches.TWO){case uy.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;qe(Fe),s=i.TOUCH_DOLLY_PAN;break;case uy.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;mn(Fe),s=i.TOUCH_DOLLY_ROTATE;break;default:s=i.NONE}break;default:s=i.NONE}s!==i.NONE&&r.dispatchEvent(MF)}function Ln(Fe){switch(Nr(Fe),s){case i.TOUCH_ROTATE:if(r.enableRotate===!1)return;cn(Fe),r.update();break;case i.TOUCH_PAN:if(r.enablePan===!1)return;St(Fe),r.update();break;case i.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;kn(Fe),r.update();break;case i.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Gn(Fe),r.update();break;default:s=i.NONE}}function ir(Fe){r.enabled!==!1&&Fe.preventDefault()}function ui(Fe){Q.push(Fe.pointerId)}function Fr(Fe){delete re[Fe.pointerId];for(let Lt=0;Lt<Q.length;Lt++)if(Q[Lt]==Fe.pointerId){Q.splice(Lt,1);return}}function ar(Fe){for(let Lt=0;Lt<Q.length;Lt++)if(Q[Lt]==Fe.pointerId)return!0;return!1}function Nr(Fe){let Lt=re[Fe.pointerId];Lt===void 0&&(Lt=new nn,re[Fe.pointerId]=Lt),Lt.set(Fe.pageX,Fe.pageY)}function Hr(Fe){const Lt=Fe.pointerId===Q[0]?Q[1]:Q[0];return re[Lt]}r.domElement.addEventListener("contextmenu",ir),r.domElement.addEventListener("pointerdown",sn),r.domElement.addEventListener("pointercancel",Ge),r.domElement.addEventListener("wheel",Sn,{passive:!1}),r.domElement.getRootNode().addEventListener("keydown",mr,{passive:!0,capture:!0}),this.update()}}const CTe="/about_portfolio/assets/clouds-IEtJOhG3.jpeg",ITe="/about_portfolio/assets/earth_basic-BA2kNn0Z.jpeg",RTe="/about_portfolio/assets/earth_normal-BhhqUxiB.jpeg",PTe="/about_portfolio/assets/earth_rough-BHPkAlB2.jpeg",LTe="/about_portfolio/assets/moon_basic-B595DPb7.jpeg",DTe="/about_portfolio/assets/moon_normal-BoJTEBW0.jpeg",BTe="/about_portfolio/assets/moon_roughness-BDXd91JJ.jpeg";var aT=function(){var n=0,e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",e.addEventListener("click",function(f){f.preventDefault(),r(++n%e.children.length)},!1);function t(f){return e.appendChild(f.dom),f}function r(f){for(var p=0;p<e.children.length;p++)e.children[p].style.display=p===f?"block":"none";n=f}var i=(performance||Date).now(),s=i,o=0,l=t(new aT.Panel("FPS","#0ff","#002")),a=t(new aT.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=t(new aT.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:e,addPanel:t,showPanel:r,begin:function(){i=(performance||Date).now()},end:function(){o++;var f=(performance||Date).now();if(a.update(f-i,200),f>=s+1e3&&(l.update(o*1e3/(f-s),100),s=f,o=0,h)){var p=performance.memory;h.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return f},update:function(){i=this.end()},domElement:e,setMode:r}};aT.Panel=function(n,e,t){var r=1/0,i=0,s=Math.round,o=s(window.devicePixelRatio||1),l=80*o,a=48*o,h=3*o,f=2*o,p=3*o,v=15*o,y=74*o,S=30*o,C=document.createElement("canvas");C.width=l,C.height=a,C.style.cssText="width:80px;height:48px";var M=C.getContext("2d");return M.font="bold "+9*o+"px Helvetica,Arial,sans-serif",M.textBaseline="top",M.fillStyle=t,M.fillRect(0,0,l,a),M.fillStyle=e,M.fillText(n,h,f),M.fillRect(p,v,y,S),M.fillStyle=t,M.globalAlpha=.9,M.fillRect(p,v,y,S),{dom:C,update:function(E,L){r=Math.min(r,E),i=Math.max(i,E),M.fillStyle=t,M.globalAlpha=1,M.fillRect(0,0,l,v),M.fillStyle=e,M.fillText(s(E)+" "+n+" ("+s(r)+"-"+s(i)+")",h,f),M.drawImage(C,p+o,v,y-o,S,p,v,y-o,S),M.fillRect(p+y-o,v,o,S),M.fillStyle=t,M.globalAlpha=.9,M.fillRect(p+y-o,v,o,s((1-E/L)*S))}}};const kTe=()=>{const n=Ae.useRef(null),e=Ae.useRef(null),t=Ae.useRef(null),r=Ae.useRef(null),i=Ae.useRef(null),s=Ae.useRef(null),o=Ae.useRef(null),l=Ae.useRef(null);let a=null,h=null,f=null,p=null,v=new Qf;Ae.useEffect(()=>(S(),a=new aT,a.showPanel(0),document.body.appendChild(a.dom),window.addEventListener("resize",y),()=>{document.body.removeChild(a.dom),window.removeEventListener("resize",y)}),[]);const y=()=>{r.current&&e.current&&(r.current.aspect=window.innerWidth/window.innerHeight,r.current.updateProjectionMatrix(),e.current.setSize(window.innerWidth,window.innerHeight))},S=()=>{const H=new Jl({canvas:n.current,antialias:!0});H.setPixelRatio(window.devicePixelRatio),H.setSize(window.innerWidth,window.innerHeight),H.setPixelRatio(Math.min(window.devicePixelRatio,2)),H.shadowMap.enabled=!0,H.toneMapping=aD,e.current=H;const X=new Ml;t.current=X;const Z=96,Q=window.innerWidth/window.innerHeight,re=new nd(-Z*Q,Z*Q,Z,-Z,1,1e3);re.position.set(0,20,200),re.lookAt(new Ze(0,0,0)),r.current=re;const ie=new k0(re,H.domElement);ie.enableDamping=!0,i.current=ie,C(X),M(X),E(X),k()},C=H=>{const X=new B0(16777215,1.2);X.position.set(-10,10,5),X.castShadow=!0,X.shadow.mapSize.width=512,X.shadow.mapSize.height=512,X.shadow.camera.top=10,X.shadow.camera.bottom=-5,X.shadow.camera.left=-5,X.shadow.camera.right=10,H.add(X);const Z=new Tx(16777215,.8);H.add(Z)},M=H=>{h=new ql;const X=new Ri(new Nm(10,64,64),new mp({map:v.load(ITe),normalMap:v.load(RTe),roughnessMap:v.load(PTe),normalScale:new nn(10,10),metalness:.1}));X.rotation.y=-Math.PI,p=new Ri(new Nm(10.6,64,64),new oE({alphaMap:v.load(CTe),transparent:!0,opacity:.4,depthTest:!0})),h.add(X),l.current=p,h.add(p),h.scale.set(6,6,6),o.current=h,H.add(h)},E=H=>{f=new Ri(new Nm(2,32,32),new mp({map:v.load(LTe),normalMap:v.load(DTe),roughnessMap:v.load(BTe),normalScale:new nn(10,10),metalness:.1})),f.position.set(-120,0,-120),f.scale.set(6,6,6),s.current=f,H.add(f)},L=new sg,k=()=>{if(!e.current||!t.current||!r.current)return;const H=L.getElapsedTime();h&&(h.rotation.y+=.002),p&&(p.rotation.y+=.004),p&&(p.rotation.x+=.002),a&&a.update(),i.current&&i.current.update(),f&&(f.position.x=Math.sin(H*.5)*-120),f&&(f.position.z=Math.cos(H*.5)*-120),e.current.render(t.current,r.current),requestAnimationFrame(k)};return me.jsx("div",{className:"earth_page",children:me.jsx("canvas",{ref:n,className:"webgl"})})};function OTe(n){if(!(typeof window>"u")){var e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=n,document.head.appendChild(e),n}}function Sb(n,e){var t=n.__state.conversionName.toString(),r=Math.round(n.r),i=Math.round(n.g),s=Math.round(n.b),o=n.a,l=Math.round(n.h),a=n.s.toFixed(1),h=n.v.toFixed(1);if(e||t==="THREE_CHAR_HEX"||t==="SIX_CHAR_HEX"){for(var f=n.hex.toString(16);f.length<6;)f="0"+f;return"#"+f}else{if(t==="CSS_RGB")return"rgb("+r+","+i+","+s+")";if(t==="CSS_RGBA")return"rgba("+r+","+i+","+s+","+o+")";if(t==="HEX")return"0x"+n.hex.toString(16);if(t==="RGB_ARRAY")return"["+r+","+i+","+s+"]";if(t==="RGBA_ARRAY")return"["+r+","+i+","+s+","+o+"]";if(t==="RGB_OBJ")return"{r:"+r+",g:"+i+",b:"+s+"}";if(t==="RGBA_OBJ")return"{r:"+r+",g:"+i+",b:"+s+",a:"+o+"}";if(t==="HSV_OBJ")return"{h:"+l+",s:"+a+",v:"+h+"}";if(t==="HSVA_OBJ")return"{h:"+l+",s:"+a+",v:"+h+",a:"+o+"}"}return"unknown format"}var U$=Array.prototype.forEach,$S=Array.prototype.slice,Pn={BREAK:{},extend:function(e){return this.each($S.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach((function(i){this.isUndefined(t[i])||(e[i]=t[i])}).bind(this))},this),e},defaults:function(e){return this.each($S.call(arguments,1),function(t){var r=this.isObject(t)?Object.keys(t):[];r.forEach((function(i){this.isUndefined(e[i])&&(e[i]=t[i])}).bind(this))},this),e},compose:function(){var e=$S.call(arguments);return function(){for(var t=$S.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,t,r){if(e){if(U$&&e.forEach&&e.forEach===U$)e.forEach(t,r);else if(e.length===e.length+0){var i=void 0,s=void 0;for(i=0,s=e.length;i<s;i++)if(i in e&&t.call(r,e[i],i)===this.BREAK)return}else for(var o in e)if(t.call(r,e[o],o)===this.BREAK)return}},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var i=void 0;return function(){var s=this,o=arguments;function l(){i=null,r||e.apply(s,o)}var a=r||!i;clearTimeout(i),i=setTimeout(l,t),a&&e.apply(s,o)}},toArray:function(e){return e.toArray?e.toArray():$S.call(e)},isUndefined:function(e){return e===void 0},isNull:function(e){return e===null},isNaN:function(n){function e(t){return n.apply(this,arguments)}return e.toString=function(){return n.toString()},e}(function(n){return isNaN(n)}),isArray:Array.isArray||function(n){return n.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return e===!1||e===!0},isFunction:function(e){return e instanceof Function}},FTe=[{litmus:Pn.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Sb},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return t===null?!1:{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Sb},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Sb},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return t===null?!1:{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Sb}}},{litmus:Pn.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Pn.isArray,conversions:{RGB_ARRAY:{read:function(e){return e.length!==3?!1:{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return e.length!==4?!1:{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Pn.isObject,conversions:{RGBA_OBJ:{read:function(e){return Pn.isNumber(e.r)&&Pn.isNumber(e.g)&&Pn.isNumber(e.b)&&Pn.isNumber(e.a)?{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return Pn.isNumber(e.r)&&Pn.isNumber(e.g)&&Pn.isNumber(e.b)?{space:"RGB",r:e.r,g:e.g,b:e.b}:!1},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return Pn.isNumber(e.h)&&Pn.isNumber(e.s)&&Pn.isNumber(e.v)&&Pn.isNumber(e.a)?{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return Pn.isNumber(e.h)&&Pn.isNumber(e.s)&&Pn.isNumber(e.v)?{space:"HSV",h:e.h,s:e.s,v:e.v}:!1},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],XS=void 0,B2=void 0,ez=function(){B2=!1;var e=arguments.length>1?Pn.toArray(arguments):arguments[0];return Pn.each(FTe,function(t){if(t.litmus(e))return Pn.each(t.conversions,function(r,i){if(XS=r.read(e),B2===!1&&XS!==!1)return B2=XS,XS.conversionName=i,XS.conversion=r,Pn.BREAK}),Pn.BREAK}),B2},G$=void 0,PP={hsv_to_rgb:function(e,t,r){var i=Math.floor(e/60)%6,s=e/60-Math.floor(e/60),o=r*(1-t),l=r*(1-s*t),a=r*(1-(1-s)*t),h=[[r,a,o],[l,r,o],[o,r,a],[o,l,r],[a,o,r],[r,o,l]][i];return{r:h[0]*255,g:h[1]*255,b:h[2]*255}},rgb_to_hsv:function(e,t,r){var i=Math.min(e,t,r),s=Math.max(e,t,r),o=s-i,l=void 0,a=void 0;if(s!==0)a=o/s;else return{h:NaN,s:0,v:0};return e===s?l=(t-r)/o:t===s?l=2+(r-e)/o:l=4+(e-t)/o,l/=6,l<0&&(l+=1),{h:l*360,s:a,v:s/255}},rgb_to_hex:function(e,t,r){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,t),i=this.hex_with_component(i,0,r),i},component_from_hex:function(e,t){return e>>t*8&255},hex_with_component:function(e,t,r){return r<<(G$=t*8)|e&~(255<<G$)}},NTe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},sd=function(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")},ad=function(){function n(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),g0=function n(e,t,r){e===null&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(i===void 0){var s=Object.getPrototypeOf(e);return s===null?void 0:n(s,t,r)}else{if("value"in i)return i.value;var o=i.get;return o===void 0?void 0:o.call(r)}},O0=function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)},F0=function(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n},al=function(){function n(){if(sd(this,n),this.__state=ez.apply(this,arguments),this.__state===!1)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return ad(n,[{key:"toString",value:function(){return Sb(this)}},{key:"toHexString",value:function(){return Sb(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),n}();function N6(n,e,t){Object.defineProperty(n,e,{get:function(){return this.__state.space==="RGB"?this.__state[e]:(al.recalculateRGB(this,e,t),this.__state[e])},set:function(i){this.__state.space!=="RGB"&&(al.recalculateRGB(this,e,t),this.__state.space="RGB"),this.__state[e]=i}})}function z6(n,e){Object.defineProperty(n,e,{get:function(){return this.__state.space==="HSV"?this.__state[e]:(al.recalculateHSV(this),this.__state[e])},set:function(r){this.__state.space!=="HSV"&&(al.recalculateHSV(this),this.__state.space="HSV"),this.__state[e]=r}})}al.recalculateRGB=function(n,e,t){if(n.__state.space==="HEX")n.__state[e]=PP.component_from_hex(n.__state.hex,t);else if(n.__state.space==="HSV")Pn.extend(n.__state,PP.hsv_to_rgb(n.__state.h,n.__state.s,n.__state.v));else throw new Error("Corrupted color state")};al.recalculateHSV=function(n){var e=PP.rgb_to_hsv(n.r,n.g,n.b);Pn.extend(n.__state,{s:e.s,v:e.v}),Pn.isNaN(e.h)?Pn.isUndefined(n.__state.h)&&(n.__state.h=0):n.__state.h=e.h};al.COMPONENTS=["r","g","b","h","s","v","hex","a"];N6(al.prototype,"r",2);N6(al.prototype,"g",1);N6(al.prototype,"b",0);z6(al.prototype,"h");z6(al.prototype,"s");z6(al.prototype,"v");Object.defineProperty(al.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}});Object.defineProperty(al.prototype,"hex",{get:function(){return this.__state.space!=="HEX"&&(this.__state.hex=PP.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Ex=function(){function n(e,t){sd(this,n),this.initialValue=e[t],this.domElement=document.createElement("div"),this.object=e,this.property=t,this.__onChange=void 0,this.__onFinishChange=void 0}return ad(n,[{key:"onChange",value:function(t){return this.__onChange=t,this}},{key:"onFinishChange",value:function(t){return this.__onFinishChange=t,this}},{key:"setValue",value:function(t){return this.object[this.property]=t,this.__onChange&&this.__onChange.call(this,t),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),n}(),zTe={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},rie={};Pn.each(zTe,function(n,e){Pn.each(n,function(t){rie[t]=e})});var UTe=/(\d+(\.\d+)?)px/;function jd(n){if(n==="0"||Pn.isUndefined(n))return 0;var e=n.match(UTe);return Pn.isNull(e)?0:parseFloat(e[1])}var on={makeSelectable:function(e,t){e===void 0||e.style===void 0||(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var i=r,s=t;Pn.isUndefined(s)&&(s=!0),Pn.isUndefined(i)&&(i=!0),e.style.position="absolute",s&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,i){var s=r||{},o=rie[t];if(!o)throw new Error("Event type "+t+" not supported.");var l=document.createEvent(o);switch(o){case"MouseEvents":{var a=s.x||s.clientX||0,h=s.y||s.clientY||0;l.initMouseEvent(t,s.bubbles||!1,s.cancelable||!0,window,s.clickCount||1,0,0,a,h,!1,!1,!1,!1,0,null);break}case"KeyboardEvents":{var f=l.initKeyboardEvent||l.initKeyEvent;Pn.defaults(s,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),f(t,s.bubbles||!1,s.cancelable,window,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.keyCode,s.charCode);break}default:{l.initEvent(t,s.bubbles||!1,s.cancelable||!0);break}}Pn.defaults(l,i),e.dispatchEvent(l)},bind:function(e,t,r,i){var s=i||!1;return e.addEventListener?e.addEventListener(t,r,s):e.attachEvent&&e.attachEvent("on"+t,r),on},unbind:function(e,t,r,i){var s=i||!1;return e.removeEventListener?e.removeEventListener(t,r,s):e.detachEvent&&e.detachEvent("on"+t,r),on},addClass:function(e,t){if(e.className===void 0)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);r.indexOf(t)===-1&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return on},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),i=r.indexOf(t);i!==-1&&(r.splice(i,1),e.className=r.join(" "))}else e.className=void 0;return on},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return jd(t["border-left-width"])+jd(t["border-right-width"])+jd(t["padding-left"])+jd(t["padding-right"])+jd(t.width)},getHeight:function(e){var t=getComputedStyle(e);return jd(t["border-top-width"])+jd(t["border-bottom-width"])+jd(t["padding-top"])+jd(t["padding-bottom"])+jd(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent;while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},iie=function(n){O0(e,n);function e(t,r){sd(this,e);var i=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),s=i;i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox");function o(){s.setValue(!s.__prev)}return on.bind(i.__checkbox,"change",o,!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return ad(e,[{key:"setValue",value:function(r){var i=g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),i}},{key:"updateDisplay",value:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Ex),GTe=function(n){O0(e,n);function e(t,r,i){sd(this,e);var s=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),o=i,l=s;if(s.__select=document.createElement("select"),Pn.isArray(o)){var a={};Pn.each(o,function(h){a[h]=h}),o=a}return Pn.each(o,function(h,f){var p=document.createElement("option");p.innerHTML=f,p.setAttribute("value",h),l.__select.appendChild(p)}),s.updateDisplay(),on.bind(s.__select,"change",function(){var h=this.options[this.selectedIndex].value;l.setValue(h)}),s.domElement.appendChild(s.__select),s}return ad(e,[{key:"setValue",value:function(r){var i=g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,r);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),i}},{key:"updateDisplay",value:function(){return on.isActive(this.__select)?this:(this.__select.value=this.getValue(),g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this))}}]),e}(Ex),VTe=function(n){O0(e,n);function e(t,r){sd(this,e);var i=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),s=i;function o(){s.setValue(s.__input.value)}function l(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),on.bind(i.__input,"keyup",o),on.bind(i.__input,"change",o),on.bind(i.__input,"blur",l),on.bind(i.__input,"keydown",function(a){a.keyCode===13&&this.blur()}),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return ad(e,[{key:"updateDisplay",value:function(){return on.isActive(this.__input)||(this.__input.value=this.getValue()),g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(Ex);function V$(n){var e=n.toString();return e.indexOf(".")>-1?e.length-e.indexOf(".")-1:0}var sie=function(n){O0(e,n);function e(t,r,i){sd(this,e);var s=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),o=i||{};return s.__min=o.min,s.__max=o.max,s.__step=o.step,Pn.isUndefined(s.__step)?s.initialValue===0?s.__impliedStep=1:s.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(s.initialValue))/Math.LN10))/10:s.__impliedStep=s.__step,s.__precision=V$(s.__impliedStep),s}return ad(e,[{key:"setValue",value:function(r){var i=r;return this.__min!==void 0&&i<this.__min?i=this.__min:this.__max!==void 0&&i>this.__max&&(i=this.__max),this.__step!==void 0&&i%this.__step!==0&&(i=Math.round(i/this.__step)*this.__step),g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setValue",this).call(this,i)}},{key:"min",value:function(r){return this.__min=r,this}},{key:"max",value:function(r){return this.__max=r,this}},{key:"step",value:function(r){return this.__step=r,this.__impliedStep=r,this.__precision=V$(r),this}}]),e}(Ex);function HTe(n,e){var t=Math.pow(10,e);return Math.round(n*t)/t}var LP=function(n){O0(e,n);function e(t,r,i){sd(this,e);var s=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,i));s.__truncationSuspended=!1;var o=s,l=void 0;function a(){var S=parseFloat(o.__input.value);Pn.isNaN(S)||o.setValue(S)}function h(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function f(){h()}function p(S){var C=l-S.clientY;o.setValue(o.getValue()+C*o.__impliedStep),l=S.clientY}function v(){on.unbind(window,"mousemove",p),on.unbind(window,"mouseup",v),h()}function y(S){on.bind(window,"mousemove",p),on.bind(window,"mouseup",v),l=S.clientY}return s.__input=document.createElement("input"),s.__input.setAttribute("type","text"),on.bind(s.__input,"change",a),on.bind(s.__input,"blur",f),on.bind(s.__input,"mousedown",y),on.bind(s.__input,"keydown",function(S){S.keyCode===13&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,h())}),s.updateDisplay(),s.domElement.appendChild(s.__input),s}return ad(e,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():HTe(this.getValue(),this.__precision),g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(sie);function H$(n,e,t,r,i){return r+(i-r)*((n-e)/(t-e))}var tz=function(n){O0(e,n);function e(t,r,i,s,o){sd(this,e);var l=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r,{min:i,max:s,step:o})),a=l;l.__background=document.createElement("div"),l.__foreground=document.createElement("div"),on.bind(l.__background,"mousedown",h),on.bind(l.__background,"touchstart",v),on.addClass(l.__background,"slider"),on.addClass(l.__foreground,"slider-fg");function h(C){document.activeElement.blur(),on.bind(window,"mousemove",f),on.bind(window,"mouseup",p),f(C)}function f(C){C.preventDefault();var M=a.__background.getBoundingClientRect();return a.setValue(H$(C.clientX,M.left,M.right,a.__min,a.__max)),!1}function p(){on.unbind(window,"mousemove",f),on.unbind(window,"mouseup",p),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}function v(C){C.touches.length===1&&(on.bind(window,"touchmove",y),on.bind(window,"touchend",S),y(C))}function y(C){var M=C.touches[0].clientX,E=a.__background.getBoundingClientRect();a.setValue(H$(M,E.left,E.right,a.__min,a.__max))}function S(){on.unbind(window,"touchmove",y),on.unbind(window,"touchend",S),a.__onFinishChange&&a.__onFinishChange.call(a,a.getValue())}return l.updateDisplay(),l.__background.appendChild(l.__foreground),l.domElement.appendChild(l.__background),l}return ad(e,[{key:"updateDisplay",value:function(){var r=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=r*100+"%",g0(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"updateDisplay",this).call(this)}}]),e}(sie),aie=function(n){O0(e,n);function e(t,r,i){sd(this,e);var s=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r)),o=s;return s.__button=document.createElement("div"),s.__button.innerHTML=i===void 0?"Fire":i,on.bind(s.__button,"click",function(l){return l.preventDefault(),o.fire(),!1}),on.addClass(s.__button,"button"),s.domElement.appendChild(s.__button),s}return ad(e,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),e}(Ex),nz=function(n){O0(e,n);function e(t,r){sd(this,e);var i=F0(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));i.__color=new al(i.getValue()),i.__temp=new al(0);var s=i;i.domElement=document.createElement("div"),on.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",on.bind(i.__input,"keydown",function(C){C.keyCode===13&&p.call(this)}),on.bind(i.__input,"blur",p),on.bind(i.__selector,"mousedown",function(){on.addClass(this,"drag").bind(window,"mouseup",function(){on.removeClass(s.__selector,"drag")})}),on.bind(i.__selector,"touchstart",function(){on.addClass(this,"drag").bind(window,"touchend",function(){on.removeClass(s.__selector,"drag")})});var o=document.createElement("div");Pn.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Pn.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Pn.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Pn.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Pn.extend(o.style,{width:"100%",height:"100%",background:"none"}),j$(o,"top","rgba(0,0,0,0)","#000"),Pn.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),WTe(i.__hue_field),Pn.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),on.bind(i.__saturation_field,"mousedown",l),on.bind(i.__saturation_field,"touchstart",l),on.bind(i.__field_knob,"mousedown",l),on.bind(i.__field_knob,"touchstart",l),on.bind(i.__hue_field,"mousedown",a),on.bind(i.__hue_field,"touchstart",a);function l(C){y(C),on.bind(window,"mousemove",y),on.bind(window,"touchmove",y),on.bind(window,"mouseup",h),on.bind(window,"touchend",h)}function a(C){S(C),on.bind(window,"mousemove",S),on.bind(window,"touchmove",S),on.bind(window,"mouseup",f),on.bind(window,"touchend",f)}function h(){on.unbind(window,"mousemove",y),on.unbind(window,"touchmove",y),on.unbind(window,"mouseup",h),on.unbind(window,"touchend",h),v()}function f(){on.unbind(window,"mousemove",S),on.unbind(window,"touchmove",S),on.unbind(window,"mouseup",f),on.unbind(window,"touchend",f),v()}function p(){var C=ez(this.value);C!==!1?(s.__color.__state=C,s.setValue(s.__color.toOriginal())):this.value=s.__color.toString()}function v(){s.__onFinishChange&&s.__onFinishChange.call(s,s.__color.toOriginal())}i.__saturation_field.appendChild(o),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay();function y(C){C.type.indexOf("touch")===-1&&C.preventDefault();var M=s.__saturation_field.getBoundingClientRect(),E=C.touches&&C.touches[0]||C,L=E.clientX,k=E.clientY,H=(L-M.left)/(M.right-M.left),X=1-(k-M.top)/(M.bottom-M.top);return X>1?X=1:X<0&&(X=0),H>1?H=1:H<0&&(H=0),s.__color.v=X,s.__color.s=H,s.setValue(s.__color.toOriginal()),!1}function S(C){C.type.indexOf("touch")===-1&&C.preventDefault();var M=s.__hue_field.getBoundingClientRect(),E=C.touches&&C.touches[0]||C,L=E.clientY,k=1-(L-M.top)/(M.bottom-M.top);return k>1?k=1:k<0&&(k=0),s.__color.h=k*360,s.setValue(s.__color.toOriginal()),!1}return i}return ad(e,[{key:"updateDisplay",value:function(){var r=ez(this.getValue());if(r!==!1){var i=!1;Pn.each(al.COMPONENTS,function(l){if(!Pn.isUndefined(r[l])&&!Pn.isUndefined(this.__color.__state[l])&&r[l]!==this.__color.__state[l])return i=!0,{}},this),i&&Pn.extend(this.__color.__state,r)}Pn.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var s=this.__color.v<.5||this.__color.s>.5?255:0,o=255-s;Pn.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+s+","+s+","+s+")"}),this.__hue_knob.style.marginTop=(1-this.__color.h/360)*100+"px",this.__temp.s=1,this.__temp.v=1,j$(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Pn.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+s+","+s+","+s+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),e}(Ex),jTe=["-moz-","-o-","-webkit-","-ms-",""];function j$(n,e,t,r){n.style.background="",Pn.each(jTe,function(i){n.style.cssText+="background: "+i+"linear-gradient("+e+", "+t+" 0%, "+r+" 100%); "})}function WTe(n){n.style.background="",n.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",n.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",n.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var $Te={load:function(e,t){var r=t||document,i=r.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,r.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var r=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e;var s=r.getElementsByTagName("head")[0];try{s.appendChild(i)}catch{}}},XTe=`<div id="dg-save" class="dg dialogue">

  Here's the new load parameter for your <code>GUI</code>'s constructor:

  <textarea id="dg-new-constructor"></textarea>

  <div id="dg-save-locally">

    <input id="dg-local-storage" type="checkbox"/> Automatically save
    values to <code>localStorage</code> on exit.

    <div id="dg-local-explain">The values saved to <code>localStorage</code> will
      override those passed to <code>dat.GUI</code>'s constructor. This makes it
      easier to work incrementally, but <code>localStorage</code> is fragile,
      and your friends may not see the same values you do.

    </div>

  </div>

</div>`,qTe=function(e,t){var r=e[t];return Pn.isArray(arguments[2])||Pn.isObject(arguments[2])?new GTe(e,t,arguments[2]):Pn.isNumber(r)?Pn.isNumber(arguments[2])&&Pn.isNumber(arguments[3])?Pn.isNumber(arguments[4])?new tz(e,t,arguments[2],arguments[3],arguments[4]):new tz(e,t,arguments[2],arguments[3]):Pn.isNumber(arguments[4])?new LP(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new LP(e,t,{min:arguments[2],max:arguments[3]}):Pn.isString(r)?new VTe(e,t):Pn.isFunction(r)?new aie(e,t,""):Pn.isBoolean(r)?new iie(e,t):null};function ZTe(n){setTimeout(n,1e3/60)}var YTe=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||ZTe,KTe=function(){function n(){sd(this,n),this.backgroundElement=document.createElement("div"),Pn.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),on.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Pn.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var e=this;on.bind(this.backgroundElement,"click",function(){e.hide()})}return ad(n,[{key:"show",value:function(){var t=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Pn.defer(function(){t.backgroundElement.style.opacity=1,t.domElement.style.opacity=1,t.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var t=this,r=function i(){t.domElement.style.display="none",t.backgroundElement.style.display="none",on.unbind(t.domElement,"webkitTransitionEnd",i),on.unbind(t.domElement,"transitionend",i),on.unbind(t.domElement,"oTransitionEnd",i)};on.bind(this.domElement,"webkitTransitionEnd",r),on.bind(this.domElement,"transitionend",r),on.bind(this.domElement,"oTransitionEnd",r),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-on.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-on.getHeight(this.domElement)/2+"px"}}]),n}(),JTe=OTe(`.dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}
`);$Te.inject(JTe);var W$="dg",$$=72,X$=20,fM="Default",IA=function(){try{return!!window.localStorage}catch{return!1}}(),oT=void 0,q$=!0,tb=void 0,EF=!1,oie=[],sa=function n(e){var t=this,r=e||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),on.addClass(this.domElement,W$),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],r=Pn.defaults(r,{closeOnTop:!1,autoPlace:!0,width:n.DEFAULT_WIDTH}),r=Pn.defaults(r,{resizable:r.autoPlace,hideable:r.autoPlace}),Pn.isUndefined(r.load)?r.load={preset:fM}:r.preset&&(r.load.preset=r.preset),Pn.isUndefined(r.parent)&&r.hideable&&oie.push(this),r.resizable=Pn.isUndefined(r.parent)&&r.resizable,r.autoPlace&&Pn.isUndefined(r.scrollable)&&(r.scrollable=!0);var i=IA&&localStorage.getItem(nb(this,"isLocal"))==="true",s=void 0,o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return r.parent}},scrollable:{get:function(){return r.scrollable}},autoPlace:{get:function(){return r.autoPlace}},closeOnTop:{get:function(){return r.closeOnTop}},preset:{get:function(){return t.parent?t.getRoot().preset:r.load.preset},set:function(v){t.parent?t.getRoot().preset=v:r.load.preset=v,nMe(this),t.revert()}},width:{get:function(){return r.width},set:function(v){r.width=v,sz(t,v)}},name:{get:function(){return r.name},set:function(v){r.name=v,o&&(o.innerHTML=r.name)}},closed:{get:function(){return r.closed},set:function(v){r.closed=v,r.closed?on.addClass(t.__ul,n.CLASS_CLOSED):on.removeClass(t.__ul,n.CLASS_CLOSED),this.onResize(),t.__closeButton&&(t.__closeButton.innerHTML=v?n.TEXT_OPEN:n.TEXT_CLOSED)}},load:{get:function(){return r.load}},useLocalStorage:{get:function(){return i},set:function(v){IA&&(i=v,v?on.bind(window,"unload",s):on.unbind(window,"unload",s),localStorage.setItem(nb(t,"isLocal"),v))}}}),Pn.isUndefined(r.parent)){if(this.closed=r.closed||!1,on.addClass(this.domElement,n.CLASS_MAIN),on.makeSelectable(this.domElement,!1),IA&&i){t.useLocalStorage=!0;var l=localStorage.getItem(nb(this,"gui"));l&&(r.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=n.TEXT_CLOSED,on.addClass(this.__closeButton,n.CLASS_CLOSE_BUTTON),r.closeOnTop?(on.addClass(this.__closeButton,n.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(on.addClass(this.__closeButton,n.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),on.bind(this.__closeButton,"click",function(){t.closed=!t.closed})}else{r.closed===void 0&&(r.closed=!0);var a=document.createTextNode(r.name);on.addClass(a,"controller-name"),o=U6(t,a);var h=function(v){return v.preventDefault(),t.closed=!t.closed,!1};on.addClass(this.__ul,n.CLASS_CLOSED),on.addClass(o,"title"),on.bind(o,"click",h),r.closed||(this.closed=!1)}r.autoPlace&&(Pn.isUndefined(r.parent)&&(q$&&(tb=document.createElement("div"),on.addClass(tb,W$),on.addClass(tb,n.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(tb),q$=!1),tb.appendChild(this.domElement),on.addClass(this.domElement,n.CLASS_AUTO_PLACE)),this.parent||sz(t,r.width)),this.__resizeHandler=function(){t.onResizeDebounced()},on.bind(window,"resize",this.__resizeHandler),on.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),on.bind(this.__ul,"transitionend",this.__resizeHandler),on.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),r.resizable&&tMe(this),s=function(){IA&&localStorage.getItem(nb(t,"isLocal"))==="true"&&localStorage.setItem(nb(t,"gui"),JSON.stringify(t.getSaveObject()))},this.saveToLocalStorageIfPossible=s;function f(){var p=t.getRoot();p.width+=1,Pn.defer(function(){p.width-=1})}r.parent||f()};sa.toggleHide=function(){EF=!EF,Pn.each(oie,function(n){n.domElement.style.display=EF?"none":""})};sa.CLASS_AUTO_PLACE="a";sa.CLASS_AUTO_PLACE_CONTAINER="ac";sa.CLASS_MAIN="main";sa.CLASS_CONTROLLER_ROW="cr";sa.CLASS_TOO_TALL="taller-than-window";sa.CLASS_CLOSED="closed";sa.CLASS_CLOSE_BUTTON="close-button";sa.CLASS_CLOSE_TOP="close-top";sa.CLASS_CLOSE_BOTTOM="close-bottom";sa.CLASS_DRAG="drag";sa.DEFAULT_WIDTH=245;sa.TEXT_CLOSED="Close Controls";sa.TEXT_OPEN="Open Controls";sa._keydownHandler=function(n){document.activeElement.type!=="text"&&(n.which===$$||n.keyCode===$$)&&sa.toggleHide()};on.bind(window,"keydown",sa._keydownHandler,!1);Pn.extend(sa.prototype,{add:function(e,t){return lT(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return lT(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Pn.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&tb.removeChild(this.domElement);var e=this;Pn.each(this.__folders,function(t){e.removeFolder(t)}),on.unbind(window,"keydown",sa._keydownHandler,!1),Z$(this)},addFolder:function(e){if(this.__folders[e]!==void 0)throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new sa(t);this.__folders[e]=r;var i=U6(this,r.domElement);return on.addClass(i,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],Z$(e);var t=this;Pn.each(e.__folders,function(r){e.removeFolder(r)}),Pn.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=on.getOffset(e.__ul).top,r=0;Pn.each(e.__ul.childNodes,function(i){e.autoPlace&&i===e.__save_row||(r+=on.getHeight(i))}),window.innerHeight-t-X$<r?(on.addClass(e.domElement,sa.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-X$+"px"):(on.removeClass(e.domElement,sa.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Pn.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Pn.debounce(function(){this.onResize()},50),remember:function(){if(Pn.isUndefined(oT)&&(oT=new KTe,oT.domElement.innerHTML=XTe),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Pn.each(Array.prototype.slice.call(arguments),function(t){e.__rememberedObjects.length===0&&eMe(e),e.__rememberedObjects.indexOf(t)===-1&&e.__rememberedObjects.push(t)}),this.autoPlace&&sz(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=k2(this)),e.folders={},Pn.each(this.__folders,function(t,r){e.folders[r]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=k2(this),rz(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[fM]=k2(this,!0)),this.load.remembered[e]=k2(this),this.preset=e,iz(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Pn.each(this.__controllers,function(t){this.getRoot().load.remembered?lie(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),Pn.each(this.__folders,function(t){t.revert(t)}),e||rz(this.getRoot(),!1)},listen:function(e){var t=this.__listening.length===0;this.__listening.push(e),t&&cie(this.__listening)},updateDisplay:function(){Pn.each(this.__controllers,function(e){e.updateDisplay()}),Pn.each(this.__folders,function(e){e.updateDisplay()})}});function U6(n,e,t){var r=document.createElement("li");return e&&r.appendChild(e),t?n.__ul.insertBefore(r,t):n.__ul.appendChild(r),n.onResize(),r}function Z$(n){on.unbind(window,"resize",n.__resizeHandler),n.saveToLocalStorageIfPossible&&on.unbind(window,"unload",n.saveToLocalStorageIfPossible)}function rz(n,e){var t=n.__preset_select[n.__preset_select.selectedIndex];e?t.innerHTML=t.value+"*":t.innerHTML=t.value}function QTe(n,e,t){if(t.__li=e,t.__gui=n,Pn.extend(t,{options:function(o){if(arguments.length>1){var l=t.__li.nextElementSibling;return t.remove(),lT(n,t.object,t.property,{before:l,factoryArgs:[Pn.toArray(arguments)]})}if(Pn.isArray(o)||Pn.isObject(o)){var a=t.__li.nextElementSibling;return t.remove(),lT(n,t.object,t.property,{before:a,factoryArgs:[o]})}},name:function(o){return t.__li.firstElementChild.firstElementChild.innerHTML=o,t},listen:function(){return t.__gui.listen(t),t},remove:function(){return t.__gui.remove(t),t}}),t instanceof tz){var r=new LP(t.object,t.property,{min:t.__min,max:t.__max,step:t.__step});Pn.each(["updateDisplay","onChange","onFinishChange","step","min","max"],function(s){var o=t[s],l=r[s];t[s]=r[s]=function(){var a=Array.prototype.slice.call(arguments);return l.apply(r,a),o.apply(t,a)}}),on.addClass(e,"has-slider"),t.domElement.insertBefore(r.domElement,t.domElement.firstElementChild)}else if(t instanceof LP){var i=function(o){if(Pn.isNumber(t.__min)&&Pn.isNumber(t.__max)){var l=t.__li.firstElementChild.firstElementChild.innerHTML,a=t.__gui.__listening.indexOf(t)>-1;t.remove();var h=lT(n,t.object,t.property,{before:t.__li.nextElementSibling,factoryArgs:[t.__min,t.__max,t.__step]});return h.name(l),a&&h.listen(),h}return o};t.min=Pn.compose(i,t.min),t.max=Pn.compose(i,t.max)}else t instanceof iie?(on.bind(e,"click",function(){on.fakeEvent(t.__checkbox,"click")}),on.bind(t.__checkbox,"click",function(s){s.stopPropagation()})):t instanceof aie?(on.bind(e,"click",function(){on.fakeEvent(t.__button,"click")}),on.bind(e,"mouseover",function(){on.addClass(t.__button,"hover")}),on.bind(e,"mouseout",function(){on.removeClass(t.__button,"hover")})):t instanceof nz&&(on.addClass(e,"color"),t.updateDisplay=Pn.compose(function(s){return e.style.borderLeftColor=t.__color.toString(),s},t.updateDisplay),t.updateDisplay());t.setValue=Pn.compose(function(s){return n.getRoot().__preset_select&&t.isModified()&&rz(n.getRoot(),!0),s},t.setValue)}function lie(n,e){var t=n.getRoot(),r=t.__rememberedObjects.indexOf(e.object);if(r!==-1){var i=t.__rememberedObjectIndecesToControllers[r];if(i===void 0&&(i={},t.__rememberedObjectIndecesToControllers[r]=i),i[e.property]=e,t.load&&t.load.remembered){var s=t.load.remembered,o=void 0;if(s[n.preset])o=s[n.preset];else if(s[fM])o=s[fM];else return;if(o[r]&&o[r][e.property]!==void 0){var l=o[r][e.property];e.initialValue=l,e.setValue(l)}}}}function lT(n,e,t,r){if(e[t]===void 0)throw new Error('Object "'+e+'" has no property "'+t+'"');var i=void 0;if(r.color)i=new nz(e,t);else{var s=[e,t].concat(r.factoryArgs);i=qTe.apply(n,s)}r.before instanceof Ex&&(r.before=r.before.__li),lie(n,i),on.addClass(i.domElement,"c");var o=document.createElement("span");on.addClass(o,"property-name"),o.innerHTML=i.property;var l=document.createElement("div");l.appendChild(o),l.appendChild(i.domElement);var a=U6(n,l,r.before);return on.addClass(a,sa.CLASS_CONTROLLER_ROW),i instanceof nz?on.addClass(a,"color"):on.addClass(a,NTe(i.getValue())),QTe(n,a,i),n.__controllers.push(i),i}function nb(n,e){return document.location.href+"."+e}function iz(n,e,t){var r=document.createElement("option");r.innerHTML=e,r.value=e,n.__preset_select.appendChild(r),t&&(n.__preset_select.selectedIndex=n.__preset_select.length-1)}function Y$(n,e){e.style.display=n.useLocalStorage?"block":"none"}function eMe(n){var e=n.__save_row=document.createElement("li");on.addClass(n.domElement,"has-save"),n.__ul.insertBefore(e,n.__ul.firstChild),on.addClass(e,"save-row");var t=document.createElement("span");t.innerHTML="&nbsp;",on.addClass(t,"button gears");var r=document.createElement("span");r.innerHTML="Save",on.addClass(r,"button"),on.addClass(r,"save");var i=document.createElement("span");i.innerHTML="New",on.addClass(i,"button"),on.addClass(i,"save-as");var s=document.createElement("span");s.innerHTML="Revert",on.addClass(s,"button"),on.addClass(s,"revert");var o=n.__preset_select=document.createElement("select");if(n.load&&n.load.remembered?Pn.each(n.load.remembered,function(p,v){iz(n,v,v===n.preset)}):iz(n,fM,!1),on.bind(o,"change",function(){for(var p=0;p<n.__preset_select.length;p++)n.__preset_select[p].innerHTML=n.__preset_select[p].value;n.preset=this.value}),e.appendChild(o),e.appendChild(t),e.appendChild(r),e.appendChild(i),e.appendChild(s),IA){var l=document.getElementById("dg-local-explain"),a=document.getElementById("dg-local-storage"),h=document.getElementById("dg-save-locally");h.style.display="block",localStorage.getItem(nb(n,"isLocal"))==="true"&&a.setAttribute("checked","checked"),Y$(n,l),on.bind(a,"change",function(){n.useLocalStorage=!n.useLocalStorage,Y$(n,l)})}var f=document.getElementById("dg-new-constructor");on.bind(f,"keydown",function(p){p.metaKey&&(p.which===67||p.keyCode===67)&&oT.hide()}),on.bind(t,"click",function(){f.innerHTML=JSON.stringify(n.getSaveObject(),void 0,2),oT.show(),f.focus(),f.select()}),on.bind(r,"click",function(){n.save()}),on.bind(i,"click",function(){var p=prompt("Enter a new preset name.");p&&n.saveAs(p)}),on.bind(s,"click",function(){n.revert()})}function tMe(n){var e=void 0;n.__resize_handle=document.createElement("div"),Pn.extend(n.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});function t(s){return s.preventDefault(),n.width+=e-s.clientX,n.onResize(),e=s.clientX,!1}function r(){on.removeClass(n.__closeButton,sa.CLASS_DRAG),on.unbind(window,"mousemove",t),on.unbind(window,"mouseup",r)}function i(s){return s.preventDefault(),e=s.clientX,on.addClass(n.__closeButton,sa.CLASS_DRAG),on.bind(window,"mousemove",t),on.bind(window,"mouseup",r),!1}on.bind(n.__resize_handle,"mousedown",i),on.bind(n.__closeButton,"mousedown",i),n.domElement.insertBefore(n.__resize_handle,n.domElement.firstElementChild)}function sz(n,e){n.domElement.style.width=e+"px",n.__save_row&&n.autoPlace&&(n.__save_row.style.width=e+"px"),n.__closeButton&&(n.__closeButton.style.width=e+"px")}function k2(n,e){var t={};return Pn.each(n.__rememberedObjects,function(r,i){var s={},o=n.__rememberedObjectIndecesToControllers[i];Pn.each(o,function(l,a){s[a]=e?l.initialValue:l.getValue()}),t[i]=s}),t}function nMe(n){for(var e=0;e<n.__preset_select.length;e++)n.__preset_select[e].value===n.preset&&(n.__preset_select.selectedIndex=e)}function cie(n){n.length!==0&&YTe.call(window,function(){cie(n)}),Pn.each(n,function(e){e.updateDisplay()})}var rMe=sa,np=Object.freeze({Linear:Object.freeze({None:function(n){return n},In:function(n){return this.None(n)},Out:function(n){return this.None(n)},InOut:function(n){return this.None(n)}}),Quadratic:Object.freeze({In:function(n){return n*n},Out:function(n){return n*(2-n)},InOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)}}),Cubic:Object.freeze({In:function(n){return n*n*n},Out:function(n){return--n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)}}),Quartic:Object.freeze({In:function(n){return n*n*n*n},Out:function(n){return 1- --n*n*n*n},InOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)}}),Quintic:Object.freeze({In:function(n){return n*n*n*n*n},Out:function(n){return--n*n*n*n*n+1},InOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)}}),Sinusoidal:Object.freeze({In:function(n){return 1-Math.sin((1-n)*Math.PI/2)},Out:function(n){return Math.sin(n*Math.PI/2)},InOut:function(n){return .5*(1-Math.sin(Math.PI*(.5-n)))}}),Exponential:Object.freeze({In:function(n){return n===0?0:Math.pow(1024,n-1)},Out:function(n){return n===1?1:1-Math.pow(2,-10*n)},InOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)}}),Circular:Object.freeze({In:function(n){return 1-Math.sqrt(1-n*n)},Out:function(n){return Math.sqrt(1- --n*n)},InOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)}}),Elastic:Object.freeze({In:function(n){return n===0?0:n===1?1:-Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI)},Out:function(n){return n===0?0:n===1?1:Math.pow(2,-10*n)*Math.sin((n-.1)*5*Math.PI)+1},InOut:function(n){return n===0?0:n===1?1:(n*=2,n<1?-.5*Math.pow(2,10*(n-1))*Math.sin((n-1.1)*5*Math.PI):.5*Math.pow(2,-10*(n-1))*Math.sin((n-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(n){var e=1.70158;return n===1?1:n*n*((e+1)*n-e)},Out:function(n){var e=1.70158;return n===0?0:--n*n*((e+1)*n+e)+1},InOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)}}),Bounce:Object.freeze({In:function(n){return 1-np.Bounce.Out(1-n)},Out:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},InOut:function(n){return n<.5?np.Bounce.In(n*2)*.5:np.Bounce.Out(n*2-1)*.5+.5}}),generatePow:function(n){return n===void 0&&(n=4),n=n<Number.EPSILON?Number.EPSILON:n,n=n>1e4?1e4:n,{In:function(e){return Math.pow(e,n)},Out:function(e){return 1-Math.pow(1-e,n)},InOut:function(e){return e<.5?Math.pow(e*2,n)/2:(1-Math.pow(2-e*2,n))/2+.5}}}}),Ab=function(){return performance.now()},uie=function(){function n(){this._tweens={},this._tweensAddedDuringUpdate={}}return n.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map(function(t){return e._tweens[t]})},n.prototype.removeAll=function(){this._tweens={}},n.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},n.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},n.prototype.update=function(e,t){e===void 0&&(e=Ab()),t===void 0&&(t=!1);var r=Object.keys(this._tweens);if(r.length===0)return!1;for(;r.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<r.length;i++){var s=this._tweens[r[i]],o=!t;s&&s.update(e,o)===!1&&!t&&delete this._tweens[r[i]]}r=Object.keys(this._tweensAddedDuringUpdate)}return!0},n}(),Ey={Linear:function(n,e){var t=n.length-1,r=t*e,i=Math.floor(r),s=Ey.Utils.Linear;return e<0?s(n[0],n[1],r):e>1?s(n[t],n[t-1],t-r):s(n[i],n[i+1>t?t:i+1],r-i)},Bezier:function(n,e){for(var t=0,r=n.length-1,i=Math.pow,s=Ey.Utils.Bernstein,o=0;o<=r;o++)t+=i(1-e,r-o)*i(e,o)*n[o]*s(r,o);return t},CatmullRom:function(n,e){var t=n.length-1,r=t*e,i=Math.floor(r),s=Ey.Utils.CatmullRom;return n[0]===n[t]?(e<0&&(i=Math.floor(r=t*(1+e))),s(n[(i-1+t)%t],n[i],n[(i+1)%t],n[(i+2)%t],r-i)):e<0?n[0]-(s(n[0],n[0],n[1],n[1],-r)-n[0]):e>1?n[t]-(s(n[t],n[t],n[t-1],n[t-1],r-t)-n[t]):s(n[i?i-1:0],n[i],n[t<i+1?t:i+1],n[t<i+2?t:i+2],r-i)},Utils:{Linear:function(n,e,t){return(e-n)*t+n},Bernstein:function(n,e){var t=Ey.Utils.Factorial;return t(n)/t(e)/t(n-e)},Factorial:function(){var n=[1];return function(e){var t=1;if(n[e])return n[e];for(var r=e;r>1;r--)t*=r;return n[e]=t,t}}(),CatmullRom:function(n,e,t,r,i){var s=(t-n)*.5,o=(r-e)*.5,l=i*i,a=i*l;return(2*e-2*t+s+o)*a+(-3*e+3*t-2*s-o)*l+s*i+e}}},G6=function(){function n(){}return n.nextId=function(){return n._nextId++},n._nextId=0,n}(),az=new uie,RA=function(){function n(e,t){t===void 0&&(t=az),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=np.Linear.None,this._interpolationFunction=Ey.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=G6.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return n.prototype.getId=function(){return this._id},n.prototype.isPlaying=function(){return this._isPlaying},n.prototype.isPaused=function(){return this._isPaused},n.prototype.getDuration=function(){return this._duration},n.prototype.to=function(e,t){if(t===void 0&&(t=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=e,this._propertiesAreSetUp=!1,this._duration=t<0?0:t,this},n.prototype.duration=function(e){return e===void 0&&(e=1e3),this._duration=e<0?0:e,this},n.prototype.dynamic=function(e){return e===void 0&&(e=!1),this._isDynamic=e,this},n.prototype.start=function(e,t){if(e===void 0&&(e=Ab()),t===void 0&&(t=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var r in this._valuesStartRepeat)this._swapEndStartRepeatValues(r),this._valuesStart[r]=this._valuesStartRepeat[r]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=e,this._startTime+=this._delayTime,!this._propertiesAreSetUp||t){if(this._propertiesAreSetUp=!0,!this._isDynamic){var i={};for(var s in this._valuesEnd)i[s]=this._valuesEnd[s];this._valuesEnd=i}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,t)}return this},n.prototype.startFromCurrentValues=function(e){return this.start(e,!0)},n.prototype._setupProperties=function(e,t,r,i,s){for(var o in r){var l=e[o],a=Array.isArray(l),h=a?"array":typeof l,f=!a&&Array.isArray(r[o]);if(!(h==="undefined"||h==="function")){if(f){var p=r[o];if(p.length===0)continue;for(var v=[l],y=0,S=p.length;y<S;y+=1){var C=this._handleRelativeValue(l,p[y]);if(isNaN(C)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}v.push(C)}f&&(r[o]=v)}if((h==="object"||a)&&l&&!f){t[o]=a?[]:{};var M=l;for(var E in M)t[o][E]=M[E];i[o]=a?[]:{};var p=r[o];if(!this._isDynamic){var L={};for(var E in p)L[E]=p[E];r[o]=p=L}this._setupProperties(M,t[o],p,i[o],s)}else(typeof t[o]>"u"||s)&&(t[o]=l),a||(t[o]*=1),f?i[o]=r[o].slice().reverse():i[o]=t[o]||0}}},n.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},n.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},n.prototype.pause=function(e){return e===void 0&&(e=Ab()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this),this)},n.prototype.resume=function(e){return e===void 0&&(e=Ab()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},n.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},n.prototype.group=function(e){return e===void 0&&(e=az),this._group=e,this},n.prototype.delay=function(e){return e===void 0&&(e=0),this._delayTime=e,this},n.prototype.repeat=function(e){return e===void 0&&(e=0),this._initialRepeat=e,this._repeat=e,this},n.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},n.prototype.yoyo=function(e){return e===void 0&&(e=!1),this._yoyo=e,this},n.prototype.easing=function(e){return e===void 0&&(e=np.Linear.None),this._easingFunction=e,this},n.prototype.interpolation=function(e){return e===void 0&&(e=Ey.Linear),this._interpolationFunction=e,this},n.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},n.prototype.onStart=function(e){return this._onStartCallback=e,this},n.prototype.onEveryStart=function(e){return this._onEveryStartCallback=e,this},n.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},n.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},n.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},n.prototype.onStop=function(e){return this._onStopCallback=e,this},n.prototype.update=function(e,t){var r=this,i;if(e===void 0&&(e=Ab()),t===void 0&&(t=!0),this._isPaused)return!0;var s,o=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>o)return!1;t&&this.start(e,!0)}if(this._goToEnd=!1,e<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var l=e-this._startTime,a=this._duration+((i=this._repeatDelayTime)!==null&&i!==void 0?i:this._delayTime),h=this._duration+this._repeat*a,f=function(){if(r._duration===0||l>h)return 1;var M=Math.trunc(l/a),E=l-M*a,L=Math.min(E/r._duration,1);return L===0&&l===r._duration?1:L},p=f(),v=this._easingFunction(p);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,v),this._onUpdateCallback&&this._onUpdateCallback(this._object,p),this._duration===0||l>=this._duration)if(this._repeat>0){var y=Math.min(Math.trunc((l-this._duration)/a)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=y);for(s in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[s]=="string"&&(this._valuesStartRepeat[s]=this._valuesStartRepeat[s]+parseFloat(this._valuesEnd[s])),this._yoyo&&this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=a*y,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var S=0,C=this._chainedTweens.length;S<C;S++)this._chainedTweens[S].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},n.prototype._updateProperties=function(e,t,r,i){for(var s in r)if(t[s]!==void 0){var o=t[s]||0,l=r[s],a=Array.isArray(e[s]),h=Array.isArray(l),f=!a&&h;f?e[s]=this._interpolationFunction(l,i):typeof l=="object"&&l?this._updateProperties(e[s],o,l,i):(l=this._handleRelativeValue(o,l),typeof l=="number"&&(e[s]=o+(l-o)*i))}},n.prototype._handleRelativeValue=function(e,t){return typeof t!="string"?t:t.charAt(0)==="+"||t.charAt(0)==="-"?e+parseFloat(t):parseFloat(t)},n.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],r=this._valuesEnd[e];typeof r=="string"?this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(r):this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=t},n}(),iMe="23.1.1",sMe=G6.nextId,gp=az,aMe=gp.getAll.bind(gp),oMe=gp.removeAll.bind(gp),lMe=gp.add.bind(gp),PA=gp.remove.bind(gp),hie=gp.update.bind(gp),cT={Easing:np,Group:uie,Interpolation:Ey,now:Ab,Sequence:G6,nextId:sMe,Tween:RA,VERSION:iMe,getAll:aMe,removeAll:oMe,add:lMe,remove:PA,update:hie};const fie={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = opacity * texel;


		}`};class N0{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const cMe=new nd(-1,1,1,-1,0,1);class uMe extends Xr{constructor(){super(),this.setAttribute("position",new or([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new or([0,2,0,0,2,0],2))}}const hMe=new uMe;class dE{constructor(e){this._mesh=new Ri(hMe,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,cMe)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class fMe extends N0{constructor(e,t){super(),this.textureID=t!==void 0?t:"tDiffuse",e instanceof Ia?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=qm.clone(e.uniforms),this.material=new Ia({name:e.name!==void 0?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new dE(this.material)}render(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class K$ extends N0{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,r){const i=e.getContext(),s=e.state;s.buffers.color.setMask(!1),s.buffers.depth.setMask(!1),s.buffers.color.setLocked(!0),s.buffers.depth.setLocked(!0);let o,l;this.inverse?(o=0,l=1):(o=1,l=0),s.buffers.stencil.setTest(!0),s.buffers.stencil.setOp(i.REPLACE,i.REPLACE,i.REPLACE),s.buffers.stencil.setFunc(i.ALWAYS,o,4294967295),s.buffers.stencil.setClear(l),s.buffers.stencil.setLocked(!0),e.setRenderTarget(r),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),s.buffers.color.setLocked(!1),s.buffers.depth.setLocked(!1),s.buffers.color.setMask(!0),s.buffers.depth.setMask(!0),s.buffers.stencil.setLocked(!1),s.buffers.stencil.setFunc(i.EQUAL,1,4294967295),s.buffers.stencil.setOp(i.KEEP,i.KEEP,i.KEEP),s.buffers.stencil.setLocked(!0)}}class dMe extends N0{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class ND{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),t===void 0){const r=e.getSize(new nn);this._width=r.width,this._height=r.height,t=new Sl(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:Ih}),t.texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new fMe(fie),this.copyPass.material.blending=cp,this.clock=new sg}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);t!==-1&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){e===void 0&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let r=!1;for(let i=0,s=this.passes.length;i<s;i++){const o=this.passes[i];if(o.enabled!==!1){if(o.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(i),o.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),o.needsSwap){if(r){const l=this.renderer.getContext(),a=this.renderer.state.buffers.stencil;a.setFunc(l.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.setFunc(l.EQUAL,1,4294967295)}this.swapBuffers()}K$!==void 0&&(o instanceof K$?r=!0:o instanceof dMe&&(r=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(e===void 0){const t=this.renderer.getSize(new nn);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,e=this.renderTarget1.clone(),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const r=this._width*this._pixelRatio,i=this._height*this._pixelRatio;this.renderTarget1.setSize(r,i),this.renderTarget2.setSize(r,i);for(let s=0;s<this.passes.length;s++)this.passes[s].setSize(r,i)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}const pMe={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:`

		varying vec2 vUv;
		void main() {
			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
		}`,fragmentShader:`

		uniform int byp; //should we apply the glitch ?

		uniform sampler2D tDiffuse;
		uniform sampler2D tDisp;

		uniform float amount;
		uniform float angle;
		uniform float seed;
		uniform float seed_x;
		uniform float seed_y;
		uniform float distortion_x;
		uniform float distortion_y;
		uniform float col_s;

		varying vec2 vUv;


		float rand(vec2 co){
			return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
		}

		void main() {
			if(byp<1) {
				vec2 p = vUv;
				float xs = floor(gl_FragCoord.x / 0.5);
				float ys = floor(gl_FragCoord.y / 0.5);
				//based on staffantans glitch shader for unity https://github.com/staffantan/unityglitch
				float disp = texture2D(tDisp, p*seed*seed).r;
				if(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {
					if(seed_x>0.){
						p.y = 1. - (p.y + distortion_y);
					}
					else {
						p.y = distortion_y;
					}
				}
				if(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {
					if(seed_y>0.){
						p.x=distortion_x;
					}
					else {
						p.x = 1. - (p.x + distortion_x);
					}
				}
				p.x+=disp*seed_x*(seed/5.);
				p.y+=disp*seed_y*(seed/5.);
				//base from RGB shift shader
				vec2 offset = amount * vec2( cos(angle), sin(angle));
				vec4 cr = texture2D(tDiffuse, p + offset);
				vec4 cga = texture2D(tDiffuse, p);
				vec4 cb = texture2D(tDiffuse, p - offset);
				gl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);
				//add noise
				vec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);
				gl_FragColor = gl_FragColor+ snow;
			}
			else {
				gl_FragColor=texture2D (tDiffuse, vUv);
			}
		}`};class mMe extends N0{constructor(e=64){super();const t=pMe;this.uniforms=qm.clone(t.uniforms),this.heightMap=this.generateHeightmap(e),this.uniforms.tDisp.value=this.heightMap,this.material=new Ia({uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader}),this.fsQuad=new dE(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()}render(e,t,r){this.uniforms.tDiffuse.value=r.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||this.goWild==!0?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=ra.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=ra.randFloat(-1,1),this.uniforms.seed_y.value=ra.randFloat(-1,1),this.uniforms.distortion_x.value=ra.randFloat(0,1),this.uniforms.distortion_y.value=ra.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=ra.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=ra.randFloat(0,1),this.uniforms.distortion_y.value=ra.randFloat(0,1),this.uniforms.seed_x.value=ra.randFloat(-.3,.3),this.uniforms.seed_y.value=ra.randFloat(-.3,.3)):this.goWild==!1&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}generateTrigger(){this.randX=ra.randInt(120,240)}generateHeightmap(e){const t=new Float32Array(e*e),r=e*e;for(let s=0;s<r;s++){const o=ra.randFloat(0,1);t[s]=o}const i=new Zf(t,e,e,qM,Mc);return i.needsUpdate=!0,i}dispose(){this.material.dispose(),this.heightMap.dispose(),this.fsQuad.dispose()}}class zD extends N0{constructor(e,t,r=null,i=null,s=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=i,this.clearAlpha=s,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Vn}render(e,t,r){const i=e.autoClear;e.autoClear=!1;let s,o;this.overrideMaterial!==null&&(o=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor!==null&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor,e.getClearAlpha())),this.clearAlpha!==null&&(s=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),this.clearDepth==!0&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear===!0&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor!==null&&e.setClearColor(this._oldClearColor),this.clearAlpha!==null&&e.setClearAlpha(s),this.overrideMaterial!==null&&(this.scene.overrideMaterial=o),e.autoClear=i}}function gMe(n,e=!1){const t=n[0].index!==null,r=new Set(Object.keys(n[0].attributes)),i=new Set(Object.keys(n[0].morphAttributes)),s={},o={},l=n[0].morphTargetsRelative,a=new Xr;let h=0;for(let f=0;f<n.length;++f){const p=n[f];let v=0;if(t!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const y in p.attributes){if(!r.has(y))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+'. All geometries must have compatible attributes; make sure "'+y+'" attribute exists among all geometries, or in none of them.'),null;s[y]===void 0&&(s[y]=[]),s[y].push(p.attributes[y]),v++}if(v!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". Make sure all geometries have the same number of attributes."),null;if(l!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const y in p.morphAttributes){if(!i.has(y))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+".  .morphAttributes must be consistent throughout all geometries."),null;o[y]===void 0&&(o[y]=[]),o[y].push(p.morphAttributes[y])}if(e){let y;if(t)y=p.index.count;else if(p.attributes.position!==void 0)y=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+f+". The geometry must have either an index or a position attribute"),null;a.addGroup(h,y,f),h+=y}}if(t){let f=0;const p=[];for(let v=0;v<n.length;++v){const y=n[v].index;for(let S=0;S<y.count;++S)p.push(y.getX(S)+f);f+=n[v].attributes.position.count}a.setIndex(p)}for(const f in s){const p=J$(s[f]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" attribute."),null;a.setAttribute(f,p)}for(const f in o){const p=o[f][0].length;if(p===0)break;a.morphAttributes=a.morphAttributes||{},a.morphAttributes[f]=[];for(let v=0;v<p;++v){const y=[];for(let C=0;C<o[f].length;++C)y.push(o[f][C][v]);const S=J$(y);if(!S)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+f+" morphAttribute."),null;a.morphAttributes[f].push(S)}}return a}function J$(n){let e,t,r,i=-1,s=0;for(let h=0;h<n.length;++h){const f=n[h];if(e===void 0&&(e=f.array.constructor),e!==f.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(t===void 0&&(t=f.itemSize),t!==f.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=f.normalized),r!==f.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(i===-1&&(i=f.gpuType),i!==f.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=f.count*t}const o=new e(s),l=new ki(o,t,r);let a=0;for(let h=0;h<n.length;++h){const f=n[h];if(f.isInterleavedBufferAttribute){const p=a/t;for(let v=0,y=f.count;v<y;v++)for(let S=0;S<t;S++){const C=f.getComponent(v,S);l.setComponent(v+p,S,C)}}else o.set(f.array,a);a+=f.count*t}return i!==void 0&&(l.gpuType=i),l}function Q$(n,e){if(e===r6)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),n;if(e===rx||e===YM){let t=n.getIndex();if(t===null){const o=[],l=n.getAttribute("position");if(l!==void 0){for(let a=0;a<l.count;a++)o.push(a);n.setIndex(o),t=n.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),n}const r=t.count-2,i=[];if(e===rx)for(let o=1;o<=r;o++)i.push(t.getX(0)),i.push(t.getX(o)),i.push(t.getX(o+1));else for(let o=0;o<r;o++)o%2===0?(i.push(t.getX(o)),i.push(t.getX(o+1)),i.push(t.getX(o+2))):(i.push(t.getX(o+2)),i.push(t.getX(o+1)),i.push(t.getX(o)));i.length/3!==r&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=n.clone();return s.setIndex(i),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),n}const vMe={1:"",2:"",3:"",4:"",5:"",6:"",7:""},CF=["37.5","","","","","","","","","","","","Yeah","hard"],_Me=[{value:5024.33,desc:"Distance"},{value:"0.22245%",desc:"oxygen level"},{value:205.24,desc:"Temperature"}],yMe={backgroundColor:"transparent",color:["#03c03c","#00e6f6","#8ae66e","#ff013c","#f9f002"],textStyle:{color:"#f9f002"},title:{text:"Kepler-90 Planetary System",textStyle:{color:"#f9f002",fontWeight:"normal"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0,borderColor:"#f9f002",show:!0},xAxis:[{type:"category",boundaryGap:!1,data:["90a","90b","90c","90i","90s","90v","90z"],color:"#f9f002"}],yAxis:[{type:"value",color:"#f9f002"}],series:[{name:"Email",type:"line",stack:"Total",emphasis:{focus:"series"},data:[120,132,101,134,90,230,210],showSymbol:!1},{name:"Union Ads",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[220,182,191,234,290,330,310]},{name:"Video Ads",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[150,232,201,154,190,330,410]},{name:"Direct",type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:[320,332,301,334,390,330,320]},{name:"Search Engine",type:"line",stack:"Total",label:{show:!0,position:"top"},areaStyle:{},emphasis:{focus:"series"},data:[820,932,901,934,1290,1330,2400]}]},xMe={backgroundColor:"transparent",color:["#000000","#00e6f6","#8ae66e","#ff013c"],textStyle:{color:"#000000"},series:[{name:"Kepler-90 Planetary system",type:"pie",radius:[25,100],center:["50%","50%"],roseType:"area",itemStyle:{borderRadius:4},data:[{value:40,name:"Kepler-90a"},{value:38,name:"Kepler-90b"},{value:32,name:"Kepler-90c"},{value:30,name:"Kepler-90i"},{value:28,name:"Kepler-90m"},{value:26,name:"Kepler-90s"},{value:22,name:"Kepler-90t"},{value:18,name:"Kepler-90z"}],label:{color:"#000000"}}]},bMe={backgroundColor:"transparent",color:["#f9f002","#00e6f6","#8ae66e","#ff013c"],dataset:{source:[["product","2012","2013","2014","2015","2016","2017"],["90a",86.5,92.1,85.7,83.1,73.4,55.1],["90i",41.1,30.4,65.1,53.3,83.8,98.7],["90t",24.1,67.2,79.5,86.4,65.2,82.5],["90z",55.2,67.1,69.2,72.4,53.9,39.1]]},series:[{type:"pie",radius:"20%",center:["25%","30%"],encode:{itemName:"product",value:"2012"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["75%","30%"],encode:{itemName:"product",value:"2013"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["25%","75%"],encode:{itemName:"product",value:"2014"},label:{color:"#f9f002"}},{type:"pie",radius:"20%",center:["75%","75%"],encode:{itemName:"product",value:"2015"},label:{color:"#f9f002"}}]},wMe={backgroundColor:"transparent",color:["#000000","#00e6f6","#8ae66e","#ff013c"],textStyle:{color:"#f9f002"},radiusAxis:{type:"category",data:["v","w","x","y","z"],z:10},angleAxis:{max:2,startAngle:30,splitLine:{show:!1}},polar:{},series:[{type:"bar",data:[4,3,2,1,0],coordinateSystem:"polar",name:"Without Round Cap",itemStyle:{borderColor:"red",opacity:.8,borderWidth:1}},{type:"bar",data:[4,3,2,1,0],coordinateSystem:"polar",name:"With Round Cap",roundCap:!0,itemStyle:{borderColor:"green",opacity:.8,borderWidth:1}}]},SMe={backgroundColor:"transparent",textStyle:{color:"#000000"},title:{text:"Cyberpunk 2077 Fantastic",textStyle:{color:"#000000"}},color:["#80FFA5","#00DDFF","#37A2FF","#FF0087","#FFBF00"],tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:["90a","90b","90c","90i","90s","90v","90z"]}],yAxis:[{type:"value"}],series:[{name:"Line 1",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(128, 255, 165)"},{offset:1,color:"rgb(1, 191, 236)"}]}},emphasis:{focus:"series"},data:[140,232,101,264,90,340,250]},{name:"Line 2",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(0, 221, 255)"},{offset:1,color:"rgb(77, 119, 255)"}]}},emphasis:{focus:"series"},data:[120,282,111,234,220,340,310]},{name:"Line 3",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(55, 162, 255)"},{offset:1,color:"rgb(116, 21, 219)"}]}},emphasis:{focus:"series"},data:[320,132,201,334,190,130,220]},{name:"Line 4",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(255, 0, 135)"},{offset:1,color:"rgb(135, 0, 157)"}]}},emphasis:{focus:"series"},data:[220,402,231,134,190,230,120]},{name:"Line 5",type:"line",stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,label:{show:!0,position:"top"},areaStyle:{opacity:.8,color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgb(255, 191, 0)"},{offset:1,color:"rgb(224, 62, 76)"}]}},emphasis:{focus:"series"},data:[220,302,181,234,210,290,150]}]},AMe="/about_portfolio/assets/earth-BrwlGRgR.jpg";var TMe=`precision mediump float;\r
uniform float actionRatio;\r
uniform float lineLength;\r
uniform vec3 diffuse;\r
uniform float opacity;\r
uniform float dashSize;\r
uniform float totalSize;\r
varying float vLineDistance;

#include <clipping_planes_pars_fragment>\r
#include <color_pars_fragment>\r
#include <common>\r
#include <fog_pars_fragment>\r
#include <logdepthbuf_pars_fragment>

vec3 linearTosRGB(vec3 color) { return pow(color, vec3(1.0 / 2.2)); }

vec3 gammaCorrect(vec3 color) {\r
  const float gamma = 2.2;\r
  return pow(color, vec3(1.0 / gamma));\r
}

void main() {\r
#include <clipping_planes_fragment>

  float halfDash = dashSize * 0.5;\r
  float currPos = (lineLength + dashSize) * actionRatio;\r
  float d = (vLineDistance + halfDash) - currPos;\r
  if (abs(d) > halfDash)\r
    discard; 

  float grad = ((vLineDistance + halfDash) - (currPos - halfDash)) / halfDash;\r
  vec3 outgoingLight = vec3(0.0);\r
  vec4 diffuseColor = vec4(diffuse, grad);\r
  
  
  
  gl_FragColor = diffuseColor;

#include <color_fragment>

#include <fog_fragment>\r
#include <logdepthbuf_fragment>

#include <premultiplied_alpha_fragment>\r
#include <tonemapping_fragment>\r
}`;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var oz=function(n,e){return oz=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},oz(n,e)};function Hn(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");oz(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var MMe=function(){function n(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return n}(),EMe=function(){function n(){this.browser=new MMe,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return n}(),gi=new EMe;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(gi.wxa=!0,gi.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?gi.worker=!0:typeof navigator>"u"||navigator.userAgent.indexOf("Node.js")===0?(gi.node=!0,gi.svgSupported=!0):CMe(navigator.userAgent,gi);function CMe(n,e){var t=e.browser,r=n.match(/Firefox\/([\d.]+)/),i=n.match(/MSIE\s([\d.]+)/)||n.match(/Trident\/.+?rv:(([\d.]+))/),s=n.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(n);r&&(t.firefox=!0,t.version=r[1]),i&&(t.ie=!0,t.version=i[1]),s&&(t.edge=!0,t.version=s[1],t.newEdge=+s[1].split(".")[0]>18),o&&(t.weChat=!0),e.svgSupported=typeof SVGRect<"u",e.touchEventsSupported="ontouchstart"in window&&!t.ie&&!t.edge,e.pointerEventsSupported="onpointerdown"in window&&(t.edge||t.ie&&+t.version>=11),e.domSupported=typeof document<"u";var l=document.documentElement.style;e.transform3dSupported=(t.ie&&"transition"in l||t.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in l)&&!("OTransition"in l),e.transformSupported=e.transform3dSupported||t.ie&&+t.version>=9}var V6=12,IMe="sans-serif",ox=V6+"px "+IMe,RMe=20,PMe=100,LMe="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function DMe(n){var e={};if(typeof JSON>"u")return e;for(var t=0;t<n.length;t++){var r=String.fromCharCode(t+32),i=(n.charCodeAt(t)-RMe)/PMe;e[r]=i}return e}var BMe=DMe(LMe),Rw={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var n,e;return function(t,r){if(!n){var i=Rw.createCanvas();n=i&&i.getContext("2d")}if(n)return e!==r&&(e=n.font=r||ox),n.measureText(t);t=t||"",r=r||ox;var s=/((?:\d+)?\.?\d*)px/.exec(r),o=s&&+s[1]||V6,l=0;if(r.indexOf("mono")>=0)l=o*t.length;else for(var a=0;a<t.length;a++){var h=BMe[t[a]];l+=h==null?o:h*o}return{width:l}}}(),loadImage:function(n,e,t){var r=new Image;return r.onload=e,r.onerror=t,r.src=n,r}},die=v0(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(n,e){return n["[object "+e+"]"]=!0,n},{}),pie=v0(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(n,e){return n["[object "+e+"Array]"]=!0,n},{}),Pw=Object.prototype.toString,UD=Array.prototype,kMe=UD.forEach,OMe=UD.filter,H6=UD.slice,FMe=UD.map,eX=(function(){}).constructor,O2=eX?eX.prototype:null,j6="__proto__",NMe=2311;function mie(){return NMe++}function W6(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];typeof console<"u"&&console.error.apply(console,n)}function yi(n){if(n==null||typeof n!="object")return n;var e=n,t=Pw.call(n);if(t==="[object Array]"){if(!hT(n)){e=[];for(var r=0,i=n.length;r<i;r++)e[r]=yi(n[r])}}else if(pie[t]){if(!hT(n)){var s=n.constructor;if(s.from)e=s.from(n);else{e=new s(n.length);for(var r=0,i=n.length;r<i;r++)e[r]=n[r]}}}else if(!die[t]&&!hT(n)&&!lw(n)){e={};for(var o in n)n.hasOwnProperty(o)&&o!==j6&&(e[o]=yi(n[o]))}return e}function Bi(n,e,t){if(!$r(e)||!$r(n))return t?yi(e):n;for(var r in e)if(e.hasOwnProperty(r)&&r!==j6){var i=n[r],s=e[r];$r(s)&&$r(i)&&!fr(s)&&!fr(i)&&!lw(s)&&!lw(i)&&!tX(s)&&!tX(i)&&!hT(s)&&!hT(i)?Bi(i,s,t):(t||!(r in n))&&(n[r]=yi(e[r]))}return n}function Jn(n,e){if(Object.assign)Object.assign(n,e);else for(var t in e)e.hasOwnProperty(t)&&t!==j6&&(n[t]=e[t]);return n}function ti(n,e,t){for(var r=aa(e),i=0;i<r.length;i++){var s=r[i];n[s]==null&&(n[s]=e[s])}return n}function Xi(n,e){if(n){if(n.indexOf)return n.indexOf(e);for(var t=0,r=n.length;t<r;t++)if(n[t]===e)return t}return-1}function zMe(n,e){var t=n.prototype;function r(){}r.prototype=e.prototype,n.prototype=new r;for(var i in t)t.hasOwnProperty(i)&&(n.prototype[i]=t[i]);n.prototype.constructor=n,n.superClass=e}function od(n,e,t){if(n="prototype"in n?n.prototype:n,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames)for(var r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++){var s=r[i];s!=="constructor"&&n[s]==null&&(n[s]=e[s])}else ti(n,e)}function Pc(n){return!n||typeof n=="string"?!1:typeof n.length=="number"}function it(n,e,t){if(n&&e)if(n.forEach&&n.forEach===kMe)n.forEach(e,t);else if(n.length===+n.length)for(var r=0,i=n.length;r<i;r++)e.call(t,n[r],r,n);else for(var s in n)n.hasOwnProperty(s)&&e.call(t,n[s],s,n)}function xr(n,e,t){if(!n)return[];if(!e)return $6(n);if(n.map&&n.map===FMe)return n.map(e,t);for(var r=[],i=0,s=n.length;i<s;i++)r.push(e.call(t,n[i],i,n));return r}function v0(n,e,t,r){if(n&&e){for(var i=0,s=n.length;i<s;i++)t=e.call(r,t,n[i],i,n);return t}}function no(n,e,t){if(!n)return[];if(!e)return $6(n);if(n.filter&&n.filter===OMe)return n.filter(e,t);for(var r=[],i=0,s=n.length;i<s;i++)e.call(t,n[i],i,n)&&r.push(n[i]);return r}function aa(n){if(!n)return[];if(Object.keys)return Object.keys(n);var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t);return e}function UMe(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return function(){return n.apply(e,t.concat(H6.call(arguments)))}}var Us=O2&&ci(O2.bind)?O2.call.bind(O2.bind):UMe;function _s(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){return n.apply(this,e.concat(H6.call(arguments)))}}function fr(n){return Array.isArray?Array.isArray(n):Pw.call(n)==="[object Array]"}function ci(n){return typeof n=="function"}function Dr(n){return typeof n=="string"}function lz(n){return Pw.call(n)==="[object String]"}function Ps(n){return typeof n=="number"}function $r(n){var e=typeof n;return e==="function"||!!n&&e==="object"}function tX(n){return!!die[Pw.call(n)]}function mu(n){return!!pie[Pw.call(n)]}function lw(n){return typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.ownerDocument=="object"}function GD(n){return n.colorStops!=null}function GMe(n){return n.image!=null}function VMe(n){return Pw.call(n)==="[object RegExp]"}function DP(n){return n!==n}function dM(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];for(var t=0,r=n.length;t<r;t++)if(n[t]!=null)return n[t]}function Ii(n,e){return n??e}function uT(n,e,t){return n??e??t}function $6(n){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return H6.apply(n,e)}function gie(n){if(typeof n=="number")return[n,n,n,n];var e=n.length;return e===2?[n[0],n[1],n[0],n[1]]:e===3?[n[0],n[1],n[2],n[1]]:n}function vp(n,e){if(!n)throw new Error(e)}function rp(n){return n==null?null:typeof n.trim=="function"?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var vie="__ec_primitive__";function BP(n){n[vie]=!0}function hT(n){return n[vie]}var HMe=function(){function n(){this.data={}}return n.prototype.delete=function(e){var t=this.has(e);return t&&delete this.data[e],t},n.prototype.has=function(e){return this.data.hasOwnProperty(e)},n.prototype.get=function(e){return this.data[e]},n.prototype.set=function(e,t){return this.data[e]=t,this},n.prototype.keys=function(){return aa(this.data)},n.prototype.forEach=function(e){var t=this.data;for(var r in t)t.hasOwnProperty(r)&&e(t[r],r)},n}(),_ie=typeof Map=="function";function jMe(){return _ie?new Map:new HMe}var WMe=function(){function n(e){var t=fr(e);this.data=jMe();var r=this;e instanceof n?e.each(i):e&&it(e,i);function i(s,o){t?r.set(s,o):r.set(o,s)}}return n.prototype.hasKey=function(e){return this.data.has(e)},n.prototype.get=function(e){return this.data.get(e)},n.prototype.set=function(e,t){return this.data.set(e,t),t},n.prototype.each=function(e,t){this.data.forEach(function(r,i){e.call(t,r,i)})},n.prototype.keys=function(){var e=this.data.keys();return _ie?Array.from(e):e},n.prototype.removeKey=function(e){this.data.delete(e)},n}();function ii(n){return new WMe(n)}function $Me(n,e){for(var t=new n.constructor(n.length+e.length),r=0;r<n.length;r++)t[r]=n[r];for(var i=n.length,r=0;r<e.length;r++)t[r+i]=e[r];return t}function VD(n,e){var t;if(Object.create)t=Object.create(n);else{var r=function(){};r.prototype=n,t=new r}return e&&Jn(t,e),t}function yie(n){var e=n.style;e.webkitUserSelect="none",e.userSelect="none",e.webkitTapHighlightColor="rgba(0,0,0,0)",e["-webkit-touch-callout"]="none"}function Qm(n,e){return n.hasOwnProperty(e)}function Rc(){}var XMe=180/Math.PI;function Lw(n,e){return n==null&&(n=0),e==null&&(e=0),[n,e]}function qMe(n){return[n[0],n[1]]}function nX(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function ZMe(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}function YMe(n){return Math.sqrt(KMe(n))}function KMe(n){return n[0]*n[0]+n[1]*n[1]}function IF(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n}function JMe(n,e){var t=YMe(e);return t===0?(n[0]=0,n[1]=0):(n[0]=e[0]/t,n[1]=e[1]/t),n}function cz(n,e){return Math.sqrt((n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1]))}var uz=cz;function QMe(n,e){return(n[0]-e[0])*(n[0]-e[0])+(n[1]-e[1])*(n[1]-e[1])}var zb=QMe;function iR(n,e,t,r){return n[0]=e[0]+r*(t[0]-e[0]),n[1]=e[1]+r*(t[1]-e[1]),n}function Rh(n,e,t){var r=e[0],i=e[1];return n[0]=t[0]*r+t[2]*i+t[4],n[1]=t[1]*r+t[3]*i+t[5],n}function Tb(n,e,t){return n[0]=Math.min(e[0],t[0]),n[1]=Math.min(e[1],t[1]),n}function Mb(n,e,t){return n[0]=Math.max(e[0],t[0]),n[1]=Math.max(e[1],t[1]),n}var R1=function(){function n(e,t){this.target=e,this.topTarget=t&&t.topTarget}return n}(),eEe=function(){function n(e){this.handler=e,e.on("mousedown",this._dragStart,this),e.on("mousemove",this._drag,this),e.on("mouseup",this._dragEnd,this)}return n.prototype._dragStart=function(e){for(var t=e.target;t&&!t.draggable;)t=t.parent||t.__hostTarget;t&&(this._draggingTarget=t,t.dragging=!0,this._x=e.offsetX,this._y=e.offsetY,this.handler.dispatchToElement(new R1(t,e),"dragstart",e.event))},n.prototype._drag=function(e){var t=this._draggingTarget;if(t){var r=e.offsetX,i=e.offsetY,s=r-this._x,o=i-this._y;this._x=r,this._y=i,t.drift(s,o,e),this.handler.dispatchToElement(new R1(t,e),"drag",e.event);var l=this.handler.findHover(r,i,t).target,a=this._dropTarget;this._dropTarget=l,t!==l&&(a&&l!==a&&this.handler.dispatchToElement(new R1(a,e),"dragleave",e.event),l&&l!==a&&this.handler.dispatchToElement(new R1(l,e),"dragenter",e.event))}},n.prototype._dragEnd=function(e){var t=this._draggingTarget;t&&(t.dragging=!1),this.handler.dispatchToElement(new R1(t,e),"dragend",e.event),this._dropTarget&&this.handler.dispatchToElement(new R1(this._dropTarget,e),"drop",e.event),this._draggingTarget=null,this._dropTarget=null},n}(),ld=function(){function n(e){e&&(this._$eventProcessor=e)}return n.prototype.on=function(e,t,r,i){this._$handlers||(this._$handlers={});var s=this._$handlers;if(typeof t=="function"&&(i=r,r=t,t=null),!r||!e)return this;var o=this._$eventProcessor;t!=null&&o&&o.normalizeQuery&&(t=o.normalizeQuery(t)),s[e]||(s[e]=[]);for(var l=0;l<s[e].length;l++)if(s[e][l].h===r)return this;var a={h:r,query:t,ctx:i||this,callAtLast:r.zrEventfulCallAtLast},h=s[e].length-1,f=s[e][h];return f&&f.callAtLast?s[e].splice(h,0,a):s[e].push(a),this},n.prototype.isSilent=function(e){var t=this._$handlers;return!t||!t[e]||!t[e].length},n.prototype.off=function(e,t){var r=this._$handlers;if(!r)return this;if(!e)return this._$handlers={},this;if(t){if(r[e]){for(var i=[],s=0,o=r[e].length;s<o;s++)r[e][s].h!==t&&i.push(r[e][s]);r[e]=i}r[e]&&r[e].length===0&&delete r[e]}else delete r[e];return this},n.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var i=this._$handlers[e],s=this._$eventProcessor;if(i)for(var o=t.length,l=i.length,a=0;a<l;a++){var h=i[a];if(!(s&&s.filter&&h.query!=null&&!s.filter(e,h.query)))switch(o){case 0:h.h.call(h.ctx);break;case 1:h.h.call(h.ctx,t[0]);break;case 2:h.h.call(h.ctx,t[0],t[1]);break;default:h.h.apply(h.ctx,t);break}}return s&&s.afterTrigger&&s.afterTrigger(e),this},n.prototype.triggerWithContext=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this._$handlers)return this;var i=this._$handlers[e],s=this._$eventProcessor;if(i)for(var o=t.length,l=t[o-1],a=i.length,h=0;h<a;h++){var f=i[h];if(!(s&&s.filter&&f.query!=null&&!s.filter(e,f.query)))switch(o){case 0:f.h.call(l);break;case 1:f.h.call(l,t[0]);break;case 2:f.h.call(l,t[0],t[1]);break;default:f.h.apply(l,t.slice(1,o-1));break}}return s&&s.afterTrigger&&s.afterTrigger(e),this},n}(),tEe=Math.log(2);function hz(n,e,t,r,i,s){var o=r+"-"+i,l=n.length;if(s.hasOwnProperty(o))return s[o];if(e===1){var a=Math.round(Math.log((1<<l)-1&~i)/tEe);return n[t][a]}for(var h=r|1<<t,f=t+1;r&1<<f;)f++;for(var p=0,v=0,y=0;v<l;v++){var S=1<<v;S&i||(p+=(y%2?-1:1)*n[t][v]*hz(n,e-1,f,h,i|S,s),y++)}return s[o]=p,p}function rX(n,e){var t=[[n[0],n[1],1,0,0,0,-e[0]*n[0],-e[0]*n[1]],[0,0,0,n[0],n[1],1,-e[1]*n[0],-e[1]*n[1]],[n[2],n[3],1,0,0,0,-e[2]*n[2],-e[2]*n[3]],[0,0,0,n[2],n[3],1,-e[3]*n[2],-e[3]*n[3]],[n[4],n[5],1,0,0,0,-e[4]*n[4],-e[4]*n[5]],[0,0,0,n[4],n[5],1,-e[5]*n[4],-e[5]*n[5]],[n[6],n[7],1,0,0,0,-e[6]*n[6],-e[6]*n[7]],[0,0,0,n[6],n[7],1,-e[7]*n[6],-e[7]*n[7]]],r={},i=hz(t,8,0,0,0,r);if(i!==0){for(var s=[],o=0;o<8;o++)for(var l=0;l<8;l++)s[l]==null&&(s[l]=0),s[l]+=((o+l)%2?-1:1)*hz(t,7,o===0?1:0,1<<o,1<<l,r)/i*e[o];return function(a,h,f){var p=h*s[6]+f*s[7]+1;a[0]=(h*s[0]+f*s[1]+s[2])/p,a[1]=(h*s[3]+f*s[4]+s[5])/p}}}var iX="___zrEVENTSAVED",RF=[];function nEe(n,e,t,r,i){return fz(RF,e,r,i,!0)&&fz(n,t,RF[0],RF[1])}function fz(n,e,t,r,i){if(e.getBoundingClientRect&&gi.domSupported&&!xie(e)){var s=e[iX]||(e[iX]={}),o=rEe(e,s),l=iEe(o,s,i);if(l)return l(n,t,r),!0}return!1}function rEe(n,e){var t=e.markers;if(t)return t;t=e.markers=[];for(var r=["left","right"],i=["top","bottom"],s=0;s<4;s++){var o=document.createElement("div"),l=o.style,a=s%2,h=(s>>1)%2;l.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",r[a]+":0",i[h]+":0",r[1-a]+":auto",i[1-h]+":auto",""].join("!important;"),n.appendChild(o),t.push(o)}return t}function iEe(n,e,t){for(var r=t?"invTrans":"trans",i=e[r],s=e.srcCoords,o=[],l=[],a=!0,h=0;h<4;h++){var f=n[h].getBoundingClientRect(),p=2*h,v=f.left,y=f.top;o.push(v,y),a=a&&s&&v===s[p]&&y===s[p+1],l.push(n[h].offsetLeft,n[h].offsetTop)}return a&&i?i:(e.srcCoords=o,e[r]=t?rX(l,o):rX(o,l))}function xie(n){return n.nodeName.toUpperCase()==="CANVAS"}var sEe=/([&<>"'])/g,aEe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Du(n){return n==null?"":(n+"").replace(sEe,function(e,t){return aEe[t]})}var oEe=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,PF=[],lEe=gi.browser.firefox&&+gi.browser.version.split(".")[0]<39;function dz(n,e,t,r){return t=t||{},r?sX(n,e,t):lEe&&e.layerX!=null&&e.layerX!==e.offsetX?(t.zrX=e.layerX,t.zrY=e.layerY):e.offsetX!=null?(t.zrX=e.offsetX,t.zrY=e.offsetY):sX(n,e,t),t}function sX(n,e,t){if(gi.domSupported&&n.getBoundingClientRect){var r=e.clientX,i=e.clientY;if(xie(n)){var s=n.getBoundingClientRect();t.zrX=r-s.left,t.zrY=i-s.top;return}else if(fz(PF,n,r,i)){t.zrX=PF[0],t.zrY=PF[1];return}}t.zrX=t.zrY=0}function X6(n){return n||window.event}function gh(n,e,t){if(e=X6(e),e.zrX!=null)return e;var r=e.type,i=r&&r.indexOf("touch")>=0;if(i){var o=r!=="touchend"?e.targetTouches[0]:e.changedTouches[0];o&&dz(n,o,e,t)}else{dz(n,e,e,t);var s=cEe(e);e.zrDelta=s?s/120:-(e.detail||0)/3}var l=e.button;return e.which==null&&l!==void 0&&oEe.test(e.type)&&(e.which=l&1?1:l&2?3:l&4?2:0),e}function cEe(n){var e=n.wheelDelta;if(e)return e;var t=n.deltaX,r=n.deltaY;if(t==null||r==null)return e;var i=Math.abs(r!==0?r:t),s=r>0?-1:r<0?1:t>0?-1:1;return 3*i*s}function pz(n,e,t,r){n.addEventListener(e,t,r)}function uEe(n,e,t,r){n.removeEventListener(e,t,r)}var bie=function(n){n.preventDefault(),n.stopPropagation(),n.cancelBubble=!0},hEe=function(){function n(){this._track=[]}return n.prototype.recognize=function(e,t,r){return this._doTrack(e,t,r),this._recognize(e)},n.prototype.clear=function(){return this._track.length=0,this},n.prototype._doTrack=function(e,t,r){var i=e.touches;if(i){for(var s={points:[],touches:[],target:t,event:e},o=0,l=i.length;o<l;o++){var a=i[o],h=dz(r,a,{});s.points.push([h.zrX,h.zrY]),s.touches.push(a)}this._track.push(s)}},n.prototype._recognize=function(e){for(var t in LF)if(LF.hasOwnProperty(t)){var r=LF[t](this._track,e);if(r)return r}},n}();function aX(n){var e=n[1][0]-n[0][0],t=n[1][1]-n[0][1];return Math.sqrt(e*e+t*t)}function fEe(n){return[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]}var LF={pinch:function(n,e){var t=n.length;if(t){var r=(n[t-1]||{}).points,i=(n[t-2]||{}).points||r;if(i&&i.length>1&&r&&r.length>1){var s=aX(r)/aX(i);!isFinite(s)&&(s=1),e.pinchScale=s;var o=fEe(r);return e.pinchX=o[0],e.pinchY=o[1],{type:"pinch",target:n[0].target,event:e}}}}};function Vy(){return[1,0,0,1,0,0]}function q6(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=1,n[4]=0,n[5]=0,n}function dEe(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n}function Ub(n,e,t){var r=e[0]*t[0]+e[2]*t[1],i=e[1]*t[0]+e[3]*t[1],s=e[0]*t[2]+e[2]*t[3],o=e[1]*t[2]+e[3]*t[3],l=e[0]*t[4]+e[2]*t[5]+e[4],a=e[1]*t[4]+e[3]*t[5]+e[5];return n[0]=r,n[1]=i,n[2]=s,n[3]=o,n[4]=l,n[5]=a,n}function kP(n,e,t){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4]+t[0],n[5]=e[5]+t[1],n}function HD(n,e,t,r){r===void 0&&(r=[0,0]);var i=e[0],s=e[2],o=e[4],l=e[1],a=e[3],h=e[5],f=Math.sin(t),p=Math.cos(t);return n[0]=i*p+l*f,n[1]=-i*f+l*p,n[2]=s*p+a*f,n[3]=-s*f+p*a,n[4]=p*(o-r[0])+f*(h-r[1])+r[0],n[5]=p*(h-r[1])-f*(o-r[0])+r[1],n}function pEe(n,e,t){var r=t[0],i=t[1];return n[0]=e[0]*r,n[1]=e[1]*i,n[2]=e[2]*r,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*i,n}function jD(n,e){var t=e[0],r=e[2],i=e[4],s=e[1],o=e[3],l=e[5],a=t*o-s*r;return a?(a=1/a,n[0]=o*a,n[1]=-s*a,n[2]=-r*a,n[3]=t*a,n[4]=(r*l-o*i)*a,n[5]=(s*i-t*l)*a,n):null}var Jr=function(){function n(e,t){this.x=e||0,this.y=t||0}return n.prototype.copy=function(e){return this.x=e.x,this.y=e.y,this},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.set=function(e,t){return this.x=e,this.y=t,this},n.prototype.equal=function(e){return e.x===this.x&&e.y===this.y},n.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},n.prototype.scale=function(e){this.x*=e,this.y*=e},n.prototype.scaleAndAdd=function(e,t){this.x+=e.x*t,this.y+=e.y*t},n.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},n.prototype.dot=function(e){return this.x*e.x+this.y*e.y},n.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},n.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},n.prototype.normalize=function(){var e=this.len();return this.x/=e,this.y/=e,this},n.prototype.distance=function(e){var t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)},n.prototype.distanceSquare=function(e){var t=this.x-e.x,r=this.y-e.y;return t*t+r*r},n.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},n.prototype.transform=function(e){if(e){var t=this.x,r=this.y;return this.x=e[0]*t+e[2]*r+e[4],this.y=e[1]*t+e[3]*r+e[5],this}},n.prototype.toArray=function(e){return e[0]=this.x,e[1]=this.y,e},n.prototype.fromArray=function(e){this.x=e[0],this.y=e[1]},n.set=function(e,t,r){e.x=t,e.y=r},n.copy=function(e,t){e.x=t.x,e.y=t.y},n.len=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.lenSquare=function(e){return e.x*e.x+e.y*e.y},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.add=function(e,t,r){e.x=t.x+r.x,e.y=t.y+r.y},n.sub=function(e,t,r){e.x=t.x-r.x,e.y=t.y-r.y},n.scale=function(e,t,r){e.x=t.x*r,e.y=t.y*r},n.scaleAndAdd=function(e,t,r,i){e.x=t.x+r.x*i,e.y=t.y+r.y*i},n.lerp=function(e,t,r,i){var s=1-i;e.x=s*t.x+i*r.x,e.y=s*t.y+i*r.y},n}(),F2=Math.min,N2=Math.max,k_=new Jr,O_=new Jr,F_=new Jr,N_=new Jr,qS=new Jr,ZS=new Jr,mEe=function(){function n(e,t,r,i){r<0&&(e=e+r,r=-r),i<0&&(t=t+i,i=-i),this.x=e,this.y=t,this.width=r,this.height=i}return n.prototype.union=function(e){var t=F2(e.x,this.x),r=F2(e.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=N2(e.x+e.width,this.x+this.width)-t:this.width=e.width,isFinite(this.y)&&isFinite(this.height)?this.height=N2(e.y+e.height,this.y+this.height)-r:this.height=e.height,this.x=t,this.y=r},n.prototype.applyTransform=function(e){n.applyTransform(this,this,e)},n.prototype.calculateTransform=function(e){var t=this,r=e.width/t.width,i=e.height/t.height,s=Vy();return kP(s,s,[-t.x,-t.y]),pEe(s,s,[r,i]),kP(s,s,[e.x,e.y]),s},n.prototype.intersect=function(e,t){if(!e)return!1;e instanceof n||(e=n.create(e));var r=this,i=r.x,s=r.x+r.width,o=r.y,l=r.y+r.height,a=e.x,h=e.x+e.width,f=e.y,p=e.y+e.height,v=!(s<a||h<i||l<f||p<o);if(t){var y=1/0,S=0,C=Math.abs(s-a),M=Math.abs(h-i),E=Math.abs(l-f),L=Math.abs(p-o),k=Math.min(C,M),H=Math.min(E,L);s<a||h<i?k>S&&(S=k,C<M?Jr.set(ZS,-C,0):Jr.set(ZS,M,0)):k<y&&(y=k,C<M?Jr.set(qS,C,0):Jr.set(qS,-M,0)),l<f||p<o?H>S&&(S=H,E<L?Jr.set(ZS,0,-E):Jr.set(ZS,0,L)):k<y&&(y=k,E<L?Jr.set(qS,0,E):Jr.set(qS,0,-L))}return t&&Jr.copy(t,v?qS:ZS),v},n.prototype.contain=function(e,t){var r=this;return e>=r.x&&e<=r.x+r.width&&t>=r.y&&t<=r.y+r.height},n.prototype.clone=function(){return new n(this.x,this.y,this.width,this.height)},n.prototype.copy=function(e){n.copy(this,e)},n.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},n.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},n.prototype.isZero=function(){return this.width===0||this.height===0},n.create=function(e){return new n(e.x,e.y,e.width,e.height)},n.copy=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},n.applyTransform=function(e,t,r){if(!r){e!==t&&n.copy(e,t);return}if(r[1]<1e-5&&r[1]>-1e-5&&r[2]<1e-5&&r[2]>-1e-5){var i=r[0],s=r[3],o=r[4],l=r[5];e.x=t.x*i+o,e.y=t.y*s+l,e.width=t.width*i,e.height=t.height*s,e.width<0&&(e.x+=e.width,e.width=-e.width),e.height<0&&(e.y+=e.height,e.height=-e.height);return}k_.x=F_.x=t.x,k_.y=N_.y=t.y,O_.x=N_.x=t.x+t.width,O_.y=F_.y=t.y+t.height,k_.transform(r),N_.transform(r),O_.transform(r),F_.transform(r),e.x=F2(k_.x,O_.x,F_.x,N_.x),e.y=F2(k_.y,O_.y,F_.y,N_.y);var a=N2(k_.x,O_.x,F_.x,N_.x),h=N2(k_.y,O_.y,F_.y,N_.y);e.width=a-e.x,e.height=h-e.y},n}();const cs=mEe;var wie="silent";function gEe(n,e,t){return{type:n,event:t,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:t.zrX,offsetY:t.zrY,gestureEvent:t.gestureEvent,pinchX:t.pinchX,pinchY:t.pinchY,pinchScale:t.pinchScale,wheelDelta:t.zrDelta,zrByTouch:t.zrByTouch,which:t.which,stop:vEe}}function vEe(){bie(this.event)}var _Ee=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.handler=null,t}return e.prototype.dispose=function(){},e.prototype.setCursor=function(){},e}(ld),YS=function(){function n(e,t){this.x=e,this.y=t}return n}(),yEe=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],DF=new cs(0,0,0,0),Sie=function(n){Hn(e,n);function e(t,r,i,s,o){var l=n.call(this)||this;return l._hovered=new YS(0,0),l.storage=t,l.painter=r,l.painterRoot=s,l._pointerSize=o,i=i||new _Ee,l.proxy=null,l.setHandlerProxy(i),l._draggingMgr=new eEe(l),l}return e.prototype.setHandlerProxy=function(t){this.proxy&&this.proxy.dispose(),t&&(it(yEe,function(r){t.on&&t.on(r,this[r],this)},this),t.handler=this),this.proxy=t},e.prototype.mousemove=function(t){var r=t.zrX,i=t.zrY,s=Aie(this,r,i),o=this._hovered,l=o.target;l&&!l.__zr&&(o=this.findHover(o.x,o.y),l=o.target);var a=this._hovered=s?new YS(r,i):this.findHover(r,i),h=a.target,f=this.proxy;f.setCursor&&f.setCursor(h?h.cursor:"default"),l&&h!==l&&this.dispatchToElement(o,"mouseout",t),this.dispatchToElement(a,"mousemove",t),h&&h!==l&&this.dispatchToElement(a,"mouseover",t)},e.prototype.mouseout=function(t){var r=t.zrEventControl;r!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",t),r!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:t})},e.prototype.resize=function(){this._hovered=new YS(0,0)},e.prototype.dispatch=function(t,r){var i=this[t];i&&i.call(this,r)},e.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},e.prototype.setCursorStyle=function(t){var r=this.proxy;r.setCursor&&r.setCursor(t)},e.prototype.dispatchToElement=function(t,r,i){t=t||{};var s=t.target;if(!(s&&s.silent)){for(var o="on"+r,l=gEe(r,t,i);s&&(s[o]&&(l.cancelBubble=!!s[o].call(s,l)),s.trigger(r,l),s=s.__hostTarget?s.__hostTarget:s.parent,!l.cancelBubble););l.cancelBubble||(this.trigger(r,l),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(a){typeof a[o]=="function"&&a[o].call(a,l),a.trigger&&a.trigger(r,l)}))}},e.prototype.findHover=function(t,r,i){var s=this.storage.getDisplayList(),o=new YS(t,r);if(oX(s,o,t,r,i),this._pointerSize&&!o.target){for(var l=[],a=this._pointerSize,h=a/2,f=new cs(t-h,r-h,a,a),p=s.length-1;p>=0;p--){var v=s[p];v!==i&&!v.ignore&&!v.ignoreCoarsePointer&&(!v.parent||!v.parent.ignoreCoarsePointer)&&(DF.copy(v.getBoundingRect()),v.transform&&DF.applyTransform(v.transform),DF.intersect(f)&&l.push(v))}if(l.length)for(var y=4,S=Math.PI/12,C=Math.PI*2,M=0;M<h;M+=y)for(var E=0;E<C;E+=S){var L=t+M*Math.cos(E),k=r+M*Math.sin(E);if(oX(l,o,L,k,i),o.target)return o}}return o},e.prototype.processGesture=function(t,r){this._gestureMgr||(this._gestureMgr=new hEe);var i=this._gestureMgr;r==="start"&&i.clear();var s=i.recognize(t,this.findHover(t.zrX,t.zrY,null).target,this.proxy.dom);if(r==="end"&&i.clear(),s){var o=s.type;t.gestureEvent=o;var l=new YS;l.target=s.target,this.dispatchToElement(l,o,s.event)}},e}(ld);it(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(n){Sie.prototype[n]=function(e){var t=e.zrX,r=e.zrY,i=Aie(this,t,r),s,o;if((n!=="mouseup"||!i)&&(s=this.findHover(t,r),o=s.target),n==="mousedown")this._downEl=o,this._downPoint=[e.zrX,e.zrY],this._upEl=o;else if(n==="mouseup")this._upEl=o;else if(n==="click"){if(this._downEl!==this._upEl||!this._downPoint||uz(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(s,n,e)}});function xEe(n,e,t){if(n[n.rectHover?"rectContain":"contain"](e,t)){for(var r=n,i=void 0,s=!1;r;){if(r.ignoreClip&&(s=!0),!s){var o=r.getClipPath();if(o&&!o.contain(e,t))return!1}r.silent&&(i=!0);var l=r.__hostTarget;r=l||r.parent}return i?wie:!0}return!1}function oX(n,e,t,r,i){for(var s=n.length-1;s>=0;s--){var o=n[s],l=void 0;if(o!==i&&!o.ignore&&(l=xEe(o,t,r))&&(!e.topTarget&&(e.topTarget=o),l!==wie)){e.target=o;break}}}function Aie(n,e,t){var r=n.painter;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}var Tie=32,KS=7;function bEe(n){for(var e=0;n>=Tie;)e|=n&1,n>>=1;return n+e}function lX(n,e,t,r){var i=e+1;if(i===t)return 1;if(r(n[i++],n[e])<0){for(;i<t&&r(n[i],n[i-1])<0;)i++;wEe(n,e,i)}else for(;i<t&&r(n[i],n[i-1])>=0;)i++;return i-e}function wEe(n,e,t){for(t--;e<t;){var r=n[e];n[e++]=n[t],n[t--]=r}}function cX(n,e,t,r,i){for(r===e&&r++;r<t;r++){for(var s=n[r],o=e,l=r,a;o<l;)a=o+l>>>1,i(s,n[a])<0?l=a:o=a+1;var h=r-o;switch(h){case 3:n[o+3]=n[o+2];case 2:n[o+2]=n[o+1];case 1:n[o+1]=n[o];break;default:for(;h>0;)n[o+h]=n[o+h-1],h--}n[o]=s}}function BF(n,e,t,r,i,s){var o=0,l=0,a=1;if(s(n,e[t+i])>0){for(l=r-i;a<l&&s(n,e[t+i+a])>0;)o=a,a=(a<<1)+1,a<=0&&(a=l);a>l&&(a=l),o+=i,a+=i}else{for(l=i+1;a<l&&s(n,e[t+i-a])<=0;)o=a,a=(a<<1)+1,a<=0&&(a=l);a>l&&(a=l);var h=o;o=i-a,a=i-h}for(o++;o<a;){var f=o+(a-o>>>1);s(n,e[t+f])>0?o=f+1:a=f}return a}function kF(n,e,t,r,i,s){var o=0,l=0,a=1;if(s(n,e[t+i])<0){for(l=i+1;a<l&&s(n,e[t+i-a])<0;)o=a,a=(a<<1)+1,a<=0&&(a=l);a>l&&(a=l);var h=o;o=i-a,a=i-h}else{for(l=r-i;a<l&&s(n,e[t+i+a])>=0;)o=a,a=(a<<1)+1,a<=0&&(a=l);a>l&&(a=l),o+=i,a+=i}for(o++;o<a;){var f=o+(a-o>>>1);s(n,e[t+f])<0?a=f:o=f+1}return a}function SEe(n,e){var t=KS,r,i,s=0,o=[];r=[],i=[];function l(y,S){r[s]=y,i[s]=S,s+=1}function a(){for(;s>1;){var y=s-2;if(y>=1&&i[y-1]<=i[y]+i[y+1]||y>=2&&i[y-2]<=i[y]+i[y-1])i[y-1]<i[y+1]&&y--;else if(i[y]>i[y+1])break;f(y)}}function h(){for(;s>1;){var y=s-2;y>0&&i[y-1]<i[y+1]&&y--,f(y)}}function f(y){var S=r[y],C=i[y],M=r[y+1],E=i[y+1];i[y]=C+E,y===s-3&&(r[y+1]=r[y+2],i[y+1]=i[y+2]),s--;var L=kF(n[M],n,S,C,0,e);S+=L,C-=L,C!==0&&(E=BF(n[S+C-1],n,M,E,E-1,e),E!==0&&(C<=E?p(S,C,M,E):v(S,C,M,E)))}function p(y,S,C,M){var E=0;for(E=0;E<S;E++)o[E]=n[y+E];var L=0,k=C,H=y;if(n[H++]=n[k++],--M===0){for(E=0;E<S;E++)n[H+E]=o[L+E];return}if(S===1){for(E=0;E<M;E++)n[H+E]=n[k+E];n[H+M]=o[L];return}for(var X=t,Z,Q,re;;){Z=0,Q=0,re=!1;do if(e(n[k],o[L])<0){if(n[H++]=n[k++],Q++,Z=0,--M===0){re=!0;break}}else if(n[H++]=o[L++],Z++,Q=0,--S===1){re=!0;break}while((Z|Q)<X);if(re)break;do{if(Z=kF(n[k],o,L,S,0,e),Z!==0){for(E=0;E<Z;E++)n[H+E]=o[L+E];if(H+=Z,L+=Z,S-=Z,S<=1){re=!0;break}}if(n[H++]=n[k++],--M===0){re=!0;break}if(Q=BF(o[L],n,k,M,0,e),Q!==0){for(E=0;E<Q;E++)n[H+E]=n[k+E];if(H+=Q,k+=Q,M-=Q,M===0){re=!0;break}}if(n[H++]=o[L++],--S===1){re=!0;break}X--}while(Z>=KS||Q>=KS);if(re)break;X<0&&(X=0),X+=2}if(t=X,t<1&&(t=1),S===1){for(E=0;E<M;E++)n[H+E]=n[k+E];n[H+M]=o[L]}else{if(S===0)throw new Error;for(E=0;E<S;E++)n[H+E]=o[L+E]}}function v(y,S,C,M){var E=0;for(E=0;E<M;E++)o[E]=n[C+E];var L=y+S-1,k=M-1,H=C+M-1,X=0,Z=0;if(n[H--]=n[L--],--S===0){for(X=H-(M-1),E=0;E<M;E++)n[X+E]=o[E];return}if(M===1){for(H-=S,L-=S,Z=H+1,X=L+1,E=S-1;E>=0;E--)n[Z+E]=n[X+E];n[H]=o[k];return}for(var Q=t;;){var re=0,ie=0,oe=!1;do if(e(o[k],n[L])<0){if(n[H--]=n[L--],re++,ie=0,--S===0){oe=!0;break}}else if(n[H--]=o[k--],ie++,re=0,--M===1){oe=!0;break}while((re|ie)<Q);if(oe)break;do{if(re=S-kF(o[k],n,y,S,S-1,e),re!==0){for(H-=re,L-=re,S-=re,Z=H+1,X=L+1,E=re-1;E>=0;E--)n[Z+E]=n[X+E];if(S===0){oe=!0;break}}if(n[H--]=o[k--],--M===1){oe=!0;break}if(ie=M-BF(n[L],o,0,M,M-1,e),ie!==0){for(H-=ie,k-=ie,M-=ie,Z=H+1,X=k+1,E=0;E<ie;E++)n[Z+E]=o[X+E];if(M<=1){oe=!0;break}}if(n[H--]=n[L--],--S===0){oe=!0;break}Q--}while(re>=KS||ie>=KS);if(oe)break;Q<0&&(Q=0),Q+=2}if(t=Q,t<1&&(t=1),M===1){for(H-=S,L-=S,Z=H+1,X=L+1,E=S-1;E>=0;E--)n[Z+E]=n[X+E];n[H]=o[k]}else{if(M===0)throw new Error;for(X=H-(M-1),E=0;E<M;E++)n[X+E]=o[E]}}return{mergeRuns:a,forceMergeRuns:h,pushRun:l}}function sR(n,e,t,r){t||(t=0),r||(r=n.length);var i=r-t;if(!(i<2)){var s=0;if(i<Tie){s=lX(n,t,r,e),cX(n,t,r,t+s,e);return}var o=SEe(n,e),l=bEe(i);do{if(s=lX(n,t,r,e),s<l){var a=i;a>l&&(a=l),cX(n,t,t+a,t+s,e),s=a}o.pushRun(t,s),o.mergeRuns(),i-=s,t+=s}while(i!==0);o.forceMergeRuns()}}var Bu=1,LA=2,rb=4,uX=!1;function OF(){uX||(uX=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function hX(n,e){return n.zlevel===e.zlevel?n.z===e.z?n.z2-e.z2:n.z-e.z:n.zlevel-e.zlevel}var AEe=function(){function n(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=hX}return n.prototype.traverse=function(e,t){for(var r=0;r<this._roots.length;r++)this._roots[r].traverse(e,t)},n.prototype.getDisplayList=function(e,t){t=t||!1;var r=this._displayList;return(e||!r.length)&&this.updateDisplayList(t),r},n.prototype.updateDisplayList=function(e){this._displayListLen=0;for(var t=this._roots,r=this._displayList,i=0,s=t.length;i<s;i++)this._updateAndAddDisplayable(t[i],null,e);r.length=this._displayListLen,sR(r,hX)},n.prototype._updateAndAddDisplayable=function(e,t,r){if(!(e.ignore&&!r)){e.beforeUpdate(),e.update(),e.afterUpdate();var i=e.getClipPath();if(e.ignoreClip)t=null;else if(i){t?t=t.slice():t=[];for(var s=i,o=e;s;)s.parent=o,s.updateTransform(),t.push(s),o=s,s=s.getClipPath()}if(e.childrenRef){for(var l=e.childrenRef(),a=0;a<l.length;a++){var h=l[a];e.__dirty&&(h.__dirty|=Bu),this._updateAndAddDisplayable(h,t,r)}e.__dirty=0}else{var f=e;t&&t.length?f.__clipPaths=t:f.__clipPaths&&f.__clipPaths.length>0&&(f.__clipPaths=[]),isNaN(f.z)&&(OF(),f.z=0),isNaN(f.z2)&&(OF(),f.z2=0),isNaN(f.zlevel)&&(OF(),f.zlevel=0),this._displayList[this._displayListLen++]=f}var p=e.getDecalElement&&e.getDecalElement();p&&this._updateAndAddDisplayable(p,t,r);var v=e.getTextGuideLine();v&&this._updateAndAddDisplayable(v,t,r);var y=e.getTextContent();y&&this._updateAndAddDisplayable(y,t,r)}},n.prototype.addRoot=function(e){e.__zr&&e.__zr.storage===this||this._roots.push(e)},n.prototype.delRoot=function(e){if(e instanceof Array){for(var t=0,r=e.length;t<r;t++)this.delRoot(e[t]);return}var i=Xi(this._roots,e);i>=0&&this._roots.splice(i,1)},n.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},n.prototype.getRoots=function(){return this._roots},n.prototype.dispose=function(){this._displayList=null,this._roots=null},n}(),OP;OP=gi.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(n){return setTimeout(n,16)};var fT={linear:function(n){return n},quadraticIn:function(n){return n*n},quadraticOut:function(n){return n*(2-n)},quadraticInOut:function(n){return(n*=2)<1?.5*n*n:-.5*(--n*(n-2)-1)},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return(n*=2)<1?.5*n*n*n:.5*((n-=2)*n*n+2)},quarticIn:function(n){return n*n*n*n},quarticOut:function(n){return 1- --n*n*n*n},quarticInOut:function(n){return(n*=2)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2)},quinticIn:function(n){return n*n*n*n*n},quinticOut:function(n){return--n*n*n*n*n+1},quinticInOut:function(n){return(n*=2)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2)},sinusoidalIn:function(n){return 1-Math.cos(n*Math.PI/2)},sinusoidalOut:function(n){return Math.sin(n*Math.PI/2)},sinusoidalInOut:function(n){return .5*(1-Math.cos(Math.PI*n))},exponentialIn:function(n){return n===0?0:Math.pow(1024,n-1)},exponentialOut:function(n){return n===1?1:1-Math.pow(2,-10*n)},exponentialInOut:function(n){return n===0?0:n===1?1:(n*=2)<1?.5*Math.pow(1024,n-1):.5*(-Math.pow(2,-10*(n-1))+2)},circularIn:function(n){return 1-Math.sqrt(1-n*n)},circularOut:function(n){return Math.sqrt(1- --n*n)},circularInOut:function(n){return(n*=2)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1)},elasticIn:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),-(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)))},elasticOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*n)*Math.sin((n-e)*(2*Math.PI)/r)+1)},elasticInOut:function(n){var e,t=.1,r=.4;return n===0?0:n===1?1:(!t||t<1?(t=1,e=r/4):e=r*Math.asin(1/t)/(2*Math.PI),(n*=2)<1?-.5*(t*Math.pow(2,10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)):t*Math.pow(2,-10*(n-=1))*Math.sin((n-e)*(2*Math.PI)/r)*.5+1)},backIn:function(n){var e=1.70158;return n*n*((e+1)*n-e)},backOut:function(n){var e=1.70158;return--n*n*((e+1)*n+e)+1},backInOut:function(n){var e=2.5949095;return(n*=2)<1?.5*(n*n*((e+1)*n-e)):.5*((n-=2)*n*((e+1)*n+e)+2)},bounceIn:function(n){return 1-fT.bounceOut(1-n)},bounceOut:function(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},bounceInOut:function(n){return n<.5?fT.bounceIn(n*2)*.5:fT.bounceOut(n*2-1)*.5+.5}},z2=Math.pow,o0=Math.sqrt,FP=1e-8,Mie=1e-4,fX=o0(3),U2=1/3,Qd=Lw(),wh=Lw(),Gb=Lw();function Xv(n){return n>-FP&&n<FP}function Eie(n){return n>FP||n<-FP}function Vo(n,e,t,r,i){var s=1-i;return s*s*(s*n+3*i*e)+i*i*(i*r+3*s*t)}function dX(n,e,t,r,i){var s=1-i;return 3*(((e-n)*s+2*(t-e)*i)*s+(r-t)*i*i)}function NP(n,e,t,r,i,s){var o=r+3*(e-t)-n,l=3*(t-e*2+n),a=3*(e-n),h=n-i,f=l*l-3*o*a,p=l*a-9*o*h,v=a*a-3*l*h,y=0;if(Xv(f)&&Xv(p))if(Xv(l))s[0]=0;else{var S=-a/l;S>=0&&S<=1&&(s[y++]=S)}else{var C=p*p-4*f*v;if(Xv(C)){var M=p/f,S=-l/o+M,E=-M/2;S>=0&&S<=1&&(s[y++]=S),E>=0&&E<=1&&(s[y++]=E)}else if(C>0){var L=o0(C),k=f*l+1.5*o*(-p+L),H=f*l+1.5*o*(-p-L);k<0?k=-z2(-k,U2):k=z2(k,U2),H<0?H=-z2(-H,U2):H=z2(H,U2);var S=(-l-(k+H))/(3*o);S>=0&&S<=1&&(s[y++]=S)}else{var X=(2*f*l-3*o*p)/(2*o0(f*f*f)),Z=Math.acos(X)/3,Q=o0(f),re=Math.cos(Z),S=(-l-2*Q*re)/(3*o),E=(-l+Q*(re+fX*Math.sin(Z)))/(3*o),ie=(-l+Q*(re-fX*Math.sin(Z)))/(3*o);S>=0&&S<=1&&(s[y++]=S),E>=0&&E<=1&&(s[y++]=E),ie>=0&&ie<=1&&(s[y++]=ie)}}return y}function Cie(n,e,t,r,i){var s=6*t-12*e+6*n,o=9*e+3*r-3*n-9*t,l=3*e-3*n,a=0;if(Xv(o)){if(Eie(s)){var h=-l/s;h>=0&&h<=1&&(i[a++]=h)}}else{var f=s*s-4*o*l;if(Xv(f))i[0]=-s/(2*o);else if(f>0){var p=o0(f),h=(-s+p)/(2*o),v=(-s-p)/(2*o);h>=0&&h<=1&&(i[a++]=h),v>=0&&v<=1&&(i[a++]=v)}}return a}function _0(n,e,t,r,i,s){var o=(e-n)*i+n,l=(t-e)*i+e,a=(r-t)*i+t,h=(l-o)*i+o,f=(a-l)*i+l,p=(f-h)*i+h;s[0]=n,s[1]=o,s[2]=h,s[3]=p,s[4]=p,s[5]=f,s[6]=a,s[7]=r}function Iie(n,e,t,r,i,s,o,l,a,h,f){var p,v=.005,y=1/0,S,C,M,E;Qd[0]=a,Qd[1]=h;for(var L=0;L<1;L+=.05)wh[0]=Vo(n,t,i,o,L),wh[1]=Vo(e,r,s,l,L),M=zb(Qd,wh),M<y&&(p=L,y=M);y=1/0;for(var k=0;k<32&&!(v<Mie);k++)S=p-v,C=p+v,wh[0]=Vo(n,t,i,o,S),wh[1]=Vo(e,r,s,l,S),M=zb(wh,Qd),S>=0&&M<y?(p=S,y=M):(Gb[0]=Vo(n,t,i,o,C),Gb[1]=Vo(e,r,s,l,C),E=zb(Gb,Qd),C<=1&&E<y?(p=C,y=E):v*=.5);return f&&(f[0]=Vo(n,t,i,o,p),f[1]=Vo(e,r,s,l,p)),o0(y)}function TEe(n,e,t,r,i,s,o,l,a){for(var h=n,f=e,p=0,v=1/a,y=1;y<=a;y++){var S=y*v,C=Vo(n,t,i,o,S),M=Vo(e,r,s,l,S),E=C-h,L=M-f;p+=Math.sqrt(E*E+L*L),h=C,f=M}return p}function Vl(n,e,t,r){var i=1-r;return i*(i*n+2*r*e)+r*r*t}function pX(n,e,t,r){return 2*((1-r)*(e-n)+r*(t-e))}function MEe(n,e,t,r,i){var s=n-2*e+t,o=2*(e-n),l=n-r,a=0;if(Xv(s)){if(Eie(o)){var h=-l/o;h>=0&&h<=1&&(i[a++]=h)}}else{var f=o*o-4*s*l;if(Xv(f)){var h=-o/(2*s);h>=0&&h<=1&&(i[a++]=h)}else if(f>0){var p=o0(f),h=(-o+p)/(2*s),v=(-o-p)/(2*s);h>=0&&h<=1&&(i[a++]=h),v>=0&&v<=1&&(i[a++]=v)}}return a}function Rie(n,e,t){var r=n+t-2*e;return r===0?.5:(n-e)/r}function zP(n,e,t,r,i){var s=(e-n)*r+n,o=(t-e)*r+e,l=(o-s)*r+s;i[0]=n,i[1]=s,i[2]=l,i[3]=l,i[4]=o,i[5]=t}function Pie(n,e,t,r,i,s,o,l,a){var h,f=.005,p=1/0;Qd[0]=o,Qd[1]=l;for(var v=0;v<1;v+=.05){wh[0]=Vl(n,t,i,v),wh[1]=Vl(e,r,s,v);var y=zb(Qd,wh);y<p&&(h=v,p=y)}p=1/0;for(var S=0;S<32&&!(f<Mie);S++){var C=h-f,M=h+f;wh[0]=Vl(n,t,i,C),wh[1]=Vl(e,r,s,C);var y=zb(wh,Qd);if(C>=0&&y<p)h=C,p=y;else{Gb[0]=Vl(n,t,i,M),Gb[1]=Vl(e,r,s,M);var E=zb(Gb,Qd);M<=1&&E<p?(h=M,p=E):f*=.5}}return a&&(a[0]=Vl(n,t,i,h),a[1]=Vl(e,r,s,h)),o0(p)}function EEe(n,e,t,r,i,s,o){for(var l=n,a=e,h=0,f=1/o,p=1;p<=o;p++){var v=p*f,y=Vl(n,t,i,v),S=Vl(e,r,s,v),C=y-l,M=S-a;h+=Math.sqrt(C*C+M*M),l=y,a=S}return h}var CEe=/cubic-bezier\(([0-9,\.e ]+)\)/;function Lie(n){var e=n&&CEe.exec(n);if(e){var t=e[1].split(","),r=+rp(t[0]),i=+rp(t[1]),s=+rp(t[2]),o=+rp(t[3]);if(isNaN(r+i+s+o))return;var l=[];return function(a){return a<=0?0:a>=1?1:NP(0,r,s,1,a,l)&&Vo(0,i,o,1,l[0])}}}var IEe=function(){function n(e){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=e.life||1e3,this._delay=e.delay||0,this.loop=e.loop||!1,this.onframe=e.onframe||Rc,this.ondestroy=e.ondestroy||Rc,this.onrestart=e.onrestart||Rc,e.easing&&this.setEasing(e.easing)}return n.prototype.step=function(e,t){if(this._inited||(this._startTime=e+this._delay,this._inited=!0),this._paused){this._pausedTime+=t;return}var r=this._life,i=e-this._startTime-this._pausedTime,s=i/r;s<0&&(s=0),s=Math.min(s,1);var o=this.easingFunc,l=o?o(s):s;if(this.onframe(l),s===1)if(this.loop){var a=i%r;this._startTime=e-a,this._pausedTime=0,this.onrestart()}else return!0;return!1},n.prototype.pause=function(){this._paused=!0},n.prototype.resume=function(){this._paused=!1},n.prototype.setEasing=function(e){this.easing=e,this.easingFunc=ci(e)?e:fT[e]||Lie(e)},n}(),Die=function(){function n(e){this.value=e}return n}(),REe=function(){function n(){this._len=0}return n.prototype.insert=function(e){var t=new Die(e);return this.insertEntry(t),t},n.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e):this.head=this.tail=e,this._len++},n.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._len--},n.prototype.len=function(){return this._len},n.prototype.clear=function(){this.head=this.tail=null,this._len=0},n}(),pE=function(){function n(e){this._list=new REe,this._maxSize=10,this._map={},this._maxSize=e}return n.prototype.put=function(e,t){var r=this._list,i=this._map,s=null;if(i[e]==null){var o=r.len(),l=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var a=r.head;r.remove(a),delete i[a.key],s=a.value,this._lastRemovedEntry=a}l?l.value=t:l=new Die(t),l.key=e,r.insertEntry(l),i[e]=l}return s},n.prototype.get=function(e){var t=this._map[e],r=this._list;if(t!=null)return t!==r.tail&&(r.remove(t),r.insertEntry(t)),t.value},n.prototype.clear=function(){this._list.clear(),this._map={}},n.prototype.len=function(){return this._list.len()},n}(),mX={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function l0(n){return n=Math.round(n),n<0?0:n>255?255:n}function mz(n){return n<0?0:n>1?1:n}function FF(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?l0(parseFloat(e)/100*255):l0(parseInt(e,10))}function dT(n){var e=n;return e.length&&e.charAt(e.length-1)==="%"?mz(parseFloat(e)/100):mz(parseFloat(e))}function NF(n,e,t){return t<0?t+=1:t>1&&(t-=1),t*6<1?n+(e-n)*t*6:t*2<1?e:t*3<2?n+(e-n)*(2/3-t)*6:n}function G2(n,e,t){return n+(e-n)*t}function ph(n,e,t,r,i){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function gz(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n}var Bie=new pE(20),V2=null;function P1(n,e){V2&&gz(V2,e),V2=Bie.put(n,V2||e.slice())}function Um(n,e){if(n){e=e||[];var t=Bie.get(n);if(t)return gz(e,t);n=n+"";var r=n.replace(/ /g,"").toLowerCase();if(r in mX)return gz(e,mX[r]),P1(n,e),e;var i=r.length;if(r.charAt(0)==="#"){if(i===4||i===5){var s=parseInt(r.slice(1,4),16);if(!(s>=0&&s<=4095)){ph(e,0,0,0,1);return}return ph(e,(s&3840)>>4|(s&3840)>>8,s&240|(s&240)>>4,s&15|(s&15)<<4,i===5?parseInt(r.slice(4),16)/15:1),P1(n,e),e}else if(i===7||i===9){var s=parseInt(r.slice(1,7),16);if(!(s>=0&&s<=16777215)){ph(e,0,0,0,1);return}return ph(e,(s&16711680)>>16,(s&65280)>>8,s&255,i===9?parseInt(r.slice(7),16)/255:1),P1(n,e),e}return}var o=r.indexOf("("),l=r.indexOf(")");if(o!==-1&&l+1===i){var a=r.substr(0,o),h=r.substr(o+1,l-(o+1)).split(","),f=1;switch(a){case"rgba":if(h.length!==4)return h.length===3?ph(e,+h[0],+h[1],+h[2],1):ph(e,0,0,0,1);f=dT(h.pop());case"rgb":if(h.length>=3)return ph(e,FF(h[0]),FF(h[1]),FF(h[2]),h.length===3?f:dT(h[3])),P1(n,e),e;ph(e,0,0,0,1);return;case"hsla":if(h.length!==4){ph(e,0,0,0,1);return}return h[3]=dT(h[3]),gX(h,e),P1(n,e),e;case"hsl":if(h.length!==3){ph(e,0,0,0,1);return}return gX(h,e),P1(n,e),e;default:return}}ph(e,0,0,0,1)}}function gX(n,e){var t=(parseFloat(n[0])%360+360)%360/360,r=dT(n[1]),i=dT(n[2]),s=i<=.5?i*(r+1):i+r-i*r,o=i*2-s;return e=e||[],ph(e,l0(NF(o,s,t+1/3)*255),l0(NF(o,s,t)*255),l0(NF(o,s,t-1/3)*255),1),n.length===4&&(e[3]=n[3]),e}function vX(n,e){var t=Um(n);if(t){for(var r=0;r<3;r++)t[r]=t[r]*(1-e)|0,t[r]>255?t[r]=255:t[r]<0&&(t[r]=0);return WD(t,t.length===4?"rgba":"rgb")}}function PEe(n,e,t){if(!(!(e&&e.length)||!(n>=0&&n<=1))){var r=n*(e.length-1),i=Math.floor(r),s=Math.ceil(r),o=Um(e[i]),l=Um(e[s]),a=r-i,h=WD([l0(G2(o[0],l[0],a)),l0(G2(o[1],l[1],a)),l0(G2(o[2],l[2],a)),mz(G2(o[3],l[3],a))],"rgba");return t?{color:h,leftIndex:i,rightIndex:s,value:r}:h}}function WD(n,e){if(!(!n||!n.length)){var t=n[0]+","+n[1]+","+n[2];return(e==="rgba"||e==="hsva"||e==="hsla")&&(t+=","+n[3]),e+"("+t+")"}}function UP(n,e){var t=Um(n);return t?(.299*t[0]+.587*t[1]+.114*t[2])*t[3]/255+(1-t[3])*e:0}var _X=new pE(100);function yX(n){if(Dr(n)){var e=_X.get(n);return e||(e=vX(n,-.1),_X.put(n,e)),e}else if(GD(n)){var t=Jn({},n);return t.colorStops=xr(n.colorStops,function(r){return{offset:r.offset,color:vX(r.color,-.1)}}),t}return n}function LEe(n){return n.type==="linear"}function DEe(n){return n.type==="radial"}(function(){return gi.hasGlobalWindow&&ci(window.btoa)?function(n){return window.btoa(unescape(encodeURIComponent(n)))}:typeof Buffer<"u"?function(n){return Buffer.from(n).toString("base64")}:function(n){return null}})();var vz=Array.prototype.slice;function wm(n,e,t){return(e-n)*t+n}function zF(n,e,t,r){for(var i=e.length,s=0;s<i;s++)n[s]=wm(e[s],t[s],r);return n}function BEe(n,e,t,r){for(var i=e.length,s=i&&e[0].length,o=0;o<i;o++){n[o]||(n[o]=[]);for(var l=0;l<s;l++)n[o][l]=wm(e[o][l],t[o][l],r)}return n}function H2(n,e,t,r){for(var i=e.length,s=0;s<i;s++)n[s]=e[s]+t[s]*r;return n}function xX(n,e,t,r){for(var i=e.length,s=i&&e[0].length,o=0;o<i;o++){n[o]||(n[o]=[]);for(var l=0;l<s;l++)n[o][l]=e[o][l]+t[o][l]*r}return n}function kEe(n,e){for(var t=n.length,r=e.length,i=t>r?e:n,s=Math.min(t,r),o=i[s-1]||{color:[0,0,0,0],offset:0},l=s;l<Math.max(t,r);l++)i.push({offset:o.offset,color:o.color.slice()})}function OEe(n,e,t){var r=n,i=e;if(!(!r.push||!i.push)){var s=r.length,o=i.length;if(s!==o){var l=s>o;if(l)r.length=o;else for(var a=s;a<o;a++)r.push(t===1?i[a]:vz.call(i[a]))}for(var h=r[0]&&r[0].length,a=0;a<r.length;a++)if(t===1)isNaN(r[a])&&(r[a]=i[a]);else for(var f=0;f<h;f++)isNaN(r[a][f])&&(r[a][f]=i[a][f])}}function aR(n){if(Pc(n)){var e=n.length;if(Pc(n[0])){for(var t=[],r=0;r<e;r++)t.push(vz.call(n[r]));return t}return vz.call(n)}return n}function oR(n){return n[0]=Math.floor(n[0])||0,n[1]=Math.floor(n[1])||0,n[2]=Math.floor(n[2])||0,n[3]=n[3]==null?1:n[3],"rgba("+n.join(",")+")"}function FEe(n){return Pc(n&&n[0])?2:1}var j2=0,lR=1,kie=2,DA=3,_z=4,yz=5,bX=6;function wX(n){return n===_z||n===yz}function W2(n){return n===lR||n===kie}var JS=[0,0,0,0],NEe=function(){function n(e){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=e}return n.prototype.isFinished=function(){return this._finished},n.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},n.prototype.needsAnimate=function(){return this.keyframes.length>=1},n.prototype.getAdditiveTrack=function(){return this._additiveTrack},n.prototype.addKeyframe=function(e,t,r){this._needsSort=!0;var i=this.keyframes,s=i.length,o=!1,l=bX,a=t;if(Pc(t)){var h=FEe(t);l=h,(h===1&&!Ps(t[0])||h===2&&!Ps(t[0][0]))&&(o=!0)}else if(Ps(t)&&!DP(t))l=j2;else if(Dr(t))if(!isNaN(+t))l=j2;else{var f=Um(t);f&&(a=f,l=DA)}else if(GD(t)){var p=Jn({},a);p.colorStops=xr(t.colorStops,function(y){return{offset:y.offset,color:Um(y.color)}}),LEe(t)?l=_z:DEe(t)&&(l=yz),a=p}s===0?this.valType=l:(l!==this.valType||l===bX)&&(o=!0),this.discrete=this.discrete||o;var v={time:e,value:a,rawValue:t,percent:0};return r&&(v.easing=r,v.easingFunc=ci(r)?r:fT[r]||Lie(r)),i.push(v),v},n.prototype.prepare=function(e,t){var r=this.keyframes;this._needsSort&&r.sort(function(C,M){return C.time-M.time});for(var i=this.valType,s=r.length,o=r[s-1],l=this.discrete,a=W2(i),h=wX(i),f=0;f<s;f++){var p=r[f],v=p.value,y=o.value;p.percent=p.time/e,l||(a&&f!==s-1?OEe(v,y,i):h&&kEe(v.colorStops,y.colorStops))}if(!l&&i!==yz&&t&&this.needsAnimate()&&t.needsAnimate()&&i===t.valType&&!t._finished){this._additiveTrack=t;for(var S=r[0].value,f=0;f<s;f++)i===j2?r[f].additiveValue=r[f].value-S:i===DA?r[f].additiveValue=H2([],r[f].value,S,-1):W2(i)&&(r[f].additiveValue=i===lR?H2([],r[f].value,S,-1):xX([],r[f].value,S,-1))}},n.prototype.step=function(e,t){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var r=this._additiveTrack!=null,i=r?"additiveValue":"value",s=this.valType,o=this.keyframes,l=o.length,a=this.propName,h=s===DA,f,p=this._lastFr,v=Math.min,y,S;if(l===1)y=S=o[0];else{if(t<0)f=0;else if(t<this._lastFrP){var C=v(p+1,l-1);for(f=C;f>=0&&!(o[f].percent<=t);f--);f=v(f,l-2)}else{for(f=p;f<l&&!(o[f].percent>t);f++);f=v(f-1,l-2)}S=o[f+1],y=o[f]}if(y&&S){this._lastFr=f,this._lastFrP=t;var M=S.percent-y.percent,E=M===0?1:v((t-y.percent)/M,1);S.easingFunc&&(E=S.easingFunc(E));var L=r?this._additiveValue:h?JS:e[a];if((W2(s)||h)&&!L&&(L=this._additiveValue=[]),this.discrete)e[a]=E<1?y.rawValue:S.rawValue;else if(W2(s))s===lR?zF(L,y[i],S[i],E):BEe(L,y[i],S[i],E);else if(wX(s)){var k=y[i],H=S[i],X=s===_z;e[a]={type:X?"linear":"radial",x:wm(k.x,H.x,E),y:wm(k.y,H.y,E),colorStops:xr(k.colorStops,function(Q,re){var ie=H.colorStops[re];return{offset:wm(Q.offset,ie.offset,E),color:oR(zF([],Q.color,ie.color,E))}}),global:H.global},X?(e[a].x2=wm(k.x2,H.x2,E),e[a].y2=wm(k.y2,H.y2,E)):e[a].r=wm(k.r,H.r,E)}else if(h)zF(L,y[i],S[i],E),r||(e[a]=oR(L));else{var Z=wm(y[i],S[i],E);r?this._additiveValue=Z:e[a]=Z}r&&this._addToTarget(e)}}},n.prototype._addToTarget=function(e){var t=this.valType,r=this.propName,i=this._additiveValue;t===j2?e[r]=e[r]+i:t===DA?(Um(e[r],JS),H2(JS,JS,i,1),e[r]=oR(JS)):t===lR?H2(e[r],e[r],i,1):t===kie&&xX(e[r],e[r],i,1)},n}(),Z6=function(){function n(e,t,r,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=e,this._loop=t,t&&i){W6("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=r}return n.prototype.getMaxTime=function(){return this._maxTime},n.prototype.getDelay=function(){return this._delay},n.prototype.getLoop=function(){return this._loop},n.prototype.getTarget=function(){return this._target},n.prototype.changeTarget=function(e){this._target=e},n.prototype.when=function(e,t,r){return this.whenWithKeys(e,t,aa(t),r)},n.prototype.whenWithKeys=function(e,t,r,i){for(var s=this._tracks,o=0;o<r.length;o++){var l=r[o],a=s[l];if(!a){a=s[l]=new NEe(l);var h=void 0,f=this._getAdditiveTrack(l);if(f){var p=f.keyframes,v=p[p.length-1];h=v&&v.value,f.valType===DA&&h&&(h=oR(h))}else h=this._target[l];if(h==null)continue;e>0&&a.addKeyframe(0,aR(h),i),this._trackKeys.push(l)}a.addKeyframe(e,aR(t[l]),i)}return this._maxTime=Math.max(this._maxTime,e),this},n.prototype.pause=function(){this._clip.pause(),this._paused=!0},n.prototype.resume=function(){this._clip.resume(),this._paused=!1},n.prototype.isPaused=function(){return!!this._paused},n.prototype.duration=function(e){return this._maxTime=e,this._force=!0,this},n.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var e=this._doneCbs;if(e)for(var t=e.length,r=0;r<t;r++)e[r].call(this)},n.prototype._abortedCallback=function(){this._setTracksFinished();var e=this.animation,t=this._abortedCbs;if(e&&e.removeClip(this._clip),this._clip=null,t)for(var r=0;r<t.length;r++)t[r].call(this)},n.prototype._setTracksFinished=function(){for(var e=this._tracks,t=this._trackKeys,r=0;r<t.length;r++)e[t[r]].setFinished()},n.prototype._getAdditiveTrack=function(e){var t,r=this._additiveAnimators;if(r)for(var i=0;i<r.length;i++){var s=r[i].getTrack(e);s&&(t=s)}return t},n.prototype.start=function(e){if(!(this._started>0)){this._started=1;for(var t=this,r=[],i=this._maxTime||0,s=0;s<this._trackKeys.length;s++){var o=this._trackKeys[s],l=this._tracks[o],a=this._getAdditiveTrack(o),h=l.keyframes,f=h.length;if(l.prepare(i,a),l.needsAnimate())if(!this._allowDiscrete&&l.discrete){var p=h[f-1];p&&(t._target[l.propName]=p.rawValue),l.setFinished()}else r.push(l)}if(r.length||this._force){var v=new IEe({life:i,loop:this._loop,delay:this._delay||0,onframe:function(y){t._started=2;var S=t._additiveAnimators;if(S){for(var C=!1,M=0;M<S.length;M++)if(S[M]._clip){C=!0;break}C||(t._additiveAnimators=null)}for(var M=0;M<r.length;M++)r[M].step(t._target,y);var E=t._onframeCbs;if(E)for(var M=0;M<E.length;M++)E[M](t._target,y)},ondestroy:function(){t._doneCallback()}});this._clip=v,this.animation&&this.animation.addClip(v),e&&v.setEasing(e)}else this._doneCallback();return this}},n.prototype.stop=function(e){if(this._clip){var t=this._clip;e&&t.onframe(1),this._abortedCallback()}},n.prototype.delay=function(e){return this._delay=e,this},n.prototype.during=function(e){return e&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(e)),this},n.prototype.done=function(e){return e&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(e)),this},n.prototype.aborted=function(e){return e&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(e)),this},n.prototype.getClip=function(){return this._clip},n.prototype.getTrack=function(e){return this._tracks[e]},n.prototype.getTracks=function(){var e=this;return xr(this._trackKeys,function(t){return e._tracks[t]})},n.prototype.stopTracks=function(e,t){if(!e.length||!this._clip)return!0;for(var r=this._tracks,i=this._trackKeys,s=0;s<e.length;s++){var o=r[e[s]];o&&!o.isFinished()&&(t?o.step(this._target,1):this._started===1&&o.step(this._target,0),o.setFinished())}for(var l=!0,s=0;s<i.length;s++)if(!r[i[s]].isFinished()){l=!1;break}return l&&this._abortedCallback(),l},n.prototype.saveTo=function(e,t,r){if(e){t=t||this._trackKeys;for(var i=0;i<t.length;i++){var s=t[i],o=this._tracks[s];if(!(!o||o.isFinished())){var l=o.keyframes,a=l[r?0:l.length-1];a&&(e[s]=aR(a.rawValue))}}}},n.prototype.__changeFinalValue=function(e,t){t=t||aa(e);for(var r=0;r<t.length;r++){var i=t[r],s=this._tracks[i];if(s){var o=s.keyframes;if(o.length>1){var l=o.pop();s.addKeyframe(l.time,e[i]),s.prepare(this._maxTime,s.getAdditiveTrack())}}}},n}();function Eb(){return new Date().getTime()}var zEe=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r._running=!1,r._time=0,r._pausedTime=0,r._pauseStart=0,r._paused=!1,t=t||{},r.stage=t.stage||{},r}return e.prototype.addClip=function(t){t.animation&&this.removeClip(t),this._head?(this._tail.next=t,t.prev=this._tail,t.next=null,this._tail=t):this._head=this._tail=t,t.animation=this},e.prototype.addAnimator=function(t){t.animation=this;var r=t.getClip();r&&this.addClip(r)},e.prototype.removeClip=function(t){if(t.animation){var r=t.prev,i=t.next;r?r.next=i:this._head=i,i?i.prev=r:this._tail=r,t.next=t.prev=t.animation=null}},e.prototype.removeAnimator=function(t){var r=t.getClip();r&&this.removeClip(r),t.animation=null},e.prototype.update=function(t){for(var r=Eb()-this._pausedTime,i=r-this._time,s=this._head;s;){var o=s.next,l=s.step(r,i);l&&(s.ondestroy(),this.removeClip(s)),s=o}this._time=r,t||(this.trigger("frame",i),this.stage.update&&this.stage.update())},e.prototype._startLoop=function(){var t=this;this._running=!0;function r(){t._running&&(OP(r),!t._paused&&t.update())}OP(r)},e.prototype.start=function(){this._running||(this._time=Eb(),this._pausedTime=0,this._startLoop())},e.prototype.stop=function(){this._running=!1},e.prototype.pause=function(){this._paused||(this._pauseStart=Eb(),this._paused=!0)},e.prototype.resume=function(){this._paused&&(this._pausedTime+=Eb()-this._pauseStart,this._paused=!1)},e.prototype.clear=function(){for(var t=this._head;t;){var r=t.next;t.prev=t.next=t.animation=null,t=r}this._head=this._tail=null},e.prototype.isFinished=function(){return this._head==null},e.prototype.animate=function(t,r){r=r||{},this.start();var i=new Z6(t,r.loop);return this.addAnimator(i),i},e}(ld),UEe=300,UF=gi.domSupported,GF=function(){var n=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],e=["touchstart","touchend","touchmove"],t={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},r=xr(n,function(i){var s=i.replace("mouse","pointer");return t.hasOwnProperty(s)?s:i});return{mouse:n,touch:e,pointer:r}}(),SX={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},AX=!1;function xz(n){var e=n.pointerType;return e==="pen"||e==="touch"}function GEe(n){n.touching=!0,n.touchTimer!=null&&(clearTimeout(n.touchTimer),n.touchTimer=null),n.touchTimer=setTimeout(function(){n.touching=!1,n.touchTimer=null},700)}function VF(n){n&&(n.zrByTouch=!0)}function VEe(n,e){return gh(n.dom,new HEe(n,e),!0)}function Oie(n,e){for(var t=e,r=!1;t&&t.nodeType!==9&&!(r=t.domBelongToZr||t!==e&&t===n.painterRoot);)t=t.parentNode;return r}var HEe=function(){function n(e,t){this.stopPropagation=Rc,this.stopImmediatePropagation=Rc,this.preventDefault=Rc,this.type=t.type,this.target=this.currentTarget=e.dom,this.pointerType=t.pointerType,this.clientX=t.clientX,this.clientY=t.clientY}return n}(),Df={mousedown:function(n){n=gh(this.dom,n),this.__mayPointerCapture=[n.zrX,n.zrY],this.trigger("mousedown",n)},mousemove:function(n){n=gh(this.dom,n);var e=this.__mayPointerCapture;e&&(n.zrX!==e[0]||n.zrY!==e[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",n)},mouseup:function(n){n=gh(this.dom,n),this.__togglePointerCapture(!1),this.trigger("mouseup",n)},mouseout:function(n){n=gh(this.dom,n);var e=n.toElement||n.relatedTarget;Oie(this,e)||(this.__pointerCapturing&&(n.zrEventControl="no_globalout"),this.trigger("mouseout",n))},wheel:function(n){AX=!0,n=gh(this.dom,n),this.trigger("mousewheel",n)},mousewheel:function(n){AX||(n=gh(this.dom,n),this.trigger("mousewheel",n))},touchstart:function(n){n=gh(this.dom,n),VF(n),this.__lastTouchMoment=new Date,this.handler.processGesture(n,"start"),Df.mousemove.call(this,n),Df.mousedown.call(this,n)},touchmove:function(n){n=gh(this.dom,n),VF(n),this.handler.processGesture(n,"change"),Df.mousemove.call(this,n)},touchend:function(n){n=gh(this.dom,n),VF(n),this.handler.processGesture(n,"end"),Df.mouseup.call(this,n),+new Date-+this.__lastTouchMoment<UEe&&Df.click.call(this,n)},pointerdown:function(n){Df.mousedown.call(this,n)},pointermove:function(n){xz(n)||Df.mousemove.call(this,n)},pointerup:function(n){Df.mouseup.call(this,n)},pointerout:function(n){xz(n)||Df.mouseout.call(this,n)}};it(["click","dblclick","contextmenu"],function(n){Df[n]=function(e){e=gh(this.dom,e),this.trigger(n,e)}});var bz={pointermove:function(n){xz(n)||bz.mousemove.call(this,n)},pointerup:function(n){bz.mouseup.call(this,n)},mousemove:function(n){this.trigger("mousemove",n)},mouseup:function(n){var e=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",n),e&&(n.zrEventControl="only_globalout",this.trigger("mouseout",n))}};function jEe(n,e){var t=e.domHandlers;gi.pointerEventsSupported?it(GF.pointer,function(r){cR(e,r,function(i){t[r].call(n,i)})}):(gi.touchEventsSupported&&it(GF.touch,function(r){cR(e,r,function(i){t[r].call(n,i),GEe(e)})}),it(GF.mouse,function(r){cR(e,r,function(i){i=X6(i),e.touching||t[r].call(n,i)})}))}function WEe(n,e){gi.pointerEventsSupported?it(SX.pointer,t):gi.touchEventsSupported||it(SX.mouse,t);function t(r){function i(s){s=X6(s),Oie(n,s.target)||(s=VEe(n,s),e.domHandlers[r].call(n,s))}cR(e,r,i,{capture:!0})}}function cR(n,e,t,r){n.mounted[e]=t,n.listenerOpts[e]=r,pz(n.domTarget,e,t,r)}function HF(n){var e=n.mounted;for(var t in e)e.hasOwnProperty(t)&&uEe(n.domTarget,t,e[t],n.listenerOpts[t]);n.mounted={}}var TX=function(){function n(e,t){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=e,this.domHandlers=t}return n}(),$Ee=function(n){Hn(e,n);function e(t,r){var i=n.call(this)||this;return i.__pointerCapturing=!1,i.dom=t,i.painterRoot=r,i._localHandlerScope=new TX(t,Df),UF&&(i._globalHandlerScope=new TX(document,bz)),jEe(i,i._localHandlerScope),i}return e.prototype.dispose=function(){HF(this._localHandlerScope),UF&&HF(this._globalHandlerScope)},e.prototype.setCursor=function(t){this.dom.style&&(this.dom.style.cursor=t||"default")},e.prototype.__togglePointerCapture=function(t){if(this.__mayPointerCapture=null,UF&&+this.__pointerCapturing^+t){this.__pointerCapturing=t;var r=this._globalHandlerScope;t?WEe(this,r):HF(r)}},e}(ld),Fie=1;gi.hasGlobalWindow&&(Fie=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var GP=Fie,wz=.4,Sz="#333",Az="#ccc",XEe="#eee",MX=q6,EX=5e-5;function z_(n){return n>EX||n<-EX}var U_=[],L1=[],jF=Vy(),WF=Math.abs,mE=function(){function n(){}return n.prototype.getLocalTransform=function(e){return n.getLocalTransform(this,e)},n.prototype.setPosition=function(e){this.x=e[0],this.y=e[1]},n.prototype.setScale=function(e){this.scaleX=e[0],this.scaleY=e[1]},n.prototype.setSkew=function(e){this.skewX=e[0],this.skewY=e[1]},n.prototype.setOrigin=function(e){this.originX=e[0],this.originY=e[1]},n.prototype.needLocalTransform=function(){return z_(this.rotation)||z_(this.x)||z_(this.y)||z_(this.scaleX-1)||z_(this.scaleY-1)||z_(this.skewX)||z_(this.skewY)},n.prototype.updateTransform=function(){var e=this.parent&&this.parent.transform,t=this.needLocalTransform(),r=this.transform;if(!(t||e)){r&&(MX(r),this.invTransform=null);return}r=r||Vy(),t?this.getLocalTransform(r):MX(r),e&&(t?Ub(r,e,r):dEe(r,e)),this.transform=r,this._resolveGlobalScaleRatio(r)},n.prototype._resolveGlobalScaleRatio=function(e){var t=this.globalScaleRatio;if(t!=null&&t!==1){this.getGlobalScale(U_);var r=U_[0]<0?-1:1,i=U_[1]<0?-1:1,s=((U_[0]-r)*t+r)/U_[0]||0,o=((U_[1]-i)*t+i)/U_[1]||0;e[0]*=s,e[1]*=s,e[2]*=o,e[3]*=o}this.invTransform=this.invTransform||Vy(),jD(this.invTransform,e)},n.prototype.getComputedTransform=function(){for(var e=this,t=[];e;)t.push(e),e=e.parent;for(;e=t.pop();)e.updateTransform();return this.transform},n.prototype.setLocalTransform=function(e){if(e){var t=e[0]*e[0]+e[1]*e[1],r=e[2]*e[2]+e[3]*e[3],i=Math.atan2(e[1],e[0]),s=Math.PI/2+i-Math.atan2(e[3],e[2]);r=Math.sqrt(r)*Math.cos(s),t=Math.sqrt(t),this.skewX=s,this.skewY=0,this.rotation=-i,this.x=+e[4],this.y=+e[5],this.scaleX=t,this.scaleY=r,this.originX=0,this.originY=0}},n.prototype.decomposeTransform=function(){if(this.transform){var e=this.parent,t=this.transform;e&&e.transform&&(e.invTransform=e.invTransform||Vy(),Ub(L1,e.invTransform,t),t=L1);var r=this.originX,i=this.originY;(r||i)&&(jF[4]=r,jF[5]=i,Ub(L1,t,jF),L1[4]-=r,L1[5]-=i,t=L1),this.setLocalTransform(t)}},n.prototype.getGlobalScale=function(e){var t=this.transform;return e=e||[],t?(e[0]=Math.sqrt(t[0]*t[0]+t[1]*t[1]),e[1]=Math.sqrt(t[2]*t[2]+t[3]*t[3]),t[0]<0&&(e[0]=-e[0]),t[3]<0&&(e[1]=-e[1]),e):(e[0]=1,e[1]=1,e)},n.prototype.transformCoordToLocal=function(e,t){var r=[e,t],i=this.invTransform;return i&&Rh(r,r,i),r},n.prototype.transformCoordToGlobal=function(e,t){var r=[e,t],i=this.transform;return i&&Rh(r,r,i),r},n.prototype.getLineScale=function(){var e=this.transform;return e&&WF(e[0]-1)>1e-10&&WF(e[3]-1)>1e-10?Math.sqrt(WF(e[0]*e[3]-e[2]*e[1])):1},n.prototype.copyTransform=function(e){qEe(this,e)},n.getLocalTransform=function(e,t){t=t||[];var r=e.originX||0,i=e.originY||0,s=e.scaleX,o=e.scaleY,l=e.anchorX,a=e.anchorY,h=e.rotation||0,f=e.x,p=e.y,v=e.skewX?Math.tan(e.skewX):0,y=e.skewY?Math.tan(-e.skewY):0;if(r||i||l||a){var S=r+l,C=i+a;t[4]=-S*s-v*C*o,t[5]=-C*o-y*S*s}else t[4]=t[5]=0;return t[0]=s,t[3]=o,t[1]=y*s,t[2]=v*o,h&&HD(t,t,h),t[4]+=r+f,t[5]+=i+p,t},n.initDefaultProps=function(){var e=n.prototype;e.scaleX=e.scaleY=e.globalScaleRatio=1,e.x=e.y=e.originX=e.originY=e.skewX=e.skewY=e.rotation=e.anchorX=e.anchorY=0}(),n}(),pM=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function qEe(n,e){for(var t=0;t<pM.length;t++){var r=pM[t];n[r]=e[r]}}var CX={};function Nu(n,e){e=e||ox;var t=CX[e];t||(t=CX[e]=new pE(500));var r=t.get(n);return r==null&&(r=Rw.measureText(n,e).width,t.put(n,r)),r}function IX(n,e,t,r){var i=Nu(n,e),s=Y6(e),o=BA(0,i,t),l=ib(0,s,r),a=new cs(o,l,i,s);return a}function gE(n,e,t,r){var i=((n||"")+"").split(`
`),s=i.length;if(s===1)return IX(i[0],e,t,r);for(var o=new cs(0,0,0,0),l=0;l<i.length;l++){var a=IX(i[l],e,t,r);l===0?o.copy(a):o.union(a)}return o}function BA(n,e,t){return t==="right"?n-=e:t==="center"&&(n-=e/2),n}function ib(n,e,t){return t==="middle"?n-=e/2:t==="bottom"&&(n-=e),n}function Y6(n){return Nu("",n)}function y0(n,e){return typeof n=="string"?n.lastIndexOf("%")>=0?parseFloat(n)/100*e:parseFloat(n):n}function VP(n,e,t){var r=e.position||"inside",i=e.distance!=null?e.distance:5,s=t.height,o=t.width,l=s/2,a=t.x,h=t.y,f="left",p="top";if(r instanceof Array)a+=y0(r[0],t.width),h+=y0(r[1],t.height),f=null,p=null;else switch(r){case"left":a-=i,h+=l,f="right",p="middle";break;case"right":a+=i+o,h+=l,p="middle";break;case"top":a+=o/2,h-=i,f="center",p="bottom";break;case"bottom":a+=o/2,h+=s+i,f="center";break;case"inside":a+=o/2,h+=l,f="center",p="middle";break;case"insideLeft":a+=i,h+=l,p="middle";break;case"insideRight":a+=o-i,h+=l,f="right",p="middle";break;case"insideTop":a+=o/2,h+=i,f="center";break;case"insideBottom":a+=o/2,h+=s-i,f="center",p="bottom";break;case"insideTopLeft":a+=i,h+=i;break;case"insideTopRight":a+=o-i,h+=i,f="right";break;case"insideBottomLeft":a+=i,h+=s-i,p="bottom";break;case"insideBottomRight":a+=o-i,h+=s-i,f="right",p="bottom";break}return n=n||{},n.x=a,n.y=h,n.align=f,n.verticalAlign=p,n}var $F="__zr_normal__",XF=pM.concat(["ignore"]),ZEe=v0(pM,function(n,e){return n[e]=!0,n},{ignore:!1}),D1={},YEe=new cs(0,0,0,0),$D=function(){function n(e){this.id=mie(),this.animators=[],this.currentStates=[],this.states={},this._init(e)}return n.prototype._init=function(e){this.attr(e)},n.prototype.drift=function(e,t,r){switch(this.draggable){case"horizontal":t=0;break;case"vertical":e=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=e,i[5]+=t,this.decomposeTransform(),this.markRedraw()},n.prototype.beforeUpdate=function(){},n.prototype.afterUpdate=function(){},n.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},n.prototype.updateInnerText=function(e){var t=this._textContent;if(t&&(!t.ignore||e)){this.textConfig||(this.textConfig={});var r=this.textConfig,i=r.local,s=t.innerTransformable,o=void 0,l=void 0,a=!1;s.parent=i?this:null;var h=!1;if(s.copyTransform(t),r.position!=null){var f=YEe;r.layoutRect?f.copy(r.layoutRect):f.copy(this.getBoundingRect()),i||f.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(D1,r,f):VP(D1,r,f),s.x=D1.x,s.y=D1.y,o=D1.align,l=D1.verticalAlign;var p=r.origin;if(p&&r.rotation!=null){var v=void 0,y=void 0;p==="center"?(v=f.width*.5,y=f.height*.5):(v=y0(p[0],f.width),y=y0(p[1],f.height)),h=!0,s.originX=-s.x+v+(i?0:f.x),s.originY=-s.y+y+(i?0:f.y)}}r.rotation!=null&&(s.rotation=r.rotation);var S=r.offset;S&&(s.x+=S[0],s.y+=S[1],h||(s.originX=-S[0],s.originY=-S[1]));var C=r.inside==null?typeof r.position=="string"&&r.position.indexOf("inside")>=0:r.inside,M=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),E=void 0,L=void 0,k=void 0;C&&this.canBeInsideText()?(E=r.insideFill,L=r.insideStroke,(E==null||E==="auto")&&(E=this.getInsideTextFill()),(L==null||L==="auto")&&(L=this.getInsideTextStroke(E),k=!0)):(E=r.outsideFill,L=r.outsideStroke,(E==null||E==="auto")&&(E=this.getOutsideFill()),(L==null||L==="auto")&&(L=this.getOutsideStroke(E),k=!0)),E=E||"#000",(E!==M.fill||L!==M.stroke||k!==M.autoStroke||o!==M.align||l!==M.verticalAlign)&&(a=!0,M.fill=E,M.stroke=L,M.autoStroke=k,M.align=o,M.verticalAlign=l,t.setDefaultTextStyle(M)),t.__dirty|=Bu,a&&t.dirtyStyle(!0)}},n.prototype.canBeInsideText=function(){return!0},n.prototype.getInsideTextFill=function(){return"#fff"},n.prototype.getInsideTextStroke=function(e){return"#000"},n.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?Az:Sz},n.prototype.getOutsideStroke=function(e){var t=this.__zr&&this.__zr.getBackgroundColor(),r=typeof t=="string"&&Um(t);r||(r=[255,255,255,1]);for(var i=r[3],s=this.__zr.isDarkMode(),o=0;o<3;o++)r[o]=r[o]*i+(s?0:255)*(1-i);return r[3]=1,WD(r,"rgba")},n.prototype.traverse=function(e,t){},n.prototype.attrKV=function(e,t){e==="textConfig"?this.setTextConfig(t):e==="textContent"?this.setTextContent(t):e==="clipPath"?this.setClipPath(t):e==="extra"?(this.extra=this.extra||{},Jn(this.extra,t)):this[e]=t},n.prototype.hide=function(){this.ignore=!0,this.markRedraw()},n.prototype.show=function(){this.ignore=!1,this.markRedraw()},n.prototype.attr=function(e,t){if(typeof e=="string")this.attrKV(e,t);else if($r(e))for(var r=e,i=aa(r),s=0;s<i.length;s++){var o=i[s];this.attrKV(o,e[o])}return this.markRedraw(),this},n.prototype.saveCurrentToNormalState=function(e){this._innerSaveToNormal(e);for(var t=this._normalState,r=0;r<this.animators.length;r++){var i=this.animators[r],s=i.__fromStateTransition;if(!(i.getLoop()||s&&s!==$F)){var o=i.targetName,l=o?t[o]:t;i.saveTo(l)}}},n.prototype._innerSaveToNormal=function(e){var t=this._normalState;t||(t=this._normalState={}),e.textConfig&&!t.textConfig&&(t.textConfig=this.textConfig),this._savePrimaryToNormal(e,t,XF)},n.prototype._savePrimaryToNormal=function(e,t,r){for(var i=0;i<r.length;i++){var s=r[i];e[s]!=null&&!(s in t)&&(t[s]=this[s])}},n.prototype.hasState=function(){return this.currentStates.length>0},n.prototype.getState=function(e){return this.states[e]},n.prototype.ensureState=function(e){var t=this.states;return t[e]||(t[e]={}),t[e]},n.prototype.clearStates=function(e){this.useState($F,!1,e)},n.prototype.useState=function(e,t,r,i){var s=e===$F,o=this.hasState();if(!(!o&&s)){var l=this.currentStates,a=this.stateTransition;if(!(Xi(l,e)>=0&&(t||l.length===1))){var h;if(this.stateProxy&&!s&&(h=this.stateProxy(e)),h||(h=this.states&&this.states[e]),!h&&!s){W6("State "+e+" not exists.");return}s||this.saveCurrentToNormalState(h);var f=!!(h&&h.hoverLayer||i);f&&this._toggleHoverLayerFlag(!0),this._applyStateObj(e,h,this._normalState,t,!r&&!this.__inHover&&a&&a.duration>0,a);var p=this._textContent,v=this._textGuide;return p&&p.useState(e,t,r,f),v&&v.useState(e,t,r,f),s?(this.currentStates=[],this._normalState={}):t?this.currentStates.push(e):this.currentStates=[e],this._updateAnimationTargets(),this.markRedraw(),!f&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Bu),h}}},n.prototype.useStates=function(e,t,r){if(!e.length)this.clearStates();else{var i=[],s=this.currentStates,o=e.length,l=o===s.length;if(l){for(var a=0;a<o;a++)if(e[a]!==s[a]){l=!1;break}}if(l)return;for(var a=0;a<o;a++){var h=e[a],f=void 0;this.stateProxy&&(f=this.stateProxy(h,e)),f||(f=this.states[h]),f&&i.push(f)}var p=i[o-1],v=!!(p&&p.hoverLayer||r);v&&this._toggleHoverLayerFlag(!0);var y=this._mergeStates(i),S=this.stateTransition;this.saveCurrentToNormalState(y),this._applyStateObj(e.join(","),y,this._normalState,!1,!t&&!this.__inHover&&S&&S.duration>0,S);var C=this._textContent,M=this._textGuide;C&&C.useStates(e,t,v),M&&M.useStates(e,t,v),this._updateAnimationTargets(),this.currentStates=e.slice(),this.markRedraw(),!v&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=~Bu)}},n.prototype.isSilent=function(){for(var e=this.silent,t=this.parent;!e&&t;){if(t.silent){e=!0;break}t=t.parent}return e},n.prototype._updateAnimationTargets=function(){for(var e=0;e<this.animators.length;e++){var t=this.animators[e];t.targetName&&t.changeTarget(this[t.targetName])}},n.prototype.removeState=function(e){var t=Xi(this.currentStates,e);if(t>=0){var r=this.currentStates.slice();r.splice(t,1),this.useStates(r)}},n.prototype.replaceState=function(e,t,r){var i=this.currentStates.slice(),s=Xi(i,e),o=Xi(i,t)>=0;s>=0?o?i.splice(s,1):i[s]=t:r&&!o&&i.push(t),this.useStates(i)},n.prototype.toggleState=function(e,t){t?this.useState(e,!0):this.removeState(e)},n.prototype._mergeStates=function(e){for(var t={},r,i=0;i<e.length;i++){var s=e[i];Jn(t,s),s.textConfig&&(r=r||{},Jn(r,s.textConfig))}return r&&(t.textConfig=r),t},n.prototype._applyStateObj=function(e,t,r,i,s,o){var l=!(t&&i);t&&t.textConfig?(this.textConfig=Jn({},i?this.textConfig:r.textConfig),Jn(this.textConfig,t.textConfig)):l&&r.textConfig&&(this.textConfig=r.textConfig);for(var a={},h=!1,f=0;f<XF.length;f++){var p=XF[f],v=s&&ZEe[p];t&&t[p]!=null?v?(h=!0,a[p]=t[p]):this[p]=t[p]:l&&r[p]!=null&&(v?(h=!0,a[p]=r[p]):this[p]=r[p])}if(!s)for(var f=0;f<this.animators.length;f++){var y=this.animators[f],S=y.targetName;y.getLoop()||y.__changeFinalValue(S?(t||r)[S]:t||r)}h&&this._transitionState(e,a,o)},n.prototype._attachComponent=function(e){if(!(e.__zr&&!e.__hostTarget)&&e!==this){var t=this.__zr;t&&e.addSelfToZr(t),e.__zr=t,e.__hostTarget=this}},n.prototype._detachComponent=function(e){e.__zr&&e.removeSelfFromZr(e.__zr),e.__zr=null,e.__hostTarget=null},n.prototype.getClipPath=function(){return this._clipPath},n.prototype.setClipPath=function(e){this._clipPath&&this._clipPath!==e&&this.removeClipPath(),this._attachComponent(e),this._clipPath=e,this.markRedraw()},n.prototype.removeClipPath=function(){var e=this._clipPath;e&&(this._detachComponent(e),this._clipPath=null,this.markRedraw())},n.prototype.getTextContent=function(){return this._textContent},n.prototype.setTextContent=function(e){var t=this._textContent;t!==e&&(t&&t!==e&&this.removeTextContent(),e.innerTransformable=new mE,this._attachComponent(e),this._textContent=e,this.markRedraw())},n.prototype.setTextConfig=function(e){this.textConfig||(this.textConfig={}),Jn(this.textConfig,e),this.markRedraw()},n.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},n.prototype.removeTextContent=function(){var e=this._textContent;e&&(e.innerTransformable=null,this._detachComponent(e),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},n.prototype.getTextGuideLine=function(){return this._textGuide},n.prototype.setTextGuideLine=function(e){this._textGuide&&this._textGuide!==e&&this.removeTextGuideLine(),this._attachComponent(e),this._textGuide=e,this.markRedraw()},n.prototype.removeTextGuideLine=function(){var e=this._textGuide;e&&(this._detachComponent(e),this._textGuide=null,this.markRedraw())},n.prototype.markRedraw=function(){this.__dirty|=Bu;var e=this.__zr;e&&(this.__inHover?e.refreshHover():e.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},n.prototype.dirty=function(){this.markRedraw()},n.prototype._toggleHoverLayerFlag=function(e){this.__inHover=e;var t=this._textContent,r=this._textGuide;t&&(t.__inHover=e),r&&(r.__inHover=e)},n.prototype.addSelfToZr=function(e){if(this.__zr!==e){this.__zr=e;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.addAnimator(t[r]);this._clipPath&&this._clipPath.addSelfToZr(e),this._textContent&&this._textContent.addSelfToZr(e),this._textGuide&&this._textGuide.addSelfToZr(e)}},n.prototype.removeSelfFromZr=function(e){if(this.__zr){this.__zr=null;var t=this.animators;if(t)for(var r=0;r<t.length;r++)e.animation.removeAnimator(t[r]);this._clipPath&&this._clipPath.removeSelfFromZr(e),this._textContent&&this._textContent.removeSelfFromZr(e),this._textGuide&&this._textGuide.removeSelfFromZr(e)}},n.prototype.animate=function(e,t,r){var i=e?this[e]:this,s=new Z6(i,t,r);return e&&(s.targetName=e),this.addAnimator(s,e),s},n.prototype.addAnimator=function(e,t){var r=this.__zr,i=this;e.during(function(){i.updateDuringAnimation(t)}).done(function(){var s=i.animators,o=Xi(s,e);o>=0&&s.splice(o,1)}),this.animators.push(e),r&&r.animation.addAnimator(e),r&&r.wakeUp()},n.prototype.updateDuringAnimation=function(e){this.markRedraw()},n.prototype.stopAnimation=function(e,t){for(var r=this.animators,i=r.length,s=[],o=0;o<i;o++){var l=r[o];!e||e===l.scope?l.stop(t):s.push(l)}return this.animators=s,this},n.prototype.animateTo=function(e,t,r){qF(this,e,t,r)},n.prototype.animateFrom=function(e,t,r){qF(this,e,t,r,!0)},n.prototype._transitionState=function(e,t,r,i){for(var s=qF(this,t,r,i),o=0;o<s.length;o++)s[o].__fromStateTransition=e},n.prototype.getBoundingRect=function(){return null},n.prototype.getPaintRect=function(){return null},n.initDefaultProps=function(){var e=n.prototype;e.type="element",e.name="",e.ignore=e.silent=e.isGroup=e.draggable=e.dragging=e.ignoreClip=e.__inHover=!1,e.__dirty=Bu;function t(r,i,s,o){Object.defineProperty(e,r,{get:function(){if(!this[i]){var a=this[i]=[];l(this,a)}return this[i]},set:function(a){this[s]=a[0],this[o]=a[1],this[i]=a,l(this,a)}});function l(a,h){Object.defineProperty(h,0,{get:function(){return a[s]},set:function(f){a[s]=f}}),Object.defineProperty(h,1,{get:function(){return a[o]},set:function(f){a[o]=f}})}}Object.defineProperty&&(t("position","_legacyPos","x","y"),t("scale","_legacyScale","scaleX","scaleY"),t("origin","_legacyOrigin","originX","originY"))}(),n}();od($D,ld);od($D,mE);function qF(n,e,t,r,i){t=t||{};var s=[];Nie(n,"",n,e,t,r,s,i);var o=s.length,l=!1,a=t.done,h=t.aborted,f=function(){l=!0,o--,o<=0&&(l?a&&a():h&&h())},p=function(){o--,o<=0&&(l?a&&a():h&&h())};o||a&&a(),s.length>0&&t.during&&s[0].during(function(S,C){t.during(C)});for(var v=0;v<s.length;v++){var y=s[v];f&&y.done(f),p&&y.aborted(p),t.force&&y.duration(t.duration),y.start(t.easing)}return s}function ZF(n,e,t){for(var r=0;r<t;r++)n[r]=e[r]}function KEe(n){return Pc(n[0])}function JEe(n,e,t){if(Pc(e[t]))if(Pc(n[t])||(n[t]=[]),mu(e[t])){var r=e[t].length;n[t].length!==r&&(n[t]=new e[t].constructor(r),ZF(n[t],e[t],r))}else{var i=e[t],s=n[t],o=i.length;if(KEe(i))for(var l=i[0].length,a=0;a<o;a++)s[a]?ZF(s[a],i[a],l):s[a]=Array.prototype.slice.call(i[a]);else ZF(s,i,o);s.length=i.length}else n[t]=e[t]}function QEe(n,e){return n===e||Pc(n)&&Pc(e)&&eCe(n,e)}function eCe(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function Nie(n,e,t,r,i,s,o,l){for(var a=aa(r),h=i.duration,f=i.delay,p=i.additive,v=i.setToFinal,y=!$r(s),S=n.animators,C=[],M=0;M<a.length;M++){var E=a[M],L=r[E];if(L!=null&&t[E]!=null&&(y||s[E]))if($r(L)&&!Pc(L)&&!GD(L)){if(e){l||(t[E]=L,n.updateDuringAnimation(e));continue}Nie(n,E,t[E],L,i,s&&s[E],o,l)}else C.push(E);else l||(t[E]=L,n.updateDuringAnimation(e),C.push(E))}var k=C.length;if(!p&&k)for(var H=0;H<S.length;H++){var X=S[H];if(X.targetName===e){var Z=X.stopTracks(C);if(Z){var Q=Xi(S,X);S.splice(Q,1)}}}if(i.force||(C=no(C,function(fe){return!QEe(r[fe],t[fe])}),k=C.length),k>0||i.force&&!o.length){var re=void 0,ie=void 0,oe=void 0;if(l){ie={},v&&(re={});for(var H=0;H<k;H++){var E=C[H];ie[E]=t[E],v?re[E]=r[E]:t[E]=r[E]}}else if(v){oe={};for(var H=0;H<k;H++){var E=C[H];oe[E]=aR(t[E]),JEe(t,r,E)}}var X=new Z6(t,!1,!1,p?no(S,function(Se){return Se.targetName===e}):null);X.targetName=e,i.scope&&(X.scope=i.scope),v&&re&&X.whenWithKeys(0,re,C),oe&&X.whenWithKeys(0,oe,C),X.whenWithKeys(h??500,l?ie:r,C).delay(f||0),n.addAnimator(X,e),o.push(X)}}var go=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r.isGroup=!0,r._children=[],r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.children=function(){return this._children.slice()},e.prototype.childAt=function(t){return this._children[t]},e.prototype.childOfName=function(t){for(var r=this._children,i=0;i<r.length;i++)if(r[i].name===t)return r[i]},e.prototype.childCount=function(){return this._children.length},e.prototype.add=function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},e.prototype.addBefore=function(t,r){if(t&&t!==this&&t.parent!==this&&r&&r.parent===this){var i=this._children,s=i.indexOf(r);s>=0&&(i.splice(s,0,t),this._doAdd(t))}return this},e.prototype.replace=function(t,r){var i=Xi(this._children,t);return i>=0&&this.replaceAt(r,i),this},e.prototype.replaceAt=function(t,r){var i=this._children,s=i[r];if(t&&t!==this&&t.parent!==this&&t!==s){i[r]=t,s.parent=null;var o=this.__zr;o&&s.removeSelfFromZr(o),this._doAdd(t)}return this},e.prototype._doAdd=function(t){t.parent&&t.parent.remove(t),t.parent=this;var r=this.__zr;r&&r!==t.__zr&&t.addSelfToZr(r),r&&r.refresh()},e.prototype.remove=function(t){var r=this.__zr,i=this._children,s=Xi(i,t);return s<0?this:(i.splice(s,1),t.parent=null,r&&t.removeSelfFromZr(r),r&&r.refresh(),this)},e.prototype.removeAll=function(){for(var t=this._children,r=this.__zr,i=0;i<t.length;i++){var s=t[i];r&&s.removeSelfFromZr(r),s.parent=null}return t.length=0,this},e.prototype.eachChild=function(t,r){for(var i=this._children,s=0;s<i.length;s++){var o=i[s];t.call(r,o,s)}return this},e.prototype.traverse=function(t,r){for(var i=0;i<this._children.length;i++){var s=this._children[i],o=t.call(r,s);s.isGroup&&!o&&s.traverse(t,r)}return this},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++){var i=this._children[r];i.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++){var i=this._children[r];i.removeSelfFromZr(t)}},e.prototype.getBoundingRect=function(t){for(var r=new cs(0,0,0,0),i=t||this._children,s=[],o=null,l=0;l<i.length;l++){var a=i[l];if(!(a.ignore||a.invisible)){var h=a.getBoundingRect(),f=a.getLocalTransform(s);f?(cs.applyTransform(r,h,f),o=o||r.clone(),o.union(r)):(o=o||h.clone(),o.union(h))}}return o||r},e}($D);go.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var uR={},zie={};function tCe(n){delete zie[n]}function nCe(n){if(!n)return!1;if(typeof n=="string")return UP(n,1)<wz;if(n.colorStops){for(var e=n.colorStops,t=0,r=e.length,i=0;i<r;i++)t+=UP(e[i].color,1);return t/=r,t<wz}return!1}var rCe=function(){function n(e,t,r){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,r=r||{},this.dom=t,this.id=e;var s=new AEe,o=r.renderer||"canvas";uR[o]||(o=aa(uR)[0]),r.useDirtyRect=r.useDirtyRect==null?!1:r.useDirtyRect;var l=new uR[o](t,s,r,e),a=r.ssr||l.ssrOnly;this.storage=s,this.painter=l;var h=!gi.node&&!gi.worker&&!a?new $Ee(l.getViewportRoot(),l.root):null,f=r.useCoarsePointer,p=f==null||f==="auto"?gi.touchEventsSupported:!!f,v=44,y;p&&(y=Ii(r.pointerSize,v)),this.handler=new Sie(s,l,h,l.root,y),this.animation=new zEe({stage:{update:a?null:function(){return i._flush(!0)}}}),a||this.animation.start()}return n.prototype.add=function(e){this._disposed||!e||(this.storage.addRoot(e),e.addSelfToZr(this),this.refresh())},n.prototype.remove=function(e){this._disposed||!e||(this.storage.delRoot(e),e.removeSelfFromZr(this),this.refresh())},n.prototype.configLayer=function(e,t){this._disposed||(this.painter.configLayer&&this.painter.configLayer(e,t),this.refresh())},n.prototype.setBackgroundColor=function(e){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(e),this.refresh(),this._backgroundColor=e,this._darkMode=nCe(e))},n.prototype.getBackgroundColor=function(){return this._backgroundColor},n.prototype.setDarkMode=function(e){this._darkMode=e},n.prototype.isDarkMode=function(){return this._darkMode},n.prototype.refreshImmediately=function(e){this._disposed||(e||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},n.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},n.prototype.flush=function(){this._disposed||this._flush(!1)},n.prototype._flush=function(e){var t,r=Eb();this._needsRefresh&&(t=!0,this.refreshImmediately(e)),this._needsRefreshHover&&(t=!0,this.refreshHoverImmediately());var i=Eb();t?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-r})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},n.prototype.setSleepAfterStill=function(e){this._sleepAfterStill=e},n.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},n.prototype.refreshHover=function(){this._needsRefreshHover=!0},n.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},n.prototype.resize=function(e){this._disposed||(e=e||{},this.painter.resize(e.width,e.height),this.handler.resize())},n.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},n.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},n.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},n.prototype.setCursorStyle=function(e){this._disposed||this.handler.setCursorStyle(e)},n.prototype.findHover=function(e,t){if(!this._disposed)return this.handler.findHover(e,t)},n.prototype.on=function(e,t,r){return this._disposed||this.handler.on(e,t,r),this},n.prototype.off=function(e,t){this._disposed||this.handler.off(e,t)},n.prototype.trigger=function(e,t){this._disposed||this.handler.trigger(e,t)},n.prototype.clear=function(){if(!this._disposed){for(var e=this.storage.getRoots(),t=0;t<e.length;t++)e[t]instanceof go&&e[t].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},n.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,tCe(this.id))},n}();function RX(n,e){var t=new rCe(mie(),n,e);return zie[t.id]=t,t}function iCe(n,e){uR[n]=e}var PX=1e-4,Uie=20;function sCe(n){return n.replace(/^\s+|\s+$/g,"")}function Uv(n,e,t,r){var i=e[0],s=e[1],o=t[0],l=t[1],a=s-i,h=l-o;if(a===0)return h===0?o:(o+l)/2;if(r)if(a>0){if(n<=i)return o;if(n>=s)return l}else{if(n>=i)return o;if(n<=s)return l}else{if(n===i)return o;if(n===s)return l}return(n-i)/a*h+o}function ls(n,e){switch(n){case"center":case"middle":n="50%";break;case"left":case"top":n="0%";break;case"right":case"bottom":n="100%";break}return Dr(n)?sCe(n).match(/%$/)?parseFloat(n)/100*e:parseFloat(n):n==null?NaN:+n}function To(n,e,t){return e==null&&(e=10),e=Math.min(Math.max(0,e),Uie),n=(+n).toFixed(e),t?n:+n}function aCe(n){return n.sort(function(e,t){return e-t}),n}function Dm(n){if(n=+n,isNaN(n))return 0;if(n>1e-14){for(var e=1,t=0;t<15;t++,e*=10)if(Math.round(n*e)/e===n)return t}return oCe(n)}function oCe(n){var e=n.toString().toLowerCase(),t=e.indexOf("e"),r=t>0?+e.slice(t+1):0,i=t>0?t:e.length,s=e.indexOf("."),o=s<0?0:i-1-s;return Math.max(0,o-r)}function Gie(n,e){var t=Math.log,r=Math.LN10,i=Math.floor(t(n[1]-n[0])/r),s=Math.round(t(Math.abs(e[1]-e[0]))/r),o=Math.min(Math.max(-i+s,0),20);return isFinite(o)?o:20}function lCe(n,e){var t=v0(n,function(y,S){return y+(isNaN(S)?0:S)},0);if(t===0)return[];for(var r=Math.pow(10,e),i=xr(n,function(y){return(isNaN(y)?0:y)/t*r*100}),s=r*100,o=xr(i,function(y){return Math.floor(y)}),l=v0(o,function(y,S){return y+S},0),a=xr(i,function(y,S){return y-o[S]});l<s;){for(var h=Number.NEGATIVE_INFINITY,f=null,p=0,v=a.length;p<v;++p)a[p]>h&&(h=a[p],f=p);++o[f],a[f]=0,++l}return xr(o,function(y){return y/r})}function cCe(n,e){var t=Math.max(Dm(n),Dm(e)),r=n+e;return t>Uie?r:To(r,t)}function Vie(n){var e=Math.PI*2;return(n%e+e)%e}function HP(n){return n>-PX&&n<PX}var uCe=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function eg(n){if(n instanceof Date)return n;if(Dr(n)){var e=uCe.exec(n);if(!e)return new Date(NaN);if(e[8]){var t=+e[4]||0;return e[8].toUpperCase()!=="Z"&&(t-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,t,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}else return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}else if(n==null)return new Date(NaN);return new Date(Math.round(n))}function hCe(n){return Math.pow(10,K6(n))}function K6(n){if(n===0)return 0;var e=Math.floor(Math.log(n)/Math.LN10);return n/Math.pow(10,e)>=10&&e++,e}function Hie(n,e){var t=K6(n),r=Math.pow(10,t),i=n/r,s;return i<1.5?s=1:i<2.5?s=2:i<4?s=3:i<7?s=5:s=10,n=s*r,t>=-20?+n.toFixed(t<0?-t:0):n}function x0(n){var e=parseFloat(n);return e==n&&(e!==0||!Dr(n)||n.indexOf("x")<=0)?e:NaN}function fCe(n){return!isNaN(x0(n))}function jie(){return Math.round(Math.random()*9)}function Wie(n,e){return e===0?n:Wie(e,n%e)}function LX(n,e){return n==null?e:e==null?n:n*e/Wie(n,e)}function os(n){throw new Error(n)}function DX(n,e,t){return(e-n)*t+n}var $ie="series\0",Xie="\0_ec_\0";function mo(n){return n instanceof Array?n:n==null?[]:[n]}function Tz(n,e,t){if(n){n[e]=n[e]||{},n.emphasis=n.emphasis||{},n.emphasis[e]=n.emphasis[e]||{};for(var r=0,i=t.length;r<i;r++){var s=t[r];!n.emphasis[e].hasOwnProperty(s)&&n[e].hasOwnProperty(s)&&(n.emphasis[e][s]=n[e][s])}}}var BX=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function vE(n){return $r(n)&&!fr(n)&&!(n instanceof Date)?n.value:n}function dCe(n){return $r(n)&&!(n instanceof Array)}function pCe(n,e,t){var r=t==="normalMerge",i=t==="replaceMerge",s=t==="replaceAll";n=n||[],e=(e||[]).slice();var o=ii();it(e,function(a,h){if(!$r(a)){e[h]=null;return}});var l=mCe(n,o,t);return(r||i)&&gCe(l,n,o,e),r&&vCe(l,e),r||i?_Ce(l,e,i):s&&yCe(l,e),xCe(l),l}function mCe(n,e,t){var r=[];if(t==="replaceAll")return r;for(var i=0;i<n.length;i++){var s=n[i];s&&s.id!=null&&e.set(s.id,i),r.push({existing:t==="replaceMerge"||mM(s)?null:s,newOption:null,keyInfo:null,brandNew:null})}return r}function gCe(n,e,t,r){it(r,function(i,s){if(!(!i||i.id==null)){var o=pT(i.id),l=t.get(o);if(l!=null){var a=n[l];vp(!a.newOption,'Duplicated option on id "'+o+'".'),a.newOption=i,a.existing=e[l],r[s]=null}}})}function vCe(n,e){it(e,function(t,r){if(!(!t||t.name==null))for(var i=0;i<n.length;i++){var s=n[i].existing;if(!n[i].newOption&&s&&(s.id==null||t.id==null)&&!mM(t)&&!mM(s)&&qie("name",s,t)){n[i].newOption=t,e[r]=null;return}}})}function _Ce(n,e,t){it(e,function(r){if(r){for(var i,s=0;(i=n[s])&&(i.newOption||mM(i.existing)||i.existing&&r.id!=null&&!qie("id",r,i.existing));)s++;i?(i.newOption=r,i.brandNew=t):n.push({newOption:r,brandNew:t,existing:null,keyInfo:null}),s++}})}function yCe(n,e){it(e,function(t){n.push({newOption:t,brandNew:!0,existing:null,keyInfo:null})})}function xCe(n){var e=ii();it(n,function(t){var r=t.existing;r&&e.set(r.id,t)}),it(n,function(t){var r=t.newOption;vp(!r||r.id==null||!e.get(r.id)||e.get(r.id)===t,"id duplicates: "+(r&&r.id)),r&&r.id!=null&&e.set(r.id,t),!t.keyInfo&&(t.keyInfo={})}),it(n,function(t,r){var i=t.existing,s=t.newOption,o=t.keyInfo;if($r(s)){if(o.name=s.name!=null?pT(s.name):i?i.name:$ie+r,i)o.id=pT(i.id);else if(s.id!=null)o.id=pT(s.id);else{var l=0;do o.id="\0"+o.name+"\0"+l++;while(e.get(o.id))}e.set(o.id,t)}})}function qie(n,e,t){var r=fp(e[n],null),i=fp(t[n],null);return r!=null&&i!=null&&r===i}function pT(n){return fp(n,"")}function fp(n,e){return n==null?e:Dr(n)?n:Ps(n)||lz(n)?n+"":e}function J6(n){var e=n.name;return!!(e&&e.indexOf($ie))}function mM(n){return n&&n.id!=null&&pT(n.id).indexOf(Xie)===0}function bCe(n){return Xie+n}function wCe(n,e,t){it(n,function(r){var i=r.newOption;$r(i)&&(r.keyInfo.mainType=e,r.keyInfo.subType=SCe(e,i,r.existing,t))})}function SCe(n,e,t,r){var i=e.type?e.type:t?t.subType:r.determineSubType(n,e);return i}function lx(n,e){if(e.dataIndexInside!=null)return e.dataIndexInside;if(e.dataIndex!=null)return fr(e.dataIndex)?xr(e.dataIndex,function(t){return n.indexOfRawIndex(t)}):n.indexOfRawIndex(e.dataIndex);if(e.name!=null)return fr(e.name)?xr(e.name,function(t){return n.indexOfName(t)}):n.indexOfName(e.name)}function qs(){var n="__ec_inner_"+ACe++;return function(e){return e[n]||(e[n]={})}}var ACe=jie();function mT(n,e,t){var r=Q6(e,t),i=r.mainTypeSpecified,s=r.queryOptionMap,o=r.others,l=o,a=t?t.defaultMainType:null;return!i&&a&&s.set(a,{}),s.each(function(h,f){var p=_E(n,f,h,{useDefault:a===f,enableAll:t&&t.enableAll!=null?t.enableAll:!0,enableNone:t&&t.enableNone!=null?t.enableNone:!0});l[f+"Models"]=p.models,l[f+"Model"]=p.models[0]}),l}function Q6(n,e){var t;if(Dr(n)){var r={};r[n+"Index"]=0,t=r}else t=n;var i=ii(),s={},o=!1;return it(t,function(l,a){if(a==="dataIndex"||a==="dataIndexInside"){s[a]=l;return}var h=a.match(/^(\w+)(Index|Id|Name)$/)||[],f=h[1],p=(h[2]||"").toLowerCase();if(!(!f||!p||e&&e.includeMainTypes&&Xi(e.includeMainTypes,f)<0)){o=o||!!f;var v=i.get(f)||i.set(f,{});v[p]=l}}),{mainTypeSpecified:o,queryOptionMap:i,others:s}}var bl={useDefault:!0,enableAll:!1,enableNone:!1},TCe={useDefault:!1,enableAll:!0,enableNone:!0};function _E(n,e,t,r){r=r||bl;var i=t.index,s=t.id,o=t.name,l={models:null,specified:i!=null||s!=null||o!=null};if(!l.specified){var a=void 0;return l.models=r.useDefault&&(a=n.getComponent(e))?[a]:[],l}return i==="none"||i===!1?(vp(r.enableNone,'`"none"` or `false` is not a valid value on index option.'),l.models=[],l):(i==="all"&&(vp(r.enableAll,'`"all"` is not a valid value on index option.'),i=s=o=null),l.models=n.queryComponents({mainType:e,index:i,id:s,name:o}),l)}function Zie(n,e,t){n.setAttribute?n.setAttribute(e,t):n[e]=t}function MCe(n,e){return n.getAttribute?n.getAttribute(e):n[e]}function ECe(n){return n==="auto"?gi.domSupported?"html":"richText":n||"html"}function Yie(n,e,t,r,i){var s=e==null||e==="auto";if(r==null)return r;if(Ps(r)){var o=DX(t||0,r,i);return To(o,s?Math.max(Dm(t||0),Dm(r)):e)}else{if(Dr(r))return i<1?t:r;for(var l=[],a=t,h=r,f=Math.max(a?a.length:0,h.length),p=0;p<f;++p){var v=n.getDimensionInfo(p);if(v&&v.type==="ordinal")l[p]=(i<1&&a?a:h)[p];else{var y=a&&a[p]?a[p]:0,S=h[p],o=DX(y,S,i);l[p]=To(o,s?Math.max(Dm(y),Dm(S)):e)}}return l}}var CCe=".",G_="___EC__COMPONENT__CONTAINER___",Kie="___EC__EXTENDED_CLASS___";function ip(n){var e={main:"",sub:""};if(n){var t=n.split(CCe);e.main=t[0]||"",e.sub=t[1]||""}return e}function ICe(n){vp(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n),'componentType "'+n+'" illegal')}function RCe(n){return!!(n&&n[Kie])}function eG(n,e){n.$constructor=n,n.extend=function(t){var r=this,i;return PCe(r)?i=function(s){Hn(o,s);function o(){return s.apply(this,arguments)||this}return o}(r):(i=function(){(t.$constructor||r).apply(this,arguments)},zMe(i,this)),Jn(i.prototype,t),i[Kie]=!0,i.extend=this.extend,i.superCall=BCe,i.superApply=kCe,i.superClass=r,i}}function PCe(n){return ci(n)&&/^class\s/.test(Function.prototype.toString.call(n))}function Jie(n,e){n.extend=e.extend}var LCe=Math.round(Math.random()*10);function DCe(n){var e=["__\0is_clz",LCe++].join("_");n.prototype[e]=!0,n.isInstance=function(t){return!!(t&&t[e])}}function BCe(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];return this.superClass.prototype[e].apply(n,t)}function kCe(n,e,t){return this.superClass.prototype[e].apply(n,t)}function XD(n){var e={};n.registerClass=function(r){var i=r.type||r.prototype.type;if(i){ICe(i),r.prototype.type=i;var s=ip(i);if(!s.sub)e[s.main]=r;else if(s.sub!==G_){var o=t(s);o[s.sub]=r}}return r},n.getClass=function(r,i,s){var o=e[r];if(o&&o[G_]&&(o=i?o[i]:null),s&&!o)throw new Error(i?"Component "+r+"."+(i||"")+" is used but not imported.":r+".type should be specified.");return o},n.getClassesByMainType=function(r){var i=ip(r),s=[],o=e[i.main];return o&&o[G_]?it(o,function(l,a){a!==G_&&s.push(l)}):s.push(o),s},n.hasClass=function(r){var i=ip(r);return!!e[i.main]},n.getAllClassMainTypes=function(){var r=[];return it(e,function(i,s){r.push(s)}),r},n.hasSubTypes=function(r){var i=ip(r),s=e[i.main];return s&&s[G_]};function t(r){var i=e[r.main];return(!i||!i[G_])&&(i=e[r.main]={},i[G_]=!0),i}}function gM(n,e){for(var t=0;t<n.length;t++)n[t][1]||(n[t][1]=n[t][0]);return e=e||!1,function(r,i,s){for(var o={},l=0;l<n.length;l++){var a=n[l][1];if(!(i&&Xi(i,a)>=0||s&&Xi(s,a)<0)){var h=r.getShallow(a,e);h!=null&&(o[n[l][0]]=h)}}return o}}var OCe=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],FCe=gM(OCe),NCe=function(){function n(){}return n.prototype.getAreaStyle=function(e,t){return FCe(this,e,t)},n}(),Mz=new pE(50);function zCe(n){if(typeof n=="string"){var e=Mz.get(n);return e&&e.image}else return n}function Qie(n,e,t,r,i){if(n)if(typeof n=="string"){if(e&&e.__zrImageSrc===n||!t)return e;var s=Mz.get(n),o={hostEl:t,cb:r,cbPayload:i};return s?(e=s.image,!qD(e)&&s.pending.push(o)):(e=Rw.loadImage(n,kX,kX),e.__zrImageSrc=n,Mz.put(n,e.__cachedImgObj={image:e,pending:[o]})),e}else return n;else return e}function kX(){var n=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<n.pending.length;e++){var t=n.pending[e],r=t.cb;r&&r(this,t.cbPayload),t.hostEl.dirty()}n.pending.length=0}function qD(n){return n&&n.width&&n.height}var YF=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function UCe(n,e,t,r,i){if(!e)return"";var s=(n+"").split(`
`);i=ese(e,t,r,i);for(var o=0,l=s.length;o<l;o++)s[o]=tse(s[o],i);return s.join(`
`)}function ese(n,e,t,r){r=r||{};var i=Jn({},r);i.font=e,t=Ii(t,"..."),i.maxIterations=Ii(r.maxIterations,2);var s=i.minChar=Ii(r.minChar,0);i.cnCharWidth=Nu("",e);var o=i.ascCharWidth=Nu("a",e);i.placeholder=Ii(r.placeholder,"");for(var l=n=Math.max(0,n-1),a=0;a<s&&l>=o;a++)l-=o;var h=Nu(t,e);return h>l&&(t="",h=0),l=n-h,i.ellipsis=t,i.ellipsisWidth=h,i.contentWidth=l,i.containerWidth=n,i}function tse(n,e){var t=e.containerWidth,r=e.font,i=e.contentWidth;if(!t)return"";var s=Nu(n,r);if(s<=t)return n;for(var o=0;;o++){if(s<=i||o>=e.maxIterations){n+=e.ellipsis;break}var l=o===0?GCe(n,i,e.ascCharWidth,e.cnCharWidth):s>0?Math.floor(n.length*i/s):0;n=n.substr(0,l),s=Nu(n,r)}return n===""&&(n=e.placeholder),n}function GCe(n,e,t,r){for(var i=0,s=0,o=n.length;s<o&&i<e;s++){var l=n.charCodeAt(s);i+=0<=l&&l<=127?t:r}return s}function VCe(n,e){n!=null&&(n+="");var t=e.overflow,r=e.padding,i=e.font,s=t==="truncate",o=Y6(i),l=Ii(e.lineHeight,o),a=!!e.backgroundColor,h=e.lineOverflow==="truncate",f=e.width,p;f!=null&&(t==="break"||t==="breakAll")?p=n?nse(n,e.font,f,t==="breakAll",0).lines:[]:p=n?n.split(`
`):[];var v=p.length*l,y=Ii(e.height,v);if(v>y&&h){var S=Math.floor(y/l);p=p.slice(0,S)}if(n&&s&&f!=null)for(var C=ese(f,i,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),M=0;M<p.length;M++)p[M]=tse(p[M],C);for(var E=y,L=0,M=0;M<p.length;M++)L=Math.max(Nu(p[M],i),L);f==null&&(f=L);var k=L;return r&&(E+=r[0]+r[2],k+=r[1]+r[3],f+=r[1]+r[3]),a&&(k=f),{lines:p,height:y,outerWidth:k,outerHeight:E,lineHeight:l,calculatedLineHeight:o,contentWidth:L,contentHeight:v,width:f}}var HCe=function(){function n(){}return n}(),OX=function(){function n(e){this.tokens=[],e&&(this.tokens=e)}return n}(),jCe=function(){function n(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[]}return n}();function WCe(n,e){var t=new jCe;if(n!=null&&(n+=""),!n)return t;for(var r=e.width,i=e.height,s=e.overflow,o=(s==="break"||s==="breakAll")&&r!=null?{width:r,accumWidth:0,breakAll:s==="breakAll"}:null,l=YF.lastIndex=0,a;(a=YF.exec(n))!=null;){var h=a.index;h>l&&KF(t,n.substring(l,h),e,o),KF(t,a[2],e,o,a[1]),l=YF.lastIndex}l<n.length&&KF(t,n.substring(l,n.length),e,o);var f=[],p=0,v=0,y=e.padding,S=s==="truncate",C=e.lineOverflow==="truncate";function M(_e,We,Ue){_e.width=We,_e.lineHeight=Ue,p+=Ue,v=Math.max(v,We)}e:for(var E=0;E<t.lines.length;E++){for(var L=t.lines[E],k=0,H=0,X=0;X<L.tokens.length;X++){var Z=L.tokens[X],Q=Z.styleName&&e.rich[Z.styleName]||{},re=Z.textPadding=Q.padding,ie=re?re[1]+re[3]:0,oe=Z.font=Q.font||e.font;Z.contentHeight=Y6(oe);var fe=Ii(Q.height,Z.contentHeight);if(Z.innerHeight=fe,re&&(fe+=re[0]+re[2]),Z.height=fe,Z.lineHeight=uT(Q.lineHeight,e.lineHeight,fe),Z.align=Q&&Q.align||e.align,Z.verticalAlign=Q&&Q.verticalAlign||"middle",C&&i!=null&&p+Z.lineHeight>i){X>0?(L.tokens=L.tokens.slice(0,X),M(L,H,k),t.lines=t.lines.slice(0,E+1)):t.lines=t.lines.slice(0,E);break e}var Se=Q.width,Ee=Se==null||Se==="auto";if(typeof Se=="string"&&Se.charAt(Se.length-1)==="%")Z.percentWidth=Se,f.push(Z),Z.contentWidth=Nu(Z.text,oe);else{if(Ee){var Ie=Q.backgroundColor,He=Ie&&Ie.image;He&&(He=zCe(He),qD(He)&&(Z.width=Math.max(Z.width,He.width*fe/He.height)))}var Re=S&&r!=null?r-H:null;Re!=null&&Re<Z.width?!Ee||Re<ie?(Z.text="",Z.width=Z.contentWidth=0):(Z.text=UCe(Z.text,Re-ie,oe,e.ellipsis,{minChar:e.truncateMinChar}),Z.width=Z.contentWidth=Nu(Z.text,oe)):Z.contentWidth=Nu(Z.text,oe)}Z.width+=ie,H+=Z.width,Q&&(k=Math.max(k,Z.lineHeight))}M(L,H,k)}t.outerWidth=t.width=Ii(r,v),t.outerHeight=t.height=Ii(i,p),t.contentHeight=p,t.contentWidth=v,y&&(t.outerWidth+=y[1]+y[3],t.outerHeight+=y[0]+y[2]);for(var E=0;E<f.length;E++){var Z=f[E],st=Z.percentWidth;Z.width=parseInt(st,10)/100*t.width}return t}function KF(n,e,t,r,i){var s=e==="",o=i&&t.rich[i]||{},l=n.lines,a=o.font||t.font,h=!1,f,p;if(r){var v=o.padding,y=v?v[1]+v[3]:0;if(o.width!=null&&o.width!=="auto"){var S=y0(o.width,r.width)+y;l.length>0&&S+r.accumWidth>r.width&&(f=e.split(`
`),h=!0),r.accumWidth=S}else{var C=nse(e,a,r.width,r.breakAll,r.accumWidth);r.accumWidth=C.accumWidth+y,p=C.linesWidths,f=C.lines}}else f=e.split(`
`);for(var M=0;M<f.length;M++){var E=f[M],L=new HCe;if(L.styleName=i,L.text=E,L.isLineHolder=!E&&!s,typeof o.width=="number"?L.width=o.width:L.width=p?p[M]:Nu(E,a),!M&&!h){var k=(l[l.length-1]||(l[0]=new OX)).tokens,H=k.length;H===1&&k[0].isLineHolder?k[0]=L:(E||!H||s)&&k.push(L)}else l.push(new OX([L]))}}function $Ce(n){var e=n.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}var XCe=v0(",&?/;] ".split(""),function(n,e){return n[e]=!0,n},{});function qCe(n){return $Ce(n)?!!XCe[n]:!0}function nse(n,e,t,r,i){for(var s=[],o=[],l="",a="",h=0,f=0,p=0;p<n.length;p++){var v=n.charAt(p);if(v===`
`){a&&(l+=a,f+=h),s.push(l),o.push(f),l="",a="",h=0,f=0;continue}var y=Nu(v,e),S=r?!1:!qCe(v);if(s.length?f+y>t:i+f+y>t){f?(l||a)&&(S?(l||(l=a,a="",h=0,f=h),s.push(l),o.push(f-h),a+=v,h+=y,l="",f=h):(a&&(l+=a,a="",h=0),s.push(l),o.push(f),l=v,f=y)):S?(s.push(a),o.push(h),a=v,h=y):(s.push(v),o.push(y));continue}f+=y,S?(a+=v,h+=y):(a&&(l+=a,a="",h=0),l+=v)}return!s.length&&!l&&(l=n,a="",h=0),a&&(l+=a),l&&(s.push(l),o.push(f)),s.length===1&&(f+=i),{accumWidth:f,lines:s,linesWidths:o}}var Ez="__zr_style_"+Math.round(Math.random()*10),Hy={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},ZD={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};Hy[Ez]=!0;var FX=["z","z2","invisible"],ZCe=["invisible"],YCe=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype._init=function(t){for(var r=aa(t),i=0;i<r.length;i++){var s=r[i];s==="style"?this.useStyle(t[s]):n.prototype.attrKV.call(this,s,t[s])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,r,i,s){var o=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&KCe(this,t,r)||o&&!o[0]&&!o[3])return!1;if(i&&this.__clipPaths){for(var l=0;l<this.__clipPaths.length;++l)if(this.__clipPaths[l].isZeroArea())return!1}if(s&&this.parent)for(var a=this.parent;a;){if(a.ignore)return!1;a=a.parent}return!0},e.prototype.contain=function(t,r){return this.rectContain(t,r)},e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.rectContain=function(t,r){var i=this.transformCoordToLocal(t,r),s=this.getBoundingRect();return s.contain(i[0],i[1])},e.prototype.getPaintRect=function(){var t=this._paintRect;if(!this._paintRect||this.__dirty){var r=this.transform,i=this.getBoundingRect(),s=this.style,o=s.shadowBlur||0,l=s.shadowOffsetX||0,a=s.shadowOffsetY||0;t=this._paintRect||(this._paintRect=new cs(0,0,0,0)),r?cs.applyTransform(t,i,r):t.copy(i),(o||l||a)&&(t.width+=o*2+Math.abs(l),t.height+=o*2+Math.abs(a),t.x=Math.min(t.x,t.x+l-o),t.y=Math.min(t.y,t.y+a-o));var h=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-h),t.y=Math.floor(t.y-h),t.width=Math.ceil(t.width+1+h*2),t.height=Math.ceil(t.height+1+h*2))}return t},e.prototype.setPrevPaintRect=function(t){t?(this._prevPaintRect=this._prevPaintRect||new cs(0,0,0,0),this._prevPaintRect.copy(t)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(t,r){t!=="style"?n.prototype.attrKV.call(this,t,r):this.style?this.setStyle(r):this.useStyle(r)},e.prototype.setStyle=function(t,r){return typeof t=="string"?this.style[t]=r:Jn(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=LA,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(this.__dirty&LA)},e.prototype.styleUpdated=function(){this.__dirty&=~LA},e.prototype.createStyle=function(t){return VD(Hy,t)},e.prototype.useStyle=function(t){t[Ez]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[Ez]},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.style&&!r.style&&(r.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(t,r,FX)},e.prototype._applyStateObj=function(t,r,i,s,o,l){n.prototype._applyStateObj.call(this,t,r,i,s,o,l);var a=!(r&&s),h;if(r&&r.style?o?s?h=r.style:(h=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(h,r.style)):(h=this._mergeStyle(this.createStyle(),s?this.style:i.style),this._mergeStyle(h,r.style)):a&&(h=i.style),h)if(o){var f=this.style;if(this.style=this.createStyle(a?{}:f),a)for(var p=aa(f),v=0;v<p.length;v++){var y=p[v];y in h&&(h[y]=h[y],this.style[y]=f[y])}for(var S=aa(h),v=0;v<S.length;v++){var y=S[v];this.style[y]=this.style[y]}this._transitionState(t,{style:h},l,this.getAnimationStyleProps())}else this.useStyle(h);for(var C=this.__inHover?ZCe:FX,v=0;v<C.length;v++){var y=C[v];r&&r[y]!=null?this[y]=r[y]:a&&i[y]!=null&&(this[y]=i[y])}},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),i,s=0;s<t.length;s++){var o=t[s];o.style&&(i=i||{},this._mergeStyle(i,o.style))}return i&&(r.style=i),r},e.prototype._mergeStyle=function(t,r){return Jn(t,r),t},e.prototype.getAnimationStyleProps=function(){return ZD},e.initDefaultProps=function(){var t=e.prototype;t.type="displayable",t.invisible=!1,t.z=0,t.z2=0,t.zlevel=0,t.culling=!1,t.cursor="pointer",t.rectHover=!1,t.incremental=!1,t._rect=null,t.dirtyRectTolerance=0,t.__dirty=Bu|LA}(),e}($D),JF=new cs(0,0,0,0),QF=new cs(0,0,0,0);function KCe(n,e,t){return JF.copy(n.getBoundingRect()),n.transform&&JF.applyTransform(n.transform),QF.width=e,QF.height=t,!JF.intersect(QF)}const Dw=YCe;var ru=Math.min,iu=Math.max,e3=Math.sin,t3=Math.cos,V_=Math.PI*2,$2=Lw(),X2=Lw(),q2=Lw();function rse(n,e,t){if(n.length!==0){for(var r=n[0],i=r[0],s=r[0],o=r[1],l=r[1],a=1;a<n.length;a++)r=n[a],i=ru(i,r[0]),s=iu(s,r[0]),o=ru(o,r[1]),l=iu(l,r[1]);e[0]=i,e[1]=o,t[0]=s,t[1]=l}}function NX(n,e,t,r,i,s){i[0]=ru(n,t),i[1]=ru(e,r),s[0]=iu(n,t),s[1]=iu(e,r)}var zX=[],UX=[];function JCe(n,e,t,r,i,s,o,l,a,h){var f=Cie,p=Vo,v=f(n,t,i,o,zX);a[0]=1/0,a[1]=1/0,h[0]=-1/0,h[1]=-1/0;for(var y=0;y<v;y++){var S=p(n,t,i,o,zX[y]);a[0]=ru(S,a[0]),h[0]=iu(S,h[0])}v=f(e,r,s,l,UX);for(var y=0;y<v;y++){var C=p(e,r,s,l,UX[y]);a[1]=ru(C,a[1]),h[1]=iu(C,h[1])}a[0]=ru(n,a[0]),h[0]=iu(n,h[0]),a[0]=ru(o,a[0]),h[0]=iu(o,h[0]),a[1]=ru(e,a[1]),h[1]=iu(e,h[1]),a[1]=ru(l,a[1]),h[1]=iu(l,h[1])}function QCe(n,e,t,r,i,s,o,l){var a=Rie,h=Vl,f=iu(ru(a(n,t,i),1),0),p=iu(ru(a(e,r,s),1),0),v=h(n,t,i,f),y=h(e,r,s,p);o[0]=ru(n,i,v),o[1]=ru(e,s,y),l[0]=iu(n,i,v),l[1]=iu(e,s,y)}function e2e(n,e,t,r,i,s,o,l,a){var h=Tb,f=Mb,p=Math.abs(i-s);if(p%V_<1e-4&&p>1e-4){l[0]=n-t,l[1]=e-r,a[0]=n+t,a[1]=e+r;return}if($2[0]=t3(i)*t+n,$2[1]=e3(i)*r+e,X2[0]=t3(s)*t+n,X2[1]=e3(s)*r+e,h(l,$2,X2),f(a,$2,X2),i=i%V_,i<0&&(i=i+V_),s=s%V_,s<0&&(s=s+V_),i>s&&!o?s+=V_:i<s&&o&&(i+=V_),o){var v=s;s=i,i=v}for(var y=0;y<s;y+=Math.PI/2)y>i&&(q2[0]=t3(y)*t+n,q2[1]=e3(y)*r+e,h(l,q2,l),f(a,q2,a))}var Is={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},H_=[],j_=[],Wd=[],yv=[],$d=[],Xd=[],n3=Math.min,r3=Math.max,W_=Math.cos,$_=Math.sin,vm=Math.abs,Cz=Math.PI,Pv=Cz*2,i3=typeof Float32Array<"u",QS=[];function s3(n){var e=Math.round(n/Cz*1e8)/1e8;return e%2*Cz}function ise(n,e){var t=s3(n[0]);t<0&&(t+=Pv);var r=t-n[0],i=n[1];i+=r,!e&&i-t>=Pv?i=t+Pv:e&&t-i>=Pv?i=t-Pv:!e&&t>i?i=t+(Pv-s3(t-i)):e&&t<i&&(i=t-(Pv-s3(i-t))),n[0]=t,n[1]=i}var tg=function(){function n(e){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,e&&(this._saveData=!1),this._saveData&&(this.data=[])}return n.prototype.increaseVersion=function(){this._version++},n.prototype.getVersion=function(){return this._version},n.prototype.setScale=function(e,t,r){r=r||0,r>0&&(this._ux=vm(r/GP/e)||0,this._uy=vm(r/GP/t)||0)},n.prototype.setDPR=function(e){this.dpr=e},n.prototype.setContext=function(e){this._ctx=e},n.prototype.getContext=function(){return this._ctx},n.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},n.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},n.prototype.moveTo=function(e,t){return this._drawPendingPt(),this.addData(Is.M,e,t),this._ctx&&this._ctx.moveTo(e,t),this._x0=e,this._y0=t,this._xi=e,this._yi=t,this},n.prototype.lineTo=function(e,t){var r=vm(e-this._xi),i=vm(t-this._yi),s=r>this._ux||i>this._uy;if(this.addData(Is.L,e,t),this._ctx&&s&&this._ctx.lineTo(e,t),s)this._xi=e,this._yi=t,this._pendingPtDist=0;else{var o=r*r+i*i;o>this._pendingPtDist&&(this._pendingPtX=e,this._pendingPtY=t,this._pendingPtDist=o)}return this},n.prototype.bezierCurveTo=function(e,t,r,i,s,o){return this._drawPendingPt(),this.addData(Is.C,e,t,r,i,s,o),this._ctx&&this._ctx.bezierCurveTo(e,t,r,i,s,o),this._xi=s,this._yi=o,this},n.prototype.quadraticCurveTo=function(e,t,r,i){return this._drawPendingPt(),this.addData(Is.Q,e,t,r,i),this._ctx&&this._ctx.quadraticCurveTo(e,t,r,i),this._xi=r,this._yi=i,this},n.prototype.arc=function(e,t,r,i,s,o){this._drawPendingPt(),QS[0]=i,QS[1]=s,ise(QS,o),i=QS[0],s=QS[1];var l=s-i;return this.addData(Is.A,e,t,r,r,i,l,0,o?0:1),this._ctx&&this._ctx.arc(e,t,r,i,s,o),this._xi=W_(s)*r+e,this._yi=$_(s)*r+t,this},n.prototype.arcTo=function(e,t,r,i,s){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(e,t,r,i,s),this},n.prototype.rect=function(e,t,r,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(e,t,r,i),this.addData(Is.R,e,t,r,i),this},n.prototype.closePath=function(){this._drawPendingPt(),this.addData(Is.Z);var e=this._ctx,t=this._x0,r=this._y0;return e&&e.closePath(),this._xi=t,this._yi=r,this},n.prototype.fill=function(e){e&&e.fill(),this.toStatic()},n.prototype.stroke=function(e){e&&e.stroke(),this.toStatic()},n.prototype.len=function(){return this._len},n.prototype.setData=function(e){var t=e.length;!(this.data&&this.data.length===t)&&i3&&(this.data=new Float32Array(t));for(var r=0;r<t;r++)this.data[r]=e[r];this._len=t},n.prototype.appendPath=function(e){e instanceof Array||(e=[e]);for(var t=e.length,r=0,i=this._len,s=0;s<t;s++)r+=e[s].len();i3&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+r));for(var s=0;s<t;s++)for(var o=e[s].data,l=0;l<o.length;l++)this.data[i++]=o[l];this._len=i},n.prototype.addData=function(e,t,r,i,s,o,l,a,h){if(this._saveData){var f=this.data;this._len+arguments.length>f.length&&(this._expandData(),f=this.data);for(var p=0;p<arguments.length;p++)f[this._len++]=arguments[p]}},n.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},n.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var e=[],t=0;t<this._len;t++)e[t]=this.data[t];this.data=e}},n.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var e=this.data;e instanceof Array&&(e.length=this._len,i3&&this._len>11&&(this.data=new Float32Array(e)))}},n.prototype.getBoundingRect=function(){Wd[0]=Wd[1]=$d[0]=$d[1]=Number.MAX_VALUE,yv[0]=yv[1]=Xd[0]=Xd[1]=-Number.MAX_VALUE;var e=this.data,t=0,r=0,i=0,s=0,o;for(o=0;o<this._len;){var l=e[o++],a=o===1;switch(a&&(t=e[o],r=e[o+1],i=t,s=r),l){case Is.M:t=i=e[o++],r=s=e[o++],$d[0]=i,$d[1]=s,Xd[0]=i,Xd[1]=s;break;case Is.L:NX(t,r,e[o],e[o+1],$d,Xd),t=e[o++],r=e[o++];break;case Is.C:JCe(t,r,e[o++],e[o++],e[o++],e[o++],e[o],e[o+1],$d,Xd),t=e[o++],r=e[o++];break;case Is.Q:QCe(t,r,e[o++],e[o++],e[o],e[o+1],$d,Xd),t=e[o++],r=e[o++];break;case Is.A:var h=e[o++],f=e[o++],p=e[o++],v=e[o++],y=e[o++],S=e[o++]+y;o+=1;var C=!e[o++];a&&(i=W_(y)*p+h,s=$_(y)*v+f),e2e(h,f,p,v,y,S,C,$d,Xd),t=W_(S)*p+h,r=$_(S)*v+f;break;case Is.R:i=t=e[o++],s=r=e[o++];var M=e[o++],E=e[o++];NX(i,s,i+M,s+E,$d,Xd);break;case Is.Z:t=i,r=s;break}Tb(Wd,Wd,$d),Mb(yv,yv,Xd)}return o===0&&(Wd[0]=Wd[1]=yv[0]=yv[1]=0),new cs(Wd[0],Wd[1],yv[0]-Wd[0],yv[1]-Wd[1])},n.prototype._calculateLength=function(){var e=this.data,t=this._len,r=this._ux,i=this._uy,s=0,o=0,l=0,a=0;this._pathSegLen||(this._pathSegLen=[]);for(var h=this._pathSegLen,f=0,p=0,v=0;v<t;){var y=e[v++],S=v===1;S&&(s=e[v],o=e[v+1],l=s,a=o);var C=-1;switch(y){case Is.M:s=l=e[v++],o=a=e[v++];break;case Is.L:{var M=e[v++],E=e[v++],L=M-s,k=E-o;(vm(L)>r||vm(k)>i||v===t-1)&&(C=Math.sqrt(L*L+k*k),s=M,o=E);break}case Is.C:{var H=e[v++],X=e[v++],M=e[v++],E=e[v++],Z=e[v++],Q=e[v++];C=TEe(s,o,H,X,M,E,Z,Q,10),s=Z,o=Q;break}case Is.Q:{var H=e[v++],X=e[v++],M=e[v++],E=e[v++];C=EEe(s,o,H,X,M,E,10),s=M,o=E;break}case Is.A:var re=e[v++],ie=e[v++],oe=e[v++],fe=e[v++],Se=e[v++],Ee=e[v++],Ie=Ee+Se;v+=1,S&&(l=W_(Se)*oe+re,a=$_(Se)*fe+ie),C=r3(oe,fe)*n3(Pv,Math.abs(Ee)),s=W_(Ie)*oe+re,o=$_(Ie)*fe+ie;break;case Is.R:{l=s=e[v++],a=o=e[v++];var He=e[v++],Re=e[v++];C=He*2+Re*2;break}case Is.Z:{var L=l-s,k=a-o;C=Math.sqrt(L*L+k*k),s=l,o=a;break}}C>=0&&(h[p++]=C,f+=C)}return this._pathLen=f,f},n.prototype.rebuildPath=function(e,t){var r=this.data,i=this._ux,s=this._uy,o=this._len,l,a,h,f,p,v,y=t<1,S,C,M=0,E=0,L,k=0,H,X;if(!(y&&(this._pathSegLen||this._calculateLength(),S=this._pathSegLen,C=this._pathLen,L=t*C,!L)))e:for(var Z=0;Z<o;){var Q=r[Z++],re=Z===1;switch(re&&(h=r[Z],f=r[Z+1],l=h,a=f),Q!==Is.L&&k>0&&(e.lineTo(H,X),k=0),Q){case Is.M:l=h=r[Z++],a=f=r[Z++],e.moveTo(h,f);break;case Is.L:{p=r[Z++],v=r[Z++];var ie=vm(p-h),oe=vm(v-f);if(ie>i||oe>s){if(y){var fe=S[E++];if(M+fe>L){var Se=(L-M)/fe;e.lineTo(h*(1-Se)+p*Se,f*(1-Se)+v*Se);break e}M+=fe}e.lineTo(p,v),h=p,f=v,k=0}else{var Ee=ie*ie+oe*oe;Ee>k&&(H=p,X=v,k=Ee)}break}case Is.C:{var Ie=r[Z++],He=r[Z++],Re=r[Z++],st=r[Z++],_e=r[Z++],We=r[Z++];if(y){var fe=S[E++];if(M+fe>L){var Se=(L-M)/fe;_0(h,Ie,Re,_e,Se,H_),_0(f,He,st,We,Se,j_),e.bezierCurveTo(H_[1],j_[1],H_[2],j_[2],H_[3],j_[3]);break e}M+=fe}e.bezierCurveTo(Ie,He,Re,st,_e,We),h=_e,f=We;break}case Is.Q:{var Ie=r[Z++],He=r[Z++],Re=r[Z++],st=r[Z++];if(y){var fe=S[E++];if(M+fe>L){var Se=(L-M)/fe;zP(h,Ie,Re,Se,H_),zP(f,He,st,Se,j_),e.quadraticCurveTo(H_[1],j_[1],H_[2],j_[2]);break e}M+=fe}e.quadraticCurveTo(Ie,He,Re,st),h=Re,f=st;break}case Is.A:var Ue=r[Z++],vt=r[Z++],xt=r[Z++],Vt=r[Z++],lt=r[Z++],Ht=r[Z++],Qt=r[Z++],rn=!r[Z++],jn=xt>Vt?xt:Vt,Bn=vm(xt-Vt)>.001,Tn=lt+Ht,Le=!1;if(y){var fe=S[E++];M+fe>L&&(Tn=lt+Ht*(L-M)/fe,Le=!0),M+=fe}if(Bn&&e.ellipse?e.ellipse(Ue,vt,xt,Vt,Qt,lt,Tn,rn):e.arc(Ue,vt,jn,lt,Tn,rn),Le)break e;re&&(l=W_(lt)*xt+Ue,a=$_(lt)*Vt+vt),h=W_(Tn)*xt+Ue,f=$_(Tn)*Vt+vt;break;case Is.R:l=h=r[Z],a=f=r[Z+1],p=r[Z++],v=r[Z++];var qe=r[Z++],mn=r[Z++];if(y){var fe=S[E++];if(M+fe>L){var cn=L-M;e.moveTo(p,v),e.lineTo(p+n3(cn,qe),v),cn-=qe,cn>0&&e.lineTo(p+qe,v+n3(cn,mn)),cn-=mn,cn>0&&e.lineTo(p+r3(qe-cn,0),v+mn),cn-=qe,cn>0&&e.lineTo(p,v+r3(mn-cn,0));break e}M+=fe}e.rect(p,v,qe,mn);break;case Is.Z:if(y){var fe=S[E++];if(M+fe>L){var Se=(L-M)/fe;e.lineTo(h*(1-Se)+l*Se,f*(1-Se)+a*Se);break e}M+=fe}e.closePath(),h=l,f=a}}},n.prototype.clone=function(){var e=new n,t=this.data;return e.data=t.slice?t.slice():Array.prototype.slice.call(t),e._len=this._len,e},n.CMD=Is,n.initDefaultProps=function(){var e=n.prototype;e._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,e._version=0}(),n}();function B1(n,e,t,r,i,s,o){if(i===0)return!1;var l=i,a=0,h=n;if(o>e+l&&o>r+l||o<e-l&&o<r-l||s>n+l&&s>t+l||s<n-l&&s<t-l)return!1;if(n!==t)a=(e-r)/(n-t),h=(n*r-t*e)/(n-t);else return Math.abs(s-n)<=l/2;var f=a*s-o+h,p=f*f/(a*a+1);return p<=l/2*l/2}function t2e(n,e,t,r,i,s,o,l,a,h,f){if(a===0)return!1;var p=a;if(f>e+p&&f>r+p&&f>s+p&&f>l+p||f<e-p&&f<r-p&&f<s-p&&f<l-p||h>n+p&&h>t+p&&h>i+p&&h>o+p||h<n-p&&h<t-p&&h<i-p&&h<o-p)return!1;var v=Iie(n,e,t,r,i,s,o,l,h,f,null);return v<=p/2}function n2e(n,e,t,r,i,s,o,l,a){if(o===0)return!1;var h=o;if(a>e+h&&a>r+h&&a>s+h||a<e-h&&a<r-h&&a<s-h||l>n+h&&l>t+h&&l>i+h||l<n-h&&l<t-h&&l<i-h)return!1;var f=Pie(n,e,t,r,i,s,l,a,null);return f<=h/2}var GX=Math.PI*2;function Bm(n){return n%=GX,n<0&&(n+=GX),n}var eA=Math.PI*2;function r2e(n,e,t,r,i,s,o,l,a){if(o===0)return!1;var h=o;l-=n,a-=e;var f=Math.sqrt(l*l+a*a);if(f-h>t||f+h<t)return!1;if(Math.abs(r-i)%eA<1e-4)return!0;if(s){var p=r;r=Bm(i),i=Bm(p)}else r=Bm(r),i=Bm(i);r>i&&(i+=eA);var v=Math.atan2(a,l);return v<0&&(v+=eA),v>=r&&v<=i||v+eA>=r&&v+eA<=i}function X_(n,e,t,r,i,s){if(s>e&&s>r||s<e&&s<r||r===e)return 0;var o=(s-e)/(r-e),l=r<e?1:-1;(o===1||o===0)&&(l=r<e?.5:-.5);var a=o*(t-n)+n;return a===i?1/0:a>i?l:0}var xv=tg.CMD,q_=Math.PI*2,i2e=1e-4;function s2e(n,e){return Math.abs(n-e)<i2e}var wc=[-1,-1,-1],yh=[-1,-1];function a2e(){var n=yh[0];yh[0]=yh[1],yh[1]=n}function o2e(n,e,t,r,i,s,o,l,a,h){if(h>e&&h>r&&h>s&&h>l||h<e&&h<r&&h<s&&h<l)return 0;var f=NP(e,r,s,l,h,wc);if(f===0)return 0;for(var p=0,v=-1,y=void 0,S=void 0,C=0;C<f;C++){var M=wc[C],E=M===0||M===1?.5:1,L=Vo(n,t,i,o,M);L<a||(v<0&&(v=Cie(e,r,s,l,yh),yh[1]<yh[0]&&v>1&&a2e(),y=Vo(e,r,s,l,yh[0]),v>1&&(S=Vo(e,r,s,l,yh[1]))),v===2?M<yh[0]?p+=y<e?E:-E:M<yh[1]?p+=S<y?E:-E:p+=l<S?E:-E:M<yh[0]?p+=y<e?E:-E:p+=l<y?E:-E)}return p}function l2e(n,e,t,r,i,s,o,l){if(l>e&&l>r&&l>s||l<e&&l<r&&l<s)return 0;var a=MEe(e,r,s,l,wc);if(a===0)return 0;var h=Rie(e,r,s);if(h>=0&&h<=1){for(var f=0,p=Vl(e,r,s,h),v=0;v<a;v++){var y=wc[v]===0||wc[v]===1?.5:1,S=Vl(n,t,i,wc[v]);S<o||(wc[v]<h?f+=p<e?y:-y:f+=s<p?y:-y)}return f}else{var y=wc[0]===0||wc[0]===1?.5:1,S=Vl(n,t,i,wc[0]);return S<o?0:s<e?y:-y}}function c2e(n,e,t,r,i,s,o,l){if(l-=e,l>t||l<-t)return 0;var a=Math.sqrt(t*t-l*l);wc[0]=-a,wc[1]=a;var h=Math.abs(r-i);if(h<1e-4)return 0;if(h>=q_-1e-4){r=0,i=q_;var f=s?1:-1;return o>=wc[0]+n&&o<=wc[1]+n?f:0}if(r>i){var p=r;r=i,i=p}r<0&&(r+=q_,i+=q_);for(var v=0,y=0;y<2;y++){var S=wc[y];if(S+n>o){var C=Math.atan2(l,S),f=s?1:-1;C<0&&(C=q_+C),(C>=r&&C<=i||C+q_>=r&&C+q_<=i)&&(C>Math.PI/2&&C<Math.PI*1.5&&(f=-f),v+=f)}}return v}function sse(n,e,t,r,i){for(var s=n.data,o=n.len(),l=0,a=0,h=0,f=0,p=0,v,y,S=0;S<o;){var C=s[S++],M=S===1;switch(C===xv.M&&S>1&&(t||(l+=X_(a,h,f,p,r,i))),M&&(a=s[S],h=s[S+1],f=a,p=h),C){case xv.M:f=s[S++],p=s[S++],a=f,h=p;break;case xv.L:if(t){if(B1(a,h,s[S],s[S+1],e,r,i))return!0}else l+=X_(a,h,s[S],s[S+1],r,i)||0;a=s[S++],h=s[S++];break;case xv.C:if(t){if(t2e(a,h,s[S++],s[S++],s[S++],s[S++],s[S],s[S+1],e,r,i))return!0}else l+=o2e(a,h,s[S++],s[S++],s[S++],s[S++],s[S],s[S+1],r,i)||0;a=s[S++],h=s[S++];break;case xv.Q:if(t){if(n2e(a,h,s[S++],s[S++],s[S],s[S+1],e,r,i))return!0}else l+=l2e(a,h,s[S++],s[S++],s[S],s[S+1],r,i)||0;a=s[S++],h=s[S++];break;case xv.A:var E=s[S++],L=s[S++],k=s[S++],H=s[S++],X=s[S++],Z=s[S++];S+=1;var Q=!!(1-s[S++]);v=Math.cos(X)*k+E,y=Math.sin(X)*H+L,M?(f=v,p=y):l+=X_(a,h,v,y,r,i);var re=(r-E)*H/k+E;if(t){if(r2e(E,L,H,X,X+Z,Q,e,re,i))return!0}else l+=c2e(E,L,H,X,X+Z,Q,re,i);a=Math.cos(X+Z)*k+E,h=Math.sin(X+Z)*H+L;break;case xv.R:f=a=s[S++],p=h=s[S++];var ie=s[S++],oe=s[S++];if(v=f+ie,y=p+oe,t){if(B1(f,p,v,p,e,r,i)||B1(v,p,v,y,e,r,i)||B1(v,y,f,y,e,r,i)||B1(f,y,f,p,e,r,i))return!0}else l+=X_(v,p,v,y,r,i),l+=X_(f,y,f,p,r,i);break;case xv.Z:if(t){if(B1(a,h,f,p,e,r,i))return!0}else l+=X_(a,h,f,p,r,i);a=f,h=p;break}}return!t&&!s2e(h,p)&&(l+=X_(a,h,f,p,r,i)||0),l!==0}function u2e(n,e,t){return sse(n,0,!1,e,t)}function h2e(n,e,t,r){return sse(n,e,!0,t,r)}var ase=ti({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},Hy),f2e={style:ti({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},ZD.style)},a3=pM.concat(["invisible","culling","z","z2","zlevel","parent"]),qi=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.update=function(){var t=this;n.prototype.update.call(this);var r=this.style;if(r.decal){var i=this._decalEl=this._decalEl||new e;i.buildPath===e.prototype.buildPath&&(i.buildPath=function(a){t.buildPath(a,t.shape)}),i.silent=!0;var s=i.style;for(var o in r)s[o]!==r[o]&&(s[o]=r[o]);s.fill=r.fill?r.decal:null,s.decal=null,s.shadowColor=null,r.strokeFirst&&(s.stroke=null);for(var l=0;l<a3.length;++l)i[a3[l]]=this[a3[l]];i.__dirty|=Bu}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(t){var r=aa(t);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var s=0;s<r.length;s++){var o=r[s],l=t[o];o==="style"?this.style?Jn(this.style,l):this.useStyle(l):o==="shape"?Jn(this.shape,l):n.prototype.attrKV.call(this,o,l)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if(t!=="none"){if(Dr(t)){var r=UP(t,0);return r>.5?Sz:r>.2?XEe:Az}else if(t)return Az}return Sz},e.prototype.getInsideTextStroke=function(t){var r=this.style.fill;if(Dr(r)){var i=this.__zr,s=!!(i&&i.isDarkMode()),o=UP(t,0)<wz;if(s===o)return r}},e.prototype.buildPath=function(t,r,i){},e.prototype.pathUpdated=function(){this.__dirty&=~rb},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new tg(!1)},e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return!(r==null||r==="none"||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.getBoundingRect=function(){var t=this._rect,r=this.style,i=!t;if(i){var s=!1;this.path||(s=!0,this.createPathProxy());var o=this.path;(s||this.__dirty&rb)&&(o.beginPath(),this.buildPath(o,this.shape,!1),this.pathUpdated()),t=o.getBoundingRect()}if(this._rect=t,this.hasStroke()&&this.path&&this.path.len()>0){var l=this._rectStroke||(this._rectStroke=t.clone());if(this.__dirty||i){l.copy(t);var a=r.strokeNoScale?this.getLineScale():1,h=r.lineWidth;if(!this.hasFill()){var f=this.strokeContainThreshold;h=Math.max(h,f??4)}a>1e-10&&(l.width+=h/a,l.height+=h/a,l.x-=h/a/2,l.y-=h/a/2)}return l}return t},e.prototype.contain=function(t,r){var i=this.transformCoordToLocal(t,r),s=this.getBoundingRect(),o=this.style;if(t=i[0],r=i[1],s.contain(t,r)){var l=this.path;if(this.hasStroke()){var a=o.lineWidth,h=o.strokeNoScale?this.getLineScale():1;if(h>1e-10&&(this.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),h2e(l,a/h,t,r)))return!0}if(this.hasFill())return u2e(l,t,r)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=rb,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){t==="style"?this.dirtyStyle():t==="shape"?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(t,r){t==="shape"?this.setShape(r):n.prototype.attrKV.call(this,t,r)},e.prototype.setShape=function(t,r){var i=this.shape;return i||(i=this.shape={}),typeof t=="string"?i[t]=r:Jn(i,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(this.__dirty&rb)},e.prototype.createStyle=function(t){return VD(ase,t)},e.prototype._innerSaveToNormal=function(t){n.prototype._innerSaveToNormal.call(this,t);var r=this._normalState;t.shape&&!r.shape&&(r.shape=Jn({},this.shape))},e.prototype._applyStateObj=function(t,r,i,s,o,l){n.prototype._applyStateObj.call(this,t,r,i,s,o,l);var a=!(r&&s),h;if(r&&r.shape?o?s?h=r.shape:(h=Jn({},i.shape),Jn(h,r.shape)):(h=Jn({},s?this.shape:i.shape),Jn(h,r.shape)):a&&(h=i.shape),h)if(o){this.shape=Jn({},this.shape);for(var f={},p=aa(h),v=0;v<p.length;v++){var y=p[v];typeof h[y]=="object"?this.shape[y]=h[y]:f[y]=h[y]}this._transitionState(t,{shape:f},l)}else this.shape=h,this.dirtyShape()},e.prototype._mergeStates=function(t){for(var r=n.prototype._mergeStates.call(this,t),i,s=0;s<t.length;s++){var o=t[s];o.shape&&(i=i||{},this._mergeStyle(i,o.shape))}return i&&(r.shape=i),r},e.prototype.getAnimationStyleProps=function(){return f2e},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var r=function(s){Hn(o,s);function o(l){var a=s.call(this,l)||this;return t.init&&t.init.call(a,l),a}return o.prototype.getDefaultStyle=function(){return yi(t.style)},o.prototype.getDefaultShape=function(){return yi(t.shape)},o}(e);for(var i in t)typeof t[i]=="function"&&(r.prototype[i]=t[i]);return r},e.initDefaultProps=function(){var t=e.prototype;t.type="path",t.strokeContainThreshold=5,t.segmentIgnoreThreshold=0,t.subPixelOptimize=!1,t.autoBatch=!1,t.__dirty=Bu|LA|rb}(),e}(Dw),d2e=ti({strokeFirst:!0,font:ox,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},ase),jP=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.hasStroke=function(){var t=this.style,r=t.stroke;return r!=null&&r!=="none"&&t.lineWidth>0},e.prototype.hasFill=function(){var t=this.style,r=t.fill;return r!=null&&r!=="none"},e.prototype.createStyle=function(t){return VD(d2e,t)},e.prototype.setBoundingRect=function(t){this._rect=t},e.prototype.getBoundingRect=function(){var t=this.style;if(!this._rect){var r=t.text;r!=null?r+="":r="";var i=gE(r,t.font,t.textAlign,t.textBaseline);if(i.x+=t.x||0,i.y+=t.y||0,this.hasStroke()){var s=t.lineWidth;i.x-=s/2,i.y-=s/2,i.width+=s,i.height+=s}this._rect=i}return this._rect},e.initDefaultProps=function(){var t=e.prototype;t.dirtyRectTolerance=10}(),e}(Dw);jP.prototype.type="tspan";var p2e=ti({x:0,y:0},Hy),m2e={style:ti({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},ZD.style)};function g2e(n){return!!(n&&typeof n!="string"&&n.width&&n.height)}var z0=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.createStyle=function(t){return VD(p2e,t)},e.prototype._getSize=function(t){var r=this.style,i=r[t];if(i!=null)return i;var s=g2e(r.image)?r.image:this.__image;if(!s)return 0;var o=t==="width"?"height":"width",l=r[o];return l==null?s[t]:s[t]/s[o]*l},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return m2e},e.prototype.getBoundingRect=function(){var t=this.style;return this._rect||(this._rect=new cs(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this._rect},e}(Dw);z0.prototype.type="image";function v2e(n,e){var t=e.x,r=e.y,i=e.width,s=e.height,o=e.r,l,a,h,f;i<0&&(t=t+i,i=-i),s<0&&(r=r+s,s=-s),typeof o=="number"?l=a=h=f=o:o instanceof Array?o.length===1?l=a=h=f=o[0]:o.length===2?(l=h=o[0],a=f=o[1]):o.length===3?(l=o[0],a=f=o[1],h=o[2]):(l=o[0],a=o[1],h=o[2],f=o[3]):l=a=h=f=0;var p;l+a>i&&(p=l+a,l*=i/p,a*=i/p),h+f>i&&(p=h+f,h*=i/p,f*=i/p),a+h>s&&(p=a+h,a*=s/p,h*=s/p),l+f>s&&(p=l+f,l*=s/p,f*=s/p),n.moveTo(t+l,r),n.lineTo(t+i-a,r),a!==0&&n.arc(t+i-a,r+a,a,-Math.PI/2,0),n.lineTo(t+i,r+s-h),h!==0&&n.arc(t+i-h,r+s-h,h,0,Math.PI/2),n.lineTo(t+f,r+s),f!==0&&n.arc(t+f,r+s-f,f,Math.PI/2,Math.PI),n.lineTo(t,r+l),l!==0&&n.arc(t+l,r+l,l,Math.PI,Math.PI*1.5)}var Cb=Math.round;function ose(n,e,t){if(e){var r=e.x1,i=e.x2,s=e.y1,o=e.y2;n.x1=r,n.x2=i,n.y1=s,n.y2=o;var l=t&&t.lineWidth;return l&&(Cb(r*2)===Cb(i*2)&&(n.x1=n.x2=Cy(r,l,!0)),Cb(s*2)===Cb(o*2)&&(n.y1=n.y2=Cy(s,l,!0))),n}}function lse(n,e,t){if(e){var r=e.x,i=e.y,s=e.width,o=e.height;n.x=r,n.y=i,n.width=s,n.height=o;var l=t&&t.lineWidth;return l&&(n.x=Cy(r,l,!0),n.y=Cy(i,l,!0),n.width=Math.max(Cy(r+s,l,!1)-n.x,s===0?0:1),n.height=Math.max(Cy(i+o,l,!1)-n.y,o===0?0:1)),n}}function Cy(n,e,t){if(!e)return n;var r=Cb(n*2);return(r+Cb(e))%2===0?r/2:(r+(t?1:-1))/2}var _2e=function(){function n(){this.x=0,this.y=0,this.width=0,this.height=0}return n}(),y2e={},Ha=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new _2e},e.prototype.buildPath=function(t,r){var i,s,o,l;if(this.subPixelOptimize){var a=lse(y2e,r,this.style);i=a.x,s=a.y,o=a.width,l=a.height,a.r=r.r,r=a}else i=r.x,s=r.y,o=r.width,l=r.height;r.r?v2e(t,r):t.rect(i,s,o,l)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(qi);Ha.prototype.type="rect";var VX={fill:"#000"},HX=2,x2e={style:ti({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},ZD.style)},Io=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r.type="text",r._children=[],r._defaultStyle=VX,r.attr(t),r}return e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){n.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var t=0;t<this._children.length;t++){var r=this._children[t];r.zlevel=this.zlevel,r.z=this.z,r.z2=this.z2,r.culling=this.culling,r.cursor=this.cursor,r.invisible=this.invisible}},e.prototype.updateTransform=function(){var t=this.innerTransformable;t?(t.updateTransform(),t.transform&&(this.transform=t.transform)):n.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(t){var r=this.innerTransformable;return r?r.getLocalTransform(t):n.prototype.getLocalTransform.call(this,t)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),n.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){this._childCursor=0,T2e(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(t){n.prototype.addSelfToZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=t},e.prototype.removeSelfFromZr=function(t){n.prototype.removeSelfFromZr.call(this,t);for(var r=0;r<this._children.length;r++)this._children[r].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var t=new cs(0,0,0,0),r=this._children,i=[],s=null,o=0;o<r.length;o++){var l=r[o],a=l.getBoundingRect(),h=l.getLocalTransform(i);h?(t.copy(a),t.applyTransform(h),s=s||t.clone(),s.union(t)):(s=s||a.clone(),s.union(a))}this._rect=s||t}return this._rect},e.prototype.setDefaultTextStyle=function(t){this._defaultStyle=t||VX},e.prototype.setTextContent=function(t){},e.prototype._mergeStyle=function(t,r){if(!r)return t;var i=r.rich,s=t.rich||i&&{};return Jn(t,r),i&&s?(this._mergeRich(s,i),t.rich=s):s&&(t.rich=s),t},e.prototype._mergeRich=function(t,r){for(var i=aa(r),s=0;s<i.length;s++){var o=i[s];t[o]=t[o]||{},Jn(t[o],r[o])}},e.prototype.getAnimationStyleProps=function(){return x2e},e.prototype._getOrCreateChild=function(t){var r=this._children[this._childCursor];return(!r||!(r instanceof t))&&(r=new t),this._children[this._childCursor++]=r,r.__zr=this.__zr,r.parent=this,r},e.prototype._updatePlainTexts=function(){var t=this.style,r=t.font||ox,i=t.padding,s=YX(t),o=VCe(s,t),l=o3(t),a=!!t.backgroundColor,h=o.outerHeight,f=o.outerWidth,p=o.contentWidth,v=o.lines,y=o.lineHeight,S=this._defaultStyle,C=t.x||0,M=t.y||0,E=t.align||S.align||"left",L=t.verticalAlign||S.verticalAlign||"top",k=C,H=ib(M,o.contentHeight,L);if(l||i){var X=BA(C,f,E),Z=ib(M,h,L);l&&this._renderBackground(t,t,X,Z,f,h)}H+=y/2,i&&(k=ZX(C,E,i),L==="top"?H+=i[0]:L==="bottom"&&(H-=i[2]));for(var Q=0,re=!1,ie=qX("fill"in t?t.fill:(re=!0,S.fill)),oe=XX("stroke"in t?t.stroke:!a&&(!S.autoStroke||re)?(Q=HX,S.stroke):null),fe=t.textShadowBlur>0,Se=t.width!=null&&(t.overflow==="truncate"||t.overflow==="break"||t.overflow==="breakAll"),Ee=o.calculatedLineHeight,Ie=0;Ie<v.length;Ie++){var He=this._getOrCreateChild(jP),Re=He.createStyle();He.useStyle(Re),Re.text=v[Ie],Re.x=k,Re.y=H,E&&(Re.textAlign=E),Re.textBaseline="middle",Re.opacity=t.opacity,Re.strokeFirst=!0,fe&&(Re.shadowBlur=t.textShadowBlur||0,Re.shadowColor=t.textShadowColor||"transparent",Re.shadowOffsetX=t.textShadowOffsetX||0,Re.shadowOffsetY=t.textShadowOffsetY||0),Re.stroke=oe,Re.fill=ie,oe&&(Re.lineWidth=t.lineWidth||Q,Re.lineDash=t.lineDash,Re.lineDashOffset=t.lineDashOffset||0),Re.font=r,WX(Re,t),H+=y,Se&&He.setBoundingRect(new cs(BA(Re.x,t.width,Re.textAlign),ib(Re.y,Ee,Re.textBaseline),p,Ee))}},e.prototype._updateRichTexts=function(){var t=this.style,r=YX(t),i=WCe(r,t),s=i.width,o=i.outerWidth,l=i.outerHeight,a=t.padding,h=t.x||0,f=t.y||0,p=this._defaultStyle,v=t.align||p.align,y=t.verticalAlign||p.verticalAlign,S=BA(h,o,v),C=ib(f,l,y),M=S,E=C;a&&(M+=a[3],E+=a[0]);var L=M+s;o3(t)&&this._renderBackground(t,t,S,C,o,l);for(var k=!!t.backgroundColor,H=0;H<i.lines.length;H++){for(var X=i.lines[H],Z=X.tokens,Q=Z.length,re=X.lineHeight,ie=X.width,oe=0,fe=M,Se=L,Ee=Q-1,Ie=void 0;oe<Q&&(Ie=Z[oe],!Ie.align||Ie.align==="left");)this._placeToken(Ie,t,re,E,fe,"left",k),ie-=Ie.width,fe+=Ie.width,oe++;for(;Ee>=0&&(Ie=Z[Ee],Ie.align==="right");)this._placeToken(Ie,t,re,E,Se,"right",k),ie-=Ie.width,Se-=Ie.width,Ee--;for(fe+=(s-(fe-M)-(L-Se)-ie)/2;oe<=Ee;)Ie=Z[oe],this._placeToken(Ie,t,re,E,fe+Ie.width/2,"center",k),fe+=Ie.width,oe++;E+=re}},e.prototype._placeToken=function(t,r,i,s,o,l,a){var h=r.rich[t.styleName]||{};h.text=t.text;var f=t.verticalAlign,p=s+i/2;f==="top"?p=s+t.height/2:f==="bottom"&&(p=s+i-t.height/2);var v=!t.isLineHolder&&o3(h);v&&this._renderBackground(h,r,l==="right"?o-t.width:l==="center"?o-t.width/2:o,p-t.height/2,t.width,t.height);var y=!!h.backgroundColor,S=t.textPadding;S&&(o=ZX(o,l,S),p-=t.height/2-S[0]-t.innerHeight/2);var C=this._getOrCreateChild(jP),M=C.createStyle();C.useStyle(M);var E=this._defaultStyle,L=!1,k=0,H=qX("fill"in h?h.fill:"fill"in r?r.fill:(L=!0,E.fill)),X=XX("stroke"in h?h.stroke:"stroke"in r?r.stroke:!y&&!a&&(!E.autoStroke||L)?(k=HX,E.stroke):null),Z=h.textShadowBlur>0||r.textShadowBlur>0;M.text=t.text,M.x=o,M.y=p,Z&&(M.shadowBlur=h.textShadowBlur||r.textShadowBlur||0,M.shadowColor=h.textShadowColor||r.textShadowColor||"transparent",M.shadowOffsetX=h.textShadowOffsetX||r.textShadowOffsetX||0,M.shadowOffsetY=h.textShadowOffsetY||r.textShadowOffsetY||0),M.textAlign=l,M.textBaseline="middle",M.font=t.font||ox,M.opacity=uT(h.opacity,r.opacity,1),WX(M,h),X&&(M.lineWidth=uT(h.lineWidth,r.lineWidth,k),M.lineDash=Ii(h.lineDash,r.lineDash),M.lineDashOffset=r.lineDashOffset||0,M.stroke=X),H&&(M.fill=H);var Q=t.contentWidth,re=t.contentHeight;C.setBoundingRect(new cs(BA(M.x,Q,M.textAlign),ib(M.y,re,M.textBaseline),Q,re))},e.prototype._renderBackground=function(t,r,i,s,o,l){var a=t.backgroundColor,h=t.borderWidth,f=t.borderColor,p=a&&a.image,v=a&&!p,y=t.borderRadius,S=this,C,M;if(v||t.lineHeight||h&&f){C=this._getOrCreateChild(Ha),C.useStyle(C.createStyle()),C.style.fill=null;var E=C.shape;E.x=i,E.y=s,E.width=o,E.height=l,E.r=y,C.dirtyShape()}if(v){var L=C.style;L.fill=a||null,L.fillOpacity=Ii(t.fillOpacity,1)}else if(p){M=this._getOrCreateChild(z0),M.onload=function(){S.dirtyStyle()};var k=M.style;k.image=a.image,k.x=i,k.y=s,k.width=o,k.height=l}if(h&&f){var L=C.style;L.lineWidth=h,L.stroke=f,L.strokeOpacity=Ii(t.strokeOpacity,1),L.lineDash=t.borderDash,L.lineDashOffset=t.borderDashOffset||0,C.strokeContainThreshold=0,C.hasFill()&&C.hasStroke()&&(L.strokeFirst=!0,L.lineWidth*=2)}var H=(C||M).style;H.shadowBlur=t.shadowBlur||0,H.shadowColor=t.shadowColor||"transparent",H.shadowOffsetX=t.shadowOffsetX||0,H.shadowOffsetY=t.shadowOffsetY||0,H.opacity=uT(t.opacity,r.opacity,1)},e.makeFont=function(t){var r="";return A2e(t)&&(r=[t.fontStyle,t.fontWeight,S2e(t.fontSize),t.fontFamily||"sans-serif"].join(" ")),r&&rp(r)||t.textFont||t.font},e}(Dw),b2e={left:!0,right:1,center:1},w2e={top:1,bottom:1,middle:1},jX=["fontStyle","fontWeight","fontSize","fontFamily"];function S2e(n){return typeof n=="string"&&(n.indexOf("px")!==-1||n.indexOf("rem")!==-1||n.indexOf("em")!==-1)?n:isNaN(+n)?V6+"px":n+"px"}function WX(n,e){for(var t=0;t<jX.length;t++){var r=jX[t],i=e[r];i!=null&&(n[r]=i)}}function A2e(n){return n.fontSize!=null||n.fontFamily||n.fontWeight}function T2e(n){return $X(n),it(n.rich,$X),n}function $X(n){if(n){n.font=Io.makeFont(n);var e=n.align;e==="middle"&&(e="center"),n.align=e==null||b2e[e]?e:"left";var t=n.verticalAlign;t==="center"&&(t="middle"),n.verticalAlign=t==null||w2e[t]?t:"top";var r=n.padding;r&&(n.padding=gie(n.padding))}}function XX(n,e){return n==null||e<=0||n==="transparent"||n==="none"?null:n.image||n.colorStops?"#000":n}function qX(n){return n==null||n==="none"?null:n.image||n.colorStops?"#000":n}function ZX(n,e,t){return e==="right"?n-t[1]:e==="center"?n+t[3]/2-t[1]/2:n+t[3]}function YX(n){var e=n.text;return e!=null&&(e+=""),e}function o3(n){return!!(n.backgroundColor||n.lineHeight||n.borderWidth&&n.borderColor)}var $i=qs(),M2e=function(n,e,t,r){if(r){var i=$i(r);i.dataIndex=t,i.dataType=e,i.seriesIndex=n,i.ssrType="chart",r.type==="group"&&r.traverse(function(s){var o=$i(s);o.seriesIndex=n,o.dataIndex=t,o.dataType=e,o.ssrType="chart"})}},KX=1,JX={},cse=qs(),tG=qs(),nG=0,YD=1,KD=2,Fh=["emphasis","blur","select"],WP=["normal","emphasis","blur","select"],E2e=10,C2e=9,jy="highlight",hR="downplay",gT="select",fR="unselect",vT="toggleSelect";function k1(n){return n!=null&&n!=="none"}function JD(n,e,t){n.onHoverStateChange&&(n.hoverState||0)!==t&&n.onHoverStateChange(e),n.hoverState=t}function use(n){JD(n,"emphasis",KD)}function hse(n){n.hoverState===KD&&JD(n,"normal",nG)}function rG(n){JD(n,"blur",YD)}function fse(n){n.hoverState===YD&&JD(n,"normal",nG)}function I2e(n){n.selected=!0}function R2e(n){n.selected=!1}function QX(n,e,t){e(n,t)}function og(n,e,t){QX(n,e,t),n.isGroup&&n.traverse(function(r){QX(r,e,t)})}function eq(n,e){switch(e){case"emphasis":n.hoverState=KD;break;case"normal":n.hoverState=nG;break;case"blur":n.hoverState=YD;break;case"select":n.selected=!0}}function P2e(n,e,t,r){for(var i=n.style,s={},o=0;o<e.length;o++){var l=e[o],a=i[l];s[l]=a??(r&&r[l])}for(var o=0;o<n.animators.length;o++){var h=n.animators[o];h.__fromStateTransition&&h.__fromStateTransition.indexOf(t)<0&&h.targetName==="style"&&h.saveTo(s,e)}return s}function L2e(n,e,t,r){var i=t&&Xi(t,"select")>=0,s=!1;if(n instanceof qi){var o=cse(n),l=i&&o.selectFill||o.normalFill,a=i&&o.selectStroke||o.normalStroke;if(k1(l)||k1(a)){r=r||{};var h=r.style||{};h.fill==="inherit"?(s=!0,r=Jn({},r),h=Jn({},h),h.fill=l):!k1(h.fill)&&k1(l)?(s=!0,r=Jn({},r),h=Jn({},h),h.fill=yX(l)):!k1(h.stroke)&&k1(a)&&(s||(r=Jn({},r),h=Jn({},h)),h.stroke=yX(a)),r.style=h}}if(r&&r.z2==null){s||(r=Jn({},r));var f=n.z2EmphasisLift;r.z2=n.z2+(f??E2e)}return r}function D2e(n,e,t){if(t&&t.z2==null){t=Jn({},t);var r=n.z2SelectLift;t.z2=n.z2+(r??C2e)}return t}function B2e(n,e,t){var r=Xi(n.currentStates,e)>=0,i=n.style.opacity,s=r?null:P2e(n,["opacity"],e,{opacity:1});t=t||{};var o=t.style||{};return o.opacity==null&&(t=Jn({},t),o=Jn({opacity:r?i:s.opacity*.1},o),t.style=o),t}function l3(n,e){var t=this.states[n];if(this.style){if(n==="emphasis")return L2e(this,n,e,t);if(n==="blur")return B2e(this,n,t);if(n==="select")return D2e(this,n,t)}return t}function k2e(n){n.stateProxy=l3;var e=n.getTextContent(),t=n.getTextGuideLine();e&&(e.stateProxy=l3),t&&(t.stateProxy=l3)}function tq(n,e){!gse(n,e)&&!n.__highByOuter&&og(n,use)}function nq(n,e){!gse(n,e)&&!n.__highByOuter&&og(n,hse)}function cw(n,e){n.__highByOuter|=1<<(e||0),og(n,use)}function uw(n,e){!(n.__highByOuter&=~(1<<(e||0)))&&og(n,hse)}function O2e(n){og(n,rG)}function dse(n){og(n,fse)}function pse(n){og(n,I2e)}function mse(n){og(n,R2e)}function gse(n,e){return n.__highDownSilentOnTouch&&e.zrByTouch}function vse(n){var e=n.getModel(),t=[],r=[];e.eachComponent(function(i,s){var o=tG(s),l=i==="series",a=l?n.getViewOfSeriesModel(s):n.getViewOfComponentModel(s);!l&&r.push(a),o.isBlured&&(a.group.traverse(function(h){fse(h)}),l&&t.push(s)),o.isBlured=!1}),it(r,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(t,!1,e)})}function Iz(n,e,t,r){var i=r.getModel();t=t||"coordinateSystem";function s(h,f){for(var p=0;p<f.length;p++){var v=h.getItemGraphicEl(f[p]);v&&dse(v)}}if(n!=null&&!(!e||e==="none")){var o=i.getSeriesByIndex(n),l=o.coordinateSystem;l&&l.master&&(l=l.master);var a=[];i.eachSeries(function(h){var f=o===h,p=h.coordinateSystem;p&&p.master&&(p=p.master);var v=p&&l?p===l:f;if(!(t==="series"&&!f||t==="coordinateSystem"&&!v||e==="series"&&f)){var y=r.getViewOfSeriesModel(h);if(y.group.traverse(function(M){M.__highByOuter&&f&&e==="self"||rG(M)}),Pc(e))s(h.getData(),e);else if($r(e))for(var S=aa(e),C=0;C<S.length;C++)s(h.getData(S[C]),e[S[C]]);a.push(h),tG(h).isBlured=!0}}),i.eachComponent(function(h,f){if(h!=="series"){var p=r.getViewOfComponentModel(f);p&&p.toggleBlurSeries&&p.toggleBlurSeries(a,!0,i)}})}}function Rz(n,e,t){if(!(n==null||e==null)){var r=t.getModel().getComponent(n,e);if(r){tG(r).isBlured=!0;var i=t.getViewOfComponentModel(r);!i||!i.focusBlurEnabled||i.group.traverse(function(s){rG(s)})}}}function F2e(n,e,t){var r=n.seriesIndex,i=n.getData(e.dataType);if(i){var s=lx(i,e);s=(fr(s)?s[0]:s)||0;var o=i.getItemGraphicEl(s);if(!o)for(var l=i.count(),a=0;!o&&a<l;)o=i.getItemGraphicEl(a++);if(o){var h=$i(o);Iz(r,h.focus,h.blurScope,t)}else{var f=n.get(["emphasis","focus"]),p=n.get(["emphasis","blurScope"]);f!=null&&Iz(r,f,p,t)}}}function iG(n,e,t,r){var i={focusSelf:!1,dispatchers:null};if(n==null||n==="series"||e==null||t==null)return i;var s=r.getModel().getComponent(n,e);if(!s)return i;var o=r.getViewOfComponentModel(s);if(!o||!o.findHighDownDispatchers)return i;for(var l=o.findHighDownDispatchers(t),a,h=0;h<l.length;h++)if($i(l[h]).focus==="self"){a=!0;break}return{focusSelf:a,dispatchers:l}}function N2e(n,e,t){var r=$i(n),i=iG(r.componentMainType,r.componentIndex,r.componentHighDownName,t),s=i.dispatchers,o=i.focusSelf;s?(o&&Rz(r.componentMainType,r.componentIndex,t),it(s,function(l){return tq(l,e)})):(Iz(r.seriesIndex,r.focus,r.blurScope,t),r.focus==="self"&&Rz(r.componentMainType,r.componentIndex,t),tq(n,e))}function z2e(n,e,t){vse(t);var r=$i(n),i=iG(r.componentMainType,r.componentIndex,r.componentHighDownName,t).dispatchers;i?it(i,function(s){return nq(s,e)}):nq(n,e)}function U2e(n,e,t){if(Dz(e)){var r=e.dataType,i=n.getData(r),s=lx(i,e);fr(s)||(s=[s]),n[e.type===vT?"toggleSelect":e.type===gT?"select":"unselect"](s,r)}}function rq(n){var e=n.getAllData();it(e,function(t){var r=t.data,i=t.type;r.eachItemGraphicEl(function(s,o){n.isSelected(o,i)?pse(s):mse(s)})})}function G2e(n){var e=[];return n.eachSeries(function(t){var r=t.getAllData();it(r,function(i){i.data;var s=i.type,o=t.getSelectedDataIndices();if(o.length>0){var l={dataIndex:o,seriesIndex:t.seriesIndex};s!=null&&(l.dataType=s),e.push(l)}})}),e}function Pz(n,e,t){_se(n,!0),og(n,k2e),H2e(n,e,t)}function V2e(n){_se(n,!1)}function vM(n,e,t,r){r?V2e(n):Pz(n,e,t)}function H2e(n,e,t){var r=$i(n);e!=null?(r.focus=e,r.blurScope=t):r.focus&&(r.focus=null)}var iq=["emphasis","blur","select"],j2e={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function $P(n,e,t,r){t=t||"itemStyle";for(var i=0;i<iq.length;i++){var s=iq[i],o=e.getModel([s,t]),l=n.ensureState(s);l.style=o[j2e[t]]()}}function _se(n,e){var t=e===!1,r=n;n.highDownSilentOnTouch&&(r.__highDownSilentOnTouch=n.highDownSilentOnTouch),(!t||r.__highDownDispatcher)&&(r.__highByOuter=r.__highByOuter||0,r.__highDownDispatcher=!t)}function Lz(n){return!!(n&&n.__highDownDispatcher)}function W2e(n){var e=JX[n];return e==null&&KX<=32&&(e=JX[n]=KX++),e}function Dz(n){var e=n.type;return e===gT||e===fR||e===vT}function sq(n){var e=n.type;return e===jy||e===hR}function $2e(n){var e=cse(n);e.normalFill=n.style.fill,e.normalStroke=n.style.stroke;var t=n.states.select||{};e.selectFill=t.style&&t.style.fill||null,e.selectStroke=t.style&&t.style.stroke||null}var O1=tg.CMD,X2e=[[],[],[]],aq=Math.sqrt,q2e=Math.atan2;function yse(n,e){if(e){var t=n.data,r=n.len(),i,s,o,l,a,h,f=O1.M,p=O1.C,v=O1.L,y=O1.R,S=O1.A,C=O1.Q;for(o=0,l=0;o<r;){switch(i=t[o++],l=o,s=0,i){case f:s=1;break;case v:s=1;break;case p:s=3;break;case C:s=2;break;case S:var M=e[4],E=e[5],L=aq(e[0]*e[0]+e[1]*e[1]),k=aq(e[2]*e[2]+e[3]*e[3]),H=q2e(-e[1]/k,e[0]/L);t[o]*=L,t[o++]+=M,t[o]*=k,t[o++]+=E,t[o++]*=L,t[o++]*=k,t[o++]+=H,t[o++]+=H,o+=2,l=o;break;case y:h[0]=t[o++],h[1]=t[o++],Rh(h,h,e),t[l++]=h[0],t[l++]=h[1],h[0]+=t[o++],h[1]+=t[o++],Rh(h,h,e),t[l++]=h[0],t[l++]=h[1]}for(a=0;a<s;a++){var X=X2e[a];X[0]=t[o++],X[1]=t[o++],Rh(X,X,e),t[l++]=X[0],t[l++]=X[1]}}n.increaseVersion()}}var c3=Math.sqrt,Z2=Math.sin,Y2=Math.cos,tA=Math.PI;function oq(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Bz(n,e){return(n[0]*e[0]+n[1]*e[1])/(oq(n)*oq(e))}function lq(n,e){return(n[0]*e[1]<n[1]*e[0]?-1:1)*Math.acos(Bz(n,e))}function cq(n,e,t,r,i,s,o,l,a,h,f){var p=a*(tA/180),v=Y2(p)*(n-t)/2+Z2(p)*(e-r)/2,y=-1*Z2(p)*(n-t)/2+Y2(p)*(e-r)/2,S=v*v/(o*o)+y*y/(l*l);S>1&&(o*=c3(S),l*=c3(S));var C=(i===s?-1:1)*c3((o*o*(l*l)-o*o*(y*y)-l*l*(v*v))/(o*o*(y*y)+l*l*(v*v)))||0,M=C*o*y/l,E=C*-l*v/o,L=(n+t)/2+Y2(p)*M-Z2(p)*E,k=(e+r)/2+Z2(p)*M+Y2(p)*E,H=lq([1,0],[(v-M)/o,(y-E)/l]),X=[(v-M)/o,(y-E)/l],Z=[(-1*v-M)/o,(-1*y-E)/l],Q=lq(X,Z);if(Bz(X,Z)<=-1&&(Q=tA),Bz(X,Z)>=1&&(Q=0),Q<0){var re=Math.round(Q/tA*1e6)/1e6;Q=tA*2+re%2*tA}f.addData(h,L,k,o,l,H,Q,p,s)}var Z2e=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,Y2e=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function K2e(n){var e=new tg;if(!n)return e;var t=0,r=0,i=t,s=r,o,l=tg.CMD,a=n.match(Z2e);if(!a)return e;for(var h=0;h<a.length;h++){for(var f=a[h],p=f.charAt(0),v=void 0,y=f.match(Y2e)||[],S=y.length,C=0;C<S;C++)y[C]=parseFloat(y[C]);for(var M=0;M<S;){var E=void 0,L=void 0,k=void 0,H=void 0,X=void 0,Z=void 0,Q=void 0,re=t,ie=r,oe=void 0,fe=void 0;switch(p){case"l":t+=y[M++],r+=y[M++],v=l.L,e.addData(v,t,r);break;case"L":t=y[M++],r=y[M++],v=l.L,e.addData(v,t,r);break;case"m":t+=y[M++],r+=y[M++],v=l.M,e.addData(v,t,r),i=t,s=r,p="l";break;case"M":t=y[M++],r=y[M++],v=l.M,e.addData(v,t,r),i=t,s=r,p="L";break;case"h":t+=y[M++],v=l.L,e.addData(v,t,r);break;case"H":t=y[M++],v=l.L,e.addData(v,t,r);break;case"v":r+=y[M++],v=l.L,e.addData(v,t,r);break;case"V":r=y[M++],v=l.L,e.addData(v,t,r);break;case"C":v=l.C,e.addData(v,y[M++],y[M++],y[M++],y[M++],y[M++],y[M++]),t=y[M-2],r=y[M-1];break;case"c":v=l.C,e.addData(v,y[M++]+t,y[M++]+r,y[M++]+t,y[M++]+r,y[M++]+t,y[M++]+r),t+=y[M-2],r+=y[M-1];break;case"S":E=t,L=r,oe=e.len(),fe=e.data,o===l.C&&(E+=t-fe[oe-4],L+=r-fe[oe-3]),v=l.C,re=y[M++],ie=y[M++],t=y[M++],r=y[M++],e.addData(v,E,L,re,ie,t,r);break;case"s":E=t,L=r,oe=e.len(),fe=e.data,o===l.C&&(E+=t-fe[oe-4],L+=r-fe[oe-3]),v=l.C,re=t+y[M++],ie=r+y[M++],t+=y[M++],r+=y[M++],e.addData(v,E,L,re,ie,t,r);break;case"Q":re=y[M++],ie=y[M++],t=y[M++],r=y[M++],v=l.Q,e.addData(v,re,ie,t,r);break;case"q":re=y[M++]+t,ie=y[M++]+r,t+=y[M++],r+=y[M++],v=l.Q,e.addData(v,re,ie,t,r);break;case"T":E=t,L=r,oe=e.len(),fe=e.data,o===l.Q&&(E+=t-fe[oe-4],L+=r-fe[oe-3]),t=y[M++],r=y[M++],v=l.Q,e.addData(v,E,L,t,r);break;case"t":E=t,L=r,oe=e.len(),fe=e.data,o===l.Q&&(E+=t-fe[oe-4],L+=r-fe[oe-3]),t+=y[M++],r+=y[M++],v=l.Q,e.addData(v,E,L,t,r);break;case"A":k=y[M++],H=y[M++],X=y[M++],Z=y[M++],Q=y[M++],re=t,ie=r,t=y[M++],r=y[M++],v=l.A,cq(re,ie,t,r,Z,Q,k,H,X,v,e);break;case"a":k=y[M++],H=y[M++],X=y[M++],Z=y[M++],Q=y[M++],re=t,ie=r,t+=y[M++],r+=y[M++],v=l.A,cq(re,ie,t,r,Z,Q,k,H,X,v,e);break}}(p==="z"||p==="Z")&&(v=l.Z,e.addData(v),t=i,r=s),o=v}return e.toStatic(),e}var xse=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.applyTransform=function(t){},e}(qi);function bse(n){return n.setData!=null}function wse(n,e){var t=K2e(n),r=Jn({},e);return r.buildPath=function(i){if(bse(i)){i.setData(t.data);var s=i.getContext();s&&i.rebuildPath(s,1)}else{var s=i;t.rebuildPath(s,1)}},r.applyTransform=function(i){yse(t,i),this.dirtyShape()},r}function J2e(n,e){return new xse(wse(n,e))}function Q2e(n,e){var t=wse(n,e),r=function(i){Hn(s,i);function s(o){var l=i.call(this,o)||this;return l.applyTransform=t.applyTransform,l.buildPath=t.buildPath,l}return s}(xse);return r}function eIe(n,e){for(var t=[],r=n.length,i=0;i<r;i++){var s=n[i];t.push(s.getUpdatedPathProxy(!0))}var o=new qi(e);return o.createPathProxy(),o.buildPath=function(l){if(bse(l)){l.appendPath(t);var a=l.getContext();a&&l.rebuildPath(a,1)}},o}function sG(n,e){e=e||{};var t=new qi;return n.shape&&t.setShape(n.shape),t.setStyle(n.style),e.bakeTransform?yse(t.path,n.getComputedTransform()):e.toLocal?t.setLocalTransform(n.getComputedTransform()):t.copyTransform(n),t.buildPath=n.buildPath,t.applyTransform=t.applyTransform,t.z=n.z,t.z2=n.z2,t.zlevel=n.zlevel,t}var tIe=function(){function n(){this.cx=0,this.cy=0,this.r=0}return n}(),Sse=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new tIe},e.prototype.buildPath=function(t,r){t.moveTo(r.cx+r.r,r.cy),t.arc(r.cx,r.cy,r.r,0,Math.PI*2)},e}(qi);Sse.prototype.type="circle";const QD=Sse;var nIe=function(){function n(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return n}(),Ase=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new nIe},e.prototype.buildPath=function(t,r){var i=.5522848,s=r.cx,o=r.cy,l=r.rx,a=r.ry,h=l*i,f=a*i;t.moveTo(s-l,o),t.bezierCurveTo(s-l,o-f,s-h,o-a,s,o-a),t.bezierCurveTo(s+h,o-a,s+l,o-f,s+l,o),t.bezierCurveTo(s+l,o+f,s+h,o+a,s,o+a),t.bezierCurveTo(s-h,o+a,s-l,o+f,s-l,o),t.closePath()},e}(qi);Ase.prototype.type="ellipse";const Tse=Ase;var Mse=Math.PI,u3=Mse*2,Z_=Math.sin,F1=Math.cos,rIe=Math.acos,zl=Math.atan2,uq=Math.abs,_T=Math.sqrt,kA=Math.max,qd=Math.min,Lf=1e-4;function iIe(n,e,t,r,i,s,o,l){var a=t-n,h=r-e,f=o-i,p=l-s,v=p*a-f*h;if(!(v*v<Lf))return v=(f*(e-s)-p*(n-i))/v,[n+v*a,e+v*h]}function K2(n,e,t,r,i,s,o){var l=n-t,a=e-r,h=(o?s:-s)/_T(l*l+a*a),f=h*a,p=-h*l,v=n+f,y=e+p,S=t+f,C=r+p,M=(v+S)/2,E=(y+C)/2,L=S-v,k=C-y,H=L*L+k*k,X=i-s,Z=v*C-S*y,Q=(k<0?-1:1)*_T(kA(0,X*X*H-Z*Z)),re=(Z*k-L*Q)/H,ie=(-Z*L-k*Q)/H,oe=(Z*k+L*Q)/H,fe=(-Z*L+k*Q)/H,Se=re-M,Ee=ie-E,Ie=oe-M,He=fe-E;return Se*Se+Ee*Ee>Ie*Ie+He*He&&(re=oe,ie=fe),{cx:re,cy:ie,x0:-f,y0:-p,x1:re*(i/X-1),y1:ie*(i/X-1)}}function sIe(n){var e;if(fr(n)){var t=n.length;if(!t)return n;t===1?e=[n[0],n[0],0,0]:t===2?e=[n[0],n[0],n[1],n[1]]:t===3?e=n.concat(n[2]):e=n}else e=[n,n,n,n];return e}function aIe(n,e){var t,r=kA(e.r,0),i=kA(e.r0||0,0),s=r>0,o=i>0;if(!(!s&&!o)){if(s||(r=i,i=0),i>r){var l=r;r=i,i=l}var a=e.startAngle,h=e.endAngle;if(!(isNaN(a)||isNaN(h))){var f=e.cx,p=e.cy,v=!!e.clockwise,y=uq(h-a),S=y>u3&&y%u3;if(S>Lf&&(y=S),!(r>Lf))n.moveTo(f,p);else if(y>u3-Lf)n.moveTo(f+r*F1(a),p+r*Z_(a)),n.arc(f,p,r,a,h,!v),i>Lf&&(n.moveTo(f+i*F1(h),p+i*Z_(h)),n.arc(f,p,i,h,a,v));else{var C=void 0,M=void 0,E=void 0,L=void 0,k=void 0,H=void 0,X=void 0,Z=void 0,Q=void 0,re=void 0,ie=void 0,oe=void 0,fe=void 0,Se=void 0,Ee=void 0,Ie=void 0,He=r*F1(a),Re=r*Z_(a),st=i*F1(h),_e=i*Z_(h),We=y>Lf;if(We){var Ue=e.cornerRadius;Ue&&(t=sIe(Ue),C=t[0],M=t[1],E=t[2],L=t[3]);var vt=uq(r-i)/2;if(k=qd(vt,E),H=qd(vt,L),X=qd(vt,C),Z=qd(vt,M),ie=Q=kA(k,H),oe=re=kA(X,Z),(Q>Lf||re>Lf)&&(fe=r*F1(h),Se=r*Z_(h),Ee=i*F1(a),Ie=i*Z_(a),y<Mse)){var xt=iIe(He,Re,Ee,Ie,fe,Se,st,_e);if(xt){var Vt=He-xt[0],lt=Re-xt[1],Ht=fe-xt[0],Qt=Se-xt[1],rn=1/Z_(rIe((Vt*Ht+lt*Qt)/(_T(Vt*Vt+lt*lt)*_T(Ht*Ht+Qt*Qt)))/2),jn=_T(xt[0]*xt[0]+xt[1]*xt[1]);ie=qd(Q,(r-jn)/(rn+1)),oe=qd(re,(i-jn)/(rn-1))}}}if(!We)n.moveTo(f+He,p+Re);else if(ie>Lf){var Bn=qd(E,ie),Tn=qd(L,ie),Le=K2(Ee,Ie,He,Re,r,Bn,v),qe=K2(fe,Se,st,_e,r,Tn,v);n.moveTo(f+Le.cx+Le.x0,p+Le.cy+Le.y0),ie<Q&&Bn===Tn?n.arc(f+Le.cx,p+Le.cy,ie,zl(Le.y0,Le.x0),zl(qe.y0,qe.x0),!v):(Bn>0&&n.arc(f+Le.cx,p+Le.cy,Bn,zl(Le.y0,Le.x0),zl(Le.y1,Le.x1),!v),n.arc(f,p,r,zl(Le.cy+Le.y1,Le.cx+Le.x1),zl(qe.cy+qe.y1,qe.cx+qe.x1),!v),Tn>0&&n.arc(f+qe.cx,p+qe.cy,Tn,zl(qe.y1,qe.x1),zl(qe.y0,qe.x0),!v))}else n.moveTo(f+He,p+Re),n.arc(f,p,r,a,h,!v);if(!(i>Lf)||!We)n.lineTo(f+st,p+_e);else if(oe>Lf){var Bn=qd(C,oe),Tn=qd(M,oe),Le=K2(st,_e,fe,Se,i,-Tn,v),qe=K2(He,Re,Ee,Ie,i,-Bn,v);n.lineTo(f+Le.cx+Le.x0,p+Le.cy+Le.y0),oe<re&&Bn===Tn?n.arc(f+Le.cx,p+Le.cy,oe,zl(Le.y0,Le.x0),zl(qe.y0,qe.x0),!v):(Tn>0&&n.arc(f+Le.cx,p+Le.cy,Tn,zl(Le.y0,Le.x0),zl(Le.y1,Le.x1),!v),n.arc(f,p,i,zl(Le.cy+Le.y1,Le.cx+Le.x1),zl(qe.cy+qe.y1,qe.cx+qe.x1),v),Bn>0&&n.arc(f+qe.cx,p+qe.cy,Bn,zl(qe.y1,qe.x1),zl(qe.y0,qe.x0),!v))}else n.lineTo(f+st,p+_e),n.arc(f,p,i,h,a,v)}n.closePath()}}}var oIe=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return n}(),Nh=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new oIe},e.prototype.buildPath=function(t,r){aIe(t,r)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(qi);Nh.prototype.type="sector";var lIe=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return n}(),Ese=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new lIe},e.prototype.buildPath=function(t,r){var i=r.cx,s=r.cy,o=Math.PI*2;t.moveTo(i+r.r,s),t.arc(i,s,r.r,0,o,!1),t.moveTo(i+r.r0,s),t.arc(i,s,r.r0,0,o,!0)},e}(qi);Ese.prototype.type="ring";const aG=Ese;function cIe(n,e,t,r){var i=[],s=[],o=[],l=[],a,h,f,p;if(r){f=[1/0,1/0],p=[-1/0,-1/0];for(var v=0,y=n.length;v<y;v++)Tb(f,f,n[v]),Mb(p,p,n[v]);Tb(f,f,r[0]),Mb(p,p,r[1])}for(var v=0,y=n.length;v<y;v++){var S=n[v];if(t)a=n[v?v-1:y-1],h=n[(v+1)%y];else if(v===0||v===y-1){i.push(qMe(n[v]));continue}else a=n[v-1],h=n[v+1];ZMe(s,h,a),IF(s,s,e);var C=cz(S,a),M=cz(S,h),E=C+M;E!==0&&(C/=E,M/=E),IF(o,s,-C),IF(l,s,M);var L=nX([],S,o),k=nX([],S,l);r&&(Mb(L,L,f),Tb(L,L,p),Mb(k,k,f),Tb(k,k,p)),i.push(L),i.push(k)}return t&&i.push(i.shift()),i}function Cse(n,e,t){var r=e.smooth,i=e.points;if(i&&i.length>=2){if(r){var s=cIe(i,r,t,e.smoothConstraint);n.moveTo(i[0][0],i[0][1]);for(var o=i.length,l=0;l<(t?o:o-1);l++){var a=s[l*2],h=s[l*2+1],f=i[(l+1)%o];n.bezierCurveTo(a[0],a[1],h[0],h[1],f[0],f[1])}}else{n.moveTo(i[0][0],i[0][1]);for(var l=1,p=i.length;l<p;l++)n.lineTo(i[l][0],i[l][1])}t&&n.closePath()}}var uIe=function(){function n(){this.points=null,this.smooth=0,this.smoothConstraint=null}return n}(),Ise=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultShape=function(){return new uIe},e.prototype.buildPath=function(t,r){Cse(t,r,!0)},e}(qi);Ise.prototype.type="polygon";const eB=Ise;var hIe=function(){function n(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return n}(),Bw=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new hIe},e.prototype.buildPath=function(t,r){Cse(t,r,!1)},e}(qi);Bw.prototype.type="polyline";var fIe={},dIe=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return n}(),Rse=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new dIe},e.prototype.buildPath=function(t,r){var i,s,o,l;if(this.subPixelOptimize){var a=ose(fIe,r,this.style);i=a.x1,s=a.y1,o=a.x2,l=a.y2}else i=r.x1,s=r.y1,o=r.x2,l=r.y2;var h=r.percent;h!==0&&(t.moveTo(i,s),h<1&&(o=i*(1-h)+o*h,l=s*(1-h)+l*h),t.lineTo(o,l))},e.prototype.pointAt=function(t){var r=this.shape;return[r.x1*(1-t)+r.x2*t,r.y1*(1-t)+r.y2*t]},e}(qi);Rse.prototype.type="line";const Hf=Rse;var Jc=[],pIe=function(){function n(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return n}();function hq(n,e,t){var r=n.cpx2,i=n.cpy2;return r!=null||i!=null?[(t?dX:Vo)(n.x1,n.cpx1,n.cpx2,n.x2,e),(t?dX:Vo)(n.y1,n.cpy1,n.cpy2,n.y2,e)]:[(t?pX:Vl)(n.x1,n.cpx1,n.x2,e),(t?pX:Vl)(n.y1,n.cpy1,n.y2,e)]}var Pse=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new pIe},e.prototype.buildPath=function(t,r){var i=r.x1,s=r.y1,o=r.x2,l=r.y2,a=r.cpx1,h=r.cpy1,f=r.cpx2,p=r.cpy2,v=r.percent;v!==0&&(t.moveTo(i,s),f==null||p==null?(v<1&&(zP(i,a,o,v,Jc),a=Jc[1],o=Jc[2],zP(s,h,l,v,Jc),h=Jc[1],l=Jc[2]),t.quadraticCurveTo(a,h,o,l)):(v<1&&(_0(i,a,f,o,v,Jc),a=Jc[1],f=Jc[2],o=Jc[3],_0(s,h,p,l,v,Jc),h=Jc[1],p=Jc[2],l=Jc[3]),t.bezierCurveTo(a,h,f,p,o,l)))},e.prototype.pointAt=function(t){return hq(this.shape,t,!1)},e.prototype.tangentAt=function(t){var r=hq(this.shape,t,!0);return JMe(r,r)},e}(qi);Pse.prototype.type="bezier-curve";const Lse=Pse;var mIe=function(){function n(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),tB=function(n){Hn(e,n);function e(t){return n.call(this,t)||this}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new mIe},e.prototype.buildPath=function(t,r){var i=r.cx,s=r.cy,o=Math.max(r.r,0),l=r.startAngle,a=r.endAngle,h=r.clockwise,f=Math.cos(l),p=Math.sin(l);t.moveTo(f*o+i,p*o+s),t.arc(i,s,o,l,a,!h)},e}(qi);tB.prototype.type="arc";var gIe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="compound",t}return e.prototype._updatePathDirty=function(){for(var t=this.shape.paths,r=this.shapeChanged(),i=0;i<t.length;i++)r=r||t[i].shapeChanged();r&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var t=this.shape.paths||[],r=this.getGlobalScale(),i=0;i<t.length;i++)t[i].path||t[i].createPathProxy(),t[i].path.setScale(r[0],r[1],t[i].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,r){for(var i=r.paths||[],s=0;s<i.length;s++)i[s].buildPath(t,i[s].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],r=0;r<t.length;r++)t[r].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),qi.prototype.getBoundingRect.call(this)},e}(qi);const vIe=gIe;var Dse=function(){function n(e){this.colorStops=e||[]}return n.prototype.addColorStop=function(e,t){this.colorStops.push({offset:e,color:t})},n}(),_Ie=function(n){Hn(e,n);function e(t,r,i,s,o,l){var a=n.call(this,o)||this;return a.x=t??0,a.y=r??0,a.x2=i??1,a.y2=s??0,a.type="linear",a.global=l||!1,a}return e}(Dse);const Bse=_Ie;var yIe=function(n){Hn(e,n);function e(t,r,i,s,o){var l=n.call(this,s)||this;return l.x=t??.5,l.y=r??.5,l.r=i??.5,l.type="radial",l.global=o||!1,l}return e}(Dse);const xIe=yIe;var Y_=[0,0],K_=[0,0],J2=new Jr,Q2=new Jr,bIe=function(){function n(e,t){this._corners=[],this._axes=[],this._origin=[0,0];for(var r=0;r<4;r++)this._corners[r]=new Jr;for(var r=0;r<2;r++)this._axes[r]=new Jr;e&&this.fromBoundingRect(e,t)}return n.prototype.fromBoundingRect=function(e,t){var r=this._corners,i=this._axes,s=e.x,o=e.y,l=s+e.width,a=o+e.height;if(r[0].set(s,o),r[1].set(l,o),r[2].set(l,a),r[3].set(s,a),t)for(var h=0;h<4;h++)r[h].transform(t);Jr.sub(i[0],r[1],r[0]),Jr.sub(i[1],r[3],r[0]),i[0].normalize(),i[1].normalize();for(var h=0;h<2;h++)this._origin[h]=i[h].dot(r[0])},n.prototype.intersect=function(e,t){var r=!0,i=!t;return J2.set(1/0,1/0),Q2.set(0,0),!this._intersectCheckOneSide(this,e,J2,Q2,i,1)&&(r=!1,i)||!this._intersectCheckOneSide(e,this,J2,Q2,i,-1)&&(r=!1,i)||i||Jr.copy(t,r?J2:Q2),r},n.prototype._intersectCheckOneSide=function(e,t,r,i,s,o){for(var l=!0,a=0;a<2;a++){var h=this._axes[a];if(this._getProjMinMaxOnAxis(a,e._corners,Y_),this._getProjMinMaxOnAxis(a,t._corners,K_),Y_[1]<K_[0]||Y_[0]>K_[1]){if(l=!1,s)return l;var f=Math.abs(K_[0]-Y_[1]),p=Math.abs(Y_[0]-K_[1]);Math.min(f,p)>i.len()&&(f<p?Jr.scale(i,h,-f*o):Jr.scale(i,h,p*o))}else if(r){var f=Math.abs(K_[0]-Y_[1]),p=Math.abs(Y_[0]-K_[1]);Math.min(f,p)<r.len()&&(f<p?Jr.scale(r,h,f*o):Jr.scale(r,h,-p*o))}}return l},n.prototype._getProjMinMaxOnAxis=function(e,t,r){for(var i=this._axes[e],s=this._origin,o=t[0].dot(i)+s[e],l=o,a=o,h=1;h<t.length;h++){var f=t[h].dot(i)+s[e];l=Math.min(f,l),a=Math.max(f,a)}r[0]=l,r[1]=a},n}();const XP=bIe;var wIe=[],SIe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.notClear=!0,t.incremental=!0,t._displayables=[],t._temporaryDisplayables=[],t._cursor=0,t}return e.prototype.traverse=function(t,r){t.call(r,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(t,r){r?this._temporaryDisplayables.push(t):this._displayables.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,r){r=r||!1;for(var i=0;i<t.length;i++)this.addDisplayable(t[i],r)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(t){for(var r=this._cursor;r<this._displayables.length;r++)t&&t(this._displayables[r]);for(var r=0;r<this._temporaryDisplayables.length;r++)t&&t(this._temporaryDisplayables[r])},e.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){var r=this._displayables[t];r.parent=this,r.update(),r.parent=null}for(var t=0;t<this._temporaryDisplayables.length;t++){var r=this._temporaryDisplayables[t];r.parent=this,r.update(),r.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new cs(1/0,1/0,-1/0,-1/0),r=0;r<this._displayables.length;r++){var i=this._displayables[r],s=i.getBoundingRect().clone();i.needLocalTransform()&&s.applyTransform(i.getLocalTransform(wIe)),t.union(s)}this._rect=t}return this._rect},e.prototype.contain=function(t,r){var i=this.transformCoordToLocal(t,r),s=this.getBoundingRect();if(s.contain(i[0],i[1]))for(var o=0;o<this._displayables.length;o++){var l=this._displayables[o];if(l.contain(t,r))return!0}return!1},e}(Dw);const AIe=SIe;var kse=qs();function nB(n,e,t,r,i){var s;if(e&&e.ecModel){var o=e.ecModel.getUpdatePayload();s=o&&o.animation}var l=e&&e.isAnimationEnabled(),a=n==="update";if(l){var h=void 0,f=void 0,p=void 0;r?(h=Ii(r.duration,200),f=Ii(r.easing,"cubicOut"),p=0):(h=e.getShallow(a?"animationDurationUpdate":"animationDuration"),f=e.getShallow(a?"animationEasingUpdate":"animationEasing"),p=e.getShallow(a?"animationDelayUpdate":"animationDelay")),s&&(s.duration!=null&&(h=s.duration),s.easing!=null&&(f=s.easing),s.delay!=null&&(p=s.delay)),ci(p)&&(p=p(t,i)),ci(h)&&(h=h(t));var v={duration:h||0,delay:p,easing:f};return v}else return null}function oG(n,e,t,r,i,s,o){var l=!1,a;ci(i)?(o=s,s=i,i=null):$r(i)&&(s=i.cb,o=i.during,l=i.isFrom,a=i.removeOpt,i=i.dataIndex);var h=n==="leave";h||e.stopAnimation("leave");var f=nB(n,r,i,h?a||{}:null,r&&r.getAnimationDelayParams?r.getAnimationDelayParams(e,i):null);if(f&&f.duration>0){var p=f.duration,v=f.delay,y=f.easing,S={duration:p,delay:v||0,easing:y,done:s,force:!!s||!!o,setToFinal:!h,scope:n,during:o};l?e.animateFrom(t,S):e.animateTo(t,S)}else e.stopAnimation(),!l&&e.attr(t),o&&o(1),s&&s()}function ol(n,e,t,r,i,s){oG("update",n,e,t,r,i,s)}function Yl(n,e,t,r,i,s){oG("enter",n,e,t,r,i,s)}function Vb(n){if(!n.__zr)return!0;for(var e=0;e<n.animators.length;e++){var t=n.animators[e];if(t.scope==="leave")return!0}return!1}function qP(n,e,t,r,i,s){Vb(n)||oG("leave",n,e,t,r,i,s)}function fq(n,e,t,r){n.removeTextContent(),n.removeTextGuideLine(),qP(n,{style:{opacity:0}},e,t,r)}function ZP(n,e,t){function r(){n.parent&&n.parent.remove(n)}n.isGroup?n.traverse(function(i){i.isGroup||fq(i,e,t,r)}):fq(n,e,t,r)}function lG(n){kse(n).oldStyle=n.style}function TIe(n){return kse(n).oldStyle}var YP=Math.max,KP=Math.min,kz={};function MIe(n){return qi.extend(n)}var EIe=Q2e;function CIe(n,e){return EIe(n,e)}function cd(n,e){kz[n]=e}function IIe(n){if(kz.hasOwnProperty(n))return kz[n]}function cG(n,e,t,r){var i=J2e(n,e);return t&&(r==="center"&&(t=Fse(t,i.getBoundingRect())),Nse(i,t)),i}function Ose(n,e,t){var r=new z0({style:{image:n,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(i){if(t==="center"){var s={width:i.width,height:i.height};r.setStyle(Fse(e,s))}}});return r}function Fse(n,e){var t=e.width/e.height,r=n.height*t,i;r<=n.width?i=n.height:(r=n.width,i=r/t);var s=n.x+n.width/2,o=n.y+n.height/2;return{x:s-r/2,y:o-i/2,width:r,height:i}}var Im=eIe;function Nse(n,e){if(n.applyTransform){var t=n.getBoundingRect(),r=t.calculateTransform(e);n.applyTransform(r)}}function _M(n,e){return ose(n,n,{lineWidth:e}),n}function RIe(n){return lse(n.shape,n.shape,n.style),n}var PIe=Cy;function uG(n,e){for(var t=q6([]);n&&n!==e;)Ub(t,n.getLocalTransform(),t),n=n.parent;return t}function rB(n,e,t){return e&&!Pc(e)&&(e=mE.getLocalTransform(e)),t&&(e=jD([],e)),Rh([],n,e)}function zse(n,e,t){var r=e[4]===0||e[5]===0||e[0]===0?1:Math.abs(2*e[4]/e[0]),i=e[4]===0||e[5]===0||e[2]===0?1:Math.abs(2*e[4]/e[2]),s=[n==="left"?-r:n==="right"?r:0,n==="top"?-i:n==="bottom"?i:0];return s=rB(s,e,t),Math.abs(s[0])>Math.abs(s[1])?s[0]>0?"right":"left":s[1]>0?"bottom":"top"}function dq(n){return!n.isGroup}function LIe(n){return n.shape!=null}function hG(n,e,t){if(!n||!e)return;function r(o){var l={};return o.traverse(function(a){dq(a)&&a.anid&&(l[a.anid]=a)}),l}function i(o){var l={x:o.x,y:o.y,rotation:o.rotation};return LIe(o)&&(l.shape=Jn({},o.shape)),l}var s=r(n);e.traverse(function(o){if(dq(o)&&o.anid){var l=s[o.anid];if(l){var a=i(o);o.attr(i(l)),ol(o,a,t,$i(o).dataIndex)}}})}function Use(n,e){return xr(n,function(t){var r=t[0];r=YP(r,e.x),r=KP(r,e.x+e.width);var i=t[1];return i=YP(i,e.y),i=KP(i,e.y+e.height),[r,i]})}function DIe(n,e){var t=YP(n.x,e.x),r=KP(n.x+n.width,e.x+e.width),i=YP(n.y,e.y),s=KP(n.y+n.height,e.y+e.height);if(r>=t&&s>=i)return{x:t,y:i,width:r-t,height:s-i}}function iB(n,e,t){var r=Jn({rectHover:!0},e),i=r.style={strokeNoScale:!0};if(t=t||{x:-1,y:-1,width:2,height:2},n)return n.indexOf("image://")===0?(i.image=n.slice(8),ti(i,t),new z0(r)):cG(n.replace("path://",""),r,t,"center")}function BIe(n,e,t,r,i){for(var s=0,o=i[i.length-1];s<i.length;s++){var l=i[s];if(Gse(n,e,t,r,l[0],l[1],o[0],o[1]))return!0;o=l}}function Gse(n,e,t,r,i,s,o,l){var a=t-n,h=r-e,f=o-i,p=l-s,v=h3(f,p,a,h);if(kIe(v))return!1;var y=n-i,S=e-s,C=h3(y,S,a,h)/v;if(C<0||C>1)return!1;var M=h3(y,S,f,p)/v;return!(M<0||M>1)}function h3(n,e,t,r){return n*r-t*e}function kIe(n){return n<=1e-6&&n>=-1e-6}function sB(n){var e=n.itemTooltipOption,t=n.componentModel,r=n.itemName,i=Dr(e)?{formatter:e}:e,s=t.mainType,o=t.componentIndex,l={componentType:s,name:r,$vars:["name"]};l[s+"Index"]=o;var a=n.formatterParamsExtra;a&&it(aa(a),function(f){Qm(l,f)||(l[f]=a[f],l.$vars.push(f))});var h=$i(n.el);h.componentMainType=s,h.componentIndex=o,h.tooltipConfig={name:r,option:ti({content:r,encodeHTMLContent:!0,formatterParams:l},i)}}function pq(n,e){var t;n.isGroup&&(t=e(n)),t||n.traverse(e)}function aB(n,e){if(n)if(fr(n))for(var t=0;t<n.length;t++)pq(n[t],e);else pq(n,e)}cd("circle",QD);cd("ellipse",Tse);cd("sector",Nh);cd("ring",aG);cd("polygon",eB);cd("polyline",Bw);cd("rect",Ha);cd("line",Hf);cd("bezierCurve",Lse);cd("arc",tB);const fG=Object.freeze(Object.defineProperty({__proto__:null,Arc:tB,BezierCurve:Lse,BoundingRect:cs,Circle:QD,CompoundPath:vIe,Ellipse:Tse,Group:go,Image:z0,IncrementalDisplayable:AIe,Line:Hf,LinearGradient:Bse,OrientedBoundingRect:XP,Path:qi,Point:Jr,Polygon:eB,Polyline:Bw,RadialGradient:xIe,Rect:Ha,Ring:aG,Sector:Nh,Text:Io,applyTransform:rB,clipPointsByRect:Use,clipRectByRect:DIe,createIcon:iB,extendPath:CIe,extendShape:MIe,getShapeClass:IIe,getTransform:uG,groupTransition:hG,initProps:Yl,isElementRemoved:Vb,lineLineIntersect:Gse,linePolygonIntersect:BIe,makeImage:Ose,makePath:cG,mergePath:Im,registerShape:cd,removeElement:qP,removeElementWithFadeOut:ZP,resizePath:Nse,setTooltipConfig:sB,subPixelOptimize:PIe,subPixelOptimizeLine:_M,subPixelOptimizeRect:RIe,transformDirection:zse,traverseElements:aB,updateProps:ol},Symbol.toStringTag,{value:"Module"}));var oB={};function Vse(n,e){for(var t=0;t<Fh.length;t++){var r=Fh[t],i=e[r],s=n.ensureState(r);s.style=s.style||{},s.style.text=i}var o=n.currentStates.slice();n.clearStates(!0),n.setStyle({text:e.normal}),n.useStates(o,!0)}function Oz(n,e,t){var r=n.labelFetcher,i=n.labelDataIndex,s=n.labelDimIndex,o=e.normal,l;r&&(l=r.getFormattedLabel(i,"normal",null,s,o&&o.get("formatter"),t!=null?{interpolatedValue:t}:null)),l==null&&(l=ci(n.defaultText)?n.defaultText(i,n,t):n.defaultText);for(var a={normal:l},h=0;h<Fh.length;h++){var f=Fh[h],p=e[f];a[f]=Ii(r?r.getFormattedLabel(i,f,null,s,p&&p.get("formatter")):null,l)}return a}function yE(n,e,t,r){t=t||oB;for(var i=n instanceof Io,s=!1,o=0;o<WP.length;o++){var l=e[WP[o]];if(l&&l.getShallow("show")){s=!0;break}}var a=i?n:n.getTextContent();if(s){i||(a||(a=new Io,n.setTextContent(a)),n.stateProxy&&(a.stateProxy=n.stateProxy));var h=Oz(t,e),f=e.normal,p=!!f.getShallow("show"),v=ng(f,r&&r.normal,t,!1,!i);v.text=h.normal,i||n.setTextConfig(mq(f,t,!1));for(var o=0;o<Fh.length;o++){var y=Fh[o],l=e[y];if(l){var S=a.ensureState(y),C=!!Ii(l.getShallow("show"),p);if(C!==p&&(S.ignore=!C),S.style=ng(l,r&&r[y],t,!0,!i),S.style.text=h[y],!i){var M=n.ensureState(y);M.textConfig=mq(l,t,!0)}}}a.silent=!!f.getShallow("silent"),a.style.x!=null&&(v.x=a.style.x),a.style.y!=null&&(v.y=a.style.y),a.ignore=!p,a.useStyle(v),a.dirty(),t.enableTextSetter&&(kw(a).setLabelText=function(E){var L=Oz(t,e,E);Vse(a,L)})}else a&&(a.ignore=!0);n.dirty()}function xE(n,e){e=e||"label";for(var t={normal:n.getModel(e)},r=0;r<Fh.length;r++){var i=Fh[r];t[i]=n.getModel([i,e])}return t}function ng(n,e,t,r,i){var s={};return OIe(s,n,t,r,i),e&&Jn(s,e),s}function mq(n,e,t){e=e||{};var r={},i,s=n.getShallow("rotate"),o=Ii(n.getShallow("distance"),t?null:5),l=n.getShallow("offset");return i=n.getShallow("position")||(t?null:"inside"),i==="outside"&&(i=e.defaultOutsidePosition||"top"),i!=null&&(r.position=i),l!=null&&(r.offset=l),s!=null&&(s*=Math.PI/180,r.rotation=s),o!=null&&(r.distance=o),r.outsideFill=n.get("color")==="inherit"?e.inheritColor||null:"auto",r}function OIe(n,e,t,r,i){t=t||oB;var s=e.ecModel,o=s&&s.option.textStyle,l=FIe(e),a;if(l){a={};for(var h in l)if(l.hasOwnProperty(h)){var f=e.getModel(["rich",h]);yq(a[h]={},f,o,t,r,i,!1,!0)}}a&&(n.rich=a);var p=e.get("overflow");p&&(n.overflow=p);var v=e.get("minMargin");v!=null&&(n.margin=v),yq(n,e,o,t,r,i,!0,!1)}function FIe(n){for(var e;n&&n!==n.ecModel;){var t=(n.option||oB).rich;if(t){e=e||{};for(var r=aa(t),i=0;i<r.length;i++){var s=r[i];e[s]=1}}n=n.parentModel}return e}var gq=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],vq=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],_q=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function yq(n,e,t,r,i,s,o,l){t=!i&&t||oB;var a=r&&r.inheritColor,h=e.getShallow("color"),f=e.getShallow("textBorderColor"),p=Ii(e.getShallow("opacity"),t.opacity);(h==="inherit"||h==="auto")&&(a?h=a:h=null),(f==="inherit"||f==="auto")&&(a?f=a:f=null),s||(h=h||t.color,f=f||t.textBorderColor),h!=null&&(n.fill=h),f!=null&&(n.stroke=f);var v=Ii(e.getShallow("textBorderWidth"),t.textBorderWidth);v!=null&&(n.lineWidth=v);var y=Ii(e.getShallow("textBorderType"),t.textBorderType);y!=null&&(n.lineDash=y);var S=Ii(e.getShallow("textBorderDashOffset"),t.textBorderDashOffset);S!=null&&(n.lineDashOffset=S),!i&&p==null&&!l&&(p=r&&r.defaultOpacity),p!=null&&(n.opacity=p),!i&&!s&&n.fill==null&&r.inheritColor&&(n.fill=r.inheritColor);for(var C=0;C<gq.length;C++){var M=gq[C],E=Ii(e.getShallow(M),t[M]);E!=null&&(n[M]=E)}for(var C=0;C<vq.length;C++){var M=vq[C],E=e.getShallow(M);E!=null&&(n[M]=E)}if(n.verticalAlign==null){var L=e.getShallow("baseline");L!=null&&(n.verticalAlign=L)}if(!o||!r.disableBox){for(var C=0;C<_q.length;C++){var M=_q[C],E=e.getShallow(M);E!=null&&(n[M]=E)}var k=e.getShallow("borderType");k!=null&&(n.borderDash=k),(n.backgroundColor==="auto"||n.backgroundColor==="inherit")&&a&&(n.backgroundColor=a),(n.borderColor==="auto"||n.borderColor==="inherit")&&a&&(n.borderColor=a)}}function Hse(n,e){var t=e&&e.getModel("textStyle");return rp([n.fontStyle||t&&t.getShallow("fontStyle")||"",n.fontWeight||t&&t.getShallow("fontWeight")||"",(n.fontSize||t&&t.getShallow("fontSize")||12)+"px",n.fontFamily||t&&t.getShallow("fontFamily")||"sans-serif"].join(" "))}var kw=qs();function NIe(n,e,t,r){if(n){var i=kw(n);i.prevValue=i.value,i.value=t;var s=e.normal;i.valueAnimation=s.get("valueAnimation"),i.valueAnimation&&(i.precision=s.get("precision"),i.defaultInterpolatedText=r,i.statesModels=e)}}function zIe(n,e,t,r,i){var s=kw(n);if(!s.valueAnimation||s.prevValue===s.value)return;var o=s.defaultInterpolatedText,l=Ii(s.interpolatedValue,s.prevValue),a=s.value;function h(f){var p=Yie(t,s.precision,l,a,f);s.interpolatedValue=f===1?null:p;var v=Oz({labelDataIndex:e,labelFetcher:i,defaultText:o?o(p):p+""},s.statesModels,p);Vse(n,v)}n.percent=0,(s.prevValue==null?Yl:ol)(n,{percent:1},r,e,null,h)}var UIe=["textStyle","color"],f3=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],d3=new Io,GIe=function(){function n(){}return n.prototype.getTextColor=function(e){var t=this.ecModel;return this.getShallow("color")||(!e&&t?t.get(UIe):null)},n.prototype.getFont=function(){return Hse({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},n.prototype.getTextRect=function(e){for(var t={text:e,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},r=0;r<f3.length;r++)t[f3[r]]=this.getShallow(f3[r]);return d3.useStyle(t),d3.update(),d3.getBoundingRect()},n}(),jse=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],VIe=gM(jse),HIe=function(){function n(){}return n.prototype.getLineStyle=function(e){return VIe(this,e)},n}(),Wse=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],jIe=gM(Wse),WIe=function(){function n(){}return n.prototype.getItemStyle=function(e,t){return jIe(this,e,t)},n}(),Ra=function(){function n(e,t,r){this.parentModel=t,this.ecModel=r,this.option=e}return n.prototype.init=function(e,t,r){},n.prototype.mergeOption=function(e,t){Bi(this.option,e,!0)},n.prototype.get=function(e,t){return e==null?this.option:this._doGet(this.parsePath(e),!t&&this.parentModel)},n.prototype.getShallow=function(e,t){var r=this.option,i=r==null?r:r[e];if(i==null&&!t){var s=this.parentModel;s&&(i=s.getShallow(e))}return i},n.prototype.getModel=function(e,t){var r=e!=null,i=r?this.parsePath(e):null,s=r?this._doGet(i):this.option;return t=t||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new n(s,t,this.ecModel)},n.prototype.isEmpty=function(){return this.option==null},n.prototype.restoreData=function(){},n.prototype.clone=function(){var e=this.constructor;return new e(yi(this.option))},n.prototype.parsePath=function(e){return typeof e=="string"?e.split("."):e},n.prototype.resolveParentPath=function(e){return e},n.prototype.isAnimationEnabled=function(){if(!gi.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},n.prototype._doGet=function(e,t){var r=this.option;if(!e)return r;for(var i=0;i<e.length&&!(e[i]&&(r=r&&typeof r=="object"?r[e[i]]:null,r==null));i++);return r==null&&t&&(r=t._doGet(this.resolveParentPath(e),t.parentModel)),r},n}();eG(Ra);DCe(Ra);od(Ra,HIe);od(Ra,WIe);od(Ra,NCe);od(Ra,GIe);var $Ie=Math.round(Math.random()*10);function bE(n){return[n||"",$Ie++].join("_")}function XIe(n){var e={};n.registerSubTypeDefaulter=function(t,r){var i=ip(t);e[i.main]=r},n.determineSubType=function(t,r){var i=r.type;if(!i){var s=ip(t).main;n.hasSubTypes(t)&&e[s]&&(i=e[s](r))}return i}}function qIe(n,e){n.topologicalTravel=function(s,o,l,a){if(!s.length)return;var h=t(o),f=h.graph,p=h.noEntryList,v={};for(it(s,function(L){v[L]=!0});p.length;){var y=p.pop(),S=f[y],C=!!v[y];C&&(l.call(a,y,S.originalDeps.slice()),delete v[y]),it(S.successor,C?E:M)}it(v,function(){var L="";throw new Error(L)});function M(L){f[L].entryCount--,f[L].entryCount===0&&p.push(L)}function E(L){v[L]=!0,M(L)}};function t(s){var o={},l=[];return it(s,function(a){var h=r(o,a),f=h.originalDeps=e(a),p=i(f,s);h.entryCount=p.length,h.entryCount===0&&l.push(a),it(p,function(v){Xi(h.predecessor,v)<0&&h.predecessor.push(v);var y=r(o,v);Xi(y.successor,v)<0&&y.successor.push(a)})}),{graph:o,noEntryList:l}}function r(s,o){return s[o]||(s[o]={predecessor:[],successor:[]}),s[o]}function i(s,o){var l=[];return it(s,function(a){Xi(o,a)>=0&&l.push(a)}),l}}function $se(n,e){return Bi(Bi({},n,!0),e,!0)}const ZIe={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},YIe={time:{month:["","","","","","","","","","","",""],monthAbbr:["1","2","3","4","5","6","7","8","9","10","11","12"],dayOfWeek:["","","","","","",""],dayOfWeekAbbr:["","","","","","",""]},legend:{selector:{all:"",inverse:""}},toolbox:{brush:{title:{rect:"",polygon:"",lineX:"",lineY:"",keep:"",clear:""}},dataView:{title:"",lang:["","",""]},dataZoom:{title:{zoom:"",back:""}},magicType:{title:{line:"",bar:"",stack:"",tiled:""}},restore:{title:""},saveAsImage:{title:"",lang:[""]}},series:{typeNames:{pie:"",bar:"",line:"",scatter:"",effectScatter:"",radar:"",tree:"",treemap:"",boxplot:"",candlestick:"K",k:"K",heatmap:"",map:"",parallel:"",lines:"",graph:"",sankey:"",funnel:"",gauge:"",pictorialBar:"",themeRiver:"",sunburst:"",custom:"",chart:""}},aria:{general:{withTitle:"{title}",withoutTitle:""},series:{single:{prefix:"",withName:"{seriesType}{seriesName}",withoutName:"{seriesType}"},multiple:{prefix:"{seriesCount}",withName:"{seriesId}{seriesName}{seriesType}",withoutName:"{seriesId}{seriesType}",separator:{middle:"",end:""}}},data:{allData:"",partialData:"{displayCnt}",withName:"{name}{value}",withoutName:"{value}",separator:{middle:"",end:""}}}};var JP="ZH",dG="EN",Hb=dG,dR={},pG={},Xse=gi.domSupported?function(){var n=(document.documentElement.lang||navigator.language||navigator.browserLanguage||Hb).toUpperCase();return n.indexOf(JP)>-1?JP:Hb}():Hb;function qse(n,e){n=n.toUpperCase(),pG[n]=new Ra(e),dR[n]=e}function KIe(n){if(Dr(n)){var e=dR[n.toUpperCase()]||{};return n===JP||n===dG?yi(e):Bi(yi(e),yi(dR[Hb]),!1)}else return Bi(yi(n),yi(dR[Hb]),!1)}function JIe(n){return pG[n]}function QIe(){return pG[Hb]}qse(dG,ZIe);qse(JP,YIe);var mG=1e3,gG=mG*60,yT=gG*60,Ah=yT*24,xq=Ah*365,OA={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},eI="{yyyy}-{MM}-{dd}",bq={year:"{yyyy}",month:"{yyyy}-{MM}",day:eI,hour:eI+" "+OA.hour,minute:eI+" "+OA.minute,second:eI+" "+OA.second,millisecond:OA.none},p3=["year","month","day","hour","minute","second","millisecond"],Zse=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function bv(n,e){return n+="","0000".substr(0,e-n.length)+n}function jb(n){switch(n){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return n}}function eRe(n){return n===jb(n)}function tRe(n){switch(n){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function lB(n,e,t,r){var i=eg(n),s=i[vG(t)](),o=i[Wb(t)]()+1,l=Math.floor((o-1)/3)+1,a=i[cB(t)](),h=i["get"+(t?"UTC":"")+"Day"](),f=i[yM(t)](),p=(f-1)%12+1,v=i[uB(t)](),y=i[hB(t)](),S=i[fB(t)](),C=f>=12?"pm":"am",M=C.toUpperCase(),E=r instanceof Ra?r:JIe(r||Xse)||QIe(),L=E.getModel("time"),k=L.get("month"),H=L.get("monthAbbr"),X=L.get("dayOfWeek"),Z=L.get("dayOfWeekAbbr");return(e||"").replace(/{a}/g,C+"").replace(/{A}/g,M+"").replace(/{yyyy}/g,s+"").replace(/{yy}/g,bv(s%100+"",2)).replace(/{Q}/g,l+"").replace(/{MMMM}/g,k[o-1]).replace(/{MMM}/g,H[o-1]).replace(/{MM}/g,bv(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,bv(a,2)).replace(/{d}/g,a+"").replace(/{eeee}/g,X[h]).replace(/{ee}/g,Z[h]).replace(/{e}/g,h+"").replace(/{HH}/g,bv(f,2)).replace(/{H}/g,f+"").replace(/{hh}/g,bv(p+"",2)).replace(/{h}/g,p+"").replace(/{mm}/g,bv(v,2)).replace(/{m}/g,v+"").replace(/{ss}/g,bv(y,2)).replace(/{s}/g,y+"").replace(/{SSS}/g,bv(S,3)).replace(/{S}/g,S+"")}function nRe(n,e,t,r,i){var s=null;if(Dr(t))s=t;else if(ci(t))s=t(n.value,e,{level:n.level});else{var o=Jn({},OA);if(n.level>0)for(var l=0;l<p3.length;++l)o[p3[l]]="{primary|"+o[p3[l]]+"}";var a=t?t.inherit===!1?t:ti(t,o):o,h=Yse(n.value,i);if(a[h])s=a[h];else if(a.inherit){for(var f=Zse.indexOf(h),l=f-1;l>=0;--l)if(a[h]){s=a[h];break}s=s||o.none}if(fr(s)){var p=n.level==null?0:n.level>=0?n.level:s.length+n.level;p=Math.min(p,s.length-1),s=s[p]}}return lB(new Date(n.value),s,i,r)}function Yse(n,e){var t=eg(n),r=t[Wb(e)]()+1,i=t[cB(e)](),s=t[yM(e)](),o=t[uB(e)](),l=t[hB(e)](),a=t[fB(e)](),h=a===0,f=h&&l===0,p=f&&o===0,v=p&&s===0,y=v&&i===1,S=y&&r===1;return S?"year":y?"month":v?"day":p?"hour":f?"minute":h?"second":"millisecond"}function wq(n,e,t){var r=Ps(n)?eg(n):n;switch(e=e||Yse(n,t),e){case"year":return r[vG(t)]();case"half-year":return r[Wb(t)]()>=6?1:0;case"quarter":return Math.floor((r[Wb(t)]()+1)/4);case"month":return r[Wb(t)]();case"day":return r[cB(t)]();case"half-day":return r[yM(t)]()/24;case"hour":return r[yM(t)]();case"minute":return r[uB(t)]();case"second":return r[hB(t)]();case"millisecond":return r[fB(t)]()}}function vG(n){return n?"getUTCFullYear":"getFullYear"}function Wb(n){return n?"getUTCMonth":"getMonth"}function cB(n){return n?"getUTCDate":"getDate"}function yM(n){return n?"getUTCHours":"getHours"}function uB(n){return n?"getUTCMinutes":"getMinutes"}function hB(n){return n?"getUTCSeconds":"getSeconds"}function fB(n){return n?"getUTCMilliseconds":"getMilliseconds"}function rRe(n){return n?"setUTCFullYear":"setFullYear"}function Kse(n){return n?"setUTCMonth":"setMonth"}function Jse(n){return n?"setUTCDate":"setDate"}function Qse(n){return n?"setUTCHours":"setHours"}function eae(n){return n?"setUTCMinutes":"setMinutes"}function tae(n){return n?"setUTCSeconds":"setSeconds"}function nae(n){return n?"setUTCMilliseconds":"setMilliseconds"}function rae(n){if(!fCe(n))return Dr(n)?n:"-";var e=(n+"").split(".");return e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:"")}function iae(n,e){return n=(n||"").toLowerCase().replace(/-(.)/g,function(t,r){return r.toUpperCase()}),e&&n&&(n=n.charAt(0).toUpperCase()+n.slice(1)),n}var dB=gie;function Fz(n,e,t){var r="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(f){return f&&rp(f)?f:"-"}function s(f){return!!(f!=null&&!isNaN(f)&&isFinite(f))}var o=e==="time",l=n instanceof Date;if(o||l){var a=o?eg(n):n;if(isNaN(+a)){if(l)return"-"}else return lB(a,r,t)}if(e==="ordinal")return lz(n)?i(n):Ps(n)&&s(n)?n+"":"-";var h=x0(n);return s(h)?rae(h):lz(n)?i(n):typeof n=="boolean"?n+"":"-"}var Sq=["a","b","c","d","e","f","g"],m3=function(n,e){return"{"+n+(e??"")+"}"};function sae(n,e,t){fr(e)||(e=[e]);var r=e.length;if(!r)return"";for(var i=e[0].$vars||[],s=0;s<i.length;s++){var o=Sq[s];n=n.replace(m3(o),m3(o,0))}for(var l=0;l<r;l++)for(var a=0;a<i.length;a++){var h=e[l][i[a]];n=n.replace(m3(Sq[a],l),t?Du(h):h)}return n}function iRe(n,e){var t=Dr(n)?{color:n,extraCssText:e}:n||{},r=t.color,i=t.type;e=t.extraCssText;var s=t.renderMode||"html";if(!r)return"";if(s==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Du(r)+";"+(e||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Du(r)+";"+(e||"")+'"></span>';var o=t.markerId||"markerX";return{renderMode:s,content:"{"+o+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:r}:{width:10,height:10,borderRadius:5,backgroundColor:r}}}function cx(n,e){return e=e||"transparent",Dr(n)?n:$r(n)&&n.colorStops&&(n.colorStops[0]||{}).color||e}function Aq(n,e){if(e==="_blank"||e==="blank"){var t=window.open();t.opener=null,t.location.href=n}else window.open(n,e)}var pR=it,sRe=["left","right","top","bottom","width","height"],tI=[["width","left","right"],["height","top","bottom"]];function _G(n,e,t,r,i){var s=0,o=0;r==null&&(r=1/0),i==null&&(i=1/0);var l=0;e.eachChild(function(a,h){var f=a.getBoundingRect(),p=e.childAt(h+1),v=p&&p.getBoundingRect(),y,S;if(n==="horizontal"){var C=f.width+(v?-v.x+f.x:0);y=s+C,y>r||a.newline?(s=0,y=C,o+=l+t,l=f.height):l=Math.max(l,f.height)}else{var M=f.height+(v?-v.y+f.y:0);S=o+M,S>i||a.newline?(s+=l+t,o=0,S=M,l=f.width):l=Math.max(l,f.width)}a.newline||(a.x=s,a.y=o,a.markRedraw(),n==="horizontal"?s=y+t:o=S+t)})}var $b=_G;_s(_G,"vertical");_s(_G,"horizontal");function b0(n,e,t){t=dB(t||0);var r=e.width,i=e.height,s=ls(n.left,r),o=ls(n.top,i),l=ls(n.right,r),a=ls(n.bottom,i),h=ls(n.width,r),f=ls(n.height,i),p=t[2]+t[0],v=t[1]+t[3],y=n.aspect;switch(isNaN(h)&&(h=r-l-v-s),isNaN(f)&&(f=i-a-p-o),y!=null&&(isNaN(h)&&isNaN(f)&&(y>r/i?h=r*.8:f=i*.8),isNaN(h)&&(h=y*f),isNaN(f)&&(f=h/y)),isNaN(s)&&(s=r-l-h-v),isNaN(o)&&(o=i-a-f-p),n.left||n.right){case"center":s=r/2-h/2-t[3];break;case"right":s=r-h-v;break}switch(n.top||n.bottom){case"middle":case"center":o=i/2-f/2-t[0];break;case"bottom":o=i-f-p;break}s=s||0,o=o||0,isNaN(h)&&(h=r-v-s-(l||0)),isNaN(f)&&(f=i-p-o-(a||0));var S=new cs(s+t[3],o+t[0],h,f);return S.margin=t,S}function aRe(n,e,t,r,i,s){s=s||n,s.x=n.x,s.y=n.y;var o;if(o=n.getBoundingRect(),n.needLocalTransform()){var l=n.getLocalTransform();o=o.clone(),o.applyTransform(l)}var a=b0(ti({width:o.width,height:o.height},e),t,r),h=a.x-o.x,f=a.y-o.y;return s.x+=h,s.y+=f,s===n&&n.markRedraw(),!0}function xM(n){var e=n.layoutMode||n.constructor.layoutMode;return $r(e)?e:e?{type:e}:null}function hw(n,e,t){var r=t&&t.ignoreSize;!fr(r)&&(r=[r,r]);var i=o(tI[0],0),s=o(tI[1],1);h(tI[0],n,i),h(tI[1],n,s);function o(f,p){var v={},y=0,S={},C=0,M=2;if(pR(f,function(k){S[k]=n[k]}),pR(f,function(k){l(e,k)&&(v[k]=S[k]=e[k]),a(v,k)&&y++,a(S,k)&&C++}),r[p])return a(e,f[1])?S[f[2]]=null:a(e,f[2])&&(S[f[1]]=null),S;if(C===M||!y)return S;if(y>=M)return v;for(var E=0;E<f.length;E++){var L=f[E];if(!l(v,L)&&l(n,L)){v[L]=n[L];break}}return v}function l(f,p){return f.hasOwnProperty(p)}function a(f,p){return f[p]!=null&&f[p]!=="auto"}function h(f,p,v){pR(f,function(y){p[y]=v[y]})}}function pB(n){return oRe({},n)}function oRe(n,e){return e&&n&&pR(sRe,function(t){e.hasOwnProperty(t)&&(n[t]=e[t])}),n}var lRe=qs(),as=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this,t,r,i)||this;return s.uid=bE("ec_cpt_model"),s}return e.prototype.init=function(t,r,i){this.mergeDefaultAndTheme(t,i)},e.prototype.mergeDefaultAndTheme=function(t,r){var i=xM(this),s=i?pB(t):{},o=r.getTheme();Bi(t,o.get(this.mainType)),Bi(t,this.getDefaultOption()),i&&hw(t,s,i)},e.prototype.mergeOption=function(t,r){Bi(this.option,t,!0);var i=xM(this);i&&hw(this.option,t,i)},e.prototype.optionUpdated=function(t,r){},e.prototype.getDefaultOption=function(){var t=this.constructor;if(!RCe(t))return t.defaultOption;var r=lRe(this);if(!r.defaultOption){for(var i=[],s=t;s;){var o=s.prototype.defaultOption;o&&i.push(o),s=s.superClass}for(var l={},a=i.length-1;a>=0;a--)l=Bi(l,i[a],!0);r.defaultOption=l}return r.defaultOption},e.prototype.getReferringComponents=function(t,r){var i=t+"Index",s=t+"Id";return _E(this.ecModel,t,{index:this.get(i,!0),id:this.get(s,!0)},r)},e.prototype.getBoxLayoutParams=function(){var t=this;return{left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")}},e.prototype.getZLevelKey=function(){return""},e.prototype.setZLevel=function(t){this.option.zlevel=t},e.protoInitialize=function(){var t=e.prototype;t.type="component",t.id="",t.name="",t.mainType="",t.subType="",t.componentIndex=0}(),e}(Ra);Jie(as,Ra);XD(as);XIe(as);qIe(as,cRe);function cRe(n){var e=[];return it(as.getClassesByMainType(n),function(t){e=e.concat(t.dependencies||t.prototype.dependencies||[])}),e=xr(e,function(t){return ip(t).main}),n!=="dataset"&&Xi(e,"dataset")<=0&&e.unshift("dataset"),e}var aae="";typeof navigator<"u"&&(aae=navigator.platform||"");var N1="rgba(0, 0, 0, 0.2)";const uRe={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:N1,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:N1,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:N1,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:N1,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:N1,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:N1,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:aae.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var oae=ii(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),zh="original",Lc="arrayRows",Uh="objectRows",wp="keyedColumns",c0="typedArray",lae="unknown",dp="column",Ow="row",yl={Must:1,Might:2,Not:3},cae=qs();function hRe(n){cae(n).datasetMap=ii()}function fRe(n,e,t){var r={},i=yG(e);if(!i||!n)return r;var s=[],o=[],l=e.ecModel,a=cae(l).datasetMap,h=i.uid+"_"+t.seriesLayoutBy,f,p;n=n.slice(),it(n,function(C,M){var E=$r(C)?C:n[M]={name:C};E.type==="ordinal"&&f==null&&(f=M,p=S(E)),r[E.name]=[]});var v=a.get(h)||a.set(h,{categoryWayDim:p,valueWayDim:0});it(n,function(C,M){var E=C.name,L=S(C);if(f==null){var k=v.valueWayDim;y(r[E],k,L),y(o,k,L),v.valueWayDim+=L}else if(f===M)y(r[E],0,L),y(s,0,L);else{var k=v.categoryWayDim;y(r[E],k,L),y(o,k,L),v.categoryWayDim+=L}});function y(C,M,E){for(var L=0;L<E;L++)C.push(M+L)}function S(C){var M=C.dimsDef;return M?M.length:1}return s.length&&(r.itemName=s),o.length&&(r.seriesName=o),r}function dRe(n,e,t){var r={},i=yG(n);if(!i)return r;var s=e.sourceFormat,o=e.dimensionsDefine,l;(s===Uh||s===wp)&&it(o,function(f,p){($r(f)?f.name:f)==="name"&&(l=p)});var a=function(){for(var f={},p={},v=[],y=0,S=Math.min(5,t);y<S;y++){var C=hae(e.data,s,e.seriesLayoutBy,o,e.startIndex,y);v.push(C);var M=C===yl.Not;if(M&&f.v==null&&y!==l&&(f.v=y),(f.n==null||f.n===f.v||!M&&v[f.n]===yl.Not)&&(f.n=y),E(f)&&v[f.n]!==yl.Not)return f;M||(C===yl.Might&&p.v==null&&y!==l&&(p.v=y),(p.n==null||p.n===p.v)&&(p.n=y))}function E(L){return L.v!=null&&L.n!=null}return E(f)?f:E(p)?p:null}();if(a){r.value=[a.v];var h=l??a.n;r.itemName=[h],r.seriesName=[h]}return r}function yG(n){var e=n.get("data",!0);if(!e)return _E(n.ecModel,"dataset",{index:n.get("datasetIndex",!0),id:n.get("datasetId",!0)},bl).models[0]}function pRe(n){return!n.get("transform",!0)&&!n.get("fromTransformResult",!0)?[]:_E(n.ecModel,"dataset",{index:n.get("fromDatasetIndex",!0),id:n.get("fromDatasetId",!0)},bl).models}function uae(n,e){return hae(n.data,n.sourceFormat,n.seriesLayoutBy,n.dimensionsDefine,n.startIndex,e)}function hae(n,e,t,r,i,s){var o,l=5;if(mu(n))return yl.Not;var a,h;if(r){var f=r[s];$r(f)?(a=f.name,h=f.type):Dr(f)&&(a=f)}if(h!=null)return h==="ordinal"?yl.Must:yl.Not;if(e===Lc){var p=n;if(t===Ow){for(var v=p[s],y=0;y<(v||[]).length&&y<l;y++)if((o=H(v[i+y]))!=null)return o}else for(var y=0;y<p.length&&y<l;y++){var S=p[i+y];if(S&&(o=H(S[s]))!=null)return o}}else if(e===Uh){var C=n;if(!a)return yl.Not;for(var y=0;y<C.length&&y<l;y++){var M=C[y];if(M&&(o=H(M[a]))!=null)return o}}else if(e===wp){var E=n;if(!a)return yl.Not;var v=E[a];if(!v||mu(v))return yl.Not;for(var y=0;y<v.length&&y<l;y++)if((o=H(v[y]))!=null)return o}else if(e===zh)for(var L=n,y=0;y<L.length&&y<l;y++){var M=L[y],k=vE(M);if(!fr(k))return yl.Not;if((o=H(k[s]))!=null)return o}function H(X){var Z=Dr(X);if(X!=null&&Number.isFinite(Number(X))&&X!=="")return Z?yl.Might:yl.Not;if(Z&&X!=="-")return yl.Must}return yl.Not}var Nz=ii();function mRe(n,e){vp(Nz.get(n)==null&&e),Nz.set(n,e)}function gRe(n,e,t){var r=Nz.get(e);if(!r)return t;var i=r(n);return i?t.concat(i):t}var Tq=qs();qs();var xG=function(){function n(){}return n.prototype.getColorFromPalette=function(e,t,r){var i=mo(this.get("color",!0)),s=this.get("colorLayer",!0);return _Re(this,Tq,i,s,e,t,r)},n.prototype.clearColorPalette=function(){yRe(this,Tq)},n}();function vRe(n,e){for(var t=n.length,r=0;r<t;r++)if(n[r].length>e)return n[r];return n[t-1]}function _Re(n,e,t,r,i,s,o){s=s||n;var l=e(s),a=l.paletteIdx||0,h=l.paletteNameMap=l.paletteNameMap||{};if(h.hasOwnProperty(i))return h[i];var f=o==null||!r?t:vRe(r,o);if(f=f||t,!(!f||!f.length)){var p=f[a];return i&&(h[i]=p),l.paletteIdx=(a+1)%f.length,p}}function yRe(n,e){e(n).paletteIdx=0,e(n).paletteNameMap={}}var nI,nA,Mq,Eq="\0_ec_inner",xRe=1,bG=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t,r,i,s,o,l){s=s||{},this.option=null,this._theme=new Ra(s),this._locale=new Ra(o),this._optionManager=l},e.prototype.setOption=function(t,r,i){var s=Rq(r);this._optionManager.setOption(t,i,s),this._resetOption(null,s)},e.prototype.resetOption=function(t,r){return this._resetOption(t,Rq(r))},e.prototype._resetOption=function(t,r){var i=!1,s=this._optionManager;if(!t||t==="recreate"){var o=s.mountOption(t==="recreate");!this.option||t==="recreate"?Mq(this,o):(this.restoreData(),this._mergeOption(o,r)),i=!0}if((t==="timeline"||t==="media")&&this.restoreData(),!t||t==="recreate"||t==="timeline"){var l=s.getTimelineOption(this);l&&(i=!0,this._mergeOption(l,r))}if(!t||t==="recreate"||t==="media"){var a=s.getMediaOption(this);a.length&&it(a,function(h){i=!0,this._mergeOption(h,r)},this)}return i},e.prototype.mergeOption=function(t){this._mergeOption(t,null)},e.prototype._mergeOption=function(t,r){var i=this.option,s=this._componentsMap,o=this._componentsCount,l=[],a=ii(),h=r&&r.replaceMergeMainTypeMap;hRe(this),it(t,function(p,v){p!=null&&(as.hasClass(v)?v&&(l.push(v),a.set(v,!0)):i[v]=i[v]==null?yi(p):Bi(i[v],p,!0))}),h&&h.each(function(p,v){as.hasClass(v)&&!a.get(v)&&(l.push(v),a.set(v,!0))}),as.topologicalTravel(l,as.getAllClassMainTypes(),f,this);function f(p){var v=gRe(this,p,mo(t[p])),y=s.get(p),S=y?h&&h.get(p)?"replaceMerge":"normalMerge":"replaceAll",C=pCe(y,v,S);wCe(C,p,as),i[p]=null,s.set(p,null),o.set(p,0);var M=[],E=[],L=0,k;it(C,function(H,X){var Z=H.existing,Q=H.newOption;if(!Q)Z&&(Z.mergeOption({},this),Z.optionUpdated({},!1));else{var re=p==="series",ie=as.getClass(p,H.keyInfo.subType,!re);if(!ie)return;if(p==="tooltip"){if(k)return;k=!0}if(Z&&Z.constructor===ie)Z.name=H.keyInfo.name,Z.mergeOption(Q,this),Z.optionUpdated(Q,!1);else{var oe=Jn({componentIndex:X},H.keyInfo);Z=new ie(Q,this,this,oe),Jn(Z,oe),H.brandNew&&(Z.__requireNewView=!0),Z.init(Q,this,this),Z.optionUpdated(null,!0)}}Z?(M.push(Z.option),E.push(Z),L++):(M.push(void 0),E.push(void 0))},this),i[p]=M,s.set(p,E),o.set(p,L),p==="series"&&nI(this)}this._seriesIndices||nI(this)},e.prototype.getOption=function(){var t=yi(this.option);return it(t,function(r,i){if(as.hasClass(i)){for(var s=mo(r),o=s.length,l=!1,a=o-1;a>=0;a--)s[a]&&!mM(s[a])?l=!0:(s[a]=null,!l&&o--);s.length=o,t[i]=s}}),delete t[Eq],t},e.prototype.getTheme=function(){return this._theme},e.prototype.getLocaleModel=function(){return this._locale},e.prototype.setUpdatePayload=function(t){this._payload=t},e.prototype.getUpdatePayload=function(){return this._payload},e.prototype.getComponent=function(t,r){var i=this._componentsMap.get(t);if(i){var s=i[r||0];if(s)return s;if(r==null){for(var o=0;o<i.length;o++)if(i[o])return i[o]}}},e.prototype.queryComponents=function(t){var r=t.mainType;if(!r)return[];var i=t.index,s=t.id,o=t.name,l=this._componentsMap.get(r);if(!l||!l.length)return[];var a;return i!=null?(a=[],it(mo(i),function(h){l[h]&&a.push(l[h])})):s!=null?a=Cq("id",s,l):o!=null?a=Cq("name",o,l):a=no(l,function(h){return!!h}),Iq(a,t)},e.prototype.findComponents=function(t){var r=t.query,i=t.mainType,s=l(r),o=s?this.queryComponents(s):no(this._componentsMap.get(i),function(h){return!!h});return a(Iq(o,t));function l(h){var f=i+"Index",p=i+"Id",v=i+"Name";return h&&(h[f]!=null||h[p]!=null||h[v]!=null)?{mainType:i,index:h[f],id:h[p],name:h[v]}:null}function a(h){return t.filter?no(h,t.filter):h}},e.prototype.eachComponent=function(t,r,i){var s=this._componentsMap;if(ci(t)){var o=r,l=t;s.each(function(p,v){for(var y=0;p&&y<p.length;y++){var S=p[y];S&&l.call(o,v,S,S.componentIndex)}})}else for(var a=Dr(t)?s.get(t):$r(t)?this.findComponents(t):null,h=0;a&&h<a.length;h++){var f=a[h];f&&r.call(i,f,f.componentIndex)}},e.prototype.getSeriesByName=function(t){var r=fp(t,null);return no(this._componentsMap.get("series"),function(i){return!!i&&r!=null&&i.name===r})},e.prototype.getSeriesByIndex=function(t){return this._componentsMap.get("series")[t]},e.prototype.getSeriesByType=function(t){return no(this._componentsMap.get("series"),function(r){return!!r&&r.subType===t})},e.prototype.getSeries=function(){return no(this._componentsMap.get("series"),function(t){return!!t})},e.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},e.prototype.eachSeries=function(t,r){nA(this),it(this._seriesIndices,function(i){var s=this._componentsMap.get("series")[i];t.call(r,s,i)},this)},e.prototype.eachRawSeries=function(t,r){it(this._componentsMap.get("series"),function(i){i&&t.call(r,i,i.componentIndex)})},e.prototype.eachSeriesByType=function(t,r,i){nA(this),it(this._seriesIndices,function(s){var o=this._componentsMap.get("series")[s];o.subType===t&&r.call(i,o,s)},this)},e.prototype.eachRawSeriesByType=function(t,r,i){return it(this.getSeriesByType(t),r,i)},e.prototype.isSeriesFiltered=function(t){return nA(this),this._seriesIndicesMap.get(t.componentIndex)==null},e.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},e.prototype.filterSeries=function(t,r){nA(this);var i=[];it(this._seriesIndices,function(s){var o=this._componentsMap.get("series")[s];t.call(r,o,s)&&i.push(s)},this),this._seriesIndices=i,this._seriesIndicesMap=ii(i)},e.prototype.restoreData=function(t){nI(this);var r=this._componentsMap,i=[];r.each(function(s,o){as.hasClass(o)&&i.push(o)}),as.topologicalTravel(i,as.getAllClassMainTypes(),function(s){it(r.get(s),function(o){o&&(s!=="series"||!bRe(o,t))&&o.restoreData()})})},e.internalField=function(){nI=function(t){var r=t._seriesIndices=[];it(t._componentsMap.get("series"),function(i){i&&r.push(i.componentIndex)}),t._seriesIndicesMap=ii(r)},nA=function(t){},Mq=function(t,r){t.option={},t.option[Eq]=xRe,t._componentsMap=ii({series:[]}),t._componentsCount=ii();var i=r.aria;$r(i)&&i.enabled==null&&(i.enabled=!0),wRe(r,t._theme.option),Bi(r,uRe,!1),t._mergeOption(r,null)}}(),e}(Ra);function bRe(n,e){if(e){var t=e.seriesIndex,r=e.seriesId,i=e.seriesName;return t!=null&&n.componentIndex!==t||r!=null&&n.id!==r||i!=null&&n.name!==i}}function wRe(n,e){var t=n.color&&!n.colorLayer;it(e,function(r,i){i==="colorLayer"&&t||as.hasClass(i)||(typeof r=="object"?n[i]=n[i]?Bi(n[i],r,!1):yi(r):n[i]==null&&(n[i]=r))})}function Cq(n,e,t){if(fr(e)){var r=ii();return it(e,function(s){if(s!=null){var o=fp(s,null);o!=null&&r.set(s,!0)}}),no(t,function(s){return s&&r.get(s[n])})}else{var i=fp(e,null);return no(t,function(s){return s&&i!=null&&s[n]===i})}}function Iq(n,e){return e.hasOwnProperty("subType")?no(n,function(t){return t&&t.subType===e.subType}):n}function Rq(n){var e=ii();return n&&it(mo(n.replaceMerge),function(t){e.set(t,!0)}),{replaceMergeMainTypeMap:e}}od(bG,xG);var SRe=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],fae=function(){function n(e){it(SRe,function(t){this[t]=Us(e[t],e)},this)}return n}(),g3={},wG=function(){function n(){this._coordinateSystems=[]}return n.prototype.create=function(e,t){var r=[];it(g3,function(i,s){var o=i.create(e,t);r=r.concat(o||[])}),this._coordinateSystems=r},n.prototype.update=function(e,t){it(this._coordinateSystems,function(r){r.update&&r.update(e,t)})},n.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},n.register=function(e,t){g3[e]=t},n.get=function(e){return g3[e]},n}(),ARe=/^(min|max)?(.+)$/,TRe=function(){function n(e){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=e}return n.prototype.setOption=function(e,t,r){e&&(it(mo(e.series),function(o){o&&o.data&&mu(o.data)&&BP(o.data)}),it(mo(e.dataset),function(o){o&&o.source&&mu(o.source)&&BP(o.source)})),e=yi(e);var i=this._optionBackup,s=MRe(e,t,!i);this._newBaseOption=s.baseOption,i?(s.timelineOptions.length&&(i.timelineOptions=s.timelineOptions),s.mediaList.length&&(i.mediaList=s.mediaList),s.mediaDefault&&(i.mediaDefault=s.mediaDefault)):this._optionBackup=s},n.prototype.mountOption=function(e){var t=this._optionBackup;return this._timelineOptions=t.timelineOptions,this._mediaList=t.mediaList,this._mediaDefault=t.mediaDefault,this._currentMediaIndices=[],yi(e?t.baseOption:this._newBaseOption)},n.prototype.getTimelineOption=function(e){var t,r=this._timelineOptions;if(r.length){var i=e.getComponent("timeline");i&&(t=yi(r[i.getCurrentIndex()]))}return t},n.prototype.getMediaOption=function(e){var t=this._api.getWidth(),r=this._api.getHeight(),i=this._mediaList,s=this._mediaDefault,o=[],l=[];if(!i.length&&!s)return l;for(var a=0,h=i.length;a<h;a++)ERe(i[a].query,t,r)&&o.push(a);return!o.length&&s&&(o=[-1]),o.length&&!IRe(o,this._currentMediaIndices)&&(l=xr(o,function(f){return yi(f===-1?s.option:i[f].option)})),this._currentMediaIndices=o,l},n}();function MRe(n,e,t){var r=[],i,s,o=n.baseOption,l=n.timeline,a=n.options,h=n.media,f=!!n.media,p=!!(a||l||o&&o.timeline);o?(s=o,s.timeline||(s.timeline=l)):((p||f)&&(n.options=n.media=null),s=n),f&&fr(h)&&it(h,function(y){y&&y.option&&(y.query?r.push(y):i||(i=y))}),v(s),it(a,function(y){return v(y)}),it(r,function(y){return v(y.option)});function v(y){it(e,function(S){S(y,t)})}return{baseOption:s,timelineOptions:a||[],mediaDefault:i,mediaList:r}}function ERe(n,e,t){var r={width:e,height:t,aspectratio:e/t},i=!0;return it(n,function(s,o){var l=o.match(ARe);if(!(!l||!l[1]||!l[2])){var a=l[1],h=l[2].toLowerCase();CRe(r[h],s,a)||(i=!1)}}),i}function CRe(n,e,t){return t==="min"?n>=e:t==="max"?n<=e:n===e}function IRe(n,e){return n.join(",")===e.join(",")}var Rf=it,bM=$r,Pq=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function v3(n){var e=n&&n.itemStyle;if(e)for(var t=0,r=Pq.length;t<r;t++){var i=Pq[t],s=e.normal,o=e.emphasis;s&&s[i]&&(n[i]=n[i]||{},n[i].normal?Bi(n[i].normal,s[i]):n[i].normal=s[i],s[i]=null),o&&o[i]&&(n[i]=n[i]||{},n[i].emphasis?Bi(n[i].emphasis,o[i]):n[i].emphasis=o[i],o[i]=null)}}function Hl(n,e,t){if(n&&n[e]&&(n[e].normal||n[e].emphasis)){var r=n[e].normal,i=n[e].emphasis;r&&(t?(n[e].normal=n[e].emphasis=null,ti(n[e],r)):n[e]=r),i&&(n.emphasis=n.emphasis||{},n.emphasis[e]=i,i.focus&&(n.emphasis.focus=i.focus),i.blurScope&&(n.emphasis.blurScope=i.blurScope))}}function FA(n){Hl(n,"itemStyle"),Hl(n,"lineStyle"),Hl(n,"areaStyle"),Hl(n,"label"),Hl(n,"labelLine"),Hl(n,"upperLabel"),Hl(n,"edgeLabel")}function fo(n,e){var t=bM(n)&&n[e],r=bM(t)&&t.textStyle;if(r)for(var i=0,s=BX.length;i<s;i++){var o=BX[i];r.hasOwnProperty(o)&&(t[o]=r[o])}}function vh(n){n&&(FA(n),fo(n,"label"),n.emphasis&&fo(n.emphasis,"label"))}function RRe(n){if(bM(n)){v3(n),FA(n),fo(n,"label"),fo(n,"upperLabel"),fo(n,"edgeLabel"),n.emphasis&&(fo(n.emphasis,"label"),fo(n.emphasis,"upperLabel"),fo(n.emphasis,"edgeLabel"));var e=n.markPoint;e&&(v3(e),vh(e));var t=n.markLine;t&&(v3(t),vh(t));var r=n.markArea;r&&vh(r);var i=n.data;if(n.type==="graph"){i=i||n.nodes;var s=n.links||n.edges;if(s&&!mu(s))for(var o=0;o<s.length;o++)vh(s[o]);it(n.categories,function(h){FA(h)})}if(i&&!mu(i))for(var o=0;o<i.length;o++)vh(i[o]);if(e=n.markPoint,e&&e.data)for(var l=e.data,o=0;o<l.length;o++)vh(l[o]);if(t=n.markLine,t&&t.data)for(var a=t.data,o=0;o<a.length;o++)fr(a[o])?(vh(a[o][0]),vh(a[o][1])):vh(a[o]);n.type==="gauge"?(fo(n,"axisLabel"),fo(n,"title"),fo(n,"detail")):n.type==="treemap"?(Hl(n.breadcrumb,"itemStyle"),it(n.levels,function(h){FA(h)})):n.type==="tree"&&FA(n.leaves)}}function _m(n){return fr(n)?n:n?[n]:[]}function Lq(n){return(fr(n)?n[0]:n)||{}}function PRe(n,e){Rf(_m(n.series),function(r){bM(r)&&RRe(r)});var t=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];e&&t.push("valueAxis","categoryAxis","logAxis","timeAxis"),Rf(t,function(r){Rf(_m(n[r]),function(i){i&&(fo(i,"axisLabel"),fo(i.axisPointer,"label"))})}),Rf(_m(n.parallel),function(r){var i=r&&r.parallelAxisDefault;fo(i,"axisLabel"),fo(i&&i.axisPointer,"label")}),Rf(_m(n.calendar),function(r){Hl(r,"itemStyle"),fo(r,"dayLabel"),fo(r,"monthLabel"),fo(r,"yearLabel")}),Rf(_m(n.radar),function(r){fo(r,"name"),r.name&&r.axisName==null&&(r.axisName=r.name,delete r.name),r.nameGap!=null&&r.axisNameGap==null&&(r.axisNameGap=r.nameGap,delete r.nameGap)}),Rf(_m(n.geo),function(r){bM(r)&&(vh(r),Rf(_m(r.regions),function(i){vh(i)}))}),Rf(_m(n.timeline),function(r){vh(r),Hl(r,"label"),Hl(r,"itemStyle"),Hl(r,"controlStyle",!0);var i=r.data;fr(i)&&it(i,function(s){$r(s)&&(Hl(s,"label"),Hl(s,"itemStyle"))})}),Rf(_m(n.toolbox),function(r){Hl(r,"iconStyle"),Rf(r.feature,function(i){Hl(i,"iconStyle")})}),fo(Lq(n.axisPointer),"label"),fo(Lq(n.tooltip).axisPointer,"label")}function LRe(n,e){for(var t=e.split(","),r=n,i=0;i<t.length&&(r=r&&r[t[i]],r!=null);i++);return r}function DRe(n,e,t,r){for(var i=e.split(","),s=n,o,l=0;l<i.length-1;l++)o=i[l],s[o]==null&&(s[o]={}),s=s[o];s[i[l]]==null&&(s[i[l]]=t)}function Dq(n){n&&it(BRe,function(e){e[0]in n&&!(e[1]in n)&&(n[e[1]]=n[e[0]])})}var BRe=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],kRe=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],_3=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function rA(n){var e=n&&n.itemStyle;if(e)for(var t=0;t<_3.length;t++){var r=_3[t][1],i=_3[t][0];e[r]!=null&&(e[i]=e[r])}}function Bq(n){n&&n.alignTo==="edge"&&n.margin!=null&&n.edgeDistance==null&&(n.edgeDistance=n.margin)}function kq(n){n&&n.downplay&&!n.blur&&(n.blur=n.downplay)}function ORe(n){n&&n.focusNodeAdjacency!=null&&(n.emphasis=n.emphasis||{},n.emphasis.focus==null&&(n.emphasis.focus="adjacency"))}function dae(n,e){if(n)for(var t=0;t<n.length;t++)e(n[t]),n[t]&&dae(n[t].children,e)}function pae(n,e){PRe(n,e),n.series=mo(n.series),it(n.series,function(t){if($r(t)){var r=t.type;if(r==="line")t.clipOverflow!=null&&(t.clip=t.clipOverflow);else if(r==="pie"||r==="gauge"){t.clockWise!=null&&(t.clockwise=t.clockWise),Bq(t.label);var i=t.data;if(i&&!mu(i))for(var s=0;s<i.length;s++)Bq(i[s]);t.hoverOffset!=null&&(t.emphasis=t.emphasis||{},(t.emphasis.scaleSize=null)&&(t.emphasis.scaleSize=t.hoverOffset))}else if(r==="gauge"){var o=LRe(t,"pointer.color");o!=null&&DRe(t,"itemStyle.color",o)}else if(r==="bar"){rA(t),rA(t.backgroundStyle),rA(t.emphasis);var i=t.data;if(i&&!mu(i))for(var s=0;s<i.length;s++)typeof i[s]=="object"&&(rA(i[s]),rA(i[s]&&i[s].emphasis))}else if(r==="sunburst"){var l=t.highlightPolicy;l&&(t.emphasis=t.emphasis||{},t.emphasis.focus||(t.emphasis.focus=l)),kq(t),dae(t.data,kq)}else r==="graph"||r==="sankey"?ORe(t):r==="map"&&(t.mapType&&!t.map&&(t.map=t.mapType),t.mapLocation&&ti(t,t.mapLocation));t.hoverAnimation!=null&&(t.emphasis=t.emphasis||{},t.emphasis&&t.emphasis.scale==null&&(t.emphasis.scale=t.hoverAnimation)),Dq(t)}}),n.dataRange&&(n.visualMap=n.dataRange),it(kRe,function(t){var r=n[t];r&&(fr(r)||(r=[r]),it(r,function(i){Dq(i)}))})}function FRe(n){var e=ii();n.eachSeries(function(t){var r=t.get("stack");if(r){var i=e.get(r)||e.set(r,[]),s=t.getData(),o={stackResultDimension:s.getCalculationInfo("stackResultDimension"),stackedOverDimension:s.getCalculationInfo("stackedOverDimension"),stackedDimension:s.getCalculationInfo("stackedDimension"),stackedByDimension:s.getCalculationInfo("stackedByDimension"),isStackedByIndex:s.getCalculationInfo("isStackedByIndex"),data:s,seriesModel:t};if(!o.stackedDimension||!(o.isStackedByIndex||o.stackedByDimension))return;i.length&&s.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(o)}}),e.each(NRe)}function NRe(n){it(n,function(e,t){var r=[],i=[NaN,NaN],s=[e.stackResultDimension,e.stackedOverDimension],o=e.data,l=e.isStackedByIndex,a=e.seriesModel.get("stackStrategy")||"samesign";o.modify(s,function(h,f,p){var v=o.get(e.stackedDimension,p);if(isNaN(v))return i;var y,S;l?S=o.getRawIndex(p):y=o.get(e.stackedByDimension,p);for(var C=NaN,M=t-1;M>=0;M--){var E=n[M];if(l||(S=E.data.rawIndexOf(E.stackedByDimension,y)),S>=0){var L=E.data.getByRawIndex(E.stackResultDimension,S);if(a==="all"||a==="positive"&&L>0||a==="negative"&&L<0||a==="samesign"&&v>=0&&L>0||a==="samesign"&&v<=0&&L<0){v=cCe(v,L),C=L;break}}}return r[0]=v,r[1]=C,r})})}var mB=function(){function n(e){this.data=e.data||(e.sourceFormat===wp?{}:[]),this.sourceFormat=e.sourceFormat||lae,this.seriesLayoutBy=e.seriesLayoutBy||dp,this.startIndex=e.startIndex||0,this.dimensionsDetectedCount=e.dimensionsDetectedCount,this.metaRawOption=e.metaRawOption;var t=this.dimensionsDefine=e.dimensionsDefine;if(t)for(var r=0;r<t.length;r++){var i=t[r];i.type==null&&uae(this,r)===yl.Must&&(i.type="ordinal")}}return n}();function SG(n){return n instanceof mB}function zz(n,e,t){t=t||gae(n);var r=e.seriesLayoutBy,i=URe(n,t,r,e.sourceHeader,e.dimensions),s=new mB({data:n,sourceFormat:t,seriesLayoutBy:r,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:yi(e)});return s}function mae(n){return new mB({data:n,sourceFormat:mu(n)?c0:zh})}function zRe(n){return new mB({data:n.data,sourceFormat:n.sourceFormat,seriesLayoutBy:n.seriesLayoutBy,dimensionsDefine:yi(n.dimensionsDefine),startIndex:n.startIndex,dimensionsDetectedCount:n.dimensionsDetectedCount})}function gae(n){var e=lae;if(mu(n))e=c0;else if(fr(n)){n.length===0&&(e=Lc);for(var t=0,r=n.length;t<r;t++){var i=n[t];if(i!=null){if(fr(i)||mu(i)){e=Lc;break}else if($r(i)){e=Uh;break}}}}else if($r(n)){for(var s in n)if(Qm(n,s)&&Pc(n[s])){e=wp;break}}return e}function URe(n,e,t,r,i){var s,o;if(!n)return{dimensionsDefine:Oq(i),startIndex:o,dimensionsDetectedCount:s};if(e===Lc){var l=n;r==="auto"||r==null?Fq(function(h){h!=null&&h!=="-"&&(Dr(h)?o==null&&(o=1):o=0)},t,l,10):o=Ps(r)?r:r?1:0,!i&&o===1&&(i=[],Fq(function(h,f){i[f]=h!=null?h+"":""},t,l,1/0)),s=i?i.length:t===Ow?l.length:l[0]?l[0].length:null}else if(e===Uh)i||(i=GRe(n));else if(e===wp)i||(i=[],it(n,function(h,f){i.push(f)}));else if(e===zh){var a=vE(n[0]);s=fr(a)&&a.length||1}return{startIndex:o,dimensionsDefine:Oq(i),dimensionsDetectedCount:s}}function GRe(n){for(var e=0,t;e<n.length&&!(t=n[e++]););if(t)return aa(t)}function Oq(n){if(n){var e=ii();return xr(n,function(t,r){t=$r(t)?t:{name:t};var i={name:t.name,displayName:t.displayName,type:t.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var s=e.get(i.name);return s?i.name+="-"+s.count++:e.set(i.name,{count:1}),i})}}function Fq(n,e,t,r){if(e===Ow)for(var i=0;i<t.length&&i<r;i++)n(t[i]?t[i][0]:null,i);else for(var s=t[0]||[],i=0;i<s.length&&i<r;i++)n(s[i],i)}function vae(n){var e=n.sourceFormat;return e===Uh||e===wp}var J_,Q_,ey,Nq,zq,_ae=function(){function n(e,t){var r=SG(e)?e:mae(e);this._source=r;var i=this._data=r.data;r.sourceFormat===c0&&(this._offset=0,this._dimSize=t,this._data=i),zq(this,i,r)}return n.prototype.getSource=function(){return this._source},n.prototype.count=function(){return 0},n.prototype.getItem=function(e,t){},n.prototype.appendData=function(e){},n.prototype.clean=function(){},n.protoInitialize=function(){var e=n.prototype;e.pure=!1,e.persistent=!0}(),n.internalField=function(){var e;zq=function(o,l,a){var h=a.sourceFormat,f=a.seriesLayoutBy,p=a.startIndex,v=a.dimensionsDefine,y=Nq[AG(h,f)];if(Jn(o,y),h===c0)o.getItem=t,o.count=i,o.fillStorage=r;else{var S=yae(h,f);o.getItem=Us(S,null,l,p,v);var C=xae(h,f);o.count=Us(C,null,l,p,v)}};var t=function(o,l){o=o-this._offset,l=l||[];for(var a=this._data,h=this._dimSize,f=h*o,p=0;p<h;p++)l[p]=a[f+p];return l},r=function(o,l,a,h){for(var f=this._data,p=this._dimSize,v=0;v<p;v++){for(var y=h[v],S=y[0]==null?1/0:y[0],C=y[1]==null?-1/0:y[1],M=l-o,E=a[v],L=0;L<M;L++){var k=f[L*p+v];E[o+L]=k,k<S&&(S=k),k>C&&(C=k)}y[0]=S,y[1]=C}},i=function(){return this._data?this._data.length/this._dimSize:0};Nq=(e={},e[Lc+"_"+dp]={pure:!0,appendData:s},e[Lc+"_"+Ow]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},e[Uh]={pure:!0,appendData:s},e[wp]={pure:!0,appendData:function(o){var l=this._data;it(o,function(a,h){for(var f=l[h]||(l[h]=[]),p=0;p<(a||[]).length;p++)f.push(a[p])})}},e[zh]={appendData:s},e[c0]={persistent:!1,pure:!0,appendData:function(o){this._data=o},clean:function(){this._offset+=this.count(),this._data=null}},e);function s(o){for(var l=0;l<o.length;l++)this._data.push(o[l])}}(),n}(),Uq=function(n,e,t,r){return n[r]},VRe=(J_={},J_[Lc+"_"+dp]=function(n,e,t,r){return n[r+e]},J_[Lc+"_"+Ow]=function(n,e,t,r,i){r+=e;for(var s=i||[],o=n,l=0;l<o.length;l++){var a=o[l];s[l]=a?a[r]:null}return s},J_[Uh]=Uq,J_[wp]=function(n,e,t,r,i){for(var s=i||[],o=0;o<t.length;o++){var l=t[o].name,a=n[l];s[o]=a?a[r]:null}return s},J_[zh]=Uq,J_);function yae(n,e){var t=VRe[AG(n,e)];return t}var Gq=function(n,e,t){return n.length},HRe=(Q_={},Q_[Lc+"_"+dp]=function(n,e,t){return Math.max(0,n.length-e)},Q_[Lc+"_"+Ow]=function(n,e,t){var r=n[0];return r?Math.max(0,r.length-e):0},Q_[Uh]=Gq,Q_[wp]=function(n,e,t){var r=t[0].name,i=n[r];return i?i.length:0},Q_[zh]=Gq,Q_);function xae(n,e){var t=HRe[AG(n,e)];return t}var y3=function(n,e,t){return n[e]},jRe=(ey={},ey[Lc]=y3,ey[Uh]=function(n,e,t){return n[t]},ey[wp]=y3,ey[zh]=function(n,e,t){var r=vE(n);return r instanceof Array?r[e]:r},ey[c0]=y3,ey);function bae(n){var e=jRe[n];return e}function AG(n,e){return n===Lc?n+"_"+e:n}function fw(n,e,t){if(n){var r=n.getRawDataItem(e);if(r!=null){var i=n.getStore(),s=i.getSource().sourceFormat;if(t!=null){var o=n.getDimensionIndex(t),l=i.getDimensionProperty(o);return bae(s)(r,o,l)}else{var a=r;return s===zh&&(a=vE(r)),a}}}}var WRe=/\{@(.+?)\}/g,$Re=function(){function n(){}return n.prototype.getDataParams=function(e,t){var r=this.getData(t),i=this.getRawValue(e,t),s=r.getRawIndex(e),o=r.getName(e),l=r.getRawDataItem(e),a=r.getItemVisual(e,"style"),h=a&&a[r.getItemVisual(e,"drawType")||"fill"],f=a&&a.stroke,p=this.mainType,v=p==="series",y=r.userOutput&&r.userOutput.get();return{componentType:p,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:v?this.subType:null,seriesIndex:this.seriesIndex,seriesId:v?this.id:null,seriesName:v?this.name:null,name:o,dataIndex:s,data:l,dataType:t,value:i,color:h,borderColor:f,dimensionNames:y?y.fullDimensions:null,encode:y?y.encode:null,$vars:["seriesName","name","value"]}},n.prototype.getFormattedLabel=function(e,t,r,i,s,o){t=t||"normal";var l=this.getData(r),a=this.getDataParams(e,r);if(o&&(a.value=o.interpolatedValue),i!=null&&fr(a.value)&&(a.value=a.value[i]),!s){var h=l.getItemModel(e);s=h.get(t==="normal"?["label","formatter"]:[t,"label","formatter"])}if(ci(s))return a.status=t,a.dimensionIndex=i,s(a);if(Dr(s)){var f=sae(s,a);return f.replace(WRe,function(p,v){var y=v.length,S=v;S.charAt(0)==="["&&S.charAt(y-1)==="]"&&(S=+S.slice(1,y-1));var C=fw(l,e,S);if(o&&fr(o.interpolatedValue)){var M=l.getDimensionIndex(S);M>=0&&(C=o.interpolatedValue[M])}return C!=null?C+"":""})}},n.prototype.getRawValue=function(e,t){return fw(this.getData(t),e)},n.prototype.formatTooltip=function(e,t,r){},n}();function Vq(n){var e,t;return $r(n)?n.type&&(t=n):e=n,{text:e,frag:t}}function xT(n){return new XRe(n)}var XRe=function(){function n(e){e=e||{},this._reset=e.reset,this._plan=e.plan,this._count=e.count,this._onDirty=e.onDirty,this._dirty=!0}return n.prototype.perform=function(e){var t=this._upstream,r=e&&e.skip;if(this._dirty&&t){var i=this.context;i.data=i.outputData=t.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var s;this._plan&&!r&&(s=this._plan(this.context));var o=f(this._modBy),l=this._modDataCount||0,a=f(e&&e.modBy),h=e&&e.modDataCount||0;(o!==a||l!==h)&&(s="reset");function f(L){return!(L>=1)&&(L=1),L}var p;(this._dirty||s==="reset")&&(this._dirty=!1,p=this._doReset(r)),this._modBy=a,this._modDataCount=h;var v=e&&e.step;if(t?this._dueEnd=t._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var y=this._dueIndex,S=Math.min(v!=null?this._dueIndex+v:1/0,this._dueEnd);if(!r&&(p||y<S)){var C=this._progress;if(fr(C))for(var M=0;M<C.length;M++)this._doProgress(C[M],y,S,a,h);else this._doProgress(C,y,S,a,h)}this._dueIndex=S;var E=this._settedOutputEnd!=null?this._settedOutputEnd:S;this._outputDueEnd=E}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},n.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},n.prototype._doProgress=function(e,t,r,i,s){Hq.reset(t,r,i,s),this._callingProgress=e,this._callingProgress({start:t,end:r,count:r-t,next:Hq.next},this.context)},n.prototype._doReset=function(e){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var t,r;!e&&this._reset&&(t=this._reset(this.context),t&&t.progress&&(r=t.forceFirstProgress,t=t.progress),fr(t)&&!t.length&&(t=null)),this._progress=t,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),r},n.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},n.prototype.pipe=function(e){(this._downstream!==e||this._dirty)&&(this._downstream=e,e._upstream=this,e.dirty())},n.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},n.prototype.getUpstream=function(){return this._upstream},n.prototype.getDownstream=function(){return this._downstream},n.prototype.setOutputEnd=function(e){this._outputDueEnd=this._settedOutputEnd=e},n}(),Hq=function(){var n,e,t,r,i,s={reset:function(a,h,f,p){e=a,n=h,t=f,r=p,i=Math.ceil(r/t),s.next=t>1&&r>0?l:o}};return s;function o(){return e<n?e++:null}function l(){var a=e%i*t+Math.ceil(e/i),h=e>=n?null:a<r?a:e;return e++,h}}();function mR(n,e){var t=e&&e.type;return t==="ordinal"?n:(t==="time"&&!Ps(n)&&n!=null&&n!=="-"&&(n=+eg(n)),n==null||n===""?NaN:Number(n))}var qRe=ii({number:function(n){return parseFloat(n)},time:function(n){return+eg(n)},trim:function(n){return Dr(n)?rp(n):n}});function wae(n){return qRe.get(n)}var Sae={lt:function(n,e){return n<e},lte:function(n,e){return n<=e},gt:function(n,e){return n>e},gte:function(n,e){return n>=e}},ZRe=function(){function n(e,t){if(!Ps(t)){var r="";os(r)}this._opFn=Sae[e],this._rvalFloat=x0(t)}return n.prototype.evaluate=function(e){return Ps(e)?this._opFn(e,this._rvalFloat):this._opFn(x0(e),this._rvalFloat)},n}(),Aae=function(){function n(e,t){var r=e==="desc";this._resultLT=r?1:-1,t==null&&(t=r?"min":"max"),this._incomparable=t==="min"?-1/0:1/0}return n.prototype.evaluate=function(e,t){var r=Ps(e)?e:x0(e),i=Ps(t)?t:x0(t),s=isNaN(r),o=isNaN(i);if(s&&(r=this._incomparable),o&&(i=this._incomparable),s&&o){var l=Dr(e),a=Dr(t);l&&(r=a?e:0),a&&(i=l?t:0)}return r<i?this._resultLT:r>i?-this._resultLT:0},n}(),YRe=function(){function n(e,t){this._rval=t,this._isEQ=e,this._rvalTypeof=typeof t,this._rvalFloat=x0(t)}return n.prototype.evaluate=function(e){var t=e===this._rval;if(!t){var r=typeof e;r!==this._rvalTypeof&&(r==="number"||this._rvalTypeof==="number")&&(t=x0(e)===this._rvalFloat)}return this._isEQ?t:!t},n}();function KRe(n,e){return n==="eq"||n==="ne"?new YRe(n==="eq",e):Qm(Sae,n)?new ZRe(n,e):null}var JRe=function(){function n(){}return n.prototype.getRawData=function(){throw new Error("not supported")},n.prototype.getRawDataItem=function(e){throw new Error("not supported")},n.prototype.cloneRawData=function(){},n.prototype.getDimensionInfo=function(e){},n.prototype.cloneAllDimensionInfo=function(){},n.prototype.count=function(){},n.prototype.retrieveValue=function(e,t){},n.prototype.retrieveValueFromItem=function(e,t){},n.prototype.convertValue=function(e,t){return mR(e,t)},n}();function QRe(n,e){var t=new JRe,r=n.data,i=t.sourceFormat=n.sourceFormat,s=n.startIndex,o="";n.seriesLayoutBy!==dp&&os(o);var l=[],a={},h=n.dimensionsDefine;if(h)it(h,function(C,M){var E=C.name,L={index:M,name:E,displayName:C.displayName};if(l.push(L),E!=null){var k="";Qm(a,E)&&os(k),a[E]=L}});else for(var f=0;f<n.dimensionsDetectedCount;f++)l.push({index:f});var p=yae(i,dp);e.__isBuiltIn&&(t.getRawDataItem=function(C){return p(r,s,l,C)},t.getRawData=Us(ePe,null,n)),t.cloneRawData=Us(tPe,null,n);var v=xae(i,dp);t.count=Us(v,null,r,s,l);var y=bae(i);t.retrieveValue=function(C,M){var E=p(r,s,l,C);return S(E,M)};var S=t.retrieveValueFromItem=function(C,M){if(C!=null){var E=l[M];if(E)return y(C,M,E.name)}};return t.getDimensionInfo=Us(nPe,null,l,a),t.cloneAllDimensionInfo=Us(rPe,null,l),t}function ePe(n){var e=n.sourceFormat;if(!TG(e)){var t="";os(t)}return n.data}function tPe(n){var e=n.sourceFormat,t=n.data;if(!TG(e)){var r="";os(r)}if(e===Lc){for(var i=[],s=0,o=t.length;s<o;s++)i.push(t[s].slice());return i}else if(e===Uh){for(var i=[],s=0,o=t.length;s<o;s++)i.push(Jn({},t[s]));return i}}function nPe(n,e,t){if(t!=null){if(Ps(t)||!isNaN(t)&&!Qm(e,t))return n[t];if(Qm(e,t))return e[t]}}function rPe(n){return yi(n)}var Tae=ii();function iPe(n){n=yi(n);var e=n.type,t="";e||os(t);var r=e.split(":");r.length!==2&&os(t);var i=!1;r[0]==="echarts"&&(e=r[1],i=!0),n.__isBuiltIn=i,Tae.set(e,n)}function sPe(n,e,t){var r=mo(n),i=r.length,s="";i||os(s);for(var o=0,l=i;o<l;o++){var a=r[o];e=aPe(a,e),o!==l-1&&(e.length=Math.max(e.length,1))}return e}function aPe(n,e,t,r){var i="";e.length||os(i),$r(n)||os(i);var s=n.type,o=Tae.get(s);o||os(i);var l=xr(e,function(h){return QRe(h,o)}),a=mo(o.transform({upstream:l[0],upstreamList:l,config:yi(n.config)}));return xr(a,function(h,f){var p="";$r(h)||os(p),h.data||os(p);var v=gae(h.data);TG(v)||os(p);var y,S=e[0];if(S&&f===0&&!h.dimensions){var C=S.startIndex;C&&(h.data=S.data.slice(0,C).concat(h.data)),y={seriesLayoutBy:dp,sourceHeader:C,dimensions:S.metaRawOption.dimensions}}else y={seriesLayoutBy:dp,sourceHeader:0,dimensions:h.dimensions};return zz(h.data,y,null)})}function TG(n){return n===Lc||n===Uh}var gB="undefined",oPe=typeof Uint32Array===gB?Array:Uint32Array,lPe=typeof Uint16Array===gB?Array:Uint16Array,Mae=typeof Int32Array===gB?Array:Int32Array,jq=typeof Float64Array===gB?Array:Float64Array,Eae={float:jq,int:Mae,ordinal:Array,number:Array,time:jq},x3;function iA(n){return n>65535?oPe:lPe}function z1(){return[1/0,-1/0]}function cPe(n){var e=n.constructor;return e===Array?n.slice():new e(n)}function Wq(n,e,t,r,i){var s=Eae[t||"float"];if(i){var o=n[e],l=o&&o.length;if(l!==r){for(var a=new s(r),h=0;h<l;h++)a[h]=o[h];n[e]=a}}else n[e]=new s(r)}var Uz=function(){function n(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=ii()}return n.prototype.initData=function(e,t,r){this._provider=e,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=e.getSource(),s=this.defaultDimValueGetter=x3[i.sourceFormat];this._dimValueGetter=r||s,this._rawExtent=[],vae(i),this._dimensions=xr(t,function(o){return{type:o.type,property:o.property}}),this._initDataFromProvider(0,e.count())},n.prototype.getProvider=function(){return this._provider},n.prototype.getSource=function(){return this._provider.getSource()},n.prototype.ensureCalculationDimension=function(e,t){var r=this._calcDimNameToIdx,i=this._dimensions,s=r.get(e);if(s!=null){if(i[s].type===t)return s}else s=i.length;return i[s]={type:t},r.set(e,s),this._chunks[s]=new Eae[t||"float"](this._rawCount),this._rawExtent[s]=z1(),s},n.prototype.collectOrdinalMeta=function(e,t){var r=this._chunks[e],i=this._dimensions[e],s=this._rawExtent,o=i.ordinalOffset||0,l=r.length;o===0&&(s[e]=z1());for(var a=s[e],h=o;h<l;h++){var f=r[h]=t.parseAndCollect(r[h]);isNaN(f)||(a[0]=Math.min(f,a[0]),a[1]=Math.max(f,a[1]))}i.ordinalMeta=t,i.ordinalOffset=l,i.type="ordinal"},n.prototype.getOrdinalMeta=function(e){var t=this._dimensions[e],r=t.ordinalMeta;return r},n.prototype.getDimensionProperty=function(e){var t=this._dimensions[e];return t&&t.property},n.prototype.appendData=function(e){var t=this._provider,r=this.count();t.appendData(e);var i=t.count();return t.persistent||(i+=r),r<i&&this._initDataFromProvider(r,i,!0),[r,i]},n.prototype.appendValues=function(e,t){for(var r=this._chunks,i=this._dimensions,s=i.length,o=this._rawExtent,l=this.count(),a=l+Math.max(e.length,t||0),h=0;h<s;h++){var f=i[h];Wq(r,h,f.type,a,!0)}for(var p=[],v=l;v<a;v++)for(var y=v-l,S=0;S<s;S++){var f=i[S],C=x3.arrayRows.call(this,e[y]||p,f.property,y,S);r[S][v]=C;var M=o[S];C<M[0]&&(M[0]=C),C>M[1]&&(M[1]=C)}return this._rawCount=this._count=a,{start:l,end:a}},n.prototype._initDataFromProvider=function(e,t,r){for(var i=this._provider,s=this._chunks,o=this._dimensions,l=o.length,a=this._rawExtent,h=xr(o,function(L){return L.property}),f=0;f<l;f++){var p=o[f];a[f]||(a[f]=z1()),Wq(s,f,p.type,t,r)}if(i.fillStorage)i.fillStorage(e,t,s,a);else for(var v=[],y=e;y<t;y++){v=i.getItem(y,v);for(var S=0;S<l;S++){var C=s[S],M=this._dimValueGetter(v,h[S],y,S);C[y]=M;var E=a[S];M<E[0]&&(E[0]=M),M>E[1]&&(E[1]=M)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=t,this._extent=[]},n.prototype.count=function(){return this._count},n.prototype.get=function(e,t){if(!(t>=0&&t<this._count))return NaN;var r=this._chunks[e];return r?r[this.getRawIndex(t)]:NaN},n.prototype.getValues=function(e,t){var r=[],i=[];if(t==null){t=e,e=[];for(var s=0;s<this._dimensions.length;s++)i.push(s)}else i=e;for(var s=0,o=i.length;s<o;s++)r.push(this.get(i[s],t));return r},n.prototype.getByRawIndex=function(e,t){if(!(t>=0&&t<this._rawCount))return NaN;var r=this._chunks[e];return r?r[t]:NaN},n.prototype.getSum=function(e){var t=this._chunks[e],r=0;if(t)for(var i=0,s=this.count();i<s;i++){var o=this.get(e,i);isNaN(o)||(r+=o)}return r},n.prototype.getMedian=function(e){var t=[];this.each([e],function(s){isNaN(s)||t.push(s)});var r=t.sort(function(s,o){return s-o}),i=this.count();return i===0?0:i%2===1?r[(i-1)/2]:(r[i/2]+r[i/2-1])/2},n.prototype.indexOfRawIndex=function(e){if(e>=this._rawCount||e<0)return-1;if(!this._indices)return e;var t=this._indices,r=t[e];if(r!=null&&r<this._count&&r===e)return e;for(var i=0,s=this._count-1;i<=s;){var o=(i+s)/2|0;if(t[o]<e)i=o+1;else if(t[o]>e)s=o-1;else return o}return-1},n.prototype.indicesOfNearest=function(e,t,r){var i=this._chunks,s=i[e],o=[];if(!s)return o;r==null&&(r=1/0);for(var l=1/0,a=-1,h=0,f=0,p=this.count();f<p;f++){var v=this.getRawIndex(f),y=t-s[v],S=Math.abs(y);S<=r&&((S<l||S===l&&y>=0&&a<0)&&(l=S,a=y,h=0),y===a&&(o[h++]=f))}return o.length=h,o},n.prototype.getIndices=function(){var e,t=this._indices;if(t){var r=t.constructor,i=this._count;if(r===Array){e=new r(i);for(var s=0;s<i;s++)e[s]=t[s]}else e=new r(t.buffer,0,i)}else{var r=iA(this._rawCount);e=new r(this.count());for(var s=0;s<e.length;s++)e[s]=s}return e},n.prototype.filter=function(e,t){if(!this._count)return this;for(var r=this.clone(),i=r.count(),s=iA(r._rawCount),o=new s(i),l=[],a=e.length,h=0,f=e[0],p=r._chunks,v=0;v<i;v++){var y=void 0,S=r.getRawIndex(v);if(a===0)y=t(v);else if(a===1){var C=p[f][S];y=t(C,v)}else{for(var M=0;M<a;M++)l[M]=p[e[M]][S];l[M]=v,y=t.apply(null,l)}y&&(o[h++]=S)}return h<i&&(r._indices=o),r._count=h,r._extent=[],r._updateGetRawIdx(),r},n.prototype.selectRange=function(e){var t=this.clone(),r=t._count;if(!r)return this;var i=aa(e),s=i.length;if(!s)return this;var o=t.count(),l=iA(t._rawCount),a=new l(o),h=0,f=i[0],p=e[f][0],v=e[f][1],y=t._chunks,S=!1;if(!t._indices){var C=0;if(s===1){for(var M=y[i[0]],E=0;E<r;E++){var L=M[E];(L>=p&&L<=v||isNaN(L))&&(a[h++]=C),C++}S=!0}else if(s===2){for(var M=y[i[0]],k=y[i[1]],H=e[i[1]][0],X=e[i[1]][1],E=0;E<r;E++){var L=M[E],Z=k[E];(L>=p&&L<=v||isNaN(L))&&(Z>=H&&Z<=X||isNaN(Z))&&(a[h++]=C),C++}S=!0}}if(!S)if(s===1)for(var E=0;E<o;E++){var Q=t.getRawIndex(E),L=y[i[0]][Q];(L>=p&&L<=v||isNaN(L))&&(a[h++]=Q)}else for(var E=0;E<o;E++){for(var re=!0,Q=t.getRawIndex(E),ie=0;ie<s;ie++){var oe=i[ie],L=y[oe][Q];(L<e[oe][0]||L>e[oe][1])&&(re=!1)}re&&(a[h++]=t.getRawIndex(E))}return h<o&&(t._indices=a),t._count=h,t._extent=[],t._updateGetRawIdx(),t},n.prototype.map=function(e,t){var r=this.clone(e);return this._updateDims(r,e,t),r},n.prototype.modify=function(e,t){this._updateDims(this,e,t)},n.prototype._updateDims=function(e,t,r){for(var i=e._chunks,s=[],o=t.length,l=e.count(),a=[],h=e._rawExtent,f=0;f<t.length;f++)h[t[f]]=z1();for(var p=0;p<l;p++){for(var v=e.getRawIndex(p),y=0;y<o;y++)a[y]=i[t[y]][v];a[o]=p;var S=r&&r.apply(null,a);if(S!=null){typeof S!="object"&&(s[0]=S,S=s);for(var f=0;f<S.length;f++){var C=t[f],M=S[f],E=h[C],L=i[C];L&&(L[v]=M),M<E[0]&&(E[0]=M),M>E[1]&&(E[1]=M)}}}},n.prototype.lttbDownSample=function(e,t){var r=this.clone([e],!0),i=r._chunks,s=i[e],o=this.count(),l=0,a=Math.floor(1/t),h=this.getRawIndex(0),f,p,v,y=new(iA(this._rawCount))(Math.min((Math.ceil(o/a)+2)*2,o));y[l++]=h;for(var S=1;S<o-1;S+=a){for(var C=Math.min(S+a,o-1),M=Math.min(S+a*2,o),E=(M+C)/2,L=0,k=C;k<M;k++){var H=this.getRawIndex(k),X=s[H];isNaN(X)||(L+=X)}L/=M-C;var Z=S,Q=Math.min(S+a,o),re=S-1,ie=s[h];f=-1,v=Z;for(var oe=-1,fe=0,k=Z;k<Q;k++){var H=this.getRawIndex(k),X=s[H];if(isNaN(X)){fe++,oe<0&&(oe=H);continue}p=Math.abs((re-E)*(X-ie)-(re-k)*(L-ie)),p>f&&(f=p,v=H)}fe>0&&fe<Q-Z&&(y[l++]=Math.min(oe,v),v=Math.max(oe,v)),y[l++]=v,h=v}return y[l++]=this.getRawIndex(o-1),r._count=l,r._indices=y,r.getRawIndex=this._getRawIdx,r},n.prototype.downSample=function(e,t,r,i){for(var s=this.clone([e],!0),o=s._chunks,l=[],a=Math.floor(1/t),h=o[e],f=this.count(),p=s._rawExtent[e]=z1(),v=new(iA(this._rawCount))(Math.ceil(f/a)),y=0,S=0;S<f;S+=a){a>f-S&&(a=f-S,l.length=a);for(var C=0;C<a;C++){var M=this.getRawIndex(S+C);l[C]=h[M]}var E=r(l),L=this.getRawIndex(Math.min(S+i(l,E)||0,f-1));h[L]=E,E<p[0]&&(p[0]=E),E>p[1]&&(p[1]=E),v[y++]=L}return s._count=y,s._indices=v,s._updateGetRawIdx(),s},n.prototype.each=function(e,t){if(this._count)for(var r=e.length,i=this._chunks,s=0,o=this.count();s<o;s++){var l=this.getRawIndex(s);switch(r){case 0:t(s);break;case 1:t(i[e[0]][l],s);break;case 2:t(i[e[0]][l],i[e[1]][l],s);break;default:for(var a=0,h=[];a<r;a++)h[a]=i[e[a]][l];h[a]=s,t.apply(null,h)}}},n.prototype.getDataExtent=function(e){var t=this._chunks[e],r=z1();if(!t)return r;var i=this.count(),s=!this._indices,o;if(s)return this._rawExtent[e].slice();if(o=this._extent[e],o)return o.slice();o=r;for(var l=o[0],a=o[1],h=0;h<i;h++){var f=this.getRawIndex(h),p=t[f];p<l&&(l=p),p>a&&(a=p)}return o=[l,a],this._extent[e]=o,o},n.prototype.getRawDataItem=function(e){var t=this.getRawIndex(e);if(this._provider.persistent)return this._provider.getItem(t);for(var r=[],i=this._chunks,s=0;s<i.length;s++)r.push(i[s][t]);return r},n.prototype.clone=function(e,t){var r=new n,i=this._chunks,s=e&&v0(e,function(l,a){return l[a]=!0,l},{});if(s)for(var o=0;o<i.length;o++)r._chunks[o]=s[o]?cPe(i[o]):i[o];else r._chunks=i;return this._copyCommonProps(r),t||(r._indices=this._cloneIndices()),r._updateGetRawIdx(),r},n.prototype._copyCommonProps=function(e){e._count=this._count,e._rawCount=this._rawCount,e._provider=this._provider,e._dimensions=this._dimensions,e._extent=yi(this._extent),e._rawExtent=yi(this._rawExtent)},n.prototype._cloneIndices=function(){if(this._indices){var e=this._indices.constructor,t=void 0;if(e===Array){var r=this._indices.length;t=new e(r);for(var i=0;i<r;i++)t[i]=this._indices[i]}else t=new e(this._indices);return t}return null},n.prototype._getRawIdxIdentity=function(e){return e},n.prototype._getRawIdx=function(e){return e<this._count&&e>=0?this._indices[e]:-1},n.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},n.internalField=function(){function e(t,r,i,s){return mR(t[s],this._dimensions[s])}x3={arrayRows:e,objectRows:function(t,r,i,s){return mR(t[r],this._dimensions[s])},keyedColumns:e,original:function(t,r,i,s){var o=t&&(t.value==null?t:t.value);return mR(o instanceof Array?o[s]:o,this._dimensions[s])},typedArray:function(t,r,i,s){return t[s]}}}(),n}(),Cae=function(){function n(e){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=e}return n.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},n.prototype._setLocalSource=function(e,t){this._sourceList=e,this._upstreamSignList=t,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},n.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},n.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},n.prototype._createSource=function(){this._setLocalSource([],[]);var e=this._sourceHost,t=this._getUpstreamSourceManagers(),r=!!t.length,i,s;if(rI(e)){var o=e,l=void 0,a=void 0,h=void 0;if(r){var f=t[0];f.prepareSource(),h=f.getSource(),l=h.data,a=h.sourceFormat,s=[f._getVersionSign()]}else l=o.get("data",!0),a=mu(l)?c0:zh,s=[];var p=this._getSourceMetaRawOption()||{},v=h&&h.metaRawOption||{},y=Ii(p.seriesLayoutBy,v.seriesLayoutBy)||null,S=Ii(p.sourceHeader,v.sourceHeader),C=Ii(p.dimensions,v.dimensions),M=y!==v.seriesLayoutBy||!!S!=!!v.sourceHeader||C;i=M?[zz(l,{seriesLayoutBy:y,sourceHeader:S,dimensions:C},a)]:[]}else{var E=e;if(r){var L=this._applyTransform(t);i=L.sourceList,s=L.upstreamSignList}else{var k=E.get("source",!0);i=[zz(k,this._getSourceMetaRawOption(),null)],s=[]}}this._setLocalSource(i,s)},n.prototype._applyTransform=function(e){var t=this._sourceHost,r=t.get("transform",!0),i=t.get("fromTransformResult",!0);if(i!=null){var s="";e.length!==1&&Xq(s)}var o,l=[],a=[];return it(e,function(h){h.prepareSource();var f=h.getSource(i||0),p="";i!=null&&!f&&Xq(p),l.push(f),a.push(h._getVersionSign())}),r?o=sPe(r,l,{datasetIndex:t.componentIndex}):i!=null&&(o=[zRe(l[0])]),{sourceList:o,upstreamSignList:a}},n.prototype._isDirty=function(){if(this._dirty)return!0;for(var e=this._getUpstreamSourceManagers(),t=0;t<e.length;t++){var r=e[t];if(r._isDirty()||this._upstreamSignList[t]!==r._getVersionSign())return!0}},n.prototype.getSource=function(e){e=e||0;var t=this._sourceList[e];if(!t){var r=this._getUpstreamSourceManagers();return r[0]&&r[0].getSource(e)}return t},n.prototype.getSharedDataStore=function(e){var t=e.makeStoreSchema();return this._innerGetDataStore(t.dimensions,e.source,t.hash)},n.prototype._innerGetDataStore=function(e,t,r){var i=0,s=this._storeList,o=s[i];o||(o=s[i]={});var l=o[r];if(!l){var a=this._getUpstreamSourceManagers()[0];rI(this._sourceHost)&&a?l=a._innerGetDataStore(e,t,r):(l=new Uz,l.initData(new _ae(t,e.length),e)),o[r]=l}return l},n.prototype._getUpstreamSourceManagers=function(){var e=this._sourceHost;if(rI(e)){var t=yG(e);return t?[t.getSourceManager()]:[]}else return xr(pRe(e),function(r){return r.getSourceManager()})},n.prototype._getSourceMetaRawOption=function(){var e=this._sourceHost,t,r,i;if(rI(e))t=e.get("seriesLayoutBy",!0),r=e.get("sourceHeader",!0),i=e.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var s=e;t=s.get("seriesLayoutBy",!0),r=s.get("sourceHeader",!0),i=s.get("dimensions",!0)}return{seriesLayoutBy:t,sourceHeader:r,dimensions:i}},n}();function $q(n){var e=n.option.transform;e&&BP(n.option.transform)}function rI(n){return n.mainType==="series"}function Xq(n){throw new Error(n)}var Iae="line-height:1";function Rae(n,e){var t=n.color||"#6e7079",r=n.fontSize||12,i=n.fontWeight||"400",s=n.color||"#464646",o=n.fontSize||14,l=n.fontWeight||"900";return e==="html"?{nameStyle:"font-size:"+Du(r+"")+"px;color:"+Du(t)+";font-weight:"+Du(i+""),valueStyle:"font-size:"+Du(o+"")+"px;color:"+Du(s)+";font-weight:"+Du(l+"")}:{nameStyle:{fontSize:r,fill:t,fontWeight:i},valueStyle:{fontSize:o,fill:s,fontWeight:l}}}var uPe=[0,10,20,30],hPe=["",`
`,`

`,`


`];function wM(n,e){return e.type=n,e}function Gz(n){return n.type==="section"}function Pae(n){return Gz(n)?fPe:dPe}function Lae(n){if(Gz(n)){var e=0,t=n.blocks.length,r=t>1||t>0&&!n.noHeader;return it(n.blocks,function(i){var s=Lae(i);s>=e&&(e=s+ +(r&&(!s||Gz(i)&&!i.noHeader)))}),e}return 0}function fPe(n,e,t,r){var i=e.noHeader,s=pPe(Lae(e)),o=[],l=e.blocks||[];vp(!l||fr(l)),l=l||[];var a=n.orderMode;if(e.sortBlocks&&a){l=l.slice();var h={valueAsc:"asc",valueDesc:"desc"};if(Qm(h,a)){var f=new Aae(h[a],null);l.sort(function(S,C){return f.evaluate(S.sortParam,C.sortParam)})}else a==="seriesDesc"&&l.reverse()}it(l,function(S,C){var M=e.valueFormatter,E=Pae(S)(M?Jn(Jn({},n),{valueFormatter:M}):n,S,C>0?s.html:0,r);E!=null&&o.push(E)});var p=n.renderMode==="richText"?o.join(s.richText):Vz(o.join(""),i?t:s.html);if(i)return p;var v=Fz(e.header,"ordinal",n.useUTC),y=Rae(r,n.renderMode).nameStyle;return n.renderMode==="richText"?Dae(n,v,y)+s.richText+p:Vz('<div style="'+y+";"+Iae+';">'+Du(v)+"</div>"+p,t)}function dPe(n,e,t,r){var i=n.renderMode,s=e.noName,o=e.noValue,l=!e.markerType,a=e.name,h=n.useUTC,f=e.valueFormatter||n.valueFormatter||function(H){return H=fr(H)?H:[H],xr(H,function(X,Z){return Fz(X,fr(y)?y[Z]:y,h)})};if(!(s&&o)){var p=l?"":n.markupStyleCreator.makeTooltipMarker(e.markerType,e.markerColor||"#333",i),v=s?"":Fz(a,"ordinal",h),y=e.valueType,S=o?[]:f(e.value,e.dataIndex),C=!l||!s,M=!l&&s,E=Rae(r,i),L=E.nameStyle,k=E.valueStyle;return i==="richText"?(l?"":p)+(s?"":Dae(n,v,L))+(o?"":vPe(n,S,C,M,k)):Vz((l?"":p)+(s?"":mPe(v,!l,L))+(o?"":gPe(S,C,M,k)),t)}}function qq(n,e,t,r,i,s){if(n){var o=Pae(n),l={useUTC:i,renderMode:t,orderMode:r,markupStyleCreator:e,valueFormatter:n.valueFormatter};return o(l,n,0,s)}}function pPe(n){return{html:uPe[n],richText:hPe[n]}}function Vz(n,e){var t='<div style="clear:both"></div>',r="margin: "+e+"px 0 0";return'<div style="'+r+";"+Iae+';">'+n+t+"</div>"}function mPe(n,e,t){var r=e?"margin-left:2px":"";return'<span style="'+t+";"+r+'">'+Du(n)+"</span>"}function gPe(n,e,t,r){var i=t?"10px":"20px",s=e?"float:right;margin-left:"+i:"";return n=fr(n)?n:[n],'<span style="'+s+";"+r+'">'+xr(n,function(o){return Du(o)}).join("&nbsp;&nbsp;")+"</span>"}function Dae(n,e,t){return n.markupStyleCreator.wrapRichTextStyle(e,t)}function vPe(n,e,t,r,i){var s=[i],o=r?10:20;return t&&s.push({padding:[0,0,0,o],align:"right"}),n.markupStyleCreator.wrapRichTextStyle(fr(e)?e.join("  "):e,s)}function _Pe(n,e){var t=n.getData().getItemVisual(e,"style"),r=t[n.visualDrawType];return cx(r)}function Bae(n,e){var t=n.get("padding");return t??(e==="richText"?[8,10]:10)}var b3=function(){function n(){this.richTextStyles={},this._nextStyleNameId=jie()}return n.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},n.prototype.makeTooltipMarker=function(e,t,r){var i=r==="richText"?this._generateStyleName():null,s=iRe({color:t,type:e,renderMode:r,markerId:i});return Dr(s)?s:(this.richTextStyles[i]=s.style,s.content)},n.prototype.wrapRichTextStyle=function(e,t){var r={};fr(t)?it(t,function(s){return Jn(r,s)}):Jn(r,t);var i=this._generateStyleName();return this.richTextStyles[i]=r,"{"+i+"|"+e+"}"},n}();function yPe(n){var e=n.series,t=n.dataIndex,r=n.multipleSeries,i=e.getData(),s=i.mapDimensionsAll("defaultedTooltip"),o=s.length,l=e.getRawValue(t),a=fr(l),h=_Pe(e,t),f,p,v,y;if(o>1||a&&!o){var S=xPe(l,e,t,s,h);f=S.inlineValues,p=S.inlineValueTypes,v=S.blocks,y=S.inlineValues[0]}else if(o){var C=i.getDimensionInfo(s[0]);y=f=fw(i,t,s[0]),p=C.type}else y=f=a?l[0]:l;var M=J6(e),E=M&&e.name||"",L=i.getName(t),k=r?E:L;return wM("section",{header:E,noHeader:r||!M,sortParam:y,blocks:[wM("nameValue",{markerType:"item",markerColor:h,name:k,noName:!rp(k),value:f,valueType:p,dataIndex:t})].concat(v||[])})}function xPe(n,e,t,r,i){var s=e.getData(),o=v0(n,function(p,v,y){var S=s.getDimensionInfo(y);return p=p||S&&S.tooltip!==!1&&S.displayName!=null},!1),l=[],a=[],h=[];r.length?it(r,function(p){f(fw(s,t,p),p)}):it(n,f);function f(p,v){var y=s.getDimensionInfo(v);!y||y.otherDims.tooltip===!1||(o?h.push(wM("nameValue",{markerType:"subItem",markerColor:i,name:y.displayName,value:p,valueType:y.type})):(l.push(p),a.push(y.type)))}return{inlineValues:l,inlineValueTypes:a,blocks:h}}var wv=qs();function iI(n,e){return n.getName(e)||n.getId(e)}var gR="__universalTransitionEnabled",ed=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t._selectedDataIndicesMap={},t}return e.prototype.init=function(t,r,i){this.seriesIndex=this.componentIndex,this.dataTask=xT({count:wPe,reset:SPe}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(t,i);var s=wv(this).sourceManager=new Cae(this);s.prepareSource();var o=this.getInitialData(t,i);Yq(o,this),this.dataTask.context.data=o,wv(this).dataBeforeProcessed=o,Zq(this),this._initSelectedMapFromData(o)},e.prototype.mergeDefaultAndTheme=function(t,r){var i=xM(this),s=i?pB(t):{},o=this.subType;as.hasClass(o)&&(o+="Series"),Bi(t,r.getTheme().get(this.subType)),Bi(t,this.getDefaultOption()),Tz(t,"label",["show"]),this.fillDataTextStyle(t.data),i&&hw(t,s,i)},e.prototype.mergeOption=function(t,r){t=Bi(this.option,t,!0),this.fillDataTextStyle(t.data);var i=xM(this);i&&hw(this.option,t,i);var s=wv(this).sourceManager;s.dirty(),s.prepareSource();var o=this.getInitialData(t,r);Yq(o,this),this.dataTask.dirty(),this.dataTask.context.data=o,wv(this).dataBeforeProcessed=o,Zq(this),this._initSelectedMapFromData(o)},e.prototype.fillDataTextStyle=function(t){if(t&&!mu(t))for(var r=["show"],i=0;i<t.length;i++)t[i]&&t[i].label&&Tz(t[i],"label",r)},e.prototype.getInitialData=function(t,r){},e.prototype.appendData=function(t){var r=this.getRawData();r.appendData(t.data)},e.prototype.getData=function(t){var r=Hz(this);if(r){var i=r.context.data;return t==null||!i.getLinkedData?i:i.getLinkedData(t)}else return wv(this).data},e.prototype.getAllData=function(){var t=this.getData();return t&&t.getLinkedDataAll?t.getLinkedDataAll():[{data:t}]},e.prototype.setData=function(t){var r=Hz(this);if(r){var i=r.context;i.outputData=t,r!==this.dataTask&&(i.data=t)}wv(this).data=t},e.prototype.getEncode=function(){var t=this.get("encode",!0);if(t)return ii(t)},e.prototype.getSourceManager=function(){return wv(this).sourceManager},e.prototype.getSource=function(){return this.getSourceManager().getSource()},e.prototype.getRawData=function(){return wv(this).dataBeforeProcessed},e.prototype.getColorBy=function(){var t=this.get("colorBy");return t||"series"},e.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},e.prototype.getBaseAxis=function(){var t=this.coordinateSystem;return t&&t.getBaseAxis&&t.getBaseAxis()},e.prototype.formatTooltip=function(t,r,i){return yPe({series:this,dataIndex:t,multipleSeries:r})},e.prototype.isAnimationEnabled=function(){var t=this.ecModel;if(gi.node&&!(t&&t.ssr))return!1;var r=this.getShallow("animation");return r&&this.getData().count()>this.getShallow("animationThreshold")&&(r=!1),!!r},e.prototype.restoreData=function(){this.dataTask.dirty()},e.prototype.getColorFromPalette=function(t,r,i){var s=this.ecModel,o=xG.prototype.getColorFromPalette.call(this,t,r,i);return o||(o=s.getColorFromPalette(t,r,i)),o},e.prototype.coordDimToDataDim=function(t){return this.getRawData().mapDimensionsAll(t)},e.prototype.getProgressive=function(){return this.get("progressive")},e.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},e.prototype.select=function(t,r){this._innerSelect(this.getData(r),t)},e.prototype.unselect=function(t,r){var i=this.option.selectedMap;if(i){var s=this.option.selectedMode,o=this.getData(r);if(s==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var l=0;l<t.length;l++){var a=t[l],h=iI(o,a);i[h]=!1,this._selectedDataIndicesMap[h]=-1}}},e.prototype.toggleSelect=function(t,r){for(var i=[],s=0;s<t.length;s++)i[0]=t[s],this.isSelected(t[s],r)?this.unselect(i,r):this.select(i,r)},e.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var t=this._selectedDataIndicesMap,r=aa(t),i=[],s=0;s<r.length;s++){var o=t[r[s]];o>=0&&i.push(o)}return i},e.prototype.isSelected=function(t,r){var i=this.option.selectedMap;if(!i)return!1;var s=this.getData(r);return(i==="all"||i[iI(s,t)])&&!s.getItemModel(t).get(["select","disabled"])},e.prototype.isUniversalTransitionEnabled=function(){if(this[gR])return!0;var t=this.option.universalTransition;return t?t===!0?!0:t&&t.enabled:!1},e.prototype._innerSelect=function(t,r){var i,s,o=this.option,l=o.selectedMode,a=r.length;if(!(!l||!a)){if(l==="series")o.selectedMap="all";else if(l==="multiple"){$r(o.selectedMap)||(o.selectedMap={});for(var h=o.selectedMap,f=0;f<a;f++){var p=r[f],v=iI(t,p);h[v]=!0,this._selectedDataIndicesMap[v]=t.getRawIndex(p)}}else if(l==="single"||l===!0){var y=r[a-1],v=iI(t,y);o.selectedMap=(i={},i[v]=!0,i),this._selectedDataIndicesMap=(s={},s[v]=t.getRawIndex(y),s)}}},e.prototype._initSelectedMapFromData=function(t){if(!this.option.selectedMap){var r=[];t.hasItemOption&&t.each(function(i){var s=t.getRawDataItem(i);s&&s.selected&&r.push(i)}),r.length>0&&this._innerSelect(t,r)}},e.registerClass=function(t){return as.registerClass(t)},e.protoInitialize=function(){var t=e.prototype;t.type="series.__base__",t.seriesIndex=0,t.ignoreStyleOnData=!1,t.hasSymbolVisual=!1,t.defaultSymbol="circle",t.visualStyleAccessPath="itemStyle",t.visualDrawType="fill"}(),e}(as);od(ed,$Re);od(ed,xG);Jie(ed,as);function Zq(n){var e=n.name;J6(n)||(n.name=bPe(n)||e)}function bPe(n){var e=n.getRawData(),t=e.mapDimensionsAll("seriesName"),r=[];return it(t,function(i){var s=e.getDimensionInfo(i);s.displayName&&r.push(s.displayName)}),r.join(" ")}function wPe(n){return n.model.getRawData().count()}function SPe(n){var e=n.model;return e.setData(e.getRawData().cloneShallow()),APe}function APe(n,e){e.outputData&&n.end>e.outputData.count()&&e.model.getRawData().cloneShallow(e.outputData)}function Yq(n,e){it($Me(n.CHANGABLE_METHODS,n.DOWNSAMPLE_METHODS),function(t){n.wrapMethod(t,_s(TPe,e))})}function TPe(n,e){var t=Hz(n);return t&&t.setOutputEnd((e||this).count()),e}function Hz(n){var e=(n.ecModel||{}).scheduler,t=e&&e.getPipeline(n.uid);if(t){var r=t.currentTask;if(r){var i=r.agentStubMap;i&&(r=i.get(n.uid))}return r}}var Dc=function(){function n(){this.group=new go,this.uid=bE("viewComponent")}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,i){},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,i){},n.prototype.updateLayout=function(e,t,r,i){},n.prototype.updateVisual=function(e,t,r,i){},n.prototype.toggleBlurSeries=function(e,t,r){},n.prototype.eachRendered=function(e){var t=this.group;t&&t.traverse(e)},n}();eG(Dc);XD(Dc);function MG(){var n=qs();return function(e){var t=n(e),r=e.pipelineContext,i=!!t.large,s=!!t.progressiveRender,o=t.large=!!(r&&r.large),l=t.progressiveRender=!!(r&&r.progressiveRender);return(i!==o||s!==l)&&"reset"}}var kae=qs(),MPe=MG(),Ph=function(){function n(){this.group=new go,this.uid=bE("viewChart"),this.renderTask=xT({plan:EPe,reset:CPe}),this.renderTask.context={view:this}}return n.prototype.init=function(e,t){},n.prototype.render=function(e,t,r,i){},n.prototype.highlight=function(e,t,r,i){var s=e.getData(i&&i.dataType);s&&Jq(s,i,"emphasis")},n.prototype.downplay=function(e,t,r,i){var s=e.getData(i&&i.dataType);s&&Jq(s,i,"normal")},n.prototype.remove=function(e,t){this.group.removeAll()},n.prototype.dispose=function(e,t){},n.prototype.updateView=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.updateLayout=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.updateVisual=function(e,t,r,i){this.render(e,t,r,i)},n.prototype.eachRendered=function(e){aB(this.group,e)},n.markUpdateMethod=function(e,t){kae(e).updateMethod=t},n.protoInitialize=function(){var e=n.prototype;e.type="chart"}(),n}();function Kq(n,e,t){n&&Lz(n)&&(e==="emphasis"?cw:uw)(n,t)}function Jq(n,e,t){var r=lx(n,e),i=e&&e.highlightKey!=null?W2e(e.highlightKey):null;r!=null?it(mo(r),function(s){Kq(n.getItemGraphicEl(s),t,i)}):n.eachItemGraphicEl(function(s){Kq(s,t,i)})}eG(Ph);XD(Ph);function EPe(n){return MPe(n.model)}function CPe(n){var e=n.model,t=n.ecModel,r=n.api,i=n.payload,s=e.pipelineContext.progressiveRender,o=n.view,l=i&&kae(i).updateMethod,a=s?"incrementalPrepareRender":l&&o[l]?l:"render";return a!=="render"&&o[a](e,t,r,i),IPe[a]}var IPe={incrementalPrepareRender:{progress:function(n,e){e.view.incrementalRender(n,e.model,e.ecModel,e.api,e.payload)}},render:{forceFirstProgress:!0,progress:function(n,e){e.view.render(e.model,e.ecModel,e.api,e.payload)}}},QP="\0__throttleOriginMethod",Qq="\0__throttleRate",eZ="\0__throttleType";function EG(n,e,t){var r,i=0,s=0,o=null,l,a,h,f;e=e||0;function p(){s=new Date().getTime(),o=null,n.apply(a,h||[])}var v=function(){for(var y=[],S=0;S<arguments.length;S++)y[S]=arguments[S];r=new Date().getTime(),a=this,h=y;var C=f||e,M=f||t;f=null,l=r-(M?i:s)-C,clearTimeout(o),M?o=setTimeout(p,C):l>=0?p():o=setTimeout(p,-l),i=r};return v.clear=function(){o&&(clearTimeout(o),o=null)},v.debounceNextCall=function(y){f=y},v}function Oae(n,e,t,r){var i=n[e];if(i){var s=i[QP]||i,o=i[eZ],l=i[Qq];if(l!==t||o!==r){if(t==null||!r)return n[e]=s;i=n[e]=EG(s,t,r==="debounce"),i[QP]=s,i[eZ]=r,i[Qq]=t}return i}}function jz(n,e){var t=n[e];t&&t[QP]&&(t.clear&&t.clear(),n[e]=t[QP])}var tZ=qs(),nZ={itemStyle:gM(Wse,!0),lineStyle:gM(jse,!0)},RPe={lineStyle:"stroke",itemStyle:"fill"};function Fae(n,e){var t=n.visualStyleMapper||nZ[e];return t||(console.warn("Unknown style type '"+e+"'."),nZ.itemStyle)}function Nae(n,e){var t=n.visualDrawType||RPe[e];return t||(console.warn("Unknown style type '"+e+"'."),"fill")}var PPe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",i=n.getModel(r),s=Fae(n,r),o=s(i),l=i.getShallow("decal");l&&(t.setVisual("decal",l),l.dirty=!0);var a=Nae(n,r),h=o[a],f=ci(h)?h:null,p=o.fill==="auto"||o.stroke==="auto";if(!o[a]||f||p){var v=n.getColorFromPalette(n.name,null,e.getSeriesCount());o[a]||(o[a]=v,t.setVisual("colorFromPalette",!0)),o.fill=o.fill==="auto"||ci(o.fill)?v:o.fill,o.stroke=o.stroke==="auto"||ci(o.stroke)?v:o.stroke}if(t.setVisual("style",o),t.setVisual("drawType",a),!e.isSeriesFiltered(n)&&f)return t.setVisual("colorFromPalette",!1),{dataEach:function(y,S){var C=n.getDataParams(S),M=Jn({},o);M[a]=f(C),y.setItemVisual(S,"style",M)}}}},sA=new Ra,LPe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!(n.ignoreStyleOnData||e.isSeriesFiltered(n))){var t=n.getData(),r=n.visualStyleAccessPath||"itemStyle",i=Fae(n,r),s=t.getVisual("drawType");return{dataEach:t.hasItemOption?function(o,l){var a=o.getRawDataItem(l);if(a&&a[r]){sA.option=a[r];var h=i(sA),f=o.ensureUniqueItemVisual(l,"style");Jn(f,h),sA.option.decal&&(o.setItemVisual(l,"decal",sA.option.decal),sA.option.decal.dirty=!0),s in h&&o.setItemVisual(l,"colorFromPalette",!1)}}:null}}}},DPe={performRawSeries:!0,overallReset:function(n){var e=ii();n.eachSeries(function(t){var r=t.getColorBy();if(!t.isColorBySeries()){var i=t.type+"-"+r,s=e.get(i);s||(s={},e.set(i,s)),tZ(t).scope=s}}),n.eachSeries(function(t){if(!(t.isColorBySeries()||n.isSeriesFiltered(t))){var r=t.getRawData(),i={},s=t.getData(),o=tZ(t).scope,l=t.visualStyleAccessPath||"itemStyle",a=Nae(t,l);s.each(function(h){var f=s.getRawIndex(h);i[f]=h}),r.each(function(h){var f=i[h],p=s.getItemVisual(f,"colorFromPalette");if(p){var v=s.ensureUniqueItemVisual(f,"style"),y=r.getName(h)||h+"",S=r.count();v[a]=t.getColorFromPalette(y,o,S)}})}})}},sI=Math.PI;function BPe(n,e){e=e||{},ti(e,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var t=new go,r=new Ha({style:{fill:e.maskColor},zlevel:e.zlevel,z:1e4});t.add(r);var i=new Io({style:{text:e.text,fill:e.textColor,fontSize:e.fontSize,fontWeight:e.fontWeight,fontStyle:e.fontStyle,fontFamily:e.fontFamily},zlevel:e.zlevel,z:10001}),s=new Ha({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:e.zlevel,z:10001});t.add(s);var o;return e.showSpinner&&(o=new tB({shape:{startAngle:-sI/2,endAngle:-sI/2+.1,r:e.spinnerRadius},style:{stroke:e.color,lineCap:"round",lineWidth:e.lineWidth},zlevel:e.zlevel,z:10001}),o.animateShape(!0).when(1e3,{endAngle:sI*3/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:sI*3/2}).delay(300).start("circularInOut"),t.add(o)),t.resize=function(){var l=i.getBoundingRect().width,a=e.showSpinner?e.spinnerRadius:0,h=(n.getWidth()-a*2-(e.showSpinner&&l?10:0)-l)/2-(e.showSpinner&&l?0:5+l/2)+(e.showSpinner?0:l/2)+(l?0:a),f=n.getHeight()/2;e.showSpinner&&o.setShape({cx:h,cy:f}),s.setShape({x:h-a,y:f-a,width:a*2,height:a*2}),r.setShape({x:0,y:0,width:n.getWidth(),height:n.getHeight()})},t.resize(),t}var zae=function(){function n(e,t,r,i){this._stageTaskMap=ii(),this.ecInstance=e,this.api=t,r=this._dataProcessorHandlers=r.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=r.concat(i)}return n.prototype.restoreData=function(e,t){e.restoreData(t),this._stageTaskMap.each(function(r){var i=r.overallTask;i&&i.dirty()})},n.prototype.getPerformArgs=function(e,t){if(e.__pipeline){var r=this._pipelineMap.get(e.__pipeline.id),i=r.context,s=!t&&r.progressiveEnabled&&(!i||i.progressiveRender)&&e.__idxInPipeline>r.blockIndex,o=s?r.step:null,l=i&&i.modDataCount,a=l!=null?Math.ceil(l/o):null;return{step:o,modBy:a,modDataCount:l}}},n.prototype.getPipeline=function(e){return this._pipelineMap.get(e)},n.prototype.updateStreamModes=function(e,t){var r=this._pipelineMap.get(e.uid),i=e.getData(),s=i.count(),o=r.progressiveEnabled&&t.incrementalPrepareRender&&s>=r.threshold,l=e.get("large")&&s>=e.get("largeThreshold"),a=e.get("progressiveChunkMode")==="mod"?s:null;e.pipelineContext=r.context={progressiveRender:o,modDataCount:a,large:l}},n.prototype.restorePipelines=function(e){var t=this,r=t._pipelineMap=ii();e.eachSeries(function(i){var s=i.getProgressive(),o=i.uid;r.set(o,{id:o,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:s&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(s||700),count:0}),t._pipe(i,i.dataTask)})},n.prototype.prepareStageTasks=function(){var e=this._stageTaskMap,t=this.api.getModel(),r=this.api;it(this._allHandlers,function(i){var s=e.get(i.uid)||e.set(i.uid,{}),o="";vp(!(i.reset&&i.overallReset),o),i.reset&&this._createSeriesStageTask(i,s,t,r),i.overallReset&&this._createOverallStageTask(i,s,t,r)},this)},n.prototype.prepareView=function(e,t,r,i){var s=e.renderTask,o=s.context;o.model=t,o.ecModel=r,o.api=i,s.__block=!e.incrementalPrepareRender,this._pipe(t,s)},n.prototype.performDataProcessorTasks=function(e,t){this._performStageTasks(this._dataProcessorHandlers,e,t,{block:!0})},n.prototype.performVisualTasks=function(e,t,r){this._performStageTasks(this._visualHandlers,e,t,r)},n.prototype._performStageTasks=function(e,t,r,i){i=i||{};var s=!1,o=this;it(e,function(a,h){if(!(i.visualType&&i.visualType!==a.visualType)){var f=o._stageTaskMap.get(a.uid),p=f.seriesTaskMap,v=f.overallTask;if(v){var y,S=v.agentStubMap;S.each(function(M){l(i,M)&&(M.dirty(),y=!0)}),y&&v.dirty(),o.updatePayload(v,r);var C=o.getPerformArgs(v,i.block);S.each(function(M){M.perform(C)}),v.perform(C)&&(s=!0)}else p&&p.each(function(M,E){l(i,M)&&M.dirty();var L=o.getPerformArgs(M,i.block);L.skip=!a.performRawSeries&&t.isSeriesFiltered(M.context.model),o.updatePayload(M,r),M.perform(L)&&(s=!0)})}});function l(a,h){return a.setDirty&&(!a.dirtyMap||a.dirtyMap.get(h.__pipeline.id))}this.unfinished=s||this.unfinished},n.prototype.performSeriesTasks=function(e){var t;e.eachSeries(function(r){t=r.dataTask.perform()||t}),this.unfinished=t||this.unfinished},n.prototype.plan=function(){this._pipelineMap.each(function(e){var t=e.tail;do{if(t.__block){e.blockIndex=t.__idxInPipeline;break}t=t.getUpstream()}while(t)})},n.prototype.updatePayload=function(e,t){t!=="remain"&&(e.context.payload=t)},n.prototype._createSeriesStageTask=function(e,t,r,i){var s=this,o=t.seriesTaskMap,l=t.seriesTaskMap=ii(),a=e.seriesType,h=e.getTargetSeries;e.createOnAllSeries?r.eachRawSeries(f):a?r.eachRawSeriesByType(a,f):h&&h(r,i).each(f);function f(p){var v=p.uid,y=l.set(v,o&&o.get(v)||xT({plan:zPe,reset:UPe,count:VPe}));y.context={model:p,ecModel:r,api:i,useClearVisual:e.isVisual&&!e.isLayout,plan:e.plan,reset:e.reset,scheduler:s},s._pipe(p,y)}},n.prototype._createOverallStageTask=function(e,t,r,i){var s=this,o=t.overallTask=t.overallTask||xT({reset:kPe});o.context={ecModel:r,api:i,overallReset:e.overallReset,scheduler:s};var l=o.agentStubMap,a=o.agentStubMap=ii(),h=e.seriesType,f=e.getTargetSeries,p=!0,v=!1,y="";vp(!e.createOnAllSeries,y),h?r.eachRawSeriesByType(h,S):f?f(r,i).each(S):(p=!1,it(r.getSeries(),S));function S(C){var M=C.uid,E=a.set(M,l&&l.get(M)||(v=!0,xT({reset:OPe,onDirty:NPe})));E.context={model:C,overallProgress:p},E.agent=o,E.__block=p,s._pipe(C,E)}v&&o.dirty()},n.prototype._pipe=function(e,t){var r=e.uid,i=this._pipelineMap.get(r);!i.head&&(i.head=t),i.tail&&i.tail.pipe(t),i.tail=t,t.__idxInPipeline=i.count++,t.__pipeline=i},n.wrapStageHandler=function(e,t){return ci(e)&&(e={overallReset:e,seriesType:HPe(e)}),e.uid=bE("stageHandler"),t&&(e.visualType=t),e},n}();function kPe(n){n.overallReset(n.ecModel,n.api,n.payload)}function OPe(n){return n.overallProgress&&FPe}function FPe(){this.agent.dirty(),this.getDownstream().dirty()}function NPe(){this.agent&&this.agent.dirty()}function zPe(n){return n.plan?n.plan(n.model,n.ecModel,n.api,n.payload):null}function UPe(n){n.useClearVisual&&n.data.clearAllVisual();var e=n.resetDefines=mo(n.reset(n.model,n.ecModel,n.api,n.payload));return e.length>1?xr(e,function(t,r){return Uae(r)}):GPe}var GPe=Uae(0);function Uae(n){return function(e,t){var r=t.data,i=t.resetDefines[n];if(i&&i.dataEach)for(var s=e.start;s<e.end;s++)i.dataEach(r,s);else i&&i.progress&&i.progress(e,r)}}function VPe(n){return n.data.count()}function HPe(n){eL=null;try{n(SM,Gae)}catch{}return eL}var SM={},Gae={},eL;Vae(SM,bG);Vae(Gae,fae);SM.eachSeriesByType=SM.eachRawSeriesByType=function(n){eL=n};SM.eachComponent=function(n){n.mainType==="series"&&n.subType&&(eL=n.subType)};function Vae(n,e){for(var t in e.prototype)n[t]=Rc}var rZ=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const jPe={color:rZ,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],rZ]};var yc="#B9B8CE",iZ="#100C2A",aI=function(){return{axisLine:{lineStyle:{color:yc}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},sZ=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],Hae={darkMode:!0,color:sZ,backgroundColor:iZ,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:yc}},textStyle:{color:yc},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:yc}},dataZoom:{borderColor:"#71708A",textStyle:{color:yc},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:yc}},timeline:{lineStyle:{color:yc},label:{color:yc},controlStyle:{color:yc,borderColor:yc}},calendar:{itemStyle:{color:iZ},dayLabel:{color:yc},monthLabel:{color:yc},yearLabel:{color:yc}},timeAxis:aI(),logAxis:aI(),valueAxis:aI(),categoryAxis:aI(),line:{symbol:"circle"},graph:{color:sZ},gauge:{title:{color:yc},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:yc},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};Hae.categoryAxis.splitLine.show=!1;var WPe=function(){function n(){}return n.prototype.normalizeQuery=function(e){var t={},r={},i={};if(Dr(e)){var s=ip(e);t.mainType=s.main||null,t.subType=s.sub||null}else{var o=["Index","Name","Id"],l={name:1,dataIndex:1,dataType:1};it(e,function(a,h){for(var f=!1,p=0;p<o.length;p++){var v=o[p],y=h.lastIndexOf(v);if(y>0&&y===h.length-v.length){var S=h.slice(0,y);S!=="data"&&(t.mainType=S,t[v.toLowerCase()]=a,f=!0)}}l.hasOwnProperty(h)&&(r[h]=a,f=!0),f||(i[h]=a)})}return{cptQuery:t,dataQuery:r,otherQuery:i}},n.prototype.filter=function(e,t){var r=this.eventInfo;if(!r)return!0;var i=r.targetEl,s=r.packedEvent,o=r.model,l=r.view;if(!o||!l)return!0;var a=t.cptQuery,h=t.dataQuery;return f(a,o,"mainType")&&f(a,o,"subType")&&f(a,o,"index","componentIndex")&&f(a,o,"name")&&f(a,o,"id")&&f(h,s,"name")&&f(h,s,"dataIndex")&&f(h,s,"dataType")&&(!l.filterForExposedEvent||l.filterForExposedEvent(e,t.otherQuery,i,s));function f(p,v,y,S){return p[y]==null||v[S||y]===p[y]}},n.prototype.afterTrigger=function(){this.eventInfo=null},n}(),Wz=["symbol","symbolSize","symbolRotate","symbolOffset"],aZ=Wz.concat(["symbolKeepAspect"]),$Pe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){var t=n.getData();if(n.legendIcon&&t.setVisual("legendIcon",n.legendIcon),!n.hasSymbolVisual)return;for(var r={},i={},s=!1,o=0;o<Wz.length;o++){var l=Wz[o],a=n.get(l);ci(a)?(s=!0,i[l]=a):r[l]=a}if(r.symbol=r.symbol||n.defaultSymbol,t.setVisual(Jn({legendIcon:n.legendIcon||r.symbol,symbolKeepAspect:n.get("symbolKeepAspect")},r)),e.isSeriesFiltered(n))return;var h=aa(i);function f(p,v){for(var y=n.getRawValue(v),S=n.getDataParams(v),C=0;C<h.length;C++){var M=h[C];p.setItemVisual(v,M,i[M](y,S))}}return{dataEach:s?f:null}}},XPe={createOnAllSeries:!0,performRawSeries:!0,reset:function(n,e){if(!n.hasSymbolVisual||e.isSeriesFiltered(n))return;var t=n.getData();function r(i,s){for(var o=i.getItemModel(s),l=0;l<aZ.length;l++){var a=aZ[l],h=o.getShallow(a,!0);h!=null&&i.setItemVisual(s,a,h)}}return{dataEach:t.hasItemOption?r:null}}};function qPe(n,e,t){switch(t){case"color":var r=n.getItemVisual(e,"style");return r[n.getVisual("drawType")];case"opacity":return n.getItemVisual(e,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getItemVisual(e,t)}}function ZPe(n,e){switch(e){case"color":var t=n.getVisual("style");return t[n.getVisual("drawType")];case"opacity":return n.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return n.getVisual(e)}}function YPe(n,e){function t(r,i){var s=[];return r.eachComponent({mainType:"series",subType:n,query:i},function(o){s.push(o.seriesIndex)}),s}it([[n+"ToggleSelect","toggleSelect"],[n+"Select","select"],[n+"UnSelect","unselect"]],function(r){e(r[0],function(i,s,o){i=Jn({},i),o.dispatchAction(Jn(i,{type:r[1],seriesIndex:t(s,i)}))})})}function U1(n,e,t,r,i){var s=n+e;t.isSilent(s)||r.eachComponent({mainType:"series",subType:"pie"},function(o){for(var l=o.seriesIndex,a=o.option.selectedMap,h=i.selected,f=0;f<h.length;f++)if(h[f].seriesIndex===l){var p=o.getData(),v=lx(p,i.fromActionPayload);t.trigger(s,{type:s,seriesId:o.id,name:fr(v)?p.getName(v[0]):p.getName(v),selected:Dr(a)?a:Jn({},a)})}})}function KPe(n,e,t){n.on("selectchanged",function(r){var i=t.getModel();r.isFromClick?(U1("map","selectchanged",e,i,r),U1("pie","selectchanged",e,i,r)):r.fromAction==="select"?(U1("map","selected",e,i,r),U1("pie","selected",e,i,r)):r.fromAction==="unselect"&&(U1("map","unselected",e,i,r),U1("pie","unselected",e,i,r))})}function NA(n,e,t){for(var r;n&&!(e(n)&&(r=n,t));)n=n.__hostTarget||n.parent;return r}var JPe=Math.round(Math.random()*9),QPe=typeof Object.defineProperty=="function",eLe=function(){function n(){this._id="__ec_inner_"+JPe++}return n.prototype.get=function(e){return this._guard(e)[this._id]},n.prototype.set=function(e,t){var r=this._guard(e);return QPe?Object.defineProperty(r,this._id,{value:t,enumerable:!1,configurable:!0}):r[this._id]=t,this},n.prototype.delete=function(e){return this.has(e)?(delete this._guard(e)[this._id],!0):!1},n.prototype.has=function(e){return!!this._guard(e)[this._id]},n.prototype._guard=function(e){if(e!==Object(e))throw TypeError("Value of WeakMap is not a non-null object.");return e},n}(),tLe=qi.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,i=e.width/2,s=e.height/2;n.moveTo(t,r-s),n.lineTo(t+i,r+s),n.lineTo(t-i,r+s),n.closePath()}}),nLe=qi.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(n,e){var t=e.cx,r=e.cy,i=e.width/2,s=e.height/2;n.moveTo(t,r-s),n.lineTo(t+i,r),n.lineTo(t,r+s),n.lineTo(t-i,r),n.closePath()}}),rLe=qi.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.x,r=e.y,i=e.width/5*3,s=Math.max(i,e.height),o=i/2,l=o*o/(s-o),a=r-s+o+l,h=Math.asin(l/o),f=Math.cos(h)*o,p=Math.sin(h),v=Math.cos(h),y=o*.6,S=o*.7;n.moveTo(t-f,a+l),n.arc(t,a,o,Math.PI-h,Math.PI*2+h),n.bezierCurveTo(t+f-p*y,a+l+v*y,t,r-S,t,r),n.bezierCurveTo(t,r-S,t-f+p*y,a+l+v*y,t-f,a+l),n.closePath()}}),iLe=qi.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(n,e){var t=e.height,r=e.width,i=e.x,s=e.y,o=r/3*2;n.moveTo(i,s),n.lineTo(i+o,s+t),n.lineTo(i,s+t/4*3),n.lineTo(i-o,s+t),n.lineTo(i,s),n.closePath()}}),sLe={line:Hf,rect:Ha,roundRect:Ha,square:Ha,circle:QD,diamond:nLe,pin:rLe,arrow:iLe,triangle:tLe},aLe={line:function(n,e,t,r,i){i.x1=n,i.y1=e+r/2,i.x2=n+t,i.y2=e+r/2},rect:function(n,e,t,r,i){i.x=n,i.y=e,i.width=t,i.height=r},roundRect:function(n,e,t,r,i){i.x=n,i.y=e,i.width=t,i.height=r,i.r=Math.min(t,r)/4},square:function(n,e,t,r,i){var s=Math.min(t,r);i.x=n,i.y=e,i.width=s,i.height=s},circle:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.r=Math.min(t,r)/2},diamond:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.width=t,i.height=r},pin:function(n,e,t,r,i){i.x=n+t/2,i.y=e+r/2,i.width=t,i.height=r},arrow:function(n,e,t,r,i){i.x=n+t/2,i.y=e+r/2,i.width=t,i.height=r},triangle:function(n,e,t,r,i){i.cx=n+t/2,i.cy=e+r/2,i.width=t,i.height=r}},$z={};it(sLe,function(n,e){$z[e]=new n});var oLe=qi.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(n,e,t){var r=VP(n,e,t),i=this.shape;return i&&i.symbolType==="pin"&&e.position==="inside"&&(r.y=t.y+t.height*.4),r},buildPath:function(n,e,t){var r=e.symbolType;if(r!=="none"){var i=$z[r];i||(r="rect",i=$z[r]),aLe[r](e.x,e.y,e.width,e.height,i.shape),i.buildPath(n,i.shape,t)}}});function lLe(n,e){if(this.type!=="image"){var t=this.style;this.__isEmptyBrush?(t.stroke=n,t.fill=e||"#fff",t.lineWidth=2):this.shape.symbolType==="line"?t.stroke=n:t.fill=n,this.markRedraw()}}function dw(n,e,t,r,i,s,o){var l=n.indexOf("empty")===0;l&&(n=n.substr(5,1).toLowerCase()+n.substr(6));var a;return n.indexOf("image://")===0?a=Ose(n.slice(8),new cs(e,t,r,i),o?"center":"cover"):n.indexOf("path://")===0?a=cG(n.slice(7),{},new cs(e,t,r,i),o?"center":"cover"):a=new oLe({shape:{symbolType:n,x:e,y:t,width:r,height:i}}),a.__isEmptyBrush=l,a.setColor=lLe,s&&a.setColor(s),a}function cLe(n){return fr(n)||(n=[+n,+n]),[n[0]||0,n[1]||0]}function jae(n,e){if(n!=null)return fr(n)||(n=[n,n]),[ls(n[0],e[0])||0,ls(Ii(n[1],n[0]),e[1])||0]}function Iy(n){return isFinite(n)}function uLe(n,e,t){var r=e.x==null?0:e.x,i=e.x2==null?1:e.x2,s=e.y==null?0:e.y,o=e.y2==null?0:e.y2;e.global||(r=r*t.width+t.x,i=i*t.width+t.x,s=s*t.height+t.y,o=o*t.height+t.y),r=Iy(r)?r:0,i=Iy(i)?i:1,s=Iy(s)?s:0,o=Iy(o)?o:0;var l=n.createLinearGradient(r,s,i,o);return l}function hLe(n,e,t){var r=t.width,i=t.height,s=Math.min(r,i),o=e.x==null?.5:e.x,l=e.y==null?.5:e.y,a=e.r==null?.5:e.r;e.global||(o=o*r+t.x,l=l*i+t.y,a=a*s),o=Iy(o)?o:.5,l=Iy(l)?l:.5,a=a>=0&&Iy(a)?a:.5;var h=n.createRadialGradient(o,l,0,o,l,a);return h}function Xz(n,e,t){for(var r=e.type==="radial"?hLe(n,e,t):uLe(n,e,t),i=e.colorStops,s=0;s<i.length;s++)r.addColorStop(i[s].offset,i[s].color);return r}function fLe(n,e){if(n===e||!n&&!e)return!1;if(!n||!e||n.length!==e.length)return!0;for(var t=0;t<n.length;t++)if(n[t]!==e[t])return!0;return!1}function oI(n){return parseInt(n,10)}function lI(n,e,t){var r=["width","height"][e],i=["clientWidth","clientHeight"][e],s=["paddingLeft","paddingTop"][e],o=["paddingRight","paddingBottom"][e];if(t[r]!=null&&t[r]!=="auto")return parseFloat(t[r]);var l=document.defaultView.getComputedStyle(n);return(n[i]||oI(l[r])||oI(n.style[r]))-(oI(l[s])||0)-(oI(l[o])||0)|0}function dLe(n,e){return!n||n==="solid"||!(e>0)?null:n==="dashed"?[4*e,2*e]:n==="dotted"?[e]:Ps(n)?[n]:fr(n)?n:null}function Wae(n){var e=n.style,t=e.lineDash&&e.lineWidth>0&&dLe(e.lineDash,e.lineWidth),r=e.lineDashOffset;if(t){var i=e.strokeNoScale&&n.getLineScale?n.getLineScale():1;i&&i!==1&&(t=xr(t,function(s){return s/i}),r/=i)}return[t,r]}var pLe=new tg(!0);function tL(n){var e=n.stroke;return!(e==null||e==="none"||!(n.lineWidth>0))}function oZ(n){return typeof n=="string"&&n!=="none"}function nL(n){var e=n.fill;return e!=null&&e!=="none"}function lZ(n,e){if(e.fillOpacity!=null&&e.fillOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.fillOpacity*e.opacity,n.fill(),n.globalAlpha=t}else n.fill()}function cZ(n,e){if(e.strokeOpacity!=null&&e.strokeOpacity!==1){var t=n.globalAlpha;n.globalAlpha=e.strokeOpacity*e.opacity,n.stroke(),n.globalAlpha=t}else n.stroke()}function qz(n,e,t){var r=Qie(e.image,e.__image,t);if(qD(r)){var i=n.createPattern(r,e.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var s=new DOMMatrix;s.translateSelf(e.x||0,e.y||0),s.rotateSelf(0,0,(e.rotation||0)*XMe),s.scaleSelf(e.scaleX||1,e.scaleY||1),i.setTransform(s)}return i}}function mLe(n,e,t,r){var i,s=tL(t),o=nL(t),l=t.strokePercent,a=l<1,h=!e.path;(!e.silent||a)&&h&&e.createPathProxy();var f=e.path||pLe,p=e.__dirty;if(!r){var v=t.fill,y=t.stroke,S=o&&!!v.colorStops,C=s&&!!y.colorStops,M=o&&!!v.image,E=s&&!!y.image,L=void 0,k=void 0,H=void 0,X=void 0,Z=void 0;(S||C)&&(Z=e.getBoundingRect()),S&&(L=p?Xz(n,v,Z):e.__canvasFillGradient,e.__canvasFillGradient=L),C&&(k=p?Xz(n,y,Z):e.__canvasStrokeGradient,e.__canvasStrokeGradient=k),M&&(H=p||!e.__canvasFillPattern?qz(n,v,e):e.__canvasFillPattern,e.__canvasFillPattern=H),E&&(X=p||!e.__canvasStrokePattern?qz(n,y,e):e.__canvasStrokePattern,e.__canvasStrokePattern=H),S?n.fillStyle=L:M&&(H?n.fillStyle=H:o=!1),C?n.strokeStyle=k:E&&(X?n.strokeStyle=X:s=!1)}var Q=e.getGlobalScale();f.setScale(Q[0],Q[1],e.segmentIgnoreThreshold);var re,ie;n.setLineDash&&t.lineDash&&(i=Wae(e),re=i[0],ie=i[1]);var oe=!0;(h||p&rb)&&(f.setDPR(n.dpr),a?f.setContext(null):(f.setContext(n),oe=!1),f.reset(),e.buildPath(f,e.shape,r),f.toStatic(),e.pathUpdated()),oe&&f.rebuildPath(n,a?l:1),re&&(n.setLineDash(re),n.lineDashOffset=ie),r||(t.strokeFirst?(s&&cZ(n,t),o&&lZ(n,t)):(o&&lZ(n,t),s&&cZ(n,t))),re&&n.setLineDash([])}function gLe(n,e,t){var r=e.__image=Qie(t.image,e.__image,e,e.onload);if(!(!r||!qD(r))){var i=t.x||0,s=t.y||0,o=e.getWidth(),l=e.getHeight(),a=r.width/r.height;if(o==null&&l!=null?o=l*a:l==null&&o!=null?l=o/a:o==null&&l==null&&(o=r.width,l=r.height),t.sWidth&&t.sHeight){var h=t.sx||0,f=t.sy||0;n.drawImage(r,h,f,t.sWidth,t.sHeight,i,s,o,l)}else if(t.sx&&t.sy){var h=t.sx,f=t.sy,p=o-h,v=l-f;n.drawImage(r,h,f,p,v,i,s,o,l)}else n.drawImage(r,i,s,o,l)}}function vLe(n,e,t){var r,i=t.text;if(i!=null&&(i+=""),i){n.font=t.font||ox,n.textAlign=t.textAlign,n.textBaseline=t.textBaseline;var s=void 0,o=void 0;n.setLineDash&&t.lineDash&&(r=Wae(e),s=r[0],o=r[1]),s&&(n.setLineDash(s),n.lineDashOffset=o),t.strokeFirst?(tL(t)&&n.strokeText(i,t.x,t.y),nL(t)&&n.fillText(i,t.x,t.y)):(nL(t)&&n.fillText(i,t.x,t.y),tL(t)&&n.strokeText(i,t.x,t.y)),s&&n.setLineDash([])}}var uZ=["shadowBlur","shadowOffsetX","shadowOffsetY"],hZ=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function $ae(n,e,t,r,i){var s=!1;if(!r&&(t=t||{},e===t))return!1;if(r||e.opacity!==t.opacity){su(n,i),s=!0;var o=Math.max(Math.min(e.opacity,1),0);n.globalAlpha=isNaN(o)?Hy.opacity:o}(r||e.blend!==t.blend)&&(s||(su(n,i),s=!0),n.globalCompositeOperation=e.blend||Hy.blend);for(var l=0;l<uZ.length;l++){var a=uZ[l];(r||e[a]!==t[a])&&(s||(su(n,i),s=!0),n[a]=n.dpr*(e[a]||0))}return(r||e.shadowColor!==t.shadowColor)&&(s||(su(n,i),s=!0),n.shadowColor=e.shadowColor||Hy.shadowColor),s}function fZ(n,e,t,r,i){var s=AM(e,i.inHover),o=r?null:t&&AM(t,i.inHover)||{};if(s===o)return!1;var l=$ae(n,s,o,r,i);if((r||s.fill!==o.fill)&&(l||(su(n,i),l=!0),oZ(s.fill)&&(n.fillStyle=s.fill)),(r||s.stroke!==o.stroke)&&(l||(su(n,i),l=!0),oZ(s.stroke)&&(n.strokeStyle=s.stroke)),(r||s.opacity!==o.opacity)&&(l||(su(n,i),l=!0),n.globalAlpha=s.opacity==null?1:s.opacity),e.hasStroke()){var a=s.lineWidth,h=a/(s.strokeNoScale&&e.getLineScale?e.getLineScale():1);n.lineWidth!==h&&(l||(su(n,i),l=!0),n.lineWidth=h)}for(var f=0;f<hZ.length;f++){var p=hZ[f],v=p[0];(r||s[v]!==o[v])&&(l||(su(n,i),l=!0),n[v]=s[v]||p[1])}return l}function _Le(n,e,t,r,i){return $ae(n,AM(e,i.inHover),t&&AM(t,i.inHover),r,i)}function Xae(n,e){var t=e.transform,r=n.dpr||1;t?n.setTransform(r*t[0],r*t[1],r*t[2],r*t[3],r*t[4],r*t[5]):n.setTransform(r,0,0,r,0,0)}function yLe(n,e,t){for(var r=!1,i=0;i<n.length;i++){var s=n[i];r=r||s.isZeroArea(),Xae(e,s),e.beginPath(),s.buildPath(e,s.shape),e.clip()}t.allClipped=r}function xLe(n,e){return n&&e?n[0]!==e[0]||n[1]!==e[1]||n[2]!==e[2]||n[3]!==e[3]||n[4]!==e[4]||n[5]!==e[5]:!(!n&&!e)}var dZ=1,pZ=2,mZ=3,gZ=4;function bLe(n){var e=nL(n),t=tL(n);return!(n.lineDash||!(+e^+t)||e&&typeof n.fill!="string"||t&&typeof n.stroke!="string"||n.strokePercent<1||n.strokeOpacity<1||n.fillOpacity<1)}function su(n,e){e.batchFill&&n.fill(),e.batchStroke&&n.stroke(),e.batchFill="",e.batchStroke=""}function AM(n,e){return e&&n.__hoverStyle||n.style}function qae(n,e){Ry(n,e,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function Ry(n,e,t,r){var i=e.transform;if(!e.shouldBePainted(t.viewWidth,t.viewHeight,!1,!1)){e.__dirty&=~Bu,e.__isRendered=!1;return}var s=e.__clipPaths,o=t.prevElClipPaths,l=!1,a=!1;if((!o||fLe(s,o))&&(o&&o.length&&(su(n,t),n.restore(),a=l=!0,t.prevElClipPaths=null,t.allClipped=!1,t.prevEl=null),s&&s.length&&(su(n,t),n.save(),yLe(s,n,t),l=!0),t.prevElClipPaths=s),t.allClipped){e.__isRendered=!1;return}e.beforeBrush&&e.beforeBrush(),e.innerBeforeBrush();var h=t.prevEl;h||(a=l=!0);var f=e instanceof qi&&e.autoBatch&&bLe(e.style);l||xLe(i,h.transform)?(su(n,t),Xae(n,e)):f||su(n,t);var p=AM(e,t.inHover);e instanceof qi?(t.lastDrawType!==dZ&&(a=!0,t.lastDrawType=dZ),fZ(n,e,h,a,t),(!f||!t.batchFill&&!t.batchStroke)&&n.beginPath(),mLe(n,e,p,f),f&&(t.batchFill=p.fill||"",t.batchStroke=p.stroke||"")):e instanceof jP?(t.lastDrawType!==mZ&&(a=!0,t.lastDrawType=mZ),fZ(n,e,h,a,t),vLe(n,e,p)):e instanceof z0?(t.lastDrawType!==pZ&&(a=!0,t.lastDrawType=pZ),_Le(n,e,h,a,t),gLe(n,e,p)):e.getTemporalDisplayables&&(t.lastDrawType!==gZ&&(a=!0,t.lastDrawType=gZ),wLe(n,e,t)),f&&r&&su(n,t),e.innerAfterBrush(),e.afterBrush&&e.afterBrush(),t.prevEl=e,e.__dirty=0,e.__isRendered=!0}function wLe(n,e,t){var r=e.getDisplayables(),i=e.getTemporalDisplayables();n.save();var s={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:t.viewWidth,viewHeight:t.viewHeight,inHover:t.inHover},o,l;for(o=e.getCursor(),l=r.length;o<l;o++){var a=r[o];a.beforeBrush&&a.beforeBrush(),a.innerBeforeBrush(),Ry(n,a,s,o===l-1),a.innerAfterBrush(),a.afterBrush&&a.afterBrush(),s.prevEl=a}for(var h=0,f=i.length;h<f;h++){var a=i[h];a.beforeBrush&&a.beforeBrush(),a.innerBeforeBrush(),Ry(n,a,s,h===f-1),a.innerAfterBrush(),a.afterBrush&&a.afterBrush(),s.prevEl=a}e.clearTemporalDisplayables(),e.notClear=!0,n.restore()}var w3=new eLe,vZ=new pE(100),_Z=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function Zz(n,e){if(n==="none")return null;var t=e.getDevicePixelRatio(),r=e.getZr(),i=r.painter.type==="svg";n.dirty&&w3.delete(n);var s=w3.get(n);if(s)return s;var o=ti(n,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});o.backgroundColor==="none"&&(o.backgroundColor=null);var l={repeat:"repeat"};return a(l),l.rotation=o.rotation,l.scaleX=l.scaleY=i?1:1/t,w3.set(n,l),n.dirty=!1,l;function a(h){for(var f=[t],p=!0,v=0;v<_Z.length;++v){var y=o[_Z[v]];if(y!=null&&!fr(y)&&!Dr(y)&&!Ps(y)&&typeof y!="boolean"){p=!1;break}f.push(y)}var S;if(p){S=f.join(",")+(i?"-svg":"");var C=vZ.get(S);C&&(i?h.svgElement=C:h.image=C)}var M=Yae(o.dashArrayX),E=SLe(o.dashArrayY),L=Zae(o.symbol),k=ALe(M),H=Kae(E),X=!i&&Rw.createCanvas(),Z=i&&{tag:"g",attrs:{},key:"dcl",children:[]},Q=ie(),re;X&&(X.width=Q.width*t,X.height=Q.height*t,re=X.getContext("2d")),oe(),p&&vZ.put(S,X||Z),h.image=X,h.svgElement=Z,h.svgWidth=Q.width,h.svgHeight=Q.height;function ie(){for(var fe=1,Se=0,Ee=k.length;Se<Ee;++Se)fe=LX(fe,k[Se]);for(var Ie=1,Se=0,Ee=L.length;Se<Ee;++Se)Ie=LX(Ie,L[Se].length);fe*=Ie;var He=H*k.length*L.length;return{width:Math.max(1,Math.min(fe,o.maxTileWidth)),height:Math.max(1,Math.min(He,o.maxTileHeight))}}function oe(){re&&(re.clearRect(0,0,X.width,X.height),o.backgroundColor&&(re.fillStyle=o.backgroundColor,re.fillRect(0,0,X.width,X.height)));for(var fe=0,Se=0;Se<E.length;++Se)fe+=E[Se];if(fe<=0)return;for(var Ee=-H,Ie=0,He=0,Re=0;Ee<Q.height;){if(Ie%2===0){for(var st=He/2%L.length,_e=0,We=0,Ue=0;_e<Q.width*2;){for(var vt=0,Se=0;Se<M[Re].length;++Se)vt+=M[Re][Se];if(vt<=0)break;if(We%2===0){var xt=(1-o.symbolSize)*.5,Vt=_e+M[Re][We]*xt,lt=Ee+E[Ie]*xt,Ht=M[Re][We]*o.symbolSize,Qt=E[Ie]*o.symbolSize,rn=Ue/2%L[st].length;jn(Vt,lt,Ht,Qt,L[st][rn])}_e+=M[Re][We],++Ue,++We,We===M[Re].length&&(We=0)}++Re,Re===M.length&&(Re=0)}Ee+=E[Ie],++He,++Ie,Ie===E.length&&(Ie=0)}function jn(Bn,Tn,Le,qe,mn){var cn=i?1:t,St=dw(mn,Bn*cn,Tn*cn,Le*cn,qe*cn,o.color,o.symbolKeepAspect);if(i){var Jt=r.painter.renderOneToVNode(St);Jt&&Z.children.push(Jt)}else qae(re,St)}}}}function Zae(n){if(!n||n.length===0)return[["rect"]];if(Dr(n))return[[n]];for(var e=!0,t=0;t<n.length;++t)if(!Dr(n[t])){e=!1;break}if(e)return Zae([n]);for(var r=[],t=0;t<n.length;++t)Dr(n[t])?r.push([n[t]]):r.push(n[t]);return r}function Yae(n){if(!n||n.length===0)return[[0,0]];if(Ps(n)){var e=Math.ceil(n);return[[e,e]]}for(var t=!0,r=0;r<n.length;++r)if(!Ps(n[r])){t=!1;break}if(t)return Yae([n]);for(var i=[],r=0;r<n.length;++r)if(Ps(n[r])){var e=Math.ceil(n[r]);i.push([e,e])}else{var e=xr(n[r],function(l){return Math.ceil(l)});e.length%2===1?i.push(e.concat(e)):i.push(e)}return i}function SLe(n){if(!n||typeof n=="object"&&n.length===0)return[0,0];if(Ps(n)){var e=Math.ceil(n);return[e,e]}var t=xr(n,function(r){return Math.ceil(r)});return n.length%2?t.concat(t):t}function ALe(n){return xr(n,function(e){return Kae(e)})}function Kae(n){for(var e=0,t=0;t<n.length;++t)e+=n[t];return n.length%2===1?e*2:e}function TLe(n,e){n.eachRawSeries(function(t){if(!n.isSeriesFiltered(t)){var r=t.getData();r.hasItemVisual()&&r.each(function(o){var l=r.getItemVisual(o,"decal");if(l){var a=r.ensureUniqueItemVisual(o,"style");a.decal=Zz(l,e)}});var i=r.getVisual("decal");if(i){var s=r.getVisual("style");s.decal=Zz(i,e)}}})}var Bf=new ld,Jae={};function MLe(n,e){Jae[n]=e}function ELe(n){return Jae[n]}var CLe=1,ILe=800,RLe=900,PLe=1e3,LLe=2e3,DLe=5e3,Qae=1e3,BLe=1100,CG=2e3,eoe=3e3,kLe=4e3,vB=4500,OLe=4600,FLe=5e3,NLe=6e3,toe=7e3,zLe={PROCESSOR:{FILTER:PLe,SERIES_FILTER:ILe,STATISTIC:DLe},VISUAL:{LAYOUT:Qae,PROGRESSIVE_LAYOUT:BLe,GLOBAL:CG,CHART:eoe,POST_CHART_LAYOUT:OLe,COMPONENT:kLe,BRUSH:FLe,CHART_ITEM:vB,ARIA:NLe,DECAL:toe}},Ul="__flagInMainProcess",Qc="__pendingUpdate",S3="__needsUpdateStatus",yZ=/^[a-zA-Z0-9_]+$/,A3="__connectUpdateStatus",xZ=0,ULe=1,GLe=2;function noe(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(this.isDisposed()){this.id;return}return ioe(this,n,e)}}function roe(n){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return ioe(this,n,e)}}function ioe(n,e,t){return t[0]=t[0]&&t[0].toLowerCase(),ld.prototype[e].apply(n,t)}var soe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(ld),aoe=soe.prototype;aoe.on=roe("on");aoe.off=roe("off");var G1,T3,cI,Sv,M3,E3,C3,aA,oA,bZ,wZ,I3,SZ,uI,AZ,ooe,hh,TZ,loe=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this,new WPe)||this;s._chartsViews=[],s._chartsMap={},s._componentsViews=[],s._componentsMap={},s._pendingActions=[],i=i||{},Dr(r)&&(r=coe[r]),s._dom=t;var o="canvas",l="auto",a=!1;i.ssr;var h=s._zr=RX(t,{renderer:i.renderer||o,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:Ii(i.useDirtyRect,a),useCoarsePointer:Ii(i.useCoarsePointer,l),pointerSize:i.pointerSize});s._ssr=i.ssr,s._throttledZrFlush=EG(Us(h.flush,h),17),r=yi(r),r&&pae(r,!0),s._theme=r,s._locale=KIe(i.locale||Xse),s._coordSysMgr=new wG;var f=s._api=AZ(s);function p(v,y){return v.__prio-y.__prio}return sR(iL,p),sR(Yz,p),s._scheduler=new zae(s,f,Yz,iL),s._messageCenter=new soe,s._initEvents(),s.resize=Us(s.resize,s),h.animation.on("frame",s._onframe,s),bZ(h,s),wZ(h,s),BP(s),s}return e.prototype._onframe=function(){if(!this._disposed){TZ(this);var t=this._scheduler;if(this[Qc]){var r=this[Qc].silent;this[Ul]=!0;try{G1(this),Sv.update.call(this,null,this[Qc].updateParams)}catch(a){throw this[Ul]=!1,this[Qc]=null,a}this._zr.flush(),this[Ul]=!1,this[Qc]=null,aA.call(this,r),oA.call(this,r)}else if(t.unfinished){var i=CLe,s=this._model,o=this._api;t.unfinished=!1;do{var l=+new Date;t.performSeriesTasks(s),t.performDataProcessorTasks(s),E3(this,s),t.performVisualTasks(s),uI(this,this._model,o,"remain",{}),i-=+new Date-l}while(i>0&&t.unfinished);t.unfinished||this._zr.flush()}}},e.prototype.getDom=function(){return this._dom},e.prototype.getId=function(){return this.id},e.prototype.getZr=function(){return this._zr},e.prototype.isSSR=function(){return this._ssr},e.prototype.setOption=function(t,r,i){if(!this[Ul]){if(this._disposed){this.id;return}var s,o,l;if($r(r)&&(i=r.lazyUpdate,s=r.silent,o=r.replaceMerge,l=r.transition,r=r.notMerge),this[Ul]=!0,!this._model||r){var a=new TRe(this._api),h=this._theme,f=this._model=new bG;f.scheduler=this._scheduler,f.ssr=this._ssr,f.init(null,null,null,h,this._locale,a)}this._model.setOption(t,{replaceMerge:o},Kz);var p={seriesTransition:l,optionChanged:!0};if(i)this[Qc]={silent:s,updateParams:p},this[Ul]=!1,this.getZr().wakeUp();else{try{G1(this),Sv.update.call(this,null,p)}catch(v){throw this[Qc]=null,this[Ul]=!1,v}this._ssr||this._zr.flush(),this[Qc]=null,this[Ul]=!1,aA.call(this,s),oA.call(this,s)}}},e.prototype.setTheme=function(){},e.prototype.getModel=function(){return this._model},e.prototype.getOption=function(){return this._model&&this._model.getOption()},e.prototype.getWidth=function(){return this._zr.getWidth()},e.prototype.getHeight=function(){return this._zr.getHeight()},e.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||gi.hasGlobalWindow&&window.devicePixelRatio||1},e.prototype.getRenderedCanvas=function(t){return this.renderToCanvas(t)},e.prototype.renderToCanvas=function(t){t=t||{};var r=this._zr.painter;return r.getRenderedCanvas({backgroundColor:t.backgroundColor||this._model.get("backgroundColor"),pixelRatio:t.pixelRatio||this.getDevicePixelRatio()})},e.prototype.renderToSVGString=function(t){t=t||{};var r=this._zr.painter;return r.renderToString({useViewBox:t.useViewBox})},e.prototype.getSvgDataURL=function(){if(gi.svgSupported){var t=this._zr,r=t.storage.getDisplayList();return it(r,function(i){i.stopAnimation(null,!0)}),t.painter.toDataURL()}},e.prototype.getDataURL=function(t){if(this._disposed){this.id;return}t=t||{};var r=t.excludeComponents,i=this._model,s=[],o=this;it(r,function(a){i.eachComponent({mainType:a},function(h){var f=o._componentsMap[h.__viewId];f.group.ignore||(s.push(f),f.group.ignore=!0)})});var l=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(t).toDataURL("image/"+(t&&t.type||"png"));return it(s,function(a){a.group.ignore=!1}),l},e.prototype.getConnectedDataURL=function(t){if(this._disposed){this.id;return}var r=t.type==="svg",i=this.group,s=Math.min,o=Math.max,l=1/0;if(MZ[i]){var a=l,h=l,f=-l,p=-l,v=[],y=t&&t.pixelRatio||this.getDevicePixelRatio();it(wT,function(k,H){if(k.group===i){var X=r?k.getZr().painter.getSvgDom().innerHTML:k.renderToCanvas(yi(t)),Z=k.getDom().getBoundingClientRect();a=s(Z.left,a),h=s(Z.top,h),f=o(Z.right,f),p=o(Z.bottom,p),v.push({dom:X,left:Z.left,top:Z.top})}}),a*=y,h*=y,f*=y,p*=y;var S=f-a,C=p-h,M=Rw.createCanvas(),E=RX(M,{renderer:r?"svg":"canvas"});if(E.resize({width:S,height:C}),r){var L="";return it(v,function(k){var H=k.left-a,X=k.top-h;L+='<g transform="translate('+H+","+X+')">'+k.dom+"</g>"}),E.painter.getSvgRoot().innerHTML=L,t.connectedBackgroundColor&&E.painter.setBackgroundColor(t.connectedBackgroundColor),E.refreshImmediately(),E.painter.toDataURL()}else return t.connectedBackgroundColor&&E.add(new Ha({shape:{x:0,y:0,width:S,height:C},style:{fill:t.connectedBackgroundColor}})),it(v,function(k){var H=new z0({style:{x:k.left*y-a,y:k.top*y-h,image:k.dom}});E.add(H)}),E.refreshImmediately(),M.toDataURL("image/"+(t&&t.type||"png"))}else return this.getDataURL(t)},e.prototype.convertToPixel=function(t,r){return M3(this,"convertToPixel",t,r)},e.prototype.convertFromPixel=function(t,r){return M3(this,"convertFromPixel",t,r)},e.prototype.containPixel=function(t,r){if(this._disposed){this.id;return}var i=this._model,s,o=mT(i,t);return it(o,function(l,a){a.indexOf("Models")>=0&&it(l,function(h){var f=h.coordinateSystem;if(f&&f.containPoint)s=s||!!f.containPoint(r);else if(a==="seriesModels"){var p=this._chartsMap[h.__viewId];p&&p.containPoint&&(s=s||p.containPoint(r,h))}},this)},this),!!s},e.prototype.getVisual=function(t,r){var i=this._model,s=mT(i,t,{defaultMainType:"series"}),o=s.seriesModel,l=o.getData(),a=s.hasOwnProperty("dataIndexInside")?s.dataIndexInside:s.hasOwnProperty("dataIndex")?l.indexOfRawIndex(s.dataIndex):null;return a!=null?qPe(l,a,r):ZPe(l,r)},e.prototype.getViewOfComponentModel=function(t){return this._componentsMap[t.__viewId]},e.prototype.getViewOfSeriesModel=function(t){return this._chartsMap[t.__viewId]},e.prototype._initEvents=function(){var t=this;it(VLe,function(r){var i=function(s){var o=t.getModel(),l=s.target,a,h=r==="globalout";if(h?a={}:l&&NA(l,function(S){var C=$i(S);if(C&&C.dataIndex!=null){var M=C.dataModel||o.getSeriesByIndex(C.seriesIndex);return a=M&&M.getDataParams(C.dataIndex,C.dataType,l)||{},!0}else if(C.eventData)return a=Jn({},C.eventData),!0},!0),a){var f=a.componentType,p=a.componentIndex;(f==="markLine"||f==="markPoint"||f==="markArea")&&(f="series",p=a.seriesIndex);var v=f&&p!=null&&o.getComponent(f,p),y=v&&t[v.mainType==="series"?"_chartsMap":"_componentsMap"][v.__viewId];a.event=s,a.type=r,t._$eventProcessor.eventInfo={targetEl:l,packedEvent:a,model:v,view:y},t.trigger(r,a)}};i.zrEventfulCallAtLast=!0,t._zr.on(r,i,t)}),it(bT,function(r,i){t._messageCenter.on(i,function(s){this.trigger(i,s)},t)}),it(["selectchanged"],function(r){t._messageCenter.on(r,function(i){this.trigger(r,i)},t)}),KPe(this._messageCenter,this,this._api)},e.prototype.isDisposed=function(){return this._disposed},e.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},e.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var t=this.getDom();t&&Zie(this.getDom(),RG,"");var r=this,i=r._api,s=r._model;it(r._componentsViews,function(o){o.dispose(s,i)}),it(r._chartsViews,function(o){o.dispose(s,i)}),r._zr.dispose(),r._dom=r._model=r._chartsMap=r._componentsMap=r._chartsViews=r._componentsViews=r._scheduler=r._api=r._zr=r._throttledZrFlush=r._theme=r._coordSysMgr=r._messageCenter=null,delete wT[r.id]},e.prototype.resize=function(t){if(!this[Ul]){if(this._disposed){this.id;return}this._zr.resize(t);var r=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!r){var i=r.resetOption("media"),s=t&&t.silent;this[Qc]&&(s==null&&(s=this[Qc].silent),i=!0,this[Qc]=null),this[Ul]=!0;try{i&&G1(this),Sv.update.call(this,{type:"resize",animation:Jn({duration:0},t&&t.animation)})}catch(o){throw this[Ul]=!1,o}this[Ul]=!1,aA.call(this,s),oA.call(this,s)}}},e.prototype.showLoading=function(t,r){if(this._disposed){this.id;return}if($r(t)&&(r=t,t=""),t=t||"default",this.hideLoading(),!!Jz[t]){var i=Jz[t](this._api,r),s=this._zr;this._loadingFX=i,s.add(i)}},e.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},e.prototype.makeActionFromEvent=function(t){var r=Jn({},t);return r.type=bT[t.type],r},e.prototype.dispatchAction=function(t,r){if(this._disposed){this.id;return}if($r(r)||(r={silent:!!r}),!!rL[t.type]&&this._model){if(this[Ul]){this._pendingActions.push(t);return}var i=r.silent;C3.call(this,t,i);var s=r.flush;s?this._zr.flush():s!==!1&&gi.browser.weChat&&this._throttledZrFlush(),aA.call(this,i),oA.call(this,i)}},e.prototype.updateLabelLayout=function(){Bf.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},e.prototype.appendData=function(t){if(this._disposed){this.id;return}var r=t.seriesIndex,i=this.getModel(),s=i.getSeriesByIndex(r);s.appendData(t),this._scheduler.unfinished=!0,this.getZr().wakeUp()},e.internalField=function(){G1=function(p){var v=p._scheduler;v.restorePipelines(p._model),v.prepareStageTasks(),T3(p,!0),T3(p,!1),v.plan()},T3=function(p,v){for(var y=p._model,S=p._scheduler,C=v?p._componentsViews:p._chartsViews,M=v?p._componentsMap:p._chartsMap,E=p._zr,L=p._api,k=0;k<C.length;k++)C[k].__alive=!1;v?y.eachComponent(function(Z,Q){Z!=="series"&&H(Q)}):y.eachSeries(H);function H(Z){var Q=Z.__requireNewView;Z.__requireNewView=!1;var re="_ec_"+Z.id+"_"+Z.type,ie=!Q&&M[re];if(!ie){var oe=ip(Z.type),fe=v?Dc.getClass(oe.main,oe.sub):Ph.getClass(oe.sub);ie=new fe,ie.init(y,L),M[re]=ie,C.push(ie),E.add(ie.group)}Z.__viewId=ie.__id=re,ie.__alive=!0,ie.__model=Z,ie.group.__ecComponentInfo={mainType:Z.mainType,index:Z.componentIndex},!v&&S.prepareView(ie,Z,y,L)}for(var k=0;k<C.length;){var X=C[k];X.__alive?k++:(!v&&X.renderTask.dispose(),E.remove(X.group),X.dispose(y,L),C.splice(k,1),M[X.__id]===X&&delete M[X.__id],X.__id=X.group.__ecComponentInfo=null)}},cI=function(p,v,y,S,C){var M=p._model;if(M.setUpdatePayload(y),!S){it([].concat(p._componentsViews).concat(p._chartsViews),X);return}var E={};E[S+"Id"]=y[S+"Id"],E[S+"Index"]=y[S+"Index"],E[S+"Name"]=y[S+"Name"];var L={mainType:S,query:E};C&&(L.subType=C);var k=y.excludeSeriesId,H;k!=null&&(H=ii(),it(mo(k),function(Z){var Q=fp(Z,null);Q!=null&&H.set(Q,!0)})),M&&M.eachComponent(L,function(Z){var Q=H&&H.get(Z.id)!=null;if(!Q)if(sq(y))if(Z instanceof ed)y.type===jy&&!y.notBlur&&!Z.get(["emphasis","disabled"])&&F2e(Z,y,p._api);else{var re=iG(Z.mainType,Z.componentIndex,y.name,p._api),ie=re.focusSelf,oe=re.dispatchers;y.type===jy&&ie&&!y.notBlur&&Rz(Z.mainType,Z.componentIndex,p._api),oe&&it(oe,function(fe){y.type===jy?cw(fe):uw(fe)})}else Dz(y)&&Z instanceof ed&&(U2e(Z,y,p._api),rq(Z),hh(p))},p),M&&M.eachComponent(L,function(Z){var Q=H&&H.get(Z.id)!=null;Q||X(p[S==="series"?"_chartsMap":"_componentsMap"][Z.__viewId])},p);function X(Z){Z&&Z.__alive&&Z[v]&&Z[v](Z.__model,M,p._api,y)}},Sv={prepareAndUpdate:function(p){G1(this),Sv.update.call(this,p,{optionChanged:p.newOption!=null})},update:function(p,v){var y=this._model,S=this._api,C=this._zr,M=this._coordSysMgr,E=this._scheduler;if(y){y.setUpdatePayload(p),E.restoreData(y,p),E.performSeriesTasks(y),M.create(y,S),E.performDataProcessorTasks(y,p),E3(this,y),M.update(y,S),t(y),E.performVisualTasks(y,p),I3(this,y,S,p,v);var L=y.get("backgroundColor")||"transparent",k=y.get("darkMode");C.setBackgroundColor(L),k!=null&&k!=="auto"&&C.setDarkMode(k),Bf.trigger("afterupdate",y,S)}},updateTransform:function(p){var v=this,y=this._model,S=this._api;if(y){y.setUpdatePayload(p);var C=[];y.eachComponent(function(E,L){if(E!=="series"){var k=v.getViewOfComponentModel(L);if(k&&k.__alive)if(k.updateTransform){var H=k.updateTransform(L,y,S,p);H&&H.update&&C.push(k)}else C.push(k)}});var M=ii();y.eachSeries(function(E){var L=v._chartsMap[E.__viewId];if(L.updateTransform){var k=L.updateTransform(E,y,S,p);k&&k.update&&M.set(E.uid,1)}else M.set(E.uid,1)}),t(y),this._scheduler.performVisualTasks(y,p,{setDirty:!0,dirtyMap:M}),uI(this,y,S,p,{},M),Bf.trigger("afterupdate",y,S)}},updateView:function(p){var v=this._model;v&&(v.setUpdatePayload(p),Ph.markUpdateMethod(p,"updateView"),t(v),this._scheduler.performVisualTasks(v,p,{setDirty:!0}),I3(this,v,this._api,p,{}),Bf.trigger("afterupdate",v,this._api))},updateVisual:function(p){var v=this,y=this._model;y&&(y.setUpdatePayload(p),y.eachSeries(function(S){S.getData().clearAllVisual()}),Ph.markUpdateMethod(p,"updateVisual"),t(y),this._scheduler.performVisualTasks(y,p,{visualType:"visual",setDirty:!0}),y.eachComponent(function(S,C){if(S!=="series"){var M=v.getViewOfComponentModel(C);M&&M.__alive&&M.updateVisual(C,y,v._api,p)}}),y.eachSeries(function(S){var C=v._chartsMap[S.__viewId];C.updateVisual(S,y,v._api,p)}),Bf.trigger("afterupdate",y,this._api))},updateLayout:function(p){Sv.update.call(this,p)}},M3=function(p,v,y,S){if(p._disposed){p.id;return}for(var C=p._model,M=p._coordSysMgr.getCoordinateSystems(),E,L=mT(C,y),k=0;k<M.length;k++){var H=M[k];if(H[v]&&(E=H[v](C,L,S))!=null)return E}},E3=function(p,v){var y=p._chartsMap,S=p._scheduler;v.eachSeries(function(C){S.updateStreamModes(C,y[C.__viewId])})},C3=function(p,v){var y=this,S=this.getModel(),C=p.type,M=p.escapeConnect,E=rL[C],L=E.actionInfo,k=(L.update||"update").split(":"),H=k.pop(),X=k[0]!=null&&ip(k[0]);this[Ul]=!0;var Z=[p],Q=!1;p.batch&&(Q=!0,Z=xr(p.batch,function(Ie){return Ie=ti(Jn({},Ie),p),Ie.batch=null,Ie}));var re=[],ie,oe=Dz(p),fe=sq(p);if(fe&&vse(this._api),it(Z,function(Ie){if(ie=E.action(Ie,y._model,y._api),ie=ie||Jn({},Ie),ie.type=L.event||ie.type,re.push(ie),fe){var He=Q6(p),Re=He.queryOptionMap,st=He.mainTypeSpecified,_e=st?Re.keys()[0]:"series";cI(y,H,Ie,_e),hh(y)}else oe?(cI(y,H,Ie,"series"),hh(y)):X&&cI(y,H,Ie,X.main,X.sub)}),H!=="none"&&!fe&&!oe&&!X)try{this[Qc]?(G1(this),Sv.update.call(this,p),this[Qc]=null):Sv[H].call(this,p)}catch(Ie){throw this[Ul]=!1,Ie}if(Q?ie={type:L.event||C,escapeConnect:M,batch:re}:ie=re[0],this[Ul]=!1,!v){var Se=this._messageCenter;if(Se.trigger(ie.type,ie),oe){var Ee={type:"selectchanged",escapeConnect:M,selected:G2e(S),isFromClick:p.isFromClick||!1,fromAction:p.type,fromActionPayload:p};Se.trigger(Ee.type,Ee)}}},aA=function(p){for(var v=this._pendingActions;v.length;){var y=v.shift();C3.call(this,y,p)}},oA=function(p){!p&&this.trigger("updated")},bZ=function(p,v){p.on("rendered",function(y){v.trigger("rendered",y),p.animation.isFinished()&&!v[Qc]&&!v._scheduler.unfinished&&!v._pendingActions.length&&v.trigger("finished")})},wZ=function(p,v){p.on("mouseover",function(y){var S=y.target,C=NA(S,Lz);C&&(N2e(C,y,v._api),hh(v))}).on("mouseout",function(y){var S=y.target,C=NA(S,Lz);C&&(z2e(C,y,v._api),hh(v))}).on("click",function(y){var S=y.target,C=NA(S,function(L){return $i(L).dataIndex!=null},!0);if(C){var M=C.selected?"unselect":"select",E=$i(C);v._api.dispatchAction({type:M,dataType:E.dataType,dataIndexInside:E.dataIndex,seriesIndex:E.seriesIndex,isFromClick:!0})}})};function t(p){p.clearColorPalette(),p.eachSeries(function(v){v.clearColorPalette()})}function r(p){var v=[],y=[],S=!1;if(p.eachComponent(function(L,k){var H=k.get("zlevel")||0,X=k.get("z")||0,Z=k.getZLevelKey();S=S||!!Z,(L==="series"?y:v).push({zlevel:H,z:X,idx:k.componentIndex,type:L,key:Z})}),S){var C=v.concat(y),M,E;sR(C,function(L,k){return L.zlevel===k.zlevel?L.z-k.z:L.zlevel-k.zlevel}),it(C,function(L){var k=p.getComponent(L.type,L.idx),H=L.zlevel,X=L.key;M!=null&&(H=Math.max(M,H)),X?(H===M&&X!==E&&H++,E=X):E&&(H===M&&H++,E=""),M=H,k.setZLevel(H)})}}I3=function(p,v,y,S,C){r(v),SZ(p,v,y,S,C),it(p._chartsViews,function(M){M.__alive=!1}),uI(p,v,y,S,C),it(p._chartsViews,function(M){M.__alive||M.remove(v,y)})},SZ=function(p,v,y,S,C,M){it(M||p._componentsViews,function(E){var L=E.__model;h(L,E),E.render(L,v,y,S),l(L,E),f(L,E)})},uI=function(p,v,y,S,C,M){var E=p._scheduler;C=Jn(C||{},{updatedSeries:v.getSeries()}),Bf.trigger("series:beforeupdate",v,y,C);var L=!1;v.eachSeries(function(k){var H=p._chartsMap[k.__viewId];H.__alive=!0;var X=H.renderTask;E.updatePayload(X,S),h(k,H),M&&M.get(k.uid)&&X.dirty(),X.perform(E.getPerformArgs(X))&&(L=!0),H.group.silent=!!k.get("silent"),o(k,H),rq(k)}),E.unfinished=L||E.unfinished,Bf.trigger("series:layoutlabels",v,y,C),Bf.trigger("series:transition",v,y,C),v.eachSeries(function(k){var H=p._chartsMap[k.__viewId];l(k,H),f(k,H)}),s(p,v),Bf.trigger("series:afterupdate",v,y,C)},hh=function(p){p[S3]=!0,p.getZr().wakeUp()},TZ=function(p){p[S3]&&(p.getZr().storage.traverse(function(v){Vb(v)||i(v)}),p[S3]=!1)};function i(p){for(var v=[],y=p.currentStates,S=0;S<y.length;S++){var C=y[S];C==="emphasis"||C==="blur"||C==="select"||v.push(C)}p.selected&&p.states.select&&v.push("select"),p.hoverState===KD&&p.states.emphasis?v.push("emphasis"):p.hoverState===YD&&p.states.blur&&v.push("blur"),p.useStates(v)}function s(p,v){var y=p._zr,S=y.storage,C=0;S.traverse(function(M){M.isGroup||C++}),C>v.get("hoverLayerThreshold")&&!gi.node&&!gi.worker&&v.eachSeries(function(M){if(!M.preventUsingHoverLayer){var E=p._chartsMap[M.__viewId];E.__alive&&E.eachRendered(function(L){L.states.emphasis&&(L.states.emphasis.hoverLayer=!0)})}})}function o(p,v){var y=p.get("blendMode")||null;v.eachRendered(function(S){S.isGroup||(S.style.blend=y)})}function l(p,v){if(!p.preventAutoZ){var y=p.get("z")||0,S=p.get("zlevel")||0;v.eachRendered(function(C){return a(C,y,S,-1/0),!0})}}function a(p,v,y,S){var C=p.getTextContent(),M=p.getTextGuideLine(),E=p.isGroup;if(E)for(var L=p.childrenRef(),k=0;k<L.length;k++)S=Math.max(a(L[k],v,y,S),S);else p.z=v,p.zlevel=y,S=Math.max(p.z2,S);if(C&&(C.z=v,C.zlevel=y,isFinite(S)&&(C.z2=S+2)),M){var H=p.textGuideLineConfig;M.z=v,M.zlevel=y,isFinite(S)&&(M.z2=S+(H&&H.showAbove?1:-1))}return S}function h(p,v){v.eachRendered(function(y){if(!Vb(y)){var S=y.getTextContent(),C=y.getTextGuideLine();y.stateTransition&&(y.stateTransition=null),S&&S.stateTransition&&(S.stateTransition=null),C&&C.stateTransition&&(C.stateTransition=null),y.hasState()?(y.prevStates=y.currentStates,y.clearStates()):y.prevStates&&(y.prevStates=null)}})}function f(p,v){var y=p.getModel("stateAnimation"),S=p.isAnimationEnabled(),C=y.get("duration"),M=C>0?{duration:C,delay:y.get("delay"),easing:y.get("easing")}:null;v.eachRendered(function(E){if(E.states&&E.states.emphasis){if(Vb(E))return;if(E instanceof qi&&$2e(E),E.__dirty){var L=E.prevStates;L&&E.useStates(L)}if(S){E.stateTransition=M;var k=E.getTextContent(),H=E.getTextGuideLine();k&&(k.stateTransition=M),H&&(H.stateTransition=M)}E.__dirty&&i(E)}})}AZ=function(p){return new(function(v){Hn(y,v);function y(){return v!==null&&v.apply(this,arguments)||this}return y.prototype.getCoordinateSystems=function(){return p._coordSysMgr.getCoordinateSystems()},y.prototype.getComponentByElement=function(S){for(;S;){var C=S.__ecComponentInfo;if(C!=null)return p._model.getComponent(C.mainType,C.index);S=S.parent}},y.prototype.enterEmphasis=function(S,C){cw(S,C),hh(p)},y.prototype.leaveEmphasis=function(S,C){uw(S,C),hh(p)},y.prototype.enterBlur=function(S){O2e(S),hh(p)},y.prototype.leaveBlur=function(S){dse(S),hh(p)},y.prototype.enterSelect=function(S){pse(S),hh(p)},y.prototype.leaveSelect=function(S){mse(S),hh(p)},y.prototype.getModel=function(){return p.getModel()},y.prototype.getViewOfComponentModel=function(S){return p.getViewOfComponentModel(S)},y.prototype.getViewOfSeriesModel=function(S){return p.getViewOfSeriesModel(S)},y}(fae))(p)},ooe=function(p){function v(y,S){for(var C=0;C<y.length;C++){var M=y[C];M[A3]=S}}it(bT,function(y,S){p._messageCenter.on(S,function(C){if(MZ[p.group]&&p[A3]!==xZ){if(C&&C.escapeConnect)return;var M=p.makeActionFromEvent(C),E=[];it(wT,function(L){L!==p&&L.group===p.group&&E.push(L)}),v(E,xZ),it(E,function(L){L[A3]!==ULe&&L.dispatchAction(M)}),v(E,GLe)}})})}}(),e}(ld),IG=loe.prototype;IG.on=noe("on");IG.off=noe("off");IG.one=function(n,e,t){var r=this;function i(){for(var s=[],o=0;o<arguments.length;o++)s[o]=arguments[o];e&&e.apply&&e.apply(this,s),r.off(n,i)}this.on.call(this,n,i,t)};var VLe=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"],rL={},bT={},Yz=[],Kz=[],iL=[],coe={},Jz={},wT={},MZ={},HLe=+new Date-0,RG="_echarts_instance_";function jLe(n,e,t){{var r=WLe(n);if(r)return r}var i=new loe(n,e,t);return i.id="ec_"+HLe++,wT[i.id]=i,Zie(n,RG,i.id),ooe(i),Bf.trigger("afterinit",i),i}function WLe(n){return wT[MCe(n,RG)]}function uoe(n,e){coe[n]=e}function hoe(n){Xi(Kz,n)<0&&Kz.push(n)}function foe(n,e){LG(Yz,n,e,LLe)}function $Le(n){PG("afterinit",n)}function XLe(n){PG("afterupdate",n)}function PG(n,e){Bf.on(n,e)}function Sp(n,e,t){ci(e)&&(t=e,e="");var r=$r(n)?n.type:[n,n={event:e}][0];n.event=(n.event||r).toLowerCase(),e=n.event,!bT[e]&&(vp(yZ.test(r)&&yZ.test(e)),rL[r]||(rL[r]={action:t,actionInfo:n}),bT[e]=r)}function qLe(n,e){wG.register(n,e)}function ZLe(n,e){LG(iL,n,e,Qae,"layout")}function Cx(n,e){LG(iL,n,e,eoe,"visual")}var EZ=[];function LG(n,e,t,r,i){if((ci(e)||$r(e))&&(t=e,e=r),!(Xi(EZ,t)>=0)){EZ.push(t);var s=zae.wrapStageHandler(t,i);s.__prio=e,s.__raw=t,n.push(s)}}function doe(n,e){Jz[n]=e}function YLe(n,e,t){var r=ELe("registerMap");r&&r(n,e,t)}var KLe=iPe;Cx(CG,PPe);Cx(vB,LPe);Cx(vB,DPe);Cx(CG,$Pe);Cx(vB,XPe);Cx(toe,TLe);hoe(pae);foe(RLe,FRe);doe("default",BPe);Sp({type:jy,event:jy,update:jy},Rc);Sp({type:hR,event:hR,update:hR},Rc);Sp({type:gT,event:gT,update:gT},Rc);Sp({type:fR,event:fR,update:fR},Rc);Sp({type:vT,event:vT,update:vT},Rc);uoe("light",jPe);uoe("dark",Hae);function lA(n){return n==null?0:n.length||1}function CZ(n){return n}var TM=function(){function n(e,t,r,i,s,o){this._old=e,this._new=t,this._oldKeyGetter=r||CZ,this._newKeyGetter=i||CZ,this.context=s,this._diffModeMultiple=o==="multiple"}return n.prototype.add=function(e){return this._add=e,this},n.prototype.update=function(e){return this._update=e,this},n.prototype.updateManyToOne=function(e){return this._updateManyToOne=e,this},n.prototype.updateOneToMany=function(e){return this._updateOneToMany=e,this},n.prototype.updateManyToMany=function(e){return this._updateManyToMany=e,this},n.prototype.remove=function(e){return this._remove=e,this},n.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},n.prototype._executeOneToOne=function(){var e=this._old,t=this._new,r={},i=new Array(e.length),s=new Array(t.length);this._initIndexMap(e,null,i,"_oldKeyGetter"),this._initIndexMap(t,r,s,"_newKeyGetter");for(var o=0;o<e.length;o++){var l=i[o],a=r[l],h=lA(a);if(h>1){var f=a.shift();a.length===1&&(r[l]=a[0]),this._update&&this._update(f,o)}else h===1?(r[l]=null,this._update&&this._update(a,o)):this._remove&&this._remove(o)}this._performRestAdd(s,r)},n.prototype._executeMultiple=function(){var e=this._old,t=this._new,r={},i={},s=[],o=[];this._initIndexMap(e,r,s,"_oldKeyGetter"),this._initIndexMap(t,i,o,"_newKeyGetter");for(var l=0;l<s.length;l++){var a=s[l],h=r[a],f=i[a],p=lA(h),v=lA(f);if(p>1&&v===1)this._updateManyToOne&&this._updateManyToOne(f,h),i[a]=null;else if(p===1&&v>1)this._updateOneToMany&&this._updateOneToMany(f,h),i[a]=null;else if(p===1&&v===1)this._update&&this._update(f,h),i[a]=null;else if(p>1&&v>1)this._updateManyToMany&&this._updateManyToMany(f,h),i[a]=null;else if(p>1)for(var y=0;y<p;y++)this._remove&&this._remove(h[y]);else this._remove&&this._remove(h)}this._performRestAdd(o,i)},n.prototype._performRestAdd=function(e,t){for(var r=0;r<e.length;r++){var i=e[r],s=t[i],o=lA(s);if(o>1)for(var l=0;l<o;l++)this._add&&this._add(s[l]);else o===1&&this._add&&this._add(s);t[i]=null}},n.prototype._initIndexMap=function(e,t,r,i){for(var s=this._diffModeMultiple,o=0;o<e.length;o++){var l="_ec_"+this[i](e[o],o);if(s||(r[o]=l),!!t){var a=t[l],h=lA(a);h===0?(t[l]=o,s&&r.push(l)):h===1?t[l]=[a,o]:a.push(o)}}},n}(),JLe=function(){function n(e,t){this._encode=e,this._schema=t}return n.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},n.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},n}();function QLe(n,e){var t={},r=t.encode={},i=ii(),s=[],o=[],l={};it(n.dimensions,function(v){var y=n.getDimensionInfo(v),S=y.coordDim;if(S){var C=y.coordDimIndex;R3(r,S)[C]=v,y.isExtraCoord||(i.set(S,1),tDe(y.type)&&(s[0]=v),R3(l,S)[C]=n.getDimensionIndex(y.name)),y.defaultTooltip&&o.push(v)}oae.each(function(M,E){var L=R3(r,E),k=y.otherDims[E];k!=null&&k!==!1&&(L[k]=y.name)})});var a=[],h={};i.each(function(v,y){var S=r[y];h[y]=S[0],a=a.concat(S)}),t.dataDimsOnCoord=a,t.dataDimIndicesOnCoord=xr(a,function(v){return n.getDimensionInfo(v).storeDimIndex}),t.encodeFirstDimNotExtra=h;var f=r.label;f&&f.length&&(s=f.slice());var p=r.tooltip;return p&&p.length?o=p.slice():o.length||(o=s.slice()),r.defaultedLabel=s,r.defaultedTooltip=o,t.userOutput=new JLe(l,e),t}function R3(n,e){return n.hasOwnProperty(e)||(n[e]=[]),n[e]}function eDe(n){return n==="category"?"ordinal":n==="time"?"time":"float"}function tDe(n){return!(n==="ordinal"||n==="time")}var vR=function(){function n(e){this.otherDims={},e!=null&&Jn(this,e)}return n}(),nDe=qs(),rDe={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},poe=function(){function n(e){this.dimensions=e.dimensions,this._dimOmitted=e.dimensionOmitted,this.source=e.source,this._fullDimCount=e.fullDimensionCount,this._updateDimOmitted(e.dimensionOmitted)}return n.prototype.isDimensionOmitted=function(){return this._dimOmitted},n.prototype._updateDimOmitted=function(e){this._dimOmitted=e,e&&(this._dimNameMap||(this._dimNameMap=voe(this.source)))},n.prototype.getSourceDimensionIndex=function(e){return Ii(this._dimNameMap.get(e),-1)},n.prototype.getSourceDimension=function(e){var t=this.source.dimensionsDefine;if(t)return t[e]},n.prototype.makeStoreSchema=function(){for(var e=this._fullDimCount,t=vae(this.source),r=!_oe(e),i="",s=[],o=0,l=0;o<e;o++){var a=void 0,h=void 0,f=void 0,p=this.dimensions[l];if(p&&p.storeDimIndex===o)a=t?p.name:null,h=p.type,f=p.ordinalMeta,l++;else{var v=this.getSourceDimension(o);v&&(a=t?v.name:null,h=v.type)}s.push({property:a,type:h,ordinalMeta:f}),t&&a!=null&&(!p||!p.isCalculationCoord)&&(i+=r?a.replace(/\`/g,"`1").replace(/\$/g,"`2"):a),i+="$",i+=rDe[h]||"f",f&&(i+=f.uid),i+="$"}var y=this.source,S=[y.seriesLayoutBy,y.startIndex,i].join("$$");return{dimensions:s,hash:S}},n.prototype.makeOutputDimensionNames=function(){for(var e=[],t=0,r=0;t<this._fullDimCount;t++){var i=void 0,s=this.dimensions[r];if(s&&s.storeDimIndex===t)s.isCalculationCoord||(i=s.name),r++;else{var o=this.getSourceDimension(t);o&&(i=o.name)}e.push(i)}return e},n.prototype.appendCalculationDimension=function(e){this.dimensions.push(e),e.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},n}();function moe(n){return n instanceof poe}function goe(n){for(var e=ii(),t=0;t<(n||[]).length;t++){var r=n[t],i=$r(r)?r.name:r;i!=null&&e.get(i)==null&&e.set(i,t)}return e}function voe(n){var e=nDe(n);return e.dimNameMap||(e.dimNameMap=goe(n.dimensionsDefine))}function _oe(n){return n>30}var cA=$r,Av=xr,iDe=typeof Int32Array>"u"?Array:Int32Array,sDe="e\0\0",IZ=-1,aDe=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],oDe=["_approximateExtent"],RZ,hI,uA,hA,P3,fI,L3,yoe=function(){function n(e,t){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","lttbDownSample"];var r,i=!1;moe(e)?(r=e.dimensions,this._dimOmitted=e.isDimensionOmitted(),this._schema=e):(i=!0,r=e),r=r||["x","y"];for(var s={},o=[],l={},a=!1,h={},f=0;f<r.length;f++){var p=r[f],v=Dr(p)?new vR({name:p}):p instanceof vR?p:new vR(p),y=v.name;v.type=v.type||"float",v.coordDim||(v.coordDim=y,v.coordDimIndex=0);var S=v.otherDims=v.otherDims||{};o.push(y),s[y]=v,h[y]!=null&&(a=!0),v.createInvertedIndices&&(l[y]=[]),S.itemName===0&&(this._nameDimIdx=f),S.itemId===0&&(this._idDimIdx=f),i&&(v.storeDimIndex=f)}if(this.dimensions=o,this._dimInfos=s,this._initGetDimensionInfo(a),this.hostModel=t,this._invertedIndicesMap=l,this._dimOmitted){var C=this._dimIdxToName=ii();it(o,function(M){C.set(s[M].storeDimIndex,M)})}}return n.prototype.getDimension=function(e){var t=this._recognizeDimIndex(e);if(t==null)return e;if(t=e,!this._dimOmitted)return this.dimensions[t];var r=this._dimIdxToName.get(t);if(r!=null)return r;var i=this._schema.getSourceDimension(t);if(i)return i.name},n.prototype.getDimensionIndex=function(e){var t=this._recognizeDimIndex(e);if(t!=null)return t;if(e==null)return-1;var r=this._getDimInfo(e);return r?r.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(e):-1},n.prototype._recognizeDimIndex=function(e){if(Ps(e)||e!=null&&!isNaN(e)&&!this._getDimInfo(e)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(e)<0))return+e},n.prototype._getStoreDimIndex=function(e){var t=this.getDimensionIndex(e);return t},n.prototype.getDimensionInfo=function(e){return this._getDimInfo(this.getDimension(e))},n.prototype._initGetDimensionInfo=function(e){var t=this._dimInfos;this._getDimInfo=e?function(r){return t.hasOwnProperty(r)?t[r]:void 0}:function(r){return t[r]}},n.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},n.prototype.mapDimension=function(e,t){var r=this._dimSummary;if(t==null)return r.encodeFirstDimNotExtra[e];var i=r.encode[e];return i?i[t]:null},n.prototype.mapDimensionsAll=function(e){var t=this._dimSummary,r=t.encode[e];return(r||[]).slice()},n.prototype.getStore=function(){return this._store},n.prototype.initData=function(e,t,r){var i=this,s;if(e instanceof Uz&&(s=e),!s){var o=this.dimensions,l=SG(e)||Pc(e)?new _ae(e,o.length):e;s=new Uz;var a=Av(o,function(h){return{type:i._dimInfos[h].type,property:h}});s.initData(l,a,r)}this._store=s,this._nameList=(t||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,s.count()),this._dimSummary=QLe(this,this._schema),this.userOutput=this._dimSummary.userOutput},n.prototype.appendData=function(e){var t=this._store.appendData(e);this._doInit(t[0],t[1])},n.prototype.appendValues=function(e,t){var r=this._store.appendValues(e,t.length),i=r.start,s=r.end,o=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),t)for(var l=i;l<s;l++){var a=l-i;this._nameList[l]=t[a],o&&L3(this,l)}},n.prototype._updateOrdinalMeta=function(){for(var e=this._store,t=this.dimensions,r=0;r<t.length;r++){var i=this._dimInfos[t[r]];i.ordinalMeta&&e.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},n.prototype._shouldMakeIdFromName=function(){var e=this._store.getProvider();return this._idDimIdx==null&&e.getSource().sourceFormat!==c0&&!e.fillStorage},n.prototype._doInit=function(e,t){if(!(e>=t)){var r=this._store,i=r.getProvider();this._updateOrdinalMeta();var s=this._nameList,o=this._idList,l=i.getSource().sourceFormat,a=l===zh;if(a&&!i.pure)for(var h=[],f=e;f<t;f++){var p=i.getItem(f,h);if(!this.hasItemOption&&dCe(p)&&(this.hasItemOption=!0),p){var v=p.name;s[f]==null&&v!=null&&(s[f]=fp(v,null));var y=p.id;o[f]==null&&y!=null&&(o[f]=fp(y,null))}}if(this._shouldMakeIdFromName())for(var f=e;f<t;f++)L3(this,f);RZ(this)}},n.prototype.getApproximateExtent=function(e){return this._approximateExtent[e]||this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.setApproximateExtent=function(e,t){t=this.getDimension(t),this._approximateExtent[t]=e.slice()},n.prototype.getCalculationInfo=function(e){return this._calculationInfo[e]},n.prototype.setCalculationInfo=function(e,t){cA(e)?Jn(this._calculationInfo,e):this._calculationInfo[e]=t},n.prototype.getName=function(e){var t=this.getRawIndex(e),r=this._nameList[t];return r==null&&this._nameDimIdx!=null&&(r=uA(this,this._nameDimIdx,t)),r==null&&(r=""),r},n.prototype._getCategory=function(e,t){var r=this._store.get(e,t),i=this._store.getOrdinalMeta(e);return i?i.categories[r]:r},n.prototype.getId=function(e){return hI(this,this.getRawIndex(e))},n.prototype.count=function(){return this._store.count()},n.prototype.get=function(e,t){var r=this._store,i=this._dimInfos[e];if(i)return r.get(i.storeDimIndex,t)},n.prototype.getByRawIndex=function(e,t){var r=this._store,i=this._dimInfos[e];if(i)return r.getByRawIndex(i.storeDimIndex,t)},n.prototype.getIndices=function(){return this._store.getIndices()},n.prototype.getDataExtent=function(e){return this._store.getDataExtent(this._getStoreDimIndex(e))},n.prototype.getSum=function(e){return this._store.getSum(this._getStoreDimIndex(e))},n.prototype.getMedian=function(e){return this._store.getMedian(this._getStoreDimIndex(e))},n.prototype.getValues=function(e,t){var r=this,i=this._store;return fr(e)?i.getValues(Av(e,function(s){return r._getStoreDimIndex(s)}),t):i.getValues(e)},n.prototype.hasValue=function(e){for(var t=this._dimSummary.dataDimIndicesOnCoord,r=0,i=t.length;r<i;r++)if(isNaN(this._store.get(t[r],e)))return!1;return!0},n.prototype.indexOfName=function(e){for(var t=0,r=this._store.count();t<r;t++)if(this.getName(t)===e)return t;return-1},n.prototype.getRawIndex=function(e){return this._store.getRawIndex(e)},n.prototype.indexOfRawIndex=function(e){return this._store.indexOfRawIndex(e)},n.prototype.rawIndexOf=function(e,t){var r=e&&this._invertedIndicesMap[e],i=r[t];return i==null||isNaN(i)?IZ:i},n.prototype.indicesOfNearest=function(e,t,r){return this._store.indicesOfNearest(this._getStoreDimIndex(e),t,r)},n.prototype.each=function(e,t,r){ci(e)&&(r=t,t=e,e=[]);var i=r||this,s=Av(hA(e),this._getStoreDimIndex,this);this._store.each(s,i?Us(t,i):t)},n.prototype.filterSelf=function(e,t,r){ci(e)&&(r=t,t=e,e=[]);var i=r||this,s=Av(hA(e),this._getStoreDimIndex,this);return this._store=this._store.filter(s,i?Us(t,i):t),this},n.prototype.selectRange=function(e){var t=this,r={},i=aa(e);return it(i,function(s){var o=t._getStoreDimIndex(s);r[o]=e[s]}),this._store=this._store.selectRange(r),this},n.prototype.mapArray=function(e,t,r){ci(e)&&(r=t,t=e,e=[]),r=r||this;var i=[];return this.each(e,function(){i.push(t&&t.apply(this,arguments))},r),i},n.prototype.map=function(e,t,r,i){var s=r||i||this,o=Av(hA(e),this._getStoreDimIndex,this),l=fI(this);return l._store=this._store.map(o,s?Us(t,s):t),l},n.prototype.modify=function(e,t,r,i){var s=r||i||this,o=Av(hA(e),this._getStoreDimIndex,this);this._store.modify(o,s?Us(t,s):t)},n.prototype.downSample=function(e,t,r,i){var s=fI(this);return s._store=this._store.downSample(this._getStoreDimIndex(e),t,r,i),s},n.prototype.lttbDownSample=function(e,t){var r=fI(this);return r._store=this._store.lttbDownSample(this._getStoreDimIndex(e),t),r},n.prototype.getRawDataItem=function(e){return this._store.getRawDataItem(e)},n.prototype.getItemModel=function(e){var t=this.hostModel,r=this.getRawDataItem(e);return new Ra(r,t,t&&t.ecModel)},n.prototype.diff=function(e){var t=this;return new TM(e?e.getStore().getIndices():[],this.getStore().getIndices(),function(r){return hI(e,r)},function(r){return hI(t,r)})},n.prototype.getVisual=function(e){var t=this._visual;return t&&t[e]},n.prototype.setVisual=function(e,t){this._visual=this._visual||{},cA(e)?Jn(this._visual,e):this._visual[e]=t},n.prototype.getItemVisual=function(e,t){var r=this._itemVisuals[e],i=r&&r[t];return i??this.getVisual(t)},n.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},n.prototype.ensureUniqueItemVisual=function(e,t){var r=this._itemVisuals,i=r[e];i||(i=r[e]={});var s=i[t];return s==null&&(s=this.getVisual(t),fr(s)?s=s.slice():cA(s)&&(s=Jn({},s)),i[t]=s),s},n.prototype.setItemVisual=function(e,t,r){var i=this._itemVisuals[e]||{};this._itemVisuals[e]=i,cA(t)?Jn(i,t):i[t]=r},n.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},n.prototype.setLayout=function(e,t){cA(e)?Jn(this._layout,e):this._layout[e]=t},n.prototype.getLayout=function(e){return this._layout[e]},n.prototype.getItemLayout=function(e){return this._itemLayouts[e]},n.prototype.setItemLayout=function(e,t,r){this._itemLayouts[e]=r?Jn(this._itemLayouts[e]||{},t):t},n.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},n.prototype.setItemGraphicEl=function(e,t){var r=this.hostModel&&this.hostModel.seriesIndex;M2e(r,this.dataType,e,t),this._graphicEls[e]=t},n.prototype.getItemGraphicEl=function(e){return this._graphicEls[e]},n.prototype.eachItemGraphicEl=function(e,t){it(this._graphicEls,function(r,i){r&&e&&e.call(t,r,i)})},n.prototype.cloneShallow=function(e){return e||(e=new n(this._schema?this._schema:Av(this.dimensions,this._getDimInfo,this),this.hostModel)),P3(e,this),e._store=this._store,e},n.prototype.wrapMethod=function(e,t){var r=this[e];ci(r)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(e),this[e]=function(){var i=r.apply(this,arguments);return t.apply(this,[i].concat($6(arguments)))})},n.internalField=function(){RZ=function(e){var t=e._invertedIndicesMap;it(t,function(r,i){var s=e._dimInfos[i],o=s.ordinalMeta,l=e._store;if(o){r=t[i]=new iDe(o.categories.length);for(var a=0;a<r.length;a++)r[a]=IZ;for(var a=0;a<l.count();a++)r[l.get(s.storeDimIndex,a)]=a}})},uA=function(e,t,r){return fp(e._getCategory(t,r),null)},hI=function(e,t){var r=e._idList[t];return r==null&&e._idDimIdx!=null&&(r=uA(e,e._idDimIdx,t)),r==null&&(r=sDe+t),r},hA=function(e){return fr(e)||(e=e!=null?[e]:[]),e},fI=function(e){var t=new n(e._schema?e._schema:Av(e.dimensions,e._getDimInfo,e),e.hostModel);return P3(t,e),t},P3=function(e,t){it(aDe.concat(t.__wrappedMethods||[]),function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e.__wrappedMethods=t.__wrappedMethods,it(oDe,function(r){e[r]=yi(t[r])}),e._calculationInfo=Jn({},t._calculationInfo)},L3=function(e,t){var r=e._nameList,i=e._idList,s=e._nameDimIdx,o=e._idDimIdx,l=r[t],a=i[t];if(l==null&&s!=null&&(r[t]=l=uA(e,s,t)),a==null&&o!=null&&(i[t]=a=uA(e,o,t)),a==null&&l!=null){var h=e._nameRepeatCount,f=h[l]=(h[l]||0)+1;a=l,f>1&&(a+="__ec__"+f),i[t]=a}}}(),n}();function xoe(n,e){SG(n)||(n=mae(n)),e=e||{};var t=e.coordDimensions||[],r=e.dimensionsDefine||n.dimensionsDefine||[],i=ii(),s=[],o=cDe(n,t,r,e.dimensionsCount),l=e.canOmitUnusedDimensions&&_oe(o),a=r===n.dimensionsDefine,h=a?voe(n):goe(r),f=e.encodeDefine;!f&&e.encodeDefaulter&&(f=e.encodeDefaulter(n,o));for(var p=ii(f),v=new Mae(o),y=0;y<v.length;y++)v[y]=-1;function S(ie){var oe=v[ie];if(oe<0){var fe=r[ie],Se=$r(fe)?fe:{name:fe},Ee=new vR,Ie=Se.name;Ie!=null&&h.get(Ie)!=null&&(Ee.name=Ee.displayName=Ie),Se.type!=null&&(Ee.type=Se.type),Se.displayName!=null&&(Ee.displayName=Se.displayName);var He=s.length;return v[ie]=He,Ee.storeDimIndex=ie,s.push(Ee),Ee}return s[oe]}if(!l)for(var y=0;y<o;y++)S(y);p.each(function(ie,oe){var fe=mo(ie).slice();if(fe.length===1&&!Dr(fe[0])&&fe[0]<0){p.set(oe,!1);return}var Se=p.set(oe,[]);it(fe,function(Ee,Ie){var He=Dr(Ee)?h.get(Ee):Ee;He!=null&&He<o&&(Se[Ie]=He,M(S(He),oe,Ie))})});var C=0;it(t,function(ie){var oe,fe,Se,Ee;if(Dr(ie))oe=ie,Ee={};else{Ee=ie,oe=Ee.name;var Ie=Ee.ordinalMeta;Ee.ordinalMeta=null,Ee=Jn({},Ee),Ee.ordinalMeta=Ie,fe=Ee.dimsDef,Se=Ee.otherDims,Ee.name=Ee.coordDim=Ee.coordDimIndex=Ee.dimsDef=Ee.otherDims=null}var He=p.get(oe);if(He!==!1){if(He=mo(He),!He.length)for(var Re=0;Re<(fe&&fe.length||1);Re++){for(;C<o&&S(C).coordDim!=null;)C++;C<o&&He.push(C++)}it(He,function(st,_e){var We=S(st);if(a&&Ee.type!=null&&(We.type=Ee.type),M(ti(We,Ee),oe,_e),We.name==null&&fe){var Ue=fe[_e];!$r(Ue)&&(Ue={name:Ue}),We.name=We.displayName=Ue.name,We.defaultTooltip=Ue.defaultTooltip}Se&&ti(We.otherDims,Se)})}});function M(ie,oe,fe){oae.get(oe)!=null?ie.otherDims[oe]=fe:(ie.coordDim=oe,ie.coordDimIndex=fe,i.set(oe,!0))}var E=e.generateCoord,L=e.generateCoordCount,k=L!=null;L=E?L||1:0;var H=E||"value";function X(ie){ie.name==null&&(ie.name=ie.coordDim)}if(l)it(s,function(ie){X(ie)}),s.sort(function(ie,oe){return ie.storeDimIndex-oe.storeDimIndex});else for(var Z=0;Z<o;Z++){var Q=S(Z),re=Q.coordDim;re==null&&(Q.coordDim=uDe(H,i,k),Q.coordDimIndex=0,(!E||L<=0)&&(Q.isExtraCoord=!0),L--),X(Q),Q.type==null&&(uae(n,Z)===yl.Must||Q.isExtraCoord&&(Q.otherDims.itemName!=null||Q.otherDims.seriesName!=null))&&(Q.type="ordinal")}return lDe(s),new poe({source:n,dimensions:s,fullDimensionCount:o,dimensionOmitted:l})}function lDe(n){for(var e=ii(),t=0;t<n.length;t++){var r=n[t],i=r.name,s=e.get(i)||0;s>0&&(r.name=i+(s-1)),s++,e.set(i,s)}}function cDe(n,e,t,r){var i=Math.max(n.dimensionsDetectedCount||1,e.length,t.length,r||0);return it(e,function(s){var o;$r(s)&&(o=s.dimsDef)&&(i=Math.max(i,o.length))}),i}function uDe(n,e,t){if(t||e.hasKey(n)){for(var r=0;e.hasKey(n+r);)r++;n+=r}return e.set(n,!0),n}var hDe=function(){function n(e){this.coordSysDims=[],this.axisMap=ii(),this.categoryAxisMap=ii(),this.coordSysName=e}return n}();function fDe(n){var e=n.get("coordinateSystem"),t=new hDe(e),r=dDe[e];if(r)return r(n,t,t.axisMap,t.categoryAxisMap),t}var dDe={cartesian2d:function(n,e,t,r){var i=n.getReferringComponents("xAxis",bl).models[0],s=n.getReferringComponents("yAxis",bl).models[0];e.coordSysDims=["x","y"],t.set("x",i),t.set("y",s),V1(i)&&(r.set("x",i),e.firstCategoryDimIndex=0),V1(s)&&(r.set("y",s),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},singleAxis:function(n,e,t,r){var i=n.getReferringComponents("singleAxis",bl).models[0];e.coordSysDims=["single"],t.set("single",i),V1(i)&&(r.set("single",i),e.firstCategoryDimIndex=0)},polar:function(n,e,t,r){var i=n.getReferringComponents("polar",bl).models[0],s=i.findAxisModel("radiusAxis"),o=i.findAxisModel("angleAxis");e.coordSysDims=["radius","angle"],t.set("radius",s),t.set("angle",o),V1(s)&&(r.set("radius",s),e.firstCategoryDimIndex=0),V1(o)&&(r.set("angle",o),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=1))},geo:function(n,e,t,r){e.coordSysDims=["lng","lat"]},parallel:function(n,e,t,r){var i=n.ecModel,s=i.getComponent("parallel",n.get("parallelIndex")),o=e.coordSysDims=s.dimensions.slice();it(s.parallelAxisIndex,function(l,a){var h=i.getComponent("parallelAxis",l),f=o[a];t.set(f,h),V1(h)&&(r.set(f,h),e.firstCategoryDimIndex==null&&(e.firstCategoryDimIndex=a))})}};function V1(n){return n.get("type")==="category"}function pDe(n,e,t){t=t||{};var r=t.byIndex,i=t.stackedCoordDimension,s,o,l;mDe(e)?s=e:(o=e.schema,s=o.dimensions,l=e.store);var a=!!(n&&n.get("stack")),h,f,p,v;if(it(s,function(L,k){Dr(L)&&(s[k]=L={name:L}),a&&!L.isExtraCoord&&(!r&&!h&&L.ordinalMeta&&(h=L),!f&&L.type!=="ordinal"&&L.type!=="time"&&(!i||i===L.coordDim)&&(f=L))}),f&&!r&&!h&&(r=!0),f){p="__\0ecstackresult_"+n.id,v="__\0ecstackedover_"+n.id,h&&(h.createInvertedIndices=!0);var y=f.coordDim,S=f.type,C=0;it(s,function(L){L.coordDim===y&&C++});var M={name:p,coordDim:y,coordDimIndex:C,type:S,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:s.length},E={name:v,coordDim:v,coordDimIndex:C+1,type:S,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:s.length+1};o?(l&&(M.storeDimIndex=l.ensureCalculationDimension(v,S),E.storeDimIndex=l.ensureCalculationDimension(p,S)),o.appendCalculationDimension(M),o.appendCalculationDimension(E)):(s.push(M),s.push(E))}return{stackedDimension:f&&f.name,stackedByDimension:h&&h.name,isStackedByIndex:r,stackedOverDimension:v,stackResultDimension:p}}function mDe(n){return!moe(n.schema)}function ux(n,e){return!!e&&e===n.getCalculationInfo("stackedDimension")}function gDe(n,e){return ux(n,e)?n.getCalculationInfo("stackResultDimension"):e}function vDe(n,e){var t=n.get("coordinateSystem"),r=wG.get(t),i;return e&&e.coordSysDims&&(i=xr(e.coordSysDims,function(s){var o={name:s},l=e.axisMap.get(s);if(l){var a=l.get("type");o.type=eDe(a)}return o})),i||(i=r&&(r.getDimensionsInfo?r.getDimensionsInfo():r.dimensions.slice())||["x","y"]),i}function _De(n,e,t){var r,i;return t&&it(n,function(s,o){var l=s.coordDim,a=t.categoryAxisMap.get(l);a&&(r==null&&(r=o),s.ordinalMeta=a.getOrdinalMeta(),e&&(s.createInvertedIndices=!0)),s.otherDims.itemName!=null&&(i=!0)}),!i&&r!=null&&(n[r].otherDims.itemName=0),r}function DG(n,e,t){t=t||{};var r=e.getSourceManager(),i,s=!1;i=r.getSource(),s=i.sourceFormat===zh;var o=fDe(e),l=vDe(e,o),a=t.useEncodeDefaulter,h=ci(a)?a:a?_s(fRe,l,e):null,f={coordDimensions:l,generateCoord:t.generateCoord,encodeDefine:e.getEncode(),encodeDefaulter:h,canOmitUnusedDimensions:!s},p=xoe(i,f),v=_De(p.dimensions,t.createInvertedIndices,o),y=s?null:r.getSharedDataStore(p),S=pDe(e,{schema:p,store:y}),C=new yoe(p,e);C.setCalculationInfo(S);var M=v!=null&&yDe(i)?function(E,L,k,H){return H===v?k:this.defaultDimValueGetter(E,L,k,H)}:null;return C.hasItemOption=!1,C.initData(s?i:y,null,M),C}function yDe(n){if(n.sourceFormat===zh){var e=xDe(n.data||[]);return!fr(vE(e))}}function xDe(n){for(var e=0;e<n.length&&n[e]==null;)e++;return n[e]}var Ap=function(){function n(e){this._setting=e||{},this._extent=[1/0,-1/0]}return n.prototype.getSetting=function(e){return this._setting[e]},n.prototype.unionExtent=function(e){var t=this._extent;e[0]<t[0]&&(t[0]=e[0]),e[1]>t[1]&&(t[1]=e[1])},n.prototype.unionExtentFromData=function(e,t){this.unionExtent(e.getApproximateExtent(t))},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.setExtent=function(e,t){var r=this._extent;isNaN(e)||(r[0]=e),isNaN(t)||(r[1]=t)},n.prototype.isInExtentRange=function(e){return this._extent[0]<=e&&this._extent[1]>=e},n.prototype.isBlank=function(){return this._isBlank},n.prototype.setBlank=function(e){this._isBlank=e},n}();XD(Ap);var bDe=0,Qz=function(){function n(e){this.categories=e.categories||[],this._needCollect=e.needCollect,this._deduplication=e.deduplication,this.uid=++bDe}return n.createByAxisModel=function(e){var t=e.option,r=t.data,i=r&&xr(r,wDe);return new n({categories:i,needCollect:!i,deduplication:t.dedplication!==!1})},n.prototype.getOrdinal=function(e){return this._getOrCreateMap().get(e)},n.prototype.parseAndCollect=function(e){var t,r=this._needCollect;if(!Dr(e)&&!r)return e;if(r&&!this._deduplication)return t=this.categories.length,this.categories[t]=e,t;var i=this._getOrCreateMap();return t=i.get(e),t==null&&(r?(t=this.categories.length,this.categories[t]=e,i.set(e,t)):t=NaN),t},n.prototype._getOrCreateMap=function(){return this._map||(this._map=ii(this.categories))},n}();function wDe(n){return $r(n)&&n.value!=null?n.value:n+""}function e5(n){return n.type==="interval"||n.type==="log"}function SDe(n,e,t,r){var i={},s=n[1]-n[0],o=i.interval=Hie(s/e);t!=null&&o<t&&(o=i.interval=t),r!=null&&o>r&&(o=i.interval=r);var l=i.intervalPrecision=boe(o),a=i.niceTickExtent=[To(Math.ceil(n[0]/o)*o,l),To(Math.floor(n[1]/o)*o,l)];return ADe(a,n),i}function D3(n){var e=Math.pow(10,K6(n)),t=n/e;return t?t===2?t=3:t===3?t=5:t*=2:t=1,To(t*e)}function boe(n){return Dm(n)+2}function PZ(n,e,t){n[e]=Math.max(Math.min(n[e],t[1]),t[0])}function ADe(n,e){!isFinite(n[0])&&(n[0]=e[0]),!isFinite(n[1])&&(n[1]=e[1]),PZ(n,0,e),PZ(n,1,e),n[0]>n[1]&&(n[0]=n[1])}function _B(n,e){return n>=e[0]&&n<=e[1]}function yB(n,e){return e[1]===e[0]?.5:(n-e[0])/(e[1]-e[0])}function xB(n,e){return n*(e[1]-e[0])+e[0]}var BG=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;r.type="ordinal";var i=r.getSetting("ordinalMeta");return i||(i=new Qz({})),fr(i)&&(i=new Qz({categories:xr(i,function(s){return $r(s)?s.value:s})})),r._ordinalMeta=i,r._extent=r.getSetting("extent")||[0,i.categories.length-1],r}return e.prototype.parse=function(t){return t==null?NaN:Dr(t)?this._ordinalMeta.getOrdinal(t):Math.round(t)},e.prototype.contain=function(t){return t=this.parse(t),_B(t,this._extent)&&this._ordinalMeta.categories[t]!=null},e.prototype.normalize=function(t){return t=this._getTickNumber(this.parse(t)),yB(t,this._extent)},e.prototype.scale=function(t){return t=Math.round(xB(t,this._extent)),this.getRawOrdinalNumber(t)},e.prototype.getTicks=function(){for(var t=[],r=this._extent,i=r[0];i<=r[1];)t.push({value:i}),i++;return t},e.prototype.getMinorTicks=function(t){},e.prototype.setSortInfo=function(t){if(t==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var r=t.ordinalNumbers,i=this._ordinalNumbersByTick=[],s=this._ticksByOrdinalNumber=[],o=0,l=this._ordinalMeta.categories.length,a=Math.min(l,r.length);o<a;++o){var h=r[o];i[o]=h,s[h]=o}for(var f=0;o<l;++o){for(;s[f]!=null;)f++;i.push(f),s[f]=o}},e.prototype._getTickNumber=function(t){var r=this._ticksByOrdinalNumber;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getRawOrdinalNumber=function(t){var r=this._ordinalNumbersByTick;return r&&t>=0&&t<r.length?r[t]:t},e.prototype.getLabel=function(t){if(!this.isBlank()){var r=this.getRawOrdinalNumber(t.value),i=this._ordinalMeta.categories[r];return i==null?"":i+""}},e.prototype.count=function(){return this._extent[1]-this._extent[0]+1},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.isInExtentRange=function(t){return t=this._getTickNumber(t),this._extent[0]<=t&&this._extent[1]>=t},e.prototype.getOrdinalMeta=function(){return this._ordinalMeta},e.prototype.calcNiceTicks=function(){},e.prototype.calcNiceExtent=function(){},e.type="ordinal",e}(Ap);Ap.registerClass(BG);var ty=To,Fw=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="interval",t._interval=0,t._intervalPrecision=2,t}return e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return _B(t,this._extent)},e.prototype.normalize=function(t){return yB(t,this._extent)},e.prototype.scale=function(t){return xB(t,this._extent)},e.prototype.setExtent=function(t,r){var i=this._extent;isNaN(t)||(i[0]=parseFloat(t)),isNaN(r)||(i[1]=parseFloat(r))},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1]),this.setExtent(r[0],r[1])},e.prototype.getInterval=function(){return this._interval},e.prototype.setInterval=function(t){this._interval=t,this._niceExtent=this._extent.slice(),this._intervalPrecision=boe(t)},e.prototype.getTicks=function(t){var r=this._interval,i=this._extent,s=this._niceExtent,o=this._intervalPrecision,l=[];if(!r)return l;var a=1e4;i[0]<s[0]&&(t?l.push({value:ty(s[0]-r,o)}):l.push({value:i[0]}));for(var h=s[0];h<=s[1]&&(l.push({value:h}),h=ty(h+r,o),h!==l[l.length-1].value);)if(l.length>a)return[];var f=l.length?l[l.length-1].value:s[1];return i[1]>f&&(t?l.push({value:ty(f+r,o)}):l.push({value:i[1]})),l},e.prototype.getMinorTicks=function(t){for(var r=this.getTicks(!0),i=[],s=this.getExtent(),o=1;o<r.length;o++){for(var l=r[o],a=r[o-1],h=0,f=[],p=l.value-a.value,v=p/t;h<t-1;){var y=ty(a.value+(h+1)*v);y>s[0]&&y<s[1]&&f.push(y),h++}i.push(f)}return i},e.prototype.getLabel=function(t,r){if(t==null)return"";var i=r&&r.precision;i==null?i=Dm(t.value)||0:i==="auto"&&(i=this._intervalPrecision);var s=ty(t.value,i,!0);return rae(s)},e.prototype.calcNiceTicks=function(t,r,i){t=t||5;var s=this._extent,o=s[1]-s[0];if(isFinite(o)){o<0&&(o=-o,s.reverse());var l=SDe(s,t,r,i);this._intervalPrecision=l.intervalPrecision,this._interval=l.interval,this._niceExtent=l.niceTickExtent}},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1])if(r[0]!==0){var i=Math.abs(r[0]);t.fixMax||(r[1]+=i/2),r[0]-=i/2}else r[1]=1;var s=r[1]-r[0];isFinite(s)||(r[0]=0,r[1]=1),this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval);var o=this._interval;t.fixMin||(r[0]=ty(Math.floor(r[0]/o)*o)),t.fixMax||(r[1]=ty(Math.ceil(r[1]/o)*o))},e.prototype.setNiceExtent=function(t,r){this._niceExtent=[t,r]},e.type="interval",e}(Ap);Ap.registerClass(Fw);var woe=typeof Float32Array<"u",TDe=woe?Float32Array:Array;function km(n){return fr(n)?woe?new Float32Array(n):n:new TDe(n)}var MDe="__ec_stack_";function kG(n){return n.get("stack")||MDe+n.seriesIndex}function OG(n){return n.dim+n.index}function Soe(n,e){var t=[];return e.eachSeriesByType(n,function(r){Toe(r)&&t.push(r)}),t}function EDe(n){var e={};it(n,function(a){var h=a.coordinateSystem,f=h.getBaseAxis();if(!(f.type!=="time"&&f.type!=="value"))for(var p=a.getData(),v=f.dim+"_"+f.index,y=p.getDimensionIndex(p.mapDimension(f.dim)),S=p.getStore(),C=0,M=S.count();C<M;++C){var E=S.get(y,C);e[v]?e[v].push(E):e[v]=[E]}});var t={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(i){i.sort(function(a,h){return a-h});for(var s=null,o=1;o<i.length;++o){var l=i[o]-i[o-1];l>0&&(s=s===null?l:Math.min(s,l))}t[r]=s}}return t}function Aoe(n){var e=EDe(n),t=[];return it(n,function(r){var i=r.coordinateSystem,s=i.getBaseAxis(),o=s.getExtent(),l;if(s.type==="category")l=s.getBandWidth();else if(s.type==="value"||s.type==="time"){var a=s.dim+"_"+s.index,h=e[a],f=Math.abs(o[1]-o[0]),p=s.scale.getExtent(),v=Math.abs(p[1]-p[0]);l=h?f/v*h:f}else{var y=r.getData();l=Math.abs(o[1]-o[0])/y.count()}var S=ls(r.get("barWidth"),l),C=ls(r.get("barMaxWidth"),l),M=ls(r.get("barMinWidth")||(Moe(r)?.5:1),l),E=r.get("barGap"),L=r.get("barCategoryGap");t.push({bandWidth:l,barWidth:S,barMaxWidth:C,barMinWidth:M,barGap:E,barCategoryGap:L,axisKey:OG(s),stackId:kG(r)})}),CDe(t)}function CDe(n){var e={};it(n,function(r,i){var s=r.axisKey,o=r.bandWidth,l=e[s]||{bandWidth:o,remainedWidth:o,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},a=l.stacks;e[s]=l;var h=r.stackId;a[h]||l.autoWidthCount++,a[h]=a[h]||{width:0,maxWidth:0};var f=r.barWidth;f&&!a[h].width&&(a[h].width=f,f=Math.min(l.remainedWidth,f),l.remainedWidth-=f);var p=r.barMaxWidth;p&&(a[h].maxWidth=p);var v=r.barMinWidth;v&&(a[h].minWidth=v);var y=r.barGap;y!=null&&(l.gap=y);var S=r.barCategoryGap;S!=null&&(l.categoryGap=S)});var t={};return it(e,function(r,i){t[i]={};var s=r.stacks,o=r.bandWidth,l=r.categoryGap;if(l==null){var a=aa(s).length;l=Math.max(35-a*4,15)+"%"}var h=ls(l,o),f=ls(r.gap,1),p=r.remainedWidth,v=r.autoWidthCount,y=(p-h)/(v+(v-1)*f);y=Math.max(y,0),it(s,function(E){var L=E.maxWidth,k=E.minWidth;if(E.width){var H=E.width;L&&(H=Math.min(H,L)),k&&(H=Math.max(H,k)),E.width=H,p-=H+f*H,v--}else{var H=y;L&&L<H&&(H=Math.min(L,p)),k&&k>H&&(H=k),H!==y&&(E.width=H,p-=H+f*H,v--)}}),y=(p-h)/(v+(v-1)*f),y=Math.max(y,0);var S=0,C;it(s,function(E,L){E.width||(E.width=y),C=E,S+=E.width*(1+f)}),C&&(S-=C.width*f);var M=-S/2;it(s,function(E,L){t[i][L]=t[i][L]||{bandWidth:o,offset:M,width:E.width},M+=E.width*(1+f)})}),t}function IDe(n,e,t){if(n&&e){var r=n[OG(e)];return r!=null&&t!=null?r[kG(t)]:r}}function RDe(n,e){var t=Soe(n,e),r=Aoe(t);it(t,function(i){var s=i.getData(),o=i.coordinateSystem,l=o.getBaseAxis(),a=kG(i),h=r[OG(l)][a],f=h.offset,p=h.width;s.setLayout({bandWidth:h.bandWidth,offset:f,size:p})})}function PDe(n){return{seriesType:n,plan:MG(),reset:function(e){if(Toe(e)){var t=e.getData(),r=e.coordinateSystem,i=r.getBaseAxis(),s=r.getOtherAxis(i),o=t.getDimensionIndex(t.mapDimension(s.dim)),l=t.getDimensionIndex(t.mapDimension(i.dim)),a=e.get("showBackground",!0),h=t.mapDimension(s.dim),f=t.getCalculationInfo("stackResultDimension"),p=ux(t,h)&&!!t.getCalculationInfo("stackedOnSeries"),v=s.isHorizontal(),y=LDe(i,s),S=Moe(e),C=e.get("barMinHeight")||0,M=f&&t.getDimensionIndex(f),E=t.getLayout("size"),L=t.getLayout("offset");return{progress:function(k,H){for(var X=k.count,Z=S&&km(X*3),Q=S&&a&&km(X*3),re=S&&km(X),ie=r.master.getRect(),oe=v?ie.width:ie.height,fe,Se=H.getStore(),Ee=0;(fe=k.next())!=null;){var Ie=Se.get(p?M:o,fe),He=Se.get(l,fe),Re=y,st=void 0;p&&(st=+Ie-Se.get(o,fe));var _e=void 0,We=void 0,Ue=void 0,vt=void 0;if(v){var xt=r.dataToPoint([Ie,He]);if(p){var Vt=r.dataToPoint([st,He]);Re=Vt[0]}_e=Re,We=xt[1]+L,Ue=xt[0]-Re,vt=E,Math.abs(Ue)<C&&(Ue=(Ue<0?-1:1)*C)}else{var xt=r.dataToPoint([He,Ie]);if(p){var Vt=r.dataToPoint([He,st]);Re=Vt[1]}_e=xt[0]+L,We=Re,Ue=E,vt=xt[1]-Re,Math.abs(vt)<C&&(vt=(vt<=0?-1:1)*C)}S?(Z[Ee]=_e,Z[Ee+1]=We,Z[Ee+2]=v?Ue:vt,Q&&(Q[Ee]=v?ie.x:_e,Q[Ee+1]=v?We:ie.y,Q[Ee+2]=oe),re[fe]=fe):H.setItemLayout(fe,{x:_e,y:We,width:Ue,height:vt}),Ee+=3}S&&H.setLayout({largePoints:Z,largeDataIndices:re,largeBackgroundPoints:Q,valueAxisHorizontal:v})}}}}}}function Toe(n){return n.coordinateSystem&&n.coordinateSystem.type==="cartesian2d"}function Moe(n){return n.pipelineContext&&n.pipelineContext.large}function LDe(n,e){var t=e.model.get("startValue");return t||(t=0),e.toGlobalCoord(e.dataToCoord(e.type==="log"?t>0?t:1:t))}var DDe=function(n,e,t,r){for(;t<r;){var i=t+r>>>1;n[i][1]<e?t=i+1:r=i}return t},Eoe=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="time",r}return e.prototype.getLabel=function(t){var r=this.getSetting("useUTC");return lB(t.value,bq[tRe(jb(this._minLevelUnit))]||bq.second,r,this.getSetting("locale"))},e.prototype.getFormattedLabel=function(t,r,i){var s=this.getSetting("useUTC"),o=this.getSetting("locale");return nRe(t,r,i,o,s)},e.prototype.getTicks=function(){var t=this._interval,r=this._extent,i=[];if(!t)return i;i.push({value:r[0],level:0});var s=this.getSetting("useUTC"),o=UDe(this._minLevelUnit,this._approxInterval,s,r);return i=i.concat(o),i.push({value:r[1],level:0}),i},e.prototype.calcNiceExtent=function(t){var r=this._extent;if(r[0]===r[1]&&(r[0]-=Ah,r[1]+=Ah),r[1]===-1/0&&r[0]===1/0){var i=new Date;r[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),r[0]=r[1]-Ah}this.calcNiceTicks(t.splitNumber,t.minInterval,t.maxInterval)},e.prototype.calcNiceTicks=function(t,r,i){t=t||10;var s=this._extent,o=s[1]-s[0];this._approxInterval=o/t,r!=null&&this._approxInterval<r&&(this._approxInterval=r),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var l=dI.length,a=Math.min(DDe(dI,this._approxInterval,0,l),l-1);this._interval=dI[a][1],this._minLevelUnit=dI[Math.max(a-1,0)][0]},e.prototype.parse=function(t){return Ps(t)?t:+eg(t)},e.prototype.contain=function(t){return _B(this.parse(t),this._extent)},e.prototype.normalize=function(t){return yB(this.parse(t),this._extent)},e.prototype.scale=function(t){return xB(t,this._extent)},e.type="time",e}(Fw),dI=[["second",mG],["minute",gG],["hour",yT],["quarter-day",yT*6],["half-day",yT*12],["day",Ah*1.2],["half-week",Ah*3.5],["week",Ah*7],["month",Ah*31],["quarter",Ah*95],["half-year",xq/2],["year",xq]];function BDe(n,e,t,r){var i=eg(e),s=eg(t),o=function(S){return wq(i,S,r)===wq(s,S,r)},l=function(){return o("year")},a=function(){return l()&&o("month")},h=function(){return a()&&o("day")},f=function(){return h()&&o("hour")},p=function(){return f()&&o("minute")},v=function(){return p()&&o("second")},y=function(){return v()&&o("millisecond")};switch(n){case"year":return l();case"month":return a();case"day":return h();case"hour":return f();case"minute":return p();case"second":return v();case"millisecond":return y()}}function kDe(n,e){return n/=Ah,n>16?16:n>7.5?7:n>3.5?4:n>1.5?2:1}function ODe(n){var e=30*Ah;return n/=e,n>6?6:n>3?3:n>2?2:1}function FDe(n){return n/=yT,n>12?12:n>6?6:n>3.5?4:n>2?2:1}function LZ(n,e){return n/=e?gG:mG,n>30?30:n>20?20:n>15?15:n>10?10:n>5?5:n>2?2:1}function NDe(n){return Hie(n)}function zDe(n,e,t){var r=new Date(n);switch(jb(e)){case"year":case"month":r[Kse(t)](0);case"day":r[Jse(t)](1);case"hour":r[Qse(t)](0);case"minute":r[eae(t)](0);case"second":r[tae(t)](0),r[nae(t)](0)}return r.getTime()}function UDe(n,e,t,r){var i=1e4,s=Zse,o=0;function l(oe,fe,Se,Ee,Ie,He,Re){for(var st=new Date(fe),_e=fe,We=st[Ee]();_e<Se&&_e<=r[1];)Re.push({value:_e}),We+=oe,st[Ie](We),_e=st.getTime();Re.push({value:_e,notAdd:!0})}function a(oe,fe,Se){var Ee=[],Ie=!fe.length;if(!BDe(jb(oe),r[0],r[1],t)){Ie&&(fe=[{value:zDe(new Date(r[0]),oe,t)},{value:r[1]}]);for(var He=0;He<fe.length-1;He++){var Re=fe[He].value,st=fe[He+1].value;if(Re!==st){var _e=void 0,We=void 0,Ue=void 0,vt=!1;switch(oe){case"year":_e=Math.max(1,Math.round(e/Ah/365)),We=vG(t),Ue=rRe(t);break;case"half-year":case"quarter":case"month":_e=ODe(e),We=Wb(t),Ue=Kse(t);break;case"week":case"half-week":case"day":_e=kDe(e),We=cB(t),Ue=Jse(t),vt=!0;break;case"half-day":case"quarter-day":case"hour":_e=FDe(e),We=yM(t),Ue=Qse(t);break;case"minute":_e=LZ(e,!0),We=uB(t),Ue=eae(t);break;case"second":_e=LZ(e,!1),We=hB(t),Ue=tae(t);break;case"millisecond":_e=NDe(e),We=fB(t),Ue=nae(t);break}l(_e,Re,st,We,Ue,vt,Ee),oe==="year"&&Se.length>1&&He===0&&Se.unshift({value:Se[0].value-_e})}}for(var He=0;He<Ee.length;He++)Se.push(Ee[He]);return Ee}}for(var h=[],f=[],p=0,v=0,y=0;y<s.length&&o++<i;++y){var S=jb(s[y]);if(eRe(s[y])){a(s[y],h[h.length-1]||[],f);var C=s[y+1]?jb(s[y+1]):null;if(S!==C){if(f.length){v=p,f.sort(function(oe,fe){return oe.value-fe.value});for(var M=[],E=0;E<f.length;++E){var L=f[E].value;(E===0||f[E-1].value!==L)&&(M.push(f[E]),L>=r[0]&&L<=r[1]&&p++)}var k=(r[1]-r[0])/e;if(p>k*1.5&&v>k/1.5||(h.push(M),p>k||n===s[y]))break}f=[]}}}for(var H=no(xr(h,function(oe){return no(oe,function(fe){return fe.value>=r[0]&&fe.value<=r[1]&&!fe.notAdd})}),function(oe){return oe.length>0}),X=[],Z=H.length-1,y=0;y<H.length;++y)for(var Q=H[y],re=0;re<Q.length;++re)X.push({value:Q[re].value,level:Z-y});X.sort(function(oe,fe){return oe.value-fe.value});for(var ie=[],y=0;y<X.length;++y)(y===0||X[y].value!==X[y-1].value)&&ie.push(X[y]);return ie}Ap.registerClass(Eoe);var DZ=Ap.prototype,ST=Fw.prototype,GDe=To,VDe=Math.floor,HDe=Math.ceil,pI=Math.pow,Pf=Math.log,FG=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="log",t.base=10,t._originalScale=new Fw,t._interval=0,t}return e.prototype.getTicks=function(t){var r=this._originalScale,i=this._extent,s=r.getExtent(),o=ST.getTicks.call(this,t);return xr(o,function(l){var a=l.value,h=To(pI(this.base,a));return h=a===i[0]&&this._fixMin?mI(h,s[0]):h,h=a===i[1]&&this._fixMax?mI(h,s[1]):h,{value:h}},this)},e.prototype.setExtent=function(t,r){var i=Pf(this.base);t=Pf(Math.max(0,t))/i,r=Pf(Math.max(0,r))/i,ST.setExtent.call(this,t,r)},e.prototype.getExtent=function(){var t=this.base,r=DZ.getExtent.call(this);r[0]=pI(t,r[0]),r[1]=pI(t,r[1]);var i=this._originalScale,s=i.getExtent();return this._fixMin&&(r[0]=mI(r[0],s[0])),this._fixMax&&(r[1]=mI(r[1],s[1])),r},e.prototype.unionExtent=function(t){this._originalScale.unionExtent(t);var r=this.base;t[0]=Pf(t[0])/Pf(r),t[1]=Pf(t[1])/Pf(r),DZ.unionExtent.call(this,t)},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.calcNiceTicks=function(t){t=t||10;var r=this._extent,i=r[1]-r[0];if(!(i===1/0||i<=0)){var s=hCe(i),o=t/i*s;for(o<=.5&&(s*=10);!isNaN(s)&&Math.abs(s)<1&&Math.abs(s)>0;)s*=10;var l=[To(HDe(r[0]/s)*s),To(VDe(r[1]/s)*s)];this._interval=s,this._niceExtent=l}},e.prototype.calcNiceExtent=function(t){ST.calcNiceExtent.call(this,t),this._fixMin=t.fixMin,this._fixMax=t.fixMax},e.prototype.parse=function(t){return t},e.prototype.contain=function(t){return t=Pf(t)/Pf(this.base),_B(t,this._extent)},e.prototype.normalize=function(t){return t=Pf(t)/Pf(this.base),yB(t,this._extent)},e.prototype.scale=function(t){return t=xB(t,this._extent),pI(this.base,t)},e.type="log",e}(Ap),Coe=FG.prototype;Coe.getMinorTicks=ST.getMinorTicks;Coe.getLabel=ST.getLabel;function mI(n,e){return GDe(n,Dm(e))}Ap.registerClass(FG);var jDe=function(){function n(e,t,r){this._prepareParams(e,t,r)}return n.prototype._prepareParams=function(e,t,r){r[1]<r[0]&&(r=[NaN,NaN]),this._dataMin=r[0],this._dataMax=r[1];var i=this._isOrdinal=e.type==="ordinal";this._needCrossZero=e.type==="interval"&&t.getNeedCrossZero&&t.getNeedCrossZero();var s=t.get("min",!0);s==null&&(s=t.get("startValue",!0));var o=this._modelMinRaw=s;ci(o)?this._modelMinNum=gI(e,o({min:r[0],max:r[1]})):o!=="dataMin"&&(this._modelMinNum=gI(e,o));var l=this._modelMaxRaw=t.get("max",!0);if(ci(l)?this._modelMaxNum=gI(e,l({min:r[0],max:r[1]})):l!=="dataMax"&&(this._modelMaxNum=gI(e,l)),i)this._axisDataLen=t.getCategories().length;else{var a=t.get("boundaryGap"),h=fr(a)?a:[a||0,a||0];typeof h[0]=="boolean"||typeof h[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[y0(h[0],1),y0(h[1],1)]}},n.prototype.calculate=function(){var e=this._isOrdinal,t=this._dataMin,r=this._dataMax,i=this._axisDataLen,s=this._boundaryGapInner,o=e?null:r-t||Math.abs(t),l=this._modelMinRaw==="dataMin"?t:this._modelMinNum,a=this._modelMaxRaw==="dataMax"?r:this._modelMaxNum,h=l!=null,f=a!=null;l==null&&(l=e?i?0:NaN:t-s[0]*o),a==null&&(a=e?i?i-1:NaN:r+s[1]*o),(l==null||!isFinite(l))&&(l=NaN),(a==null||!isFinite(a))&&(a=NaN);var p=DP(l)||DP(a)||e&&!i;this._needCrossZero&&(l>0&&a>0&&!h&&(l=0),l<0&&a<0&&!f&&(a=0));var v=this._determinedMin,y=this._determinedMax;return v!=null&&(l=v,h=!0),y!=null&&(a=y,f=!0),{min:l,max:a,minFixed:h,maxFixed:f,isBlank:p}},n.prototype.modifyDataMinMax=function(e,t){this[$De[e]]=t},n.prototype.setDeterminedMinMax=function(e,t){var r=WDe[e];this[r]=t},n.prototype.freeze=function(){this.frozen=!0},n}(),WDe={min:"_determinedMin",max:"_determinedMax"},$De={min:"_dataMin",max:"_dataMax"};function Ioe(n,e,t){var r=n.rawExtentInfo;return r||(r=new jDe(n,e,t),n.rawExtentInfo=r,r)}function gI(n,e){return e==null?null:DP(e)?NaN:n.parse(e)}function Roe(n,e){var t=n.type,r=Ioe(n,e,n.getExtent()).calculate();n.setBlank(r.isBlank);var i=r.min,s=r.max,o=e.ecModel;if(o&&t==="time"){var l=Soe("bar",o),a=!1;if(it(l,function(p){a=a||p.getBaseAxis()===e.axis}),a){var h=Aoe(l),f=XDe(i,s,e,h);i=f.min,s=f.max}}return{extent:[i,s],fixMin:r.minFixed,fixMax:r.maxFixed}}function XDe(n,e,t,r){var i=t.axis.getExtent(),s=i[1]-i[0],o=IDe(r,t.axis);if(o===void 0)return{min:n,max:e};var l=1/0;it(o,function(y){l=Math.min(y.offset,l)});var a=-1/0;it(o,function(y){a=Math.max(y.offset+y.width,a)}),l=Math.abs(l),a=Math.abs(a);var h=l+a,f=e-n,p=1-(l+a)/s,v=f/p-f;return e+=v*(a/h),n-=v*(l/h),{min:n,max:e}}function sL(n,e){var t=e,r=Roe(n,t),i=r.extent,s=t.get("splitNumber");n instanceof FG&&(n.base=t.get("logBase"));var o=n.type,l=t.get("interval"),a=o==="interval"||o==="time";n.setExtent(i[0],i[1]),n.calcNiceExtent({splitNumber:s,fixMin:r.fixMin,fixMax:r.fixMax,minInterval:a?t.get("minInterval"):null,maxInterval:a?t.get("maxInterval"):null}),l!=null&&n.setInterval&&n.setInterval(l)}function Poe(n,e){if(e=e||n.get("type"),e)switch(e){case"category":return new BG({ordinalMeta:n.getOrdinalMeta?n.getOrdinalMeta():n.getCategories(),extent:[1/0,-1/0]});case"time":return new Eoe({locale:n.ecModel.getLocaleModel(),useUTC:n.ecModel.get("useUTC")});default:return new(Ap.getClass(e)||Fw)}}function qDe(n){var e=n.scale.getExtent(),t=e[0],r=e[1];return!(t>0&&r>0||t<0&&r<0)}function Nw(n){var e=n.getLabelModel().get("formatter"),t=n.type==="category"?n.scale.getExtent()[0]:null;return n.scale.type==="time"?function(r){return function(i,s){return n.scale.getFormattedLabel(i,s,r)}}(e):Dr(e)?function(r){return function(i){var s=n.scale.getLabel(i),o=r.replace("{value}",s??"");return o}}(e):ci(e)?function(r){return function(i,s){return t!=null&&(s=i.value-t),r(NG(n,i),s,i.level!=null?{level:i.level}:null)}}(e):function(r){return n.scale.getLabel(r)}}function NG(n,e){return n.type==="category"?n.scale.getLabel(e):e.value}function ZDe(n){var e=n.model,t=n.scale;if(!(!e.get(["axisLabel","show"])||t.isBlank())){var r,i,s=t.getExtent();t instanceof BG?i=t.count():(r=t.getTicks(),i=r.length);var o=n.getLabelModel(),l=Nw(n),a,h=1;i>40&&(h=Math.ceil(i/40));for(var f=0;f<i;f+=h){var p=r?r[f]:{value:s[0]+f},v=l(p,f),y=o.getTextRect(v),S=YDe(y,o.get("rotate")||0);a?a.union(S):a=S}return a}}function YDe(n,e){var t=e*Math.PI/180,r=n.width,i=n.height,s=r*Math.abs(Math.cos(t))+Math.abs(i*Math.sin(t)),o=r*Math.abs(Math.sin(t))+Math.abs(i*Math.cos(t)),l=new cs(n.x,n.y,s,o);return l}function zG(n){var e=n.get("interval");return e??"auto"}function Loe(n){return n.type==="category"&&zG(n.getLabelModel())===0}function aL(n,e){var t={};return it(n.mapDimensionsAll(e),function(r){t[gDe(n,r)]=!0}),aa(t)}function KDe(n,e,t){e&&it(aL(e,t),function(r){var i=e.getApproximateExtent(r);i[0]<n[0]&&(n[0]=i[0]),i[1]>n[1]&&(n[1]=i[1])})}var Doe=function(){function n(){}return n.prototype.getNeedCrossZero=function(){var e=this.option;return!e.scale},n.prototype.getCoordSysModel=function(){},n}(),BZ=[],JDe={registerPreprocessor:hoe,registerProcessor:foe,registerPostInit:$Le,registerPostUpdate:XLe,registerUpdateLifecycle:PG,registerAction:Sp,registerCoordinateSystem:qLe,registerLayout:ZLe,registerVisual:Cx,registerTransform:KLe,registerLoading:doe,registerMap:YLe,registerImpl:MLe,PRIORITY:zLe,ComponentModel:as,ComponentView:Dc,SeriesModel:ed,ChartView:Ph,registerComponentModel:function(n){as.registerClass(n)},registerComponentView:function(n){Dc.registerClass(n)},registerSeriesModel:function(n){ed.registerClass(n)},registerChartView:function(n){Ph.registerClass(n)},registerSubTypeDefaulter:function(n,e){as.registerSubTypeDefaulter(n,e)},registerPainter:function(n,e){iCe(n,e)}};function _p(n){if(fr(n)){it(n,function(e){_p(e)});return}Xi(BZ,n)>=0||(BZ.push(n),ci(n)&&(n={install:n}),n.install(JDe))}var MM=qs();function Boe(n,e){var t=xr(e,function(r){return n.scale.parse(r)});return n.type==="time"&&t.length>0&&(t.sort(),t.unshift(t[0]),t.push(t[t.length-1])),t}function QDe(n){var e=n.getLabelModel().get("customValues");if(e){var t=Nw(n);return{labels:Boe(n,e).map(function(r){var i={value:r};return{formattedLabel:t(i),rawLabel:n.scale.getLabel(i),tickValue:r}})}}return n.type==="category"?tBe(n):rBe(n)}function eBe(n,e){var t=n.getTickModel().get("customValues");return t?{ticks:Boe(n,t)}:n.type==="category"?nBe(n,e):{ticks:xr(n.scale.getTicks(),function(r){return r.value})}}function tBe(n){var e=n.getLabelModel(),t=koe(n,e);return!e.get("show")||n.scale.isBlank()?{labels:[],labelCategoryInterval:t.labelCategoryInterval}:t}function koe(n,e){var t=Ooe(n,"labels"),r=zG(e),i=Foe(t,r);if(i)return i;var s,o;return ci(r)?s=Uoe(n,r):(o=r==="auto"?iBe(n):r,s=zoe(n,o)),Noe(t,r,{labels:s,labelCategoryInterval:o})}function nBe(n,e){var t=Ooe(n,"ticks"),r=zG(e),i=Foe(t,r);if(i)return i;var s,o;if((!e.get("show")||n.scale.isBlank())&&(s=[]),ci(r))s=Uoe(n,r,!0);else if(r==="auto"){var l=koe(n,n.getLabelModel());o=l.labelCategoryInterval,s=xr(l.labels,function(a){return a.tickValue})}else o=r,s=zoe(n,o,!0);return Noe(t,r,{ticks:s,tickCategoryInterval:o})}function rBe(n){var e=n.scale.getTicks(),t=Nw(n);return{labels:xr(e,function(r,i){return{level:r.level,formattedLabel:t(r,i),rawLabel:n.scale.getLabel(r),tickValue:r.value}})}}function Ooe(n,e){return MM(n)[e]||(MM(n)[e]=[])}function Foe(n,e){for(var t=0;t<n.length;t++)if(n[t].key===e)return n[t].value}function Noe(n,e,t){return n.push({key:e,value:t}),t}function iBe(n){var e=MM(n).autoInterval;return e??(MM(n).autoInterval=n.calculateCategoryInterval())}function sBe(n){var e=aBe(n),t=Nw(n),r=(e.axisRotate-e.labelRotate)/180*Math.PI,i=n.scale,s=i.getExtent(),o=i.count();if(s[1]-s[0]<1)return 0;var l=1;o>40&&(l=Math.max(1,Math.floor(o/40)));for(var a=s[0],h=n.dataToCoord(a+1)-n.dataToCoord(a),f=Math.abs(h*Math.cos(r)),p=Math.abs(h*Math.sin(r)),v=0,y=0;a<=s[1];a+=l){var S=0,C=0,M=gE(t({value:a}),e.font,"center","top");S=M.width*1.3,C=M.height*1.3,v=Math.max(v,S,7),y=Math.max(y,C,7)}var E=v/f,L=y/p;isNaN(E)&&(E=1/0),isNaN(L)&&(L=1/0);var k=Math.max(0,Math.floor(Math.min(E,L))),H=MM(n.model),X=n.getExtent(),Z=H.lastAutoInterval,Q=H.lastTickCount;return Z!=null&&Q!=null&&Math.abs(Z-k)<=1&&Math.abs(Q-o)<=1&&Z>k&&H.axisExtent0===X[0]&&H.axisExtent1===X[1]?k=Z:(H.lastTickCount=o,H.lastAutoInterval=k,H.axisExtent0=X[0],H.axisExtent1=X[1]),k}function aBe(n){var e=n.getLabelModel();return{axisRotate:n.getRotate?n.getRotate():n.isHorizontal&&!n.isHorizontal()?90:0,labelRotate:e.get("rotate")||0,font:e.getFont()}}function zoe(n,e,t){var r=Nw(n),i=n.scale,s=i.getExtent(),o=n.getLabelModel(),l=[],a=Math.max((e||0)+1,1),h=s[0],f=i.count();h!==0&&a>1&&f/a>2&&(h=Math.round(Math.ceil(h/a)*a));var p=Loe(n),v=o.get("showMinLabel")||p,y=o.get("showMaxLabel")||p;v&&h!==s[0]&&C(s[0]);for(var S=h;S<=s[1];S+=a)C(S);y&&S-a!==s[1]&&C(s[1]);function C(M){var E={value:M};l.push(t?M:{formattedLabel:r(E),rawLabel:i.getLabel(E),tickValue:M})}return l}function Uoe(n,e,t){var r=n.scale,i=Nw(n),s=[];return it(r.getTicks(),function(o){var l=r.getLabel(o),a=o.value;e(o.value,l)&&s.push(t?a:{formattedLabel:i(o),rawLabel:l,tickValue:a})}),s}var kZ=[0,1],Ix=function(){function n(e,t,r){this.onBand=!1,this.inverse=!1,this.dim=e,this.scale=t,this._extent=r||[0,0]}return n.prototype.contain=function(e){var t=this._extent,r=Math.min(t[0],t[1]),i=Math.max(t[0],t[1]);return e>=r&&e<=i},n.prototype.containData=function(e){return this.scale.contain(e)},n.prototype.getExtent=function(){return this._extent.slice()},n.prototype.getPixelPrecision=function(e){return Gie(e||this.scale.getExtent(),this._extent)},n.prototype.setExtent=function(e,t){var r=this._extent;r[0]=e,r[1]=t},n.prototype.dataToCoord=function(e,t){var r=this._extent,i=this.scale;return e=i.normalize(e),this.onBand&&i.type==="ordinal"&&(r=r.slice(),OZ(r,i.count())),Uv(e,kZ,r,t)},n.prototype.coordToData=function(e,t){var r=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(r=r.slice(),OZ(r,i.count()));var s=Uv(e,r,kZ,t);return this.scale.scale(s)},n.prototype.pointToData=function(e,t){},n.prototype.getTicksCoords=function(e){e=e||{};var t=e.tickModel||this.getTickModel(),r=eBe(this,t),i=r.ticks,s=xr(i,function(l){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(l):l),tickValue:l}},this),o=t.get("alignWithLabel");return oBe(this,s,o,e.clamp),s},n.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var e=this.model.getModel("minorTick"),t=e.get("splitNumber");t>0&&t<100||(t=5);var r=this.scale.getMinorTicks(t),i=xr(r,function(s){return xr(s,function(o){return{coord:this.dataToCoord(o),tickValue:o}},this)},this);return i},n.prototype.getViewLabels=function(){return QDe(this).labels},n.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},n.prototype.getTickModel=function(){return this.model.getModel("axisTick")},n.prototype.getBandWidth=function(){var e=this._extent,t=this.scale.getExtent(),r=t[1]-t[0]+(this.onBand?1:0);r===0&&(r=1);var i=Math.abs(e[1]-e[0]);return Math.abs(i)/r},n.prototype.calculateCategoryInterval=function(){return sBe(this)},n}();function OZ(n,e){var t=n[1]-n[0],r=e,i=t/r/2;n[0]+=i,n[1]-=i}function oBe(n,e,t,r){var i=e.length;if(!n.onBand||t||!i)return;var s=n.getExtent(),o,l;if(i===1)e[0].coord=s[0],o=e[1]={coord:s[1]};else{var a=e[i-1].tickValue-e[0].tickValue,h=(e[i-1].coord-e[0].coord)/a;it(e,function(y){y.coord-=h/2});var f=n.scale.getExtent();l=1+f[1]-e[i-1].tickValue,o={coord:e[i-1].coord+h*l},e.push(o)}var p=s[0]>s[1];v(e[0].coord,s[0])&&(r?e[0].coord=s[0]:e.shift()),r&&v(s[0],e[0].coord)&&e.unshift({coord:s[0]}),v(s[1],o.coord)&&(r?o.coord=s[1]:e.pop()),r&&v(o.coord,s[1])&&e.push({coord:s[1]});function v(y,S){return y=To(y),S=To(S),p?y>S:y<S}}var fA=Math.PI*2,ny=tg.CMD,lBe=["top","right","bottom","left"];function cBe(n,e,t,r,i){var s=t.width,o=t.height;switch(n){case"top":r.set(t.x+s/2,t.y-e),i.set(0,-1);break;case"bottom":r.set(t.x+s/2,t.y+o+e),i.set(0,1);break;case"left":r.set(t.x-e,t.y+o/2),i.set(-1,0);break;case"right":r.set(t.x+s+e,t.y+o/2),i.set(1,0);break}}function uBe(n,e,t,r,i,s,o,l,a){o-=n,l-=e;var h=Math.sqrt(o*o+l*l);o/=h,l/=h;var f=o*t+n,p=l*t+e;if(Math.abs(r-i)%fA<1e-4)return a[0]=f,a[1]=p,h-t;if(s){var v=r;r=Bm(i),i=Bm(v)}else r=Bm(r),i=Bm(i);r>i&&(i+=fA);var y=Math.atan2(l,o);if(y<0&&(y+=fA),y>=r&&y<=i||y+fA>=r&&y+fA<=i)return a[0]=f,a[1]=p,h-t;var S=t*Math.cos(r)+n,C=t*Math.sin(r)+e,M=t*Math.cos(i)+n,E=t*Math.sin(i)+e,L=(S-o)*(S-o)+(C-l)*(C-l),k=(M-o)*(M-o)+(E-l)*(E-l);return L<k?(a[0]=S,a[1]=C,Math.sqrt(L)):(a[0]=M,a[1]=E,Math.sqrt(k))}function oL(n,e,t,r,i,s,o,l){var a=i-n,h=s-e,f=t-n,p=r-e,v=Math.sqrt(f*f+p*p);f/=v,p/=v;var y=a*f+h*p,S=y/v;l&&(S=Math.min(Math.max(S,0),1)),S*=v;var C=o[0]=n+S*f,M=o[1]=e+S*p;return Math.sqrt((C-i)*(C-i)+(M-s)*(M-s))}function Goe(n,e,t,r,i,s,o){t<0&&(n=n+t,t=-t),r<0&&(e=e+r,r=-r);var l=n+t,a=e+r,h=o[0]=Math.min(Math.max(i,n),l),f=o[1]=Math.min(Math.max(s,e),a);return Math.sqrt((h-i)*(h-i)+(f-s)*(f-s))}var Ff=[];function hBe(n,e,t){var r=Goe(e.x,e.y,e.width,e.height,n.x,n.y,Ff);return t.set(Ff[0],Ff[1]),r}function fBe(n,e,t){for(var r=0,i=0,s=0,o=0,l,a,h=1/0,f=e.data,p=n.x,v=n.y,y=0;y<f.length;){var S=f[y++];y===1&&(r=f[y],i=f[y+1],s=r,o=i);var C=h;switch(S){case ny.M:s=f[y++],o=f[y++],r=s,i=o;break;case ny.L:C=oL(r,i,f[y],f[y+1],p,v,Ff,!0),r=f[y++],i=f[y++];break;case ny.C:C=Iie(r,i,f[y++],f[y++],f[y++],f[y++],f[y],f[y+1],p,v,Ff),r=f[y++],i=f[y++];break;case ny.Q:C=Pie(r,i,f[y++],f[y++],f[y],f[y+1],p,v,Ff),r=f[y++],i=f[y++];break;case ny.A:var M=f[y++],E=f[y++],L=f[y++],k=f[y++],H=f[y++],X=f[y++];y+=1;var Z=!!(1-f[y++]);l=Math.cos(H)*L+M,a=Math.sin(H)*k+E,y<=1&&(s=l,o=a);var Q=(p-M)*k/L+M;C=uBe(M,E,k,H,H+X,Z,Q,v,Ff),r=Math.cos(H+X)*L+M,i=Math.sin(H+X)*k+E;break;case ny.R:s=r=f[y++],o=i=f[y++];var re=f[y++],ie=f[y++];C=Goe(s,o,re,ie,p,v,Ff);break;case ny.Z:C=oL(r,i,s,o,p,v,Ff,!0),r=s,i=o;break}C<h&&(h=C,t.set(Ff[0],Ff[1]))}return h}var jf=new Jr,Fs=new Jr,eo=new Jr,sp=new Jr,ep=new Jr;function FZ(n,e){if(n){var t=n.getTextGuideLine(),r=n.getTextContent();if(r&&t){var i=n.textGuideLineConfig||{},s=[[0,0],[0,0],[0,0]],o=i.candidates||lBe,l=r.getBoundingRect().clone();l.applyTransform(r.getComputedTransform());var a=1/0,h=i.anchor,f=n.getComputedTransform(),p=f&&jD([],f),v=e.get("length2")||0;h&&eo.copy(h);for(var y=0;y<o.length;y++){var S=o[y];cBe(S,0,l,jf,sp),Jr.scaleAndAdd(Fs,jf,sp,v),Fs.transform(p);var C=n.getBoundingRect(),M=h?h.distance(Fs):n instanceof qi?fBe(Fs,n.path,eo):hBe(Fs,C,eo);M<a&&(a=M,Fs.transform(f),eo.transform(f),eo.toArray(s[0]),Fs.toArray(s[1]),jf.toArray(s[2]))}Voe(s,e.get("minTurnAngle")),t.setShape({points:s})}}}var lL=[],Sc=new Jr;function Voe(n,e){if(e<=180&&e>0){e=e/180*Math.PI,jf.fromArray(n[0]),Fs.fromArray(n[1]),eo.fromArray(n[2]),Jr.sub(sp,jf,Fs),Jr.sub(ep,eo,Fs);var t=sp.len(),r=ep.len();if(!(t<.001||r<.001)){sp.scale(1/t),ep.scale(1/r);var i=sp.dot(ep),s=Math.cos(e);if(s<i){var o=oL(Fs.x,Fs.y,eo.x,eo.y,jf.x,jf.y,lL,!1);Sc.fromArray(lL),Sc.scaleAndAdd(ep,o/Math.tan(Math.PI-e));var l=eo.x!==Fs.x?(Sc.x-Fs.x)/(eo.x-Fs.x):(Sc.y-Fs.y)/(eo.y-Fs.y);if(isNaN(l))return;l<0?Jr.copy(Sc,Fs):l>1&&Jr.copy(Sc,eo),Sc.toArray(n[1])}}}}function dBe(n,e,t){if(t<=180&&t>0){t=t/180*Math.PI,jf.fromArray(n[0]),Fs.fromArray(n[1]),eo.fromArray(n[2]),Jr.sub(sp,Fs,jf),Jr.sub(ep,eo,Fs);var r=sp.len(),i=ep.len();if(!(r<.001||i<.001)){sp.scale(1/r),ep.scale(1/i);var s=sp.dot(e),o=Math.cos(t);if(s<o){var l=oL(Fs.x,Fs.y,eo.x,eo.y,jf.x,jf.y,lL,!1);Sc.fromArray(lL);var a=Math.PI/2,h=Math.acos(ep.dot(e)),f=a+h-t;if(f>=a)Jr.copy(Sc,eo);else{Sc.scaleAndAdd(ep,l/Math.tan(Math.PI/2-f));var p=eo.x!==Fs.x?(Sc.x-Fs.x)/(eo.x-Fs.x):(Sc.y-Fs.y)/(eo.y-Fs.y);if(isNaN(p))return;p<0?Jr.copy(Sc,Fs):p>1&&Jr.copy(Sc,eo)}Sc.toArray(n[1])}}}}function B3(n,e,t,r){var i=t==="normal",s=i?n:n.ensureState(t);s.ignore=e;var o=r.get("smooth");o&&o===!0&&(o=.3),s.shape=s.shape||{},o>0&&(s.shape.smooth=o);var l=r.getModel("lineStyle").getLineStyle();i?n.useStyle(l):s.style=l}function pBe(n,e){var t=e.smooth,r=e.points;if(r)if(n.moveTo(r[0][0],r[0][1]),t>0&&r.length>=3){var i=uz(r[0],r[1]),s=uz(r[1],r[2]);if(!i||!s){n.lineTo(r[1][0],r[1][1]),n.lineTo(r[2][0],r[2][1]);return}var o=Math.min(i,s)*t,l=iR([],r[1],r[0],o/i),a=iR([],r[1],r[2],o/s),h=iR([],l,a,.5);n.bezierCurveTo(l[0],l[1],l[0],l[1],h[0],h[1]),n.bezierCurveTo(a[0],a[1],a[0],a[1],r[2][0],r[2][1])}else for(var f=1;f<r.length;f++)n.lineTo(r[f][0],r[f][1])}function Hoe(n,e,t){var r=n.getTextGuideLine(),i=n.getTextContent();if(!i){r&&n.removeTextGuideLine();return}for(var s=e.normal,o=s.get("show"),l=i.ignore,a=0;a<WP.length;a++){var h=WP[a],f=e[h],p=h==="normal";if(f){var v=f.get("show"),y=p?l:Ii(i.states[h]&&i.states[h].ignore,l);if(y||!Ii(v,o)){var S=p?r:r&&r.states[h];S&&(S.ignore=!0),r&&B3(r,!0,h,f);continue}r||(r=new Bw,n.setTextGuideLine(r),!p&&(l||!o)&&B3(r,!0,"normal",e.normal),n.stateProxy&&(r.stateProxy=n.stateProxy)),B3(r,!1,h,f)}}if(r){ti(r.style,t),r.style.fill=null;var C=s.get("showAbove"),M=n.textGuideLineConfig=n.textGuideLineConfig||{};M.showAbove=C||!1,r.buildPath=pBe}}function joe(n,e){e=e||"labelLine";for(var t={normal:n.getModel(e)},r=0;r<Fh.length;r++){var i=Fh[r];t[i]=n.getModel([i,e])}return t}function Woe(n){for(var e=[],t=0;t<n.length;t++){var r=n[t];if(!r.defaultAttr.ignore){var i=r.label,s=i.getComputedTransform(),o=i.getBoundingRect(),l=!s||s[1]<1e-5&&s[2]<1e-5,a=i.style.margin||0,h=o.clone();h.applyTransform(s),h.x-=a/2,h.y-=a/2,h.width+=a,h.height+=a;var f=l?new XP(o,s):null;e.push({label:i,labelLine:r.labelLine,rect:h,localRect:o,obb:f,priority:r.priority,defaultAttr:r.defaultAttr,layoutOption:r.computedLayoutOption,axisAligned:l,transform:s})}}return e}function $oe(n,e,t,r,i,s){var o=n.length;if(o<2)return;n.sort(function(re,ie){return re.rect[e]-ie.rect[e]});for(var l=0,a,h=!1,f=0,p=0;p<o;p++){var v=n[p],y=v.rect;a=y[e]-l,a<0&&(y[e]-=a,v.label[e]-=a,h=!0);var S=Math.max(-a,0);f+=S,l=y[e]+y[t]}f>0&&s&&X(-f/o,0,o);var C=n[0],M=n[o-1],E,L;k(),E<0&&Z(-E,.8),L<0&&Z(L,.8),k(),H(E,L,1),H(L,E,-1),k(),E<0&&Q(-E),L<0&&Q(L);function k(){E=C.rect[e]-r,L=i-M.rect[e]-M.rect[t]}function H(re,ie,oe){if(re<0){var fe=Math.min(ie,-re);if(fe>0){X(fe*oe,0,o);var Se=fe+re;Se<0&&Z(-Se*oe,1)}else Z(-re*oe,1)}}function X(re,ie,oe){re!==0&&(h=!0);for(var fe=ie;fe<oe;fe++){var Se=n[fe],Ee=Se.rect;Ee[e]+=re,Se.label[e]+=re}}function Z(re,ie){for(var oe=[],fe=0,Se=1;Se<o;Se++){var Ee=n[Se-1].rect,Ie=Math.max(n[Se].rect[e]-Ee[e]-Ee[t],0);oe.push(Ie),fe+=Ie}if(fe){var He=Math.min(Math.abs(re)/fe,ie);if(re>0)for(var Se=0;Se<o-1;Se++){var Re=oe[Se]*He;X(Re,0,Se+1)}else for(var Se=o-1;Se>0;Se--){var Re=oe[Se-1]*He;X(-Re,Se,o)}}}function Q(re){var ie=re<0?-1:1;re=Math.abs(re);for(var oe=Math.ceil(re/(o-1)),fe=0;fe<o-1;fe++)if(ie>0?X(oe,0,fe+1):X(-oe,o-fe-1,o),re-=oe,re<=0)return}return h}function mBe(n,e,t,r){return $oe(n,"x","width",e,t,r)}function Xoe(n,e,t,r){return $oe(n,"y","height",e,t,r)}function qoe(n){var e=[];n.sort(function(C,M){return M.priority-C.priority});var t=new cs(0,0,0,0);function r(C){if(!C.ignore){var M=C.ensureState("emphasis");M.ignore==null&&(M.ignore=!1)}C.ignore=!0}for(var i=0;i<n.length;i++){var s=n[i],o=s.axisAligned,l=s.localRect,a=s.transform,h=s.label,f=s.labelLine;t.copy(s.rect),t.width-=.1,t.height-=.1,t.x+=.05,t.y+=.05;for(var p=s.obb,v=!1,y=0;y<e.length;y++){var S=e[y];if(t.intersect(S.rect)){if(o&&S.axisAligned){v=!0;break}if(S.obb||(S.obb=new XP(S.localRect,S.transform)),p||(p=new XP(l,a)),p.intersect(S.obb)){v=!0;break}}}v?(r(h),f&&r(f)):(h.attr("ignore",s.defaultAttr.ignore),f&&f.attr("ignore",s.defaultAttr.labelGuideIgnore),e.push(s))}}function gBe(n){if(n){for(var e=[],t=0;t<n.length;t++)e.push(n[t].slice());return e}}function vBe(n,e){var t=n.label,r=e&&e.getTextGuideLine();return{dataIndex:n.dataIndex,dataType:n.dataType,seriesIndex:n.seriesModel.seriesIndex,text:n.label.style.text,rect:n.hostRect,labelRect:n.rect,align:t.style.align,verticalAlign:t.style.verticalAlign,labelLinePoints:gBe(r&&r.shape.points)}}var NZ=["align","verticalAlign","width","height","fontSize"],_c=new mE,k3=qs(),_Be=qs();function vI(n,e,t){for(var r=0;r<t.length;r++){var i=t[r];e[i]!=null&&(n[i]=e[i])}}var _I=["x","y","rotation"],yBe=function(){function n(){this._labelList=[],this._chartViewList=[]}return n.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},n.prototype._addLabel=function(e,t,r,i,s){var o=i.style,l=i.__hostTarget,a=l.textConfig||{},h=i.getComputedTransform(),f=i.getBoundingRect().plain();cs.applyTransform(f,f,h),h?_c.setLocalTransform(h):(_c.x=_c.y=_c.rotation=_c.originX=_c.originY=0,_c.scaleX=_c.scaleY=1),_c.rotation=Bm(_c.rotation);var p=i.__hostTarget,v;if(p){v=p.getBoundingRect().plain();var y=p.getComputedTransform();cs.applyTransform(v,v,y)}var S=v&&p.getTextGuideLine();this._labelList.push({label:i,labelLine:S,seriesModel:r,dataIndex:e,dataType:t,layoutOption:s,computedLayoutOption:null,rect:f,hostRect:v,priority:v?v.width*v.height:0,defaultAttr:{ignore:i.ignore,labelGuideIgnore:S&&S.ignore,x:_c.x,y:_c.y,scaleX:_c.scaleX,scaleY:_c.scaleY,rotation:_c.rotation,style:{x:o.x,y:o.y,align:o.align,verticalAlign:o.verticalAlign,width:o.width,height:o.height,fontSize:o.fontSize},cursor:i.cursor,attachedPos:a.position,attachedRot:a.rotation}})},n.prototype.addLabelsOfSeries=function(e){var t=this;this._chartViewList.push(e);var r=e.__model,i=r.get("labelLayout");(ci(i)||aa(i).length)&&e.group.traverse(function(s){if(s.ignore)return!0;var o=s.getTextContent(),l=$i(s);o&&!o.disableLabelLayout&&t._addLabel(l.dataIndex,l.dataType,r,o,i)})},n.prototype.updateLayoutConfig=function(e){var t=e.getWidth(),r=e.getHeight();function i(k,H){return function(){FZ(k,H)}}for(var s=0;s<this._labelList.length;s++){var o=this._labelList[s],l=o.label,a=l.__hostTarget,h=o.defaultAttr,f=void 0;ci(o.layoutOption)?f=o.layoutOption(vBe(o,a)):f=o.layoutOption,f=f||{},o.computedLayoutOption=f;var p=Math.PI/180;a&&a.setTextConfig({local:!1,position:f.x!=null||f.y!=null?null:h.attachedPos,rotation:f.rotate!=null?f.rotate*p:h.attachedRot,offset:[f.dx||0,f.dy||0]});var v=!1;if(f.x!=null?(l.x=ls(f.x,t),l.setStyle("x",0),v=!0):(l.x=h.x,l.setStyle("x",h.style.x)),f.y!=null?(l.y=ls(f.y,r),l.setStyle("y",0),v=!0):(l.y=h.y,l.setStyle("y",h.style.y)),f.labelLinePoints){var y=a.getTextGuideLine();y&&(y.setShape({points:f.labelLinePoints}),v=!1)}var S=k3(l);S.needsUpdateLabelLine=v,l.rotation=f.rotate!=null?f.rotate*p:h.rotation,l.scaleX=h.scaleX,l.scaleY=h.scaleY;for(var C=0;C<NZ.length;C++){var M=NZ[C];l.setStyle(M,f[M]!=null?f[M]:h.style[M])}if(f.draggable){if(l.draggable=!0,l.cursor="move",a){var E=o.seriesModel;if(o.dataIndex!=null){var L=o.seriesModel.getData(o.dataType);E=L.getItemModel(o.dataIndex)}l.on("drag",i(a,E.getModel("labelLine")))}}else l.off("drag"),l.cursor=h.cursor}},n.prototype.layout=function(e){var t=e.getWidth(),r=e.getHeight(),i=Woe(this._labelList),s=no(i,function(a){return a.layoutOption.moveOverlap==="shiftX"}),o=no(i,function(a){return a.layoutOption.moveOverlap==="shiftY"});mBe(s,0,t),Xoe(o,0,r);var l=no(i,function(a){return a.layoutOption.hideOverlap});qoe(l)},n.prototype.processLabelsOverall=function(){var e=this;it(this._chartViewList,function(t){var r=t.__model,i=t.ignoreLabelLineUpdate,s=r.isAnimationEnabled();t.group.traverse(function(o){if(o.ignore&&!o.forceLabelAnimation)return!0;var l=!i,a=o.getTextContent();!l&&a&&(l=k3(a).needsUpdateLabelLine),l&&e._updateLabelLine(o,r),s&&e._animateLabels(o,r)})})},n.prototype._updateLabelLine=function(e,t){var r=e.getTextContent(),i=$i(e),s=i.dataIndex;if(r&&s!=null){var o=t.getData(i.dataType),l=o.getItemModel(s),a={},h=o.getItemVisual(s,"style");if(h){var f=o.getVisual("drawType");a.stroke=h[f]}var p=l.getModel("labelLine");Hoe(e,joe(l),a),FZ(e,p)}},n.prototype._animateLabels=function(e,t){var r=e.getTextContent(),i=e.getTextGuideLine();if(r&&(e.forceLabelAnimation||!r.ignore&&!r.invisible&&!e.disableLabelAnimation&&!Vb(e))){var s=k3(r),o=s.oldLayout,l=$i(e),a=l.dataIndex,h={x:r.x,y:r.y,rotation:r.rotation},f=t.getData(l.dataType);if(o){r.attr(o);var v=e.prevStates;v&&(Xi(v,"select")>=0&&r.attr(s.oldLayoutSelect),Xi(v,"emphasis")>=0&&r.attr(s.oldLayoutEmphasis)),ol(r,h,t,a)}else if(r.attr(h),!kw(r).valueAnimation){var p=Ii(r.style.opacity,1);r.style.opacity=0,Yl(r,{style:{opacity:p}},t,a)}if(s.oldLayout=h,r.states.select){var y=s.oldLayoutSelect={};vI(y,h,_I),vI(y,r.states.select,_I)}if(r.states.emphasis){var S=s.oldLayoutEmphasis={};vI(S,h,_I),vI(S,r.states.emphasis,_I)}zIe(r,a,f,t,t)}if(i&&!i.ignore&&!i.invisible){var s=_Be(i),o=s.oldLayout,C={points:i.shape.points};o?(i.attr({shape:o}),ol(i,{shape:C},t)):(i.setShape(C),i.style.strokePercent=0,Yl(i,{style:{strokePercent:1}},t)),s.oldLayout=C}},n}(),O3=qs();function xBe(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){var i=O3(t).labelManager;i||(i=O3(t).labelManager=new yBe),i.clearLabels()}),n.registerUpdateLifecycle("series:layoutlabels",function(e,t,r){var i=O3(t).labelManager;r.updatedSeries.forEach(function(s){i.addLabelsOfSeries(t.getViewOfSeriesModel(s))}),i.updateLayoutConfig(t),i.layout(t),i.processLabelsOverall()})}var bBe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.hasSymbolVisual=!0,t}return e.prototype.getInitialData=function(t){return DG(null,this,{useEncodeDefaulter:!0})},e.prototype.getLegendIcon=function(t){var r=new go,i=dw("line",0,t.itemHeight/2,t.itemWidth,0,t.lineStyle.stroke,!1);r.add(i),i.setStyle(t.lineStyle);var s=this.getData().getVisual("symbol"),o=this.getData().getVisual("symbolRotate"),l=s==="none"?"circle":s,a=t.itemHeight*.8,h=dw(l,(t.itemWidth-a)/2,(t.itemHeight-a)/2,a,a,t.itemStyle.fill);r.add(h),h.setStyle(t.itemStyle);var f=t.iconRotate==="inherit"?o:t.iconRotate||0;return h.rotation=f*Math.PI/180,h.setOrigin([t.itemWidth/2,t.itemHeight/2]),l.indexOf("empty")>-1&&(h.style.stroke=h.style.fill,h.style.fill="#fff",h.style.lineWidth=2),r},e.type="series.line",e.dependencies=["grid","polar"],e.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},e}(ed);function UG(n,e){var t=n.mapDimensionsAll("defaultedLabel"),r=t.length;if(r===1){var i=fw(n,e,t[0]);return i!=null?i+"":null}else if(r){for(var s=[],o=0;o<t.length;o++)s.push(fw(n,e,t[o]));return s.join(" ")}}function Zoe(n,e){var t=n.mapDimensionsAll("defaultedLabel");if(!fr(e))return e+"";for(var r=[],i=0;i<t.length;i++){var s=n.getDimensionIndex(t[i]);s>=0&&r.push(e[s])}return r.join(" ")}var GG=function(n){Hn(e,n);function e(t,r,i,s){var o=n.call(this)||this;return o.updateData(t,r,i,s),o}return e.prototype._createSymbol=function(t,r,i,s,o){this.removeAll();var l=dw(t,-1,-1,2,2,null,o);l.attr({z2:100,culling:!0,scaleX:s[0]/2,scaleY:s[1]/2}),l.drift=wBe,this._symbolType=t,this.add(l)},e.prototype.stopSymbolAnimation=function(t){this.childAt(0).stopAnimation(null,t)},e.prototype.getSymbolType=function(){return this._symbolType},e.prototype.getSymbolPath=function(){return this.childAt(0)},e.prototype.highlight=function(){cw(this.childAt(0))},e.prototype.downplay=function(){uw(this.childAt(0))},e.prototype.setZ=function(t,r){var i=this.childAt(0);i.zlevel=t,i.z=r},e.prototype.setDraggable=function(t,r){var i=this.childAt(0);i.draggable=t,i.cursor=!r&&t?"move":i.cursor},e.prototype.updateData=function(t,r,i,s){this.silent=!1;var o=t.getItemVisual(r,"symbol")||"circle",l=t.hostModel,a=e.getSymbolSize(t,r),h=o!==this._symbolType,f=s&&s.disableAnimation;if(h){var p=t.getItemVisual(r,"symbolKeepAspect");this._createSymbol(o,t,r,a,p)}else{var v=this.childAt(0);v.silent=!1;var y={scaleX:a[0]/2,scaleY:a[1]/2};f?v.attr(y):ol(v,y,l,r),lG(v)}if(this._updateCommon(t,r,a,i,s),h){var v=this.childAt(0);if(!f){var y={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:v.style.opacity}};v.scaleX=v.scaleY=0,v.style.opacity=0,Yl(v,y,l,r)}}f&&this.childAt(0).stopAnimation("leave")},e.prototype._updateCommon=function(t,r,i,s,o){var l=this.childAt(0),a=t.hostModel,h,f,p,v,y,S,C,M,E;if(s&&(h=s.emphasisItemStyle,f=s.blurItemStyle,p=s.selectItemStyle,v=s.focus,y=s.blurScope,C=s.labelStatesModels,M=s.hoverScale,E=s.cursorStyle,S=s.emphasisDisabled),!s||t.hasItemOption){var L=s&&s.itemModel?s.itemModel:t.getItemModel(r),k=L.getModel("emphasis");h=k.getModel("itemStyle").getItemStyle(),p=L.getModel(["select","itemStyle"]).getItemStyle(),f=L.getModel(["blur","itemStyle"]).getItemStyle(),v=k.get("focus"),y=k.get("blurScope"),S=k.get("disabled"),C=xE(L),M=k.getShallow("scale"),E=L.getShallow("cursor")}var H=t.getItemVisual(r,"symbolRotate");l.attr("rotation",(H||0)*Math.PI/180||0);var X=jae(t.getItemVisual(r,"symbolOffset"),i);X&&(l.x=X[0],l.y=X[1]),E&&l.attr("cursor",E);var Z=t.getItemVisual(r,"style"),Q=Z.fill;if(l instanceof z0){var re=l.style;l.useStyle(Jn({image:re.image,x:re.x,y:re.y,width:re.width,height:re.height},Z))}else l.__isEmptyBrush?l.useStyle(Jn({},Z)):l.useStyle(Z),l.style.decal=null,l.setColor(Q,o&&o.symbolInnerColor),l.style.strokeNoScale=!0;var ie=t.getItemVisual(r,"liftZ"),oe=this._z2;ie!=null?oe==null&&(this._z2=l.z2,l.z2+=ie):oe!=null&&(l.z2=oe,this._z2=null);var fe=o&&o.useNameLabel;yE(l,C,{labelFetcher:a,labelDataIndex:r,defaultText:Se,inheritColor:Q,defaultOpacity:Z.opacity});function Se(He){return fe?t.getName(He):UG(t,He)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var Ee=l.ensureState("emphasis");Ee.style=h,l.ensureState("select").style=p,l.ensureState("blur").style=f;var Ie=M==null||M===!0?Math.max(1.1,3/this._sizeY):isFinite(M)&&M>0?+M:1;Ee.scaleX=this._sizeX*Ie,Ee.scaleY=this._sizeY*Ie,this.setSymbolScale(1),vM(this,v,y,S)},e.prototype.setSymbolScale=function(t){this.scaleX=this.scaleY=t},e.prototype.fadeOut=function(t,r,i){var s=this.childAt(0),o=$i(this).dataIndex,l=i&&i.animation;if(this.silent=s.silent=!0,i&&i.fadeLabel){var a=s.getTextContent();a&&qP(a,{style:{opacity:0}},r,{dataIndex:o,removeOpt:l,cb:function(){s.removeTextContent()}})}else s.removeTextContent();qP(s,{style:{opacity:0},scaleX:0,scaleY:0},r,{dataIndex:o,cb:t,removeOpt:l})},e.getSymbolSize=function(t,r){return cLe(t.getItemVisual(r,"symbolSize"))},e}(go);function wBe(n,e){this.parent.drift(n,e)}function F3(n,e,t,r){return e&&!isNaN(e[0])&&!isNaN(e[1])&&!(r.isIgnore&&r.isIgnore(t))&&!(r.clipShape&&!r.clipShape.contain(e[0],e[1]))&&n.getItemVisual(t,"symbol")!=="none"}function zZ(n){return n!=null&&!$r(n)&&(n={isIgnore:n}),n||{}}function UZ(n){var e=n.hostModel,t=e.getModel("emphasis");return{emphasisItemStyle:t.getModel("itemStyle").getItemStyle(),blurItemStyle:e.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:e.getModel(["select","itemStyle"]).getItemStyle(),focus:t.get("focus"),blurScope:t.get("blurScope"),emphasisDisabled:t.get("disabled"),hoverScale:t.get("scale"),labelStatesModels:xE(e),cursorStyle:e.get("cursor")}}var SBe=function(){function n(e){this.group=new go,this._SymbolCtor=e||GG}return n.prototype.updateData=function(e,t){this._progressiveEls=null,t=zZ(t);var r=this.group,i=e.hostModel,s=this._data,o=this._SymbolCtor,l=t.disableAnimation,a=UZ(e),h={disableAnimation:l},f=t.getSymbolPoint||function(p){return e.getItemLayout(p)};s||r.removeAll(),e.diff(s).add(function(p){var v=f(p);if(F3(e,v,p,t)){var y=new o(e,p,a,h);y.setPosition(v),e.setItemGraphicEl(p,y),r.add(y)}}).update(function(p,v){var y=s.getItemGraphicEl(v),S=f(p);if(!F3(e,S,p,t)){r.remove(y);return}var C=e.getItemVisual(p,"symbol")||"circle",M=y&&y.getSymbolType&&y.getSymbolType();if(!y||M&&M!==C)r.remove(y),y=new o(e,p,a,h),y.setPosition(S);else{y.updateData(e,p,a,h);var E={x:S[0],y:S[1]};l?y.attr(E):ol(y,E,i)}r.add(y),e.setItemGraphicEl(p,y)}).remove(function(p){var v=s.getItemGraphicEl(p);v&&v.fadeOut(function(){r.remove(v)},i)}).execute(),this._getSymbolPoint=f,this._data=e},n.prototype.updateLayout=function(){var e=this,t=this._data;t&&t.eachItemGraphicEl(function(r,i){var s=e._getSymbolPoint(i);r.setPosition(s),r.markRedraw()})},n.prototype.incrementalPrepareUpdate=function(e){this._seriesScope=UZ(e),this._data=null,this.group.removeAll()},n.prototype.incrementalUpdate=function(e,t,r){this._progressiveEls=[],r=zZ(r);function i(a){a.isGroup||(a.incremental=!0,a.ensureState("emphasis").hoverLayer=!0)}for(var s=e.start;s<e.end;s++){var o=t.getItemLayout(s);if(F3(t,o,s,r)){var l=new this._SymbolCtor(t,s,this._seriesScope);l.traverse(i),l.setPosition(o),this.group.add(l),t.setItemGraphicEl(s,l),this._progressiveEls.push(l)}}},n.prototype.eachRendered=function(e){aB(this._progressiveEls||this.group,e)},n.prototype.remove=function(e){var t=this.group,r=this._data;r&&e?r.eachItemGraphicEl(function(i){i.fadeOut(function(){t.remove(i)},r.hostModel)}):t.removeAll()},n}();function Yoe(n,e,t){var r=n.getBaseAxis(),i=n.getOtherAxis(r),s=ABe(i,t),o=r.dim,l=i.dim,a=e.mapDimension(l),h=e.mapDimension(o),f=l==="x"||l==="radius"?1:0,p=xr(n.dimensions,function(S){return e.mapDimension(S)}),v=!1,y=e.getCalculationInfo("stackResultDimension");return ux(e,p[0])&&(v=!0,p[0]=y),ux(e,p[1])&&(v=!0,p[1]=y),{dataDimsForPoint:p,valueStart:s,valueAxisDim:l,baseAxisDim:o,stacked:!!v,valueDim:a,baseDim:h,baseDataOffset:f,stackedOverDimension:e.getCalculationInfo("stackedOverDimension")}}function ABe(n,e){var t=0,r=n.scale.getExtent();return e==="start"?t=r[0]:e==="end"?t=r[1]:Ps(e)&&!isNaN(e)?t=e:r[0]>0?t=r[0]:r[1]<0&&(t=r[1]),t}function Koe(n,e,t,r){var i=NaN;n.stacked&&(i=t.get(t.getCalculationInfo("stackedOverDimension"),r)),isNaN(i)&&(i=n.valueStart);var s=n.baseDataOffset,o=[];return o[s]=t.get(n.baseDim,r),o[1-s]=i,e.dataToPoint(o)}function TBe(n,e){var t=[];return e.diff(n).add(function(r){t.push({cmd:"+",idx:r})}).update(function(r,i){t.push({cmd:"=",idx:i,idx1:r})}).remove(function(r){t.push({cmd:"-",idx:r})}).execute(),t}function MBe(n,e,t,r,i,s,o,l){for(var a=TBe(n,e),h=[],f=[],p=[],v=[],y=[],S=[],C=[],M=Yoe(i,e,o),E=n.getLayout("points")||[],L=e.getLayout("points")||[],k=0;k<a.length;k++){var H=a[k],X=!0,Z=void 0,Q=void 0;switch(H.cmd){case"=":Z=H.idx*2,Q=H.idx1*2;var re=E[Z],ie=E[Z+1],oe=L[Q],fe=L[Q+1];(isNaN(re)||isNaN(ie))&&(re=oe,ie=fe),h.push(re,ie),f.push(oe,fe),p.push(t[Z],t[Z+1]),v.push(r[Q],r[Q+1]),C.push(e.getRawIndex(H.idx1));break;case"+":var Se=H.idx,Ee=M.dataDimsForPoint,Ie=i.dataToPoint([e.get(Ee[0],Se),e.get(Ee[1],Se)]);Q=Se*2,h.push(Ie[0],Ie[1]),f.push(L[Q],L[Q+1]);var He=Koe(M,i,e,Se);p.push(He[0],He[1]),v.push(r[Q],r[Q+1]),C.push(e.getRawIndex(Se));break;case"-":X=!1}X&&(y.push(H),S.push(S.length))}S.sort(function(Ht,Qt){return C[Ht]-C[Qt]});for(var Re=h.length,st=km(Re),_e=km(Re),We=km(Re),Ue=km(Re),vt=[],k=0;k<S.length;k++){var xt=S[k],Vt=k*2,lt=xt*2;st[Vt]=h[lt],st[Vt+1]=h[lt+1],_e[Vt]=f[lt],_e[Vt+1]=f[lt+1],We[Vt]=p[lt],We[Vt+1]=p[lt+1],Ue[Vt]=v[lt],Ue[Vt+1]=v[lt+1],vt[k]=y[xt]}return{current:st,next:_e,stackedOnCurrent:We,stackedOnNext:Ue,status:vt}}var Tv=Math.min,Mv=Math.max;function Wy(n,e){return isNaN(n)||isNaN(e)}function t5(n,e,t,r,i,s,o,l,a){for(var h,f,p,v,y,S,C=t,M=0;M<r;M++){var E=e[C*2],L=e[C*2+1];if(C>=i||C<0)break;if(Wy(E,L)){if(a){C+=s;continue}break}if(C===t)n[s>0?"moveTo":"lineTo"](E,L),p=E,v=L;else{var k=E-h,H=L-f;if(k*k+H*H<.5){C+=s;continue}if(o>0){for(var X=C+s,Z=e[X*2],Q=e[X*2+1];Z===E&&Q===L&&M<r;)M++,X+=s,C+=s,Z=e[X*2],Q=e[X*2+1],E=e[C*2],L=e[C*2+1],k=E-h,H=L-f;var re=M+1;if(a)for(;Wy(Z,Q)&&re<r;)re++,X+=s,Z=e[X*2],Q=e[X*2+1];var ie=.5,oe=0,fe=0,Se=void 0,Ee=void 0;if(re>=r||Wy(Z,Q))y=E,S=L;else{oe=Z-h,fe=Q-f;var Ie=E-h,He=Z-E,Re=L-f,st=Q-L,_e=void 0,We=void 0;if(l==="x"){_e=Math.abs(Ie),We=Math.abs(He);var Ue=oe>0?1:-1;y=E-Ue*_e*o,S=L,Se=E+Ue*We*o,Ee=L}else if(l==="y"){_e=Math.abs(Re),We=Math.abs(st);var vt=fe>0?1:-1;y=E,S=L-vt*_e*o,Se=E,Ee=L+vt*We*o}else _e=Math.sqrt(Ie*Ie+Re*Re),We=Math.sqrt(He*He+st*st),ie=We/(We+_e),y=E-oe*o*(1-ie),S=L-fe*o*(1-ie),Se=E+oe*o*ie,Ee=L+fe*o*ie,Se=Tv(Se,Mv(Z,E)),Ee=Tv(Ee,Mv(Q,L)),Se=Mv(Se,Tv(Z,E)),Ee=Mv(Ee,Tv(Q,L)),oe=Se-E,fe=Ee-L,y=E-oe*_e/We,S=L-fe*_e/We,y=Tv(y,Mv(h,E)),S=Tv(S,Mv(f,L)),y=Mv(y,Tv(h,E)),S=Mv(S,Tv(f,L)),oe=E-y,fe=L-S,Se=E+oe*We/_e,Ee=L+fe*We/_e}n.bezierCurveTo(p,v,y,S,E,L),p=Se,v=Ee}else n.lineTo(E,L)}h=E,f=L,C+=s}return M}var Joe=function(){function n(){this.smooth=0,this.smoothConstraint=!0}return n}(),EBe=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polyline",r}return e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new Joe},e.prototype.buildPath=function(t,r){var i=r.points,s=0,o=i.length/2;if(r.connectNulls){for(;o>0&&Wy(i[o*2-2],i[o*2-1]);o--);for(;s<o&&Wy(i[s*2],i[s*2+1]);s++);}for(;s<o;)s+=t5(t,i,s,o,o,1,r.smooth,r.smoothMonotone,r.connectNulls)+1},e.prototype.getPointOn=function(t,r){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,s=i.data,o=tg.CMD,l,a,h=r==="x",f=[],p=0;p<s.length;){var v=s[p++],y=void 0,S=void 0,C=void 0,M=void 0,E=void 0,L=void 0,k=void 0;switch(v){case o.M:l=s[p++],a=s[p++];break;case o.L:if(y=s[p++],S=s[p++],k=h?(t-l)/(y-l):(t-a)/(S-a),k<=1&&k>=0){var H=h?(S-a)*k+a:(y-l)*k+l;return h?[t,H]:[H,t]}l=y,a=S;break;case o.C:y=s[p++],S=s[p++],C=s[p++],M=s[p++],E=s[p++],L=s[p++];var X=h?NP(l,y,C,E,t,f):NP(a,S,M,L,t,f);if(X>0)for(var Z=0;Z<X;Z++){var Q=f[Z];if(Q<=1&&Q>=0){var H=h?Vo(a,S,M,L,Q):Vo(l,y,C,E,Q);return h?[t,H]:[H,t]}}l=E,a=L;break}}},e}(qi),CBe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e}(Joe),IBe=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="ec-polygon",r}return e.prototype.getDefaultShape=function(){return new CBe},e.prototype.buildPath=function(t,r){var i=r.points,s=r.stackedOnPoints,o=0,l=i.length/2,a=r.smoothMonotone;if(r.connectNulls){for(;l>0&&Wy(i[l*2-2],i[l*2-1]);l--);for(;o<l&&Wy(i[o*2],i[o*2+1]);o++);}for(;o<l;){var h=t5(t,i,o,l,l,1,r.smooth,a,r.connectNulls);t5(t,s,o+h-1,h,l,-1,r.stackedOnSmooth,a,r.connectNulls),o+=h+1,t.closePath()}},e}(qi);function Qoe(n,e,t,r,i){var s=n.getArea(),o=s.x,l=s.y,a=s.width,h=s.height,f=t.get(["lineStyle","width"])||2;o-=f/2,l-=f/2,a+=f,h+=f,a=Math.ceil(a),o!==Math.floor(o)&&(o=Math.floor(o),a++);var p=new Ha({shape:{x:o,y:l,width:a,height:h}});if(e){var v=n.getBaseAxis(),y=v.isHorizontal(),S=v.inverse;y?(S&&(p.shape.x+=a),p.shape.width=0):(S||(p.shape.y+=h),p.shape.height=0);var C=ci(i)?function(M){i(M,p)}:null;Yl(p,{shape:{width:a,height:h,x:o,y:l}},t,null,r,C)}return p}function ele(n,e,t){var r=n.getArea(),i=To(r.r0,1),s=To(r.r,1),o=new Nh({shape:{cx:To(n.cx,1),cy:To(n.cy,1),r0:i,r:s,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}});if(e){var l=n.getBaseAxis().dim==="angle";l?o.shape.endAngle=r.startAngle:o.shape.r=i,Yl(o,{shape:{endAngle:r.endAngle,r:s}},t)}return o}function RBe(n,e,t,r,i){if(n){if(n.type==="polar")return ele(n,e,t);if(n.type==="cartesian2d")return Qoe(n,e,t,r,i)}else return null;return null}function VG(n,e){return n.type===e}function GZ(n,e){if(n.length===e.length){for(var t=0;t<n.length;t++)if(n[t]!==e[t])return;return!0}}function VZ(n){for(var e=1/0,t=1/0,r=-1/0,i=-1/0,s=0;s<n.length;){var o=n[s++],l=n[s++];isNaN(o)||(e=Math.min(o,e),r=Math.max(o,r)),isNaN(l)||(t=Math.min(l,t),i=Math.max(l,i))}return[[e,t],[r,i]]}function HZ(n,e){var t=VZ(n),r=t[0],i=t[1],s=VZ(e),o=s[0],l=s[1];return Math.max(Math.abs(r[0]-o[0]),Math.abs(r[1]-o[1]),Math.abs(i[0]-l[0]),Math.abs(i[1]-l[1]))}function jZ(n){return Ps(n)?n:n?.5:0}function PBe(n,e,t){if(!t.valueDim)return[];for(var r=e.count(),i=km(r*2),s=0;s<r;s++){var o=Koe(t,n,e,s);i[s*2]=o[0],i[s*2+1]=o[1]}return i}function Ev(n,e,t,r){var i=e.getBaseAxis(),s=i.dim==="x"||i.dim==="radius"?0:1,o=[],l=0,a=[],h=[],f=[],p=[];if(r){for(l=0;l<n.length;l+=2)!isNaN(n[l])&&!isNaN(n[l+1])&&p.push(n[l],n[l+1]);n=p}for(l=0;l<n.length-2;l+=2)switch(f[0]=n[l+2],f[1]=n[l+3],h[0]=n[l],h[1]=n[l+1],o.push(h[0],h[1]),t){case"end":a[s]=f[s],a[1-s]=h[1-s],o.push(a[0],a[1]);break;case"middle":var v=(h[s]+f[s])/2,y=[];a[s]=y[s]=v,a[1-s]=h[1-s],y[1-s]=f[1-s],o.push(a[0],a[1]),o.push(y[0],y[1]);break;default:a[s]=h[s],a[1-s]=f[1-s],o.push(a[0],a[1])}return o.push(n[l++],n[l++]),o}function LBe(n,e){var t=[],r=n.length,i,s;function o(f,p,v){var y=f.coord,S=(v-y)/(p.coord-y),C=PEe(S,[f.color,p.color]);return{coord:v,color:C}}for(var l=0;l<r;l++){var a=n[l],h=a.coord;if(h<0)i=a;else if(h>e){s?t.push(o(s,a,e)):i&&t.push(o(i,a,0),o(i,a,e));break}else i&&(t.push(o(i,a,0)),i=null),t.push(a),s=a}return t}function DBe(n,e,t){var r=n.getVisual("visualMeta");if(!(!r||!r.length||!n.count())&&e.type==="cartesian2d"){for(var i,s,o=r.length-1;o>=0;o--){var l=n.getDimensionInfo(r[o].dimension);if(i=l&&l.coordDim,i==="x"||i==="y"){s=r[o];break}}if(s){var a=e.getAxis(i),h=xr(s.stops,function(k){return{coord:a.toGlobalCoord(a.dataToCoord(k.value)),color:k.color}}),f=h.length,p=s.outerColors.slice();f&&h[0].coord>h[f-1].coord&&(h.reverse(),p.reverse());var v=LBe(h,i==="x"?t.getWidth():t.getHeight()),y=v.length;if(!y&&f)return h[0].coord<0?p[1]?p[1]:h[f-1].color:p[0]?p[0]:h[0].color;var S=10,C=v[0].coord-S,M=v[y-1].coord+S,E=M-C;if(E<.001)return"transparent";it(v,function(k){k.offset=(k.coord-C)/E}),v.push({offset:y?v[y-1].offset:.5,color:p[1]||"transparent"}),v.unshift({offset:y?v[0].offset:.5,color:p[0]||"transparent"});var L=new Bse(0,0,0,0,v,!0);return L[i]=C,L[i+"2"]=M,L}}}function BBe(n,e,t){var r=n.get("showAllSymbol"),i=r==="auto";if(!(r&&!i)){var s=t.getAxesByScale("ordinal")[0];if(s&&!(i&&kBe(s,e))){var o=e.mapDimension(s.dim),l={};return it(s.getViewLabels(),function(a){var h=s.scale.getRawOrdinalNumber(a.tickValue);l[h]=1}),function(a){return!l.hasOwnProperty(e.get(o,a))}}}}function kBe(n,e){var t=n.getExtent(),r=Math.abs(t[1]-t[0])/n.scale.count();isNaN(r)&&(r=0);for(var i=e.count(),s=Math.max(1,Math.round(i/5)),o=0;o<i;o+=s)if(GG.getSymbolSize(e,o)[n.isHorizontal()?1:0]*1.5>r)return!1;return!0}function OBe(n,e){return isNaN(n)||isNaN(e)}function FBe(n){for(var e=n.length/2;e>0&&OBe(n[e*2-2],n[e*2-1]);e--);return e-1}function WZ(n,e){return[n[e*2],n[e*2+1]]}function NBe(n,e,t){for(var r=n.length/2,i=t==="x"?0:1,s,o,l=0,a=-1,h=0;h<r;h++)if(o=n[h*2+i],!(isNaN(o)||isNaN(n[h*2+1-i]))){if(h===0){s=o;continue}if(s<=e&&o>=e||s>=e&&o<=e){a=h;break}l=h,s=o}return{range:[l,a],t:(e-s)/(o-s)}}function tle(n){if(n.get(["endLabel","show"]))return!0;for(var e=0;e<Fh.length;e++)if(n.get([Fh[e],"endLabel","show"]))return!0;return!1}function N3(n,e,t,r){if(VG(e,"cartesian2d")){var i=r.getModel("endLabel"),s=i.get("valueAnimation"),o=r.getData(),l={lastFrameIndex:0},a=tle(r)?function(y,S){n._endLabelOnDuring(y,S,o,l,s,i,e)}:null,h=e.getBaseAxis().isHorizontal(),f=Qoe(e,t,r,function(){var y=n._endLabel;y&&t&&l.originalX!=null&&y.attr({x:l.originalX,y:l.originalY})},a);if(!r.get("clip",!0)){var p=f.shape,v=Math.max(p.width,p.height);h?(p.y-=v,p.height+=v*2):(p.x-=v,p.width+=v*2)}return a&&a(1,f),f}else return ele(e,t,r)}function zBe(n,e){var t=e.getBaseAxis(),r=t.isHorizontal(),i=t.inverse,s=r?i?"right":"left":"center",o=r?"middle":i?"top":"bottom";return{normal:{align:n.get("align")||s,verticalAlign:n.get("verticalAlign")||o}}}var UBe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(){var t=new go,r=new SBe;this.group.add(r.group),this._symbolDraw=r,this._lineGroup=t},e.prototype.render=function(t,r,i){var s=this,o=t.coordinateSystem,l=this.group,a=t.getData(),h=t.getModel("lineStyle"),f=t.getModel("areaStyle"),p=a.getLayout("points")||[],v=o.type==="polar",y=this._coordSys,S=this._symbolDraw,C=this._polyline,M=this._polygon,E=this._lineGroup,L=!r.ssr&&t.get("animation"),k=!f.isEmpty(),H=f.get("origin"),X=Yoe(o,a,H),Z=k&&PBe(o,a,X),Q=t.get("showSymbol"),re=t.get("connectNulls"),ie=Q&&!v&&BBe(t,a,o),oe=this._data;oe&&oe.eachItemGraphicEl(function(Qt,rn){Qt.__temp&&(l.remove(Qt),oe.setItemGraphicEl(rn,null))}),Q||S.remove(),l.add(E);var fe=v?!1:t.get("step"),Se;o&&o.getArea&&t.get("clip",!0)&&(Se=o.getArea(),Se.width!=null?(Se.x-=.1,Se.y-=.1,Se.width+=.2,Se.height+=.2):Se.r0&&(Se.r0-=.5,Se.r+=.5)),this._clipShapeForSymbol=Se;var Ee=DBe(a,o,i)||a.getVisual("style")[a.getVisual("drawType")];if(!(C&&y.type===o.type&&fe===this._step))Q&&S.updateData(a,{isIgnore:ie,clipShape:Se,disableAnimation:!0,getSymbolPoint:function(Qt){return[p[Qt*2],p[Qt*2+1]]}}),L&&this._initSymbolLabelAnimation(a,o,Se),fe&&(p=Ev(p,o,fe,re),Z&&(Z=Ev(Z,o,fe,re))),C=this._newPolyline(p),k?M=this._newPolygon(p,Z):M&&(E.remove(M),M=this._polygon=null),v||this._initOrUpdateEndLabel(t,o,cx(Ee)),E.setClipPath(N3(this,o,!0,t));else{k&&!M?M=this._newPolygon(p,Z):M&&!k&&(E.remove(M),M=this._polygon=null),v||this._initOrUpdateEndLabel(t,o,cx(Ee));var Ie=E.getClipPath();if(Ie){var He=N3(this,o,!1,t);Yl(Ie,{shape:He.shape},t)}else E.setClipPath(N3(this,o,!0,t));Q&&S.updateData(a,{isIgnore:ie,clipShape:Se,disableAnimation:!0,getSymbolPoint:function(Qt){return[p[Qt*2],p[Qt*2+1]]}}),(!GZ(this._stackedOnPoints,Z)||!GZ(this._points,p))&&(L?this._doUpdateAnimation(a,Z,o,i,fe,H,re):(fe&&(p=Ev(p,o,fe,re),Z&&(Z=Ev(Z,o,fe,re))),C.setShape({points:p}),M&&M.setShape({points:p,stackedOnPoints:Z})))}var Re=t.getModel("emphasis"),st=Re.get("focus"),_e=Re.get("blurScope"),We=Re.get("disabled");if(C.useStyle(ti(h.getLineStyle(),{fill:"none",stroke:Ee,lineJoin:"bevel"})),$P(C,t,"lineStyle"),C.style.lineWidth>0&&t.get(["emphasis","lineStyle","width"])==="bolder"){var Ue=C.getState("emphasis").style;Ue.lineWidth=+C.style.lineWidth+1}$i(C).seriesIndex=t.seriesIndex,vM(C,st,_e,We);var vt=jZ(t.get("smooth")),xt=t.get("smoothMonotone");if(C.setShape({smooth:vt,smoothMonotone:xt,connectNulls:re}),M){var Vt=a.getCalculationInfo("stackedOnSeries"),lt=0;M.useStyle(ti(f.getAreaStyle(),{fill:Ee,opacity:.7,lineJoin:"bevel",decal:a.getVisual("style").decal})),Vt&&(lt=jZ(Vt.get("smooth"))),M.setShape({smooth:vt,stackedOnSmooth:lt,smoothMonotone:xt,connectNulls:re}),$P(M,t,"areaStyle"),$i(M).seriesIndex=t.seriesIndex,vM(M,st,_e,We)}var Ht=function(Qt){s._changePolyState(Qt)};a.eachItemGraphicEl(function(Qt){Qt&&(Qt.onHoverStateChange=Ht)}),this._polyline.onHoverStateChange=Ht,this._data=a,this._coordSys=o,this._stackedOnPoints=Z,this._points=p,this._step=fe,this._valueOrigin=H,t.get("triggerLineEvent")&&(this.packEventData(t,C),M&&this.packEventData(t,M))},e.prototype.packEventData=function(t,r){$i(r).eventData={componentType:"series",componentSubType:"line",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"line"}},e.prototype.highlight=function(t,r,i,s){var o=t.getData(),l=lx(o,s);if(this._changePolyState("emphasis"),!(l instanceof Array)&&l!=null&&l>=0){var a=o.getLayout("points"),h=o.getItemGraphicEl(l);if(!h){var f=a[l*2],p=a[l*2+1];if(isNaN(f)||isNaN(p)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(f,p))return;var v=t.get("zlevel")||0,y=t.get("z")||0;h=new GG(o,l),h.x=f,h.y=p,h.setZ(v,y);var S=h.getSymbolPath().getTextContent();S&&(S.zlevel=v,S.z=y,S.z2=this._polyline.z2+1),h.__temp=!0,o.setItemGraphicEl(l,h),h.stopSymbolAnimation(!0),this.group.add(h)}h.highlight()}else Ph.prototype.highlight.call(this,t,r,i,s)},e.prototype.downplay=function(t,r,i,s){var o=t.getData(),l=lx(o,s);if(this._changePolyState("normal"),l!=null&&l>=0){var a=o.getItemGraphicEl(l);a&&(a.__temp?(o.setItemGraphicEl(l,null),this.group.remove(a)):a.downplay())}else Ph.prototype.downplay.call(this,t,r,i,s)},e.prototype._changePolyState=function(t){var r=this._polygon;eq(this._polyline,t),r&&eq(r,t)},e.prototype._newPolyline=function(t){var r=this._polyline;return r&&this._lineGroup.remove(r),r=new EBe({shape:{points:t},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(r),this._polyline=r,r},e.prototype._newPolygon=function(t,r){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new IBe({shape:{points:t,stackedOnPoints:r},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},e.prototype._initSymbolLabelAnimation=function(t,r,i){var s,o,l=r.getBaseAxis(),a=l.inverse;r.type==="cartesian2d"?(s=l.isHorizontal(),o=!1):r.type==="polar"&&(s=l.dim==="angle",o=!0);var h=t.hostModel,f=h.get("animationDuration");ci(f)&&(f=f(null));var p=h.get("animationDelay")||0,v=ci(p)?p(null):p;t.eachItemGraphicEl(function(y,S){var C=y;if(C){var M=[y.x,y.y],E=void 0,L=void 0,k=void 0;if(i)if(o){var H=i,X=r.pointToCoord(M);s?(E=H.startAngle,L=H.endAngle,k=-X[1]/180*Math.PI):(E=H.r0,L=H.r,k=X[0])}else{var Z=i;s?(E=Z.x,L=Z.x+Z.width,k=y.x):(E=Z.y+Z.height,L=Z.y,k=y.y)}var Q=L===E?0:(k-E)/(L-E);a&&(Q=1-Q);var re=ci(p)?p(S):f*Q+v,ie=C.getSymbolPath(),oe=ie.getTextContent();C.attr({scaleX:0,scaleY:0}),C.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:re}),oe&&oe.animateFrom({style:{opacity:0}},{duration:300,delay:re}),ie.disableLabelAnimation=!0}})},e.prototype._initOrUpdateEndLabel=function(t,r,i){var s=t.getModel("endLabel");if(tle(t)){var o=t.getData(),l=this._polyline,a=o.getLayout("points");if(!a){l.removeTextContent(),this._endLabel=null;return}var h=this._endLabel;h||(h=this._endLabel=new Io({z2:200}),h.ignoreClip=!0,l.setTextContent(this._endLabel),l.disableLabelAnimation=!0);var f=FBe(a);f>=0&&(yE(l,xE(t,"endLabel"),{inheritColor:i,labelFetcher:t,labelDataIndex:f,defaultText:function(p,v,y){return y!=null?Zoe(o,y):UG(o,p)},enableTextSetter:!0},zBe(s,r)),l.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},e.prototype._endLabelOnDuring=function(t,r,i,s,o,l,a){var h=this._endLabel,f=this._polyline;if(h){t<1&&s.originalX==null&&(s.originalX=h.x,s.originalY=h.y);var p=i.getLayout("points"),v=i.hostModel,y=v.get("connectNulls"),S=l.get("precision"),C=l.get("distance")||0,M=a.getBaseAxis(),E=M.isHorizontal(),L=M.inverse,k=r.shape,H=L?E?k.x:k.y+k.height:E?k.x+k.width:k.y,X=(E?C:0)*(L?-1:1),Z=(E?0:-C)*(L?-1:1),Q=E?"x":"y",re=NBe(p,H,Q),ie=re.range,oe=ie[1]-ie[0],fe=void 0;if(oe>=1){if(oe>1&&!y){var Se=WZ(p,ie[0]);h.attr({x:Se[0]+X,y:Se[1]+Z}),o&&(fe=v.getRawValue(ie[0]))}else{var Se=f.getPointOn(H,Q);Se&&h.attr({x:Se[0]+X,y:Se[1]+Z});var Ee=v.getRawValue(ie[0]),Ie=v.getRawValue(ie[1]);o&&(fe=Yie(i,S,Ee,Ie,re.t))}s.lastFrameIndex=ie[0]}else{var He=t===1||s.lastFrameIndex>0?ie[0]:0,Se=WZ(p,He);o&&(fe=v.getRawValue(He)),h.attr({x:Se[0]+X,y:Se[1]+Z})}if(o){var Re=kw(h);typeof Re.setLabelText=="function"&&Re.setLabelText(fe)}}},e.prototype._doUpdateAnimation=function(t,r,i,s,o,l,a){var h=this._polyline,f=this._polygon,p=t.hostModel,v=MBe(this._data,t,this._stackedOnPoints,r,this._coordSys,i,this._valueOrigin),y=v.current,S=v.stackedOnCurrent,C=v.next,M=v.stackedOnNext;if(o&&(y=Ev(v.current,i,o,a),S=Ev(v.stackedOnCurrent,i,o,a),C=Ev(v.next,i,o,a),M=Ev(v.stackedOnNext,i,o,a)),HZ(y,C)>3e3||f&&HZ(S,M)>3e3){h.stopAnimation(),h.setShape({points:C}),f&&(f.stopAnimation(),f.setShape({points:C,stackedOnPoints:M}));return}h.shape.__points=v.current,h.shape.points=y;var E={shape:{points:C}};v.current!==y&&(E.shape.__points=v.next),h.stopAnimation(),ol(h,E,p),f&&(f.setShape({points:y,stackedOnPoints:S}),f.stopAnimation(),ol(f,{shape:{stackedOnPoints:M}},p),h.shape.points!==f.shape.points&&(f.shape.points=h.shape.points));for(var L=[],k=v.status,H=0;H<k.length;H++){var X=k[H].cmd;if(X==="="){var Z=t.getItemGraphicEl(k[H].idx1);Z&&L.push({el:Z,ptIdx:H})}}h.animators&&h.animators.length&&h.animators[0].during(function(){f&&f.dirtyShape();for(var Q=h.shape.__points,re=0;re<L.length;re++){var ie=L[re].el,oe=L[re].ptIdx*2;ie.x=Q[oe],ie.y=Q[oe+1],ie.markRedraw()}})},e.prototype.remove=function(t){var r=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(s,o){s.__temp&&(r.remove(s),i.setItemGraphicEl(o,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},e.type="line",e}(Ph);function GBe(n,e){return{seriesType:n,plan:MG(),reset:function(t){var r=t.getData(),i=t.coordinateSystem;if(t.pipelineContext,!!i){var s=xr(i.dimensions,function(p){return r.mapDimension(p)}).slice(0,2),o=s.length,l=r.getCalculationInfo("stackResultDimension");ux(r,s[0])&&(s[0]=l),ux(r,s[1])&&(s[1]=l);var a=r.getStore(),h=r.getDimensionIndex(s[0]),f=r.getDimensionIndex(s[1]);return o&&{progress:function(p,v){for(var y=p.end-p.start,S=km(y*o),C=[],M=[],E=p.start,L=0;E<p.end;E++){var k=void 0;if(o===1){var H=a.get(h,E);k=i.dataToPoint(H,null,M)}else C[0]=a.get(h,E),C[1]=a.get(f,E),k=i.dataToPoint(C,null,M);S[L++]=k[0],S[L++]=k[1]}v.setLayout("points",S)}}}}}}var VBe={average:function(n){for(var e=0,t=0,r=0;r<n.length;r++)isNaN(n[r])||(e+=n[r],t++);return t===0?NaN:e/t},sum:function(n){for(var e=0,t=0;t<n.length;t++)e+=n[t]||0;return e},max:function(n){for(var e=-1/0,t=0;t<n.length;t++)n[t]>e&&(e=n[t]);return isFinite(e)?e:NaN},min:function(n){for(var e=1/0,t=0;t<n.length;t++)n[t]<e&&(e=n[t]);return isFinite(e)?e:NaN},minmax:function(n){for(var e=-1/0,t=-1/0,r=0;r<n.length;r++){var i=n[r],s=Math.abs(i);s>e&&(e=s,t=i)}return isFinite(t)?t:NaN},nearest:function(n){return n[0]}},HBe=function(n){return Math.round(n.length/2)};function nle(n){return{seriesType:n,reset:function(e,t,r){var i=e.getData(),s=e.get("sampling"),o=e.coordinateSystem,l=i.count();if(l>10&&o.type==="cartesian2d"&&s){var a=o.getBaseAxis(),h=o.getOtherAxis(a),f=a.getExtent(),p=r.getDevicePixelRatio(),v=Math.abs(f[1]-f[0])*(p||1),y=Math.round(l/v);if(isFinite(y)&&y>1){s==="lttb"&&e.setData(i.lttbDownSample(i.mapDimension(h.dim),1/y));var S=void 0;Dr(s)?S=VBe[s]:ci(s)&&(S=s),S&&e.setData(i.downSample(i.mapDimension(h.dim),1/y,S,HBe))}}}}}function jBe(n){n.registerChartView(UBe),n.registerSeriesModel(bBe),n.registerLayout(GBe("line")),n.registerVisual({seriesType:"line",reset:function(e){var t=e.getData(),r=e.getModel("lineStyle").getLineStyle();r&&!r.stroke&&(r.stroke=t.getVisual("style").fill),t.setVisual("legendLineStyle",r)}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,nle("line"))}var n5=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(t,r){return DG(null,this,{useEncodeDefaulter:!0})},e.prototype.getMarkerPosition=function(t,r,i){var s=this.coordinateSystem;if(s&&s.clampData){var o=s.clampData(t),l=s.dataToPoint(o);if(i)it(s.getAxes(),function(v,y){if(v.type==="category"&&r!=null){var S=v.getTicksCoords(),C=v.getTickModel().get("alignWithLabel"),M=o[y],E=r[y]==="x1"||r[y]==="y1";if(E&&!C&&(M+=1),S.length<2)return;if(S.length===2){l[y]=v.toGlobalCoord(v.getExtent()[E?1:0]);return}for(var L=void 0,k=void 0,H=1,X=0;X<S.length;X++){var Z=S[X].coord,Q=X===S.length-1?S[X-1].tickValue+H:S[X].tickValue;if(Q===M){k=Z;break}else if(Q<M)L=Z;else if(L!=null&&Q>M){k=(Z+L)/2;break}X===1&&(H=Q-S[0].tickValue)}k==null&&(L?L&&(k=S[S.length-1].coord):k=S[0].coord),l[y]=v.toGlobalCoord(k)}});else{var a=this.getData(),h=a.getLayout("offset"),f=a.getLayout("size"),p=s.getBaseAxis().isHorizontal()?0:1;l[p]+=h+f/2}return l}return[NaN,NaN]},e.type="series.__base_bar__",e.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},e}(ed);ed.registerClass(n5);var WBe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.getInitialData=function(){return DG(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},e.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},e.prototype.getProgressiveThreshold=function(){var t=this.get("progressiveThreshold"),r=this.get("largeThreshold");return r>t&&(t=r),t},e.prototype.brushSelector=function(t,r,i){return i.rect(r.getItemLayout(t))},e.type="series.bar",e.dependencies=["grid","polar"],e.defaultOption=$se(n5.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),e}(n5),$Be=function(){function n(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return n}(),$Z=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="sausage",r}return e.prototype.getDefaultShape=function(){return new $Be},e.prototype.buildPath=function(t,r){var i=r.cx,s=r.cy,o=Math.max(r.r0||0,0),l=Math.max(r.r,0),a=(l-o)*.5,h=o+a,f=r.startAngle,p=r.endAngle,v=r.clockwise,y=Math.PI*2,S=v?p-f<y:f-p<y;S||(f=p-(v?y:-y));var C=Math.cos(f),M=Math.sin(f),E=Math.cos(p),L=Math.sin(p);S?(t.moveTo(C*o+i,M*o+s),t.arc(C*h+i,M*h+s,a,-Math.PI+f,f,!v)):t.moveTo(C*l+i,M*l+s),t.arc(i,s,l,f,p,!v),t.arc(E*h+i,L*h+s,a,p-Math.PI*2,p-Math.PI,!v),o!==0&&t.arc(i,s,o,p,f,v)},e}(qi);function XBe(n,e){e=e||{};var t=e.isRoundCap;return function(r,i,s){var o=i.position;if(!o||o instanceof Array)return VP(r,i,s);var l=n(o),a=i.distance!=null?i.distance:5,h=this.shape,f=h.cx,p=h.cy,v=h.r,y=h.r0,S=(v+y)/2,C=h.startAngle,M=h.endAngle,E=(C+M)/2,L=t?Math.abs(v-y)/2:0,k=Math.cos,H=Math.sin,X=f+v*k(C),Z=p+v*H(C),Q="left",re="top";switch(l){case"startArc":X=f+(y-a)*k(E),Z=p+(y-a)*H(E),Q="center",re="top";break;case"insideStartArc":X=f+(y+a)*k(E),Z=p+(y+a)*H(E),Q="center",re="bottom";break;case"startAngle":X=f+S*k(C)+yI(C,a+L,!1),Z=p+S*H(C)+xI(C,a+L,!1),Q="right",re="middle";break;case"insideStartAngle":X=f+S*k(C)+yI(C,-a+L,!1),Z=p+S*H(C)+xI(C,-a+L,!1),Q="left",re="middle";break;case"middle":X=f+S*k(E),Z=p+S*H(E),Q="center",re="middle";break;case"endArc":X=f+(v+a)*k(E),Z=p+(v+a)*H(E),Q="center",re="bottom";break;case"insideEndArc":X=f+(v-a)*k(E),Z=p+(v-a)*H(E),Q="center",re="top";break;case"endAngle":X=f+S*k(M)+yI(M,a+L,!0),Z=p+S*H(M)+xI(M,a+L,!0),Q="left",re="middle";break;case"insideEndAngle":X=f+S*k(M)+yI(M,-a+L,!0),Z=p+S*H(M)+xI(M,-a+L,!0),Q="right",re="middle";break;default:return VP(r,i,s)}return r=r||{},r.x=X,r.y=Z,r.align=Q,r.verticalAlign=re,r}}function qBe(n,e,t,r){if(Ps(r)){n.setTextConfig({rotation:r});return}else if(fr(e)){n.setTextConfig({rotation:0});return}var i=n.shape,s=i.clockwise?i.startAngle:i.endAngle,o=i.clockwise?i.endAngle:i.startAngle,l=(s+o)/2,a,h=t(e);switch(h){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":a=l;break;case"startAngle":case"insideStartAngle":a=s;break;case"endAngle":case"insideEndAngle":a=o;break;default:n.setTextConfig({rotation:0});return}var f=Math.PI*1.5-a;h==="middle"&&f>Math.PI/2&&f<Math.PI*1.5&&(f-=Math.PI),n.setTextConfig({rotation:f})}function yI(n,e,t){return e*Math.sin(n)*(t?-1:1)}function xI(n,e,t){return e*Math.cos(n)*(t?1:-1)}function zA(n,e,t){var r=n.get("borderRadius");if(r==null)return t?{cornerRadius:0}:null;fr(r)||(r=[r,r,r,r]);var i=Math.abs(e.r||0-e.r0||0);return{cornerRadius:xr(r,function(s){return y0(s,i)})}}var z3=Math.max,U3=Math.min;function ZBe(n,e){var t=n.getArea&&n.getArea();if(VG(n,"cartesian2d")){var r=n.getBaseAxis();if(r.type!=="category"||!r.onBand){var i=e.getLayout("bandWidth");r.isHorizontal()?(t.x-=i,t.width+=i*2):(t.y-=i,t.height+=i*2)}}return t}var YBe=function(n){Hn(e,n);function e(){var t=n.call(this)||this;return t.type=e.type,t._isFirstFrame=!0,t}return e.prototype.render=function(t,r,i,s){this._model=t,this._removeOnRenderedListener(i),this._updateDrawMode(t);var o=t.get("coordinateSystem");(o==="cartesian2d"||o==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(t,r,i):this._renderNormal(t,r,i,s))},e.prototype.incrementalPrepareRender=function(t){this._clear(),this._updateDrawMode(t),this._updateLargeClip(t)},e.prototype.incrementalRender=function(t,r){this._progressiveEls=[],this._incrementalRenderLarge(t,r)},e.prototype.eachRendered=function(t){aB(this._progressiveEls||this.group,t)},e.prototype._updateDrawMode=function(t){var r=t.pipelineContext.large;(this._isLargeDraw==null||r!==this._isLargeDraw)&&(this._isLargeDraw=r,this._clear())},e.prototype._renderNormal=function(t,r,i,s){var o=this.group,l=t.getData(),a=this._data,h=t.coordinateSystem,f=h.getBaseAxis(),p;h.type==="cartesian2d"?p=f.isHorizontal():h.type==="polar"&&(p=f.dim==="angle");var v=t.isAnimationEnabled()?t:null,y=KBe(t,h);y&&this._enableRealtimeSort(y,l,i);var S=t.get("clip",!0)||y,C=ZBe(h,l);o.removeClipPath();var M=t.get("roundCap",!0),E=t.get("showBackground",!0),L=t.getModel("backgroundStyle"),k=L.get("borderRadius")||0,H=[],X=this._backgroundEls,Z=s&&s.isInitSort,Q=s&&s.type==="changeAxisOrder";function re(fe){var Se=bI[h.type](l,fe),Ee=ike(h,p,Se);return Ee.useStyle(L.getItemStyle()),h.type==="cartesian2d"?Ee.setShape("r",k):Ee.setShape("cornerRadius",k),H[fe]=Ee,Ee}l.diff(a).add(function(fe){var Se=l.getItemModel(fe),Ee=bI[h.type](l,fe,Se);if(E&&re(fe),!(!l.hasValue(fe)||!KZ[h.type](Ee))){var Ie=!1;S&&(Ie=XZ[h.type](C,Ee));var He=qZ[h.type](t,l,fe,Ee,p,v,f.model,!1,M);y&&(He.forceLabelAnimation=!0),JZ(He,l,fe,Se,Ee,t,p,h.type==="polar"),Z?He.attr({shape:Ee}):y?ZZ(y,v,He,Ee,fe,p,!1,!1):Yl(He,{shape:Ee},t,fe),l.setItemGraphicEl(fe,He),o.add(He),He.ignore=Ie}}).update(function(fe,Se){var Ee=l.getItemModel(fe),Ie=bI[h.type](l,fe,Ee);if(E){var He=void 0;X.length===0?He=re(Se):(He=X[Se],He.useStyle(L.getItemStyle()),h.type==="cartesian2d"?He.setShape("r",k):He.setShape("cornerRadius",k),H[fe]=He);var Re=bI[h.type](l,fe),st=ile(p,Re,h);ol(He,{shape:st},v,fe)}var _e=a.getItemGraphicEl(Se);if(!l.hasValue(fe)||!KZ[h.type](Ie)){o.remove(_e);return}var We=!1;if(S&&(We=XZ[h.type](C,Ie),We&&o.remove(_e)),_e?lG(_e):_e=qZ[h.type](t,l,fe,Ie,p,v,f.model,!!_e,M),y&&(_e.forceLabelAnimation=!0),Q){var Ue=_e.getTextContent();if(Ue){var vt=kw(Ue);vt.prevValue!=null&&(vt.prevValue=vt.value)}}else JZ(_e,l,fe,Ee,Ie,t,p,h.type==="polar");Z?_e.attr({shape:Ie}):y?ZZ(y,v,_e,Ie,fe,p,!0,Q):ol(_e,{shape:Ie},t,fe,null),l.setItemGraphicEl(fe,_e),_e.ignore=We,o.add(_e)}).remove(function(fe){var Se=a.getItemGraphicEl(fe);Se&&ZP(Se,t,fe)}).execute();var ie=this._backgroundGroup||(this._backgroundGroup=new go);ie.removeAll();for(var oe=0;oe<H.length;++oe)ie.add(H[oe]);o.add(ie),this._backgroundEls=H,this._data=l},e.prototype._renderLarge=function(t,r,i){this._clear(),eY(t,this.group),this._updateLargeClip(t)},e.prototype._incrementalRenderLarge=function(t,r){this._removeBackground(),eY(r,this.group,this._progressiveEls,!0)},e.prototype._updateLargeClip=function(t){var r=t.get("clip",!0)&&RBe(t.coordinateSystem,!1,t),i=this.group;r?i.setClipPath(r):i.removeClipPath()},e.prototype._enableRealtimeSort=function(t,r,i){var s=this;if(r.count()){var o=t.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(r,t,i),this._isFirstFrame=!1;else{var l=function(a){var h=r.getItemGraphicEl(a),f=h&&h.shape;return f&&Math.abs(o.isHorizontal()?f.height:f.width)||0};this._onRendered=function(){s._updateSortWithinSameData(r,l,o,i)},i.getZr().on("rendered",this._onRendered)}}},e.prototype._dataSort=function(t,r,i){var s=[];return t.each(t.mapDimension(r.dim),function(o,l){var a=i(l);a=a??NaN,s.push({dataIndex:l,mappedValue:a,ordinalNumber:o})}),s.sort(function(o,l){return l.mappedValue-o.mappedValue}),{ordinalNumbers:xr(s,function(o){return o.ordinalNumber})}},e.prototype._isOrderChangedWithinSameData=function(t,r,i){for(var s=i.scale,o=t.mapDimension(i.dim),l=Number.MAX_VALUE,a=0,h=s.getOrdinalMeta().categories.length;a<h;++a){var f=t.rawIndexOf(o,s.getRawOrdinalNumber(a)),p=f<0?Number.MIN_VALUE:r(t.indexOfRawIndex(f));if(p>l)return!0;l=p}return!1},e.prototype._isOrderDifferentInView=function(t,r){for(var i=r.scale,s=i.getExtent(),o=Math.max(0,s[0]),l=Math.min(s[1],i.getOrdinalMeta().categories.length-1);o<=l;++o)if(t.ordinalNumbers[o]!==i.getRawOrdinalNumber(o))return!0},e.prototype._updateSortWithinSameData=function(t,r,i,s){if(this._isOrderChangedWithinSameData(t,r,i)){var o=this._dataSort(t,i,r);this._isOrderDifferentInView(o,i)&&(this._removeOnRenderedListener(s),s.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:o}))}},e.prototype._dispatchInitSort=function(t,r,i){var s=r.baseAxis,o=this._dataSort(t,s,function(l){return t.get(t.mapDimension(r.otherAxis.dim),l)});i.dispatchAction({type:"changeAxisOrder",componentType:s.dim+"Axis",isInitSort:!0,axisId:s.index,sortInfo:o})},e.prototype.remove=function(t,r){this._clear(this._model),this._removeOnRenderedListener(r)},e.prototype.dispose=function(t,r){this._removeOnRenderedListener(r)},e.prototype._removeOnRenderedListener=function(t){this._onRendered&&(t.getZr().off("rendered",this._onRendered),this._onRendered=null)},e.prototype._clear=function(t){var r=this.group,i=this._data;t&&t.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(s){ZP(s,t,$i(s).dataIndex)})):r.removeAll(),this._data=null,this._isFirstFrame=!0},e.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},e.type="bar",e}(Ph),XZ={cartesian2d:function(n,e){var t=e.width<0?-1:1,r=e.height<0?-1:1;t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height);var i=n.x+n.width,s=n.y+n.height,o=z3(e.x,n.x),l=U3(e.x+e.width,i),a=z3(e.y,n.y),h=U3(e.y+e.height,s),f=l<o,p=h<a;return e.x=f&&o>i?l:o,e.y=p&&a>s?h:a,e.width=f?0:l-o,e.height=p?0:h-a,t<0&&(e.x+=e.width,e.width=-e.width),r<0&&(e.y+=e.height,e.height=-e.height),f||p},polar:function(n,e){var t=e.r0<=e.r?1:-1;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}var i=U3(e.r,n.r),s=z3(e.r0,n.r0);e.r=i,e.r0=s;var o=i-s<0;if(t<0){var r=e.r;e.r=e.r0,e.r0=r}return o}},qZ={cartesian2d:function(n,e,t,r,i,s,o,l,a){var h=new Ha({shape:Jn({},r),z2:1});if(h.__dataIndex=t,h.name="item",s){var f=h.shape,p=i?"height":"width";f[p]=0}return h},polar:function(n,e,t,r,i,s,o,l,a){var h=!i&&a?$Z:Nh,f=new h({shape:r,z2:1});f.name="item";var p=rle(i);if(f.calculateTextPosition=XBe(p,{isRoundCap:h===$Z}),s){var v=f.shape,y=i?"r":"endAngle",S={};v[y]=i?r.r0:r.startAngle,S[y]=r[y],(l?ol:Yl)(f,{shape:S},s)}return f}};function KBe(n,e){var t=n.get("realtimeSort",!0),r=e.getBaseAxis();if(t&&r.type==="category"&&e.type==="cartesian2d")return{baseAxis:r,otherAxis:e.getOtherAxis(r)}}function ZZ(n,e,t,r,i,s,o,l){var a,h;s?(h={x:r.x,width:r.width},a={y:r.y,height:r.height}):(h={y:r.y,height:r.height},a={x:r.x,width:r.width}),l||(o?ol:Yl)(t,{shape:a},e,i,null);var f=e?n.baseAxis.model:null;(o?ol:Yl)(t,{shape:h},f,i)}function YZ(n,e){for(var t=0;t<e.length;t++)if(!isFinite(n[e[t]]))return!0;return!1}var JBe=["x","y","width","height"],QBe=["cx","cy","r","startAngle","endAngle"],KZ={cartesian2d:function(n){return!YZ(n,JBe)},polar:function(n){return!YZ(n,QBe)}},bI={cartesian2d:function(n,e,t){var r=n.getItemLayout(e),i=t?tke(t,r):0,s=r.width>0?1:-1,o=r.height>0?1:-1;return{x:r.x+s*i/2,y:r.y+o*i/2,width:r.width-s*i,height:r.height-o*i}},polar:function(n,e,t){var r=n.getItemLayout(e);return{cx:r.cx,cy:r.cy,r0:r.r0,r:r.r,startAngle:r.startAngle,endAngle:r.endAngle,clockwise:r.clockwise}}};function eke(n){return n.startAngle!=null&&n.endAngle!=null&&n.startAngle===n.endAngle}function rle(n){return function(e){var t=e?"Arc":"Angle";return function(r){switch(r){case"start":case"insideStart":case"end":case"insideEnd":return r+t;default:return r}}}(n)}function JZ(n,e,t,r,i,s,o,l){var a=e.getItemVisual(t,"style");if(l){if(!s.get("roundCap")){var f=n.shape,p=zA(r.getModel("itemStyle"),f,!0);Jn(f,p),n.setShape(f)}}else{var h=r.get(["itemStyle","borderRadius"])||0;n.setShape("r",h)}n.useStyle(a);var v=r.getShallow("cursor");v&&n.attr("cursor",v);var y=l?o?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":o?i.height>=0?"bottom":"top":i.width>=0?"right":"left",S=xE(r);yE(n,S,{labelFetcher:s,labelDataIndex:t,defaultText:UG(s.getData(),t),inheritColor:a.fill,defaultOpacity:a.opacity,defaultOutsidePosition:y});var C=n.getTextContent();if(l&&C){var M=r.get(["label","position"]);n.textConfig.inside=M==="middle"?!0:null,qBe(n,M==="outside"?y:M,rle(o),r.get(["label","rotate"]))}NIe(C,S,s.getRawValue(t),function(L){return Zoe(e,L)});var E=r.getModel(["emphasis"]);vM(n,E.get("focus"),E.get("blurScope"),E.get("disabled")),$P(n,r),eke(i)&&(n.style.fill="none",n.style.stroke="none",it(n.states,function(L){L.style&&(L.style.fill=L.style.stroke="none")}))}function tke(n,e){var t=n.get(["itemStyle","borderColor"]);if(!t||t==="none")return 0;var r=n.get(["itemStyle","borderWidth"])||0,i=isNaN(e.width)?Number.MAX_VALUE:Math.abs(e.width),s=isNaN(e.height)?Number.MAX_VALUE:Math.abs(e.height);return Math.min(r,i,s)}var nke=function(){function n(){}return n}(),QZ=function(n){Hn(e,n);function e(t){var r=n.call(this,t)||this;return r.type="largeBar",r}return e.prototype.getDefaultShape=function(){return new nke},e.prototype.buildPath=function(t,r){for(var i=r.points,s=this.baseDimIdx,o=1-this.baseDimIdx,l=[],a=[],h=this.barWidth,f=0;f<i.length;f+=3)a[s]=h,a[o]=i[f+2],l[s]=i[f+s],l[o]=i[f+o],t.rect(l[0],l[1],a[0],a[1])},e}(qi);function eY(n,e,t,r){var i=n.getData(),s=i.getLayout("valueAxisHorizontal")?1:0,o=i.getLayout("largeDataIndices"),l=i.getLayout("size"),a=n.getModel("backgroundStyle"),h=i.getLayout("largeBackgroundPoints");if(h){var f=new QZ({shape:{points:h},incremental:!!r,silent:!0,z2:0});f.baseDimIdx=s,f.largeDataIndices=o,f.barWidth=l,f.useStyle(a.getItemStyle()),e.add(f),t&&t.push(f)}var p=new QZ({shape:{points:i.getLayout("largePoints")},incremental:!!r,ignoreCoarsePointer:!0,z2:1});p.baseDimIdx=s,p.largeDataIndices=o,p.barWidth=l,e.add(p),p.useStyle(i.getVisual("style")),$i(p).seriesIndex=n.seriesIndex,n.get("silent")||(p.on("mousedown",tY),p.on("mousemove",tY)),t&&t.push(p)}var tY=EG(function(n){var e=this,t=rke(e,n.offsetX,n.offsetY);$i(e).dataIndex=t>=0?t:null},30,!1);function rke(n,e,t){for(var r=n.baseDimIdx,i=1-r,s=n.shape.points,o=n.largeDataIndices,l=[],a=[],h=n.barWidth,f=0,p=s.length/3;f<p;f++){var v=f*3;if(a[r]=h,a[i]=s[v+2],l[r]=s[v+r],l[i]=s[v+i],a[i]<0&&(l[i]+=a[i],a[i]=-a[i]),e>=l[0]&&e<=l[0]+a[0]&&t>=l[1]&&t<=l[1]+a[1])return o[f]}return-1}function ile(n,e,t){if(VG(t,"cartesian2d")){var r=e,i=t.getArea();return{x:n?r.x:i.x,y:n?i.y:r.y,width:n?r.width:i.width,height:n?i.height:r.height}}else{var i=t.getArea(),s=e;return{cx:i.cx,cy:i.cy,r0:n?i.r0:s.r0,r:n?i.r:s.r,startAngle:n?s.startAngle:0,endAngle:n?s.endAngle:Math.PI*2}}}function ike(n,e,t){var r=n.type==="polar"?Nh:Ha;return new r({shape:ile(e,t,n),silent:!0,z2:0})}function ske(n){n.registerChartView(YBe),n.registerSeriesModel(WBe),n.registerLayout(n.PRIORITY.VISUAL.LAYOUT,_s(RDe,"bar")),n.registerLayout(n.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,PDe("bar")),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,nle("bar")),n.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(e,t){var r=e.componentType||"series";t.eachComponent({mainType:r,query:e},function(i){e.sortInfo&&i.axis.setCategorySortInfo(e.sortInfo)})})}var nY=Math.PI*2,wI=Math.PI/180;function sle(n,e){return b0(n.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function ale(n,e){var t=sle(n,e),r=n.get("center"),i=n.get("radius");fr(i)||(i=[0,i]);var s=ls(t.width,e.getWidth()),o=ls(t.height,e.getHeight()),l=Math.min(s,o),a=ls(i[0],l/2),h=ls(i[1],l/2),f,p,v=n.coordinateSystem;if(v){var y=v.dataToPoint(r);f=y[0]||0,p=y[1]||0}else fr(r)||(r=[r,r]),f=ls(r[0],s)+t.x,p=ls(r[1],o)+t.y;return{cx:f,cy:p,r0:a,r:h}}function ake(n,e,t){e.eachSeriesByType(n,function(r){var i=r.getData(),s=i.mapDimension("value"),o=sle(r,t),l=ale(r,t),a=l.cx,h=l.cy,f=l.r,p=l.r0,v=-r.get("startAngle")*wI,y=r.get("endAngle"),S=r.get("padAngle")*wI;y=y==="auto"?v-nY:-y*wI;var C=r.get("minAngle")*wI,M=C+S,E=0;i.each(s,function(st){!isNaN(st)&&E++});var L=i.getSum(s),k=Math.PI/(L||E)*2,H=r.get("clockwise"),X=r.get("roseType"),Z=r.get("stillShowZeroSum"),Q=i.getDataExtent(s);Q[0]=0;var re=H?1:-1,ie=[v,y],oe=re*S/2;ise(ie,!H),v=ie[0],y=ie[1];var fe=ole(r);fe.startAngle=v,fe.endAngle=y,fe.clockwise=H;var Se=Math.abs(y-v),Ee=Se,Ie=0,He=v;if(i.setLayout({viewRect:o,r:f}),i.each(s,function(st,_e){var We;if(isNaN(st)){i.setItemLayout(_e,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:H,cx:a,cy:h,r0:p,r:X?NaN:f});return}X!=="area"?We=L===0&&Z?k:st*k:We=Se/E,We<M?(We=M,Ee-=M):Ie+=st;var Ue=He+re*We,vt=0,xt=0;S>We?(vt=He+re*We/2,xt=vt):(vt=He+oe,xt=Ue-oe),i.setItemLayout(_e,{angle:We,startAngle:vt,endAngle:xt,clockwise:H,cx:a,cy:h,r0:p,r:X?Uv(st,Q,[p,f]):f}),He=Ue}),Ee<nY&&E)if(Ee<=.001){var Re=Se/E;i.each(s,function(st,_e){if(!isNaN(st)){var We=i.getItemLayout(_e);We.angle=Re;var Ue=0,vt=0;Re<S?(Ue=v+re*(_e+1/2)*Re,vt=Ue):(Ue=v+re*_e*Re+oe,vt=v+re*(_e+1)*Re-oe),We.startAngle=Ue,We.endAngle=vt}})}else k=Ee/Ie,He=v,i.each(s,function(st,_e){if(!isNaN(st)){var We=i.getItemLayout(_e),Ue=We.angle===M?M:st*k,vt=0,xt=0;Ue<S?(vt=He+re*Ue/2,xt=vt):(vt=He+oe,xt=He+re*Ue-oe),We.startAngle=vt,We.endAngle=xt,He+=re*Ue}})})}var ole=qs();function oke(n){return{seriesType:n,reset:function(e,t){var r=t.findComponents({mainType:"legend"});if(!(!r||!r.length)){var i=e.getData();i.filterSelf(function(s){for(var o=i.getName(s),l=0;l<r.length;l++)if(!r[l].isSelected(o))return!1;return!0})}}}}var lke=Math.PI/180;function rY(n,e,t,r,i,s,o,l,a,h){if(n.length<2)return;function f(C){for(var M=C.rB,E=M*M,L=0;L<C.list.length;L++){var k=C.list[L],H=Math.abs(k.label.y-t),X=r+k.len,Z=X*X,Q=Math.sqrt((1-Math.abs(H*H/E))*Z),re=e+(Q+k.len2)*i,ie=re-k.label.x,oe=k.targetTextWidth-ie*i;lle(k,oe,!0),k.label.x=re}}function p(C){for(var M={list:[],maxY:0},E={list:[],maxY:0},L=0;L<C.length;L++)if(C[L].labelAlignTo==="none"){var k=C[L],H=k.label.y>t?E:M,X=Math.abs(k.label.y-t);if(X>=H.maxY){var Z=k.label.x-e-k.len2*i,Q=r+k.len,re=Math.abs(Z)<Q?Math.sqrt(X*X/(1-Z*Z/Q/Q)):Q;H.rB=re,H.maxY=X}H.list.push(k)}f(M),f(E)}for(var v=n.length,y=0;y<v;y++)if(n[y].position==="outer"&&n[y].labelAlignTo==="labelLine"){var S=n[y].label.x-h;n[y].linePoints[1][0]+=S,n[y].label.x=h}Xoe(n,a,a+o)&&p(n)}function cke(n,e,t,r,i,s,o,l){for(var a=[],h=[],f=Number.MAX_VALUE,p=-Number.MAX_VALUE,v=0;v<n.length;v++){var y=n[v].label;G3(n[v])||(y.x<e?(f=Math.min(f,y.x),a.push(n[v])):(p=Math.max(p,y.x),h.push(n[v])))}for(var v=0;v<n.length;v++){var S=n[v];if(!G3(S)&&S.linePoints){if(S.labelStyleWidth!=null)continue;var y=S.label,C=S.linePoints,M=void 0;S.labelAlignTo==="edge"?y.x<e?M=C[2][0]-S.labelDistance-o-S.edgeDistance:M=o+i-S.edgeDistance-C[2][0]-S.labelDistance:S.labelAlignTo==="labelLine"?y.x<e?M=f-o-S.bleedMargin:M=o+i-p-S.bleedMargin:y.x<e?M=y.x-o-S.bleedMargin:M=o+i-y.x-S.bleedMargin,S.targetTextWidth=M,lle(S,M)}}rY(h,e,t,r,1,i,s,o,l,p),rY(a,e,t,r,-1,i,s,o,l,f);for(var v=0;v<n.length;v++){var S=n[v];if(!G3(S)&&S.linePoints){var y=S.label,C=S.linePoints,E=S.labelAlignTo==="edge",L=y.style.padding,k=L?L[1]+L[3]:0,H=y.style.backgroundColor?0:k,X=S.rect.width+H,Z=C[1][0]-C[2][0];E?y.x<e?C[2][0]=o+S.edgeDistance+X+S.labelDistance:C[2][0]=o+i-S.edgeDistance-X-S.labelDistance:(y.x<e?C[2][0]=y.x+S.labelDistance:C[2][0]=y.x-S.labelDistance,C[1][0]=C[2][0]+Z),C[1][1]=C[2][1]=y.y}}}function lle(n,e,t){if(t===void 0&&(t=!1),n.labelStyleWidth==null){var r=n.label,i=r.style,s=n.rect,o=i.backgroundColor,l=i.padding,a=l?l[1]+l[3]:0,h=i.overflow,f=s.width+(o?0:a);if(e<f||t){var p=s.height;if(h&&h.match("break")){r.setStyle("backgroundColor",null),r.setStyle("width",e-a);var v=r.getBoundingRect();r.setStyle("width",Math.ceil(v.width)),r.setStyle("backgroundColor",o)}else{var y=e-a,S=e<f?y:t?y>n.unconstrainedWidth?null:y:null;r.setStyle("width",S)}var C=r.getBoundingRect();s.width=C.width;var M=(r.style.margin||0)+2.1;s.height=C.height+M,s.y-=(s.height-p)/2}}}function G3(n){return n.position==="center"}function uke(n){var e=n.getData(),t=[],r,i,s=!1,o=(n.get("minShowLabelAngle")||0)*lke,l=e.getLayout("viewRect"),a=e.getLayout("r"),h=l.width,f=l.x,p=l.y,v=l.height;function y(Z){Z.ignore=!0}function S(Z){if(!Z.ignore)return!0;for(var Q in Z.states)if(Z.states[Q].ignore===!1)return!0;return!1}e.each(function(Z){var Q=e.getItemGraphicEl(Z),re=Q.shape,ie=Q.getTextContent(),oe=Q.getTextGuideLine(),fe=e.getItemModel(Z),Se=fe.getModel("label"),Ee=Se.get("position")||fe.get(["emphasis","label","position"]),Ie=Se.get("distanceToLabelLine"),He=Se.get("alignTo"),Re=ls(Se.get("edgeDistance"),h),st=Se.get("bleedMargin"),_e=fe.getModel("labelLine"),We=_e.get("length");We=ls(We,h);var Ue=_e.get("length2");if(Ue=ls(Ue,h),Math.abs(re.endAngle-re.startAngle)<o){it(ie.states,y),ie.ignore=!0,oe&&(it(oe.states,y),oe.ignore=!0);return}if(S(ie)){var vt=(re.startAngle+re.endAngle)/2,xt=Math.cos(vt),Vt=Math.sin(vt),lt,Ht,Qt,rn;r=re.cx,i=re.cy;var jn=Ee==="inside"||Ee==="inner";if(Ee==="center")lt=re.cx,Ht=re.cy,rn="center";else{var Bn=(jn?(re.r+re.r0)/2*xt:re.r*xt)+r,Tn=(jn?(re.r+re.r0)/2*Vt:re.r*Vt)+i;if(lt=Bn+xt*3,Ht=Tn+Vt*3,!jn){var Le=Bn+xt*(We+a-re.r),qe=Tn+Vt*(We+a-re.r),mn=Le+(xt<0?-1:1)*Ue,cn=qe;He==="edge"?lt=xt<0?f+Re:f+h-Re:lt=mn+(xt<0?-Ie:Ie),Ht=cn,Qt=[[Bn,Tn],[Le,qe],[mn,cn]]}rn=jn?"center":He==="edge"?xt>0?"right":"left":xt>0?"left":"right"}var St=Math.PI,Jt=0,kn=Se.get("rotate");if(Ps(kn))Jt=kn*(St/180);else if(Ee==="center")Jt=0;else if(kn==="radial"||kn===!0){var Gn=xt<0?-vt+St:-vt;Jt=Gn}else if(kn==="tangential"&&Ee!=="outside"&&Ee!=="outer"){var sn=Math.atan2(xt,Vt);sn<0&&(sn=St*2+sn);var ot=Vt>0;ot&&(sn=St+sn),Jt=sn-St}if(s=!!Jt,ie.x=lt,ie.y=Ht,ie.rotation=Jt,ie.setStyle({verticalAlign:"middle"}),jn){ie.setStyle({align:rn});var An=ie.states.select;An&&(An.x+=ie.x,An.y+=ie.y)}else{var Ge=ie.getBoundingRect().clone();Ge.applyTransform(ie.getComputedTransform());var Xt=(ie.style.margin||0)+2.1;Ge.y-=Xt/2,Ge.height+=Xt,t.push({label:ie,labelLine:oe,position:Ee,len:We,len2:Ue,minTurnAngle:_e.get("minTurnAngle"),maxSurfaceAngle:_e.get("maxSurfaceAngle"),surfaceNormal:new Jr(xt,Vt),linePoints:Qt,textAlign:rn,labelDistance:Ie,labelAlignTo:He,edgeDistance:Re,bleedMargin:st,rect:Ge,unconstrainedWidth:Ge.width,labelStyleWidth:ie.style.width})}Q.setTextConfig({inside:jn})}}),!s&&n.get("avoidLabelOverlap")&&cke(t,r,i,a,h,v,f,p);for(var C=0;C<t.length;C++){var M=t[C],E=M.label,L=M.labelLine,k=isNaN(E.x)||isNaN(E.y);if(E){E.setStyle({align:M.textAlign}),k&&(it(E.states,y),E.ignore=!0);var H=E.states.select;H&&(H.x+=E.x,H.y+=E.y)}if(L){var X=M.linePoints;k||!X?(it(L.states,y),L.ignore=!0):(Voe(X,M.minTurnAngle),dBe(X,M.surfaceNormal,M.maxSurfaceAngle),L.setShape({points:X}),E.__hostTarget.textGuideLineConfig={anchor:new Jr(X[0][0],X[0][1])})}}}var hke=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this)||this;s.z2=2;var o=new Io;return s.setTextContent(o),s.updateData(t,r,i,!0),s}return e.prototype.updateData=function(t,r,i,s){var o=this,l=t.hostModel,a=t.getItemModel(r),h=a.getModel("emphasis"),f=t.getItemLayout(r),p=Jn(zA(a.getModel("itemStyle"),f,!0),f);if(isNaN(p.startAngle)){o.setShape(p);return}if(s){o.setShape(p);var v=l.getShallow("animationType");l.ecModel.ssr?(Yl(o,{scaleX:0,scaleY:0},l,{dataIndex:r,isFrom:!0}),o.originX=p.cx,o.originY=p.cy):v==="scale"?(o.shape.r=f.r0,Yl(o,{shape:{r:f.r}},l,r)):i!=null?(o.setShape({startAngle:i,endAngle:i}),Yl(o,{shape:{startAngle:f.startAngle,endAngle:f.endAngle}},l,r)):(o.shape.endAngle=f.startAngle,ol(o,{shape:{endAngle:f.endAngle}},l,r))}else lG(o),ol(o,{shape:p},l,r);o.useStyle(t.getItemVisual(r,"style")),$P(o,a);var y=(f.startAngle+f.endAngle)/2,S=l.get("selectedOffset"),C=Math.cos(y)*S,M=Math.sin(y)*S,E=a.getShallow("cursor");E&&o.attr("cursor",E),this._updateLabel(l,t,r),o.ensureState("emphasis").shape=Jn({r:f.r+(h.get("scale")&&h.get("scaleSize")||0)},zA(h.getModel("itemStyle"),f)),Jn(o.ensureState("select"),{x:C,y:M,shape:zA(a.getModel(["select","itemStyle"]),f)}),Jn(o.ensureState("blur"),{shape:zA(a.getModel(["blur","itemStyle"]),f)});var L=o.getTextGuideLine(),k=o.getTextContent();L&&Jn(L.ensureState("select"),{x:C,y:M}),Jn(k.ensureState("select"),{x:C,y:M}),vM(this,h.get("focus"),h.get("blurScope"),h.get("disabled"))},e.prototype._updateLabel=function(t,r,i){var s=this,o=r.getItemModel(i),l=o.getModel("labelLine"),a=r.getItemVisual(i,"style"),h=a&&a.fill,f=a&&a.opacity;yE(s,xE(o),{labelFetcher:r.hostModel,labelDataIndex:i,inheritColor:h,defaultOpacity:f,defaultText:t.getFormattedLabel(i,"normal")||r.getName(i)});var p=s.getTextContent();s.setTextConfig({position:null,rotation:null}),p.attr({z2:10});var v=t.get(["label","position"]);if(v!=="outside"&&v!=="outer")s.removeTextGuideLine();else{var y=this.getTextGuideLine();y||(y=new Bw,this.setTextGuideLine(y)),Hoe(this,joe(o),{stroke:h,opacity:uT(l.get(["lineStyle","opacity"]),f,1)})}},e}(Nh),fke=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.ignoreLabelLineUpdate=!0,t}return e.prototype.render=function(t,r,i,s){var o=t.getData(),l=this._data,a=this.group,h;if(!l&&o.count()>0){for(var f=o.getItemLayout(0),p=1;isNaN(f&&f.startAngle)&&p<o.count();++p)f=o.getItemLayout(p);f&&(h=f.startAngle)}if(this._emptyCircleSector&&a.remove(this._emptyCircleSector),o.count()===0&&t.get("showEmptyCircle")){var v=ole(t),y=new Nh({shape:Jn(ale(t,i),v)});y.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=y,a.add(y)}o.diff(l).add(function(S){var C=new hke(o,S,h);o.setItemGraphicEl(S,C),a.add(C)}).update(function(S,C){var M=l.getItemGraphicEl(C);M.updateData(o,S,h),M.off("click"),a.add(M),o.setItemGraphicEl(S,M)}).remove(function(S){var C=l.getItemGraphicEl(S);ZP(C,t,S)}).execute(),uke(t),t.get("animationTypeUpdate")!=="expansion"&&(this._data=o)},e.prototype.dispose=function(){},e.prototype.containPoint=function(t,r){var i=r.getData(),s=i.getItemLayout(0);if(s){var o=t[0]-s.cx,l=t[1]-s.cy,a=Math.sqrt(o*o+l*l);return a<=s.r&&a>=s.r0}},e.type="pie",e}(Ph);function dke(n,e,t){e=fr(e)&&{coordDimensions:e}||Jn({encodeDefine:n.getEncode()},e);var r=n.getSource(),i=xoe(r,e).dimensions,s=new yoe(i,n);return s.initData(r,t),s}var pke=function(){function n(e,t){this._getDataWithEncodedVisual=e,this._getRawData=t}return n.prototype.getAllNames=function(){var e=this._getRawData();return e.mapArray(e.getName)},n.prototype.containName=function(e){var t=this._getRawData();return t.indexOfName(e)>=0},n.prototype.indexOfName=function(e){var t=this._getDataWithEncodedVisual();return t.indexOfName(e)},n.prototype.getItemVisual=function(e,t){var r=this._getDataWithEncodedVisual();return r.getItemVisual(e,t)},n}(),mke=qs(),gke=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.init=function(t){n.prototype.init.apply(this,arguments),this.legendVisualProvider=new pke(Us(this.getData,this),Us(this.getRawData,this)),this._defaultLabelLine(t)},e.prototype.mergeOption=function(){n.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return dke(this,{coordDimensions:["value"],encodeDefaulter:_s(dRe,this)})},e.prototype.getDataParams=function(t){var r=this.getData(),i=mke(r),s=i.seats;if(!s){var o=[];r.each(r.mapDimension("value"),function(a){o.push(a)}),s=i.seats=lCe(o,r.hostModel.get("percentPrecision"))}var l=n.prototype.getDataParams.call(this,t);return l.percent=s[t]||0,l.$vars.push("percent"),l},e.prototype._defaultLabelLine=function(t){Tz(t,"labelLine",["show"]);var r=t.labelLine,i=t.emphasis.labelLine;r.show=r.show&&t.label.show,i.show=i.show&&t.emphasis.label.show},e.type="series.pie",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(ed);function vke(n){return{seriesType:n,reset:function(e,t){var r=e.getData();r.filterSelf(function(i){var s=r.mapDimension("value"),o=r.get(s,i);return!(Ps(o)&&!isNaN(o)&&o<0)})}}}function _ke(n){n.registerChartView(fke),n.registerSeriesModel(gke),YPe("pie",n.registerAction),n.registerLayout(_s(ake,"pie")),n.registerProcessor(oke("pie")),n.registerProcessor(vke("pie"))}var yke=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.type="grid",e.dependencies=["xAxis","yAxis"],e.layoutMode="box",e.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},e}(as),r5=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",bl).models[0]},e.type="cartesian2dAxis",e}(as);od(r5,Doe);var cle={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},xke=Bi({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},cle),HG=Bi({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},cle),bke=Bi({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},HG),wke=ti({logBase:10},HG);const Ske={category:xke,value:HG,time:bke,log:wke};var Ake={value:1,category:1,time:1,log:1};function cL(n,e,t,r){it(Ake,function(i,s){var o=Bi(Bi({},Ske[s],!0),r,!0),l=function(a){Hn(h,a);function h(){var f=a!==null&&a.apply(this,arguments)||this;return f.type=e+"Axis."+s,f}return h.prototype.mergeDefaultAndTheme=function(f,p){var v=xM(this),y=v?pB(f):{},S=p.getTheme();Bi(f,S.get(s+"Axis")),Bi(f,this.getDefaultOption()),f.type=iY(f),v&&hw(f,y,v)},h.prototype.optionUpdated=function(){var f=this.option;f.type==="category"&&(this.__ordinalMeta=Qz.createByAxisModel(this))},h.prototype.getCategories=function(f){var p=this.option;if(p.type==="category")return f?p.data:this.__ordinalMeta.categories},h.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},h.type=e+"Axis."+s,h.defaultOption=o,h}(t);n.registerComponentModel(l)}),n.registerSubTypeDefaulter(e+"Axis",iY)}function iY(n){return n.type||(n.data?"category":"value")}var Tke=function(){function n(e){this.type="cartesian",this._dimList=[],this._axes={},this.name=e||""}return n.prototype.getAxis=function(e){return this._axes[e]},n.prototype.getAxes=function(){return xr(this._dimList,function(e){return this._axes[e]},this)},n.prototype.getAxesByScale=function(e){return e=e.toLowerCase(),no(this.getAxes(),function(t){return t.scale.type===e})},n.prototype.addAxis=function(e){var t=e.dim;this._axes[t]=e,this._dimList.push(t)},n}(),i5=["x","y"];function sY(n){return n.type==="interval"||n.type==="time"}var Mke=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="cartesian2d",t.dimensions=i5,t}return e.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var t=this.getAxis("x").scale,r=this.getAxis("y").scale;if(!(!sY(t)||!sY(r))){var i=t.getExtent(),s=r.getExtent(),o=this.dataToPoint([i[0],s[0]]),l=this.dataToPoint([i[1],s[1]]),a=i[1]-i[0],h=s[1]-s[0];if(!(!a||!h)){var f=(l[0]-o[0])/a,p=(l[1]-o[1])/h,v=o[0]-i[0]*f,y=o[1]-s[0]*p,S=this._transform=[f,0,0,p,v,y];this._invTransform=jD([],S)}}},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},e.prototype.containPoint=function(t){var r=this.getAxis("x"),i=this.getAxis("y");return r.contain(r.toLocalCoord(t[0]))&&i.contain(i.toLocalCoord(t[1]))},e.prototype.containData=function(t){return this.getAxis("x").containData(t[0])&&this.getAxis("y").containData(t[1])},e.prototype.containZone=function(t,r){var i=this.dataToPoint(t),s=this.dataToPoint(r),o=this.getArea(),l=new cs(i[0],i[1],s[0]-i[0],s[1]-i[1]);return o.intersect(l)},e.prototype.dataToPoint=function(t,r,i){i=i||[];var s=t[0],o=t[1];if(this._transform&&s!=null&&isFinite(s)&&o!=null&&isFinite(o))return Rh(i,t,this._transform);var l=this.getAxis("x"),a=this.getAxis("y");return i[0]=l.toGlobalCoord(l.dataToCoord(s,r)),i[1]=a.toGlobalCoord(a.dataToCoord(o,r)),i},e.prototype.clampData=function(t,r){var i=this.getAxis("x").scale,s=this.getAxis("y").scale,o=i.getExtent(),l=s.getExtent(),a=i.parse(t[0]),h=s.parse(t[1]);return r=r||[],r[0]=Math.min(Math.max(Math.min(o[0],o[1]),a),Math.max(o[0],o[1])),r[1]=Math.min(Math.max(Math.min(l[0],l[1]),h),Math.max(l[0],l[1])),r},e.prototype.pointToData=function(t,r){var i=[];if(this._invTransform)return Rh(i,t,this._invTransform);var s=this.getAxis("x"),o=this.getAxis("y");return i[0]=s.coordToData(s.toLocalCoord(t[0]),r),i[1]=o.coordToData(o.toLocalCoord(t[1]),r),i},e.prototype.getOtherAxis=function(t){return this.getAxis(t.dim==="x"?"y":"x")},e.prototype.getArea=function(t){t=t||0;var r=this.getAxis("x").getGlobalExtent(),i=this.getAxis("y").getGlobalExtent(),s=Math.min(r[0],r[1])-t,o=Math.min(i[0],i[1])-t,l=Math.max(r[0],r[1])-s+t,a=Math.max(i[0],i[1])-o+t;return new cs(s,o,l,a)},e}(Tke),Eke=function(n){Hn(e,n);function e(t,r,i,s,o){var l=n.call(this,t,r,i)||this;return l.index=0,l.type=s||"value",l.position=o||"bottom",l}return e.prototype.isHorizontal=function(){var t=this.position;return t==="top"||t==="bottom"},e.prototype.getGlobalExtent=function(t){var r=this.getExtent();return r[0]=this.toGlobalCoord(r[0]),r[1]=this.toGlobalCoord(r[1]),t&&r[0]>r[1]&&r.reverse(),r},e.prototype.pointToData=function(t,r){return this.coordToData(this.toLocalCoord(t[this.dim==="x"?0:1]),r)},e.prototype.setCategorySortInfo=function(t){if(this.type!=="category")return!1;this.model.option.categorySortInfo=t,this.scale.setSortInfo(t)},e}(Ix);function s5(n,e,t){t=t||{};var r=n.coordinateSystem,i=e.axis,s={},o=i.getAxesOnZeroOf()[0],l=i.position,a=o?"onZero":l,h=i.dim,f=r.getRect(),p=[f.x,f.x+f.width,f.y,f.y+f.height],v={left:0,right:1,top:0,bottom:1,onZero:2},y=e.get("offset")||0,S=h==="x"?[p[2]-y,p[3]+y]:[p[0]-y,p[1]+y];if(o){var C=o.toGlobalCoord(o.dataToCoord(0));S[v.onZero]=Math.max(Math.min(C,S[1]),S[0])}s.position=[h==="y"?S[v[a]]:p[0],h==="x"?S[v[a]]:p[3]],s.rotation=Math.PI/2*(h==="x"?0:1);var M={top:-1,bottom:1,left:-1,right:1};s.labelDirection=s.tickDirection=s.nameDirection=M[l],s.labelOffset=o?S[v[l]]-S[v.onZero]:0,e.get(["axisTick","inside"])&&(s.tickDirection=-s.tickDirection),dM(t.labelInside,e.get(["axisLabel","inside"]))&&(s.labelDirection=-s.labelDirection);var E=e.get(["axisLabel","rotate"]);return s.labelRotate=a==="top"?-E:E,s.z2=1,s}function aY(n){return n.get("coordinateSystem")==="cartesian2d"}function oY(n){var e={xAxisModel:null,yAxisModel:null};return it(e,function(t,r){var i=r.replace(/Model$/,""),s=n.getReferringComponents(i,bl).models[0];e[r]=s}),e}var V3=Math.log;function Cke(n,e,t){var r=Fw.prototype,i=r.getTicks.call(t),s=r.getTicks.call(t,!0),o=i.length-1,l=r.getInterval.call(t),a=Roe(n,e),h=a.extent,f=a.fixMin,p=a.fixMax;if(n.type==="log"){var v=V3(n.base);h=[V3(h[0])/v,V3(h[1])/v]}n.setExtent(h[0],h[1]),n.calcNiceExtent({splitNumber:o,fixMin:f,fixMax:p});var y=r.getExtent.call(n);f&&(h[0]=y[0]),p&&(h[1]=y[1]);var S=r.getInterval.call(n),C=h[0],M=h[1];if(f&&p)S=(M-C)/o;else if(f)for(M=h[0]+S*o;M<h[1]&&isFinite(M)&&isFinite(h[1]);)S=D3(S),M=h[0]+S*o;else if(p)for(C=h[1]-S*o;C>h[0]&&isFinite(C)&&isFinite(h[0]);)S=D3(S),C=h[1]-S*o;else{var E=n.getTicks().length-1;E>o&&(S=D3(S));var L=S*o;M=Math.ceil(h[1]/S)*S,C=To(M-L),C<0&&h[0]>=0?(C=0,M=To(L)):M>0&&h[1]<=0&&(M=0,C=-To(L))}var k=(i[0].value-s[0].value)/l,H=(i[o].value-s[o].value)/l;r.setExtent.call(n,C+S*k,M+S*H),r.setInterval.call(n,S),(k||H)&&r.setNiceExtent.call(n,C+S,M-S)}var Ike=function(){function n(e,t,r){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=i5,this._initCartesian(e,t,r),this.model=e}return n.prototype.getRect=function(){return this._rect},n.prototype.update=function(e,t){var r=this._axesMap;this._updateScale(e,this.model);function i(o){var l,a=aa(o),h=a.length;if(h){for(var f=[],p=h-1;p>=0;p--){var v=+a[p],y=o[v],S=y.model,C=y.scale;e5(C)&&S.get("alignTicks")&&S.get("interval")==null?f.push(y):(sL(C,S),e5(C)&&(l=y))}f.length&&(l||(l=f.pop(),sL(l.scale,l.model)),it(f,function(M){Cke(M.scale,M.model,l.scale)}))}}i(r.x),i(r.y);var s={};it(r.x,function(o){lY(r,"y",o,s)}),it(r.y,function(o){lY(r,"x",o,s)}),this.resize(this.model,t)},n.prototype.resize=function(e,t,r){var i=e.getBoxLayoutParams(),s=!r&&e.get("containLabel"),o=b0(i,{width:t.getWidth(),height:t.getHeight()});this._rect=o;var l=this._axesList;a(),s&&(it(l,function(h){if(!h.model.get(["axisLabel","inside"])){var f=ZDe(h);if(f){var p=h.isHorizontal()?"height":"width",v=h.model.get(["axisLabel","margin"]);o[p]-=f[p]+v,h.position==="top"?o.y+=f.height+v:h.position==="left"&&(o.x+=f.width+v)}}}),a()),it(this._coordsList,function(h){h.calcAffineTransform()});function a(){it(l,function(h){var f=h.isHorizontal(),p=f?[0,o.width]:[0,o.height],v=h.inverse?1:0;h.setExtent(p[v],p[1-v]),Rke(h,f?o.x:o.y)})}},n.prototype.getAxis=function(e,t){var r=this._axesMap[e];if(r!=null)return r[t||0]},n.prototype.getAxes=function(){return this._axesList.slice()},n.prototype.getCartesian=function(e,t){if(e!=null&&t!=null){var r="x"+e+"y"+t;return this._coordsMap[r]}$r(e)&&(t=e.yAxisIndex,e=e.xAxisIndex);for(var i=0,s=this._coordsList;i<s.length;i++)if(s[i].getAxis("x").index===e||s[i].getAxis("y").index===t)return s[i]},n.prototype.getCartesians=function(){return this._coordsList.slice()},n.prototype.convertToPixel=function(e,t,r){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.dataToPoint(r):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(r)):null},n.prototype.convertFromPixel=function(e,t,r){var i=this._findConvertTarget(t);return i.cartesian?i.cartesian.pointToData(r):i.axis?i.axis.coordToData(i.axis.toLocalCoord(r)):null},n.prototype._findConvertTarget=function(e){var t=e.seriesModel,r=e.xAxisModel||t&&t.getReferringComponents("xAxis",bl).models[0],i=e.yAxisModel||t&&t.getReferringComponents("yAxis",bl).models[0],s=e.gridModel,o=this._coordsList,l,a;if(t)l=t.coordinateSystem,Xi(o,l)<0&&(l=null);else if(r&&i)l=this.getCartesian(r.componentIndex,i.componentIndex);else if(r)a=this.getAxis("x",r.componentIndex);else if(i)a=this.getAxis("y",i.componentIndex);else if(s){var h=s.coordinateSystem;h===this&&(l=this._coordsList[0])}return{cartesian:l,axis:a}},n.prototype.containPoint=function(e){var t=this._coordsList[0];if(t)return t.containPoint(e)},n.prototype._initCartesian=function(e,t,r){var i=this,s=this,o={left:!1,right:!1,top:!1,bottom:!1},l={x:{},y:{}},a={x:0,y:0};if(t.eachComponent("xAxis",h("x"),this),t.eachComponent("yAxis",h("y"),this),!a.x||!a.y){this._axesMap={},this._axesList=[];return}this._axesMap=l,it(l.x,function(f,p){it(l.y,function(v,y){var S="x"+p+"y"+y,C=new Mke(S);C.master=i,C.model=e,i._coordsMap[S]=C,i._coordsList.push(C),C.addAxis(f),C.addAxis(v)})});function h(f){return function(p,v){if(H3(p,e)){var y=p.get("position");f==="x"?y!=="top"&&y!=="bottom"&&(y=o.bottom?"top":"bottom"):y!=="left"&&y!=="right"&&(y=o.left?"right":"left"),o[y]=!0;var S=new Eke(f,Poe(p),[0,0],p.get("type"),y),C=S.type==="category";S.onBand=C&&p.get("boundaryGap"),S.inverse=p.get("inverse"),p.axis=S,S.model=p,S.grid=s,S.index=v,s._axesList.push(S),l[f][v]=S,a[f]++}}}},n.prototype._updateScale=function(e,t){it(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var s=i.model.get("categorySortInfo");i.scale.setSortInfo(s)}}),e.eachSeries(function(i){if(aY(i)){var s=oY(i),o=s.xAxisModel,l=s.yAxisModel;if(!H3(o,t)||!H3(l,t))return;var a=this.getCartesian(o.componentIndex,l.componentIndex),h=i.getData(),f=a.getAxis("x"),p=a.getAxis("y");r(h,f),r(h,p)}},this);function r(i,s){it(aL(i,s.dim),function(o){s.scale.unionExtentFromData(i,o)})}},n.prototype.getTooltipAxes=function(e){var t=[],r=[];return it(this.getCartesians(),function(i){var s=e!=null&&e!=="auto"?i.getAxis(e):i.getBaseAxis(),o=i.getOtherAxis(s);Xi(t,s)<0&&t.push(s),Xi(r,o)<0&&r.push(o)}),{baseAxes:t,otherAxes:r}},n.create=function(e,t){var r=[];return e.eachComponent("grid",function(i,s){var o=new n(i,e,t);o.name="grid_"+s,o.resize(i,t,!0),i.coordinateSystem=o,r.push(o)}),e.eachSeries(function(i){if(aY(i)){var s=oY(i),o=s.xAxisModel,l=s.yAxisModel,a=o.getCoordSysModel(),h=a.coordinateSystem;i.coordinateSystem=h.getCartesian(o.componentIndex,l.componentIndex)}}),r},n.dimensions=i5,n}();function H3(n,e){return n.getCoordSysModel()===e}function lY(n,e,t,r){t.getAxesOnZeroOf=function(){return s?[s]:[]};var i=n[e],s,o=t.model,l=o.get(["axisLine","onZero"]),a=o.get(["axisLine","onZeroAxisIndex"]);if(!l)return;if(a!=null)cY(i[a])&&(s=i[a]);else for(var h in i)if(i.hasOwnProperty(h)&&cY(i[h])&&!r[f(i[h])]){s=i[h];break}s&&(r[f(s)]=!0);function f(p){return p.dim+"_"+p.index}}function cY(n){return n&&n.type!=="category"&&n.type!=="time"&&qDe(n)}function Rke(n,e){var t=n.getExtent(),r=t[0]+t[1];n.toGlobalCoord=n.dim==="x"?function(i){return i+e}:function(i){return r-i+e},n.toLocalCoord=n.dim==="x"?function(i){return i-e}:function(i){return r-i+e}}var qv=Math.PI,Lh=function(){function n(e,t){this.group=new go,this.opt=t,this.axisModel=e,ti(t,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var r=new go({x:t.position[0],y:t.position[1],rotation:t.rotation});r.updateTransform(),this._transformGroup=r}return n.prototype.hasBuilder=function(e){return!!uY[e]},n.prototype.add=function(e){uY[e](this.opt,this.axisModel,this.group,this._transformGroup)},n.prototype.getGroup=function(){return this.group},n.innerTextLayout=function(e,t,r){var i=Vie(t-e),s,o;return HP(i)?(o=r>0?"top":"bottom",s="center"):HP(i-qv)?(o=r>0?"bottom":"top",s="center"):(o="middle",i>0&&i<qv?s=r>0?"right":"left":s=r>0?"left":"right"),{rotation:i,textAlign:s,textVerticalAlign:o}},n.makeAxisEventDataBase=function(e){var t={componentType:e.mainType,componentIndex:e.componentIndex};return t[e.mainType+"Index"]=e.componentIndex,t},n.isLabelSilent=function(e){var t=e.get("tooltip");return e.get("silent")||!(e.get("triggerEvent")||t&&t.show)},n}(),uY={axisLine:function(n,e,t,r){var i=e.get(["axisLine","show"]);if(i==="auto"&&n.handleAutoShown&&(i=n.handleAutoShown("axisLine")),!!i){var s=e.axis.getExtent(),o=r.transform,l=[s[0],0],a=[s[1],0],h=l[0]>a[0];o&&(Rh(l,l,o),Rh(a,a,o));var f=Jn({lineCap:"round"},e.getModel(["axisLine","lineStyle"]).getLineStyle()),p=new Hf({shape:{x1:l[0],y1:l[1],x2:a[0],y2:a[1]},style:f,strokeContainThreshold:n.strokeContainThreshold||5,silent:!0,z2:1});_M(p.shape,p.style.lineWidth),p.anid="line",t.add(p);var v=e.get(["axisLine","symbol"]);if(v!=null){var y=e.get(["axisLine","symbolSize"]);Dr(v)&&(v=[v,v]),(Dr(y)||Ps(y))&&(y=[y,y]);var S=jae(e.get(["axisLine","symbolOffset"])||0,y),C=y[0],M=y[1];it([{rotate:n.rotation+Math.PI/2,offset:S[0],r:0},{rotate:n.rotation-Math.PI/2,offset:S[1],r:Math.sqrt((l[0]-a[0])*(l[0]-a[0])+(l[1]-a[1])*(l[1]-a[1]))}],function(E,L){if(v[L]!=="none"&&v[L]!=null){var k=dw(v[L],-C/2,-M/2,C,M,f.stroke,!0),H=E.r+E.offset,X=h?a:l;k.attr({rotation:E.rotate,x:X[0]+H*Math.cos(n.rotation),y:X[1]-H*Math.sin(n.rotation),silent:!0,z2:11}),t.add(k)}})}}},axisTickLabel:function(n,e,t,r){var i=Dke(t,r,e,n),s=kke(t,r,e,n);if(Lke(e,s,i),Bke(t,r,e,n.tickDirection),e.get(["axisLabel","hideOverlap"])){var o=Woe(xr(s,function(l){return{label:l,priority:l.z2,defaultAttr:{ignore:l.ignore}}}));qoe(o)}},axisName:function(n,e,t,r){var i=dM(n.axisName,e.get("name"));if(i){var s=e.get("nameLocation"),o=n.nameDirection,l=e.getModel("nameTextStyle"),a=e.get("nameGap")||0,h=e.axis.getExtent(),f=h[0]>h[1]?-1:1,p=[s==="start"?h[0]-f*a:s==="end"?h[1]+f*a:(h[0]+h[1])/2,fY(s)?n.labelOffset+o*a:0],v,y=e.get("nameRotate");y!=null&&(y=y*qv/180);var S;fY(s)?v=Lh.innerTextLayout(n.rotation,y??n.rotation,o):(v=Pke(n.rotation,s,y||0,h),S=n.axisNameAvailableWidth,S!=null&&(S=Math.abs(S/Math.sin(v.rotation)),!isFinite(S)&&(S=null)));var C=l.getFont(),M=e.get("nameTruncate",!0)||{},E=M.ellipsis,L=dM(n.nameTruncateMaxWidth,M.maxWidth,S),k=new Io({x:p[0],y:p[1],rotation:v.rotation,silent:Lh.isLabelSilent(e),style:ng(l,{text:i,font:C,overflow:"truncate",width:L,ellipsis:E,fill:l.getTextColor()||e.get(["axisLine","lineStyle","color"]),align:l.get("align")||v.textAlign,verticalAlign:l.get("verticalAlign")||v.textVerticalAlign}),z2:1});if(sB({el:k,componentModel:e,itemName:i}),k.__fullText=i,k.anid="name",e.get("triggerEvent")){var H=Lh.makeAxisEventDataBase(e);H.targetType="axisName",H.name=i,$i(k).eventData=H}r.add(k),k.updateTransform(),t.add(k),k.decomposeTransform()}}};function Pke(n,e,t,r){var i=Vie(t-n),s,o,l=r[0]>r[1],a=e==="start"&&!l||e!=="start"&&l;return HP(i-qv/2)?(o=a?"bottom":"top",s="center"):HP(i-qv*1.5)?(o=a?"top":"bottom",s="center"):(o="middle",i<qv*1.5&&i>qv/2?s=a?"left":"right":s=a?"right":"left"),{rotation:i,textAlign:s,textVerticalAlign:o}}function Lke(n,e,t){if(!Loe(n.axis)){var r=n.get(["axisLabel","showMinLabel"]),i=n.get(["axisLabel","showMaxLabel"]);e=e||[],t=t||[];var s=e[0],o=e[1],l=e[e.length-1],a=e[e.length-2],h=t[0],f=t[1],p=t[t.length-1],v=t[t.length-2];r===!1?(fh(s),fh(h)):hY(s,o)&&(r?(fh(o),fh(f)):(fh(s),fh(h))),i===!1?(fh(l),fh(p)):hY(a,l)&&(i?(fh(a),fh(v)):(fh(l),fh(p)))}}function fh(n){n&&(n.ignore=!0)}function hY(n,e){var t=n&&n.getBoundingRect().clone(),r=e&&e.getBoundingRect().clone();if(!(!t||!r)){var i=q6([]);return HD(i,i,-n.rotation),t.applyTransform(Ub([],i,n.getLocalTransform())),r.applyTransform(Ub([],i,e.getLocalTransform())),t.intersect(r)}}function fY(n){return n==="middle"||n==="center"}function ule(n,e,t,r,i){for(var s=[],o=[],l=[],a=0;a<n.length;a++){var h=n[a].coord;o[0]=h,o[1]=0,l[0]=h,l[1]=t,e&&(Rh(o,o,e),Rh(l,l,e));var f=new Hf({shape:{x1:o[0],y1:o[1],x2:l[0],y2:l[1]},style:r,z2:2,autoBatch:!0,silent:!0});_M(f.shape,f.style.lineWidth),f.anid=i+"_"+n[a].tickValue,s.push(f)}return s}function Dke(n,e,t,r){var i=t.axis,s=t.getModel("axisTick"),o=s.get("show");if(o==="auto"&&r.handleAutoShown&&(o=r.handleAutoShown("axisTick")),!(!o||i.scale.isBlank())){for(var l=s.getModel("lineStyle"),a=r.tickDirection*s.get("length"),h=i.getTicksCoords(),f=ule(h,e.transform,a,ti(l.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}),"ticks"),p=0;p<f.length;p++)n.add(f[p]);return f}}function Bke(n,e,t,r){var i=t.axis,s=t.getModel("minorTick");if(!(!s.get("show")||i.scale.isBlank())){var o=i.getMinorTicksCoords();if(o.length)for(var l=s.getModel("lineStyle"),a=r*s.get("length"),h=ti(l.getLineStyle(),ti(t.getModel("axisTick").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})),f=0;f<o.length;f++)for(var p=ule(o[f],e.transform,a,h,"minorticks_"+f),v=0;v<p.length;v++)n.add(p[v])}}function kke(n,e,t,r){var i=t.axis,s=dM(r.axisLabelShow,t.get(["axisLabel","show"]));if(!(!s||i.scale.isBlank())){var o=t.getModel("axisLabel"),l=o.get("margin"),a=i.getViewLabels(),h=(dM(r.labelRotate,o.get("rotate"))||0)*qv/180,f=Lh.innerTextLayout(r.rotation,h,r.labelDirection),p=t.getCategories&&t.getCategories(!0),v=[],y=Lh.isLabelSilent(t),S=t.get("triggerEvent");return it(a,function(C,M){var E=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(C.tickValue):C.tickValue,L=C.formattedLabel,k=C.rawLabel,H=o;if(p&&p[E]){var X=p[E];$r(X)&&X.textStyle&&(H=new Ra(X.textStyle,o,t.ecModel))}var Z=H.getTextColor()||t.get(["axisLine","lineStyle","color"]),Q=i.dataToCoord(E),re=H.getShallow("align",!0)||f.textAlign,ie=Ii(H.getShallow("alignMinLabel",!0),re),oe=Ii(H.getShallow("alignMaxLabel",!0),re),fe=H.getShallow("verticalAlign",!0)||H.getShallow("baseline",!0)||f.textVerticalAlign,Se=Ii(H.getShallow("verticalAlignMinLabel",!0),fe),Ee=Ii(H.getShallow("verticalAlignMaxLabel",!0),fe),Ie=new Io({x:Q,y:r.labelOffset+r.labelDirection*l,rotation:f.rotation,silent:y,z2:10+(C.level||0),style:ng(H,{text:L,align:M===0?ie:M===a.length-1?oe:re,verticalAlign:M===0?Se:M===a.length-1?Ee:fe,fill:ci(Z)?Z(i.type==="category"?k:i.type==="value"?E+"":E,M):Z})});if(Ie.anid="label_"+E,S){var He=Lh.makeAxisEventDataBase(t);He.targetType="axisLabel",He.value=k,He.tickIndex=M,i.type==="category"&&(He.dataIndex=E),$i(Ie).eventData=He}e.add(Ie),Ie.updateTransform(),v.push(Ie),n.add(Ie),Ie.decomposeTransform()}),v}}function Oke(n,e){var t={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return Fke(t,n,e),t.seriesInvolved&&zke(t,n),t}function Fke(n,e,t){var r=e.getComponent("tooltip"),i=e.getComponent("axisPointer"),s=i.get("link",!0)||[],o=[];it(t.getCoordinateSystems(),function(l){if(!l.axisPointerEnabled)return;var a=EM(l.model),h=n.coordSysAxesInfo[a]={};n.coordSysMap[a]=l;var f=l.model,p=f.getModel("tooltip",r);if(it(l.getAxes(),_s(C,!1,null)),l.getTooltipAxes&&r&&p.get("show")){var v=p.get("trigger")==="axis",y=p.get(["axisPointer","type"])==="cross",S=l.getTooltipAxes(p.get(["axisPointer","axis"]));(v||y)&&it(S.baseAxes,_s(C,y?"cross":!0,v)),y&&it(S.otherAxes,_s(C,"cross",!1))}function C(M,E,L){var k=L.model.getModel("axisPointer",i),H=k.get("show");if(!(!H||H==="auto"&&!M&&!a5(k))){E==null&&(E=k.get("triggerTooltip")),k=M?Nke(L,p,i,e,M,E):k;var X=k.get("snap"),Z=k.get("triggerEmphasis"),Q=EM(L.model),re=E||X||L.type==="category",ie=n.axesInfo[Q]={key:Q,axis:L,coordSys:l,axisPointerModel:k,triggerTooltip:E,triggerEmphasis:Z,involveSeries:re,snap:X,useHandle:a5(k),seriesModels:[],linkGroup:null};h[Q]=ie,n.seriesInvolved=n.seriesInvolved||re;var oe=Uke(s,L);if(oe!=null){var fe=o[oe]||(o[oe]={axesInfo:{}});fe.axesInfo[Q]=ie,fe.mapper=s[oe].mapper,ie.linkGroup=fe}}}})}function Nke(n,e,t,r,i,s){var o=e.getModel("axisPointer"),l=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],a={};it(l,function(v){a[v]=yi(o.get(v))}),a.snap=n.type!=="category"&&!!s,o.get("type")==="cross"&&(a.type="line");var h=a.label||(a.label={});if(h.show==null&&(h.show=!1),i==="cross"){var f=o.get(["label","show"]);if(h.show=f??!0,!s){var p=a.lineStyle=o.get("crossStyle");p&&ti(h,p.textStyle)}}return n.model.getModel("axisPointer",new Ra(a,t,r))}function zke(n,e){e.eachSeries(function(t){var r=t.coordinateSystem,i=t.get(["tooltip","trigger"],!0),s=t.get(["tooltip","show"],!0);!r||i==="none"||i===!1||i==="item"||s===!1||t.get(["axisPointer","show"],!0)===!1||it(n.coordSysAxesInfo[EM(r.model)],function(o){var l=o.axis;r.getAxis(l.dim)===l&&(o.seriesModels.push(t),o.seriesDataCount==null&&(o.seriesDataCount=0),o.seriesDataCount+=t.getData().count())})})}function Uke(n,e){for(var t=e.model,r=e.dim,i=0;i<n.length;i++){var s=n[i]||{};if(j3(s[r+"AxisId"],t.id)||j3(s[r+"AxisIndex"],t.componentIndex)||j3(s[r+"AxisName"],t.name))return i}}function j3(n,e){return n==="all"||fr(n)&&Xi(n,e)>=0||n===e}function Gke(n){var e=jG(n);if(e){var t=e.axisPointerModel,r=e.axis.scale,i=t.option,s=t.get("status"),o=t.get("value");o!=null&&(o=r.parse(o));var l=a5(t);s==null&&(i.status=l?"show":"hide");var a=r.getExtent().slice();a[0]>a[1]&&a.reverse(),(o==null||o>a[1])&&(o=a[1]),o<a[0]&&(o=a[0]),i.value=o,l&&(i.status=e.axis.scale.isBlank()?"hide":"show")}}function jG(n){var e=(n.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return e&&e.axesInfo[EM(n)]}function Vke(n){var e=jG(n);return e&&e.axisPointerModel}function a5(n){return!!n.get(["handle","show"])}function EM(n){return n.type+"||"+n.id}var dY={},wE=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i,s){this.axisPointerClass&&Gke(t),n.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(t,i,!0)},e.prototype.updateAxisPointer=function(t,r,i,s){this._doUpdateAxisPointerClass(t,i,!1)},e.prototype.remove=function(t,r){var i=this._axisPointer;i&&i.remove(r)},e.prototype.dispose=function(t,r){this._disposeAxisPointer(r),n.prototype.dispose.apply(this,arguments)},e.prototype._doUpdateAxisPointerClass=function(t,r,i){var s=e.getAxisPointerClass(this.axisPointerClass);if(s){var o=Vke(t);o?(this._axisPointer||(this._axisPointer=new s)).render(t,o,r,i):this._disposeAxisPointer(r)}},e.prototype._disposeAxisPointer=function(t){this._axisPointer&&this._axisPointer.dispose(t),this._axisPointer=null},e.registerAxisPointerClass=function(t,r){dY[t]=r},e.getAxisPointerClass=function(t){return t&&dY[t]},e.type="axis",e}(Dc),o5=qs();function Hke(n,e,t,r){var i=t.axis;if(!i.scale.isBlank()){var s=t.getModel("splitArea"),o=s.getModel("areaStyle"),l=o.get("color"),a=r.coordinateSystem.getRect(),h=i.getTicksCoords({tickModel:s,clamp:!0});if(h.length){var f=l.length,p=o5(n).splitAreaColors,v=ii(),y=0;if(p)for(var S=0;S<h.length;S++){var C=p.get(h[S].tickValue);if(C!=null){y=(C+(f-1)*S)%f;break}}var M=i.toGlobalCoord(h[0].coord),E=o.getAreaStyle();l=fr(l)?l:[l];for(var S=1;S<h.length;S++){var L=i.toGlobalCoord(h[S].coord),k=void 0,H=void 0,X=void 0,Z=void 0;i.isHorizontal()?(k=M,H=a.y,X=L-k,Z=a.height,M=k+X):(k=a.x,H=M,X=a.width,Z=L-H,M=H+Z);var Q=h[S-1].tickValue;Q!=null&&v.set(Q,y),e.add(new Ha({anid:Q!=null?"area_"+Q:null,shape:{x:k,y:H,width:X,height:Z},style:ti({fill:l[y]},E),autoBatch:!0,silent:!0})),y=(y+1)%f}o5(n).splitAreaColors=v}}}function jke(n){o5(n).splitAreaColors=null}var Wke=["axisLine","axisTickLabel","axisName"],$ke=["splitArea","splitLine","minorSplitLine"],hle=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="CartesianAxisPointer",t}return e.prototype.render=function(t,r,i,s){this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new go,this.group.add(this._axisGroup),!!t.get("show")){var l=t.getCoordSysModel(),a=s5(l,t),h=new Lh(t,Jn({handleAutoShown:function(p){for(var v=l.coordinateSystem.getCartesians(),y=0;y<v.length;y++)if(e5(v[y].getOtherAxis(t.axis).scale))return!0;return!1}},a));it(Wke,h.add,h),this._axisGroup.add(h.getGroup()),it($ke,function(p){t.get([p,"show"])&&Xke[p](this,this._axisGroup,t,l)},this);var f=s&&s.type==="changeAxisOrder"&&s.isInitSort;f||hG(o,this._axisGroup,t),n.prototype.render.call(this,t,r,i,s)}},e.prototype.remove=function(){jke(this)},e.type="cartesianAxis",e}(wE),Xke={splitLine:function(n,e,t,r){var i=t.axis;if(!i.scale.isBlank()){var s=t.getModel("splitLine"),o=s.getModel("lineStyle"),l=o.get("color");l=fr(l)?l:[l];for(var a=r.coordinateSystem.getRect(),h=i.isHorizontal(),f=0,p=i.getTicksCoords({tickModel:s}),v=[],y=[],S=o.getLineStyle(),C=0;C<p.length;C++){var M=i.toGlobalCoord(p[C].coord);h?(v[0]=M,v[1]=a.y,y[0]=M,y[1]=a.y+a.height):(v[0]=a.x,v[1]=M,y[0]=a.x+a.width,y[1]=M);var E=f++%l.length,L=p[C].tickValue,k=new Hf({anid:L!=null?"line_"+p[C].tickValue:null,autoBatch:!0,shape:{x1:v[0],y1:v[1],x2:y[0],y2:y[1]},style:ti({stroke:l[E]},S),silent:!0});_M(k.shape,S.lineWidth),e.add(k)}}},minorSplitLine:function(n,e,t,r){var i=t.axis,s=t.getModel("minorSplitLine"),o=s.getModel("lineStyle"),l=r.coordinateSystem.getRect(),a=i.isHorizontal(),h=i.getMinorTicksCoords();if(h.length)for(var f=[],p=[],v=o.getLineStyle(),y=0;y<h.length;y++)for(var S=0;S<h[y].length;S++){var C=i.toGlobalCoord(h[y][S].coord);a?(f[0]=C,f[1]=l.y,p[0]=C,p[1]=l.y+l.height):(f[0]=l.x,f[1]=C,p[0]=l.x+l.width,p[1]=C);var M=new Hf({anid:"minor_line_"+h[y][S].tickValue,autoBatch:!0,shape:{x1:f[0],y1:f[1],x2:p[0],y2:p[1]},style:v,silent:!0});_M(M.shape,v.lineWidth),e.add(M)}},splitArea:function(n,e,t,r){Hke(n,e,t,r)}},fle=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="xAxis",e}(hle),qke=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=fle.type,t}return e.type="yAxis",e}(hle),Zke=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="grid",t}return e.prototype.render=function(t,r){this.group.removeAll(),t.get("show")&&this.group.add(new Ha({shape:t.coordinateSystem.getRect(),style:ti({fill:t.get("backgroundColor")},t.getItemStyle()),silent:!0,z2:-1}))},e.type="grid",e}(Dc),pY={offset:0};function Yke(n){n.registerComponentView(Zke),n.registerComponentModel(yke),n.registerCoordinateSystem("cartesian2d",Ike),cL(n,"x",r5,pY),cL(n,"y",r5,pY),n.registerComponentView(fle),n.registerComponentView(qke),n.registerPreprocessor(function(e){e.xAxis&&e.yAxis&&!e.grid&&(e.grid={})})}var mY="\0_ec_interaction_mutex";function Kke(n,e,t){var r=dle(n);r[e]=t}function Jke(n,e,t){var r=dle(n),i=r[e];i===t&&(r[e]=null)}function dle(n){return n[mY]||(n[mY]={})}Sp({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Rc);var Qke={axisPointer:1,tooltip:1,brush:1};function eOe(n,e,t){var r=e.getComponentByElement(n.topTarget),i=r&&r.coordinateSystem;return r&&r!==t&&!Qke.hasOwnProperty(r.mainType)&&i&&i.model!==t}function ple(n,e,t,r,i,s){n=n||0;var o=t[1]-t[0];if(i!=null&&(i=H1(i,[0,o])),s!=null&&(s=Math.max(s,i??0)),r==="all"){var l=Math.abs(e[1]-e[0]);l=H1(l,[0,o]),i=s=H1(l,[i,s]),r=0}e[0]=H1(e[0],t),e[1]=H1(e[1],t);var a=W3(e,r);e[r]+=n;var h=i||0,f=t.slice();a.sign<0?f[0]+=h:f[1]-=h,e[r]=H1(e[r],f);var p;return p=W3(e,r),i!=null&&(p.sign!==a.sign||p.span<i)&&(e[1-r]=e[r]+a.sign*i),p=W3(e,r),s!=null&&p.span>s&&(e[1-r]=e[r]+p.sign*s),e}function W3(n,e){var t=n[e]-n[1-e];return{span:Math.abs(t),sign:t>0?-1:t<0?1:e?-1:1}}function H1(n,e){return Math.min(e[1]!=null?e[1]:1/0,Math.max(e[0]!=null?e[0]:-1/0,n))}var hx=!0,CM=Math.min,pw=Math.max,tOe=Math.pow,nOe=1e4,rOe=6,iOe=6,gY="globalPan",sOe={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},aOe={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},vY={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},oOe=0,lOe=function(n){Hn(e,n);function e(t){var r=n.call(this)||this;return r._track=[],r._covers=[],r._handlers={},r._zr=t,r.group=new go,r._uid="brushController_"+oOe++,it(mOe,function(i,s){this._handlers[s]=Us(i,this)},r),r}return e.prototype.enableBrush=function(t){return this._brushType&&this._doDisableBrush(),t.brushType&&this._doEnableBrush(t),this},e.prototype._doEnableBrush=function(t){var r=this._zr;this._enableGlobalPan||Kke(r,gY,this._uid),it(this._handlers,function(i,s){r.on(s,i)}),this._brushType=t.brushType,this._brushOption=Bi(yi(vY),t,!0)},e.prototype._doDisableBrush=function(){var t=this._zr;Jke(t,gY,this._uid),it(this._handlers,function(r,i){t.off(i,r)}),this._brushType=this._brushOption=null},e.prototype.setPanels=function(t){if(t&&t.length){var r=this._panels={};it(t,function(i){r[i.panelId]=yi(i)})}else this._panels=null;return this},e.prototype.mount=function(t){t=t||{},this._enableGlobalPan=t.enableGlobalPan;var r=this.group;return this._zr.add(r),r.attr({x:t.x||0,y:t.y||0,rotation:t.rotation||0,scaleX:t.scaleX||1,scaleY:t.scaleY||1}),this._transform=r.getLocalTransform(),this},e.prototype.updateCovers=function(t){t=xr(t,function(v){return Bi(yi(vY),v,!0)});var r="\0-brush-index-",i=this._covers,s=this._covers=[],o=this,l=this._creatingCover;return new TM(i,t,h,a).add(f).update(f).remove(p).execute(),this;function a(v,y){return(v.id!=null?v.id:r+y)+"-"+v.brushType}function h(v,y){return a(v.__brushOption,y)}function f(v,y){var S=t[v];if(y!=null&&i[y]===l)s[v]=i[y];else{var C=s[v]=y!=null?(i[y].__brushOption=S,i[y]):gle(o,mle(o,S));WG(o,C)}}function p(v){i[v]!==l&&o.group.remove(i[v])}},e.prototype.unmount=function(){return this.enableBrush(!1),l5(this),this._zr.remove(this.group),this},e.prototype.dispose=function(){this.unmount(),this.off()},e}(ld);function mle(n,e){var t=bB[e.brushType].createCover(n,e);return t.__brushOption=e,_le(t,e),n.group.add(t),t}function gle(n,e){var t=$G(e);return t.endCreating&&(t.endCreating(n,e),_le(e,e.__brushOption)),e}function vle(n,e){var t=e.__brushOption;$G(e).updateCoverShape(n,e,t.range,t)}function _le(n,e){var t=e.z;t==null&&(t=nOe),n.traverse(function(r){r.z=t,r.z2=t})}function WG(n,e){$G(e).updateCommon(n,e),vle(n,e)}function $G(n){return bB[n.__brushOption.brushType]}function XG(n,e,t){var r=n._panels;if(!r)return hx;var i,s=n._transform;return it(r,function(o){o.isTargetByCursor(e,t,s)&&(i=o)}),i}function yle(n,e){var t=n._panels;if(!t)return hx;var r=e.__brushOption.panelId;return r!=null?t[r]:hx}function l5(n){var e=n._covers,t=e.length;return it(e,function(r){n.group.remove(r)},n),e.length=0,!!t}function fx(n,e){var t=xr(n._covers,function(r){var i=r.__brushOption,s=yi(i.range);return{brushType:i.brushType,panelId:i.panelId,range:s}});n.trigger("brush",{areas:t,isEnd:!!e.isEnd,removeOnClick:!!e.removeOnClick})}function cOe(n){var e=n._track;if(!e.length)return!1;var t=e[e.length-1],r=e[0],i=t[0]-r[0],s=t[1]-r[1],o=tOe(i*i+s*s,.5);return o>rOe}function xle(n){var e=n.length-1;return e<0&&(e=0),[n[0],n[e]]}function ble(n,e,t,r){var i=new go;return i.add(new Ha({name:"main",style:qG(t),silent:!0,draggable:!0,cursor:"move",drift:_s(_Y,n,e,i,["n","s","w","e"]),ondragend:_s(fx,e,{isEnd:!0})})),it(r,function(s){i.add(new Ha({name:s.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:_s(_Y,n,e,i,s),ondragend:_s(fx,e,{isEnd:!0})}))}),i}function wle(n,e,t,r){var i=r.brushStyle.lineWidth||0,s=pw(i,iOe),o=t[0][0],l=t[1][0],a=o-i/2,h=l-i/2,f=t[0][1],p=t[1][1],v=f-s+i/2,y=p-s+i/2,S=f-o,C=p-l,M=S+i,E=C+i;ym(n,e,"main",o,l,S,C),r.transformable&&(ym(n,e,"w",a,h,s,E),ym(n,e,"e",v,h,s,E),ym(n,e,"n",a,h,M,s),ym(n,e,"s",a,y,M,s),ym(n,e,"nw",a,h,s,s),ym(n,e,"ne",v,h,s,s),ym(n,e,"sw",a,y,s,s),ym(n,e,"se",v,y,s,s))}function c5(n,e){var t=e.__brushOption,r=t.transformable,i=e.childAt(0);i.useStyle(qG(t)),i.attr({silent:!r,cursor:r?"move":"default"}),it([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(s){var o=e.childOfName(s.join("")),l=s.length===1?u5(n,s[0]):hOe(n,s);o&&o.attr({silent:!r,invisible:!r,cursor:r?aOe[l]+"-resize":null})})}function ym(n,e,t,r,i,s,o){var l=e.childOfName(t);l&&l.setShape(dOe(ZG(n,e,[[r,i],[r+s,i+o]])))}function qG(n){return ti({strokeNoScale:!0},n.brushStyle)}function Sle(n,e,t,r){var i=[CM(n,t),CM(e,r)],s=[pw(n,t),pw(e,r)];return[[i[0],s[0]],[i[1],s[1]]]}function uOe(n){return uG(n.group)}function u5(n,e){var t={w:"left",e:"right",n:"top",s:"bottom"},r={left:"w",right:"e",top:"n",bottom:"s"},i=zse(t[e],uOe(n));return r[i]}function hOe(n,e){var t=[u5(n,e[0]),u5(n,e[1])];return(t[0]==="e"||t[0]==="w")&&t.reverse(),t.join("")}function _Y(n,e,t,r,i,s){var o=t.__brushOption,l=n.toRectRange(o.range),a=Ale(e,i,s);it(r,function(h){var f=sOe[h];l[f[0]][f[1]]+=a[f[0]]}),o.range=n.fromRectRange(Sle(l[0][0],l[1][0],l[0][1],l[1][1])),WG(e,t),fx(e,{isEnd:!1})}function fOe(n,e,t,r){var i=e.__brushOption.range,s=Ale(n,t,r);it(i,function(o){o[0]+=s[0],o[1]+=s[1]}),WG(n,e),fx(n,{isEnd:!1})}function Ale(n,e,t){var r=n.group,i=r.transformCoordToLocal(e,t),s=r.transformCoordToLocal(0,0);return[i[0]-s[0],i[1]-s[1]]}function ZG(n,e,t){var r=yle(n,e);return r&&r!==hx?r.clipPath(t,n._transform):yi(t)}function dOe(n){var e=CM(n[0][0],n[1][0]),t=CM(n[0][1],n[1][1]),r=pw(n[0][0],n[1][0]),i=pw(n[0][1],n[1][1]);return{x:e,y:t,width:r-e,height:i-t}}function pOe(n,e,t){if(!(!n._brushType||gOe(n,e.offsetX,e.offsetY))){var r=n._zr,i=n._covers,s=XG(n,e,t);if(!n._dragging)for(var o=0;o<i.length;o++){var l=i[o].__brushOption;if(s&&(s===hx||l.panelId===s.panelId)&&bB[l.brushType].contain(i[o],t[0],t[1]))return}s&&r.setCursorStyle("crosshair")}}function h5(n){var e=n.event;e.preventDefault&&e.preventDefault()}function f5(n,e,t){return n.childOfName("main").contain(e,t)}function Tle(n,e,t,r){var i=n._creatingCover,s=n._creatingPanel,o=n._brushOption,l;if(n._track.push(t.slice()),cOe(n)||i){if(s&&!i){o.brushMode==="single"&&l5(n);var a=yi(o);a.brushType=yY(a.brushType,s),a.panelId=s===hx?null:s.panelId,i=n._creatingCover=mle(n,a),n._covers.push(i)}if(i){var h=bB[yY(n._brushType,s)],f=i.__brushOption;f.range=h.getCreatingRange(ZG(n,i,n._track)),r&&(gle(n,i),h.updateCommon(n,i)),vle(n,i),l={isEnd:r}}}else r&&o.brushMode==="single"&&o.removeOnClick&&XG(n,e,t)&&l5(n)&&(l={isEnd:r,removeOnClick:!0});return l}function yY(n,e){return n==="auto"?e.defaultBrushType:n}var mOe={mousedown:function(n){if(this._dragging)xY(this,n);else if(!n.target||!n.target.draggable){h5(n);var e=this.group.transformCoordToLocal(n.offsetX,n.offsetY);this._creatingCover=null;var t=this._creatingPanel=XG(this,n,e);t&&(this._dragging=!0,this._track=[e.slice()])}},mousemove:function(n){var e=n.offsetX,t=n.offsetY,r=this.group.transformCoordToLocal(e,t);if(pOe(this,n,r),this._dragging){h5(n);var i=Tle(this,n,r,!1);i&&fx(this,i)}},mouseup:function(n){xY(this,n)}};function xY(n,e){if(n._dragging){h5(e);var t=e.offsetX,r=e.offsetY,i=n.group.transformCoordToLocal(t,r),s=Tle(n,e,i,!0);n._dragging=!1,n._track=[],n._creatingCover=null,s&&fx(n,s)}}function gOe(n,e,t){var r=n._zr;return e<0||e>r.getWidth()||t<0||t>r.getHeight()}var bB={lineX:bY(0),lineY:bY(1),rect:{createCover:function(n,e){function t(r){return r}return ble({toRectRange:t,fromRectRange:t},n,e,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(n){var e=xle(n);return Sle(e[1][0],e[1][1],e[0][0],e[0][1])},updateCoverShape:function(n,e,t,r){wle(n,e,t,r)},updateCommon:c5,contain:f5},polygon:{createCover:function(n,e){var t=new go;return t.add(new Bw({name:"main",style:qG(e),silent:!0})),t},getCreatingRange:function(n){return n},endCreating:function(n,e){e.remove(e.childAt(0)),e.add(new eB({name:"main",draggable:!0,drift:_s(fOe,n,e),ondragend:_s(fx,n,{isEnd:!0})}))},updateCoverShape:function(n,e,t,r){e.childAt(0).setShape({points:ZG(n,e,t)})},updateCommon:c5,contain:f5}};function bY(n){return{createCover:function(e,t){return ble({toRectRange:function(r){var i=[r,[0,100]];return n&&i.reverse(),i},fromRectRange:function(r){return r[n]}},e,t,[[["w"],["e"]],[["n"],["s"]]][n])},getCreatingRange:function(e){var t=xle(e),r=CM(t[0][n],t[1][n]),i=pw(t[0][n],t[1][n]);return[r,i]},updateCoverShape:function(e,t,r,i){var s,o=yle(e,t);if(o!==hx&&o.getLinearBrushOtherExtent)s=o.getLinearBrushOtherExtent(n);else{var l=e._zr;s=[0,[l.getWidth(),l.getHeight()][1-n]]}var a=[r,s];n&&a.reverse(),wle(e,t,a,i)},updateCommon:c5,contain:f5}}function vOe(n){return n=YG(n),function(e){return Use(e,n)}}function _Oe(n,e){return n=YG(n),function(t){var r=e??t,i=r?n.width:n.height,s=r?n.x:n.y;return[s,s+(i||0)]}}function yOe(n,e,t){var r=YG(n);return function(i,s){return r.contain(s[0],s[1])&&!eOe(i,e,t)}}function YG(n){return cs.create(n)}var vy=qs(),wY=yi,$3=Us,Mle=function(){function n(){this._dragging=!1,this.animationThreshold=15}return n.prototype.render=function(e,t,r,i){var s=t.get("value"),o=t.get("status");if(this._axisModel=e,this._axisPointerModel=t,this._api=r,!(!i&&this._lastValue===s&&this._lastStatus===o)){this._lastValue=s,this._lastStatus=o;var l=this._group,a=this._handle;if(!o||o==="hide"){l&&l.hide(),a&&a.hide();return}l&&l.show(),a&&a.show();var h={};this.makeElOption(h,s,e,t,r);var f=h.graphicKey;f!==this._lastGraphicKey&&this.clear(r),this._lastGraphicKey=f;var p=this._moveAnimation=this.determineAnimation(e,t);if(!l)l=this._group=new go,this.createPointerEl(l,h,e,t),this.createLabelEl(l,h,e,t),r.getZr().add(l);else{var v=_s(SY,t,p);this.updatePointerEl(l,h,v),this.updateLabelEl(l,h,v,t)}TY(l,t,!0),this._renderHandle(s)}},n.prototype.remove=function(e){this.clear(e)},n.prototype.dispose=function(e){this.clear(e)},n.prototype.determineAnimation=function(e,t){var r=t.get("animation"),i=e.axis,s=i.type==="category",o=t.get("snap");if(!o&&!s)return!1;if(r==="auto"||r==null){var l=this.animationThreshold;if(s&&i.getBandWidth()>l)return!0;if(o){var a=jG(e).seriesDataCount,h=i.getExtent();return Math.abs(h[0]-h[1])/a>l}return!1}return r===!0},n.prototype.makeElOption=function(e,t,r,i,s){},n.prototype.createPointerEl=function(e,t,r,i){var s=t.pointer;if(s){var o=vy(e).pointerEl=new fG[s.type](wY(t.pointer));e.add(o)}},n.prototype.createLabelEl=function(e,t,r,i){if(t.label){var s=vy(e).labelEl=new Io(wY(t.label));e.add(s),AY(s,i)}},n.prototype.updatePointerEl=function(e,t,r){var i=vy(e).pointerEl;i&&t.pointer&&(i.setStyle(t.pointer.style),r(i,{shape:t.pointer.shape}))},n.prototype.updateLabelEl=function(e,t,r,i){var s=vy(e).labelEl;s&&(s.setStyle(t.label.style),r(s,{x:t.label.x,y:t.label.y}),AY(s,i))},n.prototype._renderHandle=function(e){if(!(this._dragging||!this.updateHandleTransform)){var t=this._axisPointerModel,r=this._api.getZr(),i=this._handle,s=t.getModel("handle"),o=t.get("status");if(!s.get("show")||!o||o==="hide"){i&&r.remove(i),this._handle=null;return}var l;this._handle||(l=!0,i=this._handle=iB(s.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(h){bie(h.event)},onmousedown:$3(this._onHandleDragMove,this,0,0),drift:$3(this._onHandleDragMove,this),ondragend:$3(this._onHandleDragEnd,this)}),r.add(i)),TY(i,t,!1),i.setStyle(s.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var a=s.get("size");fr(a)||(a=[a,a]),i.scaleX=a[0]/2,i.scaleY=a[1]/2,Oae(this,"_doDispatchAxisPointer",s.get("throttle")||0,"fixRate"),this._moveHandleToValue(e,l)}},n.prototype._moveHandleToValue=function(e,t){SY(this._axisPointerModel,!t&&this._moveAnimation,this._handle,X3(this.getHandleTransform(e,this._axisModel,this._axisPointerModel)))},n.prototype._onHandleDragMove=function(e,t){var r=this._handle;if(r){this._dragging=!0;var i=this.updateHandleTransform(X3(r),[e,t],this._axisModel,this._axisPointerModel);this._payloadInfo=i,r.stopAnimation(),r.attr(X3(i)),vy(r).lastProp=null,this._doDispatchAxisPointer()}},n.prototype._doDispatchAxisPointer=function(){var e=this._handle;if(e){var t=this._payloadInfo,r=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:t.cursorPoint[0],y:t.cursorPoint[1],tooltipOption:t.tooltipOption,axesInfo:[{axisDim:r.axis.dim,axisIndex:r.componentIndex}]})}},n.prototype._onHandleDragEnd=function(){this._dragging=!1;var e=this._handle;if(e){var t=this._axisPointerModel.get("value");this._moveHandleToValue(t),this._api.dispatchAction({type:"hideTip"})}},n.prototype.clear=function(e){this._lastValue=null,this._lastStatus=null;var t=e.getZr(),r=this._group,i=this._handle;t&&r&&(this._lastGraphicKey=null,r&&t.remove(r),i&&t.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),jz(this,"_doDispatchAxisPointer")},n.prototype.doClear=function(){},n.prototype.buildLabel=function(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}},n}();function SY(n,e,t,r){Ele(vy(t).lastProp,r)||(vy(t).lastProp=r,e?ol(t,r,n):(t.stopAnimation(),t.attr(r)))}function Ele(n,e){if($r(n)&&$r(e)){var t=!0;return it(e,function(r,i){t=t&&Ele(n[i],r)}),!!t}else return n===e}function AY(n,e){n[e.get(["label","show"])?"show":"hide"]()}function X3(n){return{x:n.x||0,y:n.y||0,rotation:n.rotation||0}}function TY(n,e,t){var r=e.get("z"),i=e.get("zlevel");n&&n.traverse(function(s){s.type!=="group"&&(r!=null&&(s.z=r),i!=null&&(s.zlevel=i),s.silent=t)})}function Cle(n){var e=n.get("type"),t=n.getModel(e+"Style"),r;return e==="line"?(r=t.getLineStyle(),r.fill=null):e==="shadow"&&(r=t.getAreaStyle(),r.stroke=null),r}function Ile(n,e,t,r,i){var s=t.get("value"),o=Rle(s,e.axis,e.ecModel,t.get("seriesDataIndices"),{precision:t.get(["label","precision"]),formatter:t.get(["label","formatter"])}),l=t.getModel("label"),a=dB(l.get("padding")||0),h=l.getFont(),f=gE(o,h),p=i.position,v=f.width+a[1]+a[3],y=f.height+a[0]+a[2],S=i.align;S==="right"&&(p[0]-=v),S==="center"&&(p[0]-=v/2);var C=i.verticalAlign;C==="bottom"&&(p[1]-=y),C==="middle"&&(p[1]-=y/2),xOe(p,v,y,r);var M=l.get("backgroundColor");(!M||M==="auto")&&(M=e.get(["axisLine","lineStyle","color"])),n.label={x:p[0],y:p[1],style:ng(l,{text:o,font:h,fill:l.getTextColor(),padding:a,backgroundColor:M}),z2:10}}function xOe(n,e,t,r){var i=r.getWidth(),s=r.getHeight();n[0]=Math.min(n[0]+e,i)-e,n[1]=Math.min(n[1]+t,s)-t,n[0]=Math.max(n[0],0),n[1]=Math.max(n[1],0)}function Rle(n,e,t,r,i){n=e.scale.parse(n);var s=e.scale.getLabel({value:n},{precision:i.precision}),o=i.formatter;if(o){var l={value:NG(e,{value:n}),axisDimension:e.dim,axisIndex:e.index,seriesData:[]};it(r,function(a){var h=t.getSeriesByIndex(a.seriesIndex),f=a.dataIndexInside,p=h&&h.getDataParams(f);p&&l.seriesData.push(p)}),Dr(o)?s=o.replace("{value}",s):ci(o)&&(s=o(l))}return s}function Ple(n,e,t){var r=Vy();return HD(r,r,t.rotation),kP(r,r,t.position),rB([n.dataToCoord(e),(t.labelOffset||0)+(t.labelDirection||1)*(t.labelMargin||0)],r)}function bOe(n,e,t,r,i,s){var o=Lh.innerTextLayout(t.rotation,0,t.labelDirection);t.labelMargin=i.get(["label","margin"]),Ile(e,r,i,s,{position:Ple(r.axis,n,t),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function Lle(n,e,t){return t=t||0,{x1:n[t],y1:n[1-t],x2:e[t],y2:e[1-t]}}function wOe(n,e,t){return t=t||0,{x:n[t],y:n[1-t],width:e[t],height:e[1-t]}}function MY(n,e,t,r,i,s){return{cx:n,cy:e,r0:t,r,startAngle:i,endAngle:s,clockwise:!0}}var SOe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,i,s,o){var l=i.axis,a=l.grid,h=s.get("type"),f=EY(a,l).getOtherAxis(l).getGlobalExtent(),p=l.toGlobalCoord(l.dataToCoord(r,!0));if(h&&h!=="none"){var v=Cle(s),y=AOe[h](l,p,f);y.style=v,t.graphicKey=y.type,t.pointer=y}var S=s5(a.model,i);bOe(r,t,S,i,s,o)},e.prototype.getHandleTransform=function(t,r,i){var s=s5(r.axis.grid.model,r,{labelInside:!1});s.labelMargin=i.get(["handle","margin"]);var o=Ple(r.axis,t,s);return{x:o[0],y:o[1],rotation:s.rotation+(s.labelDirection<0?Math.PI:0)}},e.prototype.updateHandleTransform=function(t,r,i,s){var o=i.axis,l=o.grid,a=o.getGlobalExtent(!0),h=EY(l,o).getOtherAxis(o).getGlobalExtent(),f=o.dim==="x"?0:1,p=[t.x,t.y];p[f]+=r[f],p[f]=Math.min(a[1],p[f]),p[f]=Math.max(a[0],p[f]);var v=(h[1]+h[0])/2,y=[v,v];y[f]=p[f];var S=[{verticalAlign:"middle"},{align:"center"}];return{x:p[0],y:p[1],rotation:t.rotation,cursorPoint:y,tooltipOption:S[f]}},e}(Mle);function EY(n,e){var t={};return t[e.dim+"AxisIndex"]=e.index,n.getCartesian(t)}var AOe={line:function(n,e,t){var r=Lle([e,t[0]],[e,t[1]],CY(n));return{type:"Line",subPixelOptimize:!0,shape:r}},shadow:function(n,e,t){var r=Math.max(1,n.getBandWidth()),i=t[1]-t[0];return{type:"Rect",shape:wOe([e-r/2,t[0]],[r,i],CY(n))}}};function CY(n){return n.dim==="x"?0:1}var TOe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="axisPointer",e.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},e}(as),Om=qs(),MOe=it;function Dle(n,e,t){if(!gi.node){var r=e.getZr();Om(r).records||(Om(r).records={}),EOe(r,e);var i=Om(r).records[n]||(Om(r).records[n]={});i.handler=t}}function EOe(n,e){if(Om(n).initialized)return;Om(n).initialized=!0,t("click",_s(IY,"click")),t("mousemove",_s(IY,"mousemove")),t("globalout",IOe);function t(r,i){n.on(r,function(s){var o=ROe(e);MOe(Om(n).records,function(l){l&&i(l,s,o.dispatchAction)}),COe(o.pendings,e)})}}function COe(n,e){var t=n.showTip.length,r=n.hideTip.length,i;t?i=n.showTip[t-1]:r&&(i=n.hideTip[r-1]),i&&(i.dispatchAction=null,e.dispatchAction(i))}function IOe(n,e,t){n.handler("leave",null,t)}function IY(n,e,t,r){e.handler(n,t,r)}function ROe(n){var e={showTip:[],hideTip:[]},t=function(r){var i=e[r.type];i?i.push(r):(r.dispatchAction=t,n.dispatchAction(r))};return{dispatchAction:t,pendings:e}}function d5(n,e){if(!gi.node){var t=e.getZr(),r=(Om(t).records||{})[n];r&&(Om(t).records[n]=null)}}var POe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i){var s=r.getComponent("tooltip"),o=t.get("triggerOn")||s&&s.get("triggerOn")||"mousemove|click";Dle("axisPointer",i,function(l,a,h){o!=="none"&&(l==="leave"||o.indexOf(l)>=0)&&h({type:"updateAxisPointer",currTrigger:l,x:a&&a.offsetX,y:a&&a.offsetY})})},e.prototype.remove=function(t,r){d5("axisPointer",r)},e.prototype.dispose=function(t,r){d5("axisPointer",r)},e.type="axisPointer",e}(Dc);function Ble(n,e){var t=[],r=n.seriesIndex,i;if(r==null||!(i=e.getSeriesByIndex(r)))return{point:[]};var s=i.getData(),o=lx(s,n);if(o==null||o<0||fr(o))return{point:[]};var l=s.getItemGraphicEl(o),a=i.coordinateSystem;if(i.getTooltipPosition)t=i.getTooltipPosition(o)||[];else if(a&&a.dataToPoint)if(n.isStacked){var h=a.getBaseAxis(),f=a.getOtherAxis(h),p=f.dim,v=h.dim,y=p==="x"||p==="radius"?1:0,S=s.mapDimension(v),C=[];C[y]=s.get(S,o),C[1-y]=s.get(s.getCalculationInfo("stackResultDimension"),o),t=a.dataToPoint(C)||[]}else t=a.dataToPoint(s.getValues(xr(a.dimensions,function(E){return s.mapDimension(E)}),o))||[];else if(l){var M=l.getBoundingRect().clone();M.applyTransform(l.transform),t=[M.x+M.width/2,M.y+M.height/2]}return{point:t,el:l}}var RY=qs();function LOe(n,e,t){var r=n.currTrigger,i=[n.x,n.y],s=n,o=n.dispatchAction||Us(t.dispatchAction,t),l=e.getComponent("axisPointer").coordSysAxesInfo;if(l){_R(i)&&(i=Ble({seriesIndex:s.seriesIndex,dataIndex:s.dataIndex},e).point);var a=_R(i),h=s.axesInfo,f=l.axesInfo,p=r==="leave"||_R(i),v={},y={},S={list:[],map:{}},C={showPointer:_s(BOe,y),showTooltip:_s(kOe,S)};it(l.coordSysMap,function(E,L){var k=a||E.containPoint(i);it(l.coordSysAxesInfo[L],function(H,X){var Z=H.axis,Q=zOe(h,H);if(!p&&k&&(!h||Q)){var re=Q&&Q.value;re==null&&!a&&(re=Z.pointToData(i)),re!=null&&PY(H,re,C,!1,v)}})});var M={};return it(f,function(E,L){var k=E.linkGroup;k&&!y[L]&&it(k.axesInfo,function(H,X){var Z=y[X];if(H!==E&&Z){var Q=Z.value;k.mapper&&(Q=E.axis.scale.parse(k.mapper(Q,LY(H),LY(E)))),M[E.key]=Q}})}),it(M,function(E,L){PY(f[L],E,C,!0,v)}),OOe(y,f,v),FOe(S,i,n,o),NOe(f,o,t),v}}function PY(n,e,t,r,i){var s=n.axis;if(!(s.scale.isBlank()||!s.containData(e))){if(!n.involveSeries){t.showPointer(n,e);return}var o=DOe(e,n),l=o.payloadBatch,a=o.snapToValue;l[0]&&i.seriesIndex==null&&Jn(i,l[0]),!r&&n.snap&&s.containData(a)&&a!=null&&(e=a),t.showPointer(n,e,l),t.showTooltip(n,o,a)}}function DOe(n,e){var t=e.axis,r=t.dim,i=n,s=[],o=Number.MAX_VALUE,l=-1;return it(e.seriesModels,function(a,h){var f=a.getData().mapDimensionsAll(r),p,v;if(a.getAxisTooltipData){var y=a.getAxisTooltipData(f,n,t);v=y.dataIndices,p=y.nestestValue}else{if(v=a.getData().indicesOfNearest(f[0],n,t.type==="category"?.5:null),!v.length)return;p=a.getData().get(f[0],v[0])}if(!(p==null||!isFinite(p))){var S=n-p,C=Math.abs(S);C<=o&&((C<o||S>=0&&l<0)&&(o=C,l=S,i=p,s.length=0),it(v,function(M){s.push({seriesIndex:a.seriesIndex,dataIndexInside:M,dataIndex:a.getData().getRawIndex(M)})}))}}),{payloadBatch:s,snapToValue:i}}function BOe(n,e,t,r){n[e.key]={value:t,payloadBatch:r}}function kOe(n,e,t,r){var i=t.payloadBatch,s=e.axis,o=s.model,l=e.axisPointerModel;if(!(!e.triggerTooltip||!i.length)){var a=e.coordSys.model,h=EM(a),f=n.map[h];f||(f=n.map[h]={coordSysId:a.id,coordSysIndex:a.componentIndex,coordSysType:a.type,coordSysMainType:a.mainType,dataByAxis:[]},n.list.push(f)),f.dataByAxis.push({axisDim:s.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:r,valueLabelOpt:{precision:l.get(["label","precision"]),formatter:l.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function OOe(n,e,t){var r=t.axesInfo=[];it(e,function(i,s){var o=i.axisPointerModel.option,l=n[s];l?(!i.useHandle&&(o.status="show"),o.value=l.value,o.seriesDataIndices=(l.payloadBatch||[]).slice()):!i.useHandle&&(o.status="hide"),o.status==="show"&&r.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:o.value})})}function FOe(n,e,t,r){if(_R(e)||!n.list.length){r({type:"hideTip"});return}var i=((n.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};r({type:"showTip",escapeConnect:!0,x:e[0],y:e[1],tooltipOption:t.tooltipOption,position:t.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:n.list})}function NOe(n,e,t){var r=t.getZr(),i="axisPointerLastHighlights",s=RY(r)[i]||{},o=RY(r)[i]={};it(n,function(h,f){var p=h.axisPointerModel.option;p.status==="show"&&h.triggerEmphasis&&it(p.seriesDataIndices,function(v){var y=v.seriesIndex+" | "+v.dataIndex;o[y]=v})});var l=[],a=[];it(s,function(h,f){!o[f]&&a.push(h)}),it(o,function(h,f){!s[f]&&l.push(h)}),a.length&&t.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:a}),l.length&&t.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:l})}function zOe(n,e){for(var t=0;t<(n||[]).length;t++){var r=n[t];if(e.axis.dim===r.axisDim&&e.axis.model.componentIndex===r.axisIndex)return r}}function LY(n){var e=n.axis.model,t={},r=t.axisDim=n.axis.dim;return t.axisIndex=t[r+"AxisIndex"]=e.componentIndex,t.axisName=t[r+"AxisName"]=e.name,t.axisId=t[r+"AxisId"]=e.id,t}function _R(n){return!n||n[0]==null||isNaN(n[0])||n[1]==null||isNaN(n[1])}function KG(n){wE.registerAxisPointerClass("CartesianAxisPointer",SOe),n.registerComponentModel(TOe),n.registerComponentView(POe),n.registerPreprocessor(function(e){if(e){(!e.axisPointer||e.axisPointer.length===0)&&(e.axisPointer={});var t=e.axisPointer.link;t&&!fr(t)&&(e.axisPointer.link=[t])}}),n.registerProcessor(n.PRIORITY.PROCESSOR.STATISTIC,function(e,t){e.getComponent("axisPointer").coordSysAxesInfo=Oke(e,t)}),n.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},LOe)}function UOe(n){_p(Yke),_p(KG)}var GOe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.makeElOption=function(t,r,i,s,o){var l=i.axis;l.dim==="angle"&&(this.animationThreshold=Math.PI/18);var a=l.polar,h=a.getOtherAxis(l),f=h.getExtent(),p=l.dataToCoord(r),v=s.get("type");if(v&&v!=="none"){var y=Cle(s),S=HOe[v](l,a,p,f);S.style=y,t.graphicKey=S.type,t.pointer=S}var C=s.get(["label","margin"]),M=VOe(r,i,s,a,C);Ile(t,i,s,o,M)},e}(Mle);function VOe(n,e,t,r,i){var s=e.axis,o=s.dataToCoord(n),l=r.getAngleAxis().getExtent()[0];l=l/180*Math.PI;var a=r.getRadiusAxis().getExtent(),h,f,p;if(s.dim==="radius"){var v=Vy();HD(v,v,l),kP(v,v,[r.cx,r.cy]),h=rB([o,-i],v);var y=e.getModel("axisLabel").get("rotate")||0,S=Lh.innerTextLayout(l,y*Math.PI/180,-1);f=S.textAlign,p=S.textVerticalAlign}else{var C=a[1];h=r.coordToPoint([C+i,o]);var M=r.cx,E=r.cy;f=Math.abs(h[0]-M)/C<.3?"center":h[0]>M?"left":"right",p=Math.abs(h[1]-E)/C<.3?"middle":h[1]>E?"top":"bottom"}return{position:h,align:f,verticalAlign:p}}var HOe={line:function(n,e,t,r){return n.dim==="angle"?{type:"Line",shape:Lle(e.coordToPoint([r[0],t]),e.coordToPoint([r[1],t]))}:{type:"Circle",shape:{cx:e.cx,cy:e.cy,r:t}}},shadow:function(n,e,t,r){var i=Math.max(1,n.getBandWidth()),s=Math.PI/180;return n.dim==="angle"?{type:"Sector",shape:MY(e.cx,e.cy,r[0],r[1],(-t-i/2)*s,(-t+i/2)*s)}:{type:"Sector",shape:MY(e.cx,e.cy,t-i/2,t+i/2,0,Math.PI*2)}}},jOe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.findAxisModel=function(t){var r,i=this.ecModel;return i.eachComponent(t,function(s){s.getCoordSysModel()===this&&(r=s)},this),r},e.type="polar",e.dependencies=["radiusAxis","angleAxis"],e.defaultOption={z:0,center:["50%","50%"],radius:"80%"},e}(as),JG=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",bl).models[0]},e.type="polarAxis",e}(as);od(JG,Doe);var WOe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="angleAxis",e}(JG),$Oe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="radiusAxis",e}(JG),QG=function(n){Hn(e,n);function e(t,r){return n.call(this,"radius",t,r)||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e}(Ix);QG.prototype.dataToRadius=Ix.prototype.dataToCoord;QG.prototype.radiusToData=Ix.prototype.coordToData;var XOe=qs(),e8=function(n){Hn(e,n);function e(t,r){return n.call(this,"angle",t,r||[0,360])||this}return e.prototype.pointToData=function(t,r){return this.polar.pointToData(t,r)[this.dim==="radius"?0:1]},e.prototype.calculateCategoryInterval=function(){var t=this,r=t.getLabelModel(),i=t.scale,s=i.getExtent(),o=i.count();if(s[1]-s[0]<1)return 0;var l=s[0],a=t.dataToCoord(l+1)-t.dataToCoord(l),h=Math.abs(a),f=gE(l==null?"":l+"",r.getFont(),"center","top"),p=Math.max(f.height,7),v=p/h;isNaN(v)&&(v=1/0);var y=Math.max(0,Math.floor(v)),S=XOe(t.model),C=S.lastAutoInterval,M=S.lastTickCount;return C!=null&&M!=null&&Math.abs(C-y)<=1&&Math.abs(M-o)<=1&&C>y?y=C:(S.lastTickCount=o,S.lastAutoInterval=y),y},e}(Ix);e8.prototype.dataToAngle=Ix.prototype.dataToCoord;e8.prototype.angleToData=Ix.prototype.coordToData;var kle=["radius","angle"],qOe=function(){function n(e){this.dimensions=kle,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new QG,this._angleAxis=new e8,this.axisPointerEnabled=!0,this.name=e||"",this._radiusAxis.polar=this._angleAxis.polar=this}return n.prototype.containPoint=function(e){var t=this.pointToCoord(e);return this._radiusAxis.contain(t[0])&&this._angleAxis.contain(t[1])},n.prototype.containData=function(e){return this._radiusAxis.containData(e[0])&&this._angleAxis.containData(e[1])},n.prototype.getAxis=function(e){var t="_"+e+"Axis";return this[t]},n.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},n.prototype.getAxesByScale=function(e){var t=[],r=this._angleAxis,i=this._radiusAxis;return r.scale.type===e&&t.push(r),i.scale.type===e&&t.push(i),t},n.prototype.getAngleAxis=function(){return this._angleAxis},n.prototype.getRadiusAxis=function(){return this._radiusAxis},n.prototype.getOtherAxis=function(e){var t=this._angleAxis;return e===t?this._radiusAxis:t},n.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},n.prototype.getTooltipAxes=function(e){var t=e!=null&&e!=="auto"?this.getAxis(e):this.getBaseAxis();return{baseAxes:[t],otherAxes:[this.getOtherAxis(t)]}},n.prototype.dataToPoint=function(e,t){return this.coordToPoint([this._radiusAxis.dataToRadius(e[0],t),this._angleAxis.dataToAngle(e[1],t)])},n.prototype.pointToData=function(e,t){var r=this.pointToCoord(e);return[this._radiusAxis.radiusToData(r[0],t),this._angleAxis.angleToData(r[1],t)]},n.prototype.pointToCoord=function(e){var t=e[0]-this.cx,r=e[1]-this.cy,i=this.getAngleAxis(),s=i.getExtent(),o=Math.min(s[0],s[1]),l=Math.max(s[0],s[1]);i.inverse?o=l-360:l=o+360;var a=Math.sqrt(t*t+r*r);t/=a,r/=a;for(var h=Math.atan2(-r,t)/Math.PI*180,f=h<o?1:-1;h<o||h>l;)h+=f*360;return[a,h]},n.prototype.coordToPoint=function(e){var t=e[0],r=e[1]/180*Math.PI,i=Math.cos(r)*t+this.cx,s=-Math.sin(r)*t+this.cy;return[i,s]},n.prototype.getArea=function(){var e=this.getAngleAxis(),t=this.getRadiusAxis(),r=t.getExtent().slice();r[0]>r[1]&&r.reverse();var i=e.getExtent(),s=Math.PI/180;return{cx:this.cx,cy:this.cy,r0:r[0],r:r[1],startAngle:-i[0]*s,endAngle:-i[1]*s,clockwise:e.inverse,contain:function(o,l){var a=o-this.cx,h=l-this.cy,f=a*a+h*h-1e-4,p=this.r,v=this.r0;return f<=p*p&&f>=v*v}}},n.prototype.convertToPixel=function(e,t,r){var i=DY(t);return i===this?this.dataToPoint(r):null},n.prototype.convertFromPixel=function(e,t,r){var i=DY(t);return i===this?this.pointToData(r):null},n}();function DY(n){var e=n.seriesModel,t=n.polarModel;return t&&t.coordinateSystem||e&&e.coordinateSystem}const ZOe=qOe;function YOe(n,e,t){var r=e.get("center"),i=t.getWidth(),s=t.getHeight();n.cx=ls(r[0],i),n.cy=ls(r[1],s);var o=n.getRadiusAxis(),l=Math.min(i,s)/2,a=e.get("radius");a==null?a=[0,"100%"]:fr(a)||(a=[0,a]);var h=[ls(a[0],l),ls(a[1],l)];o.inverse?o.setExtent(h[1],h[0]):o.setExtent(h[0],h[1])}function KOe(n,e){var t=this,r=t.getAngleAxis(),i=t.getRadiusAxis();if(r.scale.setExtent(1/0,-1/0),i.scale.setExtent(1/0,-1/0),n.eachSeries(function(l){if(l.coordinateSystem===t){var a=l.getData();it(aL(a,"radius"),function(h){i.scale.unionExtentFromData(a,h)}),it(aL(a,"angle"),function(h){r.scale.unionExtentFromData(a,h)})}}),sL(r.scale,r.model),sL(i.scale,i.model),r.type==="category"&&!r.onBand){var s=r.getExtent(),o=360/r.scale.count();r.inverse?s[1]+=o:s[1]-=o,r.setExtent(s[0],s[1])}}function JOe(n){return n.mainType==="angleAxis"}function BY(n,e){var t;if(n.type=e.get("type"),n.scale=Poe(e),n.onBand=e.get("boundaryGap")&&n.type==="category",n.inverse=e.get("inverse"),JOe(e)){n.inverse=n.inverse!==e.get("clockwise");var r=e.get("startAngle"),i=(t=e.get("endAngle"))!==null&&t!==void 0?t:r+(n.inverse?-360:360);n.setExtent(r,i)}e.axis=n,n.model=e}var QOe={dimensions:kle,create:function(n,e){var t=[];return n.eachComponent("polar",function(r,i){var s=new ZOe(i+"");s.update=KOe;var o=s.getRadiusAxis(),l=s.getAngleAxis(),a=r.findAxisModel("radiusAxis"),h=r.findAxisModel("angleAxis");BY(o,a),BY(l,h),YOe(s,r,e),t.push(s),r.coordinateSystem=s,s.model=r}),n.eachSeries(function(r){if(r.get("coordinateSystem")==="polar"){var i=r.getReferringComponents("polar",bl).models[0];r.coordinateSystem=i.coordinateSystem}}),t}},eFe=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function SI(n,e,t){e[1]>e[0]&&(e=e.slice().reverse());var r=n.coordToPoint([e[0],t]),i=n.coordToPoint([e[1],t]);return{x1:r[0],y1:r[1],x2:i[0],y2:i[1]}}function AI(n){var e=n.getRadiusAxis();return e.inverse?0:1}function kY(n){var e=n[0],t=n[n.length-1];e&&t&&Math.abs(Math.abs(e.coord-t.coord)-360)<1e-4&&n.pop()}var tFe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var i=t.axis,s=i.polar,o=s.getRadiusAxis().getExtent(),l=i.getTicksCoords(),a=i.getMinorTicksCoords(),h=xr(i.getViewLabels(),function(f){f=yi(f);var p=i.scale,v=p.type==="ordinal"?p.getRawOrdinalNumber(f.tickValue):f.tickValue;return f.coord=i.dataToCoord(v),f});kY(h),kY(l),it(eFe,function(f){t.get([f,"show"])&&(!i.scale.isBlank()||f==="axisLine")&&nFe[f](this.group,t,s,l,a,o,h)},this)}},e.type="angleAxis",e}(wE),nFe={axisLine:function(n,e,t,r,i,s){var o=e.getModel(["axisLine","lineStyle"]),l=t.getAngleAxis(),a=Math.PI/180,h=l.getExtent(),f=AI(t),p=f?0:1,v,y=Math.abs(h[1]-h[0])===360?"Circle":"Arc";s[p]===0?v=new fG[y]({shape:{cx:t.cx,cy:t.cy,r:s[f],startAngle:-h[0]*a,endAngle:-h[1]*a,clockwise:l.inverse},style:o.getLineStyle(),z2:1,silent:!0}):v=new aG({shape:{cx:t.cx,cy:t.cy,r:s[f],r0:s[p]},style:o.getLineStyle(),z2:1,silent:!0}),v.style.fill=null,n.add(v)},axisTick:function(n,e,t,r,i,s){var o=e.getModel("axisTick"),l=(o.get("inside")?-1:1)*o.get("length"),a=s[AI(t)],h=xr(r,function(f){return new Hf({shape:SI(t,[a,a+l],f.coord)})});n.add(Im(h,{style:ti(o.getModel("lineStyle").getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])})}))},minorTick:function(n,e,t,r,i,s){if(i.length){for(var o=e.getModel("axisTick"),l=e.getModel("minorTick"),a=(o.get("inside")?-1:1)*l.get("length"),h=s[AI(t)],f=[],p=0;p<i.length;p++)for(var v=0;v<i[p].length;v++)f.push(new Hf({shape:SI(t,[h,h+a],i[p][v].coord)}));n.add(Im(f,{style:ti(l.getModel("lineStyle").getLineStyle(),ti(o.getLineStyle(),{stroke:e.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(n,e,t,r,i,s,o){var l=e.getCategories(!0),a=e.getModel("axisLabel"),h=a.get("margin"),f=e.get("triggerEvent");it(o,function(p,v){var y=a,S=p.tickValue,C=s[AI(t)],M=t.coordToPoint([C+h,p.coord]),E=t.cx,L=t.cy,k=Math.abs(M[0]-E)/C<.3?"center":M[0]>E?"left":"right",H=Math.abs(M[1]-L)/C<.3?"middle":M[1]>L?"top":"bottom";if(l&&l[S]){var X=l[S];$r(X)&&X.textStyle&&(y=new Ra(X.textStyle,a,a.ecModel))}var Z=new Io({silent:Lh.isLabelSilent(e),style:ng(y,{x:M[0],y:M[1],fill:y.getTextColor()||e.get(["axisLine","lineStyle","color"]),text:p.formattedLabel,align:k,verticalAlign:H})});if(n.add(Z),f){var Q=Lh.makeAxisEventDataBase(e);Q.targetType="axisLabel",Q.value=p.rawLabel,$i(Z).eventData=Q}},this)},splitLine:function(n,e,t,r,i,s){var o=e.getModel("splitLine"),l=o.getModel("lineStyle"),a=l.get("color"),h=0;a=a instanceof Array?a:[a];for(var f=[],p=0;p<r.length;p++){var v=h++%a.length;f[v]=f[v]||[],f[v].push(new Hf({shape:SI(t,s,r[p].coord)}))}for(var p=0;p<f.length;p++)n.add(Im(f[p],{style:ti({stroke:a[p%a.length]},l.getLineStyle()),silent:!0,z:e.get("z")}))},minorSplitLine:function(n,e,t,r,i,s){if(i.length){for(var o=e.getModel("minorSplitLine"),l=o.getModel("lineStyle"),a=[],h=0;h<i.length;h++)for(var f=0;f<i[h].length;f++)a.push(new Hf({shape:SI(t,s,i[h][f].coord)}));n.add(Im(a,{style:l.getLineStyle(),silent:!0,z:e.get("z")}))}},splitArea:function(n,e,t,r,i,s){if(r.length){var o=e.getModel("splitArea"),l=o.getModel("areaStyle"),a=l.get("color"),h=0;a=a instanceof Array?a:[a];for(var f=[],p=Math.PI/180,v=-r[0].coord*p,y=Math.min(s[0],s[1]),S=Math.max(s[0],s[1]),C=e.get("clockwise"),M=1,E=r.length;M<=E;M++){var L=M===E?r[0].coord:r[M].coord,k=h++%a.length;f[k]=f[k]||[],f[k].push(new Nh({shape:{cx:t.cx,cy:t.cy,r0:y,r:S,startAngle:v,endAngle:-L*p,clockwise:C},silent:!0})),v=-L*p}for(var M=0;M<f.length;M++)n.add(Im(f[M],{style:ti({fill:a[M%a.length]},l.getAreaStyle()),silent:!0}))}}},rFe=["axisLine","axisTickLabel","axisName"],iFe=["splitLine","splitArea","minorSplitLine"],sFe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.axisPointerClass="PolarAxisPointer",t}return e.prototype.render=function(t,r){if(this.group.removeAll(),!!t.get("show")){var i=this._axisGroup,s=this._axisGroup=new go;this.group.add(s);var o=t.axis,l=o.polar,a=l.getAngleAxis(),h=o.getTicksCoords(),f=o.getMinorTicksCoords(),p=a.getExtent()[0],v=o.getExtent(),y=oFe(l,t,p),S=new Lh(t,y);it(rFe,S.add,S),s.add(S.getGroup()),hG(i,s,t),it(iFe,function(C){t.get([C,"show"])&&!o.scale.isBlank()&&aFe[C](this.group,t,l,p,v,h,f)},this)}},e.type="radiusAxis",e}(wE),aFe={splitLine:function(n,e,t,r,i,s){var o=e.getModel("splitLine"),l=o.getModel("lineStyle"),a=l.get("color"),h=0,f=t.getAngleAxis(),p=Math.PI/180,v=f.getExtent(),y=Math.abs(v[1]-v[0])===360?"Circle":"Arc";a=a instanceof Array?a:[a];for(var S=[],C=0;C<s.length;C++){var M=h++%a.length;S[M]=S[M]||[],S[M].push(new fG[y]({shape:{cx:t.cx,cy:t.cy,r:Math.max(s[C].coord,0),startAngle:-v[0]*p,endAngle:-v[1]*p,clockwise:f.inverse}}))}for(var C=0;C<S.length;C++)n.add(Im(S[C],{style:ti({stroke:a[C%a.length],fill:null},l.getLineStyle()),silent:!0}))},minorSplitLine:function(n,e,t,r,i,s,o){if(o.length){for(var l=e.getModel("minorSplitLine"),a=l.getModel("lineStyle"),h=[],f=0;f<o.length;f++)for(var p=0;p<o[f].length;p++)h.push(new QD({shape:{cx:t.cx,cy:t.cy,r:o[f][p].coord}}));n.add(Im(h,{style:ti({fill:null},a.getLineStyle()),silent:!0}))}},splitArea:function(n,e,t,r,i,s){if(s.length){var o=e.getModel("splitArea"),l=o.getModel("areaStyle"),a=l.get("color"),h=0;a=a instanceof Array?a:[a];for(var f=[],p=s[0].coord,v=1;v<s.length;v++){var y=h++%a.length;f[y]=f[y]||[],f[y].push(new Nh({shape:{cx:t.cx,cy:t.cy,r0:p,r:s[v].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),p=s[v].coord}for(var v=0;v<f.length;v++)n.add(Im(f[v],{style:ti({fill:a[v%a.length]},l.getAreaStyle()),silent:!0}))}}};function oFe(n,e,t){return{position:[n.cx,n.cy],rotation:t/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:e.getModel("axisLabel").get("rotate"),z2:1}}function Ole(n){return n.get("stack")||"__ec_stack_"+n.seriesIndex}function Fle(n,e){return e.dim+n.model.componentIndex}function lFe(n,e,t){var r={},i=cFe(no(e.getSeriesByType(n),function(s){return!e.isSeriesFiltered(s)&&s.coordinateSystem&&s.coordinateSystem.type==="polar"}));e.eachSeriesByType(n,function(s){if(s.coordinateSystem.type==="polar"){var o=s.getData(),l=s.coordinateSystem,a=l.getBaseAxis(),h=Fle(l,a),f=Ole(s),p=i[h][f],v=p.offset,y=p.width,S=l.getOtherAxis(a),C=s.coordinateSystem.cx,M=s.coordinateSystem.cy,E=s.get("barMinHeight")||0,L=s.get("barMinAngle")||0;r[f]=r[f]||[];for(var k=o.mapDimension(S.dim),H=o.mapDimension(a.dim),X=ux(o,k),Z=a.dim!=="radius"||!s.get("roundCap",!0),Q=S.model,re=Q.get("startValue"),ie=S.dataToCoord(re||0),oe=0,fe=o.count();oe<fe;oe++){var Se=o.get(k,oe),Ee=o.get(H,oe),Ie=Se>=0?"p":"n",He=ie;X&&(r[f][Ee]||(r[f][Ee]={p:ie,n:ie}),He=r[f][Ee][Ie]);var Re=void 0,st=void 0,_e=void 0,We=void 0;if(S.dim==="radius"){var Ue=S.dataToCoord(Se)-ie,vt=a.dataToCoord(Ee);Math.abs(Ue)<E&&(Ue=(Ue<0?-1:1)*E),Re=He,st=He+Ue,_e=vt-v,We=_e-y,X&&(r[f][Ee][Ie]=st)}else{var xt=S.dataToCoord(Se,Z)-ie,Vt=a.dataToCoord(Ee);Math.abs(xt)<L&&(xt=(xt<0?-1:1)*L),Re=Vt+v,st=Re+y,_e=He,We=He+xt,X&&(r[f][Ee][Ie]=We)}o.setItemLayout(oe,{cx:C,cy:M,r0:Re,r:st,startAngle:-_e*Math.PI/180,endAngle:-We*Math.PI/180,clockwise:_e>=We})}}})}function cFe(n){var e={};it(n,function(r,i){var s=r.getData(),o=r.coordinateSystem,l=o.getBaseAxis(),a=Fle(o,l),h=l.getExtent(),f=l.type==="category"?l.getBandWidth():Math.abs(h[1]-h[0])/s.count(),p=e[a]||{bandWidth:f,remainedWidth:f,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},v=p.stacks;e[a]=p;var y=Ole(r);v[y]||p.autoWidthCount++,v[y]=v[y]||{width:0,maxWidth:0};var S=ls(r.get("barWidth"),f),C=ls(r.get("barMaxWidth"),f),M=r.get("barGap"),E=r.get("barCategoryGap");S&&!v[y].width&&(S=Math.min(p.remainedWidth,S),v[y].width=S,p.remainedWidth-=S),C&&(v[y].maxWidth=C),M!=null&&(p.gap=M),E!=null&&(p.categoryGap=E)});var t={};return it(e,function(r,i){t[i]={};var s=r.stacks,o=r.bandWidth,l=ls(r.categoryGap,o),a=ls(r.gap,1),h=r.remainedWidth,f=r.autoWidthCount,p=(h-l)/(f+(f-1)*a);p=Math.max(p,0),it(s,function(C,M){var E=C.maxWidth;E&&E<p&&(E=Math.min(E,h),C.width&&(E=Math.min(E,C.width)),h-=E,C.width=E,f--)}),p=(h-l)/(f+(f-1)*a),p=Math.max(p,0);var v=0,y;it(s,function(C,M){C.width||(C.width=p),y=C,v+=C.width*(1+a)}),y&&(v-=y.width*a);var S=-v/2;it(s,function(C,M){t[i][M]=t[i][M]||{offset:S,width:C.width},S+=C.width*(1+a)})}),t}var uFe={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},hFe={splitNumber:5},fFe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="polar",e}(Dc);function dFe(n){_p(KG),wE.registerAxisPointerClass("PolarAxisPointer",GOe),n.registerCoordinateSystem("polar",QOe),n.registerComponentModel(jOe),n.registerComponentView(fFe),cL(n,"angle",WOe,uFe),cL(n,"radius",$Oe,hFe),n.registerComponentView(tFe),n.registerComponentView(sFe),n.registerLayout(_s(lFe,"bar"))}var OY=["x","y","radius","angle","single"],pFe=["cartesian2d","polar","singleAxis"];function mFe(n){var e=n.get("coordinateSystem");return Xi(pFe,e)>=0}function Ib(n){return n+"Axis"}function gFe(n,e){var t=ii(),r=[],i=ii();n.eachComponent({mainType:"dataZoom",query:e},function(f){i.get(f.uid)||l(f)});var s;do s=!1,n.eachComponent("dataZoom",o);while(s);function o(f){!i.get(f.uid)&&a(f)&&(l(f),s=!0)}function l(f){i.set(f.uid,!0),r.push(f),h(f)}function a(f){var p=!1;return f.eachTargetAxis(function(v,y){var S=t.get(v);S&&S[y]&&(p=!0)}),p}function h(f){f.eachTargetAxis(function(p,v){(t.get(p)||t.set(p,[]))[v]=!0})}return r}var q3=function(){function n(){this.indexList=[],this.indexMap=[]}return n.prototype.add=function(e){this.indexMap[e]||(this.indexList.push(e),this.indexMap[e]=!0)},n}(),vFe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t._autoThrottle=!0,t._noTarget=!0,t._rangePropMode=["percent","percent"],t}return e.prototype.init=function(t,r,i){var s=FY(t);this.settledOption=s,this.mergeDefaultAndTheme(t,i),this._doInit(s)},e.prototype.mergeOption=function(t){var r=FY(t);Bi(this.option,t,!0),Bi(this.settledOption,r,!0),this._doInit(r)},e.prototype._doInit=function(t){var r=this.option;this._setDefaultThrottle(t),this._updateRangeUse(t);var i=this.settledOption;it([["start","startValue"],["end","endValue"]],function(s,o){this._rangePropMode[o]==="value"&&(r[s[0]]=i[s[0]]=null)},this),this._resetTarget()},e.prototype._resetTarget=function(){var t=this.get("orient",!0),r=this._targetAxisInfoMap=ii(),i=this._fillSpecifiedTargetAxis(r);i?this._orient=t||this._makeAutoOrientByTargetAxis():(this._orient=t||"horizontal",this._fillAutoTargetAxisByOrient(r,this._orient)),this._noTarget=!0,r.each(function(s){s.indexList.length&&(this._noTarget=!1)},this)},e.prototype._fillSpecifiedTargetAxis=function(t){var r=!1;return it(OY,function(i){var s=this.getReferringComponents(Ib(i),TCe);if(s.specified){r=!0;var o=new q3;it(s.models,function(l){o.add(l.componentIndex)}),t.set(i,o)}},this),r},e.prototype._fillAutoTargetAxisByOrient=function(t,r){var i=this.ecModel,s=!0;if(s){var o=r==="vertical"?"y":"x",l=i.findComponents({mainType:o+"Axis"});a(l,o)}if(s){var l=i.findComponents({mainType:"singleAxis",filter:function(f){return f.get("orient",!0)===r}});a(l,"single")}function a(h,f){var p=h[0];if(p){var v=new q3;if(v.add(p.componentIndex),t.set(f,v),s=!1,f==="x"||f==="y"){var y=p.getReferringComponents("grid",bl).models[0];y&&it(h,function(S){p.componentIndex!==S.componentIndex&&y===S.getReferringComponents("grid",bl).models[0]&&v.add(S.componentIndex)})}}}s&&it(OY,function(h){if(s){var f=i.findComponents({mainType:Ib(h),filter:function(v){return v.get("type",!0)==="category"}});if(f[0]){var p=new q3;p.add(f[0].componentIndex),t.set(h,p),s=!1}}},this)},e.prototype._makeAutoOrientByTargetAxis=function(){var t;return this.eachTargetAxis(function(r){!t&&(t=r)},this),t==="y"?"vertical":"horizontal"},e.prototype._setDefaultThrottle=function(t){if(t.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var r=this.ecModel.option;this.option.throttle=r.animation&&r.animationDurationUpdate>0?100:20}},e.prototype._updateRangeUse=function(t){var r=this._rangePropMode,i=this.get("rangeMode");it([["start","startValue"],["end","endValue"]],function(s,o){var l=t[s[0]]!=null,a=t[s[1]]!=null;l&&!a?r[o]="percent":!l&&a?r[o]="value":i?r[o]=i[o]:l&&(r[o]="percent")})},e.prototype.noTarget=function(){return this._noTarget},e.prototype.getFirstTargetAxisModel=function(){var t;return this.eachTargetAxis(function(r,i){t==null&&(t=this.ecModel.getComponent(Ib(r),i))},this),t},e.prototype.eachTargetAxis=function(t,r){this._targetAxisInfoMap.each(function(i,s){it(i.indexList,function(o){t.call(r,s,o)})})},e.prototype.getAxisProxy=function(t,r){var i=this.getAxisModel(t,r);if(i)return i.__dzAxisProxy},e.prototype.getAxisModel=function(t,r){var i=this._targetAxisInfoMap.get(t);if(i&&i.indexMap[r])return this.ecModel.getComponent(Ib(t),r)},e.prototype.setRawRange=function(t){var r=this.option,i=this.settledOption;it([["start","startValue"],["end","endValue"]],function(s){(t[s[0]]!=null||t[s[1]]!=null)&&(r[s[0]]=i[s[0]]=t[s[0]],r[s[1]]=i[s[1]]=t[s[1]])},this),this._updateRangeUse(t)},e.prototype.setCalculatedRange=function(t){var r=this.option;it(["start","startValue","end","endValue"],function(i){r[i]=t[i]})},e.prototype.getPercentRange=function(){var t=this.findRepresentativeAxisProxy();if(t)return t.getDataPercentWindow()},e.prototype.getValueRange=function(t,r){if(t==null&&r==null){var i=this.findRepresentativeAxisProxy();if(i)return i.getDataValueWindow()}else return this.getAxisProxy(t,r).getDataValueWindow()},e.prototype.findRepresentativeAxisProxy=function(t){if(t)return t.__dzAxisProxy;for(var r,i=this._targetAxisInfoMap.keys(),s=0;s<i.length;s++)for(var o=i[s],l=this._targetAxisInfoMap.get(o),a=0;a<l.indexList.length;a++){var h=this.getAxisProxy(o,l.indexList[a]);if(h.hostedBy(this))return h;r||(r=h)}return r},e.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},e.prototype.getOrient=function(){return this._orient},e.type="dataZoom",e.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],e.defaultOption={z:4,filterMode:"filter",start:0,end:100},e}(as);function FY(n){var e={};return it(["start","end","startValue","endValue","throttle"],function(t){n.hasOwnProperty(t)&&(e[t]=n[t])}),e}var _Fe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(vFe),yFe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i,s){this.dataZoomModel=t,this.ecModel=r,this.api=i},e.type="dataZoom",e}(Dc),xFe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="dataZoom.select",e}(yFe),sb=it,NY=aCe,bFe=function(){function n(e,t,r,i){this._dimName=e,this._axisIndex=t,this.ecModel=i,this._dataZoomModel=r}return n.prototype.hostedBy=function(e){return this._dataZoomModel===e},n.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},n.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},n.prototype.getTargetSeriesModels=function(){var e=[];return this.ecModel.eachSeries(function(t){if(mFe(t)){var r=Ib(this._dimName),i=t.getReferringComponents(r,bl).models[0];i&&this._axisIndex===i.componentIndex&&e.push(t)}},this),e},n.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},n.prototype.getMinMaxSpan=function(){return yi(this._minMaxSpan)},n.prototype.calculateDataWindow=function(e){var t=this._dataExtent,r=this.getAxisModel(),i=r.axis.scale,s=this._dataZoomModel.getRangePropMode(),o=[0,100],l=[],a=[],h;sb(["start","end"],function(v,y){var S=e[v],C=e[v+"Value"];s[y]==="percent"?(S==null&&(S=o[y]),C=i.parse(Uv(S,o,t))):(h=!0,C=C==null?t[y]:i.parse(C),S=Uv(C,t,o)),a[y]=C==null||isNaN(C)?t[y]:C,l[y]=S==null||isNaN(S)?o[y]:S}),NY(a),NY(l);var f=this._minMaxSpan;h?p(a,l,t,o,!1):p(l,a,o,t,!0);function p(v,y,S,C,M){var E=M?"Span":"ValueSpan";ple(0,v,S,"all",f["min"+E],f["max"+E]);for(var L=0;L<2;L++)y[L]=Uv(v[L],S,C,!0),M&&(y[L]=i.parse(y[L]))}return{valueWindow:a,percentWindow:l}},n.prototype.reset=function(e){if(e===this._dataZoomModel){var t=this.getTargetSeriesModels();this._dataExtent=wFe(this,this._dimName,t),this._updateMinMaxSpan();var r=this.calculateDataWindow(e.settledOption);this._valueWindow=r.valueWindow,this._percentWindow=r.percentWindow,this._setAxisModel()}},n.prototype.filterData=function(e,t){if(e!==this._dataZoomModel)return;var r=this._dimName,i=this.getTargetSeriesModels(),s=e.get("filterMode"),o=this._valueWindow;if(s==="none")return;sb(i,function(a){var h=a.getData(),f=h.mapDimensionsAll(r);if(f.length){if(s==="weakFilter"){var p=h.getStore(),v=xr(f,function(y){return h.getDimensionIndex(y)},h);h.filterSelf(function(y){for(var S,C,M,E=0;E<f.length;E++){var L=p.get(v[E],y),k=!isNaN(L),H=L<o[0],X=L>o[1];if(k&&!H&&!X)return!0;k&&(M=!0),H&&(S=!0),X&&(C=!0)}return M&&S&&C})}else sb(f,function(y){if(s==="empty")a.setData(h=h.map(y,function(C){return l(C)?C:NaN}));else{var S={};S[y]=o,h.selectRange(S)}});sb(f,function(y){h.setApproximateExtent(o,y)})}});function l(a){return a>=o[0]&&a<=o[1]}},n.prototype._updateMinMaxSpan=function(){var e=this._minMaxSpan={},t=this._dataZoomModel,r=this._dataExtent;sb(["min","max"],function(i){var s=t.get(i+"Span"),o=t.get(i+"ValueSpan");o!=null&&(o=this.getAxisModel().axis.scale.parse(o)),o!=null?s=Uv(r[0]+o,r,[0,100],!0):s!=null&&(o=Uv(s,[0,100],r,!0)-r[0]),e[i+"Span"]=s,e[i+"ValueSpan"]=o},this)},n.prototype._setAxisModel=function(){var e=this.getAxisModel(),t=this._percentWindow,r=this._valueWindow;if(t){var i=Gie(r,[0,500]);i=Math.min(i,20);var s=e.axis.scale.rawExtentInfo;t[0]!==0&&s.setDeterminedMinMax("min",+r[0].toFixed(i)),t[1]!==100&&s.setDeterminedMinMax("max",+r[1].toFixed(i)),s.freeze()}},n}();function wFe(n,e,t){var r=[1/0,-1/0];sb(t,function(o){KDe(r,o.getData(),e)});var i=n.getAxisModel(),s=Ioe(i.axis.scale,i,r).calculate();return[s.min,s.max]}var SFe={getTargetSeries:function(n){function e(i){n.eachComponent("dataZoom",function(s){s.eachTargetAxis(function(o,l){var a=n.getComponent(Ib(o),l);i(o,l,a,s)})})}e(function(i,s,o,l){o.__dzAxisProxy=null});var t=[];e(function(i,s,o,l){o.__dzAxisProxy||(o.__dzAxisProxy=new bFe(i,s,l,n),t.push(o.__dzAxisProxy))});var r=ii();return it(t,function(i){it(i.getTargetSeriesModels(),function(s){r.set(s.uid,s)})}),r},overallReset:function(n,e){n.eachComponent("dataZoom",function(t){t.eachTargetAxis(function(r,i){t.getAxisProxy(r,i).reset(t)}),t.eachTargetAxis(function(r,i){t.getAxisProxy(r,i).filterData(t,e)})}),n.eachComponent("dataZoom",function(t){var r=t.findRepresentativeAxisProxy();if(r){var i=r.getDataPercentWindow(),s=r.getDataValueWindow();t.setCalculatedRange({start:i[0],end:i[1],startValue:s[0],endValue:s[1]})}})}};function AFe(n){n.registerAction("dataZoom",function(e,t){var r=gFe(t,e);it(r,function(i){i.setRawRange({start:e.start,end:e.end,startValue:e.startValue,endValue:e.endValue})})})}var zY=!1;function TFe(n){zY||(zY=!0,n.registerProcessor(n.PRIORITY.PROCESSOR.FILTER,SFe),AFe(n),n.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function MFe(n){n.registerComponentModel(_Fe),n.registerComponentView(xFe),TFe(n)}var Gf=function(){function n(){}return n}(),Nle={};function dA(n,e){Nle[n]=e}function zle(n){return Nle[n]}var EFe=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.optionUpdated=function(){n.prototype.optionUpdated.apply(this,arguments);var t=this.ecModel;it(this.option.feature,function(r,i){var s=zle(i);s&&(s.getDefaultOption&&(s.defaultOption=s.getDefaultOption(t)),Bi(r,s.defaultOption))})},e.type="toolbox",e.layoutMode={type:"box",ignoreSize:!0},e.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},e}(as);function CFe(n,e,t){var r=e.getBoxLayoutParams(),i=e.get("padding"),s={width:t.getWidth(),height:t.getHeight()},o=b0(r,s,i);$b(e.get("orient"),n,e.get("itemGap"),o.width,o.height),aRe(n,r,s,i)}function Ule(n,e){var t=dB(e.get("padding")),r=e.getItemStyle(["color","opacity"]);return r.fill=e.get("backgroundColor"),n=new Ha({shape:{x:n.x-t[3],y:n.y-t[0],width:n.width+t[1]+t[3],height:n.height+t[0]+t[2],r:e.get("borderRadius")},style:r,silent:!0,z2:-1}),n}var IFe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,i,s){var o=this.group;if(o.removeAll(),!t.get("show"))return;var l=+t.get("itemSize"),a=t.get("orient")==="vertical",h=t.get("feature")||{},f=this._features||(this._features={}),p=[];it(h,function(S,C){p.push(C)}),new TM(this._featureNames||[],p).add(v).update(v).remove(_s(v,null)).execute(),this._featureNames=p;function v(S,C){var M=p[S],E=p[C],L=h[M],k=new Ra(L,t,t.ecModel),H;if(s&&s.newTitle!=null&&s.featureName===M&&(L.title=s.newTitle),M&&!E){if(RFe(M))H={onclick:k.option.onclick,featureName:M};else{var X=zle(M);if(!X)return;H=new X}f[M]=H}else if(H=f[E],!H)return;H.uid=bE("toolbox-feature"),H.model=k,H.ecModel=r,H.api=i;var Z=H instanceof Gf;if(!M&&E){Z&&H.dispose&&H.dispose(r,i);return}if(!k.get("show")||Z&&H.unusable){Z&&H.remove&&H.remove(r,i);return}y(k,H,M),k.setIconStatus=function(Q,re){var ie=this.option,oe=this.iconPaths;ie.iconStatus=ie.iconStatus||{},ie.iconStatus[Q]=re,oe[Q]&&(re==="emphasis"?cw:uw)(oe[Q])},H instanceof Gf&&H.render&&H.render(k,r,i,s)}function y(S,C,M){var E=S.getModel("iconStyle"),L=S.getModel(["emphasis","iconStyle"]),k=C instanceof Gf&&C.getIcons?C.getIcons():S.get("icon"),H=S.get("title")||{},X,Z;Dr(k)?(X={},X[M]=k):X=k,Dr(H)?(Z={},Z[M]=H):Z=H;var Q=S.iconPaths={};it(X,function(re,ie){var oe=iB(re,{},{x:-l/2,y:-l/2,width:l,height:l});oe.setStyle(E.getItemStyle());var fe=oe.ensureState("emphasis");fe.style=L.getItemStyle();var Se=new Io({style:{text:Z[ie],align:L.get("textAlign"),borderRadius:L.get("textBorderRadius"),padding:L.get("textPadding"),fill:null,font:Hse({fontStyle:L.get("textFontStyle"),fontFamily:L.get("textFontFamily"),fontSize:L.get("textFontSize"),fontWeight:L.get("textFontWeight")},r)},ignore:!0});oe.setTextContent(Se),sB({el:oe,componentModel:t,itemName:ie,formatterParamsExtra:{title:Z[ie]}}),oe.__title=Z[ie],oe.on("mouseover",function(){var Ee=L.getItemStyle(),Ie=a?t.get("right")==null&&t.get("left")!=="right"?"right":"left":t.get("bottom")==null&&t.get("top")!=="bottom"?"bottom":"top";Se.setStyle({fill:L.get("textFill")||Ee.fill||Ee.stroke||"#000",backgroundColor:L.get("textBackgroundColor")}),oe.setTextConfig({position:L.get("textPosition")||Ie}),Se.ignore=!t.get("showTitle"),i.enterEmphasis(this)}).on("mouseout",function(){S.get(["iconStatus",ie])!=="emphasis"&&i.leaveEmphasis(this),Se.hide()}),(S.get(["iconStatus",ie])==="emphasis"?cw:uw)(oe),o.add(oe),oe.on("click",Us(C.onclick,C,r,i,ie)),Q[ie]=oe})}CFe(o,t,i),o.add(Ule(o.getBoundingRect(),t)),a||o.eachChild(function(S){var C=S.__title,M=S.ensureState("emphasis"),E=M.textConfig||(M.textConfig={}),L=S.getTextContent(),k=L&&L.ensureState("emphasis");if(k&&!ci(k)&&C){var H=k.style||(k.style={}),X=gE(C,Io.makeFont(H)),Z=S.x+o.x,Q=S.y+o.y+l,re=!1;Q+X.height>i.getHeight()&&(E.position="top",re=!0);var ie=re?-5-X.height:l+10;Z+X.width/2>i.getWidth()?(E.position=["100%",ie],H.align="right"):Z-X.width/2<0&&(E.position=[0,ie],H.align="left")}})},e.prototype.updateView=function(t,r,i,s){it(this._features,function(o){o instanceof Gf&&o.updateView&&o.updateView(o.model,r,i,s)})},e.prototype.remove=function(t,r){it(this._features,function(i){i instanceof Gf&&i.remove&&i.remove(t,r)}),this.group.removeAll()},e.prototype.dispose=function(t,r){it(this._features,function(i){i instanceof Gf&&i.dispose&&i.dispose(t,r)})},e.type="toolbox",e}(Dc);function RFe(n){return n.indexOf("my")===0}var PFe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){var i=this.model,s=i.get("name")||t.get("title.0.text")||"echarts",o=r.getZr().painter.getType()==="svg",l=o?"svg":i.get("type",!0)||"png",a=r.getConnectedDataURL({type:l,backgroundColor:i.get("backgroundColor",!0)||t.get("backgroundColor")||"#fff",connectedBackgroundColor:i.get("connectedBackgroundColor"),excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")}),h=gi.browser;if(typeof MouseEvent=="function"&&(h.newEdge||!h.ie&&!h.edge)){var f=document.createElement("a");f.download=s+"."+l,f.target="_blank",f.href=a;var p=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});f.dispatchEvent(p)}else if(window.navigator.msSaveOrOpenBlob||o){var v=a.split(","),y=v[0].indexOf("base64")>-1,S=o?decodeURIComponent(v[1]):v[1];y&&(S=window.atob(S));var C=s+"."+l;if(window.navigator.msSaveOrOpenBlob){for(var M=S.length,E=new Uint8Array(M);M--;)E[M]=S.charCodeAt(M);var L=new Blob([E]);window.navigator.msSaveOrOpenBlob(L,C)}else{var k=document.createElement("iframe");document.body.appendChild(k);var H=k.contentWindow,X=H.document;X.open("image/svg+xml","replace"),X.write(S),X.close(),H.focus(),X.execCommand("SaveAs",!0,C),document.body.removeChild(k)}}else{var Z=i.get("lang"),Q='<body style="margin:0;"><img src="'+a+'" style="max-width:100%;" title="'+(Z&&Z[0]||"")+'" /></body>',re=window.open();re.document.write(Q),re.document.title=s}},e.getDefaultOption=function(t){var r={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:t.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:t.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return r},e}(Gf),UY="__ec_magicType_stack__",LFe=[["line","bar"],["stack"]],DFe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.getIcons=function(){var t=this.model,r=t.get("icon"),i={};return it(t.get("type"),function(s){r[s]&&(i[s]=r[s])}),i},e.getDefaultOption=function(t){var r={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:t.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return r},e.prototype.onclick=function(t,r,i){var s=this.model,o=s.get(["seriesIndex",i]);if(GY[i]){var l={series:[]},a=function(p){var v=p.subType,y=p.id,S=GY[i](v,y,p,s);S&&(ti(S,p.option),l.series.push(S));var C=p.coordinateSystem;if(C&&C.type==="cartesian2d"&&(i==="line"||i==="bar")){var M=C.getAxesByScale("ordinal")[0];if(M){var E=M.dim,L=E+"Axis",k=p.getReferringComponents(L,bl).models[0],H=k.componentIndex;l[L]=l[L]||[];for(var X=0;X<=H;X++)l[L][H]=l[L][H]||{};l[L][H].boundaryGap=i==="bar"}}};it(LFe,function(p){Xi(p,i)>=0&&it(p,function(v){s.setIconStatus(v,"normal")})}),s.setIconStatus(i,"emphasis"),t.eachComponent({mainType:"series",query:o==null?null:{seriesIndex:o}},a);var h,f=i;i==="stack"&&(h=Bi({stack:s.option.title.tiled,tiled:s.option.title.stack},s.option.title),s.get(["iconStatus",i])!=="emphasis"&&(f="tiled")),r.dispatchAction({type:"changeMagicType",currentType:f,newOption:l,newTitle:h,featureName:"magicType"})}},e}(Gf),GY={line:function(n,e,t,r){if(n==="bar")return Bi({id:e,type:"line",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","line"])||{},!0)},bar:function(n,e,t,r){if(n==="line")return Bi({id:e,type:"bar",data:t.get("data"),stack:t.get("stack"),markPoint:t.get("markPoint"),markLine:t.get("markLine")},r.get(["option","bar"])||{},!0)},stack:function(n,e,t,r){var i=t.get("stack")===UY;if(n==="line"||n==="bar")return r.setIconStatus("stack",i?"normal":"emphasis"),Bi({id:e,stack:i?"":UY},r.get(["option","stack"])||{},!0)}};Sp({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(n,e){e.mergeOption(n.newOption)});var wB=new Array(60).join("-"),mw="	";function BFe(n){var e={},t=[],r=[];return n.eachRawSeries(function(i){var s=i.coordinateSystem;if(s&&(s.type==="cartesian2d"||s.type==="polar")){var o=s.getBaseAxis();if(o.type==="category"){var l=o.dim+"_"+o.index;e[l]||(e[l]={categoryAxis:o,valueAxis:s.getOtherAxis(o),series:[]},r.push({axisDim:o.dim,axisIndex:o.index})),e[l].series.push(i)}else t.push(i)}else t.push(i)}),{seriesGroupByCategoryAxis:e,other:t,meta:r}}function kFe(n){var e=[];return it(n,function(t,r){var i=t.categoryAxis,s=t.valueAxis,o=s.dim,l=[" "].concat(xr(t.series,function(y){return y.name})),a=[i.model.getCategories()];it(t.series,function(y){var S=y.getRawData();a.push(y.getRawData().mapArray(S.mapDimension(o),function(C){return C}))});for(var h=[l.join(mw)],f=0;f<a[0].length;f++){for(var p=[],v=0;v<a.length;v++)p.push(a[v][f]);h.push(p.join(mw))}e.push(h.join(`
`))}),e.join(`

`+wB+`

`)}function OFe(n){return xr(n,function(e){var t=e.getRawData(),r=[e.name],i=[];return t.each(t.dimensions,function(){for(var s=arguments.length,o=arguments[s-1],l=t.getName(o),a=0;a<s-1;a++)i[a]=arguments[a];r.push((l?l+mw:"")+i.join(mw))}),r.join(`
`)}).join(`

`+wB+`

`)}function FFe(n){var e=BFe(n);return{value:no([kFe(e.seriesGroupByCategoryAxis),OFe(e.other)],function(t){return!!t.replace(/[\n\t\s]/g,"")}).join(`

`+wB+`

`),meta:e.meta}}function uL(n){return n.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function NFe(n){var e=n.slice(0,n.indexOf(`
`));if(e.indexOf(mw)>=0)return!0}var p5=new RegExp("["+mw+"]+","g");function zFe(n){for(var e=n.split(/\n+/g),t=uL(e.shift()).split(p5),r=[],i=xr(t,function(a){return{name:a,data:[]}}),s=0;s<e.length;s++){var o=uL(e[s]).split(p5);r.push(o.shift());for(var l=0;l<o.length;l++)i[l]&&(i[l].data[s]=o[l])}return{series:i,categories:r}}function UFe(n){for(var e=n.split(/\n+/g),t=uL(e.shift()),r=[],i=0;i<e.length;i++){var s=uL(e[i]);if(s){var o=s.split(p5),l="",a=void 0,h=!1;isNaN(o[0])?(h=!0,l=o[0],o=o.slice(1),r[i]={name:l,value:[]},a=r[i].value):a=r[i]=[];for(var f=0;f<o.length;f++)a.push(+o[f]);a.length===1&&(h?r[i].value=a[0]:r[i]=a[0])}}return{name:t,data:r}}function GFe(n,e){var t=n.split(new RegExp(`
*`+wB+`
*`,"g")),r={series:[]};return it(t,function(i,s){if(NFe(i)){var o=zFe(i),l=e[s],a=l.axisDim+"Axis";l&&(r[a]=r[a]||[],r[a][l.axisIndex]={data:o.categories},r.series=r.series.concat(o.series))}else{var o=UFe(i);r.series.push(o)}}),r}var VFe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){setTimeout(function(){r.dispatchAction({type:"hideTip"})});var i=r.getDom(),s=this.model;this._dom&&i.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",o.style.backgroundColor=s.get("backgroundColor")||"#fff";var l=document.createElement("h4"),a=s.get("lang")||[];l.innerHTML=a[0]||s.get("title"),l.style.cssText="margin:10px 20px",l.style.color=s.get("textColor");var h=document.createElement("div"),f=document.createElement("textarea");h.style.cssText="overflow:auto";var p=s.get("optionToContent"),v=s.get("contentToOption"),y=FFe(t);if(ci(p)){var S=p(r.getOption());Dr(S)?h.innerHTML=S:lw(S)&&h.appendChild(S)}else{f.readOnly=s.get("readOnly");var C=f.style;C.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",C.color=s.get("textColor"),C.borderColor=s.get("textareaBorderColor"),C.backgroundColor=s.get("textareaColor"),f.value=y.value,h.appendChild(f)}var M=y.meta,E=document.createElement("div");E.style.cssText="position:absolute;bottom:5px;left:0;right:0";var L="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",k=document.createElement("div"),H=document.createElement("div");L+=";background-color:"+s.get("buttonColor"),L+=";color:"+s.get("buttonTextColor");var X=this;function Z(){i.removeChild(o),X._dom=null}pz(k,"click",Z),pz(H,"click",function(){if(v==null&&p!=null||v!=null&&p==null){Z();return}var Q;try{ci(v)?Q=v(h,r.getOption()):Q=GFe(f.value,M)}catch(re){throw Z(),new Error("Data view format error "+re)}Q&&r.dispatchAction({type:"changeDataView",newOption:Q}),Z()}),k.innerHTML=a[1],H.innerHTML=a[2],H.style.cssText=k.style.cssText=L,!s.get("readOnly")&&E.appendChild(H),E.appendChild(k),o.appendChild(l),o.appendChild(h),o.appendChild(E),h.style.height=i.clientHeight-80+"px",i.appendChild(o),this._dom=o},e.prototype.remove=function(t,r){this._dom&&r.getDom().removeChild(this._dom)},e.prototype.dispose=function(t,r){this.remove(t,r)},e.getDefaultOption=function(t){var r={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:t.getLocaleModel().get(["toolbox","dataView","title"]),lang:t.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return r},e}(Gf);function HFe(n,e){return xr(n,function(t,r){var i=e&&e[r];if($r(i)&&!fr(i)){var s=$r(t)&&!fr(t);s||(t={value:t});var o=i.name!=null&&t.name==null;return t=ti(t,i),o&&delete t.name,t}else return t})}Sp({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(n,e){var t=[];it(n.newOption.series,function(r){var i=e.getSeriesByName(r.name)[0];if(!i)t.push(Jn({type:"scatter"},r));else{var s=i.get("data");t.push({name:r.name,data:HFe(r.data,s)})}}),e.mergeOption(ti({series:t},n.newOption))});var Gle=it,Vle=qs();function jFe(n,e){var t=t8(n);Gle(e,function(r,i){for(var s=t.length-1;s>=0;s--){var o=t[s];if(o[i])break}if(s<0){var l=n.queryComponents({mainType:"dataZoom",subType:"select",id:i})[0];if(l){var a=l.getPercentRange();t[0][i]={dataZoomId:i,start:a[0],end:a[1]}}}}),t.push(e)}function WFe(n){var e=t8(n),t=e[e.length-1];e.length>1&&e.pop();var r={};return Gle(t,function(i,s){for(var o=e.length-1;o>=0;o--)if(i=e[o][s],i){r[s]=i;break}}),r}function $Fe(n){Vle(n).snapshots=null}function XFe(n){return t8(n).length}function t8(n){var e=Vle(n);return e.snapshots||(e.snapshots=[{}]),e.snapshots}var qFe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.onclick=function(t,r){$Fe(t),r.dispatchAction({type:"restore",from:this.uid})},e.getDefaultOption=function(t){var r={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:t.getLocaleModel().get(["toolbox","restore","title"])};return r},e}(Gf);Sp({type:"restore",event:"restore",update:"prepareAndUpdate"},function(n,e){e.resetOption("recreate")});var ZFe=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],Hle=function(){function n(e,t,r){var i=this;this._targetInfoList=[];var s=VY(t,e);it(YFe,function(o,l){(!r||!r.include||Xi(r.include,l)>=0)&&o(s,i._targetInfoList)})}return n.prototype.setOutputRanges=function(e,t){return this.matchOutputRanges(e,t,function(r,i,s){if((r.coordRanges||(r.coordRanges=[])).push(i),!r.coordRange){r.coordRange=i;var o=Z3[r.brushType](0,s,i);r.__rangeOffset={offset:$Y[r.brushType](o.values,r.range,[1,1]),xyMinMax:o.xyMinMax}}}),e},n.prototype.matchOutputRanges=function(e,t,r){it(e,function(i){var s=this.findTargetInfo(i,t);s&&s!==!0&&it(s.coordSyses,function(o){var l=Z3[i.brushType](1,o,i.range,!0);r(i,l.values,o,t)})},this)},n.prototype.setInputRanges=function(e,t){it(e,function(r){var i=this.findTargetInfo(r,t);if(r.range=r.range||[],i&&i!==!0){r.panelId=i.panelId;var s=Z3[r.brushType](0,i.coordSys,r.coordRange),o=r.__rangeOffset;r.range=o?$Y[r.brushType](s.values,o.offset,KFe(s.xyMinMax,o.xyMinMax)):s.values}},this)},n.prototype.makePanelOpts=function(e,t){return xr(this._targetInfoList,function(r){var i=r.getPanelRect();return{panelId:r.panelId,defaultBrushType:t?t(r):null,clipPath:vOe(i),isTargetByCursor:yOe(i,e,r.coordSysModel),getLinearBrushOtherExtent:_Oe(i)}})},n.prototype.controlSeries=function(e,t,r){var i=this.findTargetInfo(e,r);return i===!0||i&&Xi(i.coordSyses,t.coordinateSystem)>=0},n.prototype.findTargetInfo=function(e,t){for(var r=this._targetInfoList,i=VY(t,e),s=0;s<r.length;s++){var o=r[s],l=e.panelId;if(l){if(o.panelId===l)return o}else for(var a=0;a<HY.length;a++)if(HY[a](i,o))return o}return!0},n}();function m5(n){return n[0]>n[1]&&n.reverse(),n}function VY(n,e){return mT(n,e,{includeMainTypes:ZFe})}var YFe={grid:function(n,e){var t=n.xAxisModels,r=n.yAxisModels,i=n.gridModels,s=ii(),o={},l={};!t&&!r&&!i||(it(t,function(a){var h=a.axis.grid.model;s.set(h.id,h),o[h.id]=!0}),it(r,function(a){var h=a.axis.grid.model;s.set(h.id,h),l[h.id]=!0}),it(i,function(a){s.set(a.id,a),o[a.id]=!0,l[a.id]=!0}),s.each(function(a){var h=a.coordinateSystem,f=[];it(h.getCartesians(),function(p,v){(Xi(t,p.getAxis("x").model)>=0||Xi(r,p.getAxis("y").model)>=0)&&f.push(p)}),e.push({panelId:"grid--"+a.id,gridModel:a,coordSysModel:a,coordSys:f[0],coordSyses:f,getPanelRect:jY.grid,xAxisDeclared:o[a.id],yAxisDeclared:l[a.id]})}))},geo:function(n,e){it(n.geoModels,function(t){var r=t.coordinateSystem;e.push({panelId:"geo--"+t.id,geoModel:t,coordSysModel:t,coordSys:r,coordSyses:[r],getPanelRect:jY.geo})})}},HY=[function(n,e){var t=n.xAxisModel,r=n.yAxisModel,i=n.gridModel;return!i&&t&&(i=t.axis.grid.model),!i&&r&&(i=r.axis.grid.model),i&&i===e.gridModel},function(n,e){var t=n.geoModel;return t&&t===e.geoModel}],jY={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var n=this.coordSys,e=n.getBoundingRect().clone();return e.applyTransform(uG(n)),e}},Z3={lineX:_s(WY,0),lineY:_s(WY,1),rect:function(n,e,t,r){var i=n?e.pointToData([t[0][0],t[1][0]],r):e.dataToPoint([t[0][0],t[1][0]],r),s=n?e.pointToData([t[0][1],t[1][1]],r):e.dataToPoint([t[0][1],t[1][1]],r),o=[m5([i[0],s[0]]),m5([i[1],s[1]])];return{values:o,xyMinMax:o}},polygon:function(n,e,t,r){var i=[[1/0,-1/0],[1/0,-1/0]],s=xr(t,function(o){var l=n?e.pointToData(o,r):e.dataToPoint(o,r);return i[0][0]=Math.min(i[0][0],l[0]),i[1][0]=Math.min(i[1][0],l[1]),i[0][1]=Math.max(i[0][1],l[0]),i[1][1]=Math.max(i[1][1],l[1]),l});return{values:s,xyMinMax:i}}};function WY(n,e,t,r){var i=t.getAxis(["x","y"][n]),s=m5(xr([0,1],function(l){return e?i.coordToData(i.toLocalCoord(r[l]),!0):i.toGlobalCoord(i.dataToCoord(r[l]))})),o=[];return o[n]=s,o[1-n]=[NaN,NaN],{values:s,xyMinMax:o}}var $Y={lineX:_s(XY,0),lineY:_s(XY,1),rect:function(n,e,t){return[[n[0][0]-t[0]*e[0][0],n[0][1]-t[0]*e[0][1]],[n[1][0]-t[1]*e[1][0],n[1][1]-t[1]*e[1][1]]]},polygon:function(n,e,t){return xr(n,function(r,i){return[r[0]-t[0]*e[i][0],r[1]-t[1]*e[i][1]]})}};function XY(n,e,t,r){return[e[0]-r[n]*t[0],e[1]-r[n]*t[1]]}function KFe(n,e){var t=qY(n),r=qY(e),i=[t[0]/r[0],t[1]/r[1]];return isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i}function qY(n){return n?[n[0][1]-n[0][0],n[1][1]-n[1][0]]:[NaN,NaN]}var g5=it,JFe=bCe("toolbox-dataZoom_"),QFe=function(n){Hn(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.render=function(t,r,i,s){this._brushController||(this._brushController=new lOe(i.getZr()),this._brushController.on("brush",Us(this._onBrush,this)).mount()),n3e(t,r,this,s,i),t3e(t,r)},e.prototype.onclick=function(t,r,i){e3e[i].call(this)},e.prototype.remove=function(t,r){this._brushController&&this._brushController.unmount()},e.prototype.dispose=function(t,r){this._brushController&&this._brushController.dispose()},e.prototype._onBrush=function(t){var r=t.areas;if(!t.isEnd||!r.length)return;var i={},s=this.ecModel;this._brushController.updateCovers([]);var o=new Hle(n8(this.model),s,{include:["grid"]});o.matchOutputRanges(r,s,function(h,f,p){if(p.type==="cartesian2d"){var v=h.brushType;v==="rect"?(l("x",p,f[0]),l("y",p,f[1])):l({lineX:"x",lineY:"y"}[v],p,f)}}),jFe(s,i),this._dispatchZoomAction(i);function l(h,f,p){var v=f.getAxis(h),y=v.model,S=a(h,y,s),C=S.findRepresentativeAxisProxy(y).getMinMaxSpan();(C.minValueSpan!=null||C.maxValueSpan!=null)&&(p=ple(0,p.slice(),v.scale.getExtent(),0,C.minValueSpan,C.maxValueSpan)),S&&(i[S.id]={dataZoomId:S.id,startValue:p[0],endValue:p[1]})}function a(h,f,p){var v;return p.eachComponent({mainType:"dataZoom",subType:"select"},function(y){var S=y.getAxisModel(h,f.componentIndex);S&&(v=y)}),v}},e.prototype._dispatchZoomAction=function(t){var r=[];g5(t,function(i,s){r.push(yi(i))}),r.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:r})},e.getDefaultOption=function(t){var r={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:t.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return r},e}(Gf),e3e={zoom:function(){var n=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:n})},back:function(){this._dispatchZoomAction(WFe(this.ecModel))}};function n8(n){var e={xAxisIndex:n.get("xAxisIndex",!0),yAxisIndex:n.get("yAxisIndex",!0),xAxisId:n.get("xAxisId",!0),yAxisId:n.get("yAxisId",!0)};return e.xAxisIndex==null&&e.xAxisId==null&&(e.xAxisIndex="all"),e.yAxisIndex==null&&e.yAxisId==null&&(e.yAxisIndex="all"),e}function t3e(n,e){n.setIconStatus("back",XFe(e)>1?"emphasis":"normal")}function n3e(n,e,t,r,i){var s=t._isZoomActive;r&&r.type==="takeGlobalCursor"&&(s=r.key==="dataZoomSelect"?r.dataZoomSelectActive:!1),t._isZoomActive=s,n.setIconStatus("zoom",s?"emphasis":"normal");var o=new Hle(n8(n),e,{include:["grid"]}),l=o.makePanelOpts(i,function(a){return a.xAxisDeclared&&!a.yAxisDeclared?"lineX":!a.xAxisDeclared&&a.yAxisDeclared?"lineY":"rect"});t._brushController.setPanels(l).enableBrush(s&&l.length?{brushType:"auto",brushStyle:n.getModel("brushStyle").getItemStyle()}:!1)}mRe("dataZoom",function(n){var e=n.getComponent("toolbox",0),t=["feature","dataZoom"];if(!e||e.get(t)==null)return;var r=e.getModel(t),i=[],s=n8(r),o=mT(n,s);g5(o.xAxisModels,function(a){return l(a,"xAxis","xAxisIndex")}),g5(o.yAxisModels,function(a){return l(a,"yAxis","yAxisIndex")});function l(a,h,f){var p=a.componentIndex,v={type:"select",$fromToolbox:!0,filterMode:r.get("filterMode",!0)||"filter",id:JFe+h+p};v[f]=p,i.push(v)}return i});function r3e(n){n.registerComponentModel(EFe),n.registerComponentView(IFe),dA("saveAsImage",PFe),dA("magicType",DFe),dA("dataView",VFe),dA("dataZoom",QFe),dA("restore",qFe),_p(MFe)}var i3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.type="tooltip",e.dependencies=["axisPointer"],e.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},e}(as);function jle(n){var e=n.get("confine");return e!=null?!!e:n.get("renderMode")==="richText"}function Wle(n){if(gi.domSupported){for(var e=document.documentElement.style,t=0,r=n.length;t<r;t++)if(n[t]in e)return n[t]}}var $le=Wle(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),s3e=Wle(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function Xle(n,e){if(!n)return e;e=iae(e,!0);var t=n.indexOf(e);return n=t===-1?e:"-"+n.slice(0,t)+"-"+e,n.toLowerCase()}function a3e(n,e){var t=n.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(n);return t?t[e]:null}var o3e=Xle(s3e,"transition"),r8=Xle($le,"transform"),l3e="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(gi.transform3dSupported?"will-change:transform;":"");function c3e(n){return n=n==="left"?"right":n==="right"?"left":n==="top"?"bottom":"top",n}function u3e(n,e,t){if(!Dr(t)||t==="inside")return"";var r=n.get("backgroundColor"),i=n.get("borderWidth");e=cx(e);var s=c3e(t),o=Math.max(Math.round(i)*1.5,6),l="",a=r8+":",h;Xi(["left","right"],s)>-1?(l+="top:50%",a+="translateY(-50%) rotate("+(h=s==="left"?-225:-45)+"deg)"):(l+="left:50%",a+="translateX(-50%) rotate("+(h=s==="top"?225:45)+"deg)");var f=h*Math.PI/180,p=o+i,v=p*Math.abs(Math.cos(f))+p*Math.abs(Math.sin(f)),y=Math.round(((v-Math.SQRT2*i)/2+Math.SQRT2*i-(v-p)/2)*100)/100;l+=";"+s+":-"+y+"px";var S=e+" solid "+i+"px;",C=["position:absolute;width:"+o+"px;height:"+o+"px;z-index:-1;",l+";"+a+";","border-bottom:"+S,"border-right:"+S,"background-color:"+r+";"];return'<div style="'+C.join("")+'"></div>'}function h3e(n,e){var t="cubic-bezier(0.23,1,0.32,1)",r=" "+n/2+"s "+t,i="opacity"+r+",visibility"+r;return e||(r=" "+n+"s "+t,i+=gi.transformSupported?","+r8+r:",left"+r+",top"+r),o3e+":"+i}function ZY(n,e,t){var r=n.toFixed(0)+"px",i=e.toFixed(0)+"px";if(!gi.transformSupported)return t?"top:"+i+";left:"+r+";":[["top",i],["left",r]];var s=gi.transform3dSupported,o="translate"+(s?"3d":"")+"("+r+","+i+(s?",0":"")+")";return t?"top:0;left:0;"+r8+":"+o+";":[["top",0],["left",0],[$le,o]]}function f3e(n){var e=[],t=n.get("fontSize"),r=n.getTextColor();r&&e.push("color:"+r),e.push("font:"+n.getFont()),t&&e.push("line-height:"+Math.round(t*3/2)+"px");var i=n.get("textShadowColor"),s=n.get("textShadowBlur")||0,o=n.get("textShadowOffsetX")||0,l=n.get("textShadowOffsetY")||0;return i&&s&&e.push("text-shadow:"+o+"px "+l+"px "+s+"px "+i),it(["decoration","align"],function(a){var h=n.get(a);h&&e.push("text-"+a+":"+h)}),e.join(";")}function d3e(n,e,t){var r=[],i=n.get("transitionDuration"),s=n.get("backgroundColor"),o=n.get("shadowBlur"),l=n.get("shadowColor"),a=n.get("shadowOffsetX"),h=n.get("shadowOffsetY"),f=n.getModel("textStyle"),p=Bae(n,"html"),v=a+"px "+h+"px "+o+"px "+l;return r.push("box-shadow:"+v),e&&i&&r.push(h3e(i,t)),s&&r.push("background-color:"+s),it(["width","color","radius"],function(y){var S="border-"+y,C=iae(S),M=n.get(C);M!=null&&r.push(S+":"+M+(y==="color"?"":"px"))}),r.push(f3e(f)),p!=null&&r.push("padding:"+dB(p).join("px ")+"px"),r.join(";")+";"}function YY(n,e,t,r,i){var s=e&&e.painter;if(t){var o=s&&s.getViewportRoot();o&&nEe(n,o,t,r,i)}else{n[0]=r,n[1]=i;var l=s&&s.getViewportRootOffset();l&&(n[0]+=l.offsetLeft,n[1]+=l.offsetTop)}n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var p3e=function(){function n(e,t){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,gi.wxa)return null;var r=document.createElement("div");r.domBelongToZr=!0,this.el=r;var i=this._zr=e.getZr(),s=t.appendTo,o=s&&(Dr(s)?document.querySelector(s):lw(s)?s:ci(s)&&s(e.getDom()));YY(this._styleCoord,i,o,e.getWidth()/2,e.getHeight()/2),(o||e.getDom()).appendChild(r),this._api=e,this._container=o;var l=this;r.onmouseenter=function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0},r.onmousemove=function(a){if(a=a||window.event,!l._enterable){var h=i.handler,f=i.painter.getViewportRoot();gh(f,a,!0),h.dispatch("mousemove",a)}},r.onmouseleave=function(){l._inContent=!1,l._enterable&&l._show&&l.hideLater(l._hideDelay)}}return n.prototype.update=function(e){if(!this._container){var t=this._api.getDom(),r=a3e(t,"position"),i=t.style;i.position!=="absolute"&&r!=="absolute"&&(i.position="relative")}var s=e.get("alwaysShowContent");s&&this._moveIfResized(),this._alwaysShowContent=s,this.el.className=e.get("className")||""},n.prototype.show=function(e,t){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var r=this.el,i=r.style,s=this._styleCoord;r.innerHTML?i.cssText=l3e+d3e(e,!this._firstShow,this._longHide)+ZY(s[0],s[1],!0)+("border-color:"+cx(t)+";")+(e.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},n.prototype.setContent=function(e,t,r,i,s){var o=this.el;if(e==null){o.innerHTML="";return}var l="";if(Dr(s)&&r.get("trigger")==="item"&&!jle(r)&&(l=u3e(r,i,s)),Dr(e))o.innerHTML=e+l;else if(e){o.innerHTML="",fr(e)||(e=[e]);for(var a=0;a<e.length;a++)lw(e[a])&&e[a].parentNode!==o&&o.appendChild(e[a]);if(l&&o.childNodes.length){var h=document.createElement("div");h.innerHTML=l,o.appendChild(h)}}},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el;return[e.offsetWidth,e.offsetHeight]},n.prototype.moveTo=function(e,t){var r=this._styleCoord;if(YY(r,this._zr,this._container,e,t),r[0]!=null&&r[1]!=null){var i=this.el.style,s=ZY(r[0],r[1]);it(s,function(o){i[o[0]]=o[1]})}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){var e=this,t=this.el.style;t.visibility="hidden",t.opacity="0",gi.transform3dSupported&&(t.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return e._longHide=!0},500)},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(Us(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var e=this.el.parentNode;e&&e.removeChild(this.el),this.el=this._container=null},n}(),m3e=function(){function n(e){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=e.getZr(),JY(this._styleCoord,this._zr,e.getWidth()/2,e.getHeight()/2)}return n.prototype.update=function(e){var t=e.get("alwaysShowContent");t&&this._moveIfResized(),this._alwaysShowContent=t},n.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},n.prototype.setContent=function(e,t,r,i,s){var o=this;$r(e)&&os(""),this.el&&this._zr.remove(this.el);var l=r.getModel("textStyle");this.el=new Io({style:{rich:t.richTextStyles,text:e,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:l.get("textShadowColor"),fill:r.get(["textStyle","color"]),padding:Bae(r,"richText"),verticalAlign:"top",align:"left"},z:r.get("z")}),it(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(h){o.el.style[h]=r.get(h)}),it(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(h){o.el.style[h]=l.get(h)||0}),this._zr.add(this.el);var a=this;this.el.on("mouseover",function(){a._enterable&&(clearTimeout(a._hideTimeout),a._show=!0),a._inContent=!0}),this.el.on("mouseout",function(){a._enterable&&a._show&&a.hideLater(a._hideDelay),a._inContent=!1})},n.prototype.setEnterable=function(e){this._enterable=e},n.prototype.getSize=function(){var e=this.el,t=this.el.getBoundingRect(),r=KY(e.style);return[t.width+r.left+r.right,t.height+r.top+r.bottom]},n.prototype.moveTo=function(e,t){var r=this.el;if(r){var i=this._styleCoord;JY(i,this._zr,e,t),e=i[0],t=i[1];var s=r.style,o=Lv(s.borderWidth||0),l=KY(s);r.x=e+o+l.left,r.y=t+o+l.top,r.markRedraw()}},n.prototype._moveIfResized=function(){var e=this._styleCoord[2],t=this._styleCoord[3];this.moveTo(e*this._zr.getWidth(),t*this._zr.getHeight())},n.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},n.prototype.hideLater=function(e){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(e?(this._hideDelay=e,this._show=!1,this._hideTimeout=setTimeout(Us(this.hide,this),e)):this.hide())},n.prototype.isShow=function(){return this._show},n.prototype.dispose=function(){this._zr.remove(this.el)},n}();function Lv(n){return Math.max(0,n)}function KY(n){var e=Lv(n.shadowBlur||0),t=Lv(n.shadowOffsetX||0),r=Lv(n.shadowOffsetY||0);return{left:Lv(e-t),right:Lv(e+t),top:Lv(e-r),bottom:Lv(e+r)}}function JY(n,e,t,r){n[0]=t,n[1]=r,n[2]=n[0]/e.getWidth(),n[3]=n[1]/e.getHeight()}var g3e=new Ha({shape:{x:-1,y:-1,width:2,height:2}}),v3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.init=function(t,r){if(!(gi.node||!r.getDom())){var i=t.getComponent("tooltip"),s=this._renderMode=ECe(i.get("renderMode"));this._tooltipContent=s==="richText"?new m3e(r):new p3e(r,{appendTo:i.get("appendToBody",!0)?"body":i.get("appendTo",!0)})}},e.prototype.render=function(t,r,i){if(!(gi.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=t,this._ecModel=r,this._api=i;var s=this._tooltipContent;s.update(t),s.setEnterable(t.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&t.get("transitionDuration")?Oae(this,"_updatePosition",50,"fixRate"):jz(this,"_updatePosition")}},e.prototype._initGlobalListener=function(){var t=this._tooltipModel,r=t.get("triggerOn");Dle("itemTooltip",this._api,Us(function(i,s,o){r!=="none"&&(r.indexOf(i)>=0?this._tryShow(s,o):i==="leave"&&this._hide(o))},this))},e.prototype._keepShow=function(){var t=this._tooltipModel,r=this._ecModel,i=this._api,s=t.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&s!=="none"&&s!=="click"){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&o.manuallyShowTip(t,r,i,{x:o._lastX,y:o._lastY,dataByCoordSys:o._lastDataByCoordSys})})}},e.prototype.manuallyShowTip=function(t,r,i,s){if(!(s.from===this.uid||gi.node||!i.getDom())){var o=QY(s,i);this._ticket="";var l=s.dataByCoordSys,a=b3e(s,r,i);if(a){var h=a.el.getBoundingRect().clone();h.applyTransform(a.el.transform),this._tryShow({offsetX:h.x+h.width/2,offsetY:h.y+h.height/2,target:a.el,position:s.position,positionDefault:"bottom"},o)}else if(s.tooltip&&s.x!=null&&s.y!=null){var f=g3e;f.x=s.x,f.y=s.y,f.update(),$i(f).tooltipConfig={name:null,option:s.tooltip},this._tryShow({offsetX:s.x,offsetY:s.y,target:f},o)}else if(l)this._tryShow({offsetX:s.x,offsetY:s.y,position:s.position,dataByCoordSys:l,tooltipOption:s.tooltipOption},o);else if(s.seriesIndex!=null){if(this._manuallyAxisShowTip(t,r,i,s))return;var p=Ble(s,r),v=p.point[0],y=p.point[1];v!=null&&y!=null&&this._tryShow({offsetX:v,offsetY:y,target:p.el,position:s.position,positionDefault:"bottom"},o)}else s.x!=null&&s.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:s.x,y:s.y}),this._tryShow({offsetX:s.x,offsetY:s.y,position:s.position,target:i.getZr().findHover(s.x,s.y).target},o))}},e.prototype.manuallyHideTip=function(t,r,i,s){var o=this._tooltipContent;this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,s.from!==this.uid&&this._hide(QY(s,i))},e.prototype._manuallyAxisShowTip=function(t,r,i,s){var o=s.seriesIndex,l=s.dataIndex,a=r.getComponent("axisPointer").coordSysAxesInfo;if(!(o==null||l==null||a==null)){var h=r.getSeriesByIndex(o);if(h){var f=h.getData(),p=pA([f.getItemModel(l),h,(h.coordinateSystem||{}).model],this._tooltipModel);if(p.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:l,position:s.position}),!0}}},e.prototype._tryShow=function(t,r){var i=t.target,s=this._tooltipModel;if(s){this._lastX=t.offsetX,this._lastY=t.offsetY;var o=t.dataByCoordSys;if(o&&o.length)this._showAxisTooltip(o,t);else if(i){var l=$i(i);if(l.ssrType==="legend")return;this._lastDataByCoordSys=null;var a,h;NA(i,function(f){if($i(f).dataIndex!=null)return a=f,!0;if($i(f).tooltipConfig!=null)return h=f,!0},!0),a?this._showSeriesItemTooltip(t,a,r):h?this._showComponentItemTooltip(t,h,r):this._hide(r)}else this._lastDataByCoordSys=null,this._hide(r)}},e.prototype._showOrMove=function(t,r){var i=t.get("showDelay");r=Us(r,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(r,i):r()},e.prototype._showAxisTooltip=function(t,r){var i=this._ecModel,s=this._tooltipModel,o=[r.offsetX,r.offsetY],l=pA([r.tooltipOption],s),a=this._renderMode,h=[],f=wM("section",{blocks:[],noHeader:!0}),p=[],v=new b3;it(t,function(L){it(L.dataByAxis,function(k){var H=i.getComponent(k.axisDim+"Axis",k.axisIndex),X=k.value;if(!(!H||X==null)){var Z=Rle(X,H.axis,i,k.seriesDataIndices,k.valueLabelOpt),Q=wM("section",{header:Z,noHeader:!rp(Z),sortBlocks:!0,blocks:[]});f.blocks.push(Q),it(k.seriesDataIndices,function(re){var ie=i.getSeriesByIndex(re.seriesIndex),oe=re.dataIndexInside,fe=ie.getDataParams(oe);if(!(fe.dataIndex<0)){fe.axisDim=k.axisDim,fe.axisIndex=k.axisIndex,fe.axisType=k.axisType,fe.axisId=k.axisId,fe.axisValue=NG(H.axis,{value:X}),fe.axisValueLabel=Z,fe.marker=v.makeTooltipMarker("item",cx(fe.color),a);var Se=Vq(ie.formatTooltip(oe,!0,null)),Ee=Se.frag;if(Ee){var Ie=pA([ie],s).get("valueFormatter");Q.blocks.push(Ie?Jn({valueFormatter:Ie},Ee):Ee)}Se.text&&p.push(Se.text),h.push(fe)}})}})}),f.blocks.reverse(),p.reverse();var y=r.position,S=l.get("order"),C=qq(f,v,a,S,i.get("useUTC"),l.get("textStyle"));C&&p.unshift(C);var M=a==="richText"?`

`:"<br/>",E=p.join(M);this._showOrMove(l,function(){this._updateContentNotChangedOnAxis(t,h)?this._updatePosition(l,y,o[0],o[1],this._tooltipContent,h):this._showTooltipContent(l,E,h,Math.random()+"",o[0],o[1],y,null,v)})},e.prototype._showSeriesItemTooltip=function(t,r,i){var s=this._ecModel,o=$i(r),l=o.seriesIndex,a=s.getSeriesByIndex(l),h=o.dataModel||a,f=o.dataIndex,p=o.dataType,v=h.getData(p),y=this._renderMode,S=t.positionDefault,C=pA([v.getItemModel(f),h,a&&(a.coordinateSystem||{}).model],this._tooltipModel,S?{position:S}:null),M=C.get("trigger");if(!(M!=null&&M!=="item")){var E=h.getDataParams(f,p),L=new b3;E.marker=L.makeTooltipMarker("item",cx(E.color),y);var k=Vq(h.formatTooltip(f,!1,p)),H=C.get("order"),X=C.get("valueFormatter"),Z=k.frag,Q=Z?qq(X?Jn({valueFormatter:X},Z):Z,L,y,H,s.get("useUTC"),C.get("textStyle")):k.text,re="item_"+h.name+"_"+f;this._showOrMove(C,function(){this._showTooltipContent(C,Q,E,re,t.offsetX,t.offsetY,t.position,t.target,L)}),i({type:"showTip",dataIndexInside:f,dataIndex:v.getRawIndex(f),seriesIndex:l,from:this.uid})}},e.prototype._showComponentItemTooltip=function(t,r,i){var s=this._renderMode==="html",o=$i(r),l=o.tooltipConfig,a=l.option||{},h=a.encodeHTMLContent;if(Dr(a)){var f=a;a={content:f,formatter:f},h=!0}h&&s&&a.content&&(a=yi(a),a.content=Du(a.content));var p=[a],v=this._ecModel.getComponent(o.componentMainType,o.componentIndex);v&&p.push(v),p.push({formatter:a.content});var y=t.positionDefault,S=pA(p,this._tooltipModel,y?{position:y}:null),C=S.get("content"),M=Math.random()+"",E=new b3;this._showOrMove(S,function(){var L=yi(S.get("formatterParams")||{});this._showTooltipContent(S,C,L,M,t.offsetX,t.offsetY,t.position,r,E)}),i({type:"showTip",from:this.uid})},e.prototype._showTooltipContent=function(t,r,i,s,o,l,a,h,f){if(this._ticket="",!(!t.get("showContent")||!t.get("show"))){var p=this._tooltipContent;p.setEnterable(t.get("enterable"));var v=t.get("formatter");a=a||t.get("position");var y=r,S=this._getNearestPoint([o,l],i,t.get("trigger"),t.get("borderColor")),C=S.color;if(v)if(Dr(v)){var M=t.ecModel.get("useUTC"),E=fr(i)?i[0]:i,L=E&&E.axisType&&E.axisType.indexOf("time")>=0;y=v,L&&(y=lB(E.axisValue,y,M)),y=sae(y,i,!0)}else if(ci(v)){var k=Us(function(H,X){H===this._ticket&&(p.setContent(X,f,t,C,a),this._updatePosition(t,a,o,l,p,i,h))},this);this._ticket=s,y=v(i,s,k)}else y=v;p.setContent(y,f,t,C,a),p.show(t,C),this._updatePosition(t,a,o,l,p,i,h)}},e.prototype._getNearestPoint=function(t,r,i,s){if(i==="axis"||fr(r))return{color:s||(this._renderMode==="html"?"#fff":"none")};if(!fr(r))return{color:s||r.color||r.borderColor}},e.prototype._updatePosition=function(t,r,i,s,o,l,a){var h=this._api.getWidth(),f=this._api.getHeight();r=r||t.get("position");var p=o.getSize(),v=t.get("align"),y=t.get("verticalAlign"),S=a&&a.getBoundingRect().clone();if(a&&S.applyTransform(a.transform),ci(r)&&(r=r([i,s],l,o.el,S,{viewSize:[h,f],contentSize:p.slice()})),fr(r))i=ls(r[0],h),s=ls(r[1],f);else if($r(r)){var C=r;C.width=p[0],C.height=p[1];var M=b0(C,{width:h,height:f});i=M.x,s=M.y,v=null,y=null}else if(Dr(r)&&a){var E=x3e(r,S,p,t.get("borderWidth"));i=E[0],s=E[1]}else{var E=_3e(i,s,o,h,f,v?null:20,y?null:20);i=E[0],s=E[1]}if(v&&(i-=eK(v)?p[0]/2:v==="right"?p[0]:0),y&&(s-=eK(y)?p[1]/2:y==="bottom"?p[1]:0),jle(t)){var E=y3e(i,s,o,h,f);i=E[0],s=E[1]}o.moveTo(i,s)},e.prototype._updateContentNotChangedOnAxis=function(t,r){var i=this._lastDataByCoordSys,s=this._cbParamsList,o=!!i&&i.length===t.length;return o&&it(i,function(l,a){var h=l.dataByAxis||[],f=t[a]||{},p=f.dataByAxis||[];o=o&&h.length===p.length,o&&it(h,function(v,y){var S=p[y]||{},C=v.seriesDataIndices||[],M=S.seriesDataIndices||[];o=o&&v.value===S.value&&v.axisType===S.axisType&&v.axisId===S.axisId&&C.length===M.length,o&&it(C,function(E,L){var k=M[L];o=o&&E.seriesIndex===k.seriesIndex&&E.dataIndex===k.dataIndex}),s&&it(v.seriesDataIndices,function(E){var L=E.seriesIndex,k=r[L],H=s[L];k&&H&&H.data!==k.data&&(o=!1)})})}),this._lastDataByCoordSys=t,this._cbParamsList=r,!!o},e.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid})},e.prototype.dispose=function(t,r){gi.node||!r.getDom()||(jz(this,"_updatePosition"),this._tooltipContent.dispose(),d5("itemTooltip",r))},e.type="tooltip",e}(Dc);function pA(n,e,t){var r=e.ecModel,i;t?(i=new Ra(t,r,r),i=new Ra(e.option,i,r)):i=e;for(var s=n.length-1;s>=0;s--){var o=n[s];o&&(o instanceof Ra&&(o=o.get("tooltip",!0)),Dr(o)&&(o={formatter:o}),o&&(i=new Ra(o,i,r)))}return i}function QY(n,e){return n.dispatchAction||Us(e.dispatchAction,e)}function _3e(n,e,t,r,i,s,o){var l=t.getSize(),a=l[0],h=l[1];return s!=null&&(n+a+s+2>r?n-=a+s:n+=s),o!=null&&(e+h+o>i?e-=h+o:e+=o),[n,e]}function y3e(n,e,t,r,i){var s=t.getSize(),o=s[0],l=s[1];return n=Math.min(n+o,r)-o,e=Math.min(e+l,i)-l,n=Math.max(n,0),e=Math.max(e,0),[n,e]}function x3e(n,e,t,r){var i=t[0],s=t[1],o=Math.ceil(Math.SQRT2*r)+8,l=0,a=0,h=e.width,f=e.height;switch(n){case"inside":l=e.x+h/2-i/2,a=e.y+f/2-s/2;break;case"top":l=e.x+h/2-i/2,a=e.y-s-o;break;case"bottom":l=e.x+h/2-i/2,a=e.y+f+o;break;case"left":l=e.x-i-o,a=e.y+f/2-s/2;break;case"right":l=e.x+h+o,a=e.y+f/2-s/2}return[l,a]}function eK(n){return n==="center"||n==="middle"}function b3e(n,e,t){var r=Q6(n).queryOptionMap,i=r.keys()[0];if(!(!i||i==="series")){var s=_E(e,i,r.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),o=s.models[0];if(o){var l=t.getViewOfComponentModel(o),a;if(l.group.traverse(function(h){var f=$i(h).tooltipConfig;if(f&&f.name===n.name)return a=h,!0}),a)return{componentMainType:i,componentIndex:o.componentIndex,el:a}}}}function w3e(n){_p(KG),n.registerComponentModel(i3e),n.registerComponentView(v3e),n.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Rc),n.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Rc)}var S3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.type="title",e.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},e}(as),A3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.render=function(t,r,i){if(this.group.removeAll(),!!t.get("show")){var s=this.group,o=t.getModel("textStyle"),l=t.getModel("subtextStyle"),a=t.get("textAlign"),h=Ii(t.get("textBaseline"),t.get("textVerticalAlign")),f=new Io({style:ng(o,{text:t.get("text"),fill:o.getTextColor()},{disableBox:!0}),z2:10}),p=f.getBoundingRect(),v=t.get("subtext"),y=new Io({style:ng(l,{text:v,fill:l.getTextColor(),y:p.height+t.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),S=t.get("link"),C=t.get("sublink"),M=t.get("triggerEvent",!0);f.silent=!S&&!M,y.silent=!C&&!M,S&&f.on("click",function(){Aq(S,"_"+t.get("target"))}),C&&y.on("click",function(){Aq(C,"_"+t.get("subtarget"))}),$i(f).eventData=$i(y).eventData=M?{componentType:"title",componentIndex:t.componentIndex}:null,s.add(f),v&&s.add(y);var E=s.getBoundingRect(),L=t.getBoxLayoutParams();L.width=E.width,L.height=E.height;var k=b0(L,{width:i.getWidth(),height:i.getHeight()},t.get("padding"));a||(a=t.get("left")||t.get("right"),a==="middle"&&(a="center"),a==="right"?k.x+=k.width:a==="center"&&(k.x+=k.width/2)),h||(h=t.get("top")||t.get("bottom"),h==="center"&&(h="middle"),h==="bottom"?k.y+=k.height:h==="middle"&&(k.y+=k.height/2),h=h||"top"),s.x=k.x,s.y=k.y,s.markRedraw();var H={align:a,verticalAlign:h};f.setStyle(H),y.setStyle(H),E=s.getBoundingRect();var X=k.margin,Z=t.getItemStyle(["color","opacity"]);Z.fill=t.get("backgroundColor");var Q=new Ha({shape:{x:E.x-X[3],y:E.y-X[0],width:E.width+X[1]+X[3],height:E.height+X[0]+X[2],r:t.get("borderRadius")},style:Z,subPixelOptimize:!0,silent:!0});s.add(Q)}},e.type="title",e}(Dc);function T3e(n){n.registerComponentModel(S3e),n.registerComponentView(A3e)}var M3e=function(n,e){if(e==="all")return{type:"all",title:n.getLocaleModel().get(["legend","selector","all"])};if(e==="inverse")return{type:"inverse",title:n.getLocaleModel().get(["legend","selector","inverse"])}},v5=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.layoutMode={type:"box",ignoreSize:!0},t}return e.prototype.init=function(t,r,i){this.mergeDefaultAndTheme(t,i),t.selected=t.selected||{},this._updateSelector(t)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),this._updateSelector(t)},e.prototype._updateSelector=function(t){var r=t.selector,i=this.ecModel;r===!0&&(r=t.selector=["all","inverse"]),fr(r)&&it(r,function(s,o){Dr(s)&&(s={type:s}),r[o]=Bi(s,M3e(i,s.type))})},e.prototype.optionUpdated=function(){this._updateData(this.ecModel);var t=this._data;if(t[0]&&this.get("selectedMode")==="single"){for(var r=!1,i=0;i<t.length;i++){var s=t[i].get("name");if(this.isSelected(s)){this.select(s),r=!0;break}}!r&&this.select(t[0].get("name"))}},e.prototype._updateData=function(t){var r=[],i=[];t.eachRawSeries(function(a){var h=a.name;i.push(h);var f;if(a.legendVisualProvider){var p=a.legendVisualProvider,v=p.getAllNames();t.isSeriesFiltered(a)||(i=i.concat(v)),v.length?r=r.concat(v):f=!0}else f=!0;f&&J6(a)&&r.push(a.name)}),this._availableNames=i;var s=this.get("data")||r,o=ii(),l=xr(s,function(a){return(Dr(a)||Ps(a))&&(a={name:a}),o.get(a.name)?null:(o.set(a.name,!0),new Ra(a,this,this.ecModel))},this);this._data=no(l,function(a){return!!a})},e.prototype.getData=function(){return this._data},e.prototype.select=function(t){var r=this.option.selected,i=this.get("selectedMode");if(i==="single"){var s=this._data;it(s,function(o){r[o.get("name")]=!1})}r[t]=!0},e.prototype.unSelect=function(t){this.get("selectedMode")!=="single"&&(this.option.selected[t]=!1)},e.prototype.toggleSelected=function(t){var r=this.option.selected;r.hasOwnProperty(t)||(r[t]=!0),this[r[t]?"unSelect":"select"](t)},e.prototype.allSelect=function(){var t=this._data,r=this.option.selected;it(t,function(i){r[i.get("name",!0)]=!0})},e.prototype.inverseSelect=function(){var t=this._data,r=this.option.selected;it(t,function(i){var s=i.get("name",!0);r.hasOwnProperty(s)||(r[s]=!0),r[s]=!r[s]})},e.prototype.isSelected=function(t){var r=this.option.selected;return!(r.hasOwnProperty(t)&&!r[t])&&Xi(this._availableNames,t)>=0},e.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},e.type="legend.plain",e.dependencies=["series"],e.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},e}(as),j1=_s,_5=it,TI=go,qle=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!1,t}return e.prototype.init=function(){this.group.add(this._contentGroup=new TI),this.group.add(this._selectorGroup=new TI),this._isFirstRender=!0},e.prototype.getContentGroup=function(){return this._contentGroup},e.prototype.getSelectorGroup=function(){return this._selectorGroup},e.prototype.render=function(t,r,i){var s=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!t.get("show",!0)){var o=t.get("align"),l=t.get("orient");(!o||o==="auto")&&(o=t.get("left")==="right"&&l==="vertical"?"right":"left");var a=t.get("selector",!0),h=t.get("selectorPosition",!0);a&&(!h||h==="auto")&&(h=l==="horizontal"?"end":"start"),this.renderInner(o,t,r,i,a,l,h);var f=t.getBoxLayoutParams(),p={width:i.getWidth(),height:i.getHeight()},v=t.get("padding"),y=b0(f,p,v),S=this.layoutInner(t,o,y,s,a,h),C=b0(ti({width:S.width,height:S.height},f),p,v);this.group.x=C.x-S.x,this.group.y=C.y-S.y,this.group.markRedraw(),this.group.add(this._backgroundEl=Ule(S,t))}},e.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},e.prototype.renderInner=function(t,r,i,s,o,l,a){var h=this.getContentGroup(),f=ii(),p=r.get("selectedMode"),v=[];i.eachRawSeries(function(y){!y.get("legendHoverLink")&&v.push(y.id)}),_5(r.getData(),function(y,S){var C=y.get("name");if(!this.newlineDisabled&&(C===""||C===`
`)){var M=new TI;M.newline=!0,h.add(M);return}var E=i.getSeriesByName(C)[0];if(!f.get(C))if(E){var L=E.getData(),k=L.getVisual("legendLineStyle")||{},H=L.getVisual("legendIcon"),X=L.getVisual("style"),Z=this._createItem(E,C,S,y,r,t,k,X,H,p,s);Z.on("click",j1(tK,C,null,s,v)).on("mouseover",j1(y5,E.name,null,s,v)).on("mouseout",j1(x5,E.name,null,s,v)),i.ssr&&Z.eachChild(function(Q){var re=$i(Q);re.seriesIndex=E.seriesIndex,re.dataIndex=S,re.ssrType="legend"}),f.set(C,!0)}else i.eachRawSeries(function(Q){if(!f.get(C)&&Q.legendVisualProvider){var re=Q.legendVisualProvider;if(!re.containName(C))return;var ie=re.indexOfName(C),oe=re.getItemVisual(ie,"style"),fe=re.getItemVisual(ie,"legendIcon"),Se=Um(oe.fill);Se&&Se[3]===0&&(Se[3]=.2,oe=Jn(Jn({},oe),{fill:WD(Se,"rgba")}));var Ee=this._createItem(Q,C,S,y,r,t,{},oe,fe,p,s);Ee.on("click",j1(tK,null,C,s,v)).on("mouseover",j1(y5,null,C,s,v)).on("mouseout",j1(x5,null,C,s,v)),i.ssr&&Ee.eachChild(function(Ie){var He=$i(Ie);He.seriesIndex=Q.seriesIndex,He.dataIndex=S,He.ssrType="legend"}),f.set(C,!0)}},this)},this),o&&this._createSelector(o,r,s,l,a)},e.prototype._createSelector=function(t,r,i,s,o){var l=this.getSelectorGroup();_5(t,function(h){var f=h.type,p=new Io({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:f==="all"?"legendAllSelect":"legendInverseSelect"})}});l.add(p);var v=r.getModel("selectorLabel"),y=r.getModel(["emphasis","selectorLabel"]);yE(p,{normal:v,emphasis:y},{defaultText:h.title}),Pz(p)})},e.prototype._createItem=function(t,r,i,s,o,l,a,h,f,p,v){var y=t.visualDrawType,S=o.get("itemWidth"),C=o.get("itemHeight"),M=o.isSelected(r),E=s.get("symbolRotate"),L=s.get("symbolKeepAspect"),k=s.get("icon");f=k||f||"roundRect";var H=E3e(f,s,a,h,y,M,v),X=new TI,Z=s.getModel("textStyle");if(ci(t.getLegendIcon)&&(!k||k==="inherit"))X.add(t.getLegendIcon({itemWidth:S,itemHeight:C,icon:f,iconRotate:E,itemStyle:H.itemStyle,lineStyle:H.lineStyle,symbolKeepAspect:L}));else{var Q=k==="inherit"&&t.getData().getVisual("symbol")?E==="inherit"?t.getData().getVisual("symbolRotate"):E:0;X.add(C3e({itemWidth:S,itemHeight:C,icon:f,iconRotate:Q,itemStyle:H.itemStyle,lineStyle:H.lineStyle,symbolKeepAspect:L}))}var re=l==="left"?S+5:-5,ie=l,oe=o.get("formatter"),fe=r;Dr(oe)&&oe?fe=oe.replace("{name}",r??""):ci(oe)&&(fe=oe(r));var Se=M?Z.getTextColor():s.get("inactiveColor");X.add(new Io({style:ng(Z,{text:fe,x:re,y:C/2,fill:Se,align:ie,verticalAlign:"middle"},{inheritColor:Se})}));var Ee=new Ha({shape:X.getBoundingRect(),style:{fill:"transparent"}}),Ie=s.getModel("tooltip");return Ie.get("show")&&sB({el:Ee,componentModel:o,itemName:r,itemTooltipOption:Ie.option}),X.add(Ee),X.eachChild(function(He){He.silent=!0}),Ee.silent=!p,this.getContentGroup().add(X),Pz(X),X.__legendDataIndex=i,X},e.prototype.layoutInner=function(t,r,i,s,o,l){var a=this.getContentGroup(),h=this.getSelectorGroup();$b(t.get("orient"),a,t.get("itemGap"),i.width,i.height);var f=a.getBoundingRect(),p=[-f.x,-f.y];if(h.markRedraw(),a.markRedraw(),o){$b("horizontal",h,t.get("selectorItemGap",!0));var v=h.getBoundingRect(),y=[-v.x,-v.y],S=t.get("selectorButtonGap",!0),C=t.getOrient().index,M=C===0?"width":"height",E=C===0?"height":"width",L=C===0?"y":"x";l==="end"?y[C]+=f[M]+S:p[C]+=v[M]+S,y[1-C]+=f[E]/2-v[E]/2,h.x=y[0],h.y=y[1],a.x=p[0],a.y=p[1];var k={x:0,y:0};return k[M]=f[M]+S+v[M],k[E]=Math.max(f[E],v[E]),k[L]=Math.min(0,v[L]+y[1-C]),k}else return a.x=p[0],a.y=p[1],this.group.getBoundingRect()},e.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},e.type="legend.plain",e}(Dc);function E3e(n,e,t,r,i,s,o){function l(M,E){M.lineWidth==="auto"&&(M.lineWidth=E.lineWidth>0?2:0),_5(M,function(L,k){M[k]==="inherit"&&(M[k]=E[k])})}var a=e.getModel("itemStyle"),h=a.getItemStyle(),f=n.lastIndexOf("empty",0)===0?"fill":"stroke",p=a.getShallow("decal");h.decal=!p||p==="inherit"?r.decal:Zz(p,o),h.fill==="inherit"&&(h.fill=r[i]),h.stroke==="inherit"&&(h.stroke=r[f]),h.opacity==="inherit"&&(h.opacity=(i==="fill"?r:t).opacity),l(h,r);var v=e.getModel("lineStyle"),y=v.getLineStyle();if(l(y,t),h.fill==="auto"&&(h.fill=r.fill),h.stroke==="auto"&&(h.stroke=r.fill),y.stroke==="auto"&&(y.stroke=r.fill),!s){var S=e.get("inactiveBorderWidth"),C=h[f];h.lineWidth=S==="auto"?r.lineWidth>0&&C?2:0:h.lineWidth,h.fill=e.get("inactiveColor"),h.stroke=e.get("inactiveBorderColor"),y.stroke=v.get("inactiveColor"),y.lineWidth=v.get("inactiveWidth")}return{itemStyle:h,lineStyle:y}}function C3e(n){var e=n.icon||"roundRect",t=dw(e,0,0,n.itemWidth,n.itemHeight,n.itemStyle.fill,n.symbolKeepAspect);return t.setStyle(n.itemStyle),t.rotation=(n.iconRotate||0)*Math.PI/180,t.setOrigin([n.itemWidth/2,n.itemHeight/2]),e.indexOf("empty")>-1&&(t.style.stroke=t.style.fill,t.style.fill="#fff",t.style.lineWidth=2),t}function tK(n,e,t,r){x5(n,e,t,r),t.dispatchAction({type:"legendToggleSelect",name:n??e}),y5(n,e,t,r)}function Zle(n){for(var e=n.getZr().storage.getDisplayList(),t,r=0,i=e.length;r<i&&!(t=e[r].states.emphasis);)r++;return t&&t.hoverLayer}function y5(n,e,t,r){Zle(t)||t.dispatchAction({type:"highlight",seriesName:n,name:e,excludeSeriesId:r})}function x5(n,e,t,r){Zle(t)||t.dispatchAction({type:"downplay",seriesName:n,name:e,excludeSeriesId:r})}function I3e(n){var e=n.findComponents({mainType:"legend"});e&&e.length&&n.filterSeries(function(t){for(var r=0;r<e.length;r++)if(!e[r].isSelected(t.name))return!1;return!0})}function mA(n,e,t){var r={},i=n==="toggleSelected",s;return t.eachComponent("legend",function(o){i&&s!=null?o[s?"select":"unSelect"](e.name):n==="allSelect"||n==="inverseSelect"?o[n]():(o[n](e.name),s=o.isSelected(e.name));var l=o.getData();it(l,function(a){var h=a.get("name");if(!(h===`
`||h==="")){var f=o.isSelected(h);r.hasOwnProperty(h)?r[h]=r[h]&&f:r[h]=f}})}),n==="allSelect"||n==="inverseSelect"?{selected:r}:{name:e.name,selected:r}}function R3e(n){n.registerAction("legendToggleSelect","legendselectchanged",_s(mA,"toggleSelected")),n.registerAction("legendAllSelect","legendselectall",_s(mA,"allSelect")),n.registerAction("legendInverseSelect","legendinverseselect",_s(mA,"inverseSelect")),n.registerAction("legendSelect","legendselected",_s(mA,"select")),n.registerAction("legendUnSelect","legendunselected",_s(mA,"unSelect"))}function Yle(n){n.registerComponentModel(v5),n.registerComponentView(qle),n.registerProcessor(n.PRIORITY.PROCESSOR.SERIES_FILTER,I3e),n.registerSubTypeDefaulter("legend",function(){return"plain"}),R3e(n)}var P3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t}return e.prototype.setScrollDataIndex=function(t){this.option.scrollDataIndex=t},e.prototype.init=function(t,r,i){var s=pB(t);n.prototype.init.call(this,t,r,i),nK(this,t,s)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),nK(this,this.option,t)},e.type="legend.scroll",e.defaultOption=$se(v5.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),e}(v5);function nK(n,e,t){var r=n.getOrient(),i=[1,1];i[r.index]=0,hw(e,t,{type:"box",ignoreSize:!!i})}var rK=go,Y3=["width","height"],K3=["x","y"],L3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type=e.type,t.newlineDisabled=!0,t._currentIndex=0,t}return e.prototype.init=function(){n.prototype.init.call(this),this.group.add(this._containerGroup=new rK),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new rK)},e.prototype.resetInner=function(){n.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},e.prototype.renderInner=function(t,r,i,s,o,l,a){var h=this;n.prototype.renderInner.call(this,t,r,i,s,o,l,a);var f=this._controllerGroup,p=r.get("pageIconSize",!0),v=fr(p)?p:[p,p];S("pagePrev",0);var y=r.getModel("pageTextStyle");f.add(new Io({name:"pageText",style:{text:"xx/xx",fill:y.getTextColor(),font:y.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),S("pageNext",1);function S(C,M){var E=C+"DataIndex",L=iB(r.get("pageIcons",!0)[r.getOrient().name][M],{onclick:Us(h._pageGo,h,E,r,s)},{x:-v[0]/2,y:-v[1]/2,width:v[0],height:v[1]});L.name=C,f.add(L)}},e.prototype.layoutInner=function(t,r,i,s,o,l){var a=this.getSelectorGroup(),h=t.getOrient().index,f=Y3[h],p=K3[h],v=Y3[1-h],y=K3[1-h];o&&$b("horizontal",a,t.get("selectorItemGap",!0));var S=t.get("selectorButtonGap",!0),C=a.getBoundingRect(),M=[-C.x,-C.y],E=yi(i);o&&(E[f]=i[f]-C[f]-S);var L=this._layoutContentAndController(t,s,E,h,f,v,y,p);if(o){if(l==="end")M[h]+=L[f]+S;else{var k=C[f]+S;M[h]-=k,L[p]-=k}L[f]+=C[f]+S,M[1-h]+=L[y]+L[v]/2-C[v]/2,L[v]=Math.max(L[v],C[v]),L[y]=Math.min(L[y],C[y]+M[1-h]),a.x=M[0],a.y=M[1],a.markRedraw()}return L},e.prototype._layoutContentAndController=function(t,r,i,s,o,l,a,h){var f=this.getContentGroup(),p=this._containerGroup,v=this._controllerGroup;$b(t.get("orient"),f,t.get("itemGap"),s?i.width:null,s?null:i.height),$b("horizontal",v,t.get("pageButtonItemGap",!0));var y=f.getBoundingRect(),S=v.getBoundingRect(),C=this._showController=y[o]>i[o],M=[-y.x,-y.y];r||(M[s]=f[h]);var E=[0,0],L=[-S.x,-S.y],k=Ii(t.get("pageButtonGap",!0),t.get("itemGap",!0));if(C){var H=t.get("pageButtonPosition",!0);H==="end"?L[s]+=i[o]-S[o]:E[s]+=S[o]+k}L[1-s]+=y[l]/2-S[l]/2,f.setPosition(M),p.setPosition(E),v.setPosition(L);var X={x:0,y:0};if(X[o]=C?i[o]:y[o],X[l]=Math.max(y[l],S[l]),X[a]=Math.min(0,S[a]+L[1-s]),p.__rectSize=i[o],C){var Z={x:0,y:0};Z[o]=Math.max(i[o]-S[o]-k,0),Z[l]=X[l],p.setClipPath(new Ha({shape:Z})),p.__rectSize=Z[o]}else v.eachChild(function(re){re.attr({invisible:!0,silent:!0})});var Q=this._getPageInfo(t);return Q.pageIndex!=null&&ol(f,{x:Q.contentPosition[0],y:Q.contentPosition[1]},C?t:null),this._updatePageInfoView(t,Q),X},e.prototype._pageGo=function(t,r,i){var s=this._getPageInfo(r)[t];s!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:s,legendId:r.id})},e.prototype._updatePageInfoView=function(t,r){var i=this._controllerGroup;it(["pagePrev","pageNext"],function(f){var p=f+"DataIndex",v=r[p]!=null,y=i.childOfName(f);y&&(y.setStyle("fill",v?t.get("pageIconColor",!0):t.get("pageIconInactiveColor",!0)),y.cursor=v?"pointer":"default")});var s=i.childOfName("pageText"),o=t.get("pageFormatter"),l=r.pageIndex,a=l!=null?l+1:0,h=r.pageCount;s&&o&&s.setStyle("text",Dr(o)?o.replace("{current}",a==null?"":a+"").replace("{total}",h==null?"":h+""):o({current:a,total:h}))},e.prototype._getPageInfo=function(t){var r=t.get("scrollDataIndex",!0),i=this.getContentGroup(),s=this._containerGroup.__rectSize,o=t.getOrient().index,l=Y3[o],a=K3[o],h=this._findTargetItemIndex(r),f=i.children(),p=f[h],v=f.length,y=v?1:0,S={contentPosition:[i.x,i.y],pageCount:y,pageIndex:y-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!p)return S;var C=H(p);S.contentPosition[o]=-C.s;for(var M=h+1,E=C,L=C,k=null;M<=v;++M)k=H(f[M]),(!k&&L.e>E.s+s||k&&!X(k,E.s))&&(L.i>E.i?E=L:E=k,E&&(S.pageNextDataIndex==null&&(S.pageNextDataIndex=E.i),++S.pageCount)),L=k;for(var M=h-1,E=C,L=C,k=null;M>=-1;--M)k=H(f[M]),(!k||!X(L,k.s))&&E.i<L.i&&(L=E,S.pagePrevDataIndex==null&&(S.pagePrevDataIndex=E.i),++S.pageCount,++S.pageIndex),E=k;return S;function H(Z){if(Z){var Q=Z.getBoundingRect(),re=Q[a]+Z[a];return{s:re,e:re+Q[l],i:Z.__legendDataIndex}}}function X(Z,Q){return Z.e>=Q&&Z.s<=Q+s}},e.prototype._findTargetItemIndex=function(t){if(!this._showController)return 0;var r,i=this.getContentGroup(),s;return i.eachChild(function(o,l){var a=o.__legendDataIndex;s==null&&a!=null&&(s=l),a===t&&(r=l)}),r??s},e.type="legend.scroll",e}(qle);function D3e(n){n.registerAction("legendScroll","legendscroll",function(e,t){var r=e.scrollDataIndex;r!=null&&t.eachComponent({mainType:"legend",subType:"scroll",query:e},function(i){i.setScrollDataIndex(r)})})}function B3e(n){_p(Yle),n.registerComponentModel(P3e),n.registerComponentView(L3e),D3e(n)}function k3e(n){_p(Yle),_p(B3e)}var iK={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},O3e=function(){function n(e){var t=this._condVal=Dr(e)?new RegExp(e):VMe(e)?e:null;if(t==null){var r="";os(r)}}return n.prototype.evaluate=function(e){var t=typeof e;return Dr(t)?this._condVal.test(e):Ps(t)?this._condVal.test(e+""):!1},n}(),F3e=function(){function n(){}return n.prototype.evaluate=function(){return this.value},n}(),N3e=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(!e[t].evaluate())return!1;return!0},n}(),z3e=function(){function n(){}return n.prototype.evaluate=function(){for(var e=this.children,t=0;t<e.length;t++)if(e[t].evaluate())return!0;return!1},n}(),U3e=function(){function n(){}return n.prototype.evaluate=function(){return!this.child.evaluate()},n}(),G3e=function(){function n(){}return n.prototype.evaluate=function(){for(var e=!!this.valueParser,t=this.getValue,r=t(this.valueGetterParam),i=e?this.valueParser(r):null,s=0;s<this.subCondList.length;s++)if(!this.subCondList[s].evaluate(e?i:r))return!1;return!0},n}();function i8(n,e){if(n===!0||n===!1){var t=new F3e;return t.value=n,t}var r="";return Kle(n)||os(r),n.and?sK("and",n,e):n.or?sK("or",n,e):n.not?V3e(n,e):H3e(n,e)}function sK(n,e,t){var r=e[n],i="";fr(r)||os(i),r.length||os(i);var s=n==="and"?new N3e:new z3e;return s.children=xr(r,function(o){return i8(o,t)}),s.children.length||os(i),s}function V3e(n,e){var t=n.not,r="";Kle(t)||os(r);var i=new U3e;return i.child=i8(t,e),i.child||os(r),i}function H3e(n,e){for(var t="",r=e.prepareGetValue(n),i=[],s=aa(n),o=n.parser,l=o?wae(o):null,a=0;a<s.length;a++){var h=s[a];if(!(h==="parser"||e.valueGetterAttrMap.get(h))){var f=Qm(iK,h)?iK[h]:h,p=n[h],v=l?l(p):p,y=KRe(f,v)||f==="reg"&&new O3e(v);y||os(t),i.push(y)}}i.length||os(t);var S=new G3e;return S.valueGetterParam=r,S.valueParser=l,S.getValue=e.getValue,S.subCondList=i,S}function Kle(n){return $r(n)&&!Pc(n)}var j3e=function(){function n(e,t){this._cond=i8(e,t)}return n.prototype.evaluate=function(){return this._cond.evaluate()},n}();function W3e(n,e){return new j3e(n,e)}var $3e={type:"echarts:filter",transform:function(n){for(var e=n.upstream,t,r=W3e(n.config,{valueGetterAttrMap:ii({dimension:!0}),prepareGetValue:function(l){var a="",h=l.dimension;Qm(l,"dimension")||os(a);var f=e.getDimensionInfo(h);return f||os(a),{dimIdx:f.index}},getValue:function(l){return e.retrieveValueFromItem(t,l.dimIdx)}}),i=[],s=0,o=e.count();s<o;s++)t=e.getRawDataItem(s),r.evaluate()&&i.push(t);return{data:i}}},X3e={type:"echarts:sort",transform:function(n){var e=n.upstream,t=n.config,r="",i=mo(t);i.length||os(r);var s=[];it(i,function(f){var p=f.dimension,v=f.order,y=f.parser,S=f.incomparable;if(p==null&&os(r),v!=="asc"&&v!=="desc"&&os(r),S&&S!=="min"&&S!=="max"){var C="";os(C)}if(v!=="asc"&&v!=="desc"){var M="";os(M)}var E=e.getDimensionInfo(p);E||os(r);var L=y?wae(y):null;y&&!L&&os(r),s.push({dimIdx:E.index,parser:L,comparator:new Aae(v,S)})});var o=e.sourceFormat;o!==Lc&&o!==Uh&&os(r);for(var l=[],a=0,h=e.count();a<h;a++)l.push(e.getRawDataItem(a));return l.sort(function(f,p){for(var v=0;v<s.length;v++){var y=s[v],S=e.retrieveValueFromItem(f,y.dimIdx),C=e.retrieveValueFromItem(p,y.dimIdx);y.parser&&(S=y.parser(S),C=y.parser(C));var M=y.comparator.evaluate(S,C);if(M!==0)return M}return 0}),{data:l}}};function q3e(n){n.registerTransform($3e),n.registerTransform(X3e)}var Z3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.prototype.init=function(t,r,i){n.prototype.init.call(this,t,r,i),this._sourceManager=new Cae(this),$q(this)},e.prototype.mergeOption=function(t,r){n.prototype.mergeOption.call(this,t,r),$q(this)},e.prototype.optionUpdated=function(){this._sourceManager.dirty()},e.prototype.getSourceManager=function(){return this._sourceManager},e.type="dataset",e.defaultOption={seriesLayoutBy:dp},e}(as),Y3e=function(n){Hn(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.type="dataset",t}return e.type="dataset",e}(Dc);function K3e(n){n.registerComponentModel(Z3e),n.registerComponentView(Y3e)}var Zd=tg.CMD;function Rb(n,e){return Math.abs(n-e)<1e-5}function b5(n){var e=n.data,t=n.len(),r=[],i,s=0,o=0,l=0,a=0;function h(Ee,Ie){i&&i.length>2&&r.push(i),i=[Ee,Ie]}function f(Ee,Ie,He,Re){Rb(Ee,He)&&Rb(Ie,Re)||i.push(Ee,Ie,He,Re,He,Re)}function p(Ee,Ie,He,Re,st,_e){var We=Math.abs(Ie-Ee),Ue=Math.tan(We/4)*4/3,vt=Ie<Ee?-1:1,xt=Math.cos(Ee),Vt=Math.sin(Ee),lt=Math.cos(Ie),Ht=Math.sin(Ie),Qt=xt*st+He,rn=Vt*_e+Re,jn=lt*st+He,Bn=Ht*_e+Re,Tn=st*Ue*vt,Le=_e*Ue*vt;i.push(Qt-Tn*Vt,rn+Le*xt,jn+Tn*Ht,Bn-Le*lt,jn,Bn)}for(var v,y,S,C,M=0;M<t;){var E=e[M++],L=M===1;switch(L&&(s=e[M],o=e[M+1],l=s,a=o,(E===Zd.L||E===Zd.C||E===Zd.Q)&&(i=[l,a])),E){case Zd.M:s=l=e[M++],o=a=e[M++],h(l,a);break;case Zd.L:v=e[M++],y=e[M++],f(s,o,v,y),s=v,o=y;break;case Zd.C:i.push(e[M++],e[M++],e[M++],e[M++],s=e[M++],o=e[M++]);break;case Zd.Q:v=e[M++],y=e[M++],S=e[M++],C=e[M++],i.push(s+2/3*(v-s),o+2/3*(y-o),S+2/3*(v-S),C+2/3*(y-C),S,C),s=S,o=C;break;case Zd.A:var k=e[M++],H=e[M++],X=e[M++],Z=e[M++],Q=e[M++],re=e[M++]+Q;M+=1;var ie=!e[M++];v=Math.cos(Q)*X+k,y=Math.sin(Q)*Z+H,L?(l=v,a=y,h(l,a)):f(s,o,v,y),s=Math.cos(re)*X+k,o=Math.sin(re)*Z+H;for(var oe=(ie?-1:1)*Math.PI/2,fe=Q;ie?fe>re:fe<re;fe+=oe){var Se=ie?Math.max(fe+oe,re):Math.min(fe+oe,re);p(fe,Se,k,H,X,Z)}break;case Zd.R:l=s=e[M++],a=o=e[M++],v=l+e[M++],y=a+e[M++],h(v,a),f(v,a,v,y),f(v,y,l,y),f(l,y,l,a),f(l,a,v,a);break;case Zd.Z:i&&f(s,o,l,a),s=l,o=a;break}}return i&&i.length>2&&r.push(i),r}function w5(n,e,t,r,i,s,o,l,a,h){if(Rb(n,t)&&Rb(e,r)&&Rb(i,o)&&Rb(s,l)){a.push(o,l);return}var f=2/h,p=f*f,v=o-n,y=l-e,S=Math.sqrt(v*v+y*y);v/=S,y/=S;var C=t-n,M=r-e,E=i-o,L=s-l,k=C*C+M*M,H=E*E+L*L;if(k<p&&H<p){a.push(o,l);return}var X=v*C+y*M,Z=-v*E-y*L,Q=k-X*X,re=H-Z*Z;if(Q<p&&X>=0&&re<p&&Z>=0){a.push(o,l);return}var ie=[],oe=[];_0(n,t,i,o,.5,ie),_0(e,r,s,l,.5,oe),w5(ie[0],oe[0],ie[1],oe[1],ie[2],oe[2],ie[3],oe[3],a,h),w5(ie[4],oe[4],ie[5],oe[5],ie[6],oe[6],ie[7],oe[7],a,h)}function J3e(n,e){var t=b5(n),r=[];e=e||1;for(var i=0;i<t.length;i++){var s=t[i],o=[],l=s[0],a=s[1];o.push(l,a);for(var h=2;h<s.length;){var f=s[h++],p=s[h++],v=s[h++],y=s[h++],S=s[h++],C=s[h++];w5(l,a,f,p,v,y,S,C,o,e),l=S,a=C}r.push(o)}return r}function Jle(n,e,t){var r=n[e],i=n[1-e],s=Math.abs(r/i),o=Math.ceil(Math.sqrt(s*t)),l=Math.floor(t/o);l===0&&(l=1,o=t);for(var a=[],h=0;h<o;h++)a.push(l);var f=o*l,p=t-f;if(p>0)for(var h=0;h<p;h++)a[h%o]+=1;return a}function aK(n,e,t){for(var r=n.r0,i=n.r,s=n.startAngle,o=n.endAngle,l=Math.abs(o-s),a=l*i,h=i-r,f=a>Math.abs(h),p=Jle([a,h],f?0:1,e),v=(f?l:h)/p.length,y=0;y<p.length;y++)for(var S=(f?h:l)/p[y],C=0;C<p[y];C++){var M={};f?(M.startAngle=s+v*y,M.endAngle=s+v*(y+1),M.r0=r+S*C,M.r=r+S*(C+1)):(M.startAngle=s+S*C,M.endAngle=s+S*(C+1),M.r0=r+v*y,M.r=r+v*(y+1)),M.clockwise=n.clockwise,M.cx=n.cx,M.cy=n.cy,t.push(M)}}function Q3e(n,e,t){for(var r=n.width,i=n.height,s=r>i,o=Jle([r,i],s?0:1,e),l=s?"width":"height",a=s?"height":"width",h=s?"x":"y",f=s?"y":"x",p=n[l]/o.length,v=0;v<o.length;v++)for(var y=n[a]/o[v],S=0;S<o[v];S++){var C={};C[h]=v*p,C[f]=S*y,C[l]=p,C[a]=y,C.x+=n.x,C.y+=n.y,t.push(C)}}function oK(n,e,t,r){return n*r-t*e}function eNe(n,e,t,r,i,s,o,l){var a=t-n,h=r-e,f=o-i,p=l-s,v=oK(f,p,a,h);if(Math.abs(v)<1e-6)return null;var y=n-i,S=e-s,C=oK(y,S,f,p)/v;return C<0||C>1?null:new Jr(C*a+n,C*h+e)}function tNe(n,e,t){var r=new Jr;Jr.sub(r,t,e),r.normalize();var i=new Jr;Jr.sub(i,n,e);var s=i.dot(r);return s}function W1(n,e){var t=n[n.length-1];t&&t[0]===e[0]&&t[1]===e[1]||n.push(e)}function nNe(n,e,t){for(var r=n.length,i=[],s=0;s<r;s++){var o=n[s],l=n[(s+1)%r],a=eNe(o[0],o[1],l[0],l[1],e.x,e.y,t.x,t.y);a&&i.push({projPt:tNe(a,e,t),pt:a,idx:s})}if(i.length<2)return[{points:n},{points:n}];i.sort(function(M,E){return M.projPt-E.projPt});var h=i[0],f=i[i.length-1];if(f.idx<h.idx){var p=h;h=f,f=p}for(var v=[h.pt.x,h.pt.y],y=[f.pt.x,f.pt.y],S=[v],C=[y],s=h.idx+1;s<=f.idx;s++)W1(S,n[s].slice());W1(S,y),W1(S,v);for(var s=f.idx+1;s<=h.idx+r;s++)W1(C,n[s%r].slice());return W1(C,v),W1(C,y),[{points:S},{points:C}]}function lK(n){var e=n.points,t=[],r=[];rse(e,t,r);var i=new cs(t[0],t[1],r[0]-t[0],r[1]-t[1]),s=i.width,o=i.height,l=i.x,a=i.y,h=new Jr,f=new Jr;return s>o?(h.x=f.x=l+s/2,h.y=a,f.y=a+o):(h.y=f.y=a+o/2,h.x=l,f.x=l+s),nNe(e,h,f)}function hL(n,e,t,r){if(t===1)r.push(e);else{var i=Math.floor(t/2),s=n(e);hL(n,s[0],i,r),hL(n,s[1],t-i,r)}return r}function rNe(n,e){for(var t=[],r=0;r<e;r++)t.push(sG(n));return t}function iNe(n,e){e.setStyle(n.style),e.z=n.z,e.z2=n.z2,e.zlevel=n.zlevel}function sNe(n){for(var e=[],t=0;t<n.length;)e.push([n[t++],n[t++]]);return e}function aNe(n,e){var t=[],r=n.shape,i;switch(n.type){case"rect":Q3e(r,e,t),i=Ha;break;case"sector":aK(r,e,t),i=Nh;break;case"circle":aK({r0:0,r:r.r,startAngle:0,endAngle:Math.PI*2,cx:r.cx,cy:r.cy},e,t),i=Nh;break;default:var s=n.getComputedTransform(),o=s?Math.sqrt(Math.max(s[0]*s[0]+s[1]*s[1],s[2]*s[2]+s[3]*s[3])):1,l=xr(J3e(n.getUpdatedPathProxy(),o),function(E){return sNe(E)}),a=l.length;if(a===0)hL(lK,{points:l[0]},e,t);else if(a===e)for(var h=0;h<a;h++)t.push({points:l[h]});else{var f=0,p=xr(l,function(E){var L=[],k=[];rse(E,L,k);var H=(k[1]-L[1])*(k[0]-L[0]);return f+=H,{poly:E,area:H}});p.sort(function(E,L){return L.area-E.area});for(var v=e,h=0;h<a;h++){var y=p[h];if(v<=0)break;var S=h===a-1?v:Math.ceil(y.area/f*e);S<0||(hL(lK,{points:y.poly},S,t),v-=S)}}i=eB;break}if(!i)return rNe(n,e);for(var C=[],h=0;h<t.length;h++){var M=new i;M.setShape(t[h]),iNe(n,M),C.push(M)}return C}function oNe(n,e){var t=n.length,r=e.length;if(t===r)return[n,e];for(var i=[],s=[],o=t<r?n:e,l=Math.min(t,r),a=Math.abs(r-t)/6,h=(l-2)/6,f=Math.ceil(a/h)+1,p=[o[0],o[1]],v=a,y=2;y<l;){var S=o[y-2],C=o[y-1],M=o[y++],E=o[y++],L=o[y++],k=o[y++],H=o[y++],X=o[y++];if(v<=0){p.push(M,E,L,k,H,X);continue}for(var Z=Math.min(v,f-1)+1,Q=1;Q<=Z;Q++){var re=Q/Z;_0(S,M,L,H,re,i),_0(C,E,k,X,re,s),S=i[3],C=s[3],p.push(i[1],s[1],i[2],s[2],S,C),M=i[5],E=s[5],L=i[6],k=s[6]}v-=Z-1}return o===n?[p,e]:[n,p]}function cK(n,e){for(var t=n.length,r=n[t-2],i=n[t-1],s=[],o=0;o<e.length;)s[o++]=r,s[o++]=i;return s}function lNe(n,e){for(var t,r,i,s=[],o=[],l=0;l<Math.max(n.length,e.length);l++){var a=n[l],h=e[l],f=void 0,p=void 0;a?h?(t=oNe(a,h),f=t[0],p=t[1],r=f,i=p):(p=cK(i||a,a),f=a):(f=cK(r||h,h),p=h),s.push(f),o.push(p)}return[s,o]}function uK(n){for(var e=0,t=0,r=0,i=n.length,s=0,o=i-2;s<i;o=s,s+=2){var l=n[o],a=n[o+1],h=n[s],f=n[s+1],p=l*f-h*a;e+=p,t+=(l+h)*p,r+=(a+f)*p}return e===0?[n[0]||0,n[1]||0]:[t/e/3,r/e/3,e]}function cNe(n,e,t,r){for(var i=(n.length-2)/6,s=1/0,o=0,l=n.length,a=l-2,h=0;h<i;h++){for(var f=h*6,p=0,v=0;v<l;v+=2){var y=v===0?f:(f+v-2)%a+2,S=n[y]-t[0],C=n[y+1]-t[1],M=e[v]-r[0],E=e[v+1]-r[1],L=M-S,k=E-C;p+=L*L+k*k}p<s&&(s=p,o=h)}return o}function uNe(n){for(var e=[],t=n.length,r=0;r<t;r+=2)e[r]=n[t-r-2],e[r+1]=n[t-r-1];return e}function hNe(n,e,t,r){for(var i=[],s,o=0;o<n.length;o++){var l=n[o],a=e[o],h=uK(l),f=uK(a);s==null&&(s=h[2]<0!=f[2]<0);var p=[],v=[],y=0,S=1/0,C=[],M=l.length;s&&(l=uNe(l));for(var E=cNe(l,a,h,f)*6,L=M-2,k=0;k<L;k+=2){var H=(E+k)%L+2;p[k+2]=l[H]-h[0],p[k+3]=l[H+1]-h[1]}p[0]=l[E]-h[0],p[1]=l[E+1]-h[1];for(var X=r/t,Z=-r/2;Z<=r/2;Z+=X){for(var Q=Math.sin(Z),re=Math.cos(Z),ie=0,k=0;k<l.length;k+=2){var oe=p[k],fe=p[k+1],Se=a[k]-f[0],Ee=a[k+1]-f[1],Ie=Se*re-Ee*Q,He=Se*Q+Ee*re;C[k]=Ie,C[k+1]=He;var Re=Ie-oe,st=He-fe;ie+=Re*Re+st*st}if(ie<S){S=ie,y=Z;for(var _e=0;_e<C.length;_e++)v[_e]=C[_e]}}i.push({from:p,to:v,fromCp:h,toCp:f,rotation:-y})}return i}function fL(n){return n.__isCombineMorphing}var Qle="__mOriginal_";function dL(n,e,t){var r=Qle+e,i=n[r]||n[e];n[r]||(n[r]=n[e]);var s=t.replace,o=t.after,l=t.before;n[e]=function(){var a=arguments,h;return l&&l.apply(this,a),s?h=s.apply(this,a):h=i.apply(this,a),o&&o.apply(this,a),h}}function AT(n,e){var t=Qle+e;n[t]&&(n[e]=n[t],n[t]=null)}function hK(n,e){for(var t=0;t<n.length;t++)for(var r=n[t],i=0;i<r.length;){var s=r[i],o=r[i+1];r[i++]=e[0]*s+e[2]*o+e[4],r[i++]=e[1]*s+e[3]*o+e[5]}}function ece(n,e){var t=n.getUpdatedPathProxy(),r=e.getUpdatedPathProxy(),i=lNe(b5(t),b5(r)),s=i[0],o=i[1],l=n.getComputedTransform(),a=e.getComputedTransform();function h(){this.transform=null}l&&hK(s,l),a&&hK(o,a),dL(e,"updateTransform",{replace:h}),e.transform=null;var f=hNe(s,o,10,Math.PI),p=[];dL(e,"buildPath",{replace:function(v){for(var y=e.__morphT,S=1-y,C=[],M=0;M<f.length;M++){var E=f[M],L=E.from,k=E.to,H=E.rotation*y,X=E.fromCp,Z=E.toCp,Q=Math.sin(H),re=Math.cos(H);iR(C,X,Z,y);for(var ie=0;ie<L.length;ie+=2){var oe=L[ie],fe=L[ie+1],Se=k[ie],Ee=k[ie+1],Ie=oe*S+Se*y,He=fe*S+Ee*y;p[ie]=Ie*re-He*Q+C[0],p[ie+1]=Ie*Q+He*re+C[1]}var Re=p[0],st=p[1];v.moveTo(Re,st);for(var ie=2;ie<L.length;){var Se=p[ie++],Ee=p[ie++],_e=p[ie++],We=p[ie++],Ue=p[ie++],vt=p[ie++];Re===Se&&st===Ee&&_e===Ue&&We===vt?v.lineTo(Ue,vt):v.bezierCurveTo(Se,Ee,_e,We,Ue,vt),Re=Ue,st=vt}}}})}function s8(n,e,t){if(!n||!e)return e;var r=t.done,i=t.during;ece(n,e),e.__morphT=0;function s(){AT(e,"buildPath"),AT(e,"updateTransform"),e.__morphT=-1,e.createPathProxy(),e.dirtyShape()}return e.animateTo({__morphT:1},ti({during:function(o){e.dirtyShape(),i&&i(o)},done:function(){s(),r&&r()}},t)),e}function fNe(n,e,t,r,i,s){var o=16;n=i===t?0:Math.round(32767*(n-t)/(i-t)),e=s===r?0:Math.round(32767*(e-r)/(s-r));for(var l=0,a,h=(1<<o)/2;h>0;h/=2){var f=0,p=0;(n&h)>0&&(f=1),(e&h)>0&&(p=1),l+=h*h*(3*f^p),p===0&&(f===1&&(n=h-1-n,e=h-1-e),a=n,n=e,e=a)}return l}function pL(n){var e=1/0,t=1/0,r=-1/0,i=-1/0,s=xr(n,function(l){var a=l.getBoundingRect(),h=l.getComputedTransform(),f=a.x+a.width/2+(h?h[4]:0),p=a.y+a.height/2+(h?h[5]:0);return e=Math.min(f,e),t=Math.min(p,t),r=Math.max(f,r),i=Math.max(p,i),[f,p]}),o=xr(s,function(l,a){return{cp:l,z:fNe(l[0],l[1],e,t,r,i),path:n[a]}});return o.sort(function(l,a){return l.z-a.z}).map(function(l){return l.path})}function tce(n){return aNe(n.path,n.count)}function S5(){return{fromIndividuals:[],toIndividuals:[],count:0}}function dNe(n,e,t){var r=[];function i(X){for(var Z=0;Z<X.length;Z++){var Q=X[Z];fL(Q)?i(Q.childrenRef()):Q instanceof qi&&r.push(Q)}}i(n);var s=r.length;if(!s)return S5();var o=t.dividePath||tce,l=o({path:e,count:s});if(l.length!==s)return console.error("Invalid morphing: unmatched splitted path"),S5();r=pL(r),l=pL(l);for(var a=t.done,h=t.during,f=t.individualDelay,p=new mE,v=0;v<s;v++){var y=r[v],S=l[v];S.parent=e,S.copyTransform(p),f||ece(y,S)}e.__isCombineMorphing=!0,e.childrenRef=function(){return l};function C(X){for(var Z=0;Z<l.length;Z++)l[Z].addSelfToZr(X)}dL(e,"addSelfToZr",{after:function(X){C(X)}}),dL(e,"removeSelfFromZr",{after:function(X){for(var Z=0;Z<l.length;Z++)l[Z].removeSelfFromZr(X)}});function M(){e.__isCombineMorphing=!1,e.__morphT=-1,e.childrenRef=null,AT(e,"addSelfToZr"),AT(e,"removeSelfFromZr")}var E=l.length;if(f)for(var L=E,k=function(){L--,L===0&&(M(),a&&a())},v=0;v<E;v++){var H=f?ti({delay:(t.delay||0)+f(v,E,r[v],l[v]),done:k},t):t;s8(r[v],l[v],H)}else e.__morphT=0,e.animateTo({__morphT:1},ti({during:function(X){for(var Z=0;Z<E;Z++){var Q=l[Z];Q.__morphT=e.__morphT,Q.dirtyShape()}h&&h(X)},done:function(){M();for(var X=0;X<n.length;X++)AT(n[X],"updateTransform");a&&a()}},t));return e.__zr&&C(e.__zr),{fromIndividuals:r,toIndividuals:l,count:E}}function pNe(n,e,t){var r=e.length,i=[],s=t.dividePath||tce;function o(y){for(var S=0;S<y.length;S++){var C=y[S];fL(C)?o(C.childrenRef()):C instanceof qi&&i.push(C)}}if(fL(n)){o(n.childrenRef());var l=i.length;if(l<r)for(var a=0,h=l;h<r;h++)i.push(sG(i[a++%l]));i.length=r}else{i=s({path:n,count:r});for(var f=n.getComputedTransform(),h=0;h<i.length;h++)i[h].setLocalTransform(f);if(i.length!==r)return console.error("Invalid morphing: unmatched splitted path"),S5()}i=pL(i),e=pL(e);for(var p=t.individualDelay,h=0;h<r;h++){var v=p?ti({delay:(t.delay||0)+p(h,r,i[h],e[h])},t):t;s8(i[h],e[h],v)}return{fromIndividuals:i,toIndividuals:e,count:e.length}}function fK(n){return fr(n[0])}function dK(n,e){for(var t=[],r=n.length,i=0;i<r;i++)t.push({one:n[i],many:[]});for(var i=0;i<e.length;i++){var s=e[i].length,o=void 0;for(o=0;o<s;o++)t[o%r].many.push(e[i][o])}for(var l=0,i=r-1;i>=0;i--)if(!t[i].many.length){var a=t[l].many;if(a.length<=1)if(l)l=0;else return t;var s=a.length,h=Math.ceil(s/2);t[i].many=a.slice(h,s),t[l].many=a.slice(0,h),l++}return t}var mNe={clone:function(n){for(var e=[],t=1-Math.pow(1-n.path.style.opacity,1/n.count),r=0;r<n.count;r++){var i=sG(n.path);i.setStyle("opacity",t),e.push(i)}return e},split:null};function J3(n,e,t,r,i,s){if(!n.length||!e.length)return;var o=nB("update",r,i);if(!(o&&o.duration>0))return;var l=r.getModel("universalTransition").get("delay"),a=Object.assign({setToFinal:!0},o),h,f;fK(n)&&(h=n,f=e),fK(e)&&(h=e,f=n);function p(E,L,k,H,X){var Z=E.many,Q=E.one;if(Z.length===1&&!X){var re=L?Z[0]:Q,ie=L?Q:Z[0];if(fL(re))p({many:[re],one:ie},!0,k,H,!0);else{var oe=l?ti({delay:l(k,H)},a):a;s8(re,ie,oe),s(re,ie,re,ie,oe)}}else for(var fe=ti({dividePath:mNe[t],individualDelay:l&&function(st,_e,We,Ue){return l(st+k,H)}},a),Se=L?dNe(Z,Q,fe):pNe(Q,Z,fe),Ee=Se.fromIndividuals,Ie=Se.toIndividuals,He=Ee.length,Re=0;Re<He;Re++){var oe=l?ti({delay:l(Re,He)},a):a;s(Ee[Re],Ie[Re],L?Z[Re]:E.one,L?E.one:Z[Re],oe)}}for(var v=h?h===n:n.length>e.length,y=h?dK(f,h):dK(v?e:n,[v?n:e]),S=0,C=0;C<y.length;C++)S+=y[C].many.length;for(var M=0,C=0;C<y.length;C++)p(y[C],v,M,S),M+=y[C].many.length}function py(n){if(!n)return[];if(fr(n)){for(var e=[],t=0;t<n.length;t++)e.push(py(n[t]));return e}var r=[];return n.traverse(function(i){i instanceof qi&&!i.disableMorphing&&!i.invisible&&!i.ignore&&r.push(i)}),r}var nce=1e4,gNe=0,pK=1,mK=2,vNe=qs();function _Ne(n,e){for(var t=n.dimensions,r=0;r<t.length;r++){var i=n.getDimensionInfo(t[r]);if(i&&i.otherDims[e]===0)return t[r]}}function yNe(n,e,t){var r=n.getDimensionInfo(t),i=r&&r.ordinalMeta;if(r){var s=n.get(r.name,e);return i&&i.categories[s]||s+""}}function gK(n,e,t,r){var i=r?"itemChildGroupId":"itemGroupId",s=_Ne(n,i);if(s){var o=yNe(n,e,s);return o}var l=n.getRawDataItem(e),a=r?"childGroupId":"groupId";if(l&&l[a])return l[a]+"";if(!r)return t||n.getId(e)}function vK(n){var e=[];return it(n,function(t){var r=t.data,i=t.dataGroupId;if(!(r.count()>nce))for(var s=r.getIndices(),o=0;o<s.length;o++)e.push({data:r,groupId:gK(r,o,i,!1),childGroupId:gK(r,o,i,!0),divide:t.divide,dataIndex:o})}),e}function Q3(n,e,t){n.traverse(function(r){r instanceof qi&&Yl(r,{style:{opacity:0}},e,{dataIndex:t,isFrom:!0})})}function eN(n){if(n.parent){var e=n.getComputedTransform();n.setLocalTransform(e),n.parent.remove(n)}}function $1(n){n.stopAnimation(),n.isGroup&&n.traverse(function(e){e.stopAnimation()})}function xNe(n,e,t){var r=nB("update",t,e);r&&n.traverse(function(i){if(i instanceof Dw){var s=TIe(i);s&&i.animateFrom({style:s},r)}})}function bNe(n,e){var t=n.length;if(t!==e.length)return!1;for(var r=0;r<t;r++){var i=n[r],s=e[r];if(i.data.getId(i.dataIndex)!==s.data.getId(s.dataIndex))return!1}return!0}function rce(n,e,t){var r=vK(n),i=vK(e);function s(k,H,X,Z,Q){(X||k)&&H.animateFrom({style:X&&X!==k?Jn(Jn({},X.style),k.style):k.style},Q)}var o=!1,l=gNe,a=ii(),h=ii();r.forEach(function(k){k.groupId&&a.set(k.groupId,!0),k.childGroupId&&h.set(k.childGroupId,!0)});for(var f=0;f<i.length;f++){var p=i[f].groupId;if(h.get(p)){l=pK;break}var v=i[f].childGroupId;if(v&&a.get(v)){l=mK;break}}function y(k,H){return function(X){var Z=X.data,Q=X.dataIndex;return H?Z.getId(Q):k?l===pK?X.childGroupId:X.groupId:l===mK?X.childGroupId:X.groupId}}var S=bNe(r,i),C={};if(!S)for(var f=0;f<i.length;f++){var M=i[f],E=M.data.getItemGraphicEl(M.dataIndex);E&&(C[E.id]=!0)}function L(k,H){var X=r[H],Z=i[k],Q=Z.data.hostModel,re=X.data.getItemGraphicEl(X.dataIndex),ie=Z.data.getItemGraphicEl(Z.dataIndex);if(re===ie){ie&&xNe(ie,Z.dataIndex,Q);return}re&&C[re.id]||ie&&($1(ie),re?($1(re),eN(re),o=!0,J3(py(re),py(ie),Z.divide,Q,k,s)):Q3(ie,Q,k))}new TM(r,i,y(!0,S),y(!1,S),null,"multiple").update(L).updateManyToOne(function(k,H){var X=i[k],Z=X.data,Q=Z.hostModel,re=Z.getItemGraphicEl(X.dataIndex),ie=no(xr(H,function(oe){return r[oe].data.getItemGraphicEl(r[oe].dataIndex)}),function(oe){return oe&&oe!==re&&!C[oe.id]});re&&($1(re),ie.length?(it(ie,function(oe){$1(oe),eN(oe)}),o=!0,J3(py(ie),py(re),X.divide,Q,k,s)):Q3(re,Q,X.dataIndex))}).updateOneToMany(function(k,H){var X=r[H],Z=X.data.getItemGraphicEl(X.dataIndex);if(!(Z&&C[Z.id])){var Q=no(xr(k,function(ie){return i[ie].data.getItemGraphicEl(i[ie].dataIndex)}),function(ie){return ie&&ie!==Z}),re=i[k[0]].data.hostModel;Q.length&&(it(Q,function(ie){return $1(ie)}),Z?($1(Z),eN(Z),o=!0,J3(py(Z),py(Q),X.divide,re,k[0],s)):it(Q,function(ie){return Q3(ie,re,k[0])}))}}).updateManyToMany(function(k,H){new TM(H,k,function(X){return r[X].data.getId(r[X].dataIndex)},function(X){return i[X].data.getId(i[X].dataIndex)}).update(function(X,Z){L(k[X],H[Z])}).execute()}).execute(),o&&it(e,function(k){var H=k.data,X=H.hostModel,Z=X&&t.getViewOfSeriesModel(X),Q=nB("update",X,0);Z&&X.isAnimationEnabled()&&Q&&Q.duration>0&&Z.group.traverse(function(re){re instanceof qi&&!re.animators.length&&re.animateFrom({style:{opacity:0}},Q)})})}function _K(n){var e=n.getModel("universalTransition").get("seriesKey");return e||n.id}function yK(n){return fr(n)?n.sort().join(","):n}function kv(n){if(n.hostModel)return n.hostModel.getModel("universalTransition").get("divideShape")}function wNe(n,e){var t=ii(),r=ii(),i=ii();return it(n.oldSeries,function(s,o){var l=n.oldDataGroupIds[o],a=n.oldData[o],h=_K(s),f=yK(h);r.set(f,{dataGroupId:l,data:a}),fr(h)&&it(h,function(p){i.set(p,{key:f,dataGroupId:l,data:a})})}),it(e.updatedSeries,function(s){if(s.isUniversalTransitionEnabled()&&s.isAnimationEnabled()){var o=s.get("dataGroupId"),l=s.getData(),a=_K(s),h=yK(a),f=r.get(h);if(f)t.set(h,{oldSeries:[{dataGroupId:f.dataGroupId,divide:kv(f.data),data:f.data}],newSeries:[{dataGroupId:o,divide:kv(l),data:l}]});else if(fr(a)){var p=[];it(a,function(S){var C=r.get(S);C.data&&p.push({dataGroupId:C.dataGroupId,divide:kv(C.data),data:C.data})}),p.length&&t.set(h,{oldSeries:p,newSeries:[{dataGroupId:o,data:l,divide:kv(l)}]})}else{var v=i.get(a);if(v){var y=t.get(v.key);y||(y={oldSeries:[{dataGroupId:v.dataGroupId,data:v.data,divide:kv(v.data)}],newSeries:[]},t.set(v.key,y)),y.newSeries.push({dataGroupId:o,data:l,divide:kv(l)})}}}}),t}function xK(n,e){for(var t=0;t<n.length;t++){var r=e.seriesIndex!=null&&e.seriesIndex===n[t].seriesIndex||e.seriesId!=null&&e.seriesId===n[t].id;if(r)return t}}function SNe(n,e,t,r){var i=[],s=[];it(mo(n.from),function(o){var l=xK(e.oldSeries,o);l>=0&&i.push({dataGroupId:e.oldDataGroupIds[l],data:e.oldData[l],divide:kv(e.oldData[l]),groupIdDim:o.dimension})}),it(mo(n.to),function(o){var l=xK(t.updatedSeries,o);if(l>=0){var a=t.updatedSeries[l].getData();s.push({dataGroupId:e.oldDataGroupIds[l],data:a,divide:kv(a),groupIdDim:o.dimension})}}),i.length>0&&s.length>0&&rce(i,s,r)}function ANe(n){n.registerUpdateLifecycle("series:beforeupdate",function(e,t,r){it(mo(r.seriesTransition),function(i){it(mo(i.to),function(s){for(var o=r.updatedSeries,l=0;l<o.length;l++)(s.seriesIndex!=null&&s.seriesIndex===o[l].seriesIndex||s.seriesId!=null&&s.seriesId===o[l].id)&&(o[l][gR]=!0)})})}),n.registerUpdateLifecycle("series:transition",function(e,t,r){var i=vNe(t);if(i.oldSeries&&r.updatedSeries&&r.optionChanged){var s=r.seriesTransition;if(s)it(mo(s),function(y){SNe(y,i,r,t)});else{var o=wNe(i,r);it(o.keys(),function(y){var S=o.get(y);rce(S.oldSeries,S.newSeries,t)})}it(r.updatedSeries,function(y){y[gR]&&(y[gR]=!1)})}for(var l=e.getSeries(),a=i.oldSeries=[],h=i.oldDataGroupIds=[],f=i.oldData=[],p=0;p<l.length;p++){var v=l[p].getData();v.count()<nce&&(a.push(l[p]),h.push(l[p].get("dataGroupId")),f.push(v))}})}function bK(n,e,t){var r=Rw.createCanvas(),i=e.getWidth(),s=e.getHeight(),o=r.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=i+"px",o.height=s+"px",r.setAttribute("data-zr-dom-id",n)),r.width=i*t,r.height=s*t,r}var tN=function(n){Hn(e,n);function e(t,r,i){var s=n.call(this)||this;s.motionBlur=!1,s.lastFrameAlpha=.7,s.dpr=1,s.virtual=!1,s.config={},s.incremental=!1,s.zlevel=0,s.maxRepaintRectCount=5,s.__dirty=!0,s.__firstTimePaint=!0,s.__used=!1,s.__drawIndex=0,s.__startIndex=0,s.__endIndex=0,s.__prevStartIndex=null,s.__prevEndIndex=null;var o;i=i||GP,typeof t=="string"?o=bK(t,r,i):$r(t)&&(o=t,t=o.id),s.id=t,s.dom=o;var l=o.style;return l&&(yie(o),o.onselectstart=function(){return!1},l.padding="0",l.margin="0",l.borderWidth="0"),s.painter=r,s.dpr=i,s}return e.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},e.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},e.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},e.prototype.setUnpainted=function(){this.__firstTimePaint=!0},e.prototype.createBackBuffer=function(){var t=this.dpr;this.domBack=bK("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),t!==1&&this.ctxBack.scale(t,t)},e.prototype.createRepaintRects=function(t,r,i,s){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var o=[],l=this.maxRepaintRectCount,a=!1,h=new cs(0,0,0,0);function f(L){if(!(!L.isFinite()||L.isZero()))if(o.length===0){var k=new cs(0,0,0,0);k.copy(L),o.push(k)}else{for(var H=!1,X=1/0,Z=0,Q=0;Q<o.length;++Q){var re=o[Q];if(re.intersect(L)){var ie=new cs(0,0,0,0);ie.copy(re),ie.union(L),o[Q]=ie,H=!0;break}else if(a){h.copy(L),h.union(re);var oe=L.width*L.height,fe=re.width*re.height,Se=h.width*h.height,Ee=Se-oe-fe;Ee<X&&(X=Ee,Z=Q)}}if(a&&(o[Z].union(L),H=!0),!H){var k=new cs(0,0,0,0);k.copy(L),o.push(k)}a||(a=o.length>=l)}}for(var p=this.__startIndex;p<this.__endIndex;++p){var v=t[p];if(v){var y=v.shouldBePainted(i,s,!0,!0),S=v.__isRendered&&(v.__dirty&Bu||!y)?v.getPrevPaintRect():null;S&&f(S);var C=y&&(v.__dirty&Bu||!v.__isRendered)?v.getPaintRect():null;C&&f(C)}}for(var p=this.__prevStartIndex;p<this.__prevEndIndex;++p){var v=r[p],y=v&&v.shouldBePainted(i,s,!0,!0);if(v&&(!y||!v.__zr)&&v.__isRendered){var S=v.getPrevPaintRect();S&&f(S)}}var M;do{M=!1;for(var p=0;p<o.length;){if(o[p].isZero()){o.splice(p,1);continue}for(var E=p+1;E<o.length;)o[p].intersect(o[E])?(M=!0,o[p].union(o[E]),o.splice(E,1)):E++;p++}}while(M);return this._paintRects=o,o},e.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},e.prototype.resize=function(t,r){var i=this.dpr,s=this.dom,o=s.style,l=this.domBack;o&&(o.width=t+"px",o.height=r+"px"),s.width=t*i,s.height=r*i,l&&(l.width=t*i,l.height=r*i,i!==1&&this.ctxBack.scale(i,i))},e.prototype.clear=function(t,r,i){var s=this.dom,o=this.ctx,l=s.width,a=s.height;r=r||this.clearColor;var h=this.motionBlur&&!t,f=this.lastFrameAlpha,p=this.dpr,v=this;h&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(s,0,0,l/p,a/p));var y=this.domBack;function S(C,M,E,L){if(o.clearRect(C,M,E,L),r&&r!=="transparent"){var k=void 0;if(GD(r)){var H=r.global||r.__width===E&&r.__height===L;k=H&&r.__canvasGradient||Xz(o,r,{x:0,y:0,width:E,height:L}),r.__canvasGradient=k,r.__width=E,r.__height=L}else GMe(r)&&(r.scaleX=r.scaleX||p,r.scaleY=r.scaleY||p,k=qz(o,r,{dirty:function(){v.setUnpainted(),v.painter.refresh()}}));o.save(),o.fillStyle=k||r,o.fillRect(C,M,E,L),o.restore()}h&&(o.save(),o.globalAlpha=f,o.drawImage(y,C,M,E,L),o.restore())}!i||h?S(0,0,l,a):i.length&&it(i,function(C){S(C.x*p,C.y*p,C.width*p,C.height*p)})},e}(ld),wK=1e5,ry=314159,MI=.01,TNe=.001;function MNe(n){return n?n.__builtin__?!0:!(typeof n.resize!="function"||typeof n.refresh!="function"):!1}function ENe(n,e){var t=document.createElement("div");return t.style.cssText=["position:relative","width:"+n+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",t}var CNe=function(){function n(e,t,r,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var s=!e.nodeName||e.nodeName.toUpperCase()==="CANVAS";this._opts=r=Jn({},r||{}),this.dpr=r.devicePixelRatio||GP,this._singleCanvas=s,this.root=e;var o=e.style;o&&(yie(e),e.innerHTML=""),this.storage=t;var l=this._zlevelList;this._prevDisplayList=[];var a=this._layers;if(s){var f=e,p=f.width,v=f.height;r.width!=null&&(p=r.width),r.height!=null&&(v=r.height),this.dpr=r.devicePixelRatio||1,f.width=p*this.dpr,f.height=v*this.dpr,this._width=p,this._height=v;var y=new tN(f,this,this.dpr);y.__builtin__=!0,y.initContext(),a[ry]=y,y.zlevel=ry,l.push(ry),this._domRoot=e}else{this._width=lI(e,0,r),this._height=lI(e,1,r);var h=this._domRoot=ENe(this._width,this._height);e.appendChild(h)}}return n.prototype.getType=function(){return"canvas"},n.prototype.isSingleCanvas=function(){return this._singleCanvas},n.prototype.getViewportRoot=function(){return this._domRoot},n.prototype.getViewportRootOffset=function(){var e=this.getViewportRoot();if(e)return{offsetLeft:e.offsetLeft||0,offsetTop:e.offsetTop||0}},n.prototype.refresh=function(e){var t=this.storage.getDisplayList(!0),r=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(t,r,e,this._redrawId);for(var s=0;s<i.length;s++){var o=i[s],l=this._layers[o];if(!l.__builtin__&&l.refresh){var a=s===0?this._backgroundColor:null;l.refresh(a)}}return this._opts.useDirtyRect&&(this._prevDisplayList=t.slice()),this},n.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},n.prototype._paintHoverList=function(e){var t=e.length,r=this._hoverlayer;if(r&&r.clear(),!!t){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},s,o=0;o<t;o++){var l=e[o];l.__inHover&&(r||(r=this._hoverlayer=this.getLayer(wK)),s||(s=r.ctx,s.save()),Ry(s,l,i,o===t-1))}s&&s.restore()}},n.prototype.getHoverLayer=function(){return this.getLayer(wK)},n.prototype.paintOne=function(e,t){qae(e,t)},n.prototype._paintList=function(e,t,r,i){if(this._redrawId===i){r=r||!1,this._updateLayerStatus(e);var s=this._doPaintList(e,t,r),o=s.finished,l=s.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),l&&this._paintHoverList(e),o)this.eachLayer(function(h){h.afterBrush&&h.afterBrush()});else{var a=this;OP(function(){a._paintList(e,t,r,i)})}}},n.prototype._compositeManually=function(){var e=this.getLayer(ry).ctx,t=this._domRoot.width,r=this._domRoot.height;e.clearRect(0,0,t,r),this.eachBuiltinLayer(function(i){i.virtual&&e.drawImage(i.dom,0,0,t,r)})},n.prototype._doPaintList=function(e,t,r){for(var i=this,s=[],o=this._opts.useDirtyRect,l=0;l<this._zlevelList.length;l++){var a=this._zlevelList[l],h=this._layers[a];h.__builtin__&&h!==this._hoverlayer&&(h.__dirty||r)&&s.push(h)}for(var f=!0,p=!1,v=function(C){var M=s[C],E=M.ctx,L=o&&M.createRepaintRects(e,t,y._width,y._height),k=r?M.__startIndex:M.__drawIndex,H=!r&&M.incremental&&Date.now,X=H&&Date.now(),Z=M.zlevel===y._zlevelList[0]?y._backgroundColor:null;if(M.__startIndex===M.__endIndex)M.clear(!1,Z,L);else if(k===M.__startIndex){var Q=e[k];(!Q.incremental||!Q.notClear||r)&&M.clear(!1,Z,L)}k===-1&&(console.error("For some unknown reason. drawIndex is -1"),k=M.__startIndex);var re,ie=function(Ee){var Ie={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(re=k;re<M.__endIndex;re++){var He=e[re];if(He.__inHover&&(p=!0),i._doPaintEl(He,M,o,Ee,Ie,re===M.__endIndex-1),H){var Re=Date.now()-X;if(Re>15)break}}Ie.prevElClipPaths&&E.restore()};if(L)if(L.length===0)re=M.__endIndex;else for(var oe=y.dpr,fe=0;fe<L.length;++fe){var Se=L[fe];E.save(),E.beginPath(),E.rect(Se.x*oe,Se.y*oe,Se.width*oe,Se.height*oe),E.clip(),ie(Se),E.restore()}else E.save(),ie(),E.restore();M.__drawIndex=re,M.__drawIndex<M.__endIndex&&(f=!1)},y=this,S=0;S<s.length;S++)v(S);return gi.wxa&&it(this._layers,function(C){C&&C.ctx&&C.ctx.draw&&C.ctx.draw()}),{finished:f,needsRefreshHover:p}},n.prototype._doPaintEl=function(e,t,r,i,s,o){var l=t.ctx;if(r){var a=e.getPaintRect();(!i||a&&a.intersect(i))&&(Ry(l,e,s,o),e.setPrevPaintRect(a))}else Ry(l,e,s,o)},n.prototype.getLayer=function(e,t){this._singleCanvas&&!this._needsManuallyCompositing&&(e=ry);var r=this._layers[e];return r||(r=new tN("zr_"+e,this,this.dpr),r.zlevel=e,r.__builtin__=!0,this._layerConfig[e]?Bi(r,this._layerConfig[e],!0):this._layerConfig[e-MI]&&Bi(r,this._layerConfig[e-MI],!0),t&&(r.virtual=t),this.insertLayer(e,r),r.initContext()),r},n.prototype.insertLayer=function(e,t){var r=this._layers,i=this._zlevelList,s=i.length,o=this._domRoot,l=null,a=-1;if(!r[e]&&MNe(t)){if(s>0&&e>i[0]){for(a=0;a<s-1&&!(i[a]<e&&i[a+1]>e);a++);l=r[i[a]]}if(i.splice(a+1,0,e),r[e]=t,!t.virtual)if(l){var h=l.dom;h.nextSibling?o.insertBefore(t.dom,h.nextSibling):o.appendChild(t.dom)}else o.firstChild?o.insertBefore(t.dom,o.firstChild):o.appendChild(t.dom);t.painter||(t.painter=this)}},n.prototype.eachLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var s=r[i];e.call(t,this._layers[s],s)}},n.prototype.eachBuiltinLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var s=r[i],o=this._layers[s];o.__builtin__&&e.call(t,o,s)}},n.prototype.eachOtherLayer=function(e,t){for(var r=this._zlevelList,i=0;i<r.length;i++){var s=r[i],o=this._layers[s];o.__builtin__||e.call(t,o,s)}},n.prototype.getLayers=function(){return this._layers},n.prototype._updateLayerStatus=function(e){this.eachBuiltinLayer(function(p,v){p.__dirty=p.__used=!1});function t(p){s&&(s.__endIndex!==p&&(s.__dirty=!0),s.__endIndex=p)}if(this._singleCanvas)for(var r=1;r<e.length;r++){var i=e[r];if(i.zlevel!==e[r-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var s=null,o=0,l,a;for(a=0;a<e.length;a++){var i=e[a],h=i.zlevel,f=void 0;l!==h&&(l=h,o=0),i.incremental?(f=this.getLayer(h+TNe,this._needsManuallyCompositing),f.incremental=!0,o=1):f=this.getLayer(h+(o>0?MI:0),this._needsManuallyCompositing),f.__builtin__||W6("ZLevel "+h+" has been used by unkown layer "+f.id),f!==s&&(f.__used=!0,f.__startIndex!==a&&(f.__dirty=!0),f.__startIndex=a,f.incremental?f.__drawIndex=-1:f.__drawIndex=a,t(a),s=f),i.__dirty&Bu&&!i.__inHover&&(f.__dirty=!0,f.incremental&&f.__drawIndex<0&&(f.__drawIndex=a))}t(a),this.eachBuiltinLayer(function(p,v){!p.__used&&p.getElementCount()>0&&(p.__dirty=!0,p.__startIndex=p.__endIndex=p.__drawIndex=0),p.__dirty&&p.__drawIndex<0&&(p.__drawIndex=p.__startIndex)})},n.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},n.prototype._clearLayer=function(e){e.clear()},n.prototype.setBackgroundColor=function(e){this._backgroundColor=e,it(this._layers,function(t){t.setUnpainted()})},n.prototype.configLayer=function(e,t){if(t){var r=this._layerConfig;r[e]?Bi(r[e],t,!0):r[e]=t;for(var i=0;i<this._zlevelList.length;i++){var s=this._zlevelList[i];if(s===e||s===e+MI){var o=this._layers[s];Bi(o,r[e],!0)}}}},n.prototype.delLayer=function(e){var t=this._layers,r=this._zlevelList,i=t[e];i&&(i.dom.parentNode.removeChild(i.dom),delete t[e],r.splice(Xi(r,e),1))},n.prototype.resize=function(e,t){if(this._domRoot.style){var r=this._domRoot;r.style.display="none";var i=this._opts,s=this.root;if(e!=null&&(i.width=e),t!=null&&(i.height=t),e=lI(s,0,i),t=lI(s,1,i),r.style.display="",this._width!==e||t!==this._height){r.style.width=e+"px",r.style.height=t+"px";for(var o in this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(e,t);this.refresh(!0)}this._width=e,this._height=t}else{if(e==null||t==null)return;this._width=e,this._height=t,this.getLayer(ry).resize(e,t)}return this},n.prototype.clearLayer=function(e){var t=this._layers[e];t&&t.clear()},n.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},n.prototype.getRenderedCanvas=function(e){if(e=e||{},this._singleCanvas&&!this._compositeManually)return this._layers[ry].dom;var t=new tN("image",this,e.pixelRatio||this.dpr);t.initContext(),t.clear(!1,e.backgroundColor||this._backgroundColor);var r=t.ctx;if(e.pixelRatio<=this.dpr){this.refresh();var i=t.dom.width,s=t.dom.height;this.eachLayer(function(p){p.__builtin__?r.drawImage(p.dom,0,0,i,s):p.renderToCanvas&&(r.save(),p.renderToCanvas(r),r.restore())})}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},l=this.storage.getDisplayList(!0),a=0,h=l.length;a<h;a++){var f=l[a];Ry(r,f,o,a===h-1)}return t.dom},n.prototype.getWidth=function(){return this._width},n.prototype.getHeight=function(){return this._height},n}();function INe(n){n.registerPainter("canvas",CNe)}_p([T3e,w3e,UOe,K3e,q3e,dFe,k3e,r3e,jBe,_ke,ske,xBe,ANe,INe]);const RNe=()=>{let n=null,e=null,t=null,r=null,i=null,s=null,o=Ae.useRef(null),l=[],a=[],h={colors:{base:"#f9f002",gradInner:"#8ae66e",gradOuter:"#03c03c"},reset:()=>{r.reset()}},f={impacts:{value:l},maxSize:{value:.04},minSize:{value:.025},waveHeight:{value:.1},scaling:{value:1},gradInner:{value:new Vn(h.colors.gradInner)},gradOuter:{value:new Vn(h.colors.gradOuter)}},p=10,v=null;const[y,S]=Ae.useState(vMe[new Date().getDay()]),[C,M]=Ae.useState(new Date().toLocaleTimeString()),[E,L]=Ae.useState(!1),[k,H]=Ae.useState(CF[0]),[X,Z]=Ae.useState(!1),Q=Ae.useRef(X),re=new FD,ie=new nn;Ae.useEffect(()=>{oe(),Re();for(let xt=0;xt<p;xt++)l.push({impactPosition:new Ze().random().subScalar(.5).setLength(5),impactMaxRadius:5*ra.randFloat(.5,.75),impactRatio:0,prevPosition:new Ze().random().subScalar(.5).setLength(5),trailRatio:{value:0},trailLength:{value:0}}),Se(xt);return Ie(),st(),_e(),window.addEventListener("resize",We),window.addEventListener("dblclick",Ue,!1),()=>{window.removeEventListener("resize",We),window.removeEventListener("dblclick",Ue,!1),v&&clearInterval(v)}},[]),Ae.useEffect(()=>{Q.current=X},[X]);const oe=()=>{n=new Ml,e=new ts(45,window.innerWidth/window.innerHeight,.1,50),e.position.set(0,0,15.5),n.add(e),t=new Jl({canvas:o.current,antialias:!0,alpha:!0}),t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.render(n,e),r=new k0(e,t.domElement),r.enableDamping=!0,r.enablePan=!1,s=new ND(t),s.addPass(new zD(n,e)),s.addPass(new mMe)},fe=()=>{let xt=5,Vt=75e3,lt=Math.PI*(3-Math.sqrt(5)),Ht=2/Vt,Qt=1-Ht/2,rn=0,jn=0,Bn=new Ze,Tn=new hM,Le=new Pi,qe=[],mn=new Qf().load(AMe);for(let Jt=0;Jt<Vt;Jt++){jn=Math.sqrt(1-Qt*Qt),Bn.set(jn*Math.cos(rn),Qt,-jn*Math.sin(rn)).multiplyScalar(xt),Tn.setFromVector3(Bn),rn=rn+lt,Qt=Qt-Ht,Le.lookAt(Bn),Le.updateMatrix();let kn=new ig(1,1);kn.applyMatrix4(Le.matrix),kn.translate(Bn.x,Bn.y,Bn.z);let Gn=[Bn.x,Bn.y,Bn.z,Bn.x,Bn.y,Bn.z,Bn.x,Bn.y,Bn.z,Bn.x,Bn.y,Bn.z];kn.setAttribute("center",new or(Gn,3));let sn=new nn((Tn.theta+Math.PI)/(2*Math.PI),1-Tn.phi/Math.PI),ot=[sn.x,sn.y,sn.x,sn.y,sn.x,sn.y,sn.x,sn.y];kn.setAttribute("baseUv",new or(ot,2)),qe.push(kn)}let cn=gMe(qe),St=new _a({color:new Vn(h.colors.base),onBeforeCompile:Jt=>{Jt.uniforms.impacts=f.impacts,Jt.uniforms.maxSize=f.maxSize,Jt.uniforms.minSize=f.minSize,Jt.uniforms.waveHeight=f.waveHeight,Jt.uniforms.scaling=f.scaling,Jt.uniforms.gradInner=f.gradInner,Jt.uniforms.gradOuter=f.gradOuter,Jt.uniforms.tex={value:mn},Jt.vertexShader=`
            struct impact {
              vec3 impactPosition;
              float impactMaxRadius;
              float impactRatio;
            };
            uniform impact impacts[${p}];
            uniform sampler2D tex;
            uniform float maxSize;
            uniform float minSize;
            uniform float waveHeight;
            uniform float scaling;

            attribute vec3 center;
            attribute vec2 baseUv;

            varying float vFinalStep;
            varying float vMap;

            ${Jt.vertexShader}
          `.replace("#include <begin_vertex>",`#include <begin_vertex>
            float finalStep = 0.0;
            for (int i = 0; i < ${p};i++){
              float dist = distance(center, impacts[i].impactPosition);
              float curRadius = impacts[i].impactMaxRadius * impacts[i].impactRatio;
              float sstep = smoothstep(0., curRadius, dist) - smoothstep(curRadius - ( 0.25 * impacts[i].impactRatio ), curRadius, dist);
              sstep *= 1. - impacts[i].impactRatio;
              finalStep += sstep;
            }
            finalStep = clamp(finalStep, 0., 1.);
            vFinalStep = finalStep;

            float map = texture(tex, baseUv).g;
            vMap = map;
            float pSize = map < 0.5 ? maxSize : minSize;
            float scale = scaling;

            transformed = (position - center) * pSize * mix(1., scale * 1.25, finalStep) + center; // scale on wave
            transformed += normal * finalStep * waveHeight; // lift on wave
            `),Jt.fragmentShader=`
            uniform vec3 gradInner;
            uniform vec3 gradOuter;
            varying float vFinalStep;
            varying float vMap;
            ${Jt.fragmentShader}
            `.replace("vec4 diffuseColor = vec4( diffuse, opacity );",`
            // shaping the point, pretty much from The Book of Shaders
            vec2 hUv = (vUv - 0.5);
            int N = 8;
            float a = atan(hUv.x,hUv.y); 
            float r = PI2/float(N);
            float d = cos(floor(.5+a/r)*r-a)*length(hUv);
            float f = cos(PI / float(N)) * 0.5;
            if (d > f) discard;

            vec3 grad = mix(gradInner, gradOuter, clamp( d / f, 0., 1.)); // gradient
            vec3 diffuseMap = diffuse * ((vMap > 0.5) ? 0.5 : 1.);
            vec3 col = mix(diffuseMap, grad, vFinalStep); // color on wave
            if (!gl_FrontFacing) col *= 0.25; // moderate the color on backside
            vec4 diffuseColor = vec4( col , opacity );
            `)}});St.defines={USE_UV:""},i=new Ri(cn,St),i.rotation.y=Math.PI,a.forEach(Jt=>i.add(Jt)),i.position.set(0,-.4,0),n.add(i)};function Se(xt){let Vt=new Array(300).fill(0),lt=new Xr;lt.setAttribute("position",new or(Vt,3));let Ht=new b6({color:h.colors.gradOuter,transparent:!0,onBeforeCompile:rn=>{rn.uniforms.actionRatio=l[xt].trailRatio,rn.uniforms.lineLength=l[xt].trailLength,rn.fragmentShader=TMe}}),Qt=new Jf(lt,Ht);Qt.userData.idx=xt,Ee(Qt,l[xt].prevPosition,l[xt].impactPosition),a.push(Qt)}const Ee=(xt,Vt,lt,Ht,Qt)=>{let rn=xt.geometry.attributes.position,jn=rn.count-1,Bn=1,Tn=1,Le=Vt.length(),qe=Vt.angleTo(lt),cn=Le*qe/Math.PI,St=cn/2/Bn,Jt=Tn/cn,kn=Le+St,Gn=new Ze().copy(Vt).setLength(kn),sn=new Ze().copy(Vt).negate().setLength(St),ot=new $v(Vt,lt,new Ze),Ge=new Ze;ot.getNormal(Ge);let Xt=new Ze,An=new Ze,Sn=new Ze,jt=new Ze;for(let mr=0;mr<=jn;mr++){let Un=mr/jn,tr=Un*qe;Xt.copy(Gn).applyAxisAngle(Ge,tr),An.copy(sn).applyAxisAngle(Ge,tr+Math.PI*2*Un*Bn),Sn.addVectors(Xt,An);let Sr=(Sn.length()-Le)*Jt+Le;jt.copy(Sn).setLength(Sr),rn.setXYZ(mr,jt.x,jt.y,jt.z)}rn.needsUpdate=!0,xt.computeLineDistances(),xt.geometry.attributes.lineDistance.needsUpdate=!0,l[xt.userData.idx].trailLength.value=xt.geometry.attributes.lineDistance.array[99],xt.material.dashSize=3},Ie=()=>{let xt=[];for(let Vt=0;Vt<p;Vt++)xt.push({runTween:()=>{let lt=a[Vt],rn=lt.geometry.attributes.lineDistance.array[99]/3,jn=new cT.Tween({value:0}).to({value:1},rn*1e3).onUpdate(Tn=>{l[Vt].trailRatio.value=Tn.value});var Bn=new cT.Tween({value:0}).to({value:1},ra.randInt(2500,5e3)).onUpdate(Tn=>{f.impacts.value[Vt].impactRatio=Tn.value}).onComplete(Tn=>{l[Vt].prevPosition.copy(l[Vt].impactPosition),l[Vt].impactPosition.random().subScalar(.5).setLength(5),Ee(lt,l[Vt].prevPosition,l[Vt].impactPosition),f.impacts.value[Vt].impactMaxRadius=5*ra.randFloat(.5,.75),xt[Vt].runTween()});jn.chain(Bn),jn.start()}});xt.forEach(Vt=>Vt.runTween()),fe()};let He=Array.from({length:5}).map(()=>Ae.useRef(null));const Re=()=>{const xt=[yMe,xMe,bMe,wMe,SMe];He.map(lt=>lt.current&&jLe(lt.current,"dark")).forEach((lt,Ht)=>{lt&&lt.setOption(xt[Ht])})},st=()=>{cT.update(),i.rotation.y+=.001,t&&n&&e&&t.render(n,e),requestAnimationFrame(st),Q.current&&s.render()},_e=()=>{v=setInterval(()=>{let xt=new Date,Vt=xt.getHours(),lt=xt.getMinutes(),Ht=xt.getSeconds();M(`${Vt<10?"0"+Vt:Vt}:${lt<10?"0"+lt:lt}:${Ht<10?"0"+Ht:Ht}`)},1e3)},We=()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight),s.setSize(window.innerWidth,window.innerHeight)},Ue=xt=>{ie.x=xt.clientX/window.innerWidth*2-1,ie.y=-xt.clientY/window.innerHeight*2+1,re.setFromCamera(ie,e),re.intersectObjects(i.children).length>0&&(L(!0),H(CF[ra.randInt(0,CF.length-1)]))},vt=()=>{Z(!X)};return me.jsx("div",{className:"earth-digital bg-black h-screen w-full overflow-hidden select-none",children:me.jsxs("div",{className:"p-0 m-0 box-border",children:[me.jsx("canvas",{ref:o,className:"relative z-1 cursor-pointer"}),me.jsxs("div",{className:"fixed h-40 w-48 z-10 left-1/2 top-1/2 tips-modal",style:{display:E?"block":"none"},children:[me.jsx("div",{className:"tips",children:me.jsx("p",{className:"w-full",children:k})}),me.jsx("i",{className:"close",onClick:()=>L(!1),children:"CLOSE"})]}),me.jsxs("header",{className:"hud header w-full left-0 top-0",children:[me.jsx("div",{className:"left",children:me.jsxs("p",{className:"date",children:[me.jsx("span",{className:"text",children:`${y} `}),me.jsx("span",{className:"text",children:C})]})}),me.jsx("div",{className:"middle"}),me.jsx("div",{className:"right",children:me.jsx("p",{className:"date",children:me.jsx("span",{className:"text",children:"Kepler-90 +491818.58"})})})]}),me.jsx("div",{className:"logo-pic",title:"Cyberpunk 2077"}),me.jsxs("aside",{className:"hud aside left",children:[me.jsxs("div",{className:"box box_0 inverse",children:[me.jsx("div",{className:"cover"}),me.jsxs("div",{className:"info",children:[me.jsxs("p",{className:"text",children:[me.jsx("b",{children:"Cyberpunk"}),' is a subgenre of science fiction in a dystopian futuristic setting that tends to focus on a "combination of lowlife and high tech", featuring futuristic technological and scientific achievements, such as artificial intelligence and cybernetics, juxtaposed with societal collapse or decay.'," "]}),me.jsx("button",{className:"startBtn",onClick:vt,children:"START"})]})]}),me.jsx("div",{className:"box",children:me.jsx("div",{className:"chart",ref:He[0]})}),me.jsx("div",{className:"box inverse dotted",children:me.jsx("div",{className:"chart",ref:He[1]})})]}),me.jsxs("aside",{className:"hud aside right",children:[me.jsx("div",{className:"box",children:me.jsx("div",{className:"chart",ref:He[2]})}),me.jsx("div",{className:"box",children:me.jsx("div",{className:"chart",ref:He[3]})}),me.jsx("div",{className:"box inverse dotted",children:me.jsx("div",{className:"chart",ref:He[4]})})]}),me.jsx("footer",{className:"hud footer",children:_Me.map(xt=>me.jsxs("div",{className:"square",children:[me.jsx("div",{className:"radar"}),me.jsxs("div",{className:"text",children:[me.jsx("p",{className:"title",children:xt.value}),me.jsx("p",{className:"desc",children:xt.desc})]})]}))}),me.jsx("section",{className:"background",children:"section"})]})})},PNe="/about_portfolio/assets/bird-D9YInZSw.glb",LNe=()=>{const n=Ae.useRef(),{scene:e,animations:t}=ag(PNe),{actions:r}=O6(t,n);return Ae.useEffect(()=>{r["Take 001"].play()},[]),uE(({clock:i,camera:s})=>{n.current.position.y=Math.sin(i.elapsedTime)*.2+2,n.current.position.x>s.position.x+10?n.current.rotation.y=Math.PI:n.current.position.x<s.position.x-10&&(n.current.rotation.y=0),n.current.rotation.y===0?(n.current.position.x+=.01,n.current.position.z-=.01):(n.current.position.x-=.01,n.current.position.z+=.01)}),me.jsx("mesh",{ref:n,position:[-5,2,1],scale:[.003,.003,.003],children:me.jsx("primitive",{object:e})})},DNe="/about_portfolio/assets/fox-W5Giziuq.glb",BNe=({currentAnimation:n,...e})=>{const t=Ae.useRef(),{nodes:r,materials:i,animations:s}=ag(DNe),{actions:o}=O6(s,t);return Ae.useEffect(()=>{console.log(o),Object.values(o).forEach(l=>{l.stop()}),o[n]&&o[n].play()},[o,n]),me.jsx("group",{ref:t,...e,dispose:null,children:me.jsxs("group",{name:"Sketchfab_Scene",children:[me.jsx("primitive",{object:r.GLTF_created_0_rootJoint}),me.jsx("skinnedMesh",{name:"Object_7",geometry:r.Object_7.geometry,material:i.PaletteMaterial001,skeleton:r.Object_7.skeleton}),me.jsx("skinnedMesh",{name:"Object_8",geometry:r.Object_8.geometry,material:i.PaletteMaterial001,skeleton:r.Object_8.skeleton}),me.jsx("skinnedMesh",{name:"Object_9",geometry:r.Object_9.geometry,material:i.PaletteMaterial001,skeleton:r.Object_9.skeleton}),me.jsx("skinnedMesh",{name:"Object_10",geometry:r.Object_10.geometry,material:i.PaletteMaterial001,skeleton:r.Object_10.skeleton}),me.jsx("skinnedMesh",{name:"Object_11",geometry:r.Object_11.geometry,material:i.PaletteMaterial001,skeleton:r.Object_11.skeleton})]})})},kNe="/about_portfolio/gltfModels/world_2d/world_2d.gltf",ONe=({...n})=>{const t=ag(kNe).scene;return me.jsx("mesh",{...n,children:me.jsx("primitive",{object:t})})};class FNe extends Ro{constructor(e){super(e)}load(e,t,r,i){const s=this,o=this.path===""?du.extractUrlBase(e):this.path,l=new Xo(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(a){try{t(s.parse(a,o))}catch(h){i?i(h):console.error(h),s.manager.itemError(e)}},r,i)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,t){const r=e.split(`
`);let i={};const s=/\s+/,o={};for(let a=0;a<r.length;a++){let h=r[a];if(h=h.trim(),h.length===0||h.charAt(0)==="#")continue;const f=h.indexOf(" ");let p=f>=0?h.substring(0,f):h;p=p.toLowerCase();let v=f>=0?h.substring(f+1):"";if(v=v.trim(),p==="newmtl")i={name:v},o[v]=i;else if(p==="ka"||p==="kd"||p==="ks"||p==="ke"){const y=v.split(s,3);i[p]=[parseFloat(y[0]),parseFloat(y[1]),parseFloat(y[2])]}else i[p]=v}const l=new NNe(this.resourcePath||t,this.materialOptions);return l.setCrossOrigin(this.crossOrigin),l.setManager(this.manager),l.setMaterials(o),l}}class NNe{constructor(e="",t={}){this.baseUrl=e,this.options=t,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:kh,this.wrap=this.options.wrap!==void 0?this.options.wrap:Oh}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const t={};for(const r in e){const i=e[r],s={};t[r]=s;for(const o in i){let l=!0,a=i[o];const h=o.toLowerCase();switch(h){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(a=[a[0]/255,a[1]/255,a[2]/255]),this.options&&this.options.ignoreZeroRGBs&&a[0]===0&&a[1]===0&&a[2]===0&&(l=!1);break}l&&(s[h]=a)}}return t}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const t=this,r=this.materialsInfo[e],i={name:e,side:this.side};function s(l,a){return typeof a!="string"||a===""?"":/^https?:\/\//i.test(a)?a:l+a}function o(l,a){if(i[l])return;const h=t.getTextureParams(a,i),f=t.loadTexture(s(t.baseUrl,h.url));f.repeat.copy(h.scale),f.offset.copy(h.offset),f.wrapS=t.wrap,f.wrapT=t.wrap,(l==="map"||l==="emissiveMap")&&(f.colorSpace=Ta),i[l]=f}for(const l in r){const a=r[l];let h;if(a!=="")switch(l.toLowerCase()){case"kd":i.color=new Vn().fromArray(a).convertSRGBToLinear();break;case"ks":i.specular=new Vn().fromArray(a).convertSRGBToLinear();break;case"ke":i.emissive=new Vn().fromArray(a).convertSRGBToLinear();break;case"map_kd":o("map",a);break;case"map_ks":o("specularMap",a);break;case"map_ke":o("emissiveMap",a);break;case"norm":o("normalMap",a);break;case"map_bump":case"bump":o("bumpMap",a);break;case"map_d":o("alphaMap",a),i.transparent=!0;break;case"ns":i.shininess=parseFloat(a);break;case"d":h=parseFloat(a),h<1&&(i.opacity=h,i.transparent=!0);break;case"tr":h=parseFloat(a),this.options&&this.options.invertTrProperty&&(h=1-h),h>0&&(i.opacity=1-h,i.transparent=!0);break}}return this.materials[e]=new aE(i),this.materials[e]}getTextureParams(e,t){const r={scale:new nn(1,1),offset:new nn(0,0)},i=e.split(/\s+/);let s;return s=i.indexOf("-bm"),s>=0&&(t.bumpScale=parseFloat(i[s+1]),i.splice(s,2)),s=i.indexOf("-s"),s>=0&&(r.scale.set(parseFloat(i[s+1]),parseFloat(i[s+2])),i.splice(s,4)),s=i.indexOf("-o"),s>=0&&(r.offset.set(parseFloat(i[s+1]),parseFloat(i[s+2])),i.splice(s,4)),r.url=i.join(" ").trim(),r}loadTexture(e,t,r,i,s){const o=this.manager!==void 0?this.manager:T6;let l=o.getHandler(e);l===null&&(l=new Qf(o)),l.setCrossOrigin&&l.setCrossOrigin(this.crossOrigin);const a=l.load(e,r,i,s);return t!==void 0&&(a.mapping=t),a}}const zNe=/^[og]\s*(.+)?/,UNe=/^mtllib /,GNe=/^usemtl /,VNe=/^usemap /,SK=/\s+/,AK=new Ze,nN=new Ze,TK=new Ze,MK=new Ze,dh=new Ze,EI=new Vn;function HNe(){const n={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&this.object.fromDeclaration===!1){this.object.name=e,this.object.fromDeclaration=t!==!1;return}const r=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:t!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(i,s){const o=this._finalize(!1);o&&(o.inherited||o.groupCount<=0)&&this.materials.splice(o.index,1);const l={index:this.materials.length,name:i||"",mtllib:Array.isArray(s)&&s.length>0?s[s.length-1]:"",smooth:o!==void 0?o.smooth:this.smooth,groupStart:o!==void 0?o.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){const h={index:typeof a=="number"?a:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return h.clone=this.clone.bind(h),h}};return this.materials.push(l),l},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(i){const s=this.currentMaterial();if(s&&s.groupEnd===-1&&(s.groupEnd=this.geometry.vertices.length/3,s.groupCount=s.groupEnd-s.groupStart,s.inherited=!1),i&&this.materials.length>1)for(let o=this.materials.length-1;o>=0;o--)this.materials[o].groupCount<=0&&this.materials.splice(o,1);return i&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),s}},r&&r.name&&typeof r.clone=="function"){const i=r.clone(0);i.inherited=!0,this.object.materials.push(i)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseNormalIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/3)*3},parseUVIndex:function(e,t){const r=parseInt(e,10);return(r>=0?r-1:r+t/2)*2},addVertex:function(e,t,r){const i=this.vertices,s=this.object.geometry.vertices;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[t+0],i[t+1],i[t+2]),s.push(i[r+0],i[r+1],i[r+2])},addVertexPoint:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){const t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){const i=this.normals,s=this.object.geometry.normals;s.push(i[e+0],i[e+1],i[e+2]),s.push(i[t+0],i[t+1],i[t+2]),s.push(i[r+0],i[r+1],i[r+2])},addFaceNormal:function(e,t,r){const i=this.vertices,s=this.object.geometry.normals;AK.fromArray(i,e),nN.fromArray(i,t),TK.fromArray(i,r),dh.subVectors(TK,nN),MK.subVectors(AK,nN),dh.cross(MK),dh.normalize(),s.push(dh.x,dh.y,dh.z),s.push(dh.x,dh.y,dh.z),s.push(dh.x,dh.y,dh.z)},addColor:function(e,t,r){const i=this.colors,s=this.object.geometry.colors;i[e]!==void 0&&s.push(i[e+0],i[e+1],i[e+2]),i[t]!==void 0&&s.push(i[t+0],i[t+1],i[t+2]),i[r]!==void 0&&s.push(i[r+0],i[r+1],i[r+2])},addUV:function(e,t,r){const i=this.uvs,s=this.object.geometry.uvs;s.push(i[e+0],i[e+1]),s.push(i[t+0],i[t+1]),s.push(i[r+0],i[r+1])},addDefaultUV:function(){const e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){const t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,i,s,o,l,a,h){const f=this.vertices.length;let p=this.parseVertexIndex(e,f),v=this.parseVertexIndex(t,f),y=this.parseVertexIndex(r,f);if(this.addVertex(p,v,y),this.addColor(p,v,y),l!==void 0&&l!==""){const S=this.normals.length;p=this.parseNormalIndex(l,S),v=this.parseNormalIndex(a,S),y=this.parseNormalIndex(h,S),this.addNormal(p,v,y)}else this.addFaceNormal(p,v,y);if(i!==void 0&&i!==""){const S=this.uvs.length;p=this.parseUVIndex(i,S),v=this.parseUVIndex(s,S),y=this.parseUVIndex(o,S),this.addUV(p,v,y),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";const t=this.vertices.length;for(let r=0,i=e.length;r<i;r++){const s=this.parseVertexIndex(e[r],t);this.addVertexPoint(s),this.addColor(s)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";const r=this.vertices.length,i=this.uvs.length;for(let s=0,o=e.length;s<o;s++)this.addVertexLine(this.parseVertexIndex(e[s],r));for(let s=0,o=t.length;s<o;s++)this.addUVLine(this.parseUVIndex(t[s],i))}};return n.startObject("",!1),n}class jNe extends Ro{constructor(e){super(e),this.materials=null}load(e,t,r,i){const s=this,o=new Xo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{t(s.parse(l))}catch(a){i?i(a):console.error(a),s.manager.itemError(e)}},r,i)}setMaterials(e){return this.materials=e,this}parse(e){const t=new HNe;e.indexOf(`\r
`)!==-1&&(e=e.replace(/\r\n/g,`
`)),e.indexOf(`\\
`)!==-1&&(e=e.replace(/\\\n/g,""));const r=e.split(`
`);let i=[];for(let l=0,a=r.length;l<a;l++){const h=r[l].trimStart();if(h.length===0)continue;const f=h.charAt(0);if(f!=="#")if(f==="v"){const p=h.split(SK);switch(p[0]){case"v":t.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),p.length>=7?(EI.setRGB(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6])).convertSRGBToLinear(),t.colors.push(EI.r,EI.g,EI.b)):t.colors.push(void 0,void 0,void 0);break;case"vn":t.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":t.uvs.push(parseFloat(p[1]),parseFloat(p[2]));break}}else if(f==="f"){const v=h.slice(1).trim().split(SK),y=[];for(let C=0,M=v.length;C<M;C++){const E=v[C];if(E.length>0){const L=E.split("/");y.push(L)}}const S=y[0];for(let C=1,M=y.length-1;C<M;C++){const E=y[C],L=y[C+1];t.addFace(S[0],E[0],L[0],S[1],E[1],L[1],S[2],E[2],L[2])}}else if(f==="l"){const p=h.substring(1).trim().split(" ");let v=[];const y=[];if(h.indexOf("/")===-1)v=p;else for(let S=0,C=p.length;S<C;S++){const M=p[S].split("/");M[0]!==""&&v.push(M[0]),M[1]!==""&&y.push(M[1])}t.addLineGeometry(v,y)}else if(f==="p"){const v=h.slice(1).trim().split(" ");t.addPointGeometry(v)}else if((i=zNe.exec(h))!==null){const p=(" "+i[0].slice(1).trim()).slice(1);t.startObject(p)}else if(GNe.test(h))t.object.startMaterial(h.substring(7).trim(),t.materialLibraries);else if(UNe.test(h))t.materialLibraries.push(h.substring(7).trim());else if(VNe.test(h))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(f==="s"){if(i=h.split(" "),i.length>1){const v=i[1].trim().toLowerCase();t.object.smooth=v!=="0"&&v!=="off"}else t.object.smooth=!0;const p=t.object.currentMaterial();p&&(p.smooth=t.object.smooth)}else{if(h==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+h+'"')}}t.finalize();const s=new ql;if(s.materialLibraries=[].concat(t.materialLibraries),!(t.objects.length===1&&t.objects[0].geometry.vertices.length===0)===!0)for(let l=0,a=t.objects.length;l<a;l++){const h=t.objects[l],f=h.geometry,p=h.materials,v=f.type==="Line",y=f.type==="Points";let S=!1;if(f.vertices.length===0)continue;const C=new Xr;C.setAttribute("position",new or(f.vertices,3)),f.normals.length>0&&C.setAttribute("normal",new or(f.normals,3)),f.colors.length>0&&(S=!0,C.setAttribute("color",new or(f.colors,3))),f.hasUVIndices===!0&&C.setAttribute("uv",new or(f.uvs,2));const M=[];for(let L=0,k=p.length;L<k;L++){const H=p[L],X=H.name+"_"+H.smooth+"_"+S;let Z=t.materials[X];if(this.materials!==null){if(Z=this.materials.create(H.name),v&&Z&&!(Z instanceof Eo)){const Q=new Eo;ya.prototype.copy.call(Q,Z),Q.color.copy(Z.color),Z=Q}else if(y&&Z&&!(Z instanceof cu)){const Q=new cu({size:10,sizeAttenuation:!1});ya.prototype.copy.call(Q,Z),Q.color.copy(Z.color),Q.map=Z.map,Z=Q}}Z===void 0&&(v?Z=new Eo:y?Z=new cu({size:1,sizeAttenuation:!1}):Z=new aE,Z.name=H.name,Z.flatShading=!H.smooth,Z.vertexColors=S,t.materials[X]=Z),M.push(Z)}let E;if(M.length>1){for(let L=0,k=p.length;L<k;L++){const H=p[L];C.addGroup(H.groupStart,H.groupCount,L)}v?E=new pu(C,M):y?E=new Eh(C,M):E=new Ri(C,M)}else v?E=new pu(C,M[0]):y?E=new Eh(C,M[0]):E=new Ri(C,M[0]);E.name=h.name,s.add(E)}else if(t.vertices.length>0){const l=new cu({size:1,sizeAttenuation:!1}),a=new Xr;a.setAttribute("position",new or(t.vertices,3)),t.colors.length>0&&t.colors[0]!==void 0&&(a.setAttribute("color",new or(t.colors,3)),l.vertexColors=!0);const h=new Eh(a,l);s.add(h)}return s}}const WNe="/about_portfolio/gltfModels/earth_star/earth.mtl",$Ne="/about_portfolio/gltfModels/earth_star/earth.obj",XNe=()=>{let n=null,e=null,t=null,r=null,i,s,o=null,l=0,a=Ae.useRef(null),h=()=>{let p={width:a.current.clientWidth,height:a.current.clientHeight};e=new ts(70,p.width/p.height,.01,1e3),e.position.set(50,20,200),e.lookAt(0,0,0),n=new Ml,n.fog=new Tw(1710618,1,1e3),n.background=new Vn(1710618),t=new Tx(14609919,3),r=new Jl({canvas:a.current,alpha:!0,antialias:!0}),r.setSize(p.width,p.height);let v=new k0(e,r.domElement);v.enableDamping=!0;let y=new sE(100,4,2,120),S=new _a({color:4237823,wireframe:!0});o=new Ri(y,S),o.rotation.x=Math.PI/2,o.rotation.y=-.1*(Math.PI/2);let C=new sx(12,0),M=new oE({color:16776192});s=new Ri(C,M),i=new ql;for(let k=0;k<500;k++){let H=new sx(Math.random()*3,0),X=new _a({color:16777215}),Z=new Ri(H,X);Z.position.set((Math.random()-.5)*800,(Math.random()-.5)*800,(Math.random()-.5)*800),Z.rotation.set(Math.random()*2*Math.PI,Math.random()*2*Math.PI,Math.random()*2*Math.PI),i.add(Z)}let E=new FNe,L=new jNe;E.load(WNe,k=>{k.preload(),k.side=Ac,L.setMaterials(k),L.load($Ne,H=>{H.scale.set(80,80,80),H.children.map((X,Z)=>{const Q=X.material.name;X.material=k.materials[Q],X.name==="Earth_Sphere"?(X.visible=!0,H.add(new Ri(X.geometry,X.material))):X.material.opacity=.1}),n.add(H)})}),n.add(t),n.add(o),n.add(s),n.add(i),r.render(n,e)},f=()=>{let p=new Ze(0,0,1);l+=Math.random()*.8;let v=Math.PI*l/180;o&&o.rotateOnAxis(p,Math.PI/400),s.position.set(140*Math.cos(v),100*Math.sin(v),80*Math.sin(v)),s.rotation.x+=.01,s.rotation.y+=.01,s.rotation.z-=.01,i.rotation.y+=9e-4,i.rotation.z-=9e-4,requestAnimationFrame(f),r.render(n,e)};return Ae.useEffect(()=>{h(),f()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:a,className:"w-full h-full"})})},qNe="/about_portfolio/assets/statue-C3oCcb_2.glb",rN=new WeakMap;class a8 extends Ro{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){const s=new Xo(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{this.parse(o,t,i)},r,i)}parse(e,t,r=()=>{}){this.decodeDracoFile(e,t,null,null,Ta,r).catch(r)}decodeDracoFile(e,t,r,i,s=jo,o=()=>{}){const l={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r,vertexColorSpace:s};return this.decodeGeometry(e,l).then(t).catch(o)}decodeGeometry(e,t){const r=JSON.stringify(t);if(rN.has(e)){const a=rN.get(e);if(a.key===r)return a.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,o=e.byteLength,l=this._getWorker(s,o).then(a=>(i=a,new Promise((h,f)=>{i._callbacks[s]={resolve:h,reject:f},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(a=>this._createGeometry(a.geometry));return l.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),rN.set(e,{key:r,promise:l}),l}_createGeometry(e){const t=new Xr;e.index&&t.setIndex(new ki(e.index.array,1));for(let r=0;r<e.attributes.length;r++){const i=e.attributes[r],s=i.name,o=i.array,l=i.itemSize,a=new ki(o,l);s==="color"&&(this._assignVertexColorSpace(a,i.vertexColorSpace),a.normalized=!(o instanceof Float32Array)),t.setAttribute(s,a)}return t}_assignVertexColorSpace(e,t){if(t!==Ta)return;const r=new Vn;for(let i=0,s=e.count;i<s;i++)r.fromBufferAttribute(e,i).convertSRGBToLinear(),e.setXYZ(i,r.r,r.g,r.b)}_loadLibrary(e,t){const r=new Xo(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,s)=>{r.load(e,i,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{const i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);const s=ZNe.toString(),o=["/* draco decoder */",i,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(s){const o=s.data;switch(o.type){case"decode":i._callbacks[o.id].resolve(o);break;case"error":i._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,s){return i._taskLoad>s._taskLoad?-1:1});const r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function ZNe(){let n,e;onmessage=function(o){const l=o.data;switch(l.type){case"init":n=l.decoderConfig,e=new Promise(function(f){n.onModuleLoaded=function(p){f({draco:p})},DracoDecoderModule(n)});break;case"decode":const a=l.buffer,h=l.taskConfig;e.then(f=>{const p=f.draco,v=new p.Decoder;try{const y=t(p,v,new Int8Array(a),h),S=y.attributes.map(C=>C.array.buffer);y.index&&S.push(y.index.array.buffer),self.postMessage({type:"decode",id:l.id,geometry:y},S)}catch(y){console.error(y),self.postMessage({type:"error",id:l.id,error:y.message})}finally{p.destroy(v)}});break}};function t(o,l,a,h){const f=h.attributeIDs,p=h.attributeTypes;let v,y;const S=l.GetEncodedGeometryType(a);if(S===o.TRIANGULAR_MESH)v=new o.Mesh,y=l.DecodeArrayToMesh(a,a.byteLength,v);else if(S===o.POINT_CLOUD)v=new o.PointCloud,y=l.DecodeArrayToPointCloud(a,a.byteLength,v);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!y.ok()||v.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+y.error_msg());const C={index:null,attributes:[]};for(const M in f){const E=self[p[M]];let L,k;if(h.useUniqueIDs)k=f[M],L=l.GetAttributeByUniqueId(v,k);else{if(k=l.GetAttributeId(v,o[f[M]]),k===-1)continue;L=l.GetAttribute(v,k)}const H=i(o,l,v,M,E,L);M==="color"&&(H.vertexColorSpace=h.vertexColorSpace),C.attributes.push(H)}return S===o.TRIANGULAR_MESH&&(C.index=r(o,l,v)),o.destroy(v),C}function r(o,l,a){const f=a.num_faces()*3,p=f*4,v=o._malloc(p);l.GetTrianglesUInt32Array(a,p,v);const y=new Uint32Array(o.HEAPF32.buffer,v,f).slice();return o._free(v),{array:y,itemSize:1}}function i(o,l,a,h,f,p){const v=p.num_components(),S=a.num_points()*v,C=S*f.BYTES_PER_ELEMENT,M=s(o,f),E=o._malloc(C);l.GetAttributeDataArrayForAllPoints(a,p,M,C,E);const L=new f(o.HEAPF32.buffer,E,S).slice();return o._free(E),{name:h,array:L,itemSize:v}}function s(o,l){switch(l){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}class SB extends Ro{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new e4e(t)}),this.register(function(t){return new t4e(t)}),this.register(function(t){return new u4e(t)}),this.register(function(t){return new h4e(t)}),this.register(function(t){return new f4e(t)}),this.register(function(t){return new r4e(t)}),this.register(function(t){return new i4e(t)}),this.register(function(t){return new s4e(t)}),this.register(function(t){return new a4e(t)}),this.register(function(t){return new QNe(t)}),this.register(function(t){return new o4e(t)}),this.register(function(t){return new n4e(t)}),this.register(function(t){return new c4e(t)}),this.register(function(t){return new l4e(t)}),this.register(function(t){return new KNe(t)}),this.register(function(t){return new d4e(t)}),this.register(function(t){return new p4e(t)})}load(e,t,r,i){const s=this;let o;if(this.resourcePath!=="")o=this.resourcePath;else if(this.path!==""){const h=du.extractUrlBase(e);o=du.resolveURL(h,this.path)}else o=du.extractUrlBase(e);this.manager.itemStart(e);const l=function(h){i?i(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},a=new Xo(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(h){try{s.parse(h,o,function(f){t(f),s.manager.itemEnd(e)},l)}catch(f){l(f)}},r,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){let s;const o={},l={},a=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(a.decode(new Uint8Array(e,0,4))===ice){try{o[Hi.KHR_BINARY_GLTF]=new m4e(e)}catch(p){i&&i(p);return}s=JSON.parse(o[Hi.KHR_BINARY_GLTF].content)}else s=JSON.parse(a.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const h=new C4e(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let f=0;f<this.pluginCallbacks.length;f++){const p=this.pluginCallbacks[f](h);p.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[p.name]=p,o[p.name]=!0}if(s.extensionsUsed)for(let f=0;f<s.extensionsUsed.length;++f){const p=s.extensionsUsed[f],v=s.extensionsRequired||[];switch(p){case Hi.KHR_MATERIALS_UNLIT:o[p]=new JNe;break;case Hi.KHR_DRACO_MESH_COMPRESSION:o[p]=new g4e(s,this.dracoLoader);break;case Hi.KHR_TEXTURE_TRANSFORM:o[p]=new v4e;break;case Hi.KHR_MESH_QUANTIZATION:o[p]=new _4e;break;default:v.indexOf(p)>=0&&l[p]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+p+'".')}}h.setExtensions(o),h.setPlugins(l),h.parse(r,i)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,t,i,s)})}}function YNe(){let n={};return{get:function(e){return n[e]},add:function(e,t){n[e]=t},remove:function(e){delete n[e]},removeAll:function(){n={}}}}const Hi={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class KNe{constructor(e){this.parser=e,this.name=Hi.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let r=0,i=t.length;r<i;r++){const s=t[r];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,r="light:"+e;let i=t.cache.get(r);if(i)return i;const s=t.json,a=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const f=new Vn(16777215);a.color!==void 0&&f.setRGB(a.color[0],a.color[1],a.color[2],jo);const p=a.range!==void 0?a.range:0;switch(a.type){case"directional":h=new B0(f),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new a0(f),h.distance=p;break;case"spot":h=new kD(f),h.distance=p,a.spot=a.spot||{},a.spot.innerConeAngle=a.spot.innerConeAngle!==void 0?a.spot.innerConeAngle:0,a.spot.outerConeAngle=a.spot.outerConeAngle!==void 0?a.spot.outerConeAngle:Math.PI/4,h.angle=a.spot.outerConeAngle,h.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return h.position.set(0,0,0),h.decay=2,Sm(h,a),a.intensity!==void 0&&(h.intensity=a.intensity),h.name=t.createUniqueName(a.name||"light_"+e),i=Promise.resolve(h),t.cache.add(r,i),i}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,r=this.parser,s=r.json.nodes[e],l=(s.extensions&&s.extensions[this.name]||{}).light;return l===void 0?null:this._loadLight(l).then(function(a){return r._getNodeRef(t.cache,l,a)})}}class JNe{constructor(){this.name=Hi.KHR_MATERIALS_UNLIT}getMaterialType(){return _a}extendParams(e,t,r){const i=[];e.color=new Vn(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.setRGB(o[0],o[1],o[2],jo),e.opacity=o[3]}s.baseColorTexture!==void 0&&i.push(r.assignTexture(e,"map",s.baseColorTexture,Ta))}return Promise.all(i)}}class QNe{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class e4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];if(o.clearcoatFactor!==void 0&&(t.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(r.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const l=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new nn(l,l)}return Promise.all(s)}}class t4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_DISPERSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.dispersion=s.dispersion!==void 0?s.dispersion:0,Promise.resolve()}}class n4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.iridescenceFactor!==void 0&&(t.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(t.iridescenceIOR=o.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(r.assignTexture(t,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class r4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_SHEEN}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new Vn(0,0,0),t.sheenRoughness=0,t.sheen=1;const o=i.extensions[this.name];if(o.sheenColorFactor!==void 0){const l=o.sheenColorFactor;t.sheenColor.setRGB(l[0],l[1],l[2],jo)}return o.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(r.assignTexture(t,"sheenColorMap",o.sheenColorTexture,Ta)),o.sheenRoughnessTexture!==void 0&&s.push(r.assignTexture(t,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class i4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.transmissionFactor!==void 0&&(t.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(r.assignTexture(t,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class s4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_VOLUME}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(r.assignTexture(t,"thicknessMap",o.thicknessTexture)),t.attenuationDistance=o.attenuationDistance||1/0;const l=o.attenuationColor||[1,1,1];return t.attenuationColor=new Vn().setRGB(l[0],l[1],l[2],jo),Promise.all(s)}}class a4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_IOR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class o4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_SPECULAR}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];t.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(r.assignTexture(t,"specularIntensityMap",o.specularTexture));const l=o.specularColorFactor||[1,1,1];return t.specularColor=new Vn().setRGB(l[0],l[1],l[2],jo),o.specularColorTexture!==void 0&&s.push(r.assignTexture(t,"specularColorMap",o.specularColorTexture,Ta)),Promise.all(s)}}class l4e{constructor(e){this.parser=e,this.name=Hi.EXT_MATERIALS_BUMP}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return t.bumpScale=o.bumpFactor!==void 0?o.bumpFactor:1,o.bumpTexture!==void 0&&s.push(r.assignTexture(t,"bumpMap",o.bumpTexture)),Promise.all(s)}}class c4e{constructor(e){this.parser=e,this.name=Hi.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){const r=this.parser.json.materials[e];return!r.extensions||!r.extensions[this.name]?null:Wa}extendMaterialParams(e,t){const r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=[],o=i.extensions[this.name];return o.anisotropyStrength!==void 0&&(t.anisotropy=o.anisotropyStrength),o.anisotropyRotation!==void 0&&(t.anisotropyRotation=o.anisotropyRotation),o.anisotropyTexture!==void 0&&s.push(r.assignTexture(t,"anisotropyMap",o.anisotropyTexture)),Promise.all(s)}}class u4e{constructor(e){this.parser=e,this.name=Hi.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;const s=i.extensions[this.name],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,o)}}class h4e{constructor(e){this.parser=e,this.name=Hi.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=i.images[o.source];let a=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(a=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,o.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class f4e{constructor(e){this.parser=e,this.name=Hi.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const t=this.name,r=this.parser,i=r.json,s=i.textures[e];if(!s.extensions||!s.extensions[t])return null;const o=s.extensions[t],l=i.images[o.source];let a=r.textureLoader;if(l.uri){const h=r.options.manager.getHandler(l.uri);h!==null&&(a=h)}return this.detectSupport().then(function(h){if(h)return r.loadTextureImage(e,o.source,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class d4e{constructor(e){this.name=Hi.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){const i=r.extensions[this.name],s=this.parser.getDependency("buffer",i.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(l){const a=i.byteOffset||0,h=i.byteLength||0,f=i.count,p=i.byteStride,v=new Uint8Array(l,a,h);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(f,p,v,i.mode,i.filter).then(function(y){return y.buffer}):o.ready.then(function(){const y=new ArrayBuffer(f*p);return o.decodeGltfBuffer(new Uint8Array(y),f,p,v,i.mode,i.filter),y})})}else return null}}class p4e{constructor(e){this.name=Hi.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||r.mesh===void 0)return null;const i=t.meshes[r.mesh];for(const h of i.primitives)if(h.mode!==_h.TRIANGLES&&h.mode!==_h.TRIANGLE_STRIP&&h.mode!==_h.TRIANGLE_FAN&&h.mode!==void 0)return null;const o=r.extensions[this.name].attributes,l=[],a={};for(const h in o)l.push(this.parser.getDependency("accessor",o[h]).then(f=>(a[h]=f,a[h])));return l.length<1?null:(l.push(this.parser.createNodeMesh(e)),Promise.all(l).then(h=>{const f=h.pop(),p=f.isGroup?f.children:[f],v=h[0].count,y=[];for(const S of p){const C=new Gr,M=new Ze,E=new Mo,L=new Ze(1,1,1),k=new xD(S.geometry,S.material,v);for(let H=0;H<v;H++)a.TRANSLATION&&M.fromBufferAttribute(a.TRANSLATION,H),a.ROTATION&&E.fromBufferAttribute(a.ROTATION,H),a.SCALE&&L.fromBufferAttribute(a.SCALE,H),k.setMatrixAt(H,C.compose(M,E,L));for(const H in a)if(H==="_COLOR_0"){const X=a[H];k.instanceColor=new m0(X.array,X.itemSize,X.normalized)}else H!=="TRANSLATION"&&H!=="ROTATION"&&H!=="SCALE"&&S.geometry.setAttribute(H,a[H]);Pi.prototype.copy.call(k,S),this.parser.assignFinalMaterial(k),y.push(k)}return f.isGroup?(f.clear(),f.add(...y),f):y[0]}))}}const ice="glTF",gA=12,EK={JSON:1313821514,BIN:5130562};class m4e{constructor(e){this.name=Hi.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,gA),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==ice)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-gA,s=new DataView(e,gA);let o=0;for(;o<i;){const l=s.getUint32(o,!0);o+=4;const a=s.getUint32(o,!0);if(o+=4,a===EK.JSON){const h=new Uint8Array(e,gA+o,l);this.content=r.decode(h)}else if(a===EK.BIN){const h=gA+o;this.body=e.slice(h,h+l)}o+=l}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class g4e{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Hi.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const r=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,l={},a={},h={};for(const f in o){const p=A5[f]||f.toLowerCase();l[p]=o[f]}for(const f in e.attributes){const p=A5[f]||f.toLowerCase();if(o[f]!==void 0){const v=r.accessors[e.attributes[f]],y=Xb[v.componentType];h[p]=y.name,a[p]=v.normalized===!0}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(p,v){i.decodeDracoFile(f,function(y){for(const S in y.attributes){const C=y.attributes[S],M=a[S];M!==void 0&&(C.normalized=M)}p(y)},l,h,jo,v)})})}}class v4e{constructor(){this.name=Hi.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(t.texCoord===void 0||t.texCoord===e.channel)&&t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.texCoord!==void 0&&(e.channel=t.texCoord),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class _4e{constructor(){this.name=Hi.KHR_MESH_QUANTIZATION}}class sce extends bx{constructor(e,t,r,i){super(e,t,r,i)}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let o=0;o!==i;o++)t[o]=r[s+o];return t}interpolate_(e,t,r,i){const s=this.resultBuffer,o=this.sampleValues,l=this.valueSize,a=l*2,h=l*3,f=i-t,p=(r-t)/f,v=p*p,y=v*p,S=e*h,C=S-h,M=-2*y+3*v,E=y-v,L=1-M,k=E-v+p;for(let H=0;H!==l;H++){const X=o[C+H+l],Z=o[C+H+a]*f,Q=o[S+H+l],re=o[S+H]*f;s[H]=L*X+k*Z+M*Q+E*re}return s}}const y4e=new Mo;class x4e extends sce{interpolate_(e,t,r,i){const s=super.interpolate_(e,t,r,i);return y4e.fromArray(s).normalize().toArray(s),s}}const _h={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Xb={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},CK={9728:Ao,9729:Ca,9984:XM,9985:Oy,9986:Wv,9987:lu},IK={33071:ou,33648:Qy,10497:Oh},iN={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},A5={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Cv={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},b4e={CUBICSPLINE:void 0,LINEAR:p0,STEP:nx},sN={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function w4e(n){return n.DefaultMaterial===void 0&&(n.DefaultMaterial=new mp({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:kh})),n.DefaultMaterial}function iy(n,e,t){for(const r in t.extensions)n[r]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[r]=t.extensions[r])}function Sm(n,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(n.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function S4e(n,e,t){let r=!1,i=!1,s=!1;for(let h=0,f=e.length;h<f;h++){const p=e[h];if(p.POSITION!==void 0&&(r=!0),p.NORMAL!==void 0&&(i=!0),p.COLOR_0!==void 0&&(s=!0),r&&i&&s)break}if(!r&&!i&&!s)return Promise.resolve(n);const o=[],l=[],a=[];for(let h=0,f=e.length;h<f;h++){const p=e[h];if(r){const v=p.POSITION!==void 0?t.getDependency("accessor",p.POSITION):n.attributes.position;o.push(v)}if(i){const v=p.NORMAL!==void 0?t.getDependency("accessor",p.NORMAL):n.attributes.normal;l.push(v)}if(s){const v=p.COLOR_0!==void 0?t.getDependency("accessor",p.COLOR_0):n.attributes.color;a.push(v)}}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(a)]).then(function(h){const f=h[0],p=h[1],v=h[2];return r&&(n.morphAttributes.position=f),i&&(n.morphAttributes.normal=p),s&&(n.morphAttributes.color=v),n.morphTargetsRelative=!0,n})}function A4e(n,e){if(n.updateMorphTargets(),e.weights!==void 0)for(let t=0,r=e.weights.length;t<r;t++)n.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(n.morphTargetInfluences.length===t.length){n.morphTargetDictionary={};for(let r=0,i=t.length;r<i;r++)n.morphTargetDictionary[t[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function T4e(n){let e;const t=n.extensions&&n.extensions[Hi.KHR_DRACO_MESH_COMPRESSION];if(t?e="draco:"+t.bufferView+":"+t.indices+":"+aN(t.attributes):e=n.indices+":"+aN(n.attributes)+":"+n.mode,n.targets!==void 0)for(let r=0,i=n.targets.length;r<i;r++)e+=":"+aN(n.targets[r]);return e}function aN(n){let e="";const t=Object.keys(n).sort();for(let r=0,i=t.length;r<i;r++)e+=t[r]+":"+n[t[r]]+";";return e}function T5(n){switch(n){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function M4e(n){return n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0?"image/jpeg":n.search(/\.webp($|\?)/i)>0||n.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const E4e=new Gr;class C4e{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new YNe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,i=-1,s=!1,o=-1;if(typeof navigator<"u"){const l=navigator.userAgent;r=/^((?!chrome|android).)*safari/i.test(l)===!0;const a=l.match(/Version\/(\d+)/);i=r&&a?parseInt(a[1],10):-1,s=l.indexOf("Firefox")>-1,o=s?l.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||r&&i<17||s&&o<98?this.textureLoader=new Qf(this.options.manager):this.textureLoader=new E6(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Xo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const r=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(o){const l={scene:o[0][i.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:i.asset,parser:r,userData:{}};return iy(s,l,i),Sm(l,i),Promise.all(r._invokeAll(function(a){return a.afterRoot&&a.afterRoot(l)})).then(function(){for(const a of l.scenes)a.updateMatrixWorld();e(l)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const o=t[i].joints;for(let l=0,a=o.length;l<a;l++)e[o[l]].isBone=!0}for(let i=0,s=e.length;i<s;i++){const o=e[i];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(r[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;const i=r.clone(),s=(o,l)=>{const a=this.associations.get(o);a!=null&&this.associations.set(l,a);for(const[h,f]of o.children.entries())s(f,l.children[h])};return s(r,i),i.name+="_instance_"+e.uses[t]++,i}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){const i=e(t[r]);if(i)return i}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const r=[];for(let i=0;i<t.length;i++){const s=e(t[i]);s&&r.push(s)}return r}getDependency(e,t){const r=e+":"+t;let i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":i=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":i=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":i=this.loadSkin(t);break;case"animation":i=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":i=this.loadCamera(t);break;default:if(i=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!i)throw new Error("Unknown type: "+e);break}this.cache.add(r,i)}return i}getDependencies(e){let t=this.cache.get(e);if(!t){const r=this,i=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(i.map(function(s,o){return r.getDependency(e,o)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],r=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Hi.KHR_BINARY_GLTF].body);const i=this.options;return new Promise(function(s,o){r.load(du.resolveURL(t.uri,i.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(r){const i=t.byteLength||0,s=t.byteOffset||0;return r.slice(s,s+i)})}loadAccessor(e){const t=this,r=this.json,i=this.json.accessors[e];if(i.bufferView===void 0&&i.sparse===void 0){const o=iN[i.type],l=Xb[i.componentType],a=i.normalized===!0,h=new l(i.count*o);return Promise.resolve(new ki(h,o,a))}const s=[];return i.bufferView!==void 0?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),i.sparse!==void 0&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then(function(o){const l=o[0],a=iN[i.type],h=Xb[i.componentType],f=h.BYTES_PER_ELEMENT,p=f*a,v=i.byteOffset||0,y=i.bufferView!==void 0?r.bufferViews[i.bufferView].byteStride:void 0,S=i.normalized===!0;let C,M;if(y&&y!==p){const E=Math.floor(v/y),L="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+E+":"+i.count;let k=t.cache.get(L);k||(C=new h(l,E*y,i.count*y/f),k=new Mw(C,y/f),t.cache.add(L,k)),M=new Zm(k,a,v%y/f,S)}else l===null?C=new h(i.count*a):C=new h(l,v,i.count*a),M=new ki(C,a,S);if(i.sparse!==void 0){const E=iN.SCALAR,L=Xb[i.sparse.indices.componentType],k=i.sparse.indices.byteOffset||0,H=i.sparse.values.byteOffset||0,X=new L(o[1],k,i.sparse.count*E),Z=new h(o[2],H,i.sparse.count*a);l!==null&&(M=new ki(M.array.slice(),M.itemSize,M.normalized));for(let Q=0,re=X.length;Q<re;Q++){const ie=X[Q];if(M.setX(ie,Z[Q*a]),a>=2&&M.setY(ie,Z[Q*a+1]),a>=3&&M.setZ(ie,Z[Q*a+2]),a>=4&&M.setW(ie,Z[Q*a+3]),a>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return M})}loadTexture(e){const t=this.json,r=this.options,s=t.textures[e].source,o=t.images[s];let l=this.textureLoader;if(o.uri){const a=r.manager.getHandler(o.uri);a!==null&&(l=a)}return this.loadTextureImage(e,s,l)}loadTextureImage(e,t,r){const i=this,s=this.json,o=s.textures[e],l=s.images[t],a=(l.uri||l.bufferView)+":"+o.sampler;if(this.textureCache[a])return this.textureCache[a];const h=this.loadImageSource(t,r).then(function(f){f.flipY=!1,f.name=o.name||l.name||"",f.name===""&&typeof l.uri=="string"&&l.uri.startsWith("data:image/")===!1&&(f.name=l.uri);const v=(s.samplers||{})[o.sampler]||{};return f.magFilter=CK[v.magFilter]||Ca,f.minFilter=CK[v.minFilter]||lu,f.wrapS=IK[v.wrapS]||Oh,f.wrapT=IK[v.wrapT]||Oh,i.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[a]=h,h}loadImageSource(e,t){const r=this,i=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(p=>p.clone());const o=i.images[e],l=self.URL||self.webkitURL;let a=o.uri||"",h=!1;if(o.bufferView!==void 0)a=r.getDependency("bufferView",o.bufferView).then(function(p){h=!0;const v=new Blob([p],{type:o.mimeType});return a=l.createObjectURL(v),a});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(a).then(function(p){return new Promise(function(v,y){let S=v;t.isImageBitmapLoader===!0&&(S=function(C){const M=new Xs(C);M.needsUpdate=!0,v(M)}),t.load(du.resolveURL(p,s.path),S,void 0,y)})}).then(function(p){return h===!0&&l.revokeObjectURL(a),Sm(p,o),p.userData.mimeType=o.mimeType||M4e(o.uri),p}).catch(function(p){throw console.error("THREE.GLTFLoader: Couldn't load texture",a),p});return this.sourceCache[e]=f,f}assignTexture(e,t,r,i){const s=this;return this.getDependency("texture",r.index).then(function(o){if(!o)return null;if(r.texCoord!==void 0&&r.texCoord>0&&(o=o.clone(),o.channel=r.texCoord),s.extensions[Hi.KHR_TEXTURE_TRANSFORM]){const l=r.extensions!==void 0?r.extensions[Hi.KHR_TEXTURE_TRANSFORM]:void 0;if(l){const a=s.associations.get(o);o=s.extensions[Hi.KHR_TEXTURE_TRANSFORM].extendTexture(o,l),s.associations.set(o,a)}}return i!==void 0&&(o.colorSpace=i),e[t]=o,o})}assignFinalMaterial(e){const t=e.geometry;let r=e.material;const i=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,o=t.attributes.normal===void 0;if(e.isPoints){const l="PointsMaterial:"+r.uuid;let a=this.cache.get(l);a||(a=new cu,ya.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,a.sizeAttenuation=!1,this.cache.add(l,a)),r=a}else if(e.isLine){const l="LineBasicMaterial:"+r.uuid;let a=this.cache.get(l);a||(a=new Eo,ya.prototype.copy.call(a,r),a.color.copy(r.color),a.map=r.map,this.cache.add(l,a)),r=a}if(i||s||o){let l="ClonedMaterial:"+r.uuid+":";i&&(l+="derivative-tangents:"),s&&(l+="vertex-colors:"),o&&(l+="flat-shading:");let a=this.cache.get(l);a||(a=r.clone(),s&&(a.vertexColors=!0),o&&(a.flatShading=!0),i&&(a.normalScale&&(a.normalScale.y*=-1),a.clearcoatNormalScale&&(a.clearcoatNormalScale.y*=-1)),this.cache.add(l,a),this.associations.set(a,this.associations.get(r))),r=a}e.material=r}getMaterialType(){return mp}loadMaterial(e){const t=this,r=this.json,i=this.extensions,s=r.materials[e];let o;const l={},a=s.extensions||{},h=[];if(a[Hi.KHR_MATERIALS_UNLIT]){const p=i[Hi.KHR_MATERIALS_UNLIT];o=p.getMaterialType(),h.push(p.extendParams(l,s,t))}else{const p=s.pbrMetallicRoughness||{};if(l.color=new Vn(1,1,1),l.opacity=1,Array.isArray(p.baseColorFactor)){const v=p.baseColorFactor;l.color.setRGB(v[0],v[1],v[2],jo),l.opacity=v[3]}p.baseColorTexture!==void 0&&h.push(t.assignTexture(l,"map",p.baseColorTexture,Ta)),l.metalness=p.metallicFactor!==void 0?p.metallicFactor:1,l.roughness=p.roughnessFactor!==void 0?p.roughnessFactor:1,p.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(l,"metalnessMap",p.metallicRoughnessTexture)),h.push(t.assignTexture(l,"roughnessMap",p.metallicRoughnessTexture))),o=this._invokeOne(function(v){return v.getMaterialType&&v.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(v){return v.extendMaterialParams&&v.extendMaterialParams(e,l)})))}s.doubleSided===!0&&(l.side=Ac);const f=s.alphaMode||sN.OPAQUE;if(f===sN.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,f===sN.MASK&&(l.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==_a&&(h.push(t.assignTexture(l,"normalMap",s.normalTexture)),l.normalScale=new nn(1,1),s.normalTexture.scale!==void 0)){const p=s.normalTexture.scale;l.normalScale.set(p,p)}if(s.occlusionTexture!==void 0&&o!==_a&&(h.push(t.assignTexture(l,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(l.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==_a){const p=s.emissiveFactor;l.emissive=new Vn().setRGB(p[0],p[1],p[2],jo)}return s.emissiveTexture!==void 0&&o!==_a&&h.push(t.assignTexture(l,"emissiveMap",s.emissiveTexture,Ta)),Promise.all(h).then(function(){const p=new o(l);return s.name&&(p.name=s.name),Sm(p,s),t.associations.set(p,{materials:e}),s.extensions&&iy(i,p,s),p})}createUniqueName(e){const t=es.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){const t=this,r=this.extensions,i=this.primitiveCache;function s(l){return r[Hi.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,t).then(function(a){return RK(a,l,t)})}const o=[];for(let l=0,a=e.length;l<a;l++){const h=e[l],f=T4e(h),p=i[f];if(p)o.push(p.promise);else{let v;h.extensions&&h.extensions[Hi.KHR_DRACO_MESH_COMPRESSION]?v=s(h):v=RK(new Xr,h,t),i[f]={primitive:h,promise:v},o.push(v)}}return Promise.all(o)}loadMesh(e){const t=this,r=this.json,i=this.extensions,s=r.meshes[e],o=s.primitives,l=[];for(let a=0,h=o.length;a<h;a++){const f=o[a].material===void 0?w4e(this.cache):this.getDependency("material",o[a].material);l.push(f)}return l.push(t.loadGeometries(o)),Promise.all(l).then(function(a){const h=a.slice(0,a.length-1),f=a[a.length-1],p=[];for(let y=0,S=f.length;y<S;y++){const C=f[y],M=o[y];let E;const L=h[y];if(M.mode===_h.TRIANGLES||M.mode===_h.TRIANGLE_STRIP||M.mode===_h.TRIANGLE_FAN||M.mode===void 0)E=s.isSkinnedMesh===!0?new yD(C,L):new Ri(C,L),E.isSkinnedMesh===!0&&E.normalizeSkinWeights(),M.mode===_h.TRIANGLE_STRIP?E.geometry=Q$(E.geometry,YM):M.mode===_h.TRIANGLE_FAN&&(E.geometry=Q$(E.geometry,rx));else if(M.mode===_h.LINES)E=new pu(C,L);else if(M.mode===_h.LINE_STRIP)E=new Jf(C,L);else if(M.mode===_h.LINE_LOOP)E=new bD(C,L);else if(M.mode===_h.POINTS)E=new Eh(C,L);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+M.mode);Object.keys(E.geometry.morphAttributes).length>0&&A4e(E,s),E.name=t.createUniqueName(s.name||"mesh_"+e),Sm(E,s),M.extensions&&iy(i,E,M),t.assignFinalMaterial(E),p.push(E)}for(let y=0,S=p.length;y<S;y++)t.associations.set(p[y],{meshes:e,primitives:y});if(p.length===1)return s.extensions&&iy(i,p[0],s),p[0];const v=new ql;s.extensions&&iy(i,v,s),t.associations.set(v,{meshes:e});for(let y=0,S=p.length;y<S;y++)v.add(p[y]);return v})}loadCamera(e){let t;const r=this.json.cameras[e],i=r[r.type];if(!i){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return r.type==="perspective"?t=new ts(ra.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):r.type==="orthographic"&&(t=new nd(-i.xmag,i.xmag,i.ymag,-i.ymag,i.znear,i.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),Sm(t,r),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],r=[];for(let i=0,s=t.joints.length;i<s;i++)r.push(this._loadNodeShallow(t.joints[i]));return t.inverseBindMatrices!==void 0?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(i){const s=i.pop(),o=i,l=[],a=[];for(let h=0,f=o.length;h<f;h++){const p=o[h];if(p){l.push(p);const v=new Gr;s!==null&&v.fromArray(s.array,h*16),a.push(v)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new Ew(l,a)})}loadAnimation(e){const t=this.json,r=this,i=t.animations[e],s=i.name?i.name:"animation_"+e,o=[],l=[],a=[],h=[],f=[];for(let p=0,v=i.channels.length;p<v;p++){const y=i.channels[p],S=i.samplers[y.sampler],C=y.target,M=C.node,E=i.parameters!==void 0?i.parameters[S.input]:S.input,L=i.parameters!==void 0?i.parameters[S.output]:S.output;C.node!==void 0&&(o.push(this.getDependency("node",M)),l.push(this.getDependency("accessor",E)),a.push(this.getDependency("accessor",L)),h.push(S),f.push(C))}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(a),Promise.all(h),Promise.all(f)]).then(function(p){const v=p[0],y=p[1],S=p[2],C=p[3],M=p[4],E=[];for(let L=0,k=v.length;L<k;L++){const H=v[L],X=y[L],Z=S[L],Q=C[L],re=M[L];if(H===void 0)continue;H.updateMatrix&&H.updateMatrix();const ie=r._createAnimationTracks(H,X,Z,Q,re);if(ie)for(let oe=0;oe<ie.length;oe++)E.push(ie[oe])}return new ax(s,void 0,E)})}createNodeMesh(e){const t=this.json,r=this,i=t.nodes[e];return i.mesh===void 0?null:r.getDependency("mesh",i.mesh).then(function(s){const o=r._getNodeRef(r.meshCache,i.mesh,s);return i.weights!==void 0&&o.traverse(function(l){if(l.isMesh)for(let a=0,h=i.weights.length;a<h;a++)l.morphTargetInfluences[a]=i.weights[a]}),o})}loadNode(e){const t=this.json,r=this,i=t.nodes[e],s=r._loadNodeShallow(e),o=[],l=i.children||[];for(let h=0,f=l.length;h<f;h++)o.push(r.getDependency("node",l[h]));const a=i.skin===void 0?Promise.resolve(null):r.getDependency("skin",i.skin);return Promise.all([s,Promise.all(o),a]).then(function(h){const f=h[0],p=h[1],v=h[2];v!==null&&f.traverse(function(y){y.isSkinnedMesh&&y.bind(v,E4e)});for(let y=0,S=p.length;y<S;y++)f.add(p[y]);return f})}_loadNodeShallow(e){const t=this.json,r=this.extensions,i=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=t.nodes[e],o=s.name?i.createUniqueName(s.name):"",l=[],a=i._invokeOne(function(h){return h.createNodeMesh&&h.createNodeMesh(e)});return a&&l.push(a),s.camera!==void 0&&l.push(i.getDependency("camera",s.camera).then(function(h){return i._getNodeRef(i.cameraCache,s.camera,h)})),i._invokeAll(function(h){return h.createNodeAttachment&&h.createNodeAttachment(e)}).forEach(function(h){l.push(h)}),this.nodeCache[e]=Promise.all(l).then(function(h){let f;if(s.isBone===!0?f=new nE:h.length>1?f=new ql:h.length===1?f=h[0]:f=new Pi,f!==h[0])for(let p=0,v=h.length;p<v;p++)f.add(h[p]);if(s.name&&(f.userData.name=s.name,f.name=o),Sm(f,s),s.extensions&&iy(r,f,s),s.matrix!==void 0){const p=new Gr;p.fromArray(s.matrix),f.applyMatrix4(p)}else s.translation!==void 0&&f.position.fromArray(s.translation),s.rotation!==void 0&&f.quaternion.fromArray(s.rotation),s.scale!==void 0&&f.scale.fromArray(s.scale);return i.associations.has(f)||i.associations.set(f,{}),i.associations.get(f).nodes=e,f}),this.nodeCache[e]}loadScene(e){const t=this.extensions,r=this.json.scenes[e],i=this,s=new ql;r.name&&(s.name=i.createUniqueName(r.name)),Sm(s,r),r.extensions&&iy(t,s,r);const o=r.nodes||[],l=[];for(let a=0,h=o.length;a<h;a++)l.push(i.getDependency("node",o[a]));return Promise.all(l).then(function(a){for(let f=0,p=a.length;f<p;f++)s.add(a[f]);const h=f=>{const p=new Map;for(const[v,y]of i.associations)(v instanceof ya||v instanceof Xs)&&p.set(v,y);return f.traverse(v=>{const y=i.associations.get(v);y!=null&&p.set(v,y)}),p};return i.associations=h(s),s})}_createAnimationTracks(e,t,r,i,s){const o=[],l=e.name?e.name:e.uuid,a=[];Cv[s.path]===Cv.weights?e.traverse(function(v){v.morphTargetInfluences&&a.push(v.name?v.name:v.uuid)}):a.push(l);let h;switch(Cv[s.path]){case Cv.weights:h=Ym;break;case Cv.rotation:h=Km;break;case Cv.position:case Cv.scale:h=Jm;break;default:switch(r.itemSize){case 1:h=Ym;break;case 2:case 3:default:h=Jm;break}break}const f=i.interpolation!==void 0?b4e[i.interpolation]:p0,p=this._getArrayFromAccessor(r);for(let v=0,y=a.length;v<y;v++){const S=new h(a[v]+"."+Cv[s.path],t.array,p,f);i.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(S),o.push(S)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){const r=T5(t.constructor),i=new Float32Array(t.length);for(let s=0,o=t.length;s<o;s++)i[s]=t[s]*r;t=i}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(r){const i=this instanceof Km?x4e:sce;return new i(this.times,this.values,this.getValueSize()/3,r)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function I4e(n,e,t){const r=e.attributes,i=new Al;if(r.POSITION!==void 0){const l=t.json.accessors[r.POSITION],a=l.min,h=l.max;if(a!==void 0&&h!==void 0){if(i.set(new Ze(a[0],a[1],a[2]),new Ze(h[0],h[1],h[2])),l.normalized){const f=T5(Xb[l.componentType]);i.min.multiplyScalar(f),i.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const l=new Ze,a=new Ze;for(let h=0,f=s.length;h<f;h++){const p=s[h];if(p.POSITION!==void 0){const v=t.json.accessors[p.POSITION],y=v.min,S=v.max;if(y!==void 0&&S!==void 0){if(a.setX(Math.max(Math.abs(y[0]),Math.abs(S[0]))),a.setY(Math.max(Math.abs(y[1]),Math.abs(S[1]))),a.setZ(Math.max(Math.abs(y[2]),Math.abs(S[2]))),v.normalized){const C=T5(Xb[v.componentType]);a.multiplyScalar(C)}l.max(a)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(l)}n.boundingBox=i;const o=new sl;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,n.boundingSphere=o}function RK(n,e,t){const r=e.attributes,i=[];function s(o,l){return t.getDependency("accessor",o).then(function(a){n.setAttribute(l,a)})}for(const o in r){const l=A5[o]||o.toLowerCase();l in n.attributes||i.push(s(r[o],l))}if(e.indices!==void 0&&!n.index){const o=t.getDependency("accessor",e.indices).then(function(l){n.setIndex(l)});i.push(o)}return gs.workingColorSpace!==jo&&"COLOR_0"in r&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${gs.workingColorSpace}" not supported.`),Sm(n,e),I4e(n,e,t),Promise.all(i).then(function(){return e.targets!==void 0?S4e(n,e.targets,t):n})}const R4e=()=>{let n=Ae.useRef(null),e=Ae.useRef(null),t,r,i,s,o,l,a=null;const h=new sg;let f=0,p=!1;const v={x:0,y:0};let y=()=>{t=new Jl({canvas:n.current,antialias:!0,alpha:!0,powerPreference:"high-performance"}),r=new Jl({canvas:e.current,antialias:!1});const L={width:n.current.clientWidth,height:n.current.clientHeight};t.autoClear=!0,t.outputColorSpace=Ta,t.setSize(L.width,L.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.outputColorSpace=Ta,r.setSize(L.width,L.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),i=new Ml,s=new ql,o=new ts(35,1,1,100),l=new ts(35,1,1,100),i.add(s),o.aspect=L.width/L.height,o.position.set(19,1.54,-.1),s.add(o),l.aspect=L.width/L.height,l.position.set(3,3,3),l.rotation.set(0,1,0),i.add(l);const k=new B0(16777215,.8);k.position.set(-100,0,-100),i.add(k),a=new a0(8978414,2.7,4,3),a.position.set(30,3,1.8),i.add(a);const H=new lE;H.onLoad=()=>{document.querySelector(".content").style.visibility="visible";let oe={y:0};const fe=document.querySelector(".lds-roller"),Se=document.getElementById("loading-text-intro"),Ee=new RA(oe).to({y:100},900).easing(np.Quadratic.InOut).start().onUpdate(()=>{Se.style.setProperty("transform",`translate(0,${oe.y}%)`)}).onComplete(()=>{Se.parentNode.removeChild(document.getElementById("loading-text-intro")),PA(Ee)}),Ie=new RA(o.position.set(0,4,2)).to({x:0,y:2.4,z:5.8},3500).easing(np.Quadratic.InOut).start().onComplete(()=>{PA(Ie),document.querySelector(".nav-head").classList.add("ended"),document.querySelector(".description").classList.add("ended")});fe.parentNode.removeChild(fe),window.scroll(0,0)},H.onError=oe=>{console.log("There was an error loading "+oe)};const X="/about_portfolio/",Z=new a8;Z.setDecoderPath(`${X}/draco/`),Z.setDecoderConfig({type:"js"});const Q=new SB(H);Q.setDRACOLoader(Z);let re;Q.load(qNe,oe=>{oe.scene.traverse(fe=>{fe.isMesh&&(re=fe.material,fe.material=new aE({shininess:100}))}),i.add(oe.scene),re.dispose(),t.renderLists.dispose()}),new IntersectionObserver(oe=>{p=oe[0].intersectionRatio>.05},{threshold:.05}).observe(document.querySelector(".second"))};const S=function(L){const k=document.querySelector("span");if(L.type==="mouseleave")k.style.cssText="";else{const{offsetX:H,offsetY:X}=L,{offsetWidth:Z,offsetHeight:Q}=this,re=20,ie=H/Z*(re*2)-re,oe=X/Q*(re*2)-re;k.style.cssText=`transform: translate(${ie}px, ${oe}px);`}},C=()=>{const L=h.getElapsedTime(),k=L-f;f=L;const H=v.y,X=v.x;a.position.y-=(H*9+a.position.y-2)*k,a.position.x+=(X*8-a.position.x)*2*k,s.position.z-=(H/3+s.position.z)*2*k,s.position.x+=(X/3-s.position.x)*2*k,hie(),p?r.render(i,l):t.render(i,o),requestAnimationFrame(C)},M=(L,k)=>{const H=new RA(l.position).to(L,3500).easing(np.Quadratic.InOut).start().onComplete(()=>{PA(H)}),X=new RA(l.rotation).to(k,3500).easing(np.Quadratic.InOut).start().onComplete(()=>{PA(X)})},E=()=>{let L={width:n.current.clientWidth,height:n.current.clientHeight};t.setSize(L.width,L.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.setSize(L.width,L.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),o.aspect=L.width/L.height,o.updateProjectionMatrix(),l.aspect=L.width/L.height,l.updateProjectionMatrix()};return Ae.useEffect(()=>{y(),C(),document.addEventListener("mousemove",k=>{k.preventDefault(),v.x=k.clientX/window.innerWidth-.5,v.y=k.clientY/window.innerHeight-.5,document.querySelector(".cursor").style.cssText=`left: ${k.clientX}px; top: ${k.clientY}px;`},!1);const L=document.querySelectorAll(".nav-head > .a");return L.forEach(k=>k.addEventListener("mousemove",S)),L.forEach(k=>k.addEventListener("mouseleave",S)),document.getElementById("one").addEventListener("click",()=>{document.getElementById("one").classList.add("active"),document.getElementById("two").classList.remove("active"),document.getElementById("three").classList.remove("active"),M({x:3,y:3,z:3},{x:0,y:1,z:0}),document.getElementById("content").innerText=""}),document.getElementById("two").addEventListener("click",()=>{document.getElementById("one").classList.remove("active"),document.getElementById("two").classList.add("active"),document.getElementById("three").classList.remove("active"),M({x:-1.4,y:2.8,z:4.4},{x:0,y:-.1,z:0}),document.getElementById("content").innerText=""}),document.getElementById("three").addEventListener("click",()=>{document.getElementById("one").classList.remove("active"),document.getElementById("two").classList.remove("active"),document.getElementById("three").classList.add("active"),M({x:-4.8,y:2.9,z:3.2},{x:0,y:-.75,z:0}),document.getElementById("content").innerText=""}),window.addEventListener("resize",E),()=>{window.removeEventListener("resize",E)}},[]),me.jsxs("div",{className:"shadow_page",children:[me.jsxs("div",{className:"lds-roller",children:[me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{})]}),me.jsx("div",{id:"loading-text-intro",children:me.jsx("p",{children:"Loading"})}),me.jsxs("div",{className:"content",style:{visibility:"hidden"},children:[me.jsxs("div",{className:"nav-head",children:[me.jsx("a",{href:"#",className:"a active",children:me.jsx("span",{children:"Main"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"About"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"Gallery"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"Contact"})}),me.jsx("a",{href:"#",className:"a",children:me.jsx("span",{children:"More"})}),me.jsx("div",{className:"cursor"})]}),me.jsxs("section",{className:"section first",children:[me.jsx("canvas",{ref:n,id:"container",className:"webgl"}),me.jsxs("div",{className:"info",children:[me.jsx("h2",{className:"name",children:"DEAGONIR"}),me.jsx("h1",{className:"title",children:"THREEJS"}),me.jsx("p",{className:"description",children:""})]})]}),me.jsxs("section",{className:"section second",children:[me.jsxs("div",{className:"second-container",children:[me.jsxs("ul",{children:[me.jsx("li",{id:"one",className:"active",children:"start"}),me.jsx("li",{id:"two",children:"running"}),me.jsx("li",{id:"three",children:"finished"})]}),me.jsx("p",{className:"text",id:"content",children:""})]}),me.jsx("canvas",{ref:e,id:"containerDetails",className:"webgl"})]})]})]})};var P4e=`uniform vec3 iResolution; 
uniform float iTime;      \r

varying vec2 vUv;\r

#ifdef FAST_DESCENT\r
const vec3 cameraDir = normalize(vec3(-2.0, -1.0, -4.0));\r
const float cameraDist = 5.0;\r
const float speed = 3.0;\r
const float zoom = 2.5;

const vec3 windowColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 windowColorB = vec3(0.5, 1.5, 2.0);

const float fogOffset = 2.5;\r
const float fogDensity = 0.6;\r
const vec3 fogColor = vec3(0.25, 0.0, 0.3);

const float lightHeight = 0.5;\r
const float lightSpeed = 0.2;\r
const vec3 lightColorA = vec3(0.6, 0.3, 0.1);\r
const vec3 lightColorB = vec3(0.8, 0.6, 0.4);

const vec3 signColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 signColorB = vec3(3.0, 3.0, 3.0);\r
#else\r
const vec3 cameraDir = normalize(vec3(-2.0, -1.0, -2.0));\r
const float cameraDist = 9.0;\r
const float speed = 1.0;\r
const float zoom = 3.5;

const vec3 windowColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 windowColorB = vec3(0.5, 1.5, 2.0);

const float fogOffset = 7.0;\r
const float fogDensity = 0.7;\r
const vec3 fogColor = vec3(0.25, 0.0, 0.3);

const float lightHeight = 0.0;\r
const float lightSpeed = 0.15;\r
const vec3 lightColorA = vec3(0.6, 0.3, 0.1);\r
const vec3 lightColorB = vec3(0.8, 0.6, 0.4);

const vec3 signColorA = vec3(0.0, 0.0, 1.5);\r
const vec3 signColorB = vec3(3.0, 3.0, 3.0);\r
#endif

const float tau = 6.283185;

float hash1(float p) {\r
  vec3 p3 = fract(p * vec3(5.3983, 5.4427, 6.9371));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.x + p3.y) * p3.z);\r
}

float hash1(vec2 p2) {\r
  p2 = fract(p2 * vec2(5.3983, 5.4427));\r
  p2 += dot(p2.yx, p2.xy + vec2(21.5351, 14.3137));\r
  return fract(p2.x * p2.y * 95.4337);\r
}

float hash1(vec2 p2, float p) {\r
  vec3 p3 = fract(vec3(5.3983 * p2.x, 5.4427 * p2.y, 6.9371 * p));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.x + p3.y) * p3.z);\r
}

vec2 hash2(vec2 p2, float p) {\r
  vec3 p3 = fract(vec3(5.3983 * p2.x, 5.4427 * p2.y, 6.9371 * p));\r
  p3 += dot(p3, p3.yzx + 19.19);\r
  return fract((p3.xx + p3.yz) * p3.zy);\r
}

vec3 hash3(vec2 p2) {\r
  vec3 p3 = fract(vec3(p2.xyx) * vec3(5.3983, 5.4427, 6.9371));\r
  p3 += dot(p3, p3.yxz + 19.19);\r
  return fract((p3.xxy + p3.yzz) * p3.zyx);\r
}

vec4 hash4(vec2 p2) {\r
  vec4 p4 = fract(p2.xyxy * vec4(5.3983, 5.4427, 6.9371, 7.1283));\r
  p4 += dot(p4, p4.yxwz + 19.19);\r
  return fract((p4.xxxy + p4.yyzz + p4.zwww) * p4.wzyx);\r
}

float noise(vec2 p) {\r
  vec2 i = floor(p);\r
  vec2 f = fract(p);\r
  vec2 u = f * f * (3.0 - 2.0 * f);\r
  return mix(mix(hash1(i + vec2(0.0, 0.0)), hash1(i + vec2(1.0, 0.0)), u.x),\r
             mix(hash1(i + vec2(0.0, 1.0)), hash1(i + vec2(1.0, 1.0)), u.x),\r
             u.y);\r
}

vec4 castRay(vec3 eye, vec3 ray, vec2 center) {\r
  vec2 block = floor(eye.xy);\r
  vec3 ri = 1.0 / ray;\r
  vec3 rs = sign(ray);\r
  vec3 side = 0.5 + 0.5 * rs;\r
  vec2 ris = ri.xy * rs.xy;\r
  vec2 dis = (block - eye.xy + 0.5 + rs.xy * 0.5) * ri.xy;

  for (int i = 0; i < 16; ++i) {\r
    float d = dot(block - center, cameraDir.xy);\r
    float height = 3.0 * hash1(block) - 1.0 + 1.5 * d - 0.1 * d * d;

    vec2 lo0 = vec2(block);\r
    vec2 loX = vec2(0.45, 0.45);\r
    vec2 hi0 = vec2(block + 0.55);\r
    vec2 hiX = vec2(0.45, 0.45);

    float dist = 500.0;\r
    float face = 0.0;

    {\r
      vec4 signHash = hash4(block);\r
      vec2 center = vec2(0.2, -0.4) + vec2(0.6, -0.8) * signHash.xy;\r
      float width = 0.06 + 0.1 * signHash.w;

      vec3 lo = vec3(center.x - width, 0.55, -100.0);\r
      vec3 hi = vec3(center.x + width, 0.99, center.y + width + height);

      float s = step(0.5, signHash.z);\r
      lo = vec3(block, 0.0) + mix(lo, lo.yxz, s);\r
      hi = vec3(block, 0.0) + mix(hi, hi.yxz, s);

      vec3 wall = mix(hi, lo, side);\r
      vec3 t = (wall - eye) * ri;

      vec3 dim = step(t.zxy, t) * step(t.yzx, t);\r
      float maxT = dot(dim, t);\r
      float maxFace = dim.x - dim.y;

      vec3 p = eye + maxT * ray;\r
      dim += step(lo, p) * step(p, hi);

      if (dim.x * dim.y * dim.z > 0.5) {\r
        dist = maxT;\r
        face = maxFace;\r
      }\r
    }

    for (int j = 0; j < 5; ++j) {\r
      float top = height - 0.4 * float(j);\r
      vec3 lo = vec3(lo0 + loX * hash2(block, float(j)), -100.0);\r
      vec3 hi = vec3(hi0 + hiX * hash2(block, float(j) + 0.5), top);

      vec3 wall = mix(hi, lo, side);\r
      vec3 t = (wall - eye) * ri;

      vec3 dim = step(t.zxy, t) * step(t.yzx, t);\r
      float maxT = dot(dim, t);\r
      float maxFace = dim.x - dim.y;

      vec3 p = eye + maxT * ray;\r
      dim += step(lo, p) * step(p, hi);

      if (dim.x * dim.y * dim.z > 0.5 && maxT < dist) {\r
        dist = maxT;\r
        face = maxFace;\r
      }\r
    }

    if (dist < 400.0) {\r
      return vec4(dist, height, face, 1.0);\r
    }

    float t = eye.z * ri.z;\r
    vec3 p = eye - t * ray;\r
    vec2 g = p.xy - block;

    vec2 dim = step(dis.xy, dis.yx);\r
    dis += dim * ris;\r
    block += dim * rs.xy;\r
  }

  return vec4(100.0, 0.0, 0.0, 1.0);\r
}

vec3 window(float z, vec2 pos, vec2 id) {\r
  float windowSize = 0.03 + 0.12 * hash1(id + 0.1);\r
  float windowProb = 0.3 + 0.8 * hash1(id + 0.2);\r
  float depth = z / windowSize;\r
  float level = floor(depth);\r
  vec3 colorA = mix(windowColorA, windowColorB, hash3(id));\r
  vec3 colorB = mix(windowColorA, windowColorB, hash3(id + 0.1));\r
  vec3 color = mix(colorA, colorB, hash1(id, level));\r
  color *= 0.3 +\r
           0.7 * smoothstep(0.1, 0.5, noise(20.0 * pos + 100.0 * hash1(level)));\r
  color *=\r
      smoothstep(windowProb - 0.2, windowProb + 0.2, hash1(id, level + 0.1));\r
  return color * (0.5 - 0.5 * cos(tau * depth));\r
}

vec3 addLight(vec3 eye, vec3 ray, float res, float time, float height) {\r
  vec2 q = eye.xy + ((height - eye.z) / ray.z) * ray.xy;

  float row = floor(q.x + 0.5);\r
  time += hash1(row);\r
  float col = floor(0.125 * q.y - time);

  float pos = 0.4 + 0.4 * cos(time + tau * hash1(vec2(row, col)));\r
  vec3 lightPos = vec3(row, 8.0 * (col + time + pos), height);\r
  vec3 lightDir = vec3(0.0, 1.0, 0.0);

  
  vec3 w = eye - lightPos;\r
  float a = dot(ray, ray);\r
  float b = dot(ray, lightDir);\r
  float c = dot(lightDir, lightDir);\r
  float d = dot(ray, w);\r
  float e = dot(lightDir, w);\r
  float D = a * c - b * b;\r
  float s = (b * e - c * d) / D;\r
  float t = (a * e - b * d) / D;

  t = max(t, 0.0);\r
  float dist = distance(eye + s * ray, lightPos + t * lightDir);

  float mask = smoothstep(res + 0.1, res, s);\r
  float light =\r
      min(1.0 / pow(200.0 * dist * dist / t + 20.0 * t * t, 0.8), 2.0);\r
  float fog = exp(-fogDensity * max(s - fogOffset, 0.0));\r
  vec3 color = mix(lightColorA, lightColorB, hash3(vec2(row, col)));\r
  return mask * light * fog * color;\r
}

vec3 addSign(vec3 color, vec3 pos, float side, vec2 id) {\r
  vec4 signHash = hash4(id);\r
  float s = step(0.5, signHash.z);\r
  if ((s - 0.5) * side < 0.1)\r
    return color;

  vec2 center = vec2(0.2, -0.4) + vec2(0.6, -0.8) * signHash.xy;\r
  vec2 p = mix(pos.xz, pos.yz, s);\r
  float halfWidth = 0.04 + 0.06 * signHash.w;

  float charCount = floor(1.0 + 8.0 * hash1(id + 0.5));\r
  if (center.y - p.y > 2.0 * halfWidth * (charCount + 1.0)) {\r
    center.y -= 2.0 * halfWidth * (charCount + 1.5 + 5.0 * hash1(id + 0.6));\r
    charCount = floor(2.0 + 12.0 * hash1(id + 0.7));\r
    id += 0.05;\r
  }

  vec3 signColor = mix(signColorA, signColorB, hash3(id + 0.5));\r
  vec3 outlineColor = mix(signColorA, signColorB, hash3(id + 0.6));\r
  float flash = 6.0 - 24.0 * hash1(id + 0.8);\r
  flash *= step(3.0, flash);\r
  flash = smoothstep(0.1, 0.5, 0.5 + 0.5 * cos(flash * iTime));

  vec2 halfSize = vec2(halfWidth, halfWidth * charCount);\r
  center.y -= halfSize.y;\r
  float outline = length(max(abs(p - center) - halfSize, 0.0)) / halfWidth;\r
  color *= smoothstep(0.1, 0.4, outline);

  vec2 charPos = 0.5 * (p - center + halfSize) / halfWidth;\r
  vec2 charId = id + 0.05 + 0.1 * floor(charPos);\r
  float flicker = hash1(charId);\r
  flicker = step(0.93, flicker);\r
  flicker = 1.0 - flicker * step(0.96, hash1(charId, iTime));

  float char = -3.5 + 8.0 * noise(id + 6.0 * charPos);\r
  charPos = fract(charPos);\r
  char *= smoothstep(0.0, 0.4, charPos.x) * smoothstep(1.0, 0.6, charPos.x);\r
  char *= smoothstep(0.0, 0.4, charPos.y) * smoothstep(1.0, 0.6, charPos.y);\r
  color = mix(color, signColor,\r
              flash * flicker * step(outline, 0.01) * clamp(char, 0.0, 1.0));

  outline = smoothstep(0.0, 0.2, outline) * smoothstep(0.5, 0.3, outline);\r
  return mix(color, outlineColor, flash * outline);\r
}

void main() {\r
  vec2 center = -speed * iTime * cameraDir.xy;\r
  vec3 eye = vec3(center, 0.0) - cameraDist * cameraDir;

  vec3 forward = normalize(cameraDir);\r
  vec3 right = normalize(cross(forward, vec3(0.0, 0.0, 1.0)));\r
  vec3 up = cross(right, forward);\r
  
  vec2 xy = vUv - 0.5;\r
  
  
  vec3 ray = normalize(xy.x * right + xy.y * up + zoom * forward * 0.4);

  vec4 res = castRay(eye, ray, center);\r
  vec3 p = eye + res.x * ray;

  vec2 block = floor(p.xy);\r
  vec3 color = window(p.z - res.y, p.xy, block);

  color = addSign(color, vec3(p.xy - block, p.z - res.y), res.z, block);\r
  color = mix(vec3(0.0), color, abs(res.z));

  float fog = exp(-fogDensity * max(res.x - fogOffset, 0.0));\r
  color = mix(fogColor, color, fog);

  float time = lightSpeed * iTime;\r
  color += addLight(eye.xyz, ray.xyz, res.x, time, lightHeight - 0.6);\r
  color += addLight(eye.yxz, ray.yxz, res.x, time, lightHeight - 0.4);\r
  color += addLight(vec3(-eye.xy, eye.z), vec3(-ray.xy, ray.z), res.x, time,\r
                    lightHeight - 0.2);\r
  color += addLight(vec3(-eye.yx, eye.z), vec3(-ray.yx, ray.z), res.x, time,\r
                    lightHeight);

#ifdef BLACK_AND_WHITE\r
  float c = clamp(dot(vec3(0.4, 0.3, 0.4), color), 0.0, 1.0);\r
  c = 1.0 - pow(1.0 - pow(c, 2.0), 4.0);\r
  color = vec3(c);\r
#endif

  gl_FragColor = vec4(color, 1.0);\r
}`;const L4e=()=>{let n=null,e=null,t=null,r=null,i=null,s=Ae.useRef(null);const o=()=>{r={width:s.current.clientWidth,height:s.current.clientHeight},n=new Ml,n.fog=new Tw(1710618,1,1e3),n.background=new Vn(1710618),e=new ts(70,r.width/r.height,.01,1e3),e.position.set(0,0,5),n.add(e),t=new Tx(14609919,3),n.add(t),i=new Jl({canvas:s.current,alpha:!0,antialias:!0}),i.setSize(r.width,r.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2));const h=new k0(e,i.domElement);h.enableDamping=!0,n.add(h)},l=()=>{const{x:h,y:f}=i.getDrawingBufferSize(new nn),p=new Ia({vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,fragmentShader:P4e,uniforms:{iResolution:{value:new Ze(h,f)},iTime:{value:0}}}),v=new Ri(new ig(5,5),p);v.onBeforeRender=()=>{p.uniforms.iTime.value+=.01},n.add(v)},a=()=>{i.render(n,e),requestAnimationFrame(a)};return Ae.useEffect(()=>{o(),l(),a()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{className:"w-full h-full",ref:s})})},D4e=()=>{let n=null,e=null,t=null,r=Ae.useRef(null),i,s,o;const l=()=>{i=new bp(5,5,5),s=new _a({color:16711680}),o=new Ri(i,s);let h={width:r.current.clientWidth,height:r.current.clientHeight};n=new Ml,n.add(o),e=new ts(70,h.width/h.height,.01,1e3),e.position.z=10,t=new Jl({canvas:r.current,antialias:!0}),t.setSize(h.width,h.height)},a=()=>{o&&(o.rotation.y+=.02),o&&(o.rotation.x+=.02),t.render(n,e),requestAnimationFrame(a)};return Ae.useEffect(()=>{l(),a()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{className:"w-full h-full",ref:r})})},B4e="/about_portfolio/assets/cat-DI6FY0oP.mp3",k4e="/about_portfolio/assets/cow-D6Dskg5A.mp3",O4e="/about_portfolio/assets/bg-BEcaSD04.png",ace="/about_portfolio/assets/perlinnoise-D9vz38ra.png",oce="/about_portfolio/assets/sparknoise-C0zIzS_R.png",PK=new Ze,oN=new hM,lN=new Ze;class lce{constructor(e,t){this.object=e,this.domElement=t,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.pointerX=0,this.pointerY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;let r=0,i=0;this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onPointerDown=function(p){if(this.domElement!==document&&this.domElement.focus(),this.activeLook)switch(p.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0;break}this.mouseDragOn=!0},this.onPointerUp=function(p){if(this.activeLook)switch(p.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1;break}this.mouseDragOn=!1},this.onPointerMove=function(p){this.domElement===document?(this.pointerX=p.pageX-this.viewHalfX,this.pointerY=p.pageY-this.viewHalfY):(this.pointerX=p.pageX-this.domElement.offsetLeft-this.viewHalfX,this.pointerY=p.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(p){switch(p.code){case"ArrowUp":case"KeyW":this.moveForward=!0;break;case"ArrowLeft":case"KeyA":this.moveLeft=!0;break;case"ArrowDown":case"KeyS":this.moveBackward=!0;break;case"ArrowRight":case"KeyD":this.moveRight=!0;break;case"KeyR":this.moveUp=!0;break;case"KeyF":this.moveDown=!0;break}},this.onKeyUp=function(p){switch(p.code){case"ArrowUp":case"KeyW":this.moveForward=!1;break;case"ArrowLeft":case"KeyA":this.moveLeft=!1;break;case"ArrowDown":case"KeyS":this.moveBackward=!1;break;case"ArrowRight":case"KeyD":this.moveRight=!1;break;case"KeyR":this.moveUp=!1;break;case"KeyF":this.moveDown=!1;break}},this.lookAt=function(p,v,y){return p.isVector3?lN.copy(p):lN.set(p,v,y),this.object.lookAt(lN),f(this),this},this.update=function(){const p=new Ze;return function(y){if(this.enabled===!1)return;if(this.heightSpeed){const X=ra.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin;this.autoSpeedFactor=y*(X*this.heightCoef)}else this.autoSpeedFactor=0;const S=y*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(S+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(S),this.moveLeft&&this.object.translateX(-S),this.moveRight&&this.object.translateX(S),this.moveUp&&this.object.translateY(S),this.moveDown&&this.object.translateY(-S);let C=y*this.lookSpeed;this.activeLook||(C=0);let M=1;this.constrainVertical&&(M=Math.PI/(this.verticalMax-this.verticalMin)),i-=this.pointerX*C,this.lookVertical&&(r-=this.pointerY*C*M),r=Math.max(-85,Math.min(85,r));let E=ra.degToRad(90-r);const L=ra.degToRad(i);this.constrainVertical&&(E=ra.mapLinear(E,0,Math.PI,this.verticalMin,this.verticalMax));const k=this.object.position;p.setFromSphericalCoords(1,E,L).add(k),this.object.lookAt(p)}}(),this.dispose=function(){this.domElement.removeEventListener("contextmenu",LK),this.domElement.removeEventListener("pointerdown",o),this.domElement.removeEventListener("pointermove",s),this.domElement.removeEventListener("pointerup",l),window.removeEventListener("keydown",a),window.removeEventListener("keyup",h)};const s=this.onPointerMove.bind(this),o=this.onPointerDown.bind(this),l=this.onPointerUp.bind(this),a=this.onKeyDown.bind(this),h=this.onKeyUp.bind(this);this.domElement.addEventListener("contextmenu",LK),this.domElement.addEventListener("pointerdown",o),this.domElement.addEventListener("pointermove",s),this.domElement.addEventListener("pointerup",l),window.addEventListener("keydown",a),window.addEventListener("keyup",h);function f(p){const v=p.object.quaternion;PK.set(0,0,-1).applyQuaternion(v),oN.setFromVector3(PK),r=90-ra.radToDeg(oN.phi),i=ra.radToDeg(oN.theta)}this.handleResize(),f(this)}}function LK(n){n.preventDefault()}const F4e=()=>{const n=Ae.useRef(null);let e,t,r,i=null,s={width:0,height:0};const o=()=>{s.width=window.innerWidth,s.height=window.innerHeight,t.aspect=s.width/s.height,t.updateProjectionMatrix(),r.setSize(s.width,s.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2))},l=()=>{s.width=window.innerWidth,s.height=window.innerHeight,e=new Ml,t=new ts(50,s.width/s.height,1,1e5),t.position.set(-200,25,0),t.lookAt(.1,.1,.1),e.add(t),r=new Jl({canvas:n.current,antialias:!0,alpha:!0}),r.setSize(s.width,s.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.render(e,t);const v=new B0(16777215,1);v.position.set(0,.5,1).normalize(),e.add(v),i=new lce(t,r.domElement),i.movementSpeed=50,i.lookSpeed=.1,i.noFly=!0,i.lookVertical=!1},a=()=>{e.background=new Qf().load(O4e),h(k4e,ace,0,20,-50),h(B4e,oce,0,20,50)},h=(v,y,S,C,M)=>{let E=new cre;t.add(E);let L=new Ri(new bp(40,40,40),new _a({map:new Qf().load(y)}));L.position.set(S,C,M),e.add(L);var k=new hre(E),H=new lre;H.load(v,X=>{k.setBuffer(X),k.setRefDistance(30),k.play(),k.setRolloffFactor(10),k.setLoop(!0)})},f=new sg,p=()=>{r.render(e,t),i.update(f.getDelta()),requestAnimationFrame(p)};return Ae.useEffect(()=>(l(),a(),p(),window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o)}),[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{className:"w-screen h-screen",ref:n})})},N4e="/about_portfolio/assets/px-DZeywvNe.jpg",z4e="/about_portfolio/assets/nx-gXUpNenc.jpg",U4e="/about_portfolio/assets/py-DXf_Q1NF.jpg",G4e="/about_portfolio/assets/ny-Bo9il99d.jpg",V4e="/about_portfolio/assets/pz-BKu-NtuL.jpg",H4e="/about_portfolio/assets/nz-D5GMLchw.jpg",j4e="/about_portfolio/assets/iphone-D4eE8fd6.glb",W4e="/about_portfolio/assets/demo-C_eqECfK.mp4",$4e=()=>{const n=Ae.useRef(null),e=Ae.useRef(null);let t,r,i,s=null,o={width:0,height:0};const l=()=>{t=new Ml,o.width=window.innerWidth,o.height=window.innerHeight,r=new ts(75,o.width/o.height,.1,1e3),r.position.set(0,0,20),r.lookAt(new Ze(0,0,0)),t.add(r),i=new Jl({canvas:n.current,antialias:!0,alpha:!0}),i.setSize(o.width,o.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),i.physicallyCorrectLights=!0,i.toneMapping=oD,i.toneMappingExposure=2,i.outputColorSpace=Ta,s=new lce(r,i.domElement),s.movementSpeed=30,s.lookSpeed=.1,s.noFly=!0};let a=null;const h=()=>{a=new tre().load([N4e,z4e,U4e,G4e,V4e,H4e]),a.colorSpace=Ta,t.background=a,t.environment=a};let f=null,p={mesh:null,material:null,videoMaterial:null};const v=()=>{const E=new Bne(e.current),L=new Wa({map:E,envMap:a});p.videoMaterial=L;const k="/about_portfolio/",H=new a8;H.setDecoderPath(`${k}/draco/`),H.setDecoderConfig({type:"js"});const X=new SB;X.setDRACOLoader(H),X.load(j4e,Z=>{Z.scene&&(Z.scene.traverse(Q=>{Q instanceof Ri&&Q.material instanceof mp&&(Q.material.envMap=a,Q.material.envMapIntensity=2,Q.name===""&&(p.mesh=Q,p.material=Q.material),Q.name.includes("logo")&&(Q.material.metalness=1))}),f=Z.scene,f.scale.set(60,60,60),f.position.y=-5,f.rotation.y=-Math.PI,t.add(f))})},y=()=>{const E=new FD,L=new nn;window.addEventListener("click",k=>{L.x=k.clientX/o.width*2-1,L.y=-(k.clientY/o.height)*2+1,E.setFromCamera(L,r);const H=E.intersectObjects([p.mesh]);if(H.length>0){const X=H[0].object;X.material.type==="MeshStandardMaterial"?X.material=p.videoMaterial:X.material=p.material}})},S=()=>{o.width=window.innerWidth,o.height=window.innerHeight,r.aspect=o.width/o.height,r.updateProjectionMatrix(),i.setSize(o.width,o.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2))},C=new sg,M=()=>{i.render(t,r),s.update(C.getDelta()),requestAnimationFrame(M)};return Ae.useEffect(()=>(l(),h(),v(),y(),M(),window.addEventListener("resize",S),()=>{window.removeEventListener("resize",S)}),[]),me.jsxs("div",{className:"w-screen h-screen",children:[me.jsx("canvas",{ref:n}),me.jsx("video",{className:"invisible fixed t-0 l-0",ref:e,src:W4e,muted:!0,autoPlay:!0,type:"mp4",loop:!0}),me.jsxs("div",{className:"w-64 h-12 bg-black-500 fixed top-0 left-1/2 -ml-32 rounded-b-md flex items-center py-3",children:[me.jsxs("svg",{className:"ml-4",width:"26",height:"26",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[me.jsx("path",{d:"M39 6H9C7.34315 6 6 7.34315 6 9V39C6 40.6569 7.34315 42 9 42H39C40.6569 42 42 40.6569 42 39V9C42 7.34315 40.6569 6 39 6Z",fill:"none",stroke:"#FFF",strokeWidth:"4"}),me.jsx("path",{d:"M24 19H12V29H24V19Z",fill:"none",stroke:"#FFF",strokeWidth:"4",strokeLinejoin:"bevel"}),me.jsx("path",{d:"M35 18L30 22V26L35 30V18Z",fill:"none",stroke:"#FFF",strokeWidth:"4",strokeLinejoin:"bevel"})]}),me.jsx("span",{className:"text-white text-lg align-middle pl-2",children:""})]})]})},cce=typeof document<"u"?Zl.useLayoutEffect:()=>{};function X4e(n){const e=Ae.useRef(null);return cce(()=>{e.current=n},[n]),Ae.useCallback((...t)=>{const r=e.current;return r==null?void 0:r(...t)},[])}const SE=n=>{var e;return(e=n==null?void 0:n.ownerDocument)!==null&&e!==void 0?e:document},Py=n=>n&&"window"in n&&n.window===n?n:SE(n).defaultView||window;function q4e(n){var e;return typeof window>"u"||window.navigator==null?!1:((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.brands.some(t=>n.test(t.brand)))||n.test(window.navigator.userAgent)}function Z4e(n){var e;return typeof window<"u"&&window.navigator!=null?n.test(((e=window.navigator.userAgentData)===null||e===void 0?void 0:e.platform)||window.navigator.platform):!1}function uce(n){let e=null;return()=>(e==null&&(e=n()),e)}const Y4e=uce(function(){return Z4e(/^Mac/i)}),K4e=uce(function(){return q4e(/Android/i)});function J4e(n){return n.mozInputSource===0&&n.isTrusted?!0:K4e()&&n.pointerType?n.type==="click"&&n.buttons===1:n.detail===0&&!n.pointerType}class Q4e{isDefaultPrevented(){return this.nativeEvent.defaultPrevented}preventDefault(){this.defaultPrevented=!0,this.nativeEvent.preventDefault()}stopPropagation(){this.nativeEvent.stopPropagation(),this.isPropagationStopped=()=>!0}isPropagationStopped(){return!1}persist(){}constructor(e,t){this.nativeEvent=t,this.target=t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget,this.bubbles=t.bubbles,this.cancelable=t.cancelable,this.defaultPrevented=t.defaultPrevented,this.eventPhase=t.eventPhase,this.isTrusted=t.isTrusted,this.timeStamp=t.timeStamp,this.type=e}}function hce(n){let e=Ae.useRef({isFocused:!1,observer:null});cce(()=>{const r=e.current;return()=>{r.observer&&(r.observer.disconnect(),r.observer=null)}},[]);let t=X4e(r=>{n==null||n(r)});return Ae.useCallback(r=>{if(r.target instanceof HTMLButtonElement||r.target instanceof HTMLInputElement||r.target instanceof HTMLTextAreaElement||r.target instanceof HTMLSelectElement){e.current.isFocused=!0;let i=r.target,s=o=>{e.current.isFocused=!1,i.disabled&&t(new Q4e("blur",o)),e.current.observer&&(e.current.observer.disconnect(),e.current.observer=null)};i.addEventListener("focusout",s,{once:!0}),e.current.observer=new MutationObserver(()=>{if(e.current.isFocused&&i.disabled){var o;(o=e.current.observer)===null||o===void 0||o.disconnect();let l=i===document.activeElement?null:document.activeElement;i.dispatchEvent(new FocusEvent("blur",{relatedTarget:l})),i.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:l}))}}),e.current.observer.observe(i,{attributes:!0,attributeFilter:["disabled"]})}},[t])}function eze(n){let{isDisabled:e,onFocus:t,onBlur:r,onFocusChange:i}=n;const s=Ae.useCallback(a=>{if(a.target===a.currentTarget)return r&&r(a),i&&i(!1),!0},[r,i]),o=hce(s),l=Ae.useCallback(a=>{const h=SE(a.target);a.target===a.currentTarget&&h.activeElement===a.target&&(t&&t(a),i&&i(!0),o(a))},[i,t,o]);return{focusProps:{onFocus:!e&&(t||i||r)?l:void 0,onBlur:!e&&(r||i)?s:void 0}}}let AE=null,M5=new Set,TT=new Map,dx=!1,E5=!1;const tze={Tab:!0,Escape:!0};function o8(n,e){for(let t of M5)t(n,e)}function nze(n){return!(n.metaKey||!Y4e()&&n.altKey||n.ctrlKey||n.key==="Control"||n.key==="Shift"||n.key==="Meta")}function mL(n){dx=!0,nze(n)&&(AE="keyboard",o8("keyboard",n))}function Sh(n){AE="pointer",(n.type==="mousedown"||n.type==="pointerdown")&&(dx=!0,o8("pointer",n))}function fce(n){J4e(n)&&(dx=!0,AE="virtual")}function dce(n){n.target===window||n.target===document||(!dx&&!E5&&(AE="virtual",o8("virtual",n)),dx=!1,E5=!1)}function pce(){dx=!1,E5=!0}function C5(n){if(typeof window>"u"||TT.get(Py(n)))return;const e=Py(n),t=SE(n);let r=e.HTMLElement.prototype.focus;e.HTMLElement.prototype.focus=function(){dx=!0,r.apply(this,arguments)},t.addEventListener("keydown",mL,!0),t.addEventListener("keyup",mL,!0),t.addEventListener("click",fce,!0),e.addEventListener("focus",dce,!0),e.addEventListener("blur",pce,!1),typeof PointerEvent<"u"?(t.addEventListener("pointerdown",Sh,!0),t.addEventListener("pointermove",Sh,!0),t.addEventListener("pointerup",Sh,!0)):(t.addEventListener("mousedown",Sh,!0),t.addEventListener("mousemove",Sh,!0),t.addEventListener("mouseup",Sh,!0)),e.addEventListener("beforeunload",()=>{mce(n)},{once:!0}),TT.set(e,{focus:r})}const mce=(n,e)=>{const t=Py(n),r=SE(n);e&&r.removeEventListener("DOMContentLoaded",e),TT.has(t)&&(t.HTMLElement.prototype.focus=TT.get(t).focus,r.removeEventListener("keydown",mL,!0),r.removeEventListener("keyup",mL,!0),r.removeEventListener("click",fce,!0),t.removeEventListener("focus",dce,!0),t.removeEventListener("blur",pce,!1),typeof PointerEvent<"u"?(r.removeEventListener("pointerdown",Sh,!0),r.removeEventListener("pointermove",Sh,!0),r.removeEventListener("pointerup",Sh,!0)):(r.removeEventListener("mousedown",Sh,!0),r.removeEventListener("mousemove",Sh,!0),r.removeEventListener("mouseup",Sh,!0)),TT.delete(t))};function rze(n){const e=SE(n);let t;return e.readyState!=="loading"?C5(n):(t=()=>{C5(n)},e.addEventListener("DOMContentLoaded",t)),()=>mce(n,t)}typeof document<"u"&&rze();function gce(){return AE!=="pointer"}const ize=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);function sze(n,e,t){var r;const i=typeof window<"u"?Py(t==null?void 0:t.target).HTMLInputElement:HTMLInputElement,s=typeof window<"u"?Py(t==null?void 0:t.target).HTMLTextAreaElement:HTMLTextAreaElement,o=typeof window<"u"?Py(t==null?void 0:t.target).HTMLElement:HTMLElement,l=typeof window<"u"?Py(t==null?void 0:t.target).KeyboardEvent:KeyboardEvent;return n=n||(t==null?void 0:t.target)instanceof i&&!ize.has(t==null||(r=t.target)===null||r===void 0?void 0:r.type)||(t==null?void 0:t.target)instanceof s||(t==null?void 0:t.target)instanceof o&&(t==null?void 0:t.target.isContentEditable),!(n&&e==="keyboard"&&t instanceof l&&!tze[t.key])}function aze(n,e,t){C5(),Ae.useEffect(()=>{let r=(i,s)=>{sze(!!(t!=null&&t.isTextInput),i,s)&&n(gce())};return M5.add(r),()=>{M5.delete(r)}},e)}function oze(n){let{isDisabled:e,onBlurWithin:t,onFocusWithin:r,onFocusWithinChange:i}=n,s=Ae.useRef({isFocusWithin:!1}),o=Ae.useCallback(h=>{s.current.isFocusWithin&&!h.currentTarget.contains(h.relatedTarget)&&(s.current.isFocusWithin=!1,t&&t(h),i&&i(!1))},[t,i,s]),l=hce(o),a=Ae.useCallback(h=>{!s.current.isFocusWithin&&document.activeElement===h.target&&(r&&r(h),i&&i(!0),s.current.isFocusWithin=!0,l(h))},[r,i,l]);return e?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:a,onBlur:o}}}let gL=!1,cN=0;function I5(){gL=!0,setTimeout(()=>{gL=!1},50)}function DK(n){n.pointerType==="touch"&&I5()}function lze(){if(!(typeof document>"u"))return typeof PointerEvent<"u"?document.addEventListener("pointerup",DK):document.addEventListener("touchend",I5),cN++,()=>{cN--,!(cN>0)&&(typeof PointerEvent<"u"?document.removeEventListener("pointerup",DK):document.removeEventListener("touchend",I5))}}function cze(n){let{onHoverStart:e,onHoverChange:t,onHoverEnd:r,isDisabled:i}=n,[s,o]=Ae.useState(!1),l=Ae.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;Ae.useEffect(lze,[]);let{hoverProps:a,triggerHoverEnd:h}=Ae.useMemo(()=>{let f=(y,S)=>{if(l.pointerType=S,i||S==="touch"||l.isHovered||!y.currentTarget.contains(y.target))return;l.isHovered=!0;let C=y.currentTarget;l.target=C,e&&e({type:"hoverstart",target:C,pointerType:S}),t&&t(!0),o(!0)},p=(y,S)=>{if(l.pointerType="",l.target=null,S==="touch"||!l.isHovered)return;l.isHovered=!1;let C=y.currentTarget;r&&r({type:"hoverend",target:C,pointerType:S}),t&&t(!1),o(!1)},v={};return typeof PointerEvent<"u"?(v.onPointerEnter=y=>{gL&&y.pointerType==="mouse"||f(y,y.pointerType)},v.onPointerLeave=y=>{!i&&y.currentTarget.contains(y.target)&&p(y,y.pointerType)}):(v.onTouchStart=()=>{l.ignoreEmulatedMouseEvents=!0},v.onMouseEnter=y=>{!l.ignoreEmulatedMouseEvents&&!gL&&f(y,"mouse"),l.ignoreEmulatedMouseEvents=!1},v.onMouseLeave=y=>{!i&&y.currentTarget.contains(y.target)&&p(y,"mouse")}),{hoverProps:v,triggerHoverEnd:p}},[e,t,r,i,l]);return Ae.useEffect(()=>{i&&h({currentTarget:l.target},l.pointerType)},[i]),{hoverProps:a,isHovered:s}}function uze(n={}){let{autoFocus:e=!1,isTextInput:t,within:r}=n,i=Ae.useRef({isFocused:!1,isFocusVisible:e||gce()}),[s,o]=Ae.useState(!1),[l,a]=Ae.useState(()=>i.current.isFocused&&i.current.isFocusVisible),h=Ae.useCallback(()=>a(i.current.isFocused&&i.current.isFocusVisible),[]),f=Ae.useCallback(y=>{i.current.isFocused=y,o(y),h()},[h]);aze(y=>{i.current.isFocusVisible=y,h()},[],{isTextInput:t});let{focusProps:p}=eze({isDisabled:r,onFocusChange:f}),{focusWithinProps:v}=oze({isDisabled:!r,onFocusWithinChange:f});return{isFocused:s,isFocusVisible:l,focusProps:r?v:p}}var hze=Object.defineProperty,fze=(n,e,t)=>e in n?hze(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,uN=(n,e,t)=>(fze(n,typeof e!="symbol"?e+"":e,t),t);let dze=class{constructor(){uN(this,"current",this.detect()),uN(this,"handoffState","pending"),uN(this,"currentId",0)}set(e){this.current!==e&&(this.handoffState="pending",this.currentId=0,this.current=e)}reset(){this.set(this.detect())}nextId(){return++this.currentId}get isServer(){return this.current==="server"}get isClient(){return this.current==="client"}detect(){return typeof window>"u"||typeof document>"u"?"server":"client"}handoff(){this.handoffState==="pending"&&(this.handoffState="complete")}get isHandoffComplete(){return this.handoffState==="complete"}},$y=new dze;function zw(n){return $y.isServer?null:n instanceof Node?n.ownerDocument:n!=null&&n.hasOwnProperty("current")&&n.current instanceof Node?n.current.ownerDocument:document}function vce(n){typeof queueMicrotask=="function"?queueMicrotask(n):Promise.resolve().then(n).catch(e=>setTimeout(()=>{throw e}))}function Tp(){let n=[],e={addEventListener(t,r,i,s){return t.addEventListener(r,i,s),e.add(()=>t.removeEventListener(r,i,s))},requestAnimationFrame(...t){let r=requestAnimationFrame(...t);return e.add(()=>cancelAnimationFrame(r))},nextFrame(...t){return e.requestAnimationFrame(()=>e.requestAnimationFrame(...t))},setTimeout(...t){let r=setTimeout(...t);return e.add(()=>clearTimeout(r))},microTask(...t){let r={current:!0};return vce(()=>{r.current&&t[0]()}),e.add(()=>{r.current=!1})},style(t,r,i){let s=t.style.getPropertyValue(r);return Object.assign(t.style,{[r]:i}),this.add(()=>{Object.assign(t.style,{[r]:s})})},group(t){let r=Tp();return t(r),this.add(()=>r.dispose())},add(t){return n.includes(t)||n.push(t),()=>{let r=n.indexOf(t);if(r>=0)for(let i of n.splice(r,1))i()}},dispose(){for(let t of n.splice(0))t()}};return e}function AB(){let[n]=Ae.useState(Tp);return Ae.useEffect(()=>()=>n.dispose(),[n]),n}let Co=(n,e)=>{$y.isServer?Ae.useEffect(n,e):Ae.useLayoutEffect(n,e)};function TE(n){let e=Ae.useRef(n);return Co(()=>{e.current=n},[n]),e}let Ea=function(n){let e=TE(n);return Zl.useCallback((...t)=>e.current(...t),[e])};function pze(n){let e=n.width/2,t=n.height/2;return{top:n.clientY-t,right:n.clientX+e,bottom:n.clientY+t,left:n.clientX-e}}function mze(n,e){return!(!n||!e||n.right<e.left||n.left>e.right||n.bottom<e.top||n.top>e.bottom)}function gze({disabled:n=!1}={}){let e=Ae.useRef(null),[t,r]=Ae.useState(!1),i=AB(),s=Ea(()=>{e.current=null,r(!1),i.dispose()}),o=Ea(l=>{if(i.dispose(),e.current===null){e.current=l.currentTarget,r(!0);{let a=zw(l.currentTarget);i.addEventListener(a,"pointerup",s,!1),i.addEventListener(a,"pointermove",h=>{if(e.current){let f=pze(h);r(mze(f,e.current.getBoundingClientRect()))}},!1),i.addEventListener(a,"pointercancel",s,!1)}}});return{pressed:t,pressProps:n?{}:{onPointerDown:o,onPointerUp:s,onClick:s}}}let vze=Ae.createContext(void 0);function _ce(){return Ae.useContext(vze)}function BK(...n){return Array.from(new Set(n.flatMap(e=>typeof e=="string"?e.split(" "):[]))).filter(Boolean).join(" ")}function ME(n,e,...t){if(n in e){let i=e[n];return typeof i=="function"?i(...t):i}let r=new Error(`Tried to handle "${n}" but there is no handler defined. Only defined handlers are: ${Object.keys(e).map(i=>`"${i}"`).join(", ")}.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,ME),r}var R5=(n=>(n[n.None=0]="None",n[n.RenderStrategy=1]="RenderStrategy",n[n.Static=2]="Static",n))(R5||{}),_ze=(n=>(n[n.Unmount=0]="Unmount",n[n.Hidden=1]="Hidden",n))(_ze||{});function Gh(){let n=xze();return Ae.useCallback(e=>yze({mergeRefs:n,...e}),[n])}function yze({ourProps:n,theirProps:e,slot:t,defaultTag:r,features:i,visible:s=!0,name:o,mergeRefs:l}){l=l??bze;let a=yce(e,n);if(s)return CI(a,t,r,o,l);let h=i??0;if(h&2){let{static:f=!1,...p}=a;if(f)return CI(p,t,r,o,l)}if(h&1){let{unmount:f=!0,...p}=a;return ME(f?0:1,{0(){return null},1(){return CI({...p,hidden:!0,style:{display:"none"}},t,r,o,l)}})}return CI(a,t,r,o,l)}function CI(n,e={},t,r,i){let{as:s=t,children:o,refName:l="ref",...a}=hN(n,["unmount","static"]),h=n.ref!==void 0?{[l]:n.ref}:{},f=typeof o=="function"?o(e):o;"className"in a&&a.className&&typeof a.className=="function"&&(a.className=a.className(e)),a["aria-labelledby"]&&a["aria-labelledby"]===a.id&&(a["aria-labelledby"]=void 0);let p={};if(e){let v=!1,y=[];for(let[S,C]of Object.entries(e))typeof C=="boolean"&&(v=!0),C===!0&&y.push(S.replace(/([A-Z])/g,M=>`-${M.toLowerCase()}`));if(v){p["data-headlessui-state"]=y.join(" ");for(let S of y)p[`data-${S}`]=""}}if(s===Ae.Fragment&&(Object.keys(X1(a)).length>0||Object.keys(X1(p)).length>0))if(!Ae.isValidElement(f)||Array.isArray(f)&&f.length>1){if(Object.keys(X1(a)).length>0)throw new Error(['Passing props on "Fragment"!',"",`The current component <${r} /> is rendering a "Fragment".`,"However we need to passthrough the following props:",Object.keys(X1(a)).concat(Object.keys(X1(p))).map(v=>`  - ${v}`).join(`
`),"","You can apply a few solutions:",['Add an `as="..."` prop, to ensure that we render an actual element instead of a "Fragment".',"Render a single element as the child so that we can forward the props onto that element."].map(v=>`  - ${v}`).join(`
`)].join(`
`))}else{let v=f.props,y=v==null?void 0:v.className,S=typeof y=="function"?(...E)=>BK(y(...E),a.className):BK(y,a.className),C=S?{className:S}:{},M=yce(f.props,X1(hN(a,["ref"])));for(let E in p)E in M&&delete p[E];return Ae.cloneElement(f,Object.assign({},M,p,h,{ref:i(wze(f),h.ref)},C))}return Ae.createElement(s,Object.assign({},hN(a,["ref"]),s!==Ae.Fragment&&h,s!==Ae.Fragment&&p),f)}function xze(){let n=Ae.useRef([]),e=Ae.useCallback(t=>{for(let r of n.current)r!=null&&(typeof r=="function"?r(t):r.current=t)},[]);return(...t)=>{if(!t.every(r=>r==null))return n.current=t,e}}function bze(...n){return n.every(e=>e==null)?void 0:e=>{for(let t of n)t!=null&&(typeof t=="function"?t(e):t.current=e)}}function yce(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(t[i]!=null||(t[i]=[]),t[i].push(r[i])):e[i]=r[i];if(e.disabled||e["aria-disabled"])for(let r in t)/^(on(?:Click|Pointer|Mouse|Key)(?:Down|Up|Press)?)$/.test(r)&&(t[r]=[i=>{var s;return(s=i==null?void 0:i.preventDefault)==null?void 0:s.call(i)}]);for(let r in t)Object.assign(e,{[r](i,...s){let o=t[r];for(let l of o){if((i instanceof Event||(i==null?void 0:i.nativeEvent)instanceof Event)&&i.defaultPrevented)return;l(i,...s)}}});return e}function xce(...n){if(n.length===0)return{};if(n.length===1)return n[0];let e={},t={};for(let r of n)for(let i in r)i.startsWith("on")&&typeof r[i]=="function"?(t[i]!=null||(t[i]=[]),t[i].push(r[i])):e[i]=r[i];for(let r in t)Object.assign(e,{[r](...i){let s=t[r];for(let o of s)o==null||o(...i)}});return e}function Vh(n){var e;return Object.assign(Ae.forwardRef(n),{displayName:(e=n.displayName)!=null?e:n.name})}function X1(n){let e=Object.assign({},n);for(let t in e)e[t]===void 0&&delete e[t];return e}function hN(n,e=[]){let t=Object.assign({},n);for(let r of e)r in t&&delete t[r];return t}function wze(n){return Zl.version.split(".")[0]>="19"?n.props.ref:n.ref}let Sze=Ae.createContext(void 0);function Aze(){return Ae.useContext(Sze)}function Tze(n){let e=n.parentElement,t=null;for(;e&&!(e instanceof HTMLFieldSetElement);)e instanceof HTMLLegendElement&&(t=e),e=e.parentElement;let r=(e==null?void 0:e.getAttribute("disabled"))==="";return r&&Mze(t)?!1:r}function Mze(n){if(!n)return!1;let e=n.previousElementSibling;for(;e!==null;){if(e instanceof HTMLLegendElement)return!1;e=e.previousElementSibling}return!0}let bce=Symbol();function Eze(n,e=!0){return Object.assign(n,{[bce]:e})}function lg(...n){let e=Ae.useRef(n);Ae.useEffect(()=>{e.current=n},[n]);let t=Ea(r=>{for(let i of e.current)i!=null&&(typeof i=="function"?i(r):i.current=r)});return n.every(r=>r==null||(r==null?void 0:r[bce]))?void 0:t}let l8=Ae.createContext(null);l8.displayName="DescriptionContext";function wce(){let n=Ae.useContext(l8);if(n===null){let e=new Error("You used a <Description /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,wce),e}return n}function Cze(){let[n,e]=Ae.useState([]);return[n.length>0?n.join(" "):void 0,Ae.useMemo(()=>function(t){let r=Ea(s=>(e(o=>[...o,s]),()=>e(o=>{let l=o.slice(),a=l.indexOf(s);return a!==-1&&l.splice(a,1),l}))),i=Ae.useMemo(()=>({register:r,slot:t.slot,name:t.name,props:t.props,value:t.value}),[r,t.slot,t.name,t.props,t.value]);return Zl.createElement(l8.Provider,{value:i},t.children)},[e])]}let Ize="p";function Rze(n,e){let t=Ae.useId(),r=_ce(),{id:i=`headlessui-description-${t}`,...s}=n,o=wce(),l=lg(e);Co(()=>o.register(i),[i,o.register]);let a=r||!1,h=Ae.useMemo(()=>({...o.slot,disabled:a}),[o.slot,a]),f={ref:l,...o.props,id:i};return Gh()({ourProps:f,theirProps:s,slot:h,defaultTag:Ize,name:o.name||"Description"})}let Pze=Vh(Rze);Object.assign(Pze,{});var xl=(n=>(n.Space=" ",n.Enter="Enter",n.Escape="Escape",n.Backspace="Backspace",n.Delete="Delete",n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown",n.Home="Home",n.End="End",n.PageUp="PageUp",n.PageDown="PageDown",n.Tab="Tab",n))(xl||{});let TB=Ae.createContext(null);TB.displayName="LabelContext";function c8(){let n=Ae.useContext(TB);if(n===null){let e=new Error("You used a <Label /> component, but it is not inside a relevant parent.");throw Error.captureStackTrace&&Error.captureStackTrace(e,c8),e}return n}function Lze(n){var e,t,r;let i=(t=(e=Ae.useContext(TB))==null?void 0:e.value)!=null?t:void 0;return((r=void 0)!=null?r:0)>0?[i,...n].filter(Boolean).join(" "):i}function Sce({inherit:n=!1}={}){let e=Lze(),[t,r]=Ae.useState([]),i=n?[e,...t].filter(Boolean):t;return[i.length>0?i.join(" "):void 0,Ae.useMemo(()=>function(s){let o=Ea(a=>(r(h=>[...h,a]),()=>r(h=>{let f=h.slice(),p=f.indexOf(a);return p!==-1&&f.splice(p,1),f}))),l=Ae.useMemo(()=>({register:o,slot:s.slot,name:s.name,props:s.props,value:s.value}),[o,s.slot,s.name,s.props,s.value]);return Zl.createElement(TB.Provider,{value:l},s.children)},[r])]}let Dze="label";function Bze(n,e){var t;let r=Ae.useId(),i=c8(),s=Aze(),o=_ce(),{id:l=`headlessui-label-${r}`,htmlFor:a=s??((t=i.props)==null?void 0:t.htmlFor),passive:h=!1,...f}=n,p=lg(e);Co(()=>i.register(l),[l,i.register]);let v=Ea(M=>{let E=M.currentTarget;if(E instanceof HTMLLabelElement&&M.preventDefault(),i.props&&"onClick"in i.props&&typeof i.props.onClick=="function"&&i.props.onClick(M),E instanceof HTMLLabelElement){let L=document.getElementById(E.htmlFor);if(L){let k=L.getAttribute("disabled");if(k==="true"||k==="")return;let H=L.getAttribute("aria-disabled");if(H==="true"||H==="")return;(L instanceof HTMLInputElement&&(L.type==="radio"||L.type==="checkbox")||L.role==="radio"||L.role==="checkbox"||L.role==="switch")&&L.click(),L.focus({preventScroll:!0})}}}),y=o||!1,S=Ae.useMemo(()=>({...i.slot,disabled:y}),[i.slot,y]),C={ref:p,...i.props,id:l,htmlFor:a,onClick:v};return h&&("onClick"in C&&(delete C.htmlFor,delete C.onClick),"onClick"in f&&delete f.onClick),Gh()({ourProps:C,theirProps:f,slot:S,defaultTag:a?Dze:"div",name:i.name||"Label"})}let kze=Vh(Bze);Object.assign(kze,{});function Oze(n){if(n===null)return{width:0,height:0};let{width:e,height:t}=n.getBoundingClientRect();return{width:e,height:t}}function Fze(n,e=!1){let[t,r]=Ae.useReducer(()=>({}),{}),i=Ae.useMemo(()=>Oze(n),[n,t]);return Co(()=>{if(!n)return;let s=new ResizeObserver(r);return s.observe(n),()=>{s.disconnect()}},[n]),e?{width:`${i.width}px`,height:`${i.height}px`}:i}let Nze=class extends Map{constructor(e){super(),this.factory=e}get(e){let t=super.get(e);return t===void 0&&(t=this.factory(e),this.set(e,t)),t}};function Ace(n,e){let t=n(),r=new Set;return{getSnapshot(){return t},subscribe(i){return r.add(i),()=>r.delete(i)},dispatch(i,...s){let o=e[i].call(t,...s);o&&(t=o,r.forEach(l=>l()))}}}function Tce(n){return Ae.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getSnapshot)}let zze=new Nze(()=>Ace(()=>[],{ADD(n){return this.includes(n)?this:[...this,n]},REMOVE(n){let e=this.indexOf(n);if(e===-1)return this;let t=this.slice();return t.splice(e,1),t}}));function u8(n,e){let t=zze.get(e),r=Ae.useId(),i=Tce(t);if(Co(()=>{if(n)return t.dispatch("ADD",r),()=>t.dispatch("REMOVE",r)},[t,n]),!n)return!1;let s=i.indexOf(r),o=i.length;return s===-1&&(s=o,o+=1),s===o-1}let P5=new Map,MT=new Map;function kK(n){var e;let t=(e=MT.get(n))!=null?e:0;return MT.set(n,t+1),t!==0?()=>OK(n):(P5.set(n,{"aria-hidden":n.getAttribute("aria-hidden"),inert:n.inert}),n.setAttribute("aria-hidden","true"),n.inert=!0,()=>OK(n))}function OK(n){var e;let t=(e=MT.get(n))!=null?e:1;if(t===1?MT.delete(n):MT.set(n,t-1),t!==1)return;let r=P5.get(n);r&&(r["aria-hidden"]===null?n.removeAttribute("aria-hidden"):n.setAttribute("aria-hidden",r["aria-hidden"]),n.inert=r.inert,P5.delete(n))}function Uze(n,{allowed:e,disallowed:t}={}){let r=u8(n,"inert-others");Co(()=>{var i,s;if(!r)return;let o=Tp();for(let a of(i=t==null?void 0:t())!=null?i:[])a&&o.add(kK(a));let l=(s=e==null?void 0:e())!=null?s:[];for(let a of l){if(!a)continue;let h=zw(a);if(!h)continue;let f=a.parentElement;for(;f&&f!==h.body;){for(let p of f.children)l.some(v=>p.contains(v))||o.add(kK(p));f=f.parentElement}}return o.dispose},[r,e,t])}function Gze(n,e,t){let r=TE(i=>{let s=i.getBoundingClientRect();s.x===0&&s.y===0&&s.width===0&&s.height===0&&t()});Ae.useEffect(()=>{if(!n)return;let i=e===null?null:e instanceof HTMLElement?e:e.current;if(!i)return;let s=Tp();if(typeof ResizeObserver<"u"){let o=new ResizeObserver(()=>r.current(i));o.observe(i),s.add(()=>o.disconnect())}if(typeof IntersectionObserver<"u"){let o=new IntersectionObserver(()=>r.current(i));o.observe(i),s.add(()=>o.disconnect())}return()=>s.dispose()},[e,r,n])}let L5=["[contentEditable=true]","[tabindex]","a[href]","area[href]","button:not([disabled])","iframe","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].map(n=>`${n}:not([tabindex='-1'])`).join(","),Vze=["[data-autofocus]"].map(n=>`${n}:not([tabindex='-1'])`).join(",");var D5=(n=>(n[n.First=1]="First",n[n.Previous=2]="Previous",n[n.Next=4]="Next",n[n.Last=8]="Last",n[n.WrapAround=16]="WrapAround",n[n.NoScroll=32]="NoScroll",n[n.AutoFocus=64]="AutoFocus",n))(D5||{}),Hze=(n=>(n[n.Error=0]="Error",n[n.Overflow=1]="Overflow",n[n.Success=2]="Success",n[n.Underflow=3]="Underflow",n))(Hze||{}),jze=(n=>(n[n.Previous=-1]="Previous",n[n.Next=1]="Next",n))(jze||{});function Mce(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(L5)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}function Wze(n=document.body){return n==null?[]:Array.from(n.querySelectorAll(Vze)).sort((e,t)=>Math.sign((e.tabIndex||Number.MAX_SAFE_INTEGER)-(t.tabIndex||Number.MAX_SAFE_INTEGER)))}var h8=(n=>(n[n.Strict=0]="Strict",n[n.Loose=1]="Loose",n))(h8||{});function f8(n,e=0){var t;return n===((t=zw(n))==null?void 0:t.body)?!1:ME(e,{0(){return n.matches(L5)},1(){let r=n;for(;r!==null;){if(r.matches(L5))return!0;r=r.parentElement}return!1}})}function Ece(n){let e=zw(n);Tp().nextFrame(()=>{e&&!f8(e.activeElement,0)&&Xze(n)})}var $ze=(n=>(n[n.Keyboard=0]="Keyboard",n[n.Mouse=1]="Mouse",n))($ze||{});typeof window<"u"&&typeof document<"u"&&(document.addEventListener("keydown",n=>{n.metaKey||n.altKey||n.ctrlKey||(document.documentElement.dataset.headlessuiFocusVisible="")},!0),document.addEventListener("click",n=>{n.detail===1?delete document.documentElement.dataset.headlessuiFocusVisible:n.detail===0&&(document.documentElement.dataset.headlessuiFocusVisible="")},!0));function Xze(n){n==null||n.focus({preventScroll:!0})}let qze=["textarea","input"].join(",");function Zze(n){var e,t;return(t=(e=n==null?void 0:n.matches)==null?void 0:e.call(n,qze))!=null?t:!1}function Cce(n,e=t=>t){return n.slice().sort((t,r)=>{let i=e(t),s=e(r);if(i===null||s===null)return 0;let o=i.compareDocumentPosition(s);return o&Node.DOCUMENT_POSITION_FOLLOWING?-1:o&Node.DOCUMENT_POSITION_PRECEDING?1:0})}function Yze(n,e){return Kze(Mce(),e,{relativeTo:n})}function Kze(n,e,{sorted:t=!0,relativeTo:r=null,skipElements:i=[]}={}){let s=Array.isArray(n)?n.length>0?n[0].ownerDocument:document:n.ownerDocument,o=Array.isArray(n)?t?Cce(n):n:e&64?Wze(n):Mce(n);i.length>0&&o.length>1&&(o=o.filter(y=>!i.some(S=>S!=null&&"current"in S?(S==null?void 0:S.current)===y:S===y))),r=r??s.activeElement;let l=(()=>{if(e&5)return 1;if(e&10)return-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),a=(()=>{if(e&1)return 0;if(e&2)return Math.max(0,o.indexOf(r))-1;if(e&4)return Math.max(0,o.indexOf(r))+1;if(e&8)return o.length-1;throw new Error("Missing Focus.First, Focus.Previous, Focus.Next or Focus.Last")})(),h=e&32?{preventScroll:!0}:{},f=0,p=o.length,v;do{if(f>=p||f+p<=0)return 0;let y=a+f;if(e&16)y=(y+p)%p;else{if(y<0)return 3;if(y>=p)return 1}v=o[y],v==null||v.focus(h),f+=l}while(v!==s.activeElement);return e&6&&Zze(v)&&v.select(),2}function Ice(){return/iPhone/gi.test(window.navigator.platform)||/Mac/gi.test(window.navigator.platform)&&window.navigator.maxTouchPoints>0}function Jze(){return/Android/gi.test(window.navigator.userAgent)}function Qze(){return Ice()||Jze()}function vA(n,e,t,r){let i=TE(t);Ae.useEffect(()=>{if(!n)return;function s(o){i.current(o)}return document.addEventListener(e,s,r),()=>document.removeEventListener(e,s,r)},[n,e,r])}function e5e(n,e,t,r){let i=TE(t);Ae.useEffect(()=>{if(!n)return;function s(o){i.current(o)}return window.addEventListener(e,s,r),()=>window.removeEventListener(e,s,r)},[n,e,r])}const FK=30;function t5e(n,e,t){let r=u8(n,"outside-click"),i=TE(t),s=Ae.useCallback(function(a,h){if(a.defaultPrevented)return;let f=h(a);if(f===null||!f.getRootNode().contains(f)||!f.isConnected)return;let p=function v(y){return typeof y=="function"?v(y()):Array.isArray(y)||y instanceof Set?y:[y]}(e);for(let v of p)if(v!==null&&(v.contains(f)||a.composed&&a.composedPath().includes(v)))return;return!f8(f,h8.Loose)&&f.tabIndex!==-1&&a.preventDefault(),i.current(a,f)},[i,e]),o=Ae.useRef(null);vA(r,"pointerdown",a=>{var h,f;o.current=((f=(h=a.composedPath)==null?void 0:h.call(a))==null?void 0:f[0])||a.target},!0),vA(r,"mousedown",a=>{var h,f;o.current=((f=(h=a.composedPath)==null?void 0:h.call(a))==null?void 0:f[0])||a.target},!0),vA(r,"click",a=>{Qze()||o.current&&(s(a,()=>o.current),o.current=null)},!0);let l=Ae.useRef({x:0,y:0});vA(r,"touchstart",a=>{l.current.x=a.touches[0].clientX,l.current.y=a.touches[0].clientY},!0),vA(r,"touchend",a=>{let h={x:a.changedTouches[0].clientX,y:a.changedTouches[0].clientY};if(!(Math.abs(h.x-l.current.x)>=FK||Math.abs(h.y-l.current.y)>=FK))return s(a,()=>a.target instanceof HTMLElement?a.target:null)},!0),e5e(r,"blur",a=>s(a,()=>window.document.activeElement instanceof HTMLIFrameElement?window.document.activeElement:null),!0)}function d8(...n){return Ae.useMemo(()=>zw(...n),[...n])}function n5e(n,e){return Ae.useMemo(()=>{var t;if(n.type)return n.type;let r=(t=n.as)!=null?t:"button";if(typeof r=="string"&&r.toLowerCase()==="button"||(e==null?void 0:e.tagName)==="BUTTON"&&!e.hasAttribute("type"))return"button"},[n.type,n.as,e])}function r5e(){let n;return{before({doc:e}){var t;let r=e.documentElement,i=(t=e.defaultView)!=null?t:window;n=Math.max(0,i.innerWidth-r.clientWidth)},after({doc:e,d:t}){let r=e.documentElement,i=Math.max(0,r.clientWidth-r.offsetWidth),s=Math.max(0,n-i);t.style(r,"paddingRight",`${s}px`)}}}function i5e(){return Ice()?{before({doc:n,d:e,meta:t}){function r(i){return t.containers.flatMap(s=>s()).some(s=>s.contains(i))}e.microTask(()=>{var i;if(window.getComputedStyle(n.documentElement).scrollBehavior!=="auto"){let l=Tp();l.style(n.documentElement,"scrollBehavior","auto"),e.add(()=>e.microTask(()=>l.dispose()))}let s=(i=window.scrollY)!=null?i:window.pageYOffset,o=null;e.addEventListener(n,"click",l=>{if(l.target instanceof HTMLElement)try{let a=l.target.closest("a");if(!a)return;let{hash:h}=new URL(a.href),f=n.querySelector(h);f&&!r(f)&&(o=f)}catch{}},!0),e.addEventListener(n,"touchstart",l=>{if(l.target instanceof HTMLElement)if(r(l.target)){let a=l.target;for(;a.parentElement&&r(a.parentElement);)a=a.parentElement;e.style(a,"overscrollBehavior","contain")}else e.style(l.target,"touchAction","none")}),e.addEventListener(n,"touchmove",l=>{if(l.target instanceof HTMLElement){if(l.target.tagName==="INPUT")return;if(r(l.target)){let a=l.target;for(;a.parentElement&&a.dataset.headlessuiPortal!==""&&!(a.scrollHeight>a.clientHeight||a.scrollWidth>a.clientWidth);)a=a.parentElement;a.dataset.headlessuiPortal===""&&l.preventDefault()}else l.preventDefault()}},{passive:!1}),e.add(()=>{var l;let a=(l=window.scrollY)!=null?l:window.pageYOffset;s!==a&&window.scrollTo(0,s),o&&o.isConnected&&(o.scrollIntoView({block:"nearest"}),o=null)})})}}:{}}function s5e(){return{before({doc:n,d:e}){e.style(n.documentElement,"overflow","hidden")}}}function a5e(n){let e={};for(let t of n)Object.assign(e,t(e));return e}let Ly=Ace(()=>new Map,{PUSH(n,e){var t;let r=(t=this.get(n))!=null?t:{doc:n,count:0,d:Tp(),meta:new Set};return r.count++,r.meta.add(e),this.set(n,r),this},POP(n,e){let t=this.get(n);return t&&(t.count--,t.meta.delete(e)),this},SCROLL_PREVENT({doc:n,d:e,meta:t}){let r={doc:n,d:e,meta:a5e(t)},i=[i5e(),r5e(),s5e()];i.forEach(({before:s})=>s==null?void 0:s(r)),i.forEach(({after:s})=>s==null?void 0:s(r))},SCROLL_ALLOW({d:n}){n.dispose()},TEARDOWN({doc:n}){this.delete(n)}});Ly.subscribe(()=>{let n=Ly.getSnapshot(),e=new Map;for(let[t]of n)e.set(t,t.documentElement.style.overflow);for(let t of n.values()){let r=e.get(t.doc)==="hidden",i=t.count!==0;(i&&!r||!i&&r)&&Ly.dispatch(t.count>0?"SCROLL_PREVENT":"SCROLL_ALLOW",t),t.count===0&&Ly.dispatch("TEARDOWN",t)}});function o5e(n,e,t=()=>({containers:[]})){let r=Tce(Ly),i=e?r.get(e):void 0,s=i?i.count>0:!1;return Co(()=>{if(!(!e||!n))return Ly.dispatch("PUSH",e,t),()=>Ly.dispatch("POP",e,t)},[n,e]),s}function l5e(n,e,t=()=>[document.body]){let r=u8(n,"scroll-lock");o5e(r,e,i=>{var s;return{containers:[...(s=i.containers)!=null?s:[],t]}})}function NK(n){return[n.screenX,n.screenY]}function c5e(){let n=Ae.useRef([-1,-1]);return{wasMoved(e){let t=NK(e);return n.current[0]===t[0]&&n.current[1]===t[1]?!1:(n.current=t,!0)},update(e){n.current=NK(e)}}}function u5e(n=0){let[e,t]=Ae.useState(n),r=Ae.useCallback(a=>t(a),[e]),i=Ae.useCallback(a=>t(h=>h|a),[e]),s=Ae.useCallback(a=>(e&a)===a,[e]),o=Ae.useCallback(a=>t(h=>h&~a),[t]),l=Ae.useCallback(a=>t(h=>h^a),[t]);return{flags:e,setFlag:r,addFlag:i,hasFlag:s,removeFlag:o,toggleFlag:l}}var h5e={},zK,UK;typeof process<"u"&&typeof globalThis<"u"&&typeof Element<"u"&&((zK=process==null?void 0:h5e)==null?void 0:zK.NODE_ENV)==="test"&&typeof((UK=Element==null?void 0:Element.prototype)==null?void 0:UK.getAnimations)>"u"&&(Element.prototype.getAnimations=function(){return console.warn(["Headless UI has polyfilled `Element.prototype.getAnimations` for your tests.","Please install a proper polyfill e.g. `jsdom-testing-mocks`, to silence these warnings.","","Example usage:","```js","import { mockAnimationsApi } from 'jsdom-testing-mocks'","mockAnimationsApi()","```"].join(`
`)),[]});var f5e=(n=>(n[n.None=0]="None",n[n.Closed=1]="Closed",n[n.Enter=2]="Enter",n[n.Leave=4]="Leave",n))(f5e||{});function d5e(n){let e={};for(let t in n)n[t]===!0&&(e[`data-${t}`]="");return e}function p5e(n,e,t,r){let[i,s]=Ae.useState(t),{hasFlag:o,addFlag:l,removeFlag:a}=u5e(n&&i?3:0),h=Ae.useRef(!1),f=Ae.useRef(!1),p=AB();return Co(()=>{var v;if(n){if(t&&s(!0),!e){t&&l(3);return}return(v=void 0)==null||v.call(r,t),m5e(e,{inFlight:h,prepare(){f.current?f.current=!1:f.current=h.current,h.current=!0,!f.current&&(t?(l(3),a(4)):(l(4),a(2)))},run(){f.current?t?(a(3),l(4)):(a(4),l(3)):t?a(1):l(1)},done(){var y;f.current&&typeof e.getAnimations=="function"&&e.getAnimations().length>0||(h.current=!1,a(7),t||s(!1),(y=void 0)==null||y.call(r,t))}})}},[n,t,e,p]),n?[i,{closed:o(1),enter:o(2),leave:o(4),transition:o(2)||o(4)}]:[t,{closed:void 0,enter:void 0,leave:void 0,transition:void 0}]}function m5e(n,{prepare:e,run:t,done:r,inFlight:i}){let s=Tp();return v5e(n,{prepare:e,inFlight:i}),s.nextFrame(()=>{t(),s.requestAnimationFrame(()=>{s.add(g5e(n,r))})}),s.dispose}function g5e(n,e){var t,r;let i=Tp();if(!n)return i.dispose;let s=!1;i.add(()=>{s=!0});let o=(r=(t=n.getAnimations)==null?void 0:t.call(n).filter(l=>l instanceof CSSTransition))!=null?r:[];return o.length===0?(e(),i.dispose):(Promise.allSettled(o.map(l=>l.finished)).then(()=>{s||e()}),i.dispose)}function v5e(n,{inFlight:e,prepare:t}){if(e!=null&&e.current){t();return}let r=n.style.transition;n.style.transition="none",t(),n.offsetHeight,n.style.transition=r}function _5e(n,{container:e,accept:t,walk:r}){let i=Ae.useRef(t),s=Ae.useRef(r);Ae.useEffect(()=>{i.current=t,s.current=r},[t,r]),Co(()=>{if(!e||!n)return;let o=zw(e);if(!o)return;let l=i.current,a=s.current,h=Object.assign(p=>l(p),{acceptNode:l}),f=o.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,h,!1);for(;f.nextNode();)a(f.currentNode)},[e,n,i,s])}function MB(){return typeof window<"u"}function Uw(n){return Rce(n)?(n.nodeName||"").toLowerCase():"#document"}function zu(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function Mp(n){var e;return(e=(Rce(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function Rce(n){return MB()?n instanceof Node||n instanceof zu(n).Node:!1}function Ec(n){return MB()?n instanceof Element||n instanceof zu(n).Element:!1}function yp(n){return MB()?n instanceof HTMLElement||n instanceof zu(n).HTMLElement:!1}function GK(n){return!MB()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof zu(n).ShadowRoot}function EE(n){const{overflow:e,overflowX:t,overflowY:r,display:i}=td(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(i)}function y5e(n){return["table","td","th"].includes(Uw(n))}function EB(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function p8(n){const e=m8(),t=Ec(n)?td(n):n;return t.transform!=="none"||t.perspective!=="none"||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function x5e(n){let e=w0(n);for(;yp(e)&&!gw(e);){if(p8(e))return e;if(EB(e))return null;e=w0(e)}return null}function m8(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function gw(n){return["html","body","#document"].includes(Uw(n))}function td(n){return zu(n).getComputedStyle(n)}function CB(n){return Ec(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function w0(n){if(Uw(n)==="html")return n;const e=n.assignedSlot||n.parentNode||GK(n)&&n.host||Mp(n);return GK(e)?e.host:e}function Pce(n){const e=w0(n);return gw(e)?n.ownerDocument?n.ownerDocument.body:n.body:yp(e)&&EE(e)?e:Pce(e)}function IM(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=Pce(n),s=i===((r=n.ownerDocument)==null?void 0:r.body),o=zu(i);if(s){const l=B5(o);return e.concat(o,o.visualViewport||[],EE(i)?i:[],l&&t?IM(l):[])}return e.concat(i,IM(i,[],t))}function B5(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}function b5e(){const n=navigator.userAgentData;return n&&Array.isArray(n.brands)?n.brands.map(e=>{let{brand:t,version:r}=e;return t+"/"+r}).join(" "):navigator.userAgent}const px=Math.min,Wl=Math.max,RM=Math.round,II=Math.floor,pp=n=>({x:n,y:n}),w5e={left:"right",right:"left",bottom:"top",top:"bottom"},S5e={start:"end",end:"start"};function VK(n,e,t){return Wl(n,px(e,t))}function Gw(n,e){return typeof n=="function"?n(e):n}function S0(n){return n.split("-")[0]}function CE(n){return n.split("-")[1]}function Lce(n){return n==="x"?"y":"x"}function Dce(n){return n==="y"?"height":"width"}function mx(n){return["top","bottom"].includes(S0(n))?"y":"x"}function Bce(n){return Lce(mx(n))}function A5e(n,e,t){t===void 0&&(t=!1);const r=CE(n),i=Bce(n),s=Dce(i);let o=i==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=vL(o)),[o,vL(o)]}function T5e(n){const e=vL(n);return[k5(n),e,k5(e)]}function k5(n){return n.replace(/start|end/g,e=>S5e[e])}function M5e(n,e,t){const r=["left","right"],i=["right","left"],s=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?i:r:e?r:i;case"left":case"right":return e?s:o;default:return[]}}function E5e(n,e,t,r){const i=CE(n);let s=M5e(S0(n),t==="start",r);return i&&(s=s.map(o=>o+"-"+i),e&&(s=s.concat(s.map(k5)))),s}function vL(n){return n.replace(/left|right|bottom|top/g,e=>w5e[e])}function C5e(n){return{top:0,right:0,bottom:0,left:0,...n}}function I5e(n){return typeof n!="number"?C5e(n):{top:n,right:n,bottom:n,left:n}}function _L(n){const{x:e,y:t,width:r,height:i}=n;return{width:r,height:i,top:t,left:e,right:e+r,bottom:t+i,x:e,y:t}}function HK(n,e,t){let{reference:r,floating:i}=n;const s=mx(e),o=Bce(e),l=Dce(o),a=S0(e),h=s==="y",f=r.x+r.width/2-i.width/2,p=r.y+r.height/2-i.height/2,v=r[l]/2-i[l]/2;let y;switch(a){case"top":y={x:f,y:r.y-i.height};break;case"bottom":y={x:f,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:p};break;case"left":y={x:r.x-i.width,y:p};break;default:y={x:r.x,y:r.y}}switch(CE(e)){case"start":y[o]-=v*(t&&h?-1:1);break;case"end":y[o]+=v*(t&&h?-1:1);break}return y}const R5e=async(n,e,t)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=t,l=s.filter(Boolean),a=await(o.isRTL==null?void 0:o.isRTL(e));let h=await o.getElementRects({reference:n,floating:e,strategy:i}),{x:f,y:p}=HK(h,r,a),v=r,y={},S=0;for(let C=0;C<l.length;C++){const{name:M,fn:E}=l[C],{x:L,y:k,data:H,reset:X}=await E({x:f,y:p,initialPlacement:r,placement:v,strategy:i,middlewareData:y,rects:h,platform:o,elements:{reference:n,floating:e}});f=L??f,p=k??p,y={...y,[M]:{...y[M],...H}},X&&S<=50&&(S++,typeof X=="object"&&(X.placement&&(v=X.placement),X.rects&&(h=X.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:i}):X.rects),{x:f,y:p}=HK(h,v,a)),C=-1)}return{x:f,y:p,placement:v,strategy:i,middlewareData:y}};async function IB(n,e){var t;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:l,strategy:a}=n,{boundary:h="clippingAncestors",rootBoundary:f="viewport",elementContext:p="floating",altBoundary:v=!1,padding:y=0}=Gw(e,n),S=I5e(y),M=l[v?p==="floating"?"reference":"floating":p],E=_L(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(M)))==null||t?M:M.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(l.floating)),boundary:h,rootBoundary:f,strategy:a})),L=p==="floating"?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,k=await(s.getOffsetParent==null?void 0:s.getOffsetParent(l.floating)),H=await(s.isElement==null?void 0:s.isElement(k))?await(s.getScale==null?void 0:s.getScale(k))||{x:1,y:1}:{x:1,y:1},X=_L(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:L,offsetParent:k,strategy:a}):L);return{top:(E.top-X.top+S.top)/H.y,bottom:(X.bottom-E.bottom+S.bottom)/H.y,left:(E.left-X.left+S.left)/H.x,right:(X.right-E.right+S.right)/H.x}}const P5e=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:l,platform:a,elements:h}=e,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:v,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:S="none",flipAlignment:C=!0,...M}=Gw(n,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const E=S0(i),L=mx(l),k=S0(l)===l,H=await(a.isRTL==null?void 0:a.isRTL(h.floating)),X=v||(k||!C?[vL(l)]:T5e(l)),Z=S!=="none";!v&&Z&&X.push(...E5e(l,C,S,H));const Q=[l,...X],re=await IB(e,M),ie=[];let oe=((r=s.flip)==null?void 0:r.overflows)||[];if(f&&ie.push(re[E]),p){const Ie=A5e(i,o,H);ie.push(re[Ie[0]],re[Ie[1]])}if(oe=[...oe,{placement:i,overflows:ie}],!ie.every(Ie=>Ie<=0)){var fe,Se;const Ie=(((fe=s.flip)==null?void 0:fe.index)||0)+1,He=Q[Ie];if(He)return{data:{index:Ie,overflows:oe},reset:{placement:He}};let Re=(Se=oe.filter(st=>st.overflows[0]<=0).sort((st,_e)=>st.overflows[1]-_e.overflows[1])[0])==null?void 0:Se.placement;if(!Re)switch(y){case"bestFit":{var Ee;const st=(Ee=oe.filter(_e=>{if(Z){const We=mx(_e.placement);return We===L||We==="y"}return!0}).map(_e=>[_e.placement,_e.overflows.filter(We=>We>0).reduce((We,Ue)=>We+Ue,0)]).sort((_e,We)=>_e[1]-We[1])[0])==null?void 0:Ee[0];st&&(Re=st);break}case"initialPlacement":Re=l;break}if(i!==Re)return{reset:{placement:Re}}}return{}}}};async function L5e(n,e){const{placement:t,platform:r,elements:i}=n,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=S0(t),l=CE(t),a=mx(t)==="y",h=["left","top"].includes(o)?-1:1,f=s&&a?-1:1,p=Gw(e,n);let{mainAxis:v,crossAxis:y,alignmentAxis:S}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&typeof S=="number"&&(y=l==="end"?S*-1:S),a?{x:y*f,y:v*h}:{x:v*h,y:y*f}}const D5e=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:i,y:s,placement:o,middlewareData:l}=e,a=await L5e(e,n);return o===((t=l.offset)==null?void 0:t.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:i+a.x,y:s+a.y,data:{...a,placement:o}}}}},B5e=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:l={fn:M=>{let{x:E,y:L}=M;return{x:E,y:L}}},...a}=Gw(n,e),h={x:t,y:r},f=await IB(e,a),p=mx(S0(i)),v=Lce(p);let y=h[v],S=h[p];if(s){const M=v==="y"?"top":"left",E=v==="y"?"bottom":"right",L=y+f[M],k=y-f[E];y=VK(L,y,k)}if(o){const M=p==="y"?"top":"left",E=p==="y"?"bottom":"right",L=S+f[M],k=S-f[E];S=VK(L,S,k)}const C=l.fn({...e,[v]:y,[p]:S});return{...C,data:{x:C.x-t,y:C.y-r,enabled:{[v]:s,[p]:o}}}}}},k5e=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:i,rects:s,platform:o,elements:l}=e,{apply:a=()=>{},...h}=Gw(n,e),f=await IB(e,h),p=S0(i),v=CE(i),y=mx(i)==="y",{width:S,height:C}=s.floating;let M,E;p==="top"||p==="bottom"?(M=p,E=v===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(E=p,M=v==="end"?"top":"bottom");const L=C-f.top-f.bottom,k=S-f.left-f.right,H=px(C-f[M],L),X=px(S-f[E],k),Z=!e.middlewareData.shift;let Q=H,re=X;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(re=k),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(Q=L),Z&&!v){const oe=Wl(f.left,0),fe=Wl(f.right,0),Se=Wl(f.top,0),Ee=Wl(f.bottom,0);y?re=S-2*(oe!==0||fe!==0?oe+fe:Wl(f.left,f.right)):Q=C-2*(Se!==0||Ee!==0?Se+Ee:Wl(f.top,f.bottom))}await a({...e,availableWidth:re,availableHeight:Q});const ie=await o.getDimensions(l.floating);return S!==ie.width||C!==ie.height?{reset:{rects:!0}}:{}}}};function kce(n){const e=td(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=yp(n),s=i?n.offsetWidth:t,o=i?n.offsetHeight:r,l=RM(t)!==s||RM(r)!==o;return l&&(t=s,r=o),{width:t,height:r,$:l}}function g8(n){return Ec(n)?n:n.contextElement}function qb(n){const e=g8(n);if(!yp(e))return pp(1);const t=e.getBoundingClientRect(),{width:r,height:i,$:s}=kce(e);let o=(s?RM(t.width):t.width)/r,l=(s?RM(t.height):t.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const O5e=pp(0);function Oce(n){const e=zu(n);return!m8()||!e.visualViewport?O5e:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function F5e(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==zu(n)?!1:e}function gx(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=n.getBoundingClientRect(),s=g8(n);let o=pp(1);e&&(r?Ec(r)&&(o=qb(r)):o=qb(n));const l=F5e(s,t,r)?Oce(s):pp(0);let a=(i.left+l.x)/o.x,h=(i.top+l.y)/o.y,f=i.width/o.x,p=i.height/o.y;if(s){const v=zu(s),y=r&&Ec(r)?zu(r):r;let S=v,C=B5(S);for(;C&&r&&y!==S;){const M=qb(C),E=C.getBoundingClientRect(),L=td(C),k=E.left+(C.clientLeft+parseFloat(L.paddingLeft))*M.x,H=E.top+(C.clientTop+parseFloat(L.paddingTop))*M.y;a*=M.x,h*=M.y,f*=M.x,p*=M.y,a+=k,h+=H,S=zu(C),C=B5(S)}}return _L({width:f,height:p,x:a,y:h})}function v8(n,e){const t=CB(n).scrollLeft;return e?e.left+t:gx(Mp(n)).left+t}function Fce(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),i=r.left+e.scrollLeft-(t?0:v8(n,r)),s=r.top+e.scrollTop;return{x:i,y:s}}function N5e(n){let{elements:e,rect:t,offsetParent:r,strategy:i}=n;const s=i==="fixed",o=Mp(r),l=e?EB(e.floating):!1;if(r===o||l&&s)return t;let a={scrollLeft:0,scrollTop:0},h=pp(1);const f=pp(0),p=yp(r);if((p||!p&&!s)&&((Uw(r)!=="body"||EE(o))&&(a=CB(r)),yp(r))){const y=gx(r);h=qb(r),f.x=y.x+r.clientLeft,f.y=y.y+r.clientTop}const v=o&&!p&&!s?Fce(o,a,!0):pp(0);return{width:t.width*h.x,height:t.height*h.y,x:t.x*h.x-a.scrollLeft*h.x+f.x+v.x,y:t.y*h.y-a.scrollTop*h.y+f.y+v.y}}function z5e(n){return Array.from(n.getClientRects())}function U5e(n){const e=Mp(n),t=CB(n),r=n.ownerDocument.body,i=Wl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Wl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+v8(n);const l=-t.scrollTop;return td(r).direction==="rtl"&&(o+=Wl(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:l}}function G5e(n,e){const t=zu(n),r=Mp(n),i=t.visualViewport;let s=r.clientWidth,o=r.clientHeight,l=0,a=0;if(i){s=i.width,o=i.height;const h=m8();(!h||h&&e==="fixed")&&(l=i.offsetLeft,a=i.offsetTop)}return{width:s,height:o,x:l,y:a}}function V5e(n,e){const t=gx(n,!0,e==="fixed"),r=t.top+n.clientTop,i=t.left+n.clientLeft,s=yp(n)?qb(n):pp(1),o=n.clientWidth*s.x,l=n.clientHeight*s.y,a=i*s.x,h=r*s.y;return{width:o,height:l,x:a,y:h}}function jK(n,e,t){let r;if(e==="viewport")r=G5e(n,t);else if(e==="document")r=U5e(Mp(n));else if(Ec(e))r=V5e(e,t);else{const i=Oce(n);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return _L(r)}function Nce(n,e){const t=w0(n);return t===e||!Ec(t)||gw(t)?!1:td(t).position==="fixed"||Nce(t,e)}function H5e(n,e){const t=e.get(n);if(t)return t;let r=IM(n,[],!1).filter(l=>Ec(l)&&Uw(l)!=="body"),i=null;const s=td(n).position==="fixed";let o=s?w0(n):n;for(;Ec(o)&&!gw(o);){const l=td(o),a=p8(o);!a&&l.position==="fixed"&&(i=null),(s?!a&&!i:!a&&l.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||EE(o)&&!a&&Nce(n,o))?r=r.filter(f=>f!==o):i=l,o=w0(o)}return e.set(n,r),r}function j5e(n){let{element:e,boundary:t,rootBoundary:r,strategy:i}=n;const o=[...t==="clippingAncestors"?EB(e)?[]:H5e(e,this._c):[].concat(t),r],l=o[0],a=o.reduce((h,f)=>{const p=jK(e,f,i);return h.top=Wl(p.top,h.top),h.right=px(p.right,h.right),h.bottom=px(p.bottom,h.bottom),h.left=Wl(p.left,h.left),h},jK(e,l,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function W5e(n){const{width:e,height:t}=kce(n);return{width:e,height:t}}function $5e(n,e,t){const r=yp(e),i=Mp(e),s=t==="fixed",o=gx(n,!0,s,e);let l={scrollLeft:0,scrollTop:0};const a=pp(0);if(r||!r&&!s)if((Uw(e)!=="body"||EE(i))&&(l=CB(e)),r){const v=gx(e,!0,s,e);a.x=v.x+e.clientLeft,a.y=v.y+e.clientTop}else i&&(a.x=v8(i));const h=i&&!r&&!s?Fce(i,l):pp(0),f=o.left+l.scrollLeft-a.x-h.x,p=o.top+l.scrollTop-a.y-h.y;return{x:f,y:p,width:o.width,height:o.height}}function fN(n){return td(n).position==="static"}function WK(n,e){if(!yp(n)||td(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return Mp(n)===t&&(t=t.ownerDocument.body),t}function zce(n,e){const t=zu(n);if(EB(n))return t;if(!yp(n)){let i=w0(n);for(;i&&!gw(i);){if(Ec(i)&&!fN(i))return i;i=w0(i)}return t}let r=WK(n,e);for(;r&&y5e(r)&&fN(r);)r=WK(r,e);return r&&gw(r)&&fN(r)&&!p8(r)?t:r||x5e(n)||t}const X5e=async function(n){const e=this.getOffsetParent||zce,t=this.getDimensions,r=await t(n.floating);return{reference:$5e(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function q5e(n){return td(n).direction==="rtl"}const Z5e={convertOffsetParentRelativeRectToViewportRelativeRect:N5e,getDocumentElement:Mp,getClippingRect:j5e,getOffsetParent:zce,getElementRects:X5e,getClientRects:z5e,getDimensions:W5e,getScale:qb,isElement:Ec,isRTL:q5e};function Y5e(n,e){let t=null,r;const i=Mp(n);function s(){var l;clearTimeout(r),(l=t)==null||l.disconnect(),t=null}function o(l,a){l===void 0&&(l=!1),a===void 0&&(a=1),s();const{left:h,top:f,width:p,height:v}=n.getBoundingClientRect();if(l||e(),!p||!v)return;const y=II(f),S=II(i.clientWidth-(h+p)),C=II(i.clientHeight-(f+v)),M=II(h),L={rootMargin:-y+"px "+-S+"px "+-C+"px "+-M+"px",threshold:Wl(0,px(1,a))||1};let k=!0;function H(X){const Z=X[0].intersectionRatio;if(Z!==a){if(!k)return o();Z?o(!1,Z):r=setTimeout(()=>{o(!1,1e-7)},1e3)}k=!1}try{t=new IntersectionObserver(H,{...L,root:i.ownerDocument})}catch{t=new IntersectionObserver(H,L)}t.observe(n)}return o(!0),s}function K5e(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:a=!1}=r,h=g8(n),f=i||s?[...h?IM(h):[],...IM(e)]:[];f.forEach(E=>{i&&E.addEventListener("scroll",t,{passive:!0}),s&&E.addEventListener("resize",t)});const p=h&&l?Y5e(h,t):null;let v=-1,y=null;o&&(y=new ResizeObserver(E=>{let[L]=E;L&&L.target===h&&y&&(y.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var k;(k=y)==null||k.observe(e)})),t()}),h&&!a&&y.observe(h),y.observe(e));let S,C=a?gx(n):null;a&&M();function M(){const E=gx(n);C&&(E.x!==C.x||E.y!==C.y||E.width!==C.width||E.height!==C.height)&&t(),C=E,S=requestAnimationFrame(M)}return t(),()=>{var E;f.forEach(L=>{i&&L.removeEventListener("scroll",t),s&&L.removeEventListener("resize",t)}),p==null||p(),(E=y)==null||E.disconnect(),y=null,a&&cancelAnimationFrame(S)}}const dN=IB,J5e=D5e,Q5e=B5e,eUe=P5e,tUe=k5e,nUe=(n,e,t)=>{const r=new Map,i={platform:Z5e,...t},s={...i.platform,_c:r};return R5e(n,e,{...i,platform:s})};var yR=typeof document<"u"?Ae.useLayoutEffect:Ae.useEffect;function yL(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,i;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!yL(n[r],e[r]))return!1;return!0}if(i=Object.keys(n),t=i.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=t;r--!==0;){const s=i[r];if(!(s==="_owner"&&n.$$typeof)&&!yL(n[s],e[s]))return!1}return!0}return n!==n&&e!==e}function Uce(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function $K(n,e){const t=Uce(n);return Math.round(e*t)/t}function pN(n){const e=Ae.useRef(n);return yR(()=>{e.current=n}),e}function rUe(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:l=!0,whileElementsMounted:a,open:h}=n,[f,p]=Ae.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[v,y]=Ae.useState(r);yL(v,r)||y(r);const[S,C]=Ae.useState(null),[M,E]=Ae.useState(null),L=Ae.useCallback(_e=>{_e!==Z.current&&(Z.current=_e,C(_e))},[]),k=Ae.useCallback(_e=>{_e!==Q.current&&(Q.current=_e,E(_e))},[]),H=s||S,X=o||M,Z=Ae.useRef(null),Q=Ae.useRef(null),re=Ae.useRef(f),ie=a!=null,oe=pN(a),fe=pN(i),Se=pN(h),Ee=Ae.useCallback(()=>{if(!Z.current||!Q.current)return;const _e={placement:e,strategy:t,middleware:v};fe.current&&(_e.platform=fe.current),nUe(Z.current,Q.current,_e).then(We=>{const Ue={...We,isPositioned:Se.current!==!1};Ie.current&&!yL(re.current,Ue)&&(re.current=Ue,qf.flushSync(()=>{p(Ue)}))})},[v,e,t,fe,Se]);yR(()=>{h===!1&&re.current.isPositioned&&(re.current.isPositioned=!1,p(_e=>({..._e,isPositioned:!1})))},[h]);const Ie=Ae.useRef(!1);yR(()=>(Ie.current=!0,()=>{Ie.current=!1}),[]),yR(()=>{if(H&&(Z.current=H),X&&(Q.current=X),H&&X){if(oe.current)return oe.current(H,X,Ee);Ee()}},[H,X,Ee,oe,ie]);const He=Ae.useMemo(()=>({reference:Z,floating:Q,setReference:L,setFloating:k}),[L,k]),Re=Ae.useMemo(()=>({reference:H,floating:X}),[H,X]),st=Ae.useMemo(()=>{const _e={position:t,left:0,top:0};if(!Re.floating)return _e;const We=$K(Re.floating,f.x),Ue=$K(Re.floating,f.y);return l?{..._e,transform:"translate("+We+"px, "+Ue+"px)",...Uce(Re.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:We,top:Ue}},[t,l,Re.floating,f.x,f.y]);return Ae.useMemo(()=>({...f,update:Ee,refs:He,elements:Re,floatingStyles:st}),[f,Ee,He,Re,st])}const Gce=(n,e)=>({...J5e(n),options:[n,e]}),iUe=(n,e)=>({...Q5e(n),options:[n,e]}),sUe=(n,e)=>({...eUe(n),options:[n,e]}),aUe=(n,e)=>({...tUe(n),options:[n,e]}),Vce={...AR},oUe=Vce.useInsertionEffect,lUe=oUe||(n=>n());function Hce(n){const e=Ae.useRef(()=>{});return lUe(()=>{e.current=n}),Ae.useCallback(function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}var O5=typeof document<"u"?Ae.useLayoutEffect:Ae.useEffect;let XK=!1,cUe=0;const qK=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+cUe++;function uUe(){const[n,e]=Ae.useState(()=>XK?qK():void 0);return O5(()=>{n==null&&e(qK())},[]),Ae.useEffect(()=>{XK=!0},[]),n}const hUe=Vce.useId,fUe=hUe||uUe;function dUe(){const n=new Map;return{emit(e,t){var r;(r=n.get(e))==null||r.forEach(i=>i(t))},on(e,t){n.set(e,[...n.get(e)||[],t])},off(e,t){var r;n.set(e,((r=n.get(e))==null?void 0:r.filter(i=>i!==t))||[])}}}const pUe=Ae.createContext(null),mUe=Ae.createContext(null),gUe=()=>{var n;return((n=Ae.useContext(pUe))==null?void 0:n.id)||null},vUe=()=>Ae.useContext(mUe),_Ue="data-floating-ui-focusable";function yUe(n){const{open:e=!1,onOpenChange:t,elements:r}=n,i=fUe(),s=Ae.useRef({}),[o]=Ae.useState(()=>dUe()),l=gUe()!=null,[a,h]=Ae.useState(r.reference),f=Hce((y,S,C)=>{s.current.openEvent=y?S:void 0,o.emit("openchange",{open:y,event:S,reason:C,nested:l}),t==null||t(y,S,C)}),p=Ae.useMemo(()=>({setPositionReference:h}),[]),v=Ae.useMemo(()=>({reference:a||r.reference||null,floating:r.floating||null,domReference:r.reference}),[a,r.reference,r.floating]);return Ae.useMemo(()=>({dataRef:s,open:e,onOpenChange:f,elements:v,events:o,floatingId:i,refs:p}),[e,f,v,o,i,p])}function xUe(n){n===void 0&&(n={});const{nodeId:e}=n,t=yUe({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,i=r.elements,[s,o]=Ae.useState(null),[l,a]=Ae.useState(null),f=(i==null?void 0:i.domReference)||s,p=Ae.useRef(null),v=vUe();O5(()=>{f&&(p.current=f)},[f]);const y=rUe({...n,elements:{...i,...l&&{reference:l}}}),S=Ae.useCallback(k=>{const H=Ec(k)?{getBoundingClientRect:()=>k.getBoundingClientRect(),contextElement:k}:k;a(H),y.refs.setReference(H)},[y.refs]),C=Ae.useCallback(k=>{(Ec(k)||k===null)&&(p.current=k,o(k)),(Ec(y.refs.reference.current)||y.refs.reference.current===null||k!==null&&!Ec(k))&&y.refs.setReference(k)},[y.refs]),M=Ae.useMemo(()=>({...y.refs,setReference:C,setPositionReference:S,domReference:p}),[y.refs,C,S]),E=Ae.useMemo(()=>({...y.elements,domReference:f}),[y.elements,f]),L=Ae.useMemo(()=>({...y,...r,refs:M,elements:E,nodeId:e}),[y,M,E,e,r]);return O5(()=>{r.dataRef.current.floatingContext=L;const k=v==null?void 0:v.nodesRef.current.find(H=>H.id===e);k&&(k.context=L)}),Ae.useMemo(()=>({...y,context:L,refs:M,elements:E}),[y,M,E,L])}const ZK="active",YK="selected";function mN(n,e,t){const r=new Map,i=t==="item";let s=n;if(i&&n){const{[ZK]:o,[YK]:l,...a}=n;s=a}return{...t==="floating"&&{tabIndex:-1,[_Ue]:""},...s,...e.map(o=>{const l=o?o[t]:null;return typeof l=="function"?n?l(n):null:l}).concat(n).reduce((o,l)=>(l&&Object.entries(l).forEach(a=>{let[h,f]=a;if(!(i&&[ZK,YK].includes(h)))if(h.indexOf("on")===0){if(r.has(h)||r.set(h,[]),typeof f=="function"){var p;(p=r.get(h))==null||p.push(f),o[h]=function(){for(var v,y=arguments.length,S=new Array(y),C=0;C<y;C++)S[C]=arguments[C];return(v=r.get(h))==null?void 0:v.map(M=>M(...S)).find(M=>M!==void 0)}}}else o[h]=f}),o),{})}}function bUe(n){n===void 0&&(n=[]);const e=n.map(l=>l==null?void 0:l.reference),t=n.map(l=>l==null?void 0:l.floating),r=n.map(l=>l==null?void 0:l.item),i=Ae.useCallback(l=>mN(l,n,"reference"),e),s=Ae.useCallback(l=>mN(l,n,"floating"),t),o=Ae.useCallback(l=>mN(l,n,"item"),r);return Ae.useMemo(()=>({getReferenceProps:i,getFloatingProps:s,getItemProps:o}),[i,s,o])}function KK(n,e){return{...n,rects:{...n.rects,floating:{...n.rects.floating,height:e}}}}const wUe=n=>({name:"inner",options:n,async fn(e){const{listRef:t,overflowRef:r,onFallbackChange:i,offset:s=0,index:o=0,minItemsVisible:l=4,referenceOverflowThreshold:a=0,scrollRef:h,...f}=Gw(n,e),{rects:p,elements:{floating:v}}=e,y=t.current[o],S=(h==null?void 0:h.current)||v,C=v.clientTop||S.clientTop,M=v.clientTop!==0,E=S.clientTop!==0,L=v===S;if(!y)return{};const k={...e,...await Gce(-y.offsetTop-v.clientTop-p.reference.height/2-y.offsetHeight/2-s).fn(e)},H=await dN(KK(k,S.scrollHeight+C+v.clientTop),f),X=await dN(k,{...f,elementContext:"reference"}),Z=Wl(0,H.top),Q=k.y+Z,oe=(S.scrollHeight>S.clientHeight?fe=>fe:RM)(Wl(0,S.scrollHeight+(M&&L||E?C*2:0)-Z-Wl(0,H.bottom)));if(S.style.maxHeight=oe+"px",S.scrollTop=Z,i){const fe=S.offsetHeight<y.offsetHeight*px(l,t.current.length)-1||X.top>=-a||X.bottom>=-a;qf.flushSync(()=>i(fe))}return r&&(r.current=await dN(KK({...k,y:Q},S.offsetHeight+C+v.clientTop),f)),{y:Q}}});function SUe(n,e){const{open:t,elements:r}=n,{enabled:i=!0,overflowRef:s,scrollRef:o,onChange:l}=e,a=Hce(l),h=Ae.useRef(!1),f=Ae.useRef(null),p=Ae.useRef(null);Ae.useEffect(()=>{if(!i)return;function y(C){if(C.ctrlKey||!S||s.current==null)return;const M=C.deltaY,E=s.current.top>=-.5,L=s.current.bottom>=-.5,k=S.scrollHeight-S.clientHeight,H=M<0?-1:1,X=M<0?"max":"min";S.scrollHeight<=S.clientHeight||(!E&&M>0||!L&&M<0?(C.preventDefault(),qf.flushSync(()=>{a(Z=>Z+Math[X](M,k*H))})):/firefox/i.test(b5e())&&(S.scrollTop+=M))}const S=(o==null?void 0:o.current)||r.floating;if(t&&S)return S.addEventListener("wheel",y),requestAnimationFrame(()=>{f.current=S.scrollTop,s.current!=null&&(p.current={...s.current})}),()=>{f.current=null,p.current=null,S.removeEventListener("wheel",y)}},[i,t,r.floating,s,o,a]);const v=Ae.useMemo(()=>({onKeyDown(){h.current=!0},onWheel(){h.current=!1},onPointerMove(){h.current=!1},onScroll(){const y=(o==null?void 0:o.current)||r.floating;if(!(!s.current||!y||!h.current)){if(f.current!==null){const S=y.scrollTop-f.current;(s.current.bottom<-.5&&S<-1||s.current.top<-.5&&S>1)&&qf.flushSync(()=>a(C=>C+S))}requestAnimationFrame(()=>{f.current=y.scrollTop})}}}),[r.floating,a,s,o]);return Ae.useMemo(()=>i?{floating:v}:{},[i,v])}let Vw=Ae.createContext({styles:void 0,setReference:()=>{},setFloating:()=>{},getReferenceProps:()=>({}),getFloatingProps:()=>({}),slot:{}});Vw.displayName="FloatingContext";let _8=Ae.createContext(null);_8.displayName="PlacementContext";function AUe(n){return Ae.useMemo(()=>n?typeof n=="string"?{to:n}:n:null,[n])}function TUe(){return Ae.useContext(Vw).setReference}function MUe(){return Ae.useContext(Vw).getReferenceProps}function EUe(){let{getFloatingProps:n,slot:e}=Ae.useContext(Vw);return Ae.useCallback((...t)=>Object.assign({},n(...t),{"data-anchor":e.anchor}),[n,e])}function CUe(n=null){n===!1&&(n=null),typeof n=="string"&&(n={to:n});let e=Ae.useContext(_8),t=Ae.useMemo(()=>n,[JSON.stringify(n,(i,s)=>{var o;return(o=s==null?void 0:s.outerHTML)!=null?o:s})]);Co(()=>{e==null||e(t??null)},[e,t]);let r=Ae.useContext(Vw);return Ae.useMemo(()=>[r.setFloating,n?r.styles:{}],[r.setFloating,n,r.styles])}let JK=4;function IUe({children:n,enabled:e=!0}){let[t,r]=Ae.useState(null),[i,s]=Ae.useState(0),o=Ae.useRef(null),[l,a]=Ae.useState(null);RUe(l);let h=e&&t!==null&&l!==null,{to:f="bottom",gap:p=0,offset:v=0,padding:y=0,inner:S}=PUe(t,l),[C,M="center"]=f.split(" ");Co(()=>{h&&s(0)},[h]);let{refs:E,floatingStyles:L,context:k}=xUe({open:h,placement:C==="selection"?M==="center"?"bottom":`bottom-${M}`:M==="center"?`${C}`:`${C}-${M}`,strategy:"absolute",transform:!1,middleware:[Gce({mainAxis:C==="selection"?0:p,crossAxis:v}),iUe({padding:y}),C!=="selection"&&sUe({padding:y}),C==="selection"&&S?wUe({...S,padding:y,overflowRef:o,offset:i,minItemsVisible:JK,referenceOverflowThreshold:y,onFallbackChange(fe){var Se,Ee;if(!fe)return;let Ie=k.elements.floating;if(!Ie)return;let He=parseFloat(getComputedStyle(Ie).scrollPaddingBottom)||0,Re=Math.min(JK,Ie.childElementCount),st=0,_e=0;for(let We of(Ee=(Se=k.elements.floating)==null?void 0:Se.childNodes)!=null?Ee:[])if(We instanceof HTMLElement){let Ue=We.offsetTop,vt=Ue+We.clientHeight+He,xt=Ie.scrollTop,Vt=xt+Ie.clientHeight;if(Ue>=xt&&vt<=Vt)Re--;else{_e=Math.max(0,Math.min(vt,Vt)-Math.max(Ue,xt)),st=We.clientHeight;break}}Re>=1&&s(We=>{let Ue=st*Re-_e+He;return We>=Ue?We:Ue})}}):null,aUe({padding:y,apply({availableWidth:fe,availableHeight:Se,elements:Ee}){Object.assign(Ee.floating.style,{overflow:"auto",maxWidth:`${fe}px`,maxHeight:`min(var(--anchor-max-height, 100vh), ${Se}px)`})}})].filter(Boolean),whileElementsMounted:K5e}),[H=C,X=M]=k.placement.split("-");C==="selection"&&(H="selection");let Z=Ae.useMemo(()=>({anchor:[H,X].filter(Boolean).join(" ")}),[H,X]),Q=SUe(k,{overflowRef:o,onChange:s}),{getReferenceProps:re,getFloatingProps:ie}=bUe([Q]),oe=Ea(fe=>{a(fe),E.setFloating(fe)});return Ae.createElement(_8.Provider,{value:r},Ae.createElement(Vw.Provider,{value:{setFloating:oe,setReference:E.setReference,styles:L,getReferenceProps:re,getFloatingProps:ie,slot:Z}},n))}function RUe(n){Co(()=>{if(!n)return;let e=new MutationObserver(()=>{let t=window.getComputedStyle(n).maxHeight,r=parseFloat(t);if(isNaN(r))return;let i=parseInt(t);isNaN(i)||r!==i&&(n.style.maxHeight=`${Math.ceil(r)}px`)});return e.observe(n,{attributes:!0,attributeFilter:["style"]}),()=>{e.disconnect()}},[n])}function PUe(n,e){var t,r,i;let s=gN((t=n==null?void 0:n.gap)!=null?t:"var(--anchor-gap, 0)",e),o=gN((r=n==null?void 0:n.offset)!=null?r:"var(--anchor-offset, 0)",e),l=gN((i=n==null?void 0:n.padding)!=null?i:"var(--anchor-padding, 0)",e);return{...n,gap:s,offset:o,padding:l}}function gN(n,e,t=void 0){let r=AB(),i=Ea((a,h)=>{if(a==null)return[t,null];if(typeof a=="number")return[a,null];if(typeof a=="string"){if(!h)return[t,null];let f=QK(a,h);return[f,p=>{let v=jce(a);{let y=v.map(S=>window.getComputedStyle(h).getPropertyValue(S));r.requestAnimationFrame(function S(){r.nextFrame(S);let C=!1;for(let[E,L]of v.entries()){let k=window.getComputedStyle(h).getPropertyValue(L);if(y[E]!==k){y[E]=k,C=!0;break}}if(!C)return;let M=QK(a,h);f!==M&&(p(M),f=M)})}return r.dispose}]}return[t,null]}),s=Ae.useMemo(()=>i(n,e)[0],[n,e]),[o=s,l]=Ae.useState();return Co(()=>{let[a,h]=i(n,e);if(l(a),!!h)return h(l)},[n,e]),o}function jce(n){let e=/var\((.*)\)/.exec(n);if(e){let t=e[1].indexOf(",");if(t===-1)return[e[1]];let r=e[1].slice(0,t).trim(),i=e[1].slice(t+1).trim();return i?[r,...jce(i)]:[r]}return[]}function QK(n,e){let t=document.createElement("div");e.appendChild(t),t.style.setProperty("margin-top","0px","important"),t.style.setProperty("margin-top",n,"important");let r=parseFloat(window.getComputedStyle(t).marginTop)||0;return e.removeChild(t),r}let y8=Ae.createContext(null);y8.displayName="OpenClosedContext";var PM=(n=>(n[n.Open=1]="Open",n[n.Closed=2]="Closed",n[n.Closing=4]="Closing",n[n.Opening=8]="Opening",n))(PM||{});function LUe(){return Ae.useContext(y8)}function DUe({value:n,children:e}){return Zl.createElement(y8.Provider,{value:n},e)}function BUe(n){throw new Error("Unexpected object: "+n)}var $l=(n=>(n[n.First=0]="First",n[n.Previous=1]="Previous",n[n.Next=2]="Next",n[n.Last=3]="Last",n[n.Specific=4]="Specific",n[n.Nothing=5]="Nothing",n))($l||{});function vN(n,e){let t=e.resolveItems();if(t.length<=0)return null;let r=e.resolveActiveIndex(),i=r??-1;switch(n.focus){case 0:{for(let s=0;s<t.length;++s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 1:{i===-1&&(i=t.length);for(let s=i-1;s>=0;--s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 2:{for(let s=i+1;s<t.length;++s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 3:{for(let s=t.length-1;s>=0;--s)if(!e.resolveDisabled(t[s],s,t))return s;return r}case 4:{for(let s=0;s<t.length;++s)if(e.resolveId(t[s],s,t)===n.id)return s;return r}case 5:return null;default:BUe(n)}}function kUe(n){let e=Ea(n),t=Ae.useRef(!1);Ae.useEffect(()=>(t.current=!1,()=>{t.current=!0,vce(()=>{t.current&&e()})}),[e])}function OUe(){let n=typeof document>"u";return"useSyncExternalStore"in AR?(e=>e.useSyncExternalStore)(AR)(()=>()=>{},()=>!1,()=>!n):!1}function FUe(){let n=OUe(),[e,t]=Ae.useState($y.isHandoffComplete);return e&&$y.isHandoffComplete===!1&&t(!1),Ae.useEffect(()=>{e!==!0&&t(!0)},[e]),Ae.useEffect(()=>$y.handoff(),[]),n?!1:e}let NUe=Ae.createContext(!1);function zUe(){return Ae.useContext(NUe)}function UUe(n){let e=zUe(),t=Ae.useContext($ce),r=d8(n),[i,s]=Ae.useState(()=>{var o;if(!e&&t!==null)return(o=t.current)!=null?o:null;if($y.isServer)return null;let l=r==null?void 0:r.getElementById("headlessui-portal-root");if(l)return l;if(r===null)return null;let a=r.createElement("div");return a.setAttribute("id","headlessui-portal-root"),r.body.appendChild(a)});return Ae.useEffect(()=>{i!==null&&(r!=null&&r.body.contains(i)||r==null||r.body.appendChild(i))},[i,r]),Ae.useEffect(()=>{e||t!==null&&s(t.current)},[t,s,e]),i}let Wce=Ae.Fragment,GUe=Vh(function(n,e){let t=n,r=Ae.useRef(null),i=lg(Eze(p=>{r.current=p}),e),s=d8(r),o=UUe(r),[l]=Ae.useState(()=>{var p;return $y.isServer?null:(p=s==null?void 0:s.createElement("div"))!=null?p:null}),a=Ae.useContext(WUe),h=FUe();Co(()=>{!o||!l||o.contains(l)||(l.setAttribute("data-headlessui-portal",""),o.appendChild(l))},[o,l]),Co(()=>{if(l&&a)return a.register(l)},[a,l]),kUe(()=>{var p;!o||!l||(l instanceof Node&&o.contains(l)&&o.removeChild(l),o.childNodes.length<=0&&((p=o.parentElement)==null||p.removeChild(o)))});let f=Gh();return h?!o||!l?null:qf.createPortal(f({ourProps:{ref:i},theirProps:t,slot:{},defaultTag:Wce,name:"Portal"}),l):null});function VUe(n,e){let t=lg(e),{enabled:r=!0,...i}=n,s=Gh();return r?Zl.createElement(GUe,{...i,ref:t}):s({ourProps:{ref:t},theirProps:i,slot:{},defaultTag:Wce,name:"Portal"})}let HUe=Ae.Fragment,$ce=Ae.createContext(null);function jUe(n,e){let{target:t,...r}=n,i={ref:lg(e)},s=Gh();return Zl.createElement($ce.Provider,{value:t},s({ourProps:i,theirProps:r,defaultTag:HUe,name:"Popover.Group"}))}let WUe=Ae.createContext(null),$Ue=Vh(VUe),XUe=Vh(jUe),qUe=Object.assign($Ue,{Group:XUe});function ZUe(n,e){let t=Ae.useRef({left:0,top:0});if(Co(()=>{if(!e)return;let i=e.getBoundingClientRect();i&&(t.current=i)},[n,e]),e==null||!n||e===document.activeElement)return!1;let r=e.getBoundingClientRect();return r.top!==t.current.top||r.left!==t.current.left}let eJ=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function tJ(n){var e,t;let r=(e=n.innerText)!=null?e:"",i=n.cloneNode(!0);if(!(i instanceof HTMLElement))return r;let s=!1;for(let l of i.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))l.remove(),s=!0;let o=s?(t=i.innerText)!=null?t:"":r;return eJ.test(o)&&(o=o.replace(eJ,"")),o}function YUe(n){let e=n.getAttribute("aria-label");if(typeof e=="string")return e.trim();let t=n.getAttribute("aria-labelledby");if(t){let r=t.split(" ").map(i=>{let s=document.getElementById(i);if(s){let o=s.getAttribute("aria-label");return typeof o=="string"?o.trim():tJ(s).trim()}return null}).filter(Boolean);if(r.length>0)return r.join(", ")}return tJ(n).trim()}function KUe(n){let e=Ae.useRef(""),t=Ae.useRef("");return Ea(()=>{let r=n.current;if(!r)return"";let i=r.innerText;if(e.current===i)return t.current;let s=YUe(r).trim().toLowerCase();return e.current=i,t.current=s,s})}var JUe=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(JUe||{}),QUe=(n=>(n[n.Pointer=0]="Pointer",n[n.Other=1]="Other",n))(QUe||{}),e6e=(n=>(n[n.OpenMenu=0]="OpenMenu",n[n.CloseMenu=1]="CloseMenu",n[n.GoToItem=2]="GoToItem",n[n.Search=3]="Search",n[n.ClearSearch=4]="ClearSearch",n[n.RegisterItem=5]="RegisterItem",n[n.UnregisterItem=6]="UnregisterItem",n[n.SetButtonElement=7]="SetButtonElement",n[n.SetItemsElement=8]="SetItemsElement",n))(e6e||{});function _N(n,e=t=>t){let t=n.activeItemIndex!==null?n.items[n.activeItemIndex]:null,r=Cce(e(n.items.slice()),s=>s.dataRef.current.domRef.current),i=t?r.indexOf(t):null;return i===-1&&(i=null),{items:r,activeItemIndex:i}}let t6e={1(n){return n.menuState===1?n:{...n,activeItemIndex:null,menuState:1}},0(n){return n.menuState===0?n:{...n,__demoMode:!1,menuState:0}},2:(n,e)=>{var t,r,i,s,o;if(n.menuState===1)return n;let l={...n,searchQuery:"",activationTrigger:(t=e.trigger)!=null?t:1,__demoMode:!1};if(e.focus===$l.Nothing)return{...l,activeItemIndex:null};if(e.focus===$l.Specific)return{...l,activeItemIndex:n.items.findIndex(f=>f.id===e.id)};if(e.focus===$l.Previous){let f=n.activeItemIndex;if(f!==null){let p=n.items[f].dataRef.current.domRef,v=vN(e,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:y=>y.id,resolveDisabled:y=>y.dataRef.current.disabled});if(v!==null){let y=n.items[v].dataRef.current.domRef;if(((r=p.current)==null?void 0:r.previousElementSibling)===y.current||((i=y.current)==null?void 0:i.previousElementSibling)===null)return{...l,activeItemIndex:v}}}}else if(e.focus===$l.Next){let f=n.activeItemIndex;if(f!==null){let p=n.items[f].dataRef.current.domRef,v=vN(e,{resolveItems:()=>n.items,resolveActiveIndex:()=>n.activeItemIndex,resolveId:y=>y.id,resolveDisabled:y=>y.dataRef.current.disabled});if(v!==null){let y=n.items[v].dataRef.current.domRef;if(((s=p.current)==null?void 0:s.nextElementSibling)===y.current||((o=y.current)==null?void 0:o.nextElementSibling)===null)return{...l,activeItemIndex:v}}}}let a=_N(n),h=vN(e,{resolveItems:()=>a.items,resolveActiveIndex:()=>a.activeItemIndex,resolveId:f=>f.id,resolveDisabled:f=>f.dataRef.current.disabled});return{...l,...a,activeItemIndex:h}},3:(n,e)=>{let t=n.searchQuery!==""?0:1,r=n.searchQuery+e.value.toLowerCase(),i=(n.activeItemIndex!==null?n.items.slice(n.activeItemIndex+t).concat(n.items.slice(0,n.activeItemIndex+t)):n.items).find(o=>{var l;return((l=o.dataRef.current.textValue)==null?void 0:l.startsWith(r))&&!o.dataRef.current.disabled}),s=i?n.items.indexOf(i):-1;return s===-1||s===n.activeItemIndex?{...n,searchQuery:r}:{...n,searchQuery:r,activeItemIndex:s,activationTrigger:1}},4(n){return n.searchQuery===""?n:{...n,searchQuery:"",searchActiveItemIndex:null}},5:(n,e)=>{let t=_N(n,r=>[...r,{id:e.id,dataRef:e.dataRef}]);return{...n,...t}},6:(n,e)=>{let t=_N(n,r=>{let i=r.findIndex(s=>s.id===e.id);return i!==-1&&r.splice(i,1),r});return{...n,...t,activationTrigger:1}},7:(n,e)=>n.buttonElement===e.element?n:{...n,buttonElement:e.element},8:(n,e)=>n.itemsElement===e.element?n:{...n,itemsElement:e.element}},x8=Ae.createContext(null);x8.displayName="MenuContext";function RB(n){let e=Ae.useContext(x8);if(e===null){let t=new Error(`<${n} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,RB),t}return e}function n6e(n,e){return ME(e.type,t6e,n,e)}let r6e=Ae.Fragment;function i6e(n,e){let{__demoMode:t=!1,...r}=n,i=Ae.useReducer(n6e,{__demoMode:t,menuState:t?0:1,buttonElement:null,itemsElement:null,items:[],searchQuery:"",activeItemIndex:null,activationTrigger:1}),[{menuState:s,itemsElement:o,buttonElement:l},a]=i,h=lg(e);t5e(s===0,[l,o],(S,C)=>{a({type:1}),f8(C,h8.Loose)||(S.preventDefault(),l==null||l.focus())});let f=Ea(()=>{a({type:1})}),p=Ae.useMemo(()=>({open:s===0,close:f}),[s,f]),v={ref:h},y=Gh();return Zl.createElement(IUe,null,Zl.createElement(x8.Provider,{value:i},Zl.createElement(DUe,{value:ME(s,{0:PM.Open,1:PM.Closed})},y({ourProps:v,theirProps:r,slot:p,defaultTag:r6e,name:"Menu"}))))}let s6e="button";function a6e(n,e){var t;let r=Ae.useId(),{id:i=`headlessui-menu-button-${r}`,disabled:s=!1,autoFocus:o=!1,...l}=n,[a,h]=RB("Menu.Button"),f=MUe(),p=lg(e,TUe(),Ea(Q=>h({type:7,element:Q}))),v=Ea(Q=>{switch(Q.key){case xl.Space:case xl.Enter:case xl.ArrowDown:Q.preventDefault(),Q.stopPropagation(),qf.flushSync(()=>h({type:0})),h({type:2,focus:$l.First});break;case xl.ArrowUp:Q.preventDefault(),Q.stopPropagation(),qf.flushSync(()=>h({type:0})),h({type:2,focus:$l.Last});break}}),y=Ea(Q=>{switch(Q.key){case xl.Space:Q.preventDefault();break}}),S=Ea(Q=>{var re;if(Tze(Q.currentTarget))return Q.preventDefault();s||(a.menuState===0?(qf.flushSync(()=>h({type:1})),(re=a.buttonElement)==null||re.focus({preventScroll:!0})):(Q.preventDefault(),h({type:0})))}),{isFocusVisible:C,focusProps:M}=uze({autoFocus:o}),{isHovered:E,hoverProps:L}=cze({isDisabled:s}),{pressed:k,pressProps:H}=gze({disabled:s}),X=Ae.useMemo(()=>({open:a.menuState===0,active:k||a.menuState===0,disabled:s,hover:E,focus:C,autofocus:o}),[a,E,C,k,s,o]),Z=xce(f(),{ref:p,id:i,type:n5e(n,a.buttonElement),"aria-haspopup":"menu","aria-controls":(t=a.itemsElement)==null?void 0:t.id,"aria-expanded":a.menuState===0,disabled:s||void 0,autoFocus:o,onKeyDown:v,onKeyUp:y,onClick:S},M,L,H);return Gh()({ourProps:Z,theirProps:l,slot:X,defaultTag:s6e,name:"Menu.Button"})}let o6e="div",l6e=R5.RenderStrategy|R5.Static;function c6e(n,e){var t,r;let i=Ae.useId(),{id:s=`headlessui-menu-items-${i}`,anchor:o,portal:l=!1,modal:a=!0,transition:h=!1,...f}=n,p=AUe(o),[v,y]=RB("Menu.Items"),[S,C]=CUe(p),M=EUe(),[E,L]=Ae.useState(null),k=lg(e,p?S:null,Ea(_e=>y({type:8,element:_e})),L),H=d8(v.itemsElement);p&&(l=!0);let X=LUe(),[Z,Q]=p5e(h,E,X!==null?(X&PM.Open)===PM.Open:v.menuState===0);Gze(Z,v.buttonElement,()=>{y({type:1})});let re=v.__demoMode?!1:a&&v.menuState===0;l5e(re,H);let ie=v.__demoMode?!1:a&&v.menuState===0;Uze(ie,{allowed:Ae.useCallback(()=>[v.buttonElement,v.itemsElement],[v.buttonElement,v.itemsElement])});let oe=v.menuState!==0,fe=ZUe(oe,v.buttonElement)?!1:Z;Ae.useEffect(()=>{let _e=v.itemsElement;_e&&v.menuState===0&&_e!==(H==null?void 0:H.activeElement)&&_e.focus({preventScroll:!0})},[v.menuState,v.itemsElement,H]),_5e(v.menuState===0,{container:v.itemsElement,accept(_e){return _e.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:_e.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(_e){_e.setAttribute("role","none")}});let Se=AB(),Ee=Ea(_e=>{var We,Ue,vt;switch(Se.dispose(),_e.key){case xl.Space:if(v.searchQuery!=="")return _e.preventDefault(),_e.stopPropagation(),y({type:3,value:_e.key});case xl.Enter:if(_e.preventDefault(),_e.stopPropagation(),y({type:1}),v.activeItemIndex!==null){let{dataRef:xt}=v.items[v.activeItemIndex];(Ue=(We=xt.current)==null?void 0:We.domRef.current)==null||Ue.click()}Ece(v.buttonElement);break;case xl.ArrowDown:return _e.preventDefault(),_e.stopPropagation(),y({type:2,focus:$l.Next});case xl.ArrowUp:return _e.preventDefault(),_e.stopPropagation(),y({type:2,focus:$l.Previous});case xl.Home:case xl.PageUp:return _e.preventDefault(),_e.stopPropagation(),y({type:2,focus:$l.First});case xl.End:case xl.PageDown:return _e.preventDefault(),_e.stopPropagation(),y({type:2,focus:$l.Last});case xl.Escape:_e.preventDefault(),_e.stopPropagation(),qf.flushSync(()=>y({type:1})),(vt=v.buttonElement)==null||vt.focus({preventScroll:!0});break;case xl.Tab:_e.preventDefault(),_e.stopPropagation(),qf.flushSync(()=>y({type:1})),Yze(v.buttonElement,_e.shiftKey?D5.Previous:D5.Next);break;default:_e.key.length===1&&(y({type:3,value:_e.key}),Se.setTimeout(()=>y({type:4}),350));break}}),Ie=Ea(_e=>{switch(_e.key){case xl.Space:_e.preventDefault();break}}),He=Ae.useMemo(()=>({open:v.menuState===0}),[v.menuState]),Re=xce(p?M():{},{"aria-activedescendant":v.activeItemIndex===null||(t=v.items[v.activeItemIndex])==null?void 0:t.id,"aria-labelledby":(r=v.buttonElement)==null?void 0:r.id,id:s,onKeyDown:Ee,onKeyUp:Ie,role:"menu",tabIndex:v.menuState===0?0:void 0,ref:k,style:{...f.style,...C,"--button-width":Fze(v.buttonElement,!0).width},...d5e(Q)}),st=Gh();return Zl.createElement(qUe,{enabled:l?n.static||Z:!1},st({ourProps:Re,theirProps:f,slot:He,defaultTag:o6e,features:l6e,visible:fe,name:"Menu.Items"}))}let u6e=Ae.Fragment;function h6e(n,e){let t=Ae.useId(),{id:r=`headlessui-menu-item-${t}`,disabled:i=!1,...s}=n,[o,l]=RB("Menu.Item"),a=o.activeItemIndex!==null?o.items[o.activeItemIndex].id===r:!1,h=Ae.useRef(null),f=lg(e,h);Co(()=>{if(!o.__demoMode&&o.menuState===0&&a&&o.activationTrigger!==0)return Tp().requestAnimationFrame(()=>{var fe,Se;(Se=(fe=h.current)==null?void 0:fe.scrollIntoView)==null||Se.call(fe,{block:"nearest"})})},[o.__demoMode,h,a,o.menuState,o.activationTrigger,o.activeItemIndex]);let p=KUe(h),v=Ae.useRef({disabled:i,domRef:h,get textValue(){return p()}});Co(()=>{v.current.disabled=i},[v,i]),Co(()=>(l({type:5,id:r,dataRef:v}),()=>l({type:6,id:r})),[v,r]);let y=Ea(()=>{l({type:1})}),S=Ea(fe=>{if(i)return fe.preventDefault();l({type:1}),Ece(o.buttonElement)}),C=Ea(()=>{if(i)return l({type:2,focus:$l.Nothing});l({type:2,focus:$l.Specific,id:r})}),M=c5e(),E=Ea(fe=>{M.update(fe),!i&&(a||l({type:2,focus:$l.Specific,id:r,trigger:0}))}),L=Ea(fe=>{M.wasMoved(fe)&&(i||a||l({type:2,focus:$l.Specific,id:r,trigger:0}))}),k=Ea(fe=>{M.wasMoved(fe)&&(i||a&&l({type:2,focus:$l.Nothing}))}),[H,X]=Sce(),[Z,Q]=Cze(),re=Ae.useMemo(()=>({active:a,focus:a,disabled:i,close:y}),[a,i,y]),ie={id:r,ref:f,role:"menuitem",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-labelledby":H,"aria-describedby":Z,disabled:void 0,onClick:S,onFocus:C,onPointerEnter:E,onMouseEnter:E,onPointerMove:L,onMouseMove:L,onPointerLeave:k,onMouseLeave:k},oe=Gh();return Zl.createElement(X,null,Zl.createElement(Q,null,oe({ourProps:ie,theirProps:s,slot:re,defaultTag:u6e,name:"Menu.Item"})))}let f6e="div";function d6e(n,e){let[t,r]=Sce(),i=n,s={ref:e,"aria-labelledby":t,role:"group"},o=Gh();return Zl.createElement(r,null,o({ourProps:s,theirProps:i,slot:{},defaultTag:f6e,name:"Menu.Section"}))}let p6e="header";function m6e(n,e){let t=Ae.useId(),{id:r=`headlessui-menu-heading-${t}`,...i}=n,s=c8();Co(()=>s.register(r),[r,s.register]);let o={id:r,ref:e,role:"presentation",...s.props};return Gh()({ourProps:o,theirProps:i,slot:{},defaultTag:p6e,name:"Menu.Heading"})}let g6e="div";function v6e(n,e){let t=n,r={ref:e,role:"separator"};return Gh()({ourProps:r,theirProps:t,slot:{},defaultTag:g6e,name:"Menu.Separator"})}let _6e=Vh(i6e),b8=Vh(a6e),w8=Vh(c6e),Vf=Vh(h6e),y6e=Vh(d6e),x6e=Vh(m6e),b6e=Vh(v6e),Xce=Object.assign(_6e,{Button:b8,Items:w8,Item:Vf,Section:y6e,Heading:x6e,Separator:b6e});const w6e="/about_portfolio/assets/heart--ic8Oklh.png",S6e=()=>{let n=Ae.useRef(null),e,t,r,i=null;const s=()=>{for(let C=-15;C<16;C++)for(let M=-10;M<11;M++){let E=new _D({color:Math.random()*16777215}),L=new p6(E);L.position.set(C*2,M*2,0),e.add(L)}},o=()=>{const C=new Xr,M=new cu({size:3,vertexColors:!0,color:16777215});let E=[],L=[];for(let H=-15;H<16;H++)for(let X=-15;X<16;X++){E.push(H*4,X*4,0);let Z=new Vn(Math.random()*16777215);L.push(Z.r,Z.g,Z.b)}C.attributes.position=new or(E,3),C.attributes.color=new or(L,3);const k=new Eh(C,M);e.add(k)},l=()=>{const C=document.createElement("canvas");C.width=300,C.height=300;const M=C.getContext("2d");M.lineWidth=10,M.beginPath(),M.moveTo(200,150);var E=M.createLinearGradient(100,0,200,0);E.addColorStop("0","black"),E.addColorStop("0.3","magenta"),E.addColorStop("0.5","blue"),E.addColorStop("0.6","green"),E.addColorStop("0.8","yellow"),E.addColorStop("1","red"),M.strokeStyle=E,M.arc(150,150,50,0,2*Math.PI),M.stroke();const L=new G4(C);return L.needsUpdate=!0,L},a=(C,M,E,L,k)=>{const H=new Xr,X=new cu({size:C,transparent:M,opacity:E,sizeAttenuation:L,map:l(),color:k,depthTest:!0,depthWrite:!1});let Z=[],Q=200;for(let oe=0;oe<400;oe++){let fe=new Ze(Math.random()*Q-Q/2,Math.random()*Q-Q/2,Math.random()*Q-Q/2);Z.push(fe.x,fe.y,fe.z)}let re=new or(Z,3);H.attributes.position=re;const ie=new Eh(H,X);e.add(ie)},h=(C,M,E)=>{const L=new Xr,k=new cu({size:C,transparent:E,opacity:M,map:new Qf().load(w6e),sizeAttenuation:!0,depthTest:!0,depthWrite:!1});let H=[],X=200;for(let Q=0;Q<400;Q++){let re=new Ze(Math.random()*X-X/2,Math.random()*X-X/2,Math.random()*X-X/2);H.push(re.x,re.y,re.z)}L.attributes.position=new or(H,3);let Z=new Eh(L,k);e.add(Z)},f=()=>{const C=document.createElement("canvas");C.width=16,C.height=16;let M=C.getContext("2d"),E=M.createRadialGradient(C.width/2,C.height/2,0,C.width/2,C.height/2,C.width/2);E.addColorStop(0,"rgba(255,255,255,1)"),E.addColorStop(.2,"rgba(0,255,255,1)"),E.addColorStop(.4,"rgba(0,0,255,1)"),E.addColorStop(1,"rgba(0,255,0,1)"),M.fillStyle=E,M.fillRect(0,0,C.width,C.height);const L=new G4(C);return L.needsUpdate=!0,L},p=()=>{const C=new Nm(50,32,32),M=new cu({size:1,map:f(),transparent:!0,opacity:1,sizeAttenuation:!0,color:15539236,blending:rw,depthTest:!0,depthWrite:!1}),E=new Eh(C,M);e.add(E)},v=()=>{const C={width:window.innerWidth,height:window.innerHeight};e=new Ml,t=new ts(75,1,.1,1e3),e.add(t),r=new k0(t,n.current),r.enableDamping=!0,i=new Jl({canvas:n.current}),i.setSize(C.width,C.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.aspect=C.width/C.height,t.position.z=120,t.lookAt(new Ze(0,0,0))},y=()=>{i.render(e,t),r&&r.update(),requestAnimationFrame(y)},S=C=>{switch(e.clear(),C){case 0:s();break;case 1:{o();break}case 2:a(10,!0,.6,!0,16777215);break;case 3:h(10,.6,!0);break;case 4:p();break;default:s()}};return Ae.useEffect(()=>{v(),S(0),y()},[]),me.jsxs("div",{className:"absolute flex w-screen top-20 flex-col items-center",children:[me.jsx("header",{className:"flex w-full items-center justify-between border-b-2 border-b-black shadow-xl",children:me.jsx("div",{className:"mr-8 text-right",children:me.jsxs(Xce,{children:[me.jsx(b8,{className:"inline-flex items-center gap-2 rounded-md bg-gray-800 py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-700 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",children:"different ways to create particles"}),me.jsxs(w8,{transition:!0,anchor:"bottom end",className:"w-52 origin-top-right rounded-xl border border-gray-800 bg-gray-700 p-1 text-sm/6 text-white transition duration-100 ease-out [--anchor-gap:var(--spacing-1)] focus:outline-none",children:[me.jsx(Vf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(0),children:"createParticlesBySprite"})}),me.jsx(Vf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(1),children:"createParticlesByPoints"})}),me.jsx(Vf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(2),children:"createParticlesByCanvas"})}),me.jsx(Vf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(3),children:"createParticlesByTexture"})}),me.jsx(Vf,{children:me.jsx("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>S(4),children:"createParticlesByGeometry"})})]})]})})}),me.jsx("canvas",{ref:n})]})},A6e="/about_portfolio/assets/astronaut-FRdIWehG.glb",T6e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgSURBVHgB7cmxDQAACALBj/vvrIWUJCzAtQf1VtwNlR3vKwf7lmC9zQAAAABJRU5ErkJggg==",M6e=()=>{let n=Ae.useRef(null),e=null,t=null,r=null,i=null,s=null,o=0,l=[],a={width:0,height:0};const h=()=>{t=new Jl({canvas:n.current,antialias:!0}),t.setSize(a.width,a.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),e=new Ml,r=new ts(75,a.width/a.height,.1,100),r.position.z=150,r.lookAt(new Ze(0,0,0)),e.add(r),t.render(e,r),f(),p(),v()},f=()=>{new SB().load(A6e,Z=>{i=Z.scene,i.material=new oE,i.scale.set(4e-4,4e-4,4e-4),i.position.z=-10,e.add(i)})},p=()=>{const X=new Xr,Z=new cu({size:10,alphaTest:.8,color:16777215,map:new Qf().load(T6e)});let Q=[];for(let re=0;re<1e3;re++){l.push(H(20,300)*Math.cos(re),H(20,300)*Math.sin(re),H(-1500,10));let ie=new Vn(Math.random()*16777215);Q.push(ie.r,ie.g,ie.b)}X.attributes.position=new or(l,3),X.attributes.color=new or(Q,3),s=new Eh(X,Z),e.add(s)},v=()=>{e.fog=new tE(0,.005);let X=new a0(16777215,.8);X.position.set(50,50,75),e.add(X),X=new a0(16777215,.8),X.position.set(-50,-50,75),e.add(X),X=new a0(16777215,.5),X.position.set(25,50,200),e.add(X),X=new Tx(16777215,.8),e.add(X)},y=()=>{s.position.x=.2*Math.cos(o),s.position.y=.2*Math.cos(o),s.position.z+=.015,r.lookAt(s.position);for(let X=0;X<l.length;X++)if((X+1)%3===0){l[X]-r.position.z>=0&&(l[X]=H(-1e3,-500)),l[X]+=2.5;let Q=new or(l,3);s.geometry.attributes.position=Q}s.geometry.verticesNeedUpdate=!0},S=()=>{i&&(i.position.z=.08*Math.sin(o)+(r.position.z-.2),i.rotation.x+=.015,i.rotation.y+=.015,i.rotation.z+=.01)},C=()=>{let X=window.innerWidth,Z=window.innerHeight;(window.innerHeight!==Z||window.innerWidth!==X)&&(t.setSize(X,Z,!1),r.aspect=X/Z,r.updateProjectionMatrix())},M=()=>{y(),S(),C(),t.render(e,r),o+=.01,requestAnimationFrame(M)},E=()=>({onResize:()=>{a.width=window.innerWidth,a.height=window.innerHeight,t.setSize(a.width,a.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.aspect=a.width/a.height,r.updateProjectionMatrix()},onMouseMove:Q=>{let re=window.innerWidth/2,ie=window.innerHeight/2,oe=-1*((re-Q.clientX)/re),fe=-1*((ie-Q.clientY)/ie);r&&(r.position.x=oe*5),r&&(r.position.y=fe*5),i&&(i.position.x=oe*5),i&&(i.position.y=fe*5)}}),{onResize:L,onMouseMove:k}=E(),H=(X,Z)=>X+Math.random()*(Z-X);return Ae.useEffect(()=>(a.width=window.innerWidth,a.height=window.innerHeight,h(),M(),window.addEventListener("resize",L),window.addEventListener("mousemove",k),()=>{window.removeEventListener("resize",L),window.removeEventListener("mousemove",k)}),[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:n})})},E6e={name:"LuminosityHighPassShader",shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Vn(0)},defaultOpacity:{value:0}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform sampler2D tDiffuse;
		uniform vec3 defaultColor;
		uniform float defaultOpacity;
		uniform float luminosityThreshold;
		uniform float smoothWidth;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );

			vec3 luma = vec3( 0.299, 0.587, 0.114 );

			float v = dot( texel.xyz, luma );

			vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );

			float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );

			gl_FragColor = mix( outputColor, texel, alpha );

		}`};class A0 extends N0{constructor(e,t,r,i){super(),this.strength=t!==void 0?t:1,this.radius=r,this.threshold=i,this.resolution=e!==void 0?new nn(e.x,e.y):new nn(256,256),this.clearColor=new Vn(0,0,0),this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;let s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);this.renderTargetBright=new Sl(s,o,{type:Ih}),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(let p=0;p<this.nMips;p++){const v=new Sl(s,o,{type:Ih});v.texture.name="UnrealBloomPass.h"+p,v.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(v);const y=new Sl(s,o,{type:Ih});y.texture.name="UnrealBloomPass.v"+p,y.texture.generateMipmaps=!1,this.renderTargetsVertical.push(y),s=Math.round(s/2),o=Math.round(o/2)}const l=E6e;this.highPassUniforms=qm.clone(l.uniforms),this.highPassUniforms.luminosityThreshold.value=i,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new Ia({uniforms:this.highPassUniforms,vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}),this.separableBlurMaterials=[];const a=[3,5,7,9,11];s=Math.round(this.resolution.x/2),o=Math.round(this.resolution.y/2);for(let p=0;p<this.nMips;p++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(a[p])),this.separableBlurMaterials[p].uniforms.invSize.value=new nn(1/s,1/o),s=Math.round(s/2),o=Math.round(o/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=t,this.compositeMaterial.uniforms.bloomRadius.value=.1;const h=[1,.8,.6,.4,.2];this.compositeMaterial.uniforms.bloomFactors.value=h,this.bloomTintColors=[new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1),new Ze(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors;const f=fie;this.copyUniforms=qm.clone(f.uniforms),this.blendMaterial=new Ia({uniforms:this.copyUniforms,vertexShader:f.vertexShader,fragmentShader:f.fragmentShader,blending:rw,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this._oldClearColor=new Vn,this.oldClearAlpha=1,this.basic=new _a,this.fsQuad=new dE(null)}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose();for(let e=0;e<this.separableBlurMaterials.length;e++)this.separableBlurMaterials[e].dispose();this.compositeMaterial.dispose(),this.blendMaterial.dispose(),this.basic.dispose(),this.fsQuad.dispose()}setSize(e,t){let r=Math.round(e/2),i=Math.round(t/2);this.renderTargetBright.setSize(r,i);for(let s=0;s<this.nMips;s++)this.renderTargetsHorizontal[s].setSize(r,i),this.renderTargetsVertical[s].setSize(r,i),this.separableBlurMaterials[s].uniforms.invSize.value=new nn(1/r,1/i),r=Math.round(r/2),i=Math.round(i/2)}render(e,t,r,i,s){e.getClearColor(this._oldClearColor),this.oldClearAlpha=e.getClearAlpha();const o=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=r.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=r.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);let l=this.renderTargetBright;for(let a=0;a<this.nMips;a++)this.fsQuad.material=this.separableBlurMaterials[a],this.separableBlurMaterials[a].uniforms.colorTexture.value=l.texture,this.separableBlurMaterials[a].uniforms.direction.value=A0.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[a]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[a].uniforms.colorTexture.value=this.renderTargetsHorizontal[a].texture,this.separableBlurMaterials[a].uniforms.direction.value=A0.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[a]),e.clear(),this.fsQuad.render(e),l=this.renderTargetsVertical[a];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.blendMaterial,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,s&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(r),this.fsQuad.render(e)),e.setClearColor(this._oldClearColor,this.oldClearAlpha),e.autoClear=o}getSeperableBlurMaterial(e){const t=[];for(let r=0;r<e;r++)t.push(.39894*Math.exp(-.5*r*r/(e*e))/e);return new Ia({defines:{KERNEL_RADIUS:e},uniforms:{colorTexture:{value:null},invSize:{value:new nn(.5,.5)},direction:{value:new nn(.5,.5)},gaussianCoefficients:{value:t}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>
				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 invSize;
				uniform vec2 direction;
				uniform float gaussianCoefficients[KERNEL_RADIUS];

				void main() {
					float weightSum = gaussianCoefficients[0];
					vec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;
					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {
						float x = float(i);
						float w = gaussianCoefficients[i];
						vec2 uvOffset = direction * invSize * x;
						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset ).rgb;
						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset ).rgb;
						diffuseSum += (sample1 + sample2) * w;
						weightSum += 2.0 * w;
					}
					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})}getCompositeMaterial(e){return new Ia({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`varying vec2 vUv;
				uniform sampler2D blurTexture1;
				uniform sampler2D blurTexture2;
				uniform sampler2D blurTexture3;
				uniform sampler2D blurTexture4;
				uniform sampler2D blurTexture5;
				uniform float bloomStrength;
				uniform float bloomRadius;
				uniform float bloomFactors[NUM_MIPS];
				uniform vec3 bloomTintColors[NUM_MIPS];

				float lerpBloomFactor(const in float factor) {
					float mirrorFactor = 1.2 - factor;
					return mix(factor, mirrorFactor, bloomRadius);
				}

				void main() {
					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) +
						lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) +
						lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) +
						lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) +
						lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );
				}`})}}A0.BlurDirectionX=new nn(1,0);A0.BlurDirectionY=new nn(0,1);const nJ={name:"ConvolutionShader",defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new nn(.001953125,0)},cKernel:{value:[]}},vertexShader:`

		uniform vec2 uImageIncrement;

		varying vec2 vUv;

		void main() {

			vUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float cKernel[ KERNEL_SIZE_INT ];

		uniform sampler2D tDiffuse;
		uniform vec2 uImageIncrement;

		varying vec2 vUv;

		void main() {

			vec2 imageCoord = vUv;
			vec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );

			for( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {

				sum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];
				imageCoord += uImageIncrement;

			}

			gl_FragColor = sum;

		}`,buildKernel:function(n){let t=2*Math.ceil(n*3)+1;t>25&&(t=25);const r=(t-1)*.5,i=new Array(t);let s=0;for(let o=0;o<t;++o)i[o]=C6e(o-r,n),s+=i[o];for(let o=0;o<t;++o)i[o]/=s;return i}};function C6e(n,e){return Math.exp(-(n*n)/(2*e*e))}class Xy extends N0{constructor(e=1,t=25,r=4){super(),this.renderTargetX=new Sl(1,1,{type:Ih}),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new Sl(1,1,{type:Ih}),this.renderTargetY.texture.name="BloomPass.y",this.combineUniforms=qm.clone(RI.uniforms),this.combineUniforms.strength.value=e,this.materialCombine=new Ia({name:RI.name,uniforms:this.combineUniforms,vertexShader:RI.vertexShader,fragmentShader:RI.fragmentShader,blending:rw,transparent:!0});const i=nJ;this.convolutionUniforms=qm.clone(i.uniforms),this.convolutionUniforms.uImageIncrement.value=Xy.blurX,this.convolutionUniforms.cKernel.value=nJ.buildKernel(r),this.materialConvolution=new Ia({name:i.name,uniforms:this.convolutionUniforms,vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,defines:{KERNEL_SIZE_FLOAT:t.toFixed(1),KERNEL_SIZE_INT:t.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new dE(null)}render(e,t,r,i,s){s&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=r.texture,this.convolutionUniforms.uImageIncrement.value=Xy.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Xy.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCombine,this.combineUniforms.tDiffuse.value=this.renderTargetY.texture,s&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(r),this.clear&&e.clear(),this.fsQuad.render(e)}setSize(e,t){this.renderTargetX.setSize(e,t),this.renderTargetY.setSize(e,t)}dispose(){this.renderTargetX.dispose(),this.renderTargetY.dispose(),this.materialCombine.dispose(),this.materialConvolution.dispose(),this.fsQuad.dispose()}}const RI={name:"CombineShader",uniforms:{tDiffuse:{value:null},strength:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float strength;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 texel = texture2D( tDiffuse, vUv );
			gl_FragColor = strength * texel;

		}`};Xy.blurX=new nn(.001953125,0);Xy.blurY=new nn(0,.001953125);const I6e={name:"FilmShader",uniforms:{tDiffuse:{value:null},time:{value:0},intensity:{value:.5},grayscale:{value:!1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		#include <common>

		uniform float intensity;
		uniform bool grayscale;
		uniform float time;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			vec4 base = texture2D( tDiffuse, vUv );

			float noise = rand( fract( vUv + time ) );

			vec3 color = base.rgb + base.rgb * clamp( 0.1 + noise, 0.0, 1.0 );

			color = mix( base.rgb, color, intensity );

			if ( grayscale ) {

				color = vec3( luminance( color ) ); // assuming linear-srgb

			}

			gl_FragColor = vec4( color, base.a );

		}`};class R6e extends N0{constructor(e=.5,t=!1){super();const r=I6e;this.uniforms=qm.clone(r.uniforms),this.material=new Ia({name:r.name,uniforms:this.uniforms,vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}),this.uniforms.intensity.value=e,this.uniforms.grayscale.value=t,this.fsQuad=new dE(this.material)}render(e,t,r,i){this.uniforms.tDiffuse.value=r.texture,this.uniforms.time.value+=i,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}const P6e=()=>{const n=Ae.useRef(null);let e,t,r,i,s=null,o={width:0,height:0},l;const a=()=>{o.width=window.innerWidth,o.height=window.innerHeight,e=new Ml,t=new ts(75,o.width/o.height,.1,100),t.position.set(1,-1,1),e.add(t),s=new Jl({canvas:n.current,antialias:!0}),s.setSize(o.width,o.height),s.setPixelRatio(Math.min(window.devicePixelRatio,2)),s.autoClear=!1,l=new k0(t,s.domElement),l.enableDamping=!0;const f=new bp(1,1,1),p=new _a({color:65280});i=new Ri(f,p),e.add(i);const v=new zD(e,t);new A0(new nn(o.width,o.height),1.5,.4,.85);const y=new Xy(1.5,25,4,256),S=new R6e(.35,.25,648,!1);r=new ND(s),r.renderToScreen=!0,r.addPass(v),r.addPass(y),r.addPass(S)},h=()=>{l&&l.update(),i&&(i.rotation.y+=.002),i&&(i.rotation.x+=.002),r&&r.render(),r.setSize(o.width,o.height),s.render(e,t),window.requestAnimationFrame(h)};return Ae.useEffect(()=>{a(),h()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:n})})},L6e="/about_portfolio/assets/rickAndMorty-Do2rctLy.glb";var D6e=`#define MUN_OCTAVES 5\r
#define M_PI 3.1415926535897932384626433832795\r
precision mediump float;

varying vec3 vNormal;\r
varying vec3 vCamPos;\r
varying vec2 vUv;

uniform vec4 resolution;\r
uniform sampler2D perlinNoise;\r
uniform sampler2D sparkNoise;\r
uniform sampler2D waterTurbulence;\r
uniform sampler2D noiseText;\r
uniform float time;\r
uniform vec3 color0;\r
uniform vec3 color1;\r
uniform vec3 color2;\r
uniform vec3 color3;\r
uniform vec3 color4;\r
uniform vec3 color5;

float Rand(vec2 n) {\r
  return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\r
}

float Noise(vec2 p) {\r
  vec2 ip = floor(p);\r
  vec2 u = fract(p);\r
  u = u * u * (3.0 - 2.0 * u);

  float res =\r
      mix(mix(Rand(ip), Rand(ip + vec2(1.0, 0.0)), u.x),\r
          mix(Rand(ip + vec2(0.0, 1.0)), Rand(ip + vec2(1.0, 1.0)), u.x), u.y);\r
  return res * res;\r
}

float Fbm(vec2 p) {\r
  float v = 0.0;\r
  float a = 0.5;\r
  vec2 shift = vec2(100);\r
  
  mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));\r
  for (int i = 0; i < MUN_OCTAVES; ++i) {\r
    v += a * Noise(p);\r
    p = rot * p * 2.0 + shift;\r
    a *= 0.5;\r
  }\r
  return v;\r
}

float SetOpacity(float r, float g, float b, float toneThreshold) {\r
  float tone = (r + g + b) / 3.0;\r
  if (tone < toneThreshold) {\r
    return 0.0;\r
  }\r
  return 1.0;\r
}

vec3 Rgbcol(vec3 col) {\r
  return vec3(col.r / 255.0, col.g / 255.0, col.b / 255.0);\r
}

vec2 Rotate(vec2 v, float a) {\r
  float s = sin(a);\r
  float c = cos(a);\r
  mat2 m = mat2(c, -s, s, c);\r
  return m * v;\r
}

vec2 UnityPolarCoordinates(vec2 uv, vec2 center, float radialScale,\r
                           float lengthScale) {\r
  vec2 delta = uv - center;\r
  float radius = length(delta) * radialScale * 2.0;\r
  float angle = atan(delta.x, delta.y) * 1.0 / 6.28 * lengthScale;\r
  return vec2(radius, angle);\r
}

void main() {\r
  
  vec2 oldUv = gl_FragCoord.xy / resolution.xy;\r
  vec2 uv = vUv;\r
  vec2 imgUv = uv;\r
  float scale = 1.0;\r
  oldUv *= 0.5 + time;\r
  oldUv.y = oldUv.y;\r
  vec2 p = oldUv * scale; 

  
  float noise = Fbm(p) * 0.04;\r
  vec4 txt = texture2D(perlinNoise, oldUv);\r
  float gradient = dot(normalize(-vCamPos), normalize(vNormal));\r
  float pct = distance(vUv, vec2(0.5));\r
  
  vec3 rgbColor0 = Rgbcol(color0);\r
  vec3 rgbColor1 = Rgbcol(color1);\r
  vec3 rgbColor2 = Rgbcol(color2);\r
  vec3 rgbColor3 = Rgbcol(color3);\r
  vec3 rgbColor4 = Rgbcol(color4);\r
  vec3 rgbColor5 = Rgbcol(color5);

  
  float y = smoothstep(0.16, 0.525, pct);\r
  vec3 backColor = mix(rgbColor0, rgbColor5, y);\r
  gl_FragColor = vec4(backColor, 1.0);

  
  vec2 center = vec2(0.5);\r
  vec2 cor = UnityPolarCoordinates(vUv, center, 1.0, 1.0);\r
  vec2 newvUv = vUv - 0.5;\r
  vec3 noiseTextvUv =\r
      texture2D(perlinNoise, mod(Rotate(newvUv * 0.15 + vec2(sin(time * 0.005),\r
                                                             cos(time * 0.005)),\r
                                        time),\r
                                 1.0))\r
          .rgb; 

  
  vec2 newUv = vec2(cor.x + time, cor.x + cor.y);\r
  vec3 noiseText1 = texture2D(perlinNoise, mod(newUv, 1.0))\r
                        .rgb; 
  vec3 noiseText2 = texture2D(sparkNoise, mod(newUv, 1.)).rgb;\r
  vec3 noiseText3 = texture2D(waterTurbulence, mod(newUv, 1.))\r
                        .rgb; 

  
  float tone0 = 1. - smoothstep(0.3, 0.6, noiseText1.r);\r
  float tone1 = smoothstep(0.3, 0.6, noiseText2.r);\r
  float tone2 = smoothstep(0.3, 0.6, noiseText3.r);

  
  float opacity0 = SetOpacity(tone0, tone0, tone0, .29);\r
  float opacity1 = SetOpacity(tone1, tone1, tone1, .49);\r
  float opacity2 = SetOpacity(tone2, tone2, tone2, .69);

  
  float gradientTone = 1. - smoothstep(0.196, 0.532, pct);\r
  vec4 circularNoise = vec4(vec3(gradientTone) * noiseTextvUv * 1.4, 1.0);\r
  float gradOpacity =\r
      SetOpacity(circularNoise.r, circularNoise.g, circularNoise.b, 0.19);

  
  vec2 uv2 = uv;\r
  float iTime = time * 0.004;\r
  uv.y += iTime / 10.0;\r
  uv.x -= (sin(iTime / 10.0) / 2.0);\r
  uv2.x += iTime / 14.0;\r
  uv2.x += (sin(iTime / 10.0) / 9.0);\r
  float result = 0.0;\r
  result +=\r
      texture2D(noiseText, mod(uv * 0.5, 1.) * 0.6 + vec2(iTime * (-0.003)))\r
          .r; 
              
  result *=\r
      texture2D(noiseText, mod(uv2 * 0.5, 1.) * 0.9 + vec2(iTime * 0.002)).b;\r
  result = pow(result, 4.0);

  
  if (opacity2 > 0.0) {\r
    gl_FragColor = vec4(rgbColor4, 0.) * vec4(opacity2);\r
  } else if (opacity1 > 0.0) {\r
    gl_FragColor = vec4(rgbColor2, 0.) * vec4(opacity1);\r
  } else if (opacity0 > 0.0) {\r
    gl_FragColor = vec4(rgbColor1, 0.) * vec4(opacity0);\r
  }\r
  gl_FragColor += vec4(108.0) * result * (y * 0.02);\r
  gl_FragColor *= vec4(gradOpacity);\r
}`,B6e=`varying vec2 vUv;\r
varying vec3 vNormal;\r
varying vec3 vCamPos;

void main() {\r
  vUv = uv;\r
  vNormal = normal;\r
  vCamPos = cameraPosition;\r
  gl_Position =\r
      projectionMatrix * modelViewMatrix *\r
      vec4(position,\r
           1.0); 
}`;const k6e="/about_portfolio/assets/noise-CSy_EG5b.png",O6e="/about_portfolio/assets/waterturbulence-D5gcttvO.png",F6e=()=>{const n=Ae.useRef(null);let e,t,r,i=null,s={width:0,height:0},o,l,a=null,h=null;const f=()=>{s.width=window.innerWidth,s.height=window.innerHeight,e=new Ml,t=new ts(75,s.width/s.height,.1,100),t.position.set(0,1,5),e.add(t),r=new Jl({canvas:n.current,antialias:!0,alpha:!0}),r.setSize(s.width,s.height),r.setPixelRatio(Math.min(window.devicePixelRatio,2)),r.autoClear=!1,r.setClearAlpha(0),r.physicallyCorrectLights=!0,r.toneMapping=aD,r.toneMappingExposure=2,r.render(e,t);const M=new B0(16777215,1);M.castShadow=!0,M.shadow.camera.far=15,M.shadow.mapSize.set(1024,1024),M.shadow.normalBias=.05,M.position.set(.25,3,-1.25),e.add(M);const E=new Tx(16777215,1.2);e.add(E),i=new k0(t,r.domElement),i.enableDamping=!0,i.enablePan=!1,i.minPolarAngle=.5,i.maxPolarAngle=2.5,i.minAzimuthAngle=-1,i.maxAzimuthAngle=1},p={exposure:2.8,bloomStrength:2.39,bloomThreshold:0,bloomRadius:.38,color0:[1,5,1],color1:[2,20,2],color2:[44,97,15],color3:[14,28,5],color4:[255,255,255],color5:[74,145,0]},v=()=>{const M=new zD(e,t),E=new A0(new nn(s.width,s.height),1.5,.4,.85);E.threshold=p.bloomThreshold,E.strength=p.bloomStrength,E.radius=p.bloomRadius,h=new ND(r),h.renderToScreen=!0,h.addPass(M),h.addPass(E)},y=()=>{const M=new ig(8,8,1,1),E=new Qf;l=new Ia({uniforms:{time:{type:"f",value:0},perlinNoise:{type:"t",value:E.load(ace)},sparkNoise:{type:"t",value:E.load(oce)},waterTurbulence:{type:"t",value:E.load(O6e)},noiseText:{type:"t",value:E.load(k6e)},color0:{value:new Ze(...p.color0)},color1:{value:new Ze(...p.color1)},color2:{value:new Ze(...p.color2)},color3:{value:new Ze(...p.color3)},color4:{value:new Ze(...p.color4)},color5:{value:new Ze(...p.color5)},resolution:{value:new nn(s.width,s.height)}},vertexShader:B6e,fragmentShader:D6e}),o=new Ri(M,l),o.layers.enable(1),e.add(o),v();const L=new lE;L.onLoad=()=>{};const k="/about_portfolio/",H=new a8;H.setDecoderPath(`${k}/draco/`),H.setDecoderConfig({type:"js"});const X=new SB(L);X.setDRACOLoader(H),X.load(L6e,Z=>{Z.scene&&(a=Z.scene,a.scale.set(.02,.02,.02),a.position.x=-.5,a.rotation.y=Math.PI,a.layers.set(0),e.add(a))})},S=()=>{const M=new rMe,E=M.addFolder("bloom");E.add(p,"bloomStrength",0,10).name("bloomStrength").listen(),E.add(p,"bloomRadius",.1,10).name("bloomRadius").listen(),E.open();const L=M.addFolder("Colors");L.addColor(p,"color0").name("layer0"),L.addColor(p,"color1").name("layer1"),L.addColor(p,"color2").name("layer2"),L.addColor(p,"color3").name("layer3"),L.addColor(p,"color4").name("layer4"),L.addColor(p,"color5").name("layer5"),L.open()},C=M=>{const E=new sg;l.uniforms.time.value=M/5e3,l.uniforms.color5.value=new Ze(...p.color5),l.uniforms.color4.value=new Ze(...p.color4),l.uniforms.color3.value=new Ze(...p.color3),l.uniforms.color2.value=new Ze(...p.color2),l.uniforms.color1.value=new Ze(...p.color1),l.uniforms.color0.value=new Ze(...p.color0),r.clear(),t.layers.set(1),h.render(),r.clearDepth(),t.layers.set(0),r.render(e,t);const k=E.getElapsedTime()*.5;a&&(a.rotation.x=Math.cos(k)*.2,a.rotation.z=Math.sin(k)*.1,a.position.z+=Math.cos(k)*.005);const H=Math.cos(k)*2+3;o&&o.scale.set(H,H,H),i.update(),window.requestAnimationFrame(C)};return Ae.useEffect(()=>{f(),y(),S(),C()},[]),me.jsx("div",{className:"w-screen h-screen bg-black",children:me.jsx("canvas",{ref:n})})};var N6e=`varying vec2 vUv;

void main() {\r
  gl_Position =\r
      projectionMatrix * modelViewMatrix *\r
      vec4(position,\r
           1.0); 
  vUv = uv;\r
}`,z6e=`precision mediump float;\r
#define PI 3.1415926535897932384626433832795

varying vec2 vUv;

float random(vec2 st) {\r
  return fract(sin(dot(st.xy, vec2(12.9898, 78.233))) * 43758.5453123);\r
}

vec2 rotate(vec2 uv, float rotation, vec2 mid) {\r
  return vec2(\r
      cos(rotation) * (uv.x - mid.x) - sin(rotation) * (uv.y - mid.y) + mid.x,\r
      sin(rotation) * (uv.x - mid.x) + cos(rotation) * (uv.y - mid.y) + mid.y);\r
}\r

vec2 fade(vec2 t) { return t * t * t * (t * (t * 6.0 - 15.0) + 10.0); }

vec4 permute(vec4 x) { return mod(((x * 34.0) + 1.0) * x, 289.0); }

float cnoise(vec2 P) {\r
  vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\r
  vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\r
  Pi = mod(Pi, 289.0); 
  vec4 ix = Pi.xzxz;\r
  vec4 iy = Pi.yyww;\r
  vec4 fx = Pf.xzxz;\r
  vec4 fy = Pf.yyww;\r
  vec4 i = permute(permute(ix) + iy);\r
  vec4 gx = 2.0 * fract(i * 0.0243902439) - 1.0; 
  vec4 gy = abs(gx) - 0.5;\r
  vec4 tx = floor(gx + 0.5);\r
  gx = gx - tx;\r
  vec2 g00 = vec2(gx.x, gy.x);\r
  vec2 g10 = vec2(gx.y, gy.y);\r
  vec2 g01 = vec2(gx.z, gy.z);\r
  vec2 g11 = vec2(gx.w, gy.w);\r
  vec4 norm =\r
      1.79284291400159 - 0.85373472095314 * vec4(dot(g00, g00), dot(g01, g01),\r
                                                 dot(g10, g10), dot(g11, g11));\r
  g00 *= norm.x;\r
  g01 *= norm.y;\r
  g10 *= norm.z;\r
  g11 *= norm.w;\r
  float n00 = dot(g00, vec2(fx.x, fy.x));\r
  float n10 = dot(g10, vec2(fx.y, fy.y));\r
  float n01 = dot(g01, vec2(fx.z, fy.z));\r
  float n11 = dot(g11, vec2(fx.w, fy.w));\r
  vec2 fade_xy = fade(Pf.xy);\r
  vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\r
  float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\r
  return 2.3 * n_xy;\r
}

void main() {\r
  
  
  
  
  
  
  
  

  
  
  
  
  

  vec2 rotateUv = rotate(vUv, PI / 4.0, vec2(0.5));\r
  
  
  
  
  
  
  
  
  
  

  
  
  
  
  

  

  
  
  
  
  
  
  
  
  

  
  

  
  

  
  
  
  

  
  
  

  float strength = step(0.9, sin(cnoise(vUv * 10.0) * 20.0));

  vec3 blackColor = vec3(0.0);\r
  vec3 uvColor = vec3(vUv, 0.2);\r
  vec3 mixColor = mix(blackColor, uvColor, strength);\r
  gl_FragColor = vec4(mixColor, 1.0);\r
}`;const U6e=()=>{let n,e,t=null,r={width:0,height:0},i=Ae.useRef(null),s,o,l=null;const a=()=>{r.width=window.innerWidth,r.height=window.innerHeight,n=new Ml,e=new ts(75,r.width/r.height,.1,100),e.position.set(1,-1,1),n.add(e),t=new Jl({canvas:i.current}),t.setSize(r.width,r.height),t.setPixelRatio(Math.min(window.devicePixelRatio,2)),t.autoClear=!1,o=new k0(e,t.domElement),o.enableDamping=!0;const f=new sx(1,64),p=new Ia({vertexShader:N6e,fragmentShader:z6e,side:Ac});s=new Ri(f,p),n.add(s);const v=new zD(n,e),y=new A0(new nn(r.width,r.height),2.2,.2,0);l=new ND(t),l.renderToScreen=!0,l.addPass(v),l.addPass(y)},h=()=>{o&&o.update(),s&&(s.rotation.y+=.002),s&&(s.rotation.x+=.002),l&&l.render(),o.update(),t.render(n,e),requestAnimationFrame(h)};return Ae.useEffect(()=>{a(),h()},[]),me.jsx("div",{className:"w-screen h-screen",children:me.jsx("canvas",{ref:i})})};var qce={exports:{}};(function(n,e){var t={};(function(r,i){n.exports=i()})(jde,function(){var r,i,s;function o(a,h){if(!r)r=h;else if(!i)i=h;else{var f="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+r+")(sharedChunk); ("+i+")(sharedChunk); self.onerror = null;",p={};r(p),s=h(p),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(s.workerUrl=window.URL.createObjectURL(new Blob([f],{type:"text/javascript"})))}}o(["exports"],function(a){function h(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var f,p={},v={};function y(){if(f)return v;f=1,Object.defineProperty(v,"__esModule",{value:!0}),v.setMatrixArrayType=function(A){v.ARRAY_TYPE=c=A},v.toRadian=function(A){return A*_},v.equals=function(A,x){return Math.abs(A-x)<=g*Math.max(1,Math.abs(A),Math.abs(x))},v.RANDOM=v.ARRAY_TYPE=v.EPSILON=void 0;var g=1e-6;v.EPSILON=g;var c=typeof Float32Array<"u"?Float32Array:Array;v.ARRAY_TYPE=c;var d=Math.random;v.RANDOM=d;var _=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var A=0,x=arguments.length;x--;)A+=arguments[x]*arguments[x];return Math.sqrt(A)}),v}var S,C={};function M(){if(S)return C;function g(x){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(x)}S=1,Object.defineProperty(C,"__esModule",{value:!0}),C.create=function(){var x=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x},C.clone=function(x){var T=new c.ARRAY_TYPE(4);return T[0]=x[0],T[1]=x[1],T[2]=x[2],T[3]=x[3],T},C.copy=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[3],x},C.identity=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=1,x},C.fromValues=function(x,T,B,U){var j=new c.ARRAY_TYPE(4);return j[0]=x,j[1]=T,j[2]=B,j[3]=U,j},C.set=function(x,T,B,U,j){return x[0]=T,x[1]=B,x[2]=U,x[3]=j,x},C.transpose=function(x,T){if(x===T){var B=T[1];x[1]=T[2],x[2]=B}else x[0]=T[0],x[1]=T[2],x[2]=T[1],x[3]=T[3];return x},C.invert=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=B*R-j*U;return N?(x[0]=R*(N=1/N),x[1]=-U*N,x[2]=-j*N,x[3]=B*N,x):null},C.adjoint=function(x,T){var B=T[0];return x[0]=T[3],x[1]=-T[1],x[2]=-T[2],x[3]=B,x},C.determinant=function(x){return x[0]*x[3]-x[2]*x[1]},C.multiply=_,C.rotate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=Math.sin(B),z=Math.cos(B);return x[0]=U*z+R*V,x[1]=j*z+N*V,x[2]=U*-V+R*z,x[3]=j*-V+N*z,x},C.scale=function(x,T,B){var U=T[1],j=T[2],R=T[3],N=B[0],V=B[1];return x[0]=T[0]*N,x[1]=U*N,x[2]=j*V,x[3]=R*V,x},C.fromRotation=function(x,T){var B=Math.sin(T),U=Math.cos(T);return x[0]=U,x[1]=B,x[2]=-B,x[3]=U,x},C.fromScaling=function(x,T){return x[0]=T[0],x[1]=0,x[2]=0,x[3]=T[1],x},C.str=function(x){return"mat2("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+")"},C.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3])},C.LDU=function(x,T,B,U){return x[2]=U[2]/U[0],B[0]=U[0],B[1]=U[1],B[3]=U[3]-x[2]*B[1],[x,T,B]},C.add=function(x,T,B){return x[0]=T[0]+B[0],x[1]=T[1]+B[1],x[2]=T[2]+B[2],x[3]=T[3]+B[3],x},C.subtract=A,C.exactEquals=function(x,T){return x[0]===T[0]&&x[1]===T[1]&&x[2]===T[2]&&x[3]===T[3]},C.equals=function(x,T){var B=x[0],U=x[1],j=x[2],R=x[3],N=T[0],V=T[1],z=T[2],G=T[3];return Math.abs(B-N)<=c.EPSILON*Math.max(1,Math.abs(B),Math.abs(N))&&Math.abs(U-V)<=c.EPSILON*Math.max(1,Math.abs(U),Math.abs(V))&&Math.abs(j-z)<=c.EPSILON*Math.max(1,Math.abs(j),Math.abs(z))&&Math.abs(R-G)<=c.EPSILON*Math.max(1,Math.abs(R),Math.abs(G))},C.multiplyScalar=function(x,T,B){return x[0]=T[0]*B,x[1]=T[1]*B,x[2]=T[2]*B,x[3]=T[3]*B,x},C.multiplyScalarAndAdd=function(x,T,B,U){return x[0]=T[0]+B[0]*U,x[1]=T[1]+B[1]*U,x[2]=T[2]+B[2]*U,x[3]=T[3]+B[3]*U,x},C.sub=C.mul=void 0;var c=function(x,T){if(x&&x.__esModule)return x;if(x===null||g(x)!=="object"&&typeof x!="function")return{default:x};var B=d(void 0);if(B&&B.has(x))return B.get(x);var U={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in x)if(R!=="default"&&Object.prototype.hasOwnProperty.call(x,R)){var N=j?Object.getOwnPropertyDescriptor(x,R):null;N&&(N.get||N.set)?Object.defineProperty(U,R,N):U[R]=x[R]}return U.default=x,B&&B.set(x,U),U}(y());function d(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,B=new WeakMap;return(d=function(U){return U?B:T})(x)}function _(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=B[0],z=B[1],G=B[2],$=B[3];return x[0]=U*V+R*z,x[1]=j*V+N*z,x[2]=U*G+R*$,x[3]=j*G+N*$,x}function A(x,T,B){return x[0]=T[0]-B[0],x[1]=T[1]-B[1],x[2]=T[2]-B[2],x[3]=T[3]-B[3],x}return C.mul=_,C.sub=A,C}var E,L={};function k(){if(E)return L;function g(x){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(x)}E=1,Object.defineProperty(L,"__esModule",{value:!0}),L.create=function(){var x=new c.ARRAY_TYPE(6);return c.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[4]=0,x[5]=0),x[0]=1,x[3]=1,x},L.clone=function(x){var T=new c.ARRAY_TYPE(6);return T[0]=x[0],T[1]=x[1],T[2]=x[2],T[3]=x[3],T[4]=x[4],T[5]=x[5],T},L.copy=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[3],x[4]=T[4],x[5]=T[5],x},L.identity=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=1,x[4]=0,x[5]=0,x},L.fromValues=function(x,T,B,U,j,R){var N=new c.ARRAY_TYPE(6);return N[0]=x,N[1]=T,N[2]=B,N[3]=U,N[4]=j,N[5]=R,N},L.set=function(x,T,B,U,j,R,N){return x[0]=T,x[1]=B,x[2]=U,x[3]=j,x[4]=R,x[5]=N,x},L.invert=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=B*R-U*j;return z?(x[0]=R*(z=1/z),x[1]=-U*z,x[2]=-j*z,x[3]=B*z,x[4]=(j*V-R*N)*z,x[5]=(U*N-B*V)*z,x):null},L.determinant=function(x){return x[0]*x[3]-x[1]*x[2]},L.multiply=_,L.rotate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=Math.sin(B),$=Math.cos(B);return x[0]=U*$+R*G,x[1]=j*$+N*G,x[2]=U*-G+R*$,x[3]=j*-G+N*$,x[4]=V,x[5]=z,x},L.scale=function(x,T,B){var U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=B[0],G=B[1];return x[0]=T[0]*z,x[1]=U*z,x[2]=j*G,x[3]=R*G,x[4]=N,x[5]=V,x},L.translate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=B[0],$=B[1];return x[0]=U,x[1]=j,x[2]=R,x[3]=N,x[4]=U*G+R*$+V,x[5]=j*G+N*$+z,x},L.fromRotation=function(x,T){var B=Math.sin(T),U=Math.cos(T);return x[0]=U,x[1]=B,x[2]=-B,x[3]=U,x[4]=0,x[5]=0,x},L.fromScaling=function(x,T){return x[0]=T[0],x[1]=0,x[2]=0,x[3]=T[1],x[4]=0,x[5]=0,x},L.fromTranslation=function(x,T){return x[0]=1,x[1]=0,x[2]=0,x[3]=1,x[4]=T[0],x[5]=T[1],x},L.str=function(x){return"mat2d("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+")"},L.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],1)},L.add=function(x,T,B){return x[0]=T[0]+B[0],x[1]=T[1]+B[1],x[2]=T[2]+B[2],x[3]=T[3]+B[3],x[4]=T[4]+B[4],x[5]=T[5]+B[5],x},L.subtract=A,L.multiplyScalar=function(x,T,B){return x[0]=T[0]*B,x[1]=T[1]*B,x[2]=T[2]*B,x[3]=T[3]*B,x[4]=T[4]*B,x[5]=T[5]*B,x},L.multiplyScalarAndAdd=function(x,T,B,U){return x[0]=T[0]+B[0]*U,x[1]=T[1]+B[1]*U,x[2]=T[2]+B[2]*U,x[3]=T[3]+B[3]*U,x[4]=T[4]+B[4]*U,x[5]=T[5]+B[5]*U,x},L.exactEquals=function(x,T){return x[0]===T[0]&&x[1]===T[1]&&x[2]===T[2]&&x[3]===T[3]&&x[4]===T[4]&&x[5]===T[5]},L.equals=function(x,T){var B=x[0],U=x[1],j=x[2],R=x[3],N=x[4],V=x[5],z=T[0],G=T[1],$=T[2],K=T[3],te=T[4],ce=T[5];return Math.abs(B-z)<=c.EPSILON*Math.max(1,Math.abs(B),Math.abs(z))&&Math.abs(U-G)<=c.EPSILON*Math.max(1,Math.abs(U),Math.abs(G))&&Math.abs(j-$)<=c.EPSILON*Math.max(1,Math.abs(j),Math.abs($))&&Math.abs(R-K)<=c.EPSILON*Math.max(1,Math.abs(R),Math.abs(K))&&Math.abs(N-te)<=c.EPSILON*Math.max(1,Math.abs(N),Math.abs(te))&&Math.abs(V-ce)<=c.EPSILON*Math.max(1,Math.abs(V),Math.abs(ce))},L.sub=L.mul=void 0;var c=function(x,T){if(x&&x.__esModule)return x;if(x===null||g(x)!=="object"&&typeof x!="function")return{default:x};var B=d(void 0);if(B&&B.has(x))return B.get(x);var U={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in x)if(R!=="default"&&Object.prototype.hasOwnProperty.call(x,R)){var N=j?Object.getOwnPropertyDescriptor(x,R):null;N&&(N.get||N.set)?Object.defineProperty(U,R,N):U[R]=x[R]}return U.default=x,B&&B.set(x,U),U}(y());function d(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,B=new WeakMap;return(d=function(U){return U?B:T})(x)}function _(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=B[0],$=B[1],K=B[2],te=B[3],ce=B[4],he=B[5];return x[0]=U*G+R*$,x[1]=j*G+N*$,x[2]=U*K+R*te,x[3]=j*K+N*te,x[4]=U*ce+R*he+V,x[5]=j*ce+N*he+z,x}function A(x,T,B){return x[0]=T[0]-B[0],x[1]=T[1]-B[1],x[2]=T[2]-B[2],x[3]=T[3]-B[3],x[4]=T[4]-B[4],x[5]=T[5]-B[5],x}return L.mul=_,L.sub=A,L}var H,X={};function Z(){if(H)return X;function g(x){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(T){return typeof T}:function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(x)}H=1,Object.defineProperty(X,"__esModule",{value:!0}),X.create=function(){var x=new c.ARRAY_TYPE(9);return c.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0,x[3]=0,x[5]=0,x[6]=0,x[7]=0),x[0]=1,x[4]=1,x[8]=1,x},X.fromMat4=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[4],x[4]=T[5],x[5]=T[6],x[6]=T[8],x[7]=T[9],x[8]=T[10],x},X.clone=function(x){var T=new c.ARRAY_TYPE(9);return T[0]=x[0],T[1]=x[1],T[2]=x[2],T[3]=x[3],T[4]=x[4],T[5]=x[5],T[6]=x[6],T[7]=x[7],T[8]=x[8],T},X.copy=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=T[2],x[3]=T[3],x[4]=T[4],x[5]=T[5],x[6]=T[6],x[7]=T[7],x[8]=T[8],x},X.fromValues=function(x,T,B,U,j,R,N,V,z){var G=new c.ARRAY_TYPE(9);return G[0]=x,G[1]=T,G[2]=B,G[3]=U,G[4]=j,G[5]=R,G[6]=N,G[7]=V,G[8]=z,G},X.set=function(x,T,B,U,j,R,N,V,z,G){return x[0]=T,x[1]=B,x[2]=U,x[3]=j,x[4]=R,x[5]=N,x[6]=V,x[7]=z,x[8]=G,x},X.identity=function(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=1,x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},X.transpose=function(x,T){if(x===T){var B=T[1],U=T[2],j=T[5];x[1]=T[3],x[2]=T[6],x[3]=B,x[5]=T[7],x[6]=U,x[7]=j}else x[0]=T[0],x[1]=T[3],x[2]=T[6],x[3]=T[1],x[4]=T[4],x[5]=T[7],x[6]=T[2],x[7]=T[5],x[8]=T[8];return x},X.invert=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=T[6],G=T[7],$=T[8],K=$*N-V*G,te=-$*R+V*z,ce=G*R-N*z,he=B*K+U*te+j*ce;return he?(x[0]=K*(he=1/he),x[1]=(-$*U+j*G)*he,x[2]=(V*U-j*N)*he,x[3]=te*he,x[4]=($*B-j*z)*he,x[5]=(-V*B+j*R)*he,x[6]=ce*he,x[7]=(-G*B+U*z)*he,x[8]=(N*B-U*R)*he,x):null},X.adjoint=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=T[6],G=T[7],$=T[8];return x[0]=N*$-V*G,x[1]=j*G-U*$,x[2]=U*V-j*N,x[3]=V*z-R*$,x[4]=B*$-j*z,x[5]=j*R-B*V,x[6]=R*G-N*z,x[7]=U*z-B*G,x[8]=B*N-U*R,x},X.determinant=function(x){var T=x[3],B=x[4],U=x[5],j=x[6],R=x[7],N=x[8];return x[0]*(N*B-U*R)+x[1]*(-N*T+U*j)+x[2]*(R*T-B*j)},X.multiply=_,X.translate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=T[6],$=T[7],K=T[8],te=B[0],ce=B[1];return x[0]=U,x[1]=j,x[2]=R,x[3]=N,x[4]=V,x[5]=z,x[6]=te*U+ce*N+G,x[7]=te*j+ce*V+$,x[8]=te*R+ce*z+K,x},X.rotate=function(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=T[6],$=T[7],K=T[8],te=Math.sin(B),ce=Math.cos(B);return x[0]=ce*U+te*N,x[1]=ce*j+te*V,x[2]=ce*R+te*z,x[3]=ce*N-te*U,x[4]=ce*V-te*j,x[5]=ce*z-te*R,x[6]=G,x[7]=$,x[8]=K,x},X.scale=function(x,T,B){var U=B[0],j=B[1];return x[0]=U*T[0],x[1]=U*T[1],x[2]=U*T[2],x[3]=j*T[3],x[4]=j*T[4],x[5]=j*T[5],x[6]=T[6],x[7]=T[7],x[8]=T[8],x},X.fromTranslation=function(x,T){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=1,x[5]=0,x[6]=T[0],x[7]=T[1],x[8]=1,x},X.fromRotation=function(x,T){var B=Math.sin(T),U=Math.cos(T);return x[0]=U,x[1]=B,x[2]=0,x[3]=-B,x[4]=U,x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},X.fromScaling=function(x,T){return x[0]=T[0],x[1]=0,x[2]=0,x[3]=0,x[4]=T[1],x[5]=0,x[6]=0,x[7]=0,x[8]=1,x},X.fromMat2d=function(x,T){return x[0]=T[0],x[1]=T[1],x[2]=0,x[3]=T[2],x[4]=T[3],x[5]=0,x[6]=T[4],x[7]=T[5],x[8]=1,x},X.fromQuat=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=B+B,V=U+U,z=j+j,G=B*N,$=U*N,K=U*V,te=j*N,ce=j*V,he=j*z,ne=R*N,de=R*V,ge=R*z;return x[0]=1-K-he,x[3]=$-ge,x[6]=te+de,x[1]=$+ge,x[4]=1-G-he,x[7]=ce-ne,x[2]=te-de,x[5]=ce+ne,x[8]=1-G-K,x},X.normalFromMat4=function(x,T){var B=T[0],U=T[1],j=T[2],R=T[3],N=T[4],V=T[5],z=T[6],G=T[7],$=T[8],K=T[9],te=T[10],ce=T[11],he=T[12],ne=T[13],de=T[14],ge=T[15],Me=B*V-U*N,Be=B*z-j*N,Oe=B*G-R*N,Pe=U*z-j*V,Ye=U*G-R*V,ze=j*G-R*z,Qe=$*ne-K*he,ct=$*de-te*he,ht=$*ge-ce*he,ft=K*de-te*ne,mt=K*ge-ce*ne,Ct=te*ge-ce*de,_t=Me*Ct-Be*mt+Oe*ft+Pe*ht-Ye*ct+ze*Qe;return _t?(x[0]=(V*Ct-z*mt+G*ft)*(_t=1/_t),x[1]=(z*ht-N*Ct-G*ct)*_t,x[2]=(N*mt-V*ht+G*Qe)*_t,x[3]=(j*mt-U*Ct-R*ft)*_t,x[4]=(B*Ct-j*ht+R*ct)*_t,x[5]=(U*ht-B*mt-R*Qe)*_t,x[6]=(ne*ze-de*Ye+ge*Pe)*_t,x[7]=(de*Oe-he*ze-ge*Be)*_t,x[8]=(he*Ye-ne*Oe+ge*Me)*_t,x):null},X.projection=function(x,T,B){return x[0]=2/T,x[1]=0,x[2]=0,x[3]=0,x[4]=-2/B,x[5]=0,x[6]=-1,x[7]=1,x[8]=1,x},X.str=function(x){return"mat3("+x[0]+", "+x[1]+", "+x[2]+", "+x[3]+", "+x[4]+", "+x[5]+", "+x[6]+", "+x[7]+", "+x[8]+")"},X.frob=function(x){return Math.hypot(x[0],x[1],x[2],x[3],x[4],x[5],x[6],x[7],x[8])},X.add=function(x,T,B){return x[0]=T[0]+B[0],x[1]=T[1]+B[1],x[2]=T[2]+B[2],x[3]=T[3]+B[3],x[4]=T[4]+B[4],x[5]=T[5]+B[5],x[6]=T[6]+B[6],x[7]=T[7]+B[7],x[8]=T[8]+B[8],x},X.subtract=A,X.multiplyScalar=function(x,T,B){return x[0]=T[0]*B,x[1]=T[1]*B,x[2]=T[2]*B,x[3]=T[3]*B,x[4]=T[4]*B,x[5]=T[5]*B,x[6]=T[6]*B,x[7]=T[7]*B,x[8]=T[8]*B,x},X.multiplyScalarAndAdd=function(x,T,B,U){return x[0]=T[0]+B[0]*U,x[1]=T[1]+B[1]*U,x[2]=T[2]+B[2]*U,x[3]=T[3]+B[3]*U,x[4]=T[4]+B[4]*U,x[5]=T[5]+B[5]*U,x[6]=T[6]+B[6]*U,x[7]=T[7]+B[7]*U,x[8]=T[8]+B[8]*U,x},X.exactEquals=function(x,T){return x[0]===T[0]&&x[1]===T[1]&&x[2]===T[2]&&x[3]===T[3]&&x[4]===T[4]&&x[5]===T[5]&&x[6]===T[6]&&x[7]===T[7]&&x[8]===T[8]},X.equals=function(x,T){var B=x[0],U=x[1],j=x[2],R=x[3],N=x[4],V=x[5],z=x[6],G=x[7],$=x[8],K=T[0],te=T[1],ce=T[2],he=T[3],ne=T[4],de=T[5],ge=T[6],Me=T[7],Be=T[8];return Math.abs(B-K)<=c.EPSILON*Math.max(1,Math.abs(B),Math.abs(K))&&Math.abs(U-te)<=c.EPSILON*Math.max(1,Math.abs(U),Math.abs(te))&&Math.abs(j-ce)<=c.EPSILON*Math.max(1,Math.abs(j),Math.abs(ce))&&Math.abs(R-he)<=c.EPSILON*Math.max(1,Math.abs(R),Math.abs(he))&&Math.abs(N-ne)<=c.EPSILON*Math.max(1,Math.abs(N),Math.abs(ne))&&Math.abs(V-de)<=c.EPSILON*Math.max(1,Math.abs(V),Math.abs(de))&&Math.abs(z-ge)<=c.EPSILON*Math.max(1,Math.abs(z),Math.abs(ge))&&Math.abs(G-Me)<=c.EPSILON*Math.max(1,Math.abs(G),Math.abs(Me))&&Math.abs($-Be)<=c.EPSILON*Math.max(1,Math.abs($),Math.abs(Be))},X.sub=X.mul=void 0;var c=function(x,T){if(x&&x.__esModule)return x;if(x===null||g(x)!=="object"&&typeof x!="function")return{default:x};var B=d(void 0);if(B&&B.has(x))return B.get(x);var U={},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in x)if(R!=="default"&&Object.prototype.hasOwnProperty.call(x,R)){var N=j?Object.getOwnPropertyDescriptor(x,R):null;N&&(N.get||N.set)?Object.defineProperty(U,R,N):U[R]=x[R]}return U.default=x,B&&B.set(x,U),U}(y());function d(x){if(typeof WeakMap!="function")return null;var T=new WeakMap,B=new WeakMap;return(d=function(U){return U?B:T})(x)}function _(x,T,B){var U=T[0],j=T[1],R=T[2],N=T[3],V=T[4],z=T[5],G=T[6],$=T[7],K=T[8],te=B[0],ce=B[1],he=B[2],ne=B[3],de=B[4],ge=B[5],Me=B[6],Be=B[7],Oe=B[8];return x[0]=te*U+ce*N+he*G,x[1]=te*j+ce*V+he*$,x[2]=te*R+ce*z+he*K,x[3]=ne*U+de*N+ge*G,x[4]=ne*j+de*V+ge*$,x[5]=ne*R+de*z+ge*K,x[6]=Me*U+Be*N+Oe*G,x[7]=Me*j+Be*V+Oe*$,x[8]=Me*R+Be*z+Oe*K,x}function A(x,T,B){return x[0]=T[0]-B[0],x[1]=T[1]-B[1],x[2]=T[2]-B[2],x[3]=T[3]-B[3],x[4]=T[4]-B[4],x[5]=T[5]-B[5],x[6]=T[6]-B[6],x[7]=T[7]-B[7],x[8]=T[8]-B[8],x}return X.mul=_,X.sub=A,X}var Q,re={};function ie(){if(Q)return re;function g(R){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},g(R)}Q=1,Object.defineProperty(re,"__esModule",{value:!0}),re.create=function(){var R=new c.ARRAY_TYPE(16);return c.ARRAY_TYPE!=Float32Array&&(R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=0,R[12]=0,R[13]=0,R[14]=0),R[0]=1,R[5]=1,R[10]=1,R[15]=1,R},re.clone=function(R){var N=new c.ARRAY_TYPE(16);return N[0]=R[0],N[1]=R[1],N[2]=R[2],N[3]=R[3],N[4]=R[4],N[5]=R[5],N[6]=R[6],N[7]=R[7],N[8]=R[8],N[9]=R[9],N[10]=R[10],N[11]=R[11],N[12]=R[12],N[13]=R[13],N[14]=R[14],N[15]=R[15],N},re.copy=function(R,N){return R[0]=N[0],R[1]=N[1],R[2]=N[2],R[3]=N[3],R[4]=N[4],R[5]=N[5],R[6]=N[6],R[7]=N[7],R[8]=N[8],R[9]=N[9],R[10]=N[10],R[11]=N[11],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15],R},re.fromValues=function(R,N,V,z,G,$,K,te,ce,he,ne,de,ge,Me,Be,Oe){var Pe=new c.ARRAY_TYPE(16);return Pe[0]=R,Pe[1]=N,Pe[2]=V,Pe[3]=z,Pe[4]=G,Pe[5]=$,Pe[6]=K,Pe[7]=te,Pe[8]=ce,Pe[9]=he,Pe[10]=ne,Pe[11]=de,Pe[12]=ge,Pe[13]=Me,Pe[14]=Be,Pe[15]=Oe,Pe},re.set=function(R,N,V,z,G,$,K,te,ce,he,ne,de,ge,Me,Be,Oe,Pe){return R[0]=N,R[1]=V,R[2]=z,R[3]=G,R[4]=$,R[5]=K,R[6]=te,R[7]=ce,R[8]=he,R[9]=ne,R[10]=de,R[11]=ge,R[12]=Me,R[13]=Be,R[14]=Oe,R[15]=Pe,R},re.identity=_,re.transpose=function(R,N){if(R===N){var V=N[1],z=N[2],G=N[3],$=N[6],K=N[7],te=N[11];R[1]=N[4],R[2]=N[8],R[3]=N[12],R[4]=V,R[6]=N[9],R[7]=N[13],R[8]=z,R[9]=$,R[11]=N[14],R[12]=G,R[13]=K,R[14]=te}else R[0]=N[0],R[1]=N[4],R[2]=N[8],R[3]=N[12],R[4]=N[1],R[5]=N[5],R[6]=N[9],R[7]=N[13],R[8]=N[2],R[9]=N[6],R[10]=N[10],R[11]=N[14],R[12]=N[3],R[13]=N[7],R[14]=N[11],R[15]=N[15];return R},re.invert=function(R,N){var V=N[0],z=N[1],G=N[2],$=N[3],K=N[4],te=N[5],ce=N[6],he=N[7],ne=N[8],de=N[9],ge=N[10],Me=N[11],Be=N[12],Oe=N[13],Pe=N[14],Ye=N[15],ze=V*te-z*K,Qe=V*ce-G*K,ct=V*he-$*K,ht=z*ce-G*te,ft=z*he-$*te,mt=G*he-$*ce,Ct=ne*Oe-de*Be,_t=ne*Pe-ge*Be,Ut=ne*Ye-Me*Be,Yt=de*Pe-ge*Oe,Dt=de*Ye-Me*Oe,Rn=ge*Ye-Me*Pe,bn=ze*Rn-Qe*Dt+ct*Yt+ht*Ut-ft*_t+mt*Ct;return bn?(R[0]=(te*Rn-ce*Dt+he*Yt)*(bn=1/bn),R[1]=(G*Dt-z*Rn-$*Yt)*bn,R[2]=(Oe*mt-Pe*ft+Ye*ht)*bn,R[3]=(ge*ft-de*mt-Me*ht)*bn,R[4]=(ce*Ut-K*Rn-he*_t)*bn,R[5]=(V*Rn-G*Ut+$*_t)*bn,R[6]=(Pe*ct-Be*mt-Ye*Qe)*bn,R[7]=(ne*mt-ge*ct+Me*Qe)*bn,R[8]=(K*Dt-te*Ut+he*Ct)*bn,R[9]=(z*Ut-V*Dt-$*Ct)*bn,R[10]=(Be*ft-Oe*ct+Ye*ze)*bn,R[11]=(de*ct-ne*ft-Me*ze)*bn,R[12]=(te*_t-K*Yt-ce*Ct)*bn,R[13]=(V*Yt-z*_t+G*Ct)*bn,R[14]=(Oe*Qe-Be*ht-Pe*ze)*bn,R[15]=(ne*ht-de*Qe+ge*ze)*bn,R):null},re.adjoint=function(R,N){var V=N[0],z=N[1],G=N[2],$=N[3],K=N[4],te=N[5],ce=N[6],he=N[7],ne=N[8],de=N[9],ge=N[10],Me=N[11],Be=N[12],Oe=N[13],Pe=N[14],Ye=N[15];return R[0]=te*(ge*Ye-Me*Pe)-de*(ce*Ye-he*Pe)+Oe*(ce*Me-he*ge),R[1]=-(z*(ge*Ye-Me*Pe)-de*(G*Ye-$*Pe)+Oe*(G*Me-$*ge)),R[2]=z*(ce*Ye-he*Pe)-te*(G*Ye-$*Pe)+Oe*(G*he-$*ce),R[3]=-(z*(ce*Me-he*ge)-te*(G*Me-$*ge)+de*(G*he-$*ce)),R[4]=-(K*(ge*Ye-Me*Pe)-ne*(ce*Ye-he*Pe)+Be*(ce*Me-he*ge)),R[5]=V*(ge*Ye-Me*Pe)-ne*(G*Ye-$*Pe)+Be*(G*Me-$*ge),R[6]=-(V*(ce*Ye-he*Pe)-K*(G*Ye-$*Pe)+Be*(G*he-$*ce)),R[7]=V*(ce*Me-he*ge)-K*(G*Me-$*ge)+ne*(G*he-$*ce),R[8]=K*(de*Ye-Me*Oe)-ne*(te*Ye-he*Oe)+Be*(te*Me-he*de),R[9]=-(V*(de*Ye-Me*Oe)-ne*(z*Ye-$*Oe)+Be*(z*Me-$*de)),R[10]=V*(te*Ye-he*Oe)-K*(z*Ye-$*Oe)+Be*(z*he-$*te),R[11]=-(V*(te*Me-he*de)-K*(z*Me-$*de)+ne*(z*he-$*te)),R[12]=-(K*(de*Pe-ge*Oe)-ne*(te*Pe-ce*Oe)+Be*(te*ge-ce*de)),R[13]=V*(de*Pe-ge*Oe)-ne*(z*Pe-G*Oe)+Be*(z*ge-G*de),R[14]=-(V*(te*Pe-ce*Oe)-K*(z*Pe-G*Oe)+Be*(z*ce-G*te)),R[15]=V*(te*ge-ce*de)-K*(z*ge-G*de)+ne*(z*ce-G*te),R},re.determinant=function(R){var N=R[0],V=R[1],z=R[2],G=R[3],$=R[4],K=R[5],te=R[6],ce=R[7],he=R[8],ne=R[9],de=R[10],ge=R[11],Me=R[12],Be=R[13],Oe=R[14],Pe=R[15];return(N*K-V*$)*(de*Pe-ge*Oe)-(N*te-z*$)*(ne*Pe-ge*Be)+(N*ce-G*$)*(ne*Oe-de*Be)+(V*te-z*K)*(he*Pe-ge*Me)-(V*ce-G*K)*(he*Oe-de*Me)+(z*ce-G*te)*(he*Be-ne*Me)},re.multiply=A,re.translate=function(R,N,V){var z,G,$,K,te,ce,he,ne,de,ge,Me,Be,Oe=V[0],Pe=V[1],Ye=V[2];return N===R?(R[12]=N[0]*Oe+N[4]*Pe+N[8]*Ye+N[12],R[13]=N[1]*Oe+N[5]*Pe+N[9]*Ye+N[13],R[14]=N[2]*Oe+N[6]*Pe+N[10]*Ye+N[14],R[15]=N[3]*Oe+N[7]*Pe+N[11]*Ye+N[15]):(G=N[1],$=N[2],K=N[3],te=N[4],ce=N[5],he=N[6],ne=N[7],de=N[8],ge=N[9],Me=N[10],Be=N[11],R[0]=z=N[0],R[1]=G,R[2]=$,R[3]=K,R[4]=te,R[5]=ce,R[6]=he,R[7]=ne,R[8]=de,R[9]=ge,R[10]=Me,R[11]=Be,R[12]=z*Oe+te*Pe+de*Ye+N[12],R[13]=G*Oe+ce*Pe+ge*Ye+N[13],R[14]=$*Oe+he*Pe+Me*Ye+N[14],R[15]=K*Oe+ne*Pe+Be*Ye+N[15]),R},re.scale=function(R,N,V){var z=V[0],G=V[1],$=V[2];return R[0]=N[0]*z,R[1]=N[1]*z,R[2]=N[2]*z,R[3]=N[3]*z,R[4]=N[4]*G,R[5]=N[5]*G,R[6]=N[6]*G,R[7]=N[7]*G,R[8]=N[8]*$,R[9]=N[9]*$,R[10]=N[10]*$,R[11]=N[11]*$,R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15],R},re.rotate=function(R,N,V,z){var G,$,K,te,ce,he,ne,de,ge,Me,Be,Oe,Pe,Ye,ze,Qe,ct,ht,ft,mt,Ct,_t,Ut,Yt,Dt=z[0],Rn=z[1],bn=z[2],dn=Math.hypot(Dt,Rn,bn);return dn<c.EPSILON?null:(Dt*=dn=1/dn,Rn*=dn,bn*=dn,G=Math.sin(V),$=Math.cos(V),ce=N[1],he=N[2],ne=N[3],ge=N[5],Me=N[6],Be=N[7],Pe=N[9],Ye=N[10],ze=N[11],Qe=Dt*Dt*(K=1-$)+$,ft=Dt*Rn*K-bn*G,mt=Rn*Rn*K+$,Ct=bn*Rn*K+Dt*G,_t=Dt*bn*K+Rn*G,Ut=Rn*bn*K-Dt*G,Yt=bn*bn*K+$,R[0]=(te=N[0])*Qe+(de=N[4])*(ct=Rn*Dt*K+bn*G)+(Oe=N[8])*(ht=bn*Dt*K-Rn*G),R[1]=ce*Qe+ge*ct+Pe*ht,R[2]=he*Qe+Me*ct+Ye*ht,R[3]=ne*Qe+Be*ct+ze*ht,R[4]=te*ft+de*mt+Oe*Ct,R[5]=ce*ft+ge*mt+Pe*Ct,R[6]=he*ft+Me*mt+Ye*Ct,R[7]=ne*ft+Be*mt+ze*Ct,R[8]=te*_t+de*Ut+Oe*Yt,R[9]=ce*_t+ge*Ut+Pe*Yt,R[10]=he*_t+Me*Ut+Ye*Yt,R[11]=ne*_t+Be*Ut+ze*Yt,N!==R&&(R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R)},re.rotateX=function(R,N,V){var z=Math.sin(V),G=Math.cos(V),$=N[4],K=N[5],te=N[6],ce=N[7],he=N[8],ne=N[9],de=N[10],ge=N[11];return N!==R&&(R[0]=N[0],R[1]=N[1],R[2]=N[2],R[3]=N[3],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R[4]=$*G+he*z,R[5]=K*G+ne*z,R[6]=te*G+de*z,R[7]=ce*G+ge*z,R[8]=he*G-$*z,R[9]=ne*G-K*z,R[10]=de*G-te*z,R[11]=ge*G-ce*z,R},re.rotateY=function(R,N,V){var z=Math.sin(V),G=Math.cos(V),$=N[0],K=N[1],te=N[2],ce=N[3],he=N[8],ne=N[9],de=N[10],ge=N[11];return N!==R&&(R[4]=N[4],R[5]=N[5],R[6]=N[6],R[7]=N[7],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R[0]=$*G-he*z,R[1]=K*G-ne*z,R[2]=te*G-de*z,R[3]=ce*G-ge*z,R[8]=$*z+he*G,R[9]=K*z+ne*G,R[10]=te*z+de*G,R[11]=ce*z+ge*G,R},re.rotateZ=function(R,N,V){var z=Math.sin(V),G=Math.cos(V),$=N[0],K=N[1],te=N[2],ce=N[3],he=N[4],ne=N[5],de=N[6],ge=N[7];return N!==R&&(R[8]=N[8],R[9]=N[9],R[10]=N[10],R[11]=N[11],R[12]=N[12],R[13]=N[13],R[14]=N[14],R[15]=N[15]),R[0]=$*G+he*z,R[1]=K*G+ne*z,R[2]=te*G+de*z,R[3]=ce*G+ge*z,R[4]=he*G-$*z,R[5]=ne*G-K*z,R[6]=de*G-te*z,R[7]=ge*G-ce*z,R},re.fromTranslation=function(R,N){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=N[0],R[13]=N[1],R[14]=N[2],R[15]=1,R},re.fromScaling=function(R,N){return R[0]=N[0],R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=N[1],R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=N[2],R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromRotation=function(R,N,V){var z,G,$,K=V[0],te=V[1],ce=V[2],he=Math.hypot(K,te,ce);return he<c.EPSILON?null:(K*=he=1/he,te*=he,ce*=he,z=Math.sin(N),G=Math.cos(N),R[0]=K*K*($=1-G)+G,R[1]=te*K*$+ce*z,R[2]=ce*K*$-te*z,R[3]=0,R[4]=K*te*$-ce*z,R[5]=te*te*$+G,R[6]=ce*te*$+K*z,R[7]=0,R[8]=K*ce*$+te*z,R[9]=te*ce*$-K*z,R[10]=ce*ce*$+G,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R)},re.fromXRotation=function(R,N){var V=Math.sin(N),z=Math.cos(N);return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=z,R[6]=V,R[7]=0,R[8]=0,R[9]=-V,R[10]=z,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromYRotation=function(R,N){var V=Math.sin(N),z=Math.cos(N);return R[0]=z,R[1]=0,R[2]=-V,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=V,R[9]=0,R[10]=z,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromZRotation=function(R,N){var V=Math.sin(N),z=Math.cos(N);return R[0]=z,R[1]=V,R[2]=0,R[3]=0,R[4]=-V,R[5]=z,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.fromRotationTranslation=x,re.fromQuat2=function(R,N){var V=new c.ARRAY_TYPE(3),z=-N[0],G=-N[1],$=-N[2],K=N[3],te=N[4],ce=N[5],he=N[6],ne=N[7],de=z*z+G*G+$*$+K*K;return de>0?(V[0]=2*(te*K+ne*z+ce*$-he*G)/de,V[1]=2*(ce*K+ne*G+he*z-te*$)/de,V[2]=2*(he*K+ne*$+te*G-ce*z)/de):(V[0]=2*(te*K+ne*z+ce*$-he*G),V[1]=2*(ce*K+ne*G+he*z-te*$),V[2]=2*(he*K+ne*$+te*G-ce*z)),x(R,N,V),R},re.getTranslation=function(R,N){return R[0]=N[12],R[1]=N[13],R[2]=N[14],R},re.getScaling=T,re.getRotation=function(R,N){var V=new c.ARRAY_TYPE(3);T(V,N);var z=1/V[0],G=1/V[1],$=1/V[2],K=N[0]*z,te=N[1]*G,ce=N[2]*$,he=N[4]*z,ne=N[5]*G,de=N[6]*$,ge=N[8]*z,Me=N[9]*G,Be=N[10]*$,Oe=K+ne+Be,Pe=0;return Oe>0?(Pe=2*Math.sqrt(Oe+1),R[3]=.25*Pe,R[0]=(de-Me)/Pe,R[1]=(ge-ce)/Pe,R[2]=(te-he)/Pe):K>ne&&K>Be?(Pe=2*Math.sqrt(1+K-ne-Be),R[3]=(de-Me)/Pe,R[0]=.25*Pe,R[1]=(te+he)/Pe,R[2]=(ge+ce)/Pe):ne>Be?(Pe=2*Math.sqrt(1+ne-K-Be),R[3]=(ge-ce)/Pe,R[0]=(te+he)/Pe,R[1]=.25*Pe,R[2]=(de+Me)/Pe):(Pe=2*Math.sqrt(1+Be-K-ne),R[3]=(te-he)/Pe,R[0]=(ge+ce)/Pe,R[1]=(de+Me)/Pe,R[2]=.25*Pe),R},re.fromRotationTranslationScale=function(R,N,V,z){var G=N[0],$=N[1],K=N[2],te=N[3],ce=G+G,he=$+$,ne=K+K,de=G*ce,ge=G*he,Me=G*ne,Be=$*he,Oe=$*ne,Pe=K*ne,Ye=te*ce,ze=te*he,Qe=te*ne,ct=z[0],ht=z[1],ft=z[2];return R[0]=(1-(Be+Pe))*ct,R[1]=(ge+Qe)*ct,R[2]=(Me-ze)*ct,R[3]=0,R[4]=(ge-Qe)*ht,R[5]=(1-(de+Pe))*ht,R[6]=(Oe+Ye)*ht,R[7]=0,R[8]=(Me+ze)*ft,R[9]=(Oe-Ye)*ft,R[10]=(1-(de+Be))*ft,R[11]=0,R[12]=V[0],R[13]=V[1],R[14]=V[2],R[15]=1,R},re.fromRotationTranslationScaleOrigin=function(R,N,V,z,G){var $=N[0],K=N[1],te=N[2],ce=N[3],he=$+$,ne=K+K,de=te+te,ge=$*he,Me=$*ne,Be=$*de,Oe=K*ne,Pe=K*de,Ye=te*de,ze=ce*he,Qe=ce*ne,ct=ce*de,ht=z[0],ft=z[1],mt=z[2],Ct=G[0],_t=G[1],Ut=G[2],Yt=(1-(Oe+Ye))*ht,Dt=(Me+ct)*ht,Rn=(Be-Qe)*ht,bn=(Me-ct)*ft,dn=(1-(ge+Ye))*ft,tn=(Pe+ze)*ft,nr=(Be+Qe)*mt,In=(Pe-ze)*mt,Nn=(1-(ge+Oe))*mt;return R[0]=Yt,R[1]=Dt,R[2]=Rn,R[3]=0,R[4]=bn,R[5]=dn,R[6]=tn,R[7]=0,R[8]=nr,R[9]=In,R[10]=Nn,R[11]=0,R[12]=V[0]+Ct-(Yt*Ct+bn*_t+nr*Ut),R[13]=V[1]+_t-(Dt*Ct+dn*_t+In*Ut),R[14]=V[2]+Ut-(Rn*Ct+tn*_t+Nn*Ut),R[15]=1,R},re.fromQuat=function(R,N){var V=N[0],z=N[1],G=N[2],$=N[3],K=V+V,te=z+z,ce=G+G,he=V*K,ne=z*K,de=z*te,ge=G*K,Me=G*te,Be=G*ce,Oe=$*K,Pe=$*te,Ye=$*ce;return R[0]=1-de-Be,R[1]=ne+Ye,R[2]=ge-Pe,R[3]=0,R[4]=ne-Ye,R[5]=1-he-Be,R[6]=Me+Oe,R[7]=0,R[8]=ge+Pe,R[9]=Me-Oe,R[10]=1-he-de,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R},re.frustum=function(R,N,V,z,G,$,K){var te=1/(V-N),ce=1/(G-z),he=1/($-K);return R[0]=2*$*te,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=2*$*ce,R[6]=0,R[7]=0,R[8]=(V+N)*te,R[9]=(G+z)*ce,R[10]=(K+$)*he,R[11]=-1,R[12]=0,R[13]=0,R[14]=K*$*2*he,R[15]=0,R},re.perspectiveNO=B,re.perspectiveZO=function(R,N,V,z,G){var $,K=1/Math.tan(N/2);return R[0]=K/V,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=K,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=-1,R[12]=0,R[13]=0,R[15]=0,G!=null&&G!==1/0?(R[10]=G*($=1/(z-G)),R[14]=G*z*$):(R[10]=-1,R[14]=-z),R},re.perspectiveFromFieldOfView=function(R,N,V,z){var G=Math.tan(N.upDegrees*Math.PI/180),$=Math.tan(N.downDegrees*Math.PI/180),K=Math.tan(N.leftDegrees*Math.PI/180),te=Math.tan(N.rightDegrees*Math.PI/180),ce=2/(K+te),he=2/(G+$);return R[0]=ce,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=he,R[6]=0,R[7]=0,R[8]=-(K-te)*ce*.5,R[9]=(G-$)*he*.5,R[10]=z/(V-z),R[11]=-1,R[12]=0,R[13]=0,R[14]=z*V/(V-z),R[15]=0,R},re.orthoNO=U,re.orthoZO=function(R,N,V,z,G,$,K){var te=1/(N-V),ce=1/(z-G),he=1/($-K);return R[0]=-2*te,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=-2*ce,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=he,R[11]=0,R[12]=(N+V)*te,R[13]=(G+z)*ce,R[14]=$*he,R[15]=1,R},re.lookAt=function(R,N,V,z){var G,$,K,te,ce,he,ne,de,ge,Me,Be=N[0],Oe=N[1],Pe=N[2],Ye=z[0],ze=z[1],Qe=z[2],ct=V[0],ht=V[1],ft=V[2];return Math.abs(Be-ct)<c.EPSILON&&Math.abs(Oe-ht)<c.EPSILON&&Math.abs(Pe-ft)<c.EPSILON?_(R):(ne=Be-ct,de=Oe-ht,ge=Pe-ft,G=ze*(ge*=Me=1/Math.hypot(ne,de,ge))-Qe*(de*=Me),$=Qe*(ne*=Me)-Ye*ge,K=Ye*de-ze*ne,(Me=Math.hypot(G,$,K))?(G*=Me=1/Me,$*=Me,K*=Me):(G=0,$=0,K=0),te=de*K-ge*$,ce=ge*G-ne*K,he=ne*$-de*G,(Me=Math.hypot(te,ce,he))?(te*=Me=1/Me,ce*=Me,he*=Me):(te=0,ce=0,he=0),R[0]=G,R[1]=te,R[2]=ne,R[3]=0,R[4]=$,R[5]=ce,R[6]=de,R[7]=0,R[8]=K,R[9]=he,R[10]=ge,R[11]=0,R[12]=-(G*Be+$*Oe+K*Pe),R[13]=-(te*Be+ce*Oe+he*Pe),R[14]=-(ne*Be+de*Oe+ge*Pe),R[15]=1,R)},re.targetTo=function(R,N,V,z){var G=N[0],$=N[1],K=N[2],te=z[0],ce=z[1],he=z[2],ne=G-V[0],de=$-V[1],ge=K-V[2],Me=ne*ne+de*de+ge*ge;Me>0&&(ne*=Me=1/Math.sqrt(Me),de*=Me,ge*=Me);var Be=ce*ge-he*de,Oe=he*ne-te*ge,Pe=te*de-ce*ne;return(Me=Be*Be+Oe*Oe+Pe*Pe)>0&&(Be*=Me=1/Math.sqrt(Me),Oe*=Me,Pe*=Me),R[0]=Be,R[1]=Oe,R[2]=Pe,R[3]=0,R[4]=de*Pe-ge*Oe,R[5]=ge*Be-ne*Pe,R[6]=ne*Oe-de*Be,R[7]=0,R[8]=ne,R[9]=de,R[10]=ge,R[11]=0,R[12]=G,R[13]=$,R[14]=K,R[15]=1,R},re.str=function(R){return"mat4("+R[0]+", "+R[1]+", "+R[2]+", "+R[3]+", "+R[4]+", "+R[5]+", "+R[6]+", "+R[7]+", "+R[8]+", "+R[9]+", "+R[10]+", "+R[11]+", "+R[12]+", "+R[13]+", "+R[14]+", "+R[15]+")"},re.frob=function(R){return Math.hypot(R[0],R[1],R[2],R[3],R[4],R[5],R[6],R[7],R[8],R[9],R[10],R[11],R[12],R[13],R[14],R[15])},re.add=function(R,N,V){return R[0]=N[0]+V[0],R[1]=N[1]+V[1],R[2]=N[2]+V[2],R[3]=N[3]+V[3],R[4]=N[4]+V[4],R[5]=N[5]+V[5],R[6]=N[6]+V[6],R[7]=N[7]+V[7],R[8]=N[8]+V[8],R[9]=N[9]+V[9],R[10]=N[10]+V[10],R[11]=N[11]+V[11],R[12]=N[12]+V[12],R[13]=N[13]+V[13],R[14]=N[14]+V[14],R[15]=N[15]+V[15],R},re.subtract=j,re.multiplyScalar=function(R,N,V){return R[0]=N[0]*V,R[1]=N[1]*V,R[2]=N[2]*V,R[3]=N[3]*V,R[4]=N[4]*V,R[5]=N[5]*V,R[6]=N[6]*V,R[7]=N[7]*V,R[8]=N[8]*V,R[9]=N[9]*V,R[10]=N[10]*V,R[11]=N[11]*V,R[12]=N[12]*V,R[13]=N[13]*V,R[14]=N[14]*V,R[15]=N[15]*V,R},re.multiplyScalarAndAdd=function(R,N,V,z){return R[0]=N[0]+V[0]*z,R[1]=N[1]+V[1]*z,R[2]=N[2]+V[2]*z,R[3]=N[3]+V[3]*z,R[4]=N[4]+V[4]*z,R[5]=N[5]+V[5]*z,R[6]=N[6]+V[6]*z,R[7]=N[7]+V[7]*z,R[8]=N[8]+V[8]*z,R[9]=N[9]+V[9]*z,R[10]=N[10]+V[10]*z,R[11]=N[11]+V[11]*z,R[12]=N[12]+V[12]*z,R[13]=N[13]+V[13]*z,R[14]=N[14]+V[14]*z,R[15]=N[15]+V[15]*z,R},re.exactEquals=function(R,N){return R[0]===N[0]&&R[1]===N[1]&&R[2]===N[2]&&R[3]===N[3]&&R[4]===N[4]&&R[5]===N[5]&&R[6]===N[6]&&R[7]===N[7]&&R[8]===N[8]&&R[9]===N[9]&&R[10]===N[10]&&R[11]===N[11]&&R[12]===N[12]&&R[13]===N[13]&&R[14]===N[14]&&R[15]===N[15]},re.equals=function(R,N){var V=R[0],z=R[1],G=R[2],$=R[3],K=R[4],te=R[5],ce=R[6],he=R[7],ne=R[8],de=R[9],ge=R[10],Me=R[11],Be=R[12],Oe=R[13],Pe=R[14],Ye=R[15],ze=N[0],Qe=N[1],ct=N[2],ht=N[3],ft=N[4],mt=N[5],Ct=N[6],_t=N[7],Ut=N[8],Yt=N[9],Dt=N[10],Rn=N[11],bn=N[12],dn=N[13],tn=N[14],nr=N[15];return Math.abs(V-ze)<=c.EPSILON*Math.max(1,Math.abs(V),Math.abs(ze))&&Math.abs(z-Qe)<=c.EPSILON*Math.max(1,Math.abs(z),Math.abs(Qe))&&Math.abs(G-ct)<=c.EPSILON*Math.max(1,Math.abs(G),Math.abs(ct))&&Math.abs($-ht)<=c.EPSILON*Math.max(1,Math.abs($),Math.abs(ht))&&Math.abs(K-ft)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(ft))&&Math.abs(te-mt)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(mt))&&Math.abs(ce-Ct)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(Ct))&&Math.abs(he-_t)<=c.EPSILON*Math.max(1,Math.abs(he),Math.abs(_t))&&Math.abs(ne-Ut)<=c.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Ut))&&Math.abs(de-Yt)<=c.EPSILON*Math.max(1,Math.abs(de),Math.abs(Yt))&&Math.abs(ge-Dt)<=c.EPSILON*Math.max(1,Math.abs(ge),Math.abs(Dt))&&Math.abs(Me-Rn)<=c.EPSILON*Math.max(1,Math.abs(Me),Math.abs(Rn))&&Math.abs(Be-bn)<=c.EPSILON*Math.max(1,Math.abs(Be),Math.abs(bn))&&Math.abs(Oe-dn)<=c.EPSILON*Math.max(1,Math.abs(Oe),Math.abs(dn))&&Math.abs(Pe-tn)<=c.EPSILON*Math.max(1,Math.abs(Pe),Math.abs(tn))&&Math.abs(Ye-nr)<=c.EPSILON*Math.max(1,Math.abs(Ye),Math.abs(nr))},re.sub=re.mul=re.ortho=re.perspective=void 0;var c=function(R,N){if(R&&R.__esModule)return R;if(R===null||g(R)!=="object"&&typeof R!="function")return{default:R};var V=d(void 0);if(V&&V.has(R))return V.get(R);var z={},G=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in R)if($!=="default"&&Object.prototype.hasOwnProperty.call(R,$)){var K=G?Object.getOwnPropertyDescriptor(R,$):null;K&&(K.get||K.set)?Object.defineProperty(z,$,K):z[$]=R[$]}return z.default=R,V&&V.set(R,z),z}(y());function d(R){if(typeof WeakMap!="function")return null;var N=new WeakMap,V=new WeakMap;return(d=function(z){return z?V:N})(R)}function _(R){return R[0]=1,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=1,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=1,R[11]=0,R[12]=0,R[13]=0,R[14]=0,R[15]=1,R}function A(R,N,V){var z=N[0],G=N[1],$=N[2],K=N[3],te=N[4],ce=N[5],he=N[6],ne=N[7],de=N[8],ge=N[9],Me=N[10],Be=N[11],Oe=N[12],Pe=N[13],Ye=N[14],ze=N[15],Qe=V[0],ct=V[1],ht=V[2],ft=V[3];return R[0]=Qe*z+ct*te+ht*de+ft*Oe,R[1]=Qe*G+ct*ce+ht*ge+ft*Pe,R[2]=Qe*$+ct*he+ht*Me+ft*Ye,R[3]=Qe*K+ct*ne+ht*Be+ft*ze,R[4]=(Qe=V[4])*z+(ct=V[5])*te+(ht=V[6])*de+(ft=V[7])*Oe,R[5]=Qe*G+ct*ce+ht*ge+ft*Pe,R[6]=Qe*$+ct*he+ht*Me+ft*Ye,R[7]=Qe*K+ct*ne+ht*Be+ft*ze,R[8]=(Qe=V[8])*z+(ct=V[9])*te+(ht=V[10])*de+(ft=V[11])*Oe,R[9]=Qe*G+ct*ce+ht*ge+ft*Pe,R[10]=Qe*$+ct*he+ht*Me+ft*Ye,R[11]=Qe*K+ct*ne+ht*Be+ft*ze,R[12]=(Qe=V[12])*z+(ct=V[13])*te+(ht=V[14])*de+(ft=V[15])*Oe,R[13]=Qe*G+ct*ce+ht*ge+ft*Pe,R[14]=Qe*$+ct*he+ht*Me+ft*Ye,R[15]=Qe*K+ct*ne+ht*Be+ft*ze,R}function x(R,N,V){var z=N[0],G=N[1],$=N[2],K=N[3],te=z+z,ce=G+G,he=$+$,ne=z*te,de=z*ce,ge=z*he,Me=G*ce,Be=G*he,Oe=$*he,Pe=K*te,Ye=K*ce,ze=K*he;return R[0]=1-(Me+Oe),R[1]=de+ze,R[2]=ge-Ye,R[3]=0,R[4]=de-ze,R[5]=1-(ne+Oe),R[6]=Be+Pe,R[7]=0,R[8]=ge+Ye,R[9]=Be-Pe,R[10]=1-(ne+Me),R[11]=0,R[12]=V[0],R[13]=V[1],R[14]=V[2],R[15]=1,R}function T(R,N){var V=N[4],z=N[5],G=N[6],$=N[8],K=N[9],te=N[10];return R[0]=Math.hypot(N[0],N[1],N[2]),R[1]=Math.hypot(V,z,G),R[2]=Math.hypot($,K,te),R}function B(R,N,V,z,G){var $,K=1/Math.tan(N/2);return R[0]=K/V,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=K,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[11]=-1,R[12]=0,R[13]=0,R[15]=0,G!=null&&G!==1/0?(R[10]=(G+z)*($=1/(z-G)),R[14]=2*G*z*$):(R[10]=-1,R[14]=-2*z),R}function U(R,N,V,z,G,$,K){var te=1/(N-V),ce=1/(z-G),he=1/($-K);return R[0]=-2*te,R[1]=0,R[2]=0,R[3]=0,R[4]=0,R[5]=-2*ce,R[6]=0,R[7]=0,R[8]=0,R[9]=0,R[10]=2*he,R[11]=0,R[12]=(N+V)*te,R[13]=(G+z)*ce,R[14]=(K+$)*he,R[15]=1,R}function j(R,N,V){return R[0]=N[0]-V[0],R[1]=N[1]-V[1],R[2]=N[2]-V[2],R[3]=N[3]-V[3],R[4]=N[4]-V[4],R[5]=N[5]-V[5],R[6]=N[6]-V[6],R[7]=N[7]-V[7],R[8]=N[8]-V[8],R[9]=N[9]-V[9],R[10]=N[10]-V[10],R[11]=N[11]-V[11],R[12]=N[12]-V[12],R[13]=N[13]-V[13],R[14]=N[14]-V[14],R[15]=N[15]-V[15],R}return re.perspective=B,re.ortho=U,re.mul=A,re.sub=j,re}var oe,fe={},Se={};function Ee(){if(oe)return Se;function g(G){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function($){return typeof $}:function($){return $&&typeof Symbol=="function"&&$.constructor===Symbol&&$!==Symbol.prototype?"symbol":typeof $},g(G)}oe=1,Object.defineProperty(Se,"__esModule",{value:!0}),Se.create=_,Se.clone=function(G){var $=new c.ARRAY_TYPE(3);return $[0]=G[0],$[1]=G[1],$[2]=G[2],$},Se.length=A,Se.fromValues=function(G,$,K){var te=new c.ARRAY_TYPE(3);return te[0]=G,te[1]=$,te[2]=K,te},Se.copy=function(G,$){return G[0]=$[0],G[1]=$[1],G[2]=$[2],G},Se.set=function(G,$,K,te){return G[0]=$,G[1]=K,G[2]=te,G},Se.add=function(G,$,K){return G[0]=$[0]+K[0],G[1]=$[1]+K[1],G[2]=$[2]+K[2],G},Se.subtract=x,Se.multiply=T,Se.divide=B,Se.ceil=function(G,$){return G[0]=Math.ceil($[0]),G[1]=Math.ceil($[1]),G[2]=Math.ceil($[2]),G},Se.floor=function(G,$){return G[0]=Math.floor($[0]),G[1]=Math.floor($[1]),G[2]=Math.floor($[2]),G},Se.min=function(G,$,K){return G[0]=Math.min($[0],K[0]),G[1]=Math.min($[1],K[1]),G[2]=Math.min($[2],K[2]),G},Se.max=function(G,$,K){return G[0]=Math.max($[0],K[0]),G[1]=Math.max($[1],K[1]),G[2]=Math.max($[2],K[2]),G},Se.round=function(G,$){return G[0]=Math.round($[0]),G[1]=Math.round($[1]),G[2]=Math.round($[2]),G},Se.scale=function(G,$,K){return G[0]=$[0]*K,G[1]=$[1]*K,G[2]=$[2]*K,G},Se.scaleAndAdd=function(G,$,K,te){return G[0]=$[0]+K[0]*te,G[1]=$[1]+K[1]*te,G[2]=$[2]+K[2]*te,G},Se.distance=U,Se.squaredDistance=j,Se.squaredLength=R,Se.negate=function(G,$){return G[0]=-$[0],G[1]=-$[1],G[2]=-$[2],G},Se.inverse=function(G,$){return G[0]=1/$[0],G[1]=1/$[1],G[2]=1/$[2],G},Se.normalize=function(G,$){var K=$[0],te=$[1],ce=$[2],he=K*K+te*te+ce*ce;return he>0&&(he=1/Math.sqrt(he)),G[0]=$[0]*he,G[1]=$[1]*he,G[2]=$[2]*he,G},Se.dot=N,Se.cross=function(G,$,K){var te=$[0],ce=$[1],he=$[2],ne=K[0],de=K[1],ge=K[2];return G[0]=ce*ge-he*de,G[1]=he*ne-te*ge,G[2]=te*de-ce*ne,G},Se.lerp=function(G,$,K,te){var ce=$[0],he=$[1],ne=$[2];return G[0]=ce+te*(K[0]-ce),G[1]=he+te*(K[1]-he),G[2]=ne+te*(K[2]-ne),G},Se.hermite=function(G,$,K,te,ce,he){var ne=he*he,de=ne*(2*he-3)+1,ge=ne*(he-2)+he,Me=ne*(he-1),Be=ne*(3-2*he);return G[0]=$[0]*de+K[0]*ge+te[0]*Me+ce[0]*Be,G[1]=$[1]*de+K[1]*ge+te[1]*Me+ce[1]*Be,G[2]=$[2]*de+K[2]*ge+te[2]*Me+ce[2]*Be,G},Se.bezier=function(G,$,K,te,ce,he){var ne=1-he,de=ne*ne,ge=he*he,Me=de*ne,Be=3*he*de,Oe=3*ge*ne,Pe=ge*he;return G[0]=$[0]*Me+K[0]*Be+te[0]*Oe+ce[0]*Pe,G[1]=$[1]*Me+K[1]*Be+te[1]*Oe+ce[1]*Pe,G[2]=$[2]*Me+K[2]*Be+te[2]*Oe+ce[2]*Pe,G},Se.random=function(G,$){$=$||1;var K=2*c.RANDOM()*Math.PI,te=2*c.RANDOM()-1,ce=Math.sqrt(1-te*te)*$;return G[0]=Math.cos(K)*ce,G[1]=Math.sin(K)*ce,G[2]=te*$,G},Se.transformMat4=function(G,$,K){var te=$[0],ce=$[1],he=$[2],ne=K[3]*te+K[7]*ce+K[11]*he+K[15];return G[0]=(K[0]*te+K[4]*ce+K[8]*he+K[12])/(ne=ne||1),G[1]=(K[1]*te+K[5]*ce+K[9]*he+K[13])/ne,G[2]=(K[2]*te+K[6]*ce+K[10]*he+K[14])/ne,G},Se.transformMat3=function(G,$,K){var te=$[0],ce=$[1],he=$[2];return G[0]=te*K[0]+ce*K[3]+he*K[6],G[1]=te*K[1]+ce*K[4]+he*K[7],G[2]=te*K[2]+ce*K[5]+he*K[8],G},Se.transformQuat=function(G,$,K){var te=K[0],ce=K[1],he=K[2],ne=$[0],de=$[1],ge=$[2],Me=ce*ge-he*de,Be=he*ne-te*ge,Oe=te*de-ce*ne,Pe=ce*Oe-he*Be,Ye=he*Me-te*Oe,ze=te*Be-ce*Me,Qe=2*K[3];return Be*=Qe,Oe*=Qe,Ye*=2,ze*=2,G[0]=ne+(Me*=Qe)+(Pe*=2),G[1]=de+Be+Ye,G[2]=ge+Oe+ze,G},Se.rotateX=function(G,$,K,te){var ce=[],he=[];return ce[0]=$[0]-K[0],ce[1]=$[1]-K[1],ce[2]=$[2]-K[2],he[0]=ce[0],he[1]=ce[1]*Math.cos(te)-ce[2]*Math.sin(te),he[2]=ce[1]*Math.sin(te)+ce[2]*Math.cos(te),G[0]=he[0]+K[0],G[1]=he[1]+K[1],G[2]=he[2]+K[2],G},Se.rotateY=function(G,$,K,te){var ce=[],he=[];return ce[0]=$[0]-K[0],ce[1]=$[1]-K[1],ce[2]=$[2]-K[2],he[0]=ce[2]*Math.sin(te)+ce[0]*Math.cos(te),he[1]=ce[1],he[2]=ce[2]*Math.cos(te)-ce[0]*Math.sin(te),G[0]=he[0]+K[0],G[1]=he[1]+K[1],G[2]=he[2]+K[2],G},Se.rotateZ=function(G,$,K,te){var ce=[],he=[];return ce[0]=$[0]-K[0],ce[1]=$[1]-K[1],ce[2]=$[2]-K[2],he[0]=ce[0]*Math.cos(te)-ce[1]*Math.sin(te),he[1]=ce[0]*Math.sin(te)+ce[1]*Math.cos(te),he[2]=ce[2],G[0]=he[0]+K[0],G[1]=he[1]+K[1],G[2]=he[2]+K[2],G},Se.angle=function(G,$){var K=G[0],te=G[1],ce=G[2],he=$[0],ne=$[1],de=$[2],ge=Math.sqrt(K*K+te*te+ce*ce)*Math.sqrt(he*he+ne*ne+de*de),Me=ge&&N(G,$)/ge;return Math.acos(Math.min(Math.max(Me,-1),1))},Se.zero=function(G){return G[0]=0,G[1]=0,G[2]=0,G},Se.str=function(G){return"vec3("+G[0]+", "+G[1]+", "+G[2]+")"},Se.exactEquals=function(G,$){return G[0]===$[0]&&G[1]===$[1]&&G[2]===$[2]},Se.equals=function(G,$){var K=G[0],te=G[1],ce=G[2],he=$[0],ne=$[1],de=$[2];return Math.abs(K-he)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(he))&&Math.abs(te-ne)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(ne))&&Math.abs(ce-de)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(de))},Se.forEach=Se.sqrLen=Se.len=Se.sqrDist=Se.dist=Se.div=Se.mul=Se.sub=void 0;var c=function(G,$){if(G&&G.__esModule)return G;if(G===null||g(G)!=="object"&&typeof G!="function")return{default:G};var K=d(void 0);if(K&&K.has(G))return K.get(G);var te={},ce=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var he in G)if(he!=="default"&&Object.prototype.hasOwnProperty.call(G,he)){var ne=ce?Object.getOwnPropertyDescriptor(G,he):null;ne&&(ne.get||ne.set)?Object.defineProperty(te,he,ne):te[he]=G[he]}return te.default=G,K&&K.set(G,te),te}(y());function d(G){if(typeof WeakMap!="function")return null;var $=new WeakMap,K=new WeakMap;return(d=function(te){return te?K:$})(G)}function _(){var G=new c.ARRAY_TYPE(3);return c.ARRAY_TYPE!=Float32Array&&(G[0]=0,G[1]=0,G[2]=0),G}function A(G){return Math.hypot(G[0],G[1],G[2])}function x(G,$,K){return G[0]=$[0]-K[0],G[1]=$[1]-K[1],G[2]=$[2]-K[2],G}function T(G,$,K){return G[0]=$[0]*K[0],G[1]=$[1]*K[1],G[2]=$[2]*K[2],G}function B(G,$,K){return G[0]=$[0]/K[0],G[1]=$[1]/K[1],G[2]=$[2]/K[2],G}function U(G,$){return Math.hypot($[0]-G[0],$[1]-G[1],$[2]-G[2])}function j(G,$){var K=$[0]-G[0],te=$[1]-G[1],ce=$[2]-G[2];return K*K+te*te+ce*ce}function R(G){var $=G[0],K=G[1],te=G[2];return $*$+K*K+te*te}function N(G,$){return G[0]*$[0]+G[1]*$[1]+G[2]*$[2]}Se.sub=x,Se.mul=T,Se.div=B,Se.dist=U,Se.sqrDist=j,Se.len=A,Se.sqrLen=R;var V,z=(V=_(),function(G,$,K,te,ce,he){var ne,de;for($||($=3),K||(K=0),de=te?Math.min(te*$+K,G.length):G.length,ne=K;ne<de;ne+=$)V[0]=G[ne],V[1]=G[ne+1],V[2]=G[ne+2],ce(V,V,he),G[ne]=V[0],G[ne+1]=V[1],G[ne+2]=V[2];return G});return Se.forEach=z,Se}var Ie,He,Re={};function st(){if(Ie)return Re;function g(z){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},g(z)}Ie=1,Object.defineProperty(Re,"__esModule",{value:!0}),Re.create=_,Re.clone=function(z){var G=new c.ARRAY_TYPE(4);return G[0]=z[0],G[1]=z[1],G[2]=z[2],G[3]=z[3],G},Re.fromValues=function(z,G,$,K){var te=new c.ARRAY_TYPE(4);return te[0]=z,te[1]=G,te[2]=$,te[3]=K,te},Re.copy=function(z,G){return z[0]=G[0],z[1]=G[1],z[2]=G[2],z[3]=G[3],z},Re.set=function(z,G,$,K,te){return z[0]=G,z[1]=$,z[2]=K,z[3]=te,z},Re.add=function(z,G,$){return z[0]=G[0]+$[0],z[1]=G[1]+$[1],z[2]=G[2]+$[2],z[3]=G[3]+$[3],z},Re.subtract=A,Re.multiply=x,Re.divide=T,Re.ceil=function(z,G){return z[0]=Math.ceil(G[0]),z[1]=Math.ceil(G[1]),z[2]=Math.ceil(G[2]),z[3]=Math.ceil(G[3]),z},Re.floor=function(z,G){return z[0]=Math.floor(G[0]),z[1]=Math.floor(G[1]),z[2]=Math.floor(G[2]),z[3]=Math.floor(G[3]),z},Re.min=function(z,G,$){return z[0]=Math.min(G[0],$[0]),z[1]=Math.min(G[1],$[1]),z[2]=Math.min(G[2],$[2]),z[3]=Math.min(G[3],$[3]),z},Re.max=function(z,G,$){return z[0]=Math.max(G[0],$[0]),z[1]=Math.max(G[1],$[1]),z[2]=Math.max(G[2],$[2]),z[3]=Math.max(G[3],$[3]),z},Re.round=function(z,G){return z[0]=Math.round(G[0]),z[1]=Math.round(G[1]),z[2]=Math.round(G[2]),z[3]=Math.round(G[3]),z},Re.scale=function(z,G,$){return z[0]=G[0]*$,z[1]=G[1]*$,z[2]=G[2]*$,z[3]=G[3]*$,z},Re.scaleAndAdd=function(z,G,$,K){return z[0]=G[0]+$[0]*K,z[1]=G[1]+$[1]*K,z[2]=G[2]+$[2]*K,z[3]=G[3]+$[3]*K,z},Re.distance=B,Re.squaredDistance=U,Re.length=j,Re.squaredLength=R,Re.negate=function(z,G){return z[0]=-G[0],z[1]=-G[1],z[2]=-G[2],z[3]=-G[3],z},Re.inverse=function(z,G){return z[0]=1/G[0],z[1]=1/G[1],z[2]=1/G[2],z[3]=1/G[3],z},Re.normalize=function(z,G){var $=G[0],K=G[1],te=G[2],ce=G[3],he=$*$+K*K+te*te+ce*ce;return he>0&&(he=1/Math.sqrt(he)),z[0]=$*he,z[1]=K*he,z[2]=te*he,z[3]=ce*he,z},Re.dot=function(z,G){return z[0]*G[0]+z[1]*G[1]+z[2]*G[2]+z[3]*G[3]},Re.cross=function(z,G,$,K){var te=$[0]*K[1]-$[1]*K[0],ce=$[0]*K[2]-$[2]*K[0],he=$[0]*K[3]-$[3]*K[0],ne=$[1]*K[2]-$[2]*K[1],de=$[1]*K[3]-$[3]*K[1],ge=$[2]*K[3]-$[3]*K[2],Me=G[0],Be=G[1],Oe=G[2],Pe=G[3];return z[0]=Be*ge-Oe*de+Pe*ne,z[1]=-Me*ge+Oe*he-Pe*ce,z[2]=Me*de-Be*he+Pe*te,z[3]=-Me*ne+Be*ce-Oe*te,z},Re.lerp=function(z,G,$,K){var te=G[0],ce=G[1],he=G[2],ne=G[3];return z[0]=te+K*($[0]-te),z[1]=ce+K*($[1]-ce),z[2]=he+K*($[2]-he),z[3]=ne+K*($[3]-ne),z},Re.random=function(z,G){var $,K,te,ce,he,ne;G=G||1;do he=($=2*c.RANDOM()-1)*$+(K=2*c.RANDOM()-1)*K;while(he>=1);do ne=(te=2*c.RANDOM()-1)*te+(ce=2*c.RANDOM()-1)*ce;while(ne>=1);var de=Math.sqrt((1-he)/ne);return z[0]=G*$,z[1]=G*K,z[2]=G*te*de,z[3]=G*ce*de,z},Re.transformMat4=function(z,G,$){var K=G[0],te=G[1],ce=G[2],he=G[3];return z[0]=$[0]*K+$[4]*te+$[8]*ce+$[12]*he,z[1]=$[1]*K+$[5]*te+$[9]*ce+$[13]*he,z[2]=$[2]*K+$[6]*te+$[10]*ce+$[14]*he,z[3]=$[3]*K+$[7]*te+$[11]*ce+$[15]*he,z},Re.transformQuat=function(z,G,$){var K=G[0],te=G[1],ce=G[2],he=$[0],ne=$[1],de=$[2],ge=$[3],Me=ge*K+ne*ce-de*te,Be=ge*te+de*K-he*ce,Oe=ge*ce+he*te-ne*K,Pe=-he*K-ne*te-de*ce;return z[0]=Me*ge+Pe*-he+Be*-de-Oe*-ne,z[1]=Be*ge+Pe*-ne+Oe*-he-Me*-de,z[2]=Oe*ge+Pe*-de+Me*-ne-Be*-he,z[3]=G[3],z},Re.zero=function(z){return z[0]=0,z[1]=0,z[2]=0,z[3]=0,z},Re.str=function(z){return"vec4("+z[0]+", "+z[1]+", "+z[2]+", "+z[3]+")"},Re.exactEquals=function(z,G){return z[0]===G[0]&&z[1]===G[1]&&z[2]===G[2]&&z[3]===G[3]},Re.equals=function(z,G){var $=z[0],K=z[1],te=z[2],ce=z[3],he=G[0],ne=G[1],de=G[2],ge=G[3];return Math.abs($-he)<=c.EPSILON*Math.max(1,Math.abs($),Math.abs(he))&&Math.abs(K-ne)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(ne))&&Math.abs(te-de)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(de))&&Math.abs(ce-ge)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(ge))},Re.forEach=Re.sqrLen=Re.len=Re.sqrDist=Re.dist=Re.div=Re.mul=Re.sub=void 0;var c=function(z,G){if(z&&z.__esModule)return z;if(z===null||g(z)!=="object"&&typeof z!="function")return{default:z};var $=d(void 0);if($&&$.has(z))return $.get(z);var K={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in z)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(z,ce)){var he=te?Object.getOwnPropertyDescriptor(z,ce):null;he&&(he.get||he.set)?Object.defineProperty(K,ce,he):K[ce]=z[ce]}return K.default=z,$&&$.set(z,K),K}(y());function d(z){if(typeof WeakMap!="function")return null;var G=new WeakMap,$=new WeakMap;return(d=function(K){return K?$:G})(z)}function _(){var z=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(z[0]=0,z[1]=0,z[2]=0,z[3]=0),z}function A(z,G,$){return z[0]=G[0]-$[0],z[1]=G[1]-$[1],z[2]=G[2]-$[2],z[3]=G[3]-$[3],z}function x(z,G,$){return z[0]=G[0]*$[0],z[1]=G[1]*$[1],z[2]=G[2]*$[2],z[3]=G[3]*$[3],z}function T(z,G,$){return z[0]=G[0]/$[0],z[1]=G[1]/$[1],z[2]=G[2]/$[2],z[3]=G[3]/$[3],z}function B(z,G){return Math.hypot(G[0]-z[0],G[1]-z[1],G[2]-z[2],G[3]-z[3])}function U(z,G){var $=G[0]-z[0],K=G[1]-z[1],te=G[2]-z[2],ce=G[3]-z[3];return $*$+K*K+te*te+ce*ce}function j(z){return Math.hypot(z[0],z[1],z[2],z[3])}function R(z){var G=z[0],$=z[1],K=z[2],te=z[3];return G*G+$*$+K*K+te*te}Re.sub=A,Re.mul=x,Re.div=T,Re.dist=B,Re.sqrDist=U,Re.len=j,Re.sqrLen=R;var N,V=(N=_(),function(z,G,$,K,te,ce){var he,ne;for(G||(G=4),$||($=0),ne=K?Math.min(K*G+$,z.length):z.length,he=$;he<ne;he+=G)N[0]=z[he],N[1]=z[he+1],N[2]=z[he+2],N[3]=z[he+3],te(N,N,ce),z[he]=N[0],z[he+1]=N[1],z[he+2]=N[2],z[he+3]=N[3];return z});return Re.forEach=V,Re}function _e(){if(He)return fe;function g(ze){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Qe){return typeof Qe}:function(Qe){return Qe&&typeof Symbol=="function"&&Qe.constructor===Symbol&&Qe!==Symbol.prototype?"symbol":typeof Qe},g(ze)}He=1,Object.defineProperty(fe,"__esModule",{value:!0}),fe.create=B,fe.identity=function(ze){return ze[0]=0,ze[1]=0,ze[2]=0,ze[3]=1,ze},fe.setAxisAngle=U,fe.getAxisAngle=function(ze,Qe){var ct=2*Math.acos(Qe[3]),ht=Math.sin(ct/2);return ht>c.EPSILON?(ze[0]=Qe[0]/ht,ze[1]=Qe[1]/ht,ze[2]=Qe[2]/ht):(ze[0]=1,ze[1]=0,ze[2]=0),ct},fe.getAngle=function(ze,Qe){var ct=$(ze,Qe);return Math.acos(2*ct*ct-1)},fe.multiply=j,fe.rotateX=function(ze,Qe,ct){ct*=.5;var ht=Qe[0],ft=Qe[1],mt=Qe[2],Ct=Qe[3],_t=Math.sin(ct),Ut=Math.cos(ct);return ze[0]=ht*Ut+Ct*_t,ze[1]=ft*Ut+mt*_t,ze[2]=mt*Ut-ft*_t,ze[3]=Ct*Ut-ht*_t,ze},fe.rotateY=function(ze,Qe,ct){ct*=.5;var ht=Qe[0],ft=Qe[1],mt=Qe[2],Ct=Qe[3],_t=Math.sin(ct),Ut=Math.cos(ct);return ze[0]=ht*Ut-mt*_t,ze[1]=ft*Ut+Ct*_t,ze[2]=mt*Ut+ht*_t,ze[3]=Ct*Ut-ft*_t,ze},fe.rotateZ=function(ze,Qe,ct){ct*=.5;var ht=Qe[0],ft=Qe[1],mt=Qe[2],Ct=Qe[3],_t=Math.sin(ct),Ut=Math.cos(ct);return ze[0]=ht*Ut+ft*_t,ze[1]=ft*Ut-ht*_t,ze[2]=mt*Ut+Ct*_t,ze[3]=Ct*Ut-mt*_t,ze},fe.calculateW=function(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2];return ze[0]=ct,ze[1]=ht,ze[2]=ft,ze[3]=Math.sqrt(Math.abs(1-ct*ct-ht*ht-ft*ft)),ze},fe.exp=R,fe.ln=N,fe.pow=function(ze,Qe,ct){return N(ze,Qe),G(ze,ze,ct),R(ze,ze),ze},fe.slerp=V,fe.random=function(ze){var Qe=c.RANDOM(),ct=c.RANDOM(),ht=c.RANDOM(),ft=Math.sqrt(1-Qe),mt=Math.sqrt(Qe);return ze[0]=ft*Math.sin(2*Math.PI*ct),ze[1]=ft*Math.cos(2*Math.PI*ct),ze[2]=mt*Math.sin(2*Math.PI*ht),ze[3]=mt*Math.cos(2*Math.PI*ht),ze},fe.invert=function(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2],mt=Qe[3],Ct=ct*ct+ht*ht+ft*ft+mt*mt,_t=Ct?1/Ct:0;return ze[0]=-ct*_t,ze[1]=-ht*_t,ze[2]=-ft*_t,ze[3]=mt*_t,ze},fe.conjugate=function(ze,Qe){return ze[0]=-Qe[0],ze[1]=-Qe[1],ze[2]=-Qe[2],ze[3]=Qe[3],ze},fe.fromMat3=z,fe.fromEuler=function(ze,Qe,ct,ht){var ft=.5*Math.PI/180;Qe*=ft,ct*=ft,ht*=ft;var mt=Math.sin(Qe),Ct=Math.cos(Qe),_t=Math.sin(ct),Ut=Math.cos(ct),Yt=Math.sin(ht),Dt=Math.cos(ht);return ze[0]=mt*Ut*Dt-Ct*_t*Yt,ze[1]=Ct*_t*Dt+mt*Ut*Yt,ze[2]=Ct*Ut*Yt-mt*_t*Dt,ze[3]=Ct*Ut*Dt+mt*_t*Yt,ze},fe.str=function(ze){return"quat("+ze[0]+", "+ze[1]+", "+ze[2]+", "+ze[3]+")"},fe.setAxes=fe.sqlerp=fe.rotationTo=fe.equals=fe.exactEquals=fe.normalize=fe.sqrLen=fe.squaredLength=fe.len=fe.length=fe.lerp=fe.dot=fe.scale=fe.mul=fe.add=fe.set=fe.copy=fe.fromValues=fe.clone=void 0;var c=T(y()),d=T(Z()),_=T(Ee()),A=T(st());function x(ze){if(typeof WeakMap!="function")return null;var Qe=new WeakMap,ct=new WeakMap;return(x=function(ht){return ht?ct:Qe})(ze)}function T(ze,Qe){if(ze&&ze.__esModule)return ze;if(ze===null||g(ze)!=="object"&&typeof ze!="function")return{default:ze};var ct=x(Qe);if(ct&&ct.has(ze))return ct.get(ze);var ht={},ft=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var mt in ze)if(mt!=="default"&&Object.prototype.hasOwnProperty.call(ze,mt)){var Ct=ft?Object.getOwnPropertyDescriptor(ze,mt):null;Ct&&(Ct.get||Ct.set)?Object.defineProperty(ht,mt,Ct):ht[mt]=ze[mt]}return ht.default=ze,ct&&ct.set(ze,ht),ht}function B(){var ze=new c.ARRAY_TYPE(4);return c.ARRAY_TYPE!=Float32Array&&(ze[0]=0,ze[1]=0,ze[2]=0),ze[3]=1,ze}function U(ze,Qe,ct){ct*=.5;var ht=Math.sin(ct);return ze[0]=ht*Qe[0],ze[1]=ht*Qe[1],ze[2]=ht*Qe[2],ze[3]=Math.cos(ct),ze}function j(ze,Qe,ct){var ht=Qe[0],ft=Qe[1],mt=Qe[2],Ct=Qe[3],_t=ct[0],Ut=ct[1],Yt=ct[2],Dt=ct[3];return ze[0]=ht*Dt+Ct*_t+ft*Yt-mt*Ut,ze[1]=ft*Dt+Ct*Ut+mt*_t-ht*Yt,ze[2]=mt*Dt+Ct*Yt+ht*Ut-ft*_t,ze[3]=Ct*Dt-ht*_t-ft*Ut-mt*Yt,ze}function R(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2],mt=Qe[3],Ct=Math.sqrt(ct*ct+ht*ht+ft*ft),_t=Math.exp(mt),Ut=Ct>0?_t*Math.sin(Ct)/Ct:0;return ze[0]=ct*Ut,ze[1]=ht*Ut,ze[2]=ft*Ut,ze[3]=_t*Math.cos(Ct),ze}function N(ze,Qe){var ct=Qe[0],ht=Qe[1],ft=Qe[2],mt=Qe[3],Ct=Math.sqrt(ct*ct+ht*ht+ft*ft),_t=Ct>0?Math.atan2(Ct,mt)/Ct:0;return ze[0]=ct*_t,ze[1]=ht*_t,ze[2]=ft*_t,ze[3]=.5*Math.log(ct*ct+ht*ht+ft*ft+mt*mt),ze}function V(ze,Qe,ct,ht){var ft,mt,Ct,_t,Ut,Yt=Qe[0],Dt=Qe[1],Rn=Qe[2],bn=Qe[3],dn=ct[0],tn=ct[1],nr=ct[2],In=ct[3];return(mt=Yt*dn+Dt*tn+Rn*nr+bn*In)<0&&(mt=-mt,dn=-dn,tn=-tn,nr=-nr,In=-In),1-mt>c.EPSILON?(ft=Math.acos(mt),Ct=Math.sin(ft),_t=Math.sin((1-ht)*ft)/Ct,Ut=Math.sin(ht*ft)/Ct):(_t=1-ht,Ut=ht),ze[0]=_t*Yt+Ut*dn,ze[1]=_t*Dt+Ut*tn,ze[2]=_t*Rn+Ut*nr,ze[3]=_t*bn+Ut*In,ze}function z(ze,Qe){var ct,ht=Qe[0]+Qe[4]+Qe[8];if(ht>0)ct=Math.sqrt(ht+1),ze[3]=.5*ct,ze[0]=(Qe[5]-Qe[7])*(ct=.5/ct),ze[1]=(Qe[6]-Qe[2])*ct,ze[2]=(Qe[1]-Qe[3])*ct;else{var ft=0;Qe[4]>Qe[0]&&(ft=1),Qe[8]>Qe[3*ft+ft]&&(ft=2);var mt=(ft+1)%3,Ct=(ft+2)%3;ct=Math.sqrt(Qe[3*ft+ft]-Qe[3*mt+mt]-Qe[3*Ct+Ct]+1),ze[ft]=.5*ct,ze[3]=(Qe[3*mt+Ct]-Qe[3*Ct+mt])*(ct=.5/ct),ze[mt]=(Qe[3*mt+ft]+Qe[3*ft+mt])*ct,ze[Ct]=(Qe[3*Ct+ft]+Qe[3*ft+Ct])*ct}return ze}fe.clone=A.clone,fe.fromValues=A.fromValues,fe.copy=A.copy,fe.set=A.set,fe.add=A.add,fe.mul=j;var G=A.scale;fe.scale=G;var $=A.dot;fe.dot=$,fe.lerp=A.lerp;var K=A.length;fe.length=K,fe.len=K;var te=A.squaredLength;fe.squaredLength=te,fe.sqrLen=te;var ce=A.normalize;fe.normalize=ce,fe.exactEquals=A.exactEquals,fe.equals=A.equals;var he,ne,de,ge=(he=_.create(),ne=_.fromValues(1,0,0),de=_.fromValues(0,1,0),function(ze,Qe,ct){var ht=_.dot(Qe,ct);return ht<-.999999?(_.cross(he,ne,Qe),_.len(he)<1e-6&&_.cross(he,de,Qe),_.normalize(he,he),U(ze,he,Math.PI),ze):ht>.999999?(ze[0]=0,ze[1]=0,ze[2]=0,ze[3]=1,ze):(_.cross(he,Qe,ct),ze[0]=he[0],ze[1]=he[1],ze[2]=he[2],ze[3]=1+ht,ce(ze,ze))});fe.rotationTo=ge;var Me,Be,Oe=(Me=B(),Be=B(),function(ze,Qe,ct,ht,ft,mt){return V(Me,Qe,ft,mt),V(Be,ct,ht,mt),V(ze,Me,Be,2*mt*(1-mt)),ze});fe.sqlerp=Oe;var Pe,Ye=(Pe=d.create(),function(ze,Qe,ct,ht){return Pe[0]=ct[0],Pe[3]=ct[1],Pe[6]=ct[2],Pe[1]=ht[0],Pe[4]=ht[1],Pe[7]=ht[2],Pe[2]=-Qe[0],Pe[5]=-Qe[1],Pe[8]=-Qe[2],ce(ze,z(ze,Pe))});return fe.setAxes=Ye,fe}var We,Ue={};function vt(){if(We)return Ue;function g(V){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(z){return typeof z}:function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},g(V)}We=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.create=function(){var V=new c.ARRAY_TYPE(8);return c.ARRAY_TYPE!=Float32Array&&(V[0]=0,V[1]=0,V[2]=0,V[4]=0,V[5]=0,V[6]=0,V[7]=0),V[3]=1,V},Ue.clone=function(V){var z=new c.ARRAY_TYPE(8);return z[0]=V[0],z[1]=V[1],z[2]=V[2],z[3]=V[3],z[4]=V[4],z[5]=V[5],z[6]=V[6],z[7]=V[7],z},Ue.fromValues=function(V,z,G,$,K,te,ce,he){var ne=new c.ARRAY_TYPE(8);return ne[0]=V,ne[1]=z,ne[2]=G,ne[3]=$,ne[4]=K,ne[5]=te,ne[6]=ce,ne[7]=he,ne},Ue.fromRotationTranslationValues=function(V,z,G,$,K,te,ce){var he=new c.ARRAY_TYPE(8);he[0]=V,he[1]=z,he[2]=G,he[3]=$;var ne=.5*K,de=.5*te,ge=.5*ce;return he[4]=ne*$+de*G-ge*z,he[5]=de*$+ge*V-ne*G,he[6]=ge*$+ne*z-de*V,he[7]=-ne*V-de*z-ge*G,he},Ue.fromRotationTranslation=T,Ue.fromTranslation=function(V,z){return V[0]=0,V[1]=0,V[2]=0,V[3]=1,V[4]=.5*z[0],V[5]=.5*z[1],V[6]=.5*z[2],V[7]=0,V},Ue.fromRotation=function(V,z){return V[0]=z[0],V[1]=z[1],V[2]=z[2],V[3]=z[3],V[4]=0,V[5]=0,V[6]=0,V[7]=0,V},Ue.fromMat4=function(V,z){var G=d.create();_.getRotation(G,z);var $=new c.ARRAY_TYPE(3);return _.getTranslation($,z),T(V,G,$),V},Ue.copy=B,Ue.identity=function(V){return V[0]=0,V[1]=0,V[2]=0,V[3]=1,V[4]=0,V[5]=0,V[6]=0,V[7]=0,V},Ue.set=function(V,z,G,$,K,te,ce,he,ne){return V[0]=z,V[1]=G,V[2]=$,V[3]=K,V[4]=te,V[5]=ce,V[6]=he,V[7]=ne,V},Ue.getDual=function(V,z){return V[0]=z[4],V[1]=z[5],V[2]=z[6],V[3]=z[7],V},Ue.setDual=function(V,z){return V[4]=z[0],V[5]=z[1],V[6]=z[2],V[7]=z[3],V},Ue.getTranslation=function(V,z){var G=z[4],$=z[5],K=z[6],te=z[7],ce=-z[0],he=-z[1],ne=-z[2],de=z[3];return V[0]=2*(G*de+te*ce+$*ne-K*he),V[1]=2*($*de+te*he+K*ce-G*ne),V[2]=2*(K*de+te*ne+G*he-$*ce),V},Ue.translate=function(V,z,G){var $=z[0],K=z[1],te=z[2],ce=z[3],he=.5*G[0],ne=.5*G[1],de=.5*G[2],ge=z[4],Me=z[5],Be=z[6],Oe=z[7];return V[0]=$,V[1]=K,V[2]=te,V[3]=ce,V[4]=ce*he+K*de-te*ne+ge,V[5]=ce*ne+te*he-$*de+Me,V[6]=ce*de+$*ne-K*he+Be,V[7]=-$*he-K*ne-te*de+Oe,V},Ue.rotateX=function(V,z,G){var $=-z[0],K=-z[1],te=-z[2],ce=z[3],he=z[4],ne=z[5],de=z[6],ge=z[7],Me=he*ce+ge*$+ne*te-de*K,Be=ne*ce+ge*K+de*$-he*te,Oe=de*ce+ge*te+he*K-ne*$,Pe=ge*ce-he*$-ne*K-de*te;return d.rotateX(V,z,G),V[4]=Me*(ce=V[3])+Pe*($=V[0])+Be*(te=V[2])-Oe*(K=V[1]),V[5]=Be*ce+Pe*K+Oe*$-Me*te,V[6]=Oe*ce+Pe*te+Me*K-Be*$,V[7]=Pe*ce-Me*$-Be*K-Oe*te,V},Ue.rotateY=function(V,z,G){var $=-z[0],K=-z[1],te=-z[2],ce=z[3],he=z[4],ne=z[5],de=z[6],ge=z[7],Me=he*ce+ge*$+ne*te-de*K,Be=ne*ce+ge*K+de*$-he*te,Oe=de*ce+ge*te+he*K-ne*$,Pe=ge*ce-he*$-ne*K-de*te;return d.rotateY(V,z,G),V[4]=Me*(ce=V[3])+Pe*($=V[0])+Be*(te=V[2])-Oe*(K=V[1]),V[5]=Be*ce+Pe*K+Oe*$-Me*te,V[6]=Oe*ce+Pe*te+Me*K-Be*$,V[7]=Pe*ce-Me*$-Be*K-Oe*te,V},Ue.rotateZ=function(V,z,G){var $=-z[0],K=-z[1],te=-z[2],ce=z[3],he=z[4],ne=z[5],de=z[6],ge=z[7],Me=he*ce+ge*$+ne*te-de*K,Be=ne*ce+ge*K+de*$-he*te,Oe=de*ce+ge*te+he*K-ne*$,Pe=ge*ce-he*$-ne*K-de*te;return d.rotateZ(V,z,G),V[4]=Me*(ce=V[3])+Pe*($=V[0])+Be*(te=V[2])-Oe*(K=V[1]),V[5]=Be*ce+Pe*K+Oe*$-Me*te,V[6]=Oe*ce+Pe*te+Me*K-Be*$,V[7]=Pe*ce-Me*$-Be*K-Oe*te,V},Ue.rotateByQuatAppend=function(V,z,G){var $=G[0],K=G[1],te=G[2],ce=G[3],he=z[0],ne=z[1],de=z[2],ge=z[3];return V[0]=he*ce+ge*$+ne*te-de*K,V[1]=ne*ce+ge*K+de*$-he*te,V[2]=de*ce+ge*te+he*K-ne*$,V[3]=ge*ce-he*$-ne*K-de*te,V[4]=(he=z[4])*ce+(ge=z[7])*$+(ne=z[5])*te-(de=z[6])*K,V[5]=ne*ce+ge*K+de*$-he*te,V[6]=de*ce+ge*te+he*K-ne*$,V[7]=ge*ce-he*$-ne*K-de*te,V},Ue.rotateByQuatPrepend=function(V,z,G){var $=z[0],K=z[1],te=z[2],ce=z[3],he=G[0],ne=G[1],de=G[2],ge=G[3];return V[0]=$*ge+ce*he+K*de-te*ne,V[1]=K*ge+ce*ne+te*he-$*de,V[2]=te*ge+ce*de+$*ne-K*he,V[3]=ce*ge-$*he-K*ne-te*de,V[4]=$*(ge=G[7])+ce*(he=G[4])+K*(de=G[6])-te*(ne=G[5]),V[5]=K*ge+ce*ne+te*he-$*de,V[6]=te*ge+ce*de+$*ne-K*he,V[7]=ce*ge-$*he-K*ne-te*de,V},Ue.rotateAroundAxis=function(V,z,G,$){if(Math.abs($)<c.EPSILON)return B(V,z);var K=Math.hypot(G[0],G[1],G[2]);$*=.5;var te=Math.sin($),ce=te*G[0]/K,he=te*G[1]/K,ne=te*G[2]/K,de=Math.cos($),ge=z[0],Me=z[1],Be=z[2],Oe=z[3];V[0]=ge*de+Oe*ce+Me*ne-Be*he,V[1]=Me*de+Oe*he+Be*ce-ge*ne,V[2]=Be*de+Oe*ne+ge*he-Me*ce,V[3]=Oe*de-ge*ce-Me*he-Be*ne;var Pe=z[4],Ye=z[5],ze=z[6],Qe=z[7];return V[4]=Pe*de+Qe*ce+Ye*ne-ze*he,V[5]=Ye*de+Qe*he+ze*ce-Pe*ne,V[6]=ze*de+Qe*ne+Pe*he-Ye*ce,V[7]=Qe*de-Pe*ce-Ye*he-ze*ne,V},Ue.add=function(V,z,G){return V[0]=z[0]+G[0],V[1]=z[1]+G[1],V[2]=z[2]+G[2],V[3]=z[3]+G[3],V[4]=z[4]+G[4],V[5]=z[5]+G[5],V[6]=z[6]+G[6],V[7]=z[7]+G[7],V},Ue.multiply=U,Ue.scale=function(V,z,G){return V[0]=z[0]*G,V[1]=z[1]*G,V[2]=z[2]*G,V[3]=z[3]*G,V[4]=z[4]*G,V[5]=z[5]*G,V[6]=z[6]*G,V[7]=z[7]*G,V},Ue.lerp=function(V,z,G,$){var K=1-$;return j(z,G)<0&&($=-$),V[0]=z[0]*K+G[0]*$,V[1]=z[1]*K+G[1]*$,V[2]=z[2]*K+G[2]*$,V[3]=z[3]*K+G[3]*$,V[4]=z[4]*K+G[4]*$,V[5]=z[5]*K+G[5]*$,V[6]=z[6]*K+G[6]*$,V[7]=z[7]*K+G[7]*$,V},Ue.invert=function(V,z){var G=N(z);return V[0]=-z[0]/G,V[1]=-z[1]/G,V[2]=-z[2]/G,V[3]=z[3]/G,V[4]=-z[4]/G,V[5]=-z[5]/G,V[6]=-z[6]/G,V[7]=z[7]/G,V},Ue.conjugate=function(V,z){return V[0]=-z[0],V[1]=-z[1],V[2]=-z[2],V[3]=z[3],V[4]=-z[4],V[5]=-z[5],V[6]=-z[6],V[7]=z[7],V},Ue.normalize=function(V,z){var G=N(z);if(G>0){G=Math.sqrt(G);var $=z[0]/G,K=z[1]/G,te=z[2]/G,ce=z[3]/G,he=z[4],ne=z[5],de=z[6],ge=z[7],Me=$*he+K*ne+te*de+ce*ge;V[0]=$,V[1]=K,V[2]=te,V[3]=ce,V[4]=(he-$*Me)/G,V[5]=(ne-K*Me)/G,V[6]=(de-te*Me)/G,V[7]=(ge-ce*Me)/G}return V},Ue.str=function(V){return"quat2("+V[0]+", "+V[1]+", "+V[2]+", "+V[3]+", "+V[4]+", "+V[5]+", "+V[6]+", "+V[7]+")"},Ue.exactEquals=function(V,z){return V[0]===z[0]&&V[1]===z[1]&&V[2]===z[2]&&V[3]===z[3]&&V[4]===z[4]&&V[5]===z[5]&&V[6]===z[6]&&V[7]===z[7]},Ue.equals=function(V,z){var G=V[0],$=V[1],K=V[2],te=V[3],ce=V[4],he=V[5],ne=V[6],de=V[7],ge=z[0],Me=z[1],Be=z[2],Oe=z[3],Pe=z[4],Ye=z[5],ze=z[6],Qe=z[7];return Math.abs(G-ge)<=c.EPSILON*Math.max(1,Math.abs(G),Math.abs(ge))&&Math.abs($-Me)<=c.EPSILON*Math.max(1,Math.abs($),Math.abs(Me))&&Math.abs(K-Be)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(Be))&&Math.abs(te-Oe)<=c.EPSILON*Math.max(1,Math.abs(te),Math.abs(Oe))&&Math.abs(ce-Pe)<=c.EPSILON*Math.max(1,Math.abs(ce),Math.abs(Pe))&&Math.abs(he-Ye)<=c.EPSILON*Math.max(1,Math.abs(he),Math.abs(Ye))&&Math.abs(ne-ze)<=c.EPSILON*Math.max(1,Math.abs(ne),Math.abs(ze))&&Math.abs(de-Qe)<=c.EPSILON*Math.max(1,Math.abs(de),Math.abs(Qe))},Ue.sqrLen=Ue.squaredLength=Ue.len=Ue.length=Ue.dot=Ue.mul=Ue.setReal=Ue.getReal=void 0;var c=x(y()),d=x(_e()),_=x(ie());function A(V){if(typeof WeakMap!="function")return null;var z=new WeakMap,G=new WeakMap;return(A=function($){return $?G:z})(V)}function x(V,z){if(V&&V.__esModule)return V;if(V===null||g(V)!=="object"&&typeof V!="function")return{default:V};var G=A(z);if(G&&G.has(V))return G.get(V);var $={},K=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var te in V)if(te!=="default"&&Object.prototype.hasOwnProperty.call(V,te)){var ce=K?Object.getOwnPropertyDescriptor(V,te):null;ce&&(ce.get||ce.set)?Object.defineProperty($,te,ce):$[te]=V[te]}return $.default=V,G&&G.set(V,$),$}function T(V,z,G){var $=.5*G[0],K=.5*G[1],te=.5*G[2],ce=z[0],he=z[1],ne=z[2],de=z[3];return V[0]=ce,V[1]=he,V[2]=ne,V[3]=de,V[4]=$*de+K*ne-te*he,V[5]=K*de+te*ce-$*ne,V[6]=te*de+$*he-K*ce,V[7]=-$*ce-K*he-te*ne,V}function B(V,z){return V[0]=z[0],V[1]=z[1],V[2]=z[2],V[3]=z[3],V[4]=z[4],V[5]=z[5],V[6]=z[6],V[7]=z[7],V}function U(V,z,G){var $=z[0],K=z[1],te=z[2],ce=z[3],he=G[4],ne=G[5],de=G[6],ge=G[7],Me=z[4],Be=z[5],Oe=z[6],Pe=z[7],Ye=G[0],ze=G[1],Qe=G[2],ct=G[3];return V[0]=$*ct+ce*Ye+K*Qe-te*ze,V[1]=K*ct+ce*ze+te*Ye-$*Qe,V[2]=te*ct+ce*Qe+$*ze-K*Ye,V[3]=ce*ct-$*Ye-K*ze-te*Qe,V[4]=$*ge+ce*he+K*de-te*ne+Me*ct+Pe*Ye+Be*Qe-Oe*ze,V[5]=K*ge+ce*ne+te*he-$*de+Be*ct+Pe*ze+Oe*Ye-Me*Qe,V[6]=te*ge+ce*de+$*ne-K*he+Oe*ct+Pe*Qe+Me*ze-Be*Ye,V[7]=ce*ge-$*he-K*ne-te*de+Pe*ct-Me*Ye-Be*ze-Oe*Qe,V}Ue.getReal=d.copy,Ue.setReal=d.copy,Ue.mul=U;var j=d.dot;Ue.dot=j;var R=d.length;Ue.length=R,Ue.len=R;var N=d.squaredLength;return Ue.squaredLength=N,Ue.sqrLen=N,Ue}var xt,Vt,lt={};function Ht(){if(xt)return lt;function g(z){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},g(z)}xt=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.create=_,lt.clone=function(z){var G=new c.ARRAY_TYPE(2);return G[0]=z[0],G[1]=z[1],G},lt.fromValues=function(z,G){var $=new c.ARRAY_TYPE(2);return $[0]=z,$[1]=G,$},lt.copy=function(z,G){return z[0]=G[0],z[1]=G[1],z},lt.set=function(z,G,$){return z[0]=G,z[1]=$,z},lt.add=function(z,G,$){return z[0]=G[0]+$[0],z[1]=G[1]+$[1],z},lt.subtract=A,lt.multiply=x,lt.divide=T,lt.ceil=function(z,G){return z[0]=Math.ceil(G[0]),z[1]=Math.ceil(G[1]),z},lt.floor=function(z,G){return z[0]=Math.floor(G[0]),z[1]=Math.floor(G[1]),z},lt.min=function(z,G,$){return z[0]=Math.min(G[0],$[0]),z[1]=Math.min(G[1],$[1]),z},lt.max=function(z,G,$){return z[0]=Math.max(G[0],$[0]),z[1]=Math.max(G[1],$[1]),z},lt.round=function(z,G){return z[0]=Math.round(G[0]),z[1]=Math.round(G[1]),z},lt.scale=function(z,G,$){return z[0]=G[0]*$,z[1]=G[1]*$,z},lt.scaleAndAdd=function(z,G,$,K){return z[0]=G[0]+$[0]*K,z[1]=G[1]+$[1]*K,z},lt.distance=B,lt.squaredDistance=U,lt.length=j,lt.squaredLength=R,lt.negate=function(z,G){return z[0]=-G[0],z[1]=-G[1],z},lt.inverse=function(z,G){return z[0]=1/G[0],z[1]=1/G[1],z},lt.normalize=function(z,G){var $=G[0],K=G[1],te=$*$+K*K;return te>0&&(te=1/Math.sqrt(te)),z[0]=G[0]*te,z[1]=G[1]*te,z},lt.dot=function(z,G){return z[0]*G[0]+z[1]*G[1]},lt.cross=function(z,G,$){var K=G[0]*$[1]-G[1]*$[0];return z[0]=z[1]=0,z[2]=K,z},lt.lerp=function(z,G,$,K){var te=G[0],ce=G[1];return z[0]=te+K*($[0]-te),z[1]=ce+K*($[1]-ce),z},lt.random=function(z,G){G=G||1;var $=2*c.RANDOM()*Math.PI;return z[0]=Math.cos($)*G,z[1]=Math.sin($)*G,z},lt.transformMat2=function(z,G,$){var K=G[0],te=G[1];return z[0]=$[0]*K+$[2]*te,z[1]=$[1]*K+$[3]*te,z},lt.transformMat2d=function(z,G,$){var K=G[0],te=G[1];return z[0]=$[0]*K+$[2]*te+$[4],z[1]=$[1]*K+$[3]*te+$[5],z},lt.transformMat3=function(z,G,$){var K=G[0],te=G[1];return z[0]=$[0]*K+$[3]*te+$[6],z[1]=$[1]*K+$[4]*te+$[7],z},lt.transformMat4=function(z,G,$){var K=G[0],te=G[1];return z[0]=$[0]*K+$[4]*te+$[12],z[1]=$[1]*K+$[5]*te+$[13],z},lt.rotate=function(z,G,$,K){var te=G[0]-$[0],ce=G[1]-$[1],he=Math.sin(K),ne=Math.cos(K);return z[0]=te*ne-ce*he+$[0],z[1]=te*he+ce*ne+$[1],z},lt.angle=function(z,G){var $=z[0],K=z[1],te=G[0],ce=G[1],he=Math.sqrt($*$+K*K)*Math.sqrt(te*te+ce*ce);return Math.acos(Math.min(Math.max(he&&($*te+K*ce)/he,-1),1))},lt.zero=function(z){return z[0]=0,z[1]=0,z},lt.str=function(z){return"vec2("+z[0]+", "+z[1]+")"},lt.exactEquals=function(z,G){return z[0]===G[0]&&z[1]===G[1]},lt.equals=function(z,G){var $=z[0],K=z[1],te=G[0],ce=G[1];return Math.abs($-te)<=c.EPSILON*Math.max(1,Math.abs($),Math.abs(te))&&Math.abs(K-ce)<=c.EPSILON*Math.max(1,Math.abs(K),Math.abs(ce))},lt.forEach=lt.sqrLen=lt.sqrDist=lt.dist=lt.div=lt.mul=lt.sub=lt.len=void 0;var c=function(z,G){if(z&&z.__esModule)return z;if(z===null||g(z)!=="object"&&typeof z!="function")return{default:z};var $=d(void 0);if($&&$.has(z))return $.get(z);var K={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in z)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(z,ce)){var he=te?Object.getOwnPropertyDescriptor(z,ce):null;he&&(he.get||he.set)?Object.defineProperty(K,ce,he):K[ce]=z[ce]}return K.default=z,$&&$.set(z,K),K}(y());function d(z){if(typeof WeakMap!="function")return null;var G=new WeakMap,$=new WeakMap;return(d=function(K){return K?$:G})(z)}function _(){var z=new c.ARRAY_TYPE(2);return c.ARRAY_TYPE!=Float32Array&&(z[0]=0,z[1]=0),z}function A(z,G,$){return z[0]=G[0]-$[0],z[1]=G[1]-$[1],z}function x(z,G,$){return z[0]=G[0]*$[0],z[1]=G[1]*$[1],z}function T(z,G,$){return z[0]=G[0]/$[0],z[1]=G[1]/$[1],z}function B(z,G){return Math.hypot(G[0]-z[0],G[1]-z[1])}function U(z,G){var $=G[0]-z[0],K=G[1]-z[1];return $*$+K*K}function j(z){return Math.hypot(z[0],z[1])}function R(z){var G=z[0],$=z[1];return G*G+$*$}lt.len=j,lt.sub=A,lt.mul=x,lt.div=T,lt.dist=B,lt.sqrDist=U,lt.sqrLen=R;var N,V=(N=_(),function(z,G,$,K,te,ce){var he,ne;for(G||(G=2),$||($=0),ne=K?Math.min(K*G+$,z.length):z.length,he=$;he<ne;he+=G)N[0]=z[he],N[1]=z[he+1],te(N,N,ce),z[he]=N[0],z[he+1]=N[1];return z});return lt.forEach=V,lt}function Qt(){if(Vt)return p;function g(z){return g=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(G){return typeof G}:function(G){return G&&typeof Symbol=="function"&&G.constructor===Symbol&&G!==Symbol.prototype?"symbol":typeof G},g(z)}Vt=1,Object.defineProperty(p,"__esModule",{value:!0}),p.vec4=p.vec3=p.vec2=p.quat2=p.quat=p.mat4=p.mat3=p.mat2d=p.mat2=p.glMatrix=void 0;var c=V(y());p.glMatrix=c;var d=V(M());p.mat2=d;var _=V(k());p.mat2d=_;var A=V(Z());p.mat3=A;var x=V(ie());p.mat4=x;var T=V(_e());p.quat=T;var B=V(vt());p.quat2=B;var U=V(Ht());p.vec2=U;var j=V(Ee());p.vec3=j;var R=V(st());function N(z){if(typeof WeakMap!="function")return null;var G=new WeakMap,$=new WeakMap;return(N=function(K){return K?$:G})(z)}function V(z,G){if(z&&z.__esModule)return z;if(z===null||g(z)!=="object"&&typeof z!="function")return{default:z};var $=N(G);if($&&$.has(z))return $.get(z);var K={},te=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var ce in z)if(ce!=="default"&&Object.prototype.hasOwnProperty.call(z,ce)){var he=te?Object.getOwnPropertyDescriptor(z,ce):null;he&&(he.get||he.set)?Object.defineProperty(K,ce,he):K[ce]=z[ce]}return K.default=z,$&&$.set(z,K),K}return p.vec4=R,p}var rn,jn,Bn,Tn,Le=Qt(),qe=function(){if(jn)return rn;function g(c,d,_,A){this.cx=3*c,this.bx=3*(_-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*d,this.by=3*(A-d)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=d,this.p2x=_,this.p2y=A}return jn=1,rn=g,g.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,d){if(d===void 0&&(d=1e-6),c<0)return 0;if(c>1)return 1;for(var _=c,A=0;A<8;A++){var x=this.sampleCurveX(_)-c;if(Math.abs(x)<d)return _;var T=this.sampleCurveDerivativeX(_);if(Math.abs(T)<1e-6)break;_-=x/T}var B=0,U=1;for(_=c,A=0;A<20&&(x=this.sampleCurveX(_),!(Math.abs(x-c)<d));A++)c>x?B=_:U=_,_=.5*(U-B)+B;return _},solve:function(c,d){return this.sampleCurveY(this.solveCurveX(c,d))}},rn}(),mn=h(qe);function cn(){if(Tn)return Bn;function g(c,d){this.x=c,this.y=d}return Tn=1,Bn=g,g.prototype={clone:function(){return new g(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,d){return this.clone()._rotateAround(c,d)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var d=c.x-this.x,_=c.y-this.y;return d*d+_*_},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,d){return Math.atan2(this.x*d-this.y*c,this.x*c+this.y*d)},_matMult:function(c){var d=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=d,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var d=Math.cos(c),_=Math.sin(c),A=_*this.x+d*this.y;return this.x=d*this.x-_*this.y,this.y=A,this},_rotateAround:function(c,d){var _=Math.cos(c),A=Math.sin(c),x=d.y+A*(this.x-d.x)+_*(this.y-d.y);return this.x=d.x+_*(this.x-d.x)-A*(this.y-d.y),this.y=x,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},g.convert=function(c){return c instanceof g?c:Array.isArray(c)?new g(c[0],c[1]):c},Bn}var St=h(cn());function Jt(g,c){if(Array.isArray(g)){if(!Array.isArray(c)||g.length!==c.length)return!1;for(let d=0;d<g.length;d++)if(!Jt(g[d],c[d]))return!1;return!0}if(typeof g=="object"&&g!==null&&c!==null){if(typeof c!="object"||Object.keys(g).length!==Object.keys(c).length)return!1;for(const d in g)if(!Jt(g[d],c[d]))return!1;return!0}return g===c}const kn=Math.PI/180,Gn=180/Math.PI;function sn(g){return g*kn}function ot(g){return g*Gn}const Ge=[[0,0],[1,0],[1,1],[0,1]];function Xt(g){if(g<=0)return 0;if(g>=1)return 1;const c=g*g,d=c*g;return 4*(g<.5?d:3*(g-c)+d-.75)}function An(g,c,d,_){const A=new mn(g,c,d,_);return function(x){return A.solve(x)}}const Sn=An(.25,.1,.25,1);function jt(g,c,d){return Math.min(d,Math.max(c,g))}function mr(g,c,d){return(d=jt((d-g)/(c-g),0,1))*d*(3-2*d)}function Un(g,c,d){const _=d-c,A=((g-c)%_+_)%_+c;return A===c?d:A}function tr(g,c,d){if(!g.length)return d(null,[]);let _=g.length;const A=new Array(g.length);let x=null;g.forEach((T,B)=>{c(T,(U,j)=>{U&&(x=U),A[B]=j,--_==0&&d(x,A)})})}function Sr(g,...c){for(const d of c)for(const _ in d)g[_]=d[_];return g}let Ln=1;function ir(){return Ln++}function ui(g){return g<=1?1:Math.pow(2,Math.ceil(Math.log(g)/Math.LN2))}function Fr(g,c){g.forEach(d=>{c[d]&&(c[d]=c[d].bind(c))})}function ar(g,c){return g.indexOf(c,g.length-c.length)!==-1}function Nr(g,c,d){const _={};for(const A in g)_[A]=c.call(this,g[A],A,g);return _}function Hr(g,c,d){const _={};for(const A in g)c.call(this,g[A],A,g)&&(_[A]=g[A]);return _}function xi(g){return Array.isArray(g)?g.map(xi):typeof g=="object"&&g?Nr(g,xi):g}const Fe={};function Lt(g){Fe[g]||(typeof console<"u"&&console.warn(g),Fe[g]=!0)}function Kt(g,c,d){return(d.y-g.y)*(c.x-g.x)>(c.y-g.y)*(d.x-g.x)}function un(g){let c=0;for(let d,_,A=0,x=g.length,T=x-1;A<x;T=A++)d=g[A],_=g[T],c+=(_.x-d.x)*(d.y+_.y);return c}function Cn([g,c,d]){const _=sn(c+90),A=sn(d);return{x:g*Math.cos(_)*Math.sin(A),y:g*Math.sin(_)*Math.sin(A),z:g*Math.cos(A),azimuthal:c,polar:d}}function Ar(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Vr(g){const c={};if(g.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(d,_,A,x)=>{const T=A||x;return c[_]=!T||T.toLowerCase(),""}),c["max-age"]){const d=parseInt(c["max-age"],10);isNaN(d)?delete c["max-age"]:c["max-age"]=d}return c}let hs,Ls=null;function hi(g,c){return[g[4*c],g[4*c+1],g[4*c+2],g[4*c+3]]}function Tt(g,c,d,_){for(;c<d;){const A=c+d>>1;g[A]<_?c=A+1:d=A}return c}function xe(g,c,d,_){for(;c<d;){const A=c+d>>1;g[A]<=_?c=A+1:d=A}return c}function Ce(g){return g>0?1/(1.001-g):1+g}function Xe(g){return g>0?1-1/(1.001-g):-g}const nt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(hs==null){const g=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{hs=t.API_URL_REGEX!=null?new RegExp(t.API_URL_REGEX):g}catch{hs=g}}return hs},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!nt.API_URL)return null;try{const g=new URL(nt.API_URL);return g.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":g.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Je(g){return nt.API_URL_REGEX.test(g)}function pt(g){return nt.API_SPRITE_REGEX.test(g)}let Rt,gt,Pt,zt,Bt,ln;function Mn(){return Rt==null&&(Rt=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Rt}const En={now:()=>zt!==void 0?zt:performance.now(),setNow(g){zt=g},restoreNow(){zt=void 0},frame(g){const c=requestAnimationFrame(g);return{cancel:()=>cancelAnimationFrame(c)}},getImageData(g,c=0){const{width:d,height:_}=g;Bt||(Bt=document.createElement("canvas"));const A=Bt.getContext("2d",{willReadFrequently:!0});if(!A)throw new Error("failed to create canvas 2d context");return(d>Bt.width||_>Bt.height)&&(Bt.width=d,Bt.height=_),A.clearRect(-c,-c,d+2*c,_+2*c),A.drawImage(g,0,0,d,_),A.getImageData(-c,-c,d+2*c,_+2*c)},resolveURL:g=>(gt||(gt=document.createElement("a")),gt.href=g,gt.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Pt==null&&(Pt=window.matchMedia("(prefers-reduced-motion: reduce)")),Pt.matches)},hasCanvasFingerprintNoise(){if(ln!==void 0)return ln;if(!Mn())return ln=!1,!1;const g=new OffscreenCanvas(85,1),c=g.getContext("2d",{willReadFrequently:!0});let d=0;for(let A=0;A<g.width;++A)c.fillStyle=`rgba(${d++},${d++},${d++}, 255)`,c.fillRect(A,0,1,1);const _=c.getImageData(0,0,g.width,g.height);d=0;for(let A=0;A<_.data.length;++A)if(A%4!=3&&d++!==_.data[A])return ln=!0,!0;return ln=!1,!1}};function Ve(g,c){const d=g.indexOf("?");if(d<0)return`${g}?${new URLSearchParams(c).toString()}`;const _=new URLSearchParams(g.slice(d));for(const A in c)_.set(A,c[A]);return`${g.slice(0,d)}?${_.toString()}`}function yt(g,c={persistentParams:[]}){const d=g.indexOf("?");if(d<0)return g;const _=new URLSearchParams,A=new URLSearchParams(g.slice(d));for(const T of c.persistentParams){const B=A.get(T);B&&_.set(T,B)}const x=_.toString();return`${g.slice(0,d)}${x.length>0?`?${x}`:""}`}const Mt="mapbox-tiles";let Et=500,It=50;const wn=["language","worldview","jobid"];let _n,zn;function $n(){try{return caches}catch{}}function lr(){const g=$n();g&&_n==null&&(_n=g.open(Mt))}let gr=1/0;const dr={supported:!1,testSupport:function(g){!ji&&Oi&&(As?Qn(g):fi=g)}};let fi,Oi,ji=!1,As=!1;const Cr=typeof self<"u"?self:{};function Qn(g){const c=g.createTexture();g.bindTexture(g.TEXTURE_2D,c);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Oi),g.isContextLost())return;dr.supported=!0}catch{}g.deleteTexture(c),ji=!0}Cr.document&&(Oi=Cr.document.createElement("img"),Oi.onload=function(){fi&&Qn(fi),fi=null,As=!0},Oi.onerror=function(){ji=!0,fi=null},Oi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Yi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Yi);class qr extends Error{constructor(c,d,_){d===401&&Je(_)&&(c+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(c),this.status=d,this.url=_}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ys=Ar()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,$a=function(g,c){if(!(/^file:/.test(d=g.url)||/^file:/.test(ys())&&!/^\w+:/.test(d))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(_,A){const x=new AbortController,T=new Request(_.url,{method:_.method||"GET",body:_.body,credentials:_.credentials,headers:_.headers,referrer:ys(),referrerPolicy:_.referrerPolicy,signal:x.signal});let B=!1,U=!1;const j=(R=T.url).indexOf("sku=")>0&&Je(R);var R;_.type==="json"&&T.headers.set("Accept","application/json");const N=(z,G,$)=>{if(U)return;if(z&&z.message!=="SecurityError"&&Lt(z.toString()),G&&$)return V(G);const K=Date.now();fetch(T).then(te=>{if(te.ok){const ce=j?te.clone():null;return V(te,ce,K)}return A(new qr(te.statusText,te.status,_.url))}).catch(te=>{te.name!=="AbortError"&&A(new Error(`${te.message} ${_.url}`))})},V=(z,G,$)=>{(_.type==="arrayBuffer"?z.arrayBuffer():_.type==="json"?z.json():z.text()).then(K=>{U||(G&&$&&function(te,ce,he){if(lr(),_n==null)return;const ne=Vr(ce.headers.get("Cache-Control")||"");if(ne["no-store"])return;const de={status:ce.status,statusText:ce.statusText,headers:new Headers};ce.headers.forEach((Be,Oe)=>de.headers.set(Oe,Be)),ne["max-age"]&&de.headers.set("Expires",new Date(he+1e3*ne["max-age"]).toUTCString());const ge=de.headers.get("Expires");if(!ge||new Date(ge).getTime()-he<42e4)return;let Me=yt(te.url,{persistentParams:wn});if(ce.status===206){const Be=te.headers.get("Range");if(!Be)return;de.status=200,Me=Ve(Me,{range:Be})}(function(Be,Oe){if(zn===void 0)try{new Response(new ReadableStream),zn=!0}catch{zn=!1}zn?Oe(Be.body):Be.blob().then(Oe)})(ce,Be=>{const Oe=new Response((Pe=ce.status)!==200&&Pe!==404&&[101,103,204,205,304].includes(Pe)?null:Be,de);var Pe;lr(),_n!=null&&_n.then(Ye=>Ye.put(Me,Oe)).catch(Ye=>Lt(Ye.message))})}(T,G,$),B=!0,A(null,K,z.headers.get("Cache-Control"),z.headers.get("Expires")))}).catch(K=>{U||A(new Error(K.message))})};return j?function(z,G){if(lr(),_n==null)return G(null);_n.then($=>{let K=yt(z.url,{persistentParams:wn});const te=z.headers.get("Range");te&&(K=Ve(K,{range:te})),$.match(K).then(ce=>{const he=function(ne){if(!ne)return!1;const de=new Date(ne.headers.get("Expires")||0),ge=Vr(ne.headers.get("Cache-Control")||"");return de>Date.now()&&!ge["no-cache"]}(ce);$.delete(K),he&&$.put(K,ce.clone()),G(null,ce,he)}).catch(G)}).catch(G)}(T,N):N(null,null),{cancel:()=>{U=!0,B||x.abort()}}}(g,c);if(Ar()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",g,c,void 0,!0)}var d;return function(_,A){const x=new XMLHttpRequest;x.open(_.method||"GET",_.url,!0),_.type==="arrayBuffer"&&(x.responseType="arraybuffer");for(const T in _.headers)x.setRequestHeader(T,_.headers[T]);return _.type==="json"&&(x.responseType="text",x.setRequestHeader("Accept","application/json")),x.withCredentials=_.credentials==="include",x.onerror=()=>{A(new Error(x.statusText))},x.onload=()=>{if((x.status>=200&&x.status<300||x.status===0)&&x.response!==null){let T=x.response;if(_.type==="json")try{T=JSON.parse(x.response)}catch(B){return A(B)}A(null,T,x.getResponseHeader("Cache-Control"),x.getResponseHeader("Expires"))}else A(new qr(x.statusText,x.status,_.url))},x.send(_.body),{cancel:()=>x.abort()}}(g,c)},Ds=function(g,c){return $a(Sr(g,{type:"arrayBuffer"}),c)};function fs(g){const c=document.createElement("a");return c.href=g,c.protocol===location.protocol&&c.host===location.host}const Li="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let oa,Pa;oa=[],Pa=0;const Ts=function(g,c){if(dr.supported&&(g.headers||(g.headers={}),g.headers.accept="image/webp,*/*"),Pa>=nt.MAX_PARALLEL_IMAGE_REQUESTS){const x={requestParameters:g,callback:c,cancelled:!1,cancel(){this.cancelled=!0}};return oa.push(x),x}Pa++;let d=!1;const _=()=>{if(!d)for(d=!0,Pa--;oa.length&&Pa<nt.MAX_PARALLEL_IMAGE_REQUESTS;){const x=oa.shift(),{requestParameters:T,callback:B,cancelled:U}=x;U||(x.cancel=Ts(T,B).cancel)}},A=Ds(g,(x,T,B,U)=>{_(),x?c(x):T&&(self.createImageBitmap?function(j,R){const N=new Blob([new Uint8Array(j)],{type:"image/png"});createImageBitmap(N).then(V=>{R(null,V)}).catch(V=>{R(new Error(`Could not load image because of ${V.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(T,(j,R)=>c(j,R,B,U)):function(j,R){const N=new Image;N.onload=()=>{R(null,N),URL.revokeObjectURL(N.src),N.onload=null,requestAnimationFrame(()=>{N.src=Li})},N.onerror=()=>R(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const V=new Blob([new Uint8Array(j)],{type:"image/png"});N.src=j.byteLength?URL.createObjectURL(V):Li}(T,(j,R)=>c(j,R,B,U)))});return{cancel:()=>{A.cancel(),_()}}};var Oc,Po,ud,Fc={exports:{}},cg={exports:{}},Ep={exports:{}},ug=function(){if(ud)return Fc.exports;ud=1;var g=(Oc||(Oc=1,cg.exports=function(d,_){var A,x,T,B,U,j,R,N;for(x=d.length-(A=3&d.length),T=_,U=3432918353,j=461845907,N=0;N<x;)R=255&d.charCodeAt(N)|(255&d.charCodeAt(++N))<<8|(255&d.charCodeAt(++N))<<16|(255&d.charCodeAt(++N))<<24,++N,T=27492+(65535&(B=5*(65535&(T=(T^=R=(65535&(R=(R=(65535&R)*U+(((R>>>16)*U&65535)<<16)&4294967295)<<15|R>>>17))*j+(((R>>>16)*j&65535)<<16)&4294967295)<<13|T>>>19))+((5*(T>>>16)&65535)<<16)&4294967295))+((58964+(B>>>16)&65535)<<16);switch(R=0,A){case 3:R^=(255&d.charCodeAt(N+2))<<16;case 2:R^=(255&d.charCodeAt(N+1))<<8;case 1:T^=R=(65535&(R=(R=(65535&(R^=255&d.charCodeAt(N)))*U+(((R>>>16)*U&65535)<<16)&4294967295)<<15|R>>>17))*j+(((R>>>16)*j&65535)<<16)&4294967295}return T^=d.length,T=2246822507*(65535&(T^=T>>>16))+((2246822507*(T>>>16)&65535)<<16)&4294967295,T=3266489909*(65535&(T^=T>>>13))+((3266489909*(T>>>16)&65535)<<16)&4294967295,(T^=T>>>16)>>>0}),cg.exports),c=(Po||(Po=1,Ep.exports=function(d,_){for(var A,x=d.length,T=_^x,B=0;x>=4;)A=1540483477*(65535&(A=255&d.charCodeAt(B)|(255&d.charCodeAt(++B))<<8|(255&d.charCodeAt(++B))<<16|(255&d.charCodeAt(++B))<<24))+((1540483477*(A>>>16)&65535)<<16),T=1540483477*(65535&T)+((1540483477*(T>>>16)&65535)<<16)^(A=1540483477*(65535&(A^=A>>>24))+((1540483477*(A>>>16)&65535)<<16)),x-=4,++B;switch(x){case 3:T^=(255&d.charCodeAt(B+2))<<16;case 2:T^=(255&d.charCodeAt(B+1))<<8;case 1:T=1540483477*(65535&(T^=255&d.charCodeAt(B)))+((1540483477*(T>>>16)&65535)<<16)}return T=1540483477*(65535&(T^=T>>>13))+((1540483477*(T>>>16)&65535)<<16),(T^=T>>>15)>>>0}),Ep.exports);return Fc.exports=g,Fc.exports.murmur3=g,Fc.exports.murmur2=c,Fc.exports}(),Xa=h(ug);class Ql{constructor(c,...d){Sr(this,d[0]||{}),this.type=c}}class Cp extends Ql{constructor(c,d={}){super("error",Sr({error:c},d))}}function hd(g,c,d){d[g]&&d[g].indexOf(c)!==-1||(d[g]=d[g]||[],d[g].push(c))}function Ip(g,c,d){if(d&&d[g]){const _=d[g].indexOf(c);_!==-1&&d[g].splice(_,1)}}class ju{on(c,d){return this._listeners=this._listeners||{},hd(c,d,this._listeners),this}off(c,d){return Ip(c,d,this._listeners),Ip(c,d,this._oneTimeListeners),this}once(c,d){return d?(this._oneTimeListeners=this._oneTimeListeners||{},hd(c,d,this._oneTimeListeners),this):new Promise(_=>this.once(c,_))}fire(c,d){const _=typeof c=="string"?new Ql(c,d):c,A=_.type;if(this.listens(A)){_.target=this;const x=this._listeners&&this._listeners[A]?this._listeners[A].slice():[];for(const U of x)U.call(this,_);const T=this._oneTimeListeners&&this._oneTimeListeners[A]?this._oneTimeListeners[A].slice():[];for(const U of T)Ip(A,U,this._oneTimeListeners),U.call(this,_);const B=this._eventedParent;B&&(Sr(_,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),B.fire(_))}else _ instanceof Cp&&console.error(_.error);return this}listens(c){return!!(this._listeners&&this._listeners[c]&&this._listeners[c].length>0||this._oneTimeListeners&&this._oneTimeListeners[c]&&this._oneTimeListeners[c].length>0||this._eventedParent&&this._eventedParent.listens(c))}setEventedParent(c,d){return this._eventedParent=c,this._eventedParentData=d,this}}var Hh,si={},Rp=function(){if(Hh)return si;Hh=1;var g={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function c(x){return(x=Math.round(x))<0?0:x>255?255:x}function d(x){return c(x[x.length-1]==="%"?parseFloat(x)/100*255:parseInt(x))}function _(x){return(T=x[x.length-1]==="%"?parseFloat(x)/100:parseFloat(x))<0?0:T>1?1:T;var T}function A(x,T,B){return B<0?B+=1:B>1&&(B-=1),6*B<1?x+(T-x)*B*6:2*B<1?T:3*B<2?x+(T-x)*(2/3-B)*6:x}try{si.parseCSSColor=function(x){var T,B=x.replace(/ /g,"").toLowerCase();if(B in g)return g[B].slice();if(B[0]==="#")return B.length===4?(T=parseInt(B.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:B.length===7&&(T=parseInt(B.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var U=B.indexOf("("),j=B.indexOf(")");if(U!==-1&&j+1===B.length){var R=B.substr(0,U),N=B.substr(U+1,j-(U+1)).split(","),V=1;switch(R){case"rgba":if(N.length!==4)return null;V=_(N.pop());case"rgb":return N.length!==3?null:[d(N[0]),d(N[1]),d(N[2]),V];case"hsla":if(N.length!==4)return null;V=_(N.pop());case"hsl":if(N.length!==3)return null;var z=(parseFloat(N[0])%360+360)%360/360,G=_(N[1]),$=_(N[2]),K=$<=.5?$*(G+1):$+G-$*G,te=2*$-K;return[c(255*A(te,K,z+1/3)),c(255*A(te,K,z)),c(255*A(te,K,z-1/3)),V];default:return null}}return null}}catch{}return si}();class vr{constructor(c,d,_,A=1){this.r=c,this.g=d,this.b=_,this.a=A}static parse(c){if(!c)return;if(c instanceof vr)return c;if(typeof c!="string")return;const d=Rp.parseCSSColor(c);return d?new vr(d[0]/255*d[3],d[1]/255*d[3],d[2]/255*d[3],d[3]):void 0}toString(){const[c,d,_,A]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(c)},${Math.round(d)},${Math.round(_)},${A})`}toRenderColor(c){const{r:d,g:_,b:A,a:x}=this;return new Rx(c,d,_,A,x)}}class Rx{constructor(c,d,_,A,x){if(c){const T=c.image.height,B=T*T;d=x===0?0:d/x*(T-1),_=x===0?0:_/x*(T-1),A=x===0?0:A/x*(T-1);const U=Math.floor(d),j=Math.floor(_),R=Math.floor(A),N=Math.ceil(d),V=Math.ceil(_),z=Math.ceil(A),G=d-U,$=_-j,K=A-R,te=c.image.data,ce=4*(U+j*B+R*T),he=4*(U+j*B+z*T),ne=4*(U+V*B+R*T),de=4*(U+V*B+z*T),ge=4*(N+j*B+R*T),Me=4*(N+j*B+z*T),Be=4*(N+V*B+R*T),Oe=4*(N+V*B+z*T);if(ce<0||Oe>=te.length)throw new Error("out of range");this.r=cr(cr(cr(te[ce],te[he],K),cr(te[ne],te[de],K),$),cr(cr(te[ge],te[Me],K),cr(te[Be],te[Oe],K),$),G)/255*x,this.g=cr(cr(cr(te[ce+1],te[he+1],K),cr(te[ne+1],te[de+1],K),$),cr(cr(te[ge+1],te[Me+1],K),cr(te[Be+1],te[Oe+1],K),$),G)/255*x,this.b=cr(cr(cr(te[ce+2],te[he+2],K),cr(te[ne+2],te[de+2],K),$),cr(cr(te[ge+2],te[Me+2],K),cr(te[Be+2],te[Oe+2],K),$),G)/255*x,this.a=x}else this.r=d,this.g=_,this.b=A,this.a=x}toArray(){const{r:c,g:d,b:_,a:A}=this;return A===0?[0,0,0,0]:[255*c/A,255*d/A,255*_/A,A]}toArray01(){const{r:c,g:d,b:_,a:A}=this;return A===0?[0,0,0,0]:[c/A,d/A,_/A,A]}toArray01Scaled(c){const{r:d,g:_,b:A,a:x}=this;return x===0?[0,0,0]:[d/x*c,_/x*c,A/x*c]}toArray01PremultipliedAlpha(){const{r:c,g:d,b:_,a:A}=this;return[c,d,_,A]}toArray01Linear(){const{r:c,g:d,b:_,a:A}=this;return A===0?[0,0,0,0]:[Math.pow(c/A,2.2),Math.pow(d/A,2.2),Math.pow(_/A,2.2),A]}}function cr(g,c,d){return g*(1-d)+c*d}function fd(g,c,d){return g.map((_,A)=>cr(_,c[A],d))}vr.black=new vr(0,0,0,1),vr.white=new vr(1,1,1,1),vr.transparent=new vr(0,0,0,0),vr.red=new vr(1,0,0,1),vr.blue=new vr(0,0,1,1);var jh=Object.freeze({__proto__:null,array:fd,color:function(g,c,d){return new vr(cr(g.r,c.r,d),cr(g.g,c.g,d),cr(g.b,c.b,d),cr(g.a,c.a,d))},number:cr});function dd(g,...c){for(const d of c)for(const _ in d)g[_]=d[_];return g}class bs extends Error{constructor(c,d){super(d),this.message=d,this.key=c}}class pd{constructor(c,d=[]){this.parent=c,this.bindings={};for(const[_,A]of d)this.bindings[_]=A}concat(c){return new pd(this,c)}get(c){if(this.bindings[c])return this.bindings[c];if(this.parent)return this.parent.get(c);throw new Error(`${c} not found in scope.`)}has(c){return!!this.bindings[c]||!!this.parent&&this.parent.has(c)}}const ec={kind:"null"},On={kind:"number"},ei={kind:"string"},Zr={kind:"boolean"},Gs={kind:"color"},vo={kind:"object"},ni={kind:"value"},ll={kind:"collator"},qo={kind:"formatted"},gu={kind:"resolvedImage"};function so(g,c){return{kind:"array",itemType:g,N:c}}function Ms(g){if(g.kind==="array"){const c=Ms(g.itemType);return typeof g.N=="number"?`array<${c}, ${g.N}>`:g.itemType.kind==="value"?"array":`array<${c}>`}return g.kind}const Px=[ec,On,ei,Zr,Gs,qo,vo,so(ni),gu];function Lo(g,c){if(c.kind==="error")return null;if(g.kind==="array"){if(c.kind==="array"&&(c.N===0&&c.itemType.kind==="value"||!Lo(g.itemType,c.itemType))&&(typeof g.N!="number"||g.N===c.N))return null}else{if(g.kind===c.kind)return null;if(g.kind==="value"){for(const d of Px)if(!Lo(d,c))return null}}return`Expected ${Ms(g)} but found ${Ms(c)} instead.`}function md(g,c){return c.some(d=>d.kind===g.kind)}function cl(g,c){return c.some(d=>d==="null"?g===null:d==="array"?Array.isArray(g):d==="object"?g&&!Array.isArray(g)&&typeof g=="object":d===typeof g)}class hg{constructor(c,d,_){this.sensitivity=c?d?"variant":"case":d?"accent":"base",this.locale=_,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(c,d){return this.collator.compare(c,d)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vs{constructor(c,d,_,A,x){this.text=c.normalize?c.normalize():c,this.image=d,this.scale=_,this.fontStack=A,this.textColor=x}}class La{constructor(c){this.sections=c}static fromString(c){return new La([new Vs(c,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(c=>c.text.length!==0||c.image&&c.image.namePrimary.length!==0)}static factory(c){return c instanceof La?c:La.fromString(c)}toString(){return this.sections.length===0?"":this.sections.map(c=>c.text).join("")}serialize(){const c=["format"];for(const d of this.sections){if(d.image){c.push(["image",d.image.namePrimary]);continue}c.push(d.text);const _={};d.fontStack&&(_["text-font"]=["literal",d.fontStack.split(",")]),d.scale&&(_["font-scale"]=d.scale),d.textColor&&(_["text-color"]=["rgba"].concat(d.textColor.toRenderColor(null).toArray())),c.push(_)}return c}}class qa{constructor(c){this.namePrimary=c.namePrimary,c.nameSecondary&&(this.nameSecondary=c.nameSecondary),this.available=c.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(c,d){return c?new qa({namePrimary:c,nameSecondary:d,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function Wh(g,c,d,_){return typeof g=="number"&&g>=0&&g<=255&&typeof c=="number"&&c>=0&&c<=255&&typeof d=="number"&&d>=0&&d<=255?_===void 0||typeof _=="number"&&_>=0&&_<=1?null:`Invalid rgba value [${[g,c,d,_].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof _=="number"?[g,c,d,_]:[g,c,d]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Nc(g){if(g===null||typeof g=="string"||typeof g=="boolean"||typeof g=="number"||g instanceof vr||g instanceof hg||g instanceof La||g instanceof qa)return!0;if(Array.isArray(g)){for(const c of g)if(!Nc(c))return!1;return!0}if(typeof g=="object"){for(const c in g)if(!Nc(g[c]))return!1;return!0}return!1}function Bs(g){if(g===null)return ec;if(typeof g=="string")return ei;if(typeof g=="boolean")return Zr;if(typeof g=="number")return On;if(g instanceof vr)return Gs;if(g instanceof hg)return ll;if(g instanceof La)return qo;if(g instanceof qa)return gu;if(Array.isArray(g)){const c=g.length;let d;for(const _ of g){const A=Bs(_);if(d){if(d===A)continue;d=ni;break}d=A}return so(d||ni,c)}return vo}function _o(g){const c=typeof g;return g===null?"":c==="string"||c==="number"||c==="boolean"?String(g):g instanceof vr||g instanceof La||g instanceof qa?g.toString():JSON.stringify(g)}class ul{constructor(c,d){this.type=c,this.value=d}static parse(c,d){if(c.length!==2)return d.error(`'literal' expression requires exactly one argument, but found ${c.length-1} instead.`);if(!Nc(c[1]))return d.error("invalid value");const _=c[1];let A=Bs(_);const x=d.expectedType;return A.kind!=="array"||A.N!==0||!x||x.kind!=="array"||typeof x.N=="number"&&x.N!==0||(A=x),new ul(A,_)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof vr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof La?this.value.serialize():this.value}}class Zs{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}}const Wu={string:ei,number:On,boolean:Zr,object:vo};class Ys{constructor(c,d){this.type=c,this.args=d}static parse(c,d){if(c.length<2)return d.error("Expected at least one argument.");let _,A=1;const x=c[0];if(x==="array"){let B,U;if(c.length>2){const j=c[1];if(typeof j!="string"||!(j in Wu)||j==="object")return d.error('The item type argument of "array" must be one of string, number, boolean',1);B=Wu[j],A++}else B=ni;if(c.length>3){if(c[2]!==null&&(typeof c[2]!="number"||c[2]<0||c[2]!==Math.floor(c[2])))return d.error('The length argument to "array" must be a positive integer literal',2);U=c[2],A++}_=so(B,U)}else _=Wu[x];const T=[];for(;A<c.length;A++){const B=d.parse(c[A],A,ni);if(!B)return null;T.push(B)}return new Ys(_,T)}evaluate(c){for(let d=0;d<this.args.length;d++){const _=this.args[d].evaluate(c);if(!Lo(this.type,Bs(_)))return _;if(d===this.args.length-1)throw new Zs(`The expression ${JSON.stringify(this.args[d].serialize())} evaluated to ${Ms(Bs(_))} but was expected to be of type ${Ms(this.type)}.`)}return null}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){const c=this.type,d=[c.kind];if(c.kind==="array"){const _=c.itemType;if(_.kind==="string"||_.kind==="number"||_.kind==="boolean"){d.push(_.kind);const A=c.N;(typeof A=="number"||this.args.length>1)&&d.push(A)}}return d.concat(this.args.map(_=>_.serialize()))}}class Do{constructor(c){this.type=qo,this.sections=c}static parse(c,d){if(c.length<2)return d.error("Expected at least one argument.");const _=c[1];if(!Array.isArray(_)&&typeof _=="object")return d.error("First argument must be an image or text section.");const A=[];let x=!1;for(let T=1;T<=c.length-1;++T){const B=c[T];if(x&&typeof B=="object"&&!Array.isArray(B)){x=!1;let U=null;if(B["font-scale"]&&(U=d.parseObjectValue(B["font-scale"],T,"font-scale",On),!U))return null;let j=null;if(B["text-font"]&&(j=d.parseObjectValue(B["text-font"],T,"text-font",so(ei)),!j))return null;let R=null;if(B["text-color"]&&(R=d.parseObjectValue(B["text-color"],T,"text-color",Gs),!R))return null;const N=A[A.length-1];N.scale=U,N.font=j,N.textColor=R}else{const U=d.parse(c[T],T,ni);if(!U)return null;const j=U.type.kind;if(j!=="string"&&j!=="value"&&j!=="null"&&j!=="resolvedImage")return d.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");x=!0,A.push({content:U,scale:null,font:null,textColor:null})}}return new Do(A)}evaluate(c){return new La(this.sections.map(d=>{const _=d.content.evaluate(c);return Bs(_)===gu?new Vs("",_,null,null,null):new Vs(_o(_),null,d.scale?d.scale.evaluate(c):null,d.font?d.font.evaluate(c).join(","):null,d.textColor?d.textColor.evaluate(c):null)}))}eachChild(c){for(const d of this.sections)c(d.content),d.scale&&c(d.scale),d.font&&c(d.font),d.textColor&&c(d.textColor)}outputDefined(){return!1}serialize(){const c=["format"];for(const d of this.sections){c.push(d.content.serialize());const _={};d.scale&&(_["font-scale"]=d.scale.serialize()),d.font&&(_["text-font"]=d.font.serialize()),d.textColor&&(_["text-color"]=d.textColor.serialize()),c.push(_)}return c}}class Zo{constructor(c,d){this.type=gu,this.inputPrimary=c,this.inputSecondary=d}static parse(c,d){if(c.length<2)return d.error("Expected two or more arguments.");const _=d.parse(c[1],1,ei);if(!_)return d.error("No image name provided.");if(c.length===2)return new Zo(_);const A=d.parse(c[2],1,ei);return A?new Zo(_,A):d.error("Secondary image variant is not a string.")}evaluate(c){const d=qa.fromString(this.inputPrimary.evaluate(c),this.inputSecondary?this.inputSecondary.evaluate(c):void 0);return d&&c.availableImages&&(d.available=c.availableImages.indexOf(d.namePrimary)>-1,d.nameSecondary&&d.available&&c.availableImages&&(d.available=c.availableImages.indexOf(d.nameSecondary)>-1)),d}eachChild(c){c(this.inputPrimary),this.inputSecondary&&c(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function vu(g){return g instanceof Number?"number":g instanceof String?"string":g instanceof Boolean?"boolean":Array.isArray(g)?"array":g===null?"null":typeof g}const Pp={"to-boolean":Zr,"to-color":Gs,"to-number":On,"to-string":ei};class ao{constructor(c,d){this.type=c,this.args=d}static parse(c,d){if(c.length<2)return d.error("Expected at least one argument.");const _=c[0],A=[];let x=ec;if(_==="to-array"){if(!Array.isArray(c[1]))return null;const T=c[1].length;if(d.expectedType){if(d.expectedType.kind!=="array")return d.error(`Expected ${d.expectedType.kind} but found array.`);x=so(d.expectedType.itemType,T)}else{if(!(T>0&&Nc(c[1][0])))return null;x=so(Bs(c[1][0]),T)}for(let B=0;B<T;B++){const U=c[1][B];let j;if(vu(U)==="array")j=d.parse(U,void 0,x.itemType);else{const R=vu(U);if(R!==x.itemType.kind)return d.error(`Expected ${x.itemType.kind} but found ${R}.`);j=d.registry.literal.parse(["literal",U===void 0?null:U],d)}if(!j)return null;A.push(j)}}else{if((_==="to-boolean"||_==="to-string")&&c.length!==2)return d.error("Expected one argument.");x=Pp[_];for(let T=1;T<c.length;T++){const B=d.parse(c[T],T,ni);if(!B)return null;A.push(B)}}return new ao(x,A)}evaluate(c){if(this.type.kind==="boolean")return!!this.args[0].evaluate(c);if(this.type.kind==="color"){let d,_;for(const A of this.args){if(d=A.evaluate(c),_=null,d instanceof vr)return d;if(typeof d=="string"){const x=c.parseColor(d);if(x)return x}else if(Array.isArray(d)&&(_=d.length<3||d.length>4?`Invalid rbga value ${JSON.stringify(d)}: expected an array containing either three or four numeric values.`:Wh(d[0],d[1],d[2],d[3]),!_))return new vr(d[0]/255,d[1]/255,d[2]/255,d[3])}throw new Zs(_||`Could not parse color from value '${typeof d=="string"?d:String(JSON.stringify(d))}'`)}if(this.type.kind==="number"){let d=null;for(const _ of this.args){if(d=_.evaluate(c),d===null)return 0;const A=Number(d);if(!isNaN(A))return A}throw new Zs(`Could not convert ${JSON.stringify(d)} to number.`)}return this.type.kind==="formatted"?La.fromString(_o(this.args[0].evaluate(c))):this.type.kind==="resolvedImage"?qa.fromString(_o(this.args[0].evaluate(c))):this.type.kind==="array"?this.args.map(d=>d.evaluate(c)):_o(this.args[0].evaluate(c))}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Do([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Zo(this.args[0]).serialize();const c=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(d=>{c.push(d.serialize())}),c}}const $u=["Unknown","Point","LineString","Polygon"];class Lp{constructor(c,d){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=c,this.options=d}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?$u[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(c){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,d=this.featureDistanceData.scale,{x:_,y:A}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(_*d-c[0])+this.featureDistanceData.bearing[1]*(A*d-c[1])}return 0}parseColor(c){let d=this._parseColorCache[c];return d||(d=this._parseColorCache[c]=vr.parse(c)),d}getConfig(c){return this.options?this.options.get(c):null}}class Bo{constructor(c,d,_,A,x){this.name=c,this.type=d,this._evaluate=_,this.args=A,this._overloadIndex=x}evaluate(c){if(!this._evaluate){const d=Bo.definitions[this.name];this._evaluate=Array.isArray(d)?d[2]:d.overloads[this._overloadIndex][1]}return this._evaluate(c,this.args)}eachChild(c){this.args.forEach(c)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(c=>c.serialize()))}static parse(c,d){const _=c[0],A=Bo.definitions[_];if(!A)return d.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0);const x=Array.isArray(A)?A[0]:A.type,T=Array.isArray(A)?[[A[1],A[2]]]:A.overloads,B=[];let U=null,j=-1;for(const[R,N]of T){if(Array.isArray(R)&&R.length!==c.length-1)continue;B.push(R),j++,U=new V0(d.registry,d.path,null,d.scope,void 0,d._scope,d.options);const V=[];let z=!1;for(let G=1;G<c.length;G++){const $=c[G],K=Array.isArray(R)?R[G-1]:R.type,te=U.parse($,1+V.length,K);if(!te){z=!0;break}V.push(te)}if(!z)if(Array.isArray(R)&&R.length!==V.length)U.error(`Expected ${R.length} arguments, but found ${V.length} instead.`);else{for(let G=0;G<V.length;G++){const $=Array.isArray(R)?R[G]:R.type,K=V[G];U.concat(G+1).checkSubtype($,K.type)}if(U.errors.length===0)return new Bo(_,x,N,V,j)}}if(B.length===1)d.errors.push(...U.errors);else{const R=(B.length?B:T.map(([V])=>V)).map(fg).join(" | "),N=[];for(let V=1;V<c.length;V++){const z=d.parse(c[V],1+N.length);if(!z)return null;N.push(Ms(z.type))}d.error(`Expected arguments of type ${R}, but found (${N.join(", ")}) instead.`)}return null}static register(c,d){Bo.definitions=d;for(const _ in d)c[_]=Bo}}function fg(g){return Array.isArray(g)?`(${g.map(Ms).join(", ")})`:`(${Ms(g.type)}...)`}class Dp{constructor(c,d,_){this.type=ll,this.locale=_,this.caseSensitive=c,this.diacriticSensitive=d}static parse(c,d){if(c.length!==2)return d.error("Expected one argument.");const _=c[1];if(typeof _!="object"||Array.isArray(_))return d.error("Collator options argument must be an object.");const A=_["case-sensitive"]===void 0?d.parse(!1,1,Zr):d.parseObjectValue(_["case-sensitive"],1,"case-sensitive",Zr);if(!A)return null;const x=_["diacritic-sensitive"]===void 0?d.parse(!1,1,Zr):d.parseObjectValue(_["diacritic-sensitive"],1,"diacritic-sensitive",Zr);if(!x)return null;let T=null;return _.locale&&(T=d.parseObjectValue(_.locale,1,"locale",ei),!T)?null:new Dp(A,x,T)}evaluate(c){return new hg(this.caseSensitive.evaluate(c),this.diacriticSensitive.evaluate(c),this.locale?this.locale.evaluate(c):null)}eachChild(c){c(this.caseSensitive),c(this.diacriticSensitive),this.locale&&c(this.locale)}outputDefined(){return!1}serialize(){const c={};return c["case-sensitive"]=this.caseSensitive.serialize(),c["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(c.locale=this.locale.serialize()),["collator",c]}}function U0(g,c,d=0,_=g.length-1,A=_u){for(;_>d;){if(_-d>600){const U=_-d+1,j=c-d+1,R=Math.log(U),N=.5*Math.exp(2*R/3),V=.5*Math.sqrt(R*N*(U-N)/U)*(j-U/2<0?-1:1);U0(g,c,Math.max(d,Math.floor(c-j*N/U+V)),Math.min(_,Math.floor(c+(U-j)*N/U+V)),A)}const x=g[c];let T=d,B=_;for(Xu(g,d,c),A(g[_],x)>0&&Xu(g,d,_);T<B;){for(Xu(g,T,B),T++,B--;A(g[T],x)<0;)T++;for(;A(g[B],x)>0;)B--}A(g[d],x)===0?Xu(g,d,B):(B++,Xu(g,B,_)),B<=c&&(d=B+1),c<=B&&(_=B-1)}}function Xu(g,c,d){const _=g[c];g[c]=g[d],g[d]=_}function _u(g,c){return g<c?-1:g>c?1:0}function Lx(g){let c=0;for(let d,_,A=0,x=g.length,T=x-1;A<x;T=A++)d=g[A],_=g[T],c+=(_.x-d.x)*(d.y+_.y);return c}function gd(g,c){g[0]=Math.min(g[0],c[0]),g[1]=Math.min(g[1],c[1]),g[2]=Math.max(g[2],c[0]),g[3]=Math.max(g[3],c[1])}function qu(g,c){return!(g[0]<=c[0]||g[2]>=c[2]||g[1]<=c[1]||g[3]>=c[3])}function G0(g,c,d){const _=g[0]-c[0],A=g[1]-c[1],x=g[0]-d[0],T=g[1]-d[1];return _*T-x*A==0&&_*x<=0&&A*T<=0}function tc(g,c,d=!1){let _=!1;for(let B=0,U=c.length;B<U;B++){const j=c[B];for(let R=0,N=j.length,V=N-1;R<N;V=R++){const z=j[V],G=j[R];if(G0(g,z,G))return d;(x=z)[1]>(A=g)[1]!=(T=G)[1]>A[1]&&A[0]<(T[0]-x[0])*(A[1]-x[1])/(T[1]-x[1])+x[0]&&(_=!_)}}var A,x,T;return _}function $h(g,c,d,_){const A=_[0]-d[0],x=_[1]-d[1],T=(g[0]-d[0])*x-A*(g[1]-d[1]),B=(c[0]-d[0])*x-A*(c[1]-d[1]);return T>0&&B<0||T<0&&B>0}function Xh(g,c,d,_){return(A=[_[0]-d[0],_[1]-d[1]])[0]*(x=[c[0]-g[0],c[1]-g[1]])[1]-A[1]*x[0]!=0&&!(!$h(g,c,d,_)||!$h(d,_,g,c));var A,x}const yo=8192;function Mr(g,c){const d=(180+g[0])/360,_=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+g[1]*Math.PI/360)))/360,A=Math.pow(2,c.z);return[Math.round(d*A*yo),Math.round(_*A*yo)]}function Xn(g,c){for(let d=0;d<c.length;d++)if(tc(g,c[d]))return!0;return!1}function yu(g,c,d){for(const _ of d)for(let A=0,x=_.length,T=x-1;A<x;T=A++)if(Xh(g,c,_[T],_[A]))return!0;return!1}function pr(g,c){for(let d=0;d<g.length;++d)if(!tc(g[d],c))return!1;for(let d=0;d<g.length-1;++d)if(yu(g[d],g[d+1],c))return!1;return!0}function nc(g,c){for(let d=0;d<c.length;d++)if(pr(g,c[d]))return!0;return!1}function rc(g,c,d){const _=[];for(let A=0;A<g.length;A++){const x=[];for(let T=0;T<g[A].length;T++){const B=Mr(g[A][T],d);gd(c,B),x.push(B)}_.push(x)}return _}function _r(g,c,d){const _=[];for(let A=0;A<g.length;A++){const x=rc(g[A],c,d);_.push(x)}return _}function Bp(g,c,d,_){if(g[0]<d[0]||g[0]>d[2]){const A=.5*_;let x=g[0]-d[0]>A?-_:d[0]-g[0]>A?_:0;x===0&&(x=g[0]-d[2]>A?-_:d[2]-g[0]>A?_:0),g[0]+=x}gd(c,g)}function vd(g,c,d,_){const A=Math.pow(2,_.z)*yo,x=[_.x*yo,_.y*yo],T=[];if(!g)return T;for(const B of g)for(const U of B){const j=[U.x+x[0],U.y+x[1]];Bp(j,c,d,A),T.push(j)}return T}function ko(g,c,d,_){const A=Math.pow(2,_.z)*yo,x=[_.x*yo,_.y*yo],T=[];if(!g)return T;for(const U of g){const j=[];for(const R of U){const N=[R.x+x[0],R.y+x[1]];gd(c,N),j.push(N)}T.push(j)}if(c[2]-c[0]<=A/2){(B=c)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const U of T)for(const j of U)Bp(j,c,d,A)}var B;return T}class xa{constructor(c,d){this.type=Zr,this.geojson=c,this.geometries=d}static parse(c,d){if(c.length!==2)return d.error(`'within' expression requires exactly one argument, but found ${c.length-1} instead.`);if(Nc(c[1])){const _=c[1];if(_.type==="FeatureCollection")for(let A=0;A<_.features.length;++A){const x=_.features[A].geometry.type;if(x==="Polygon"||x==="MultiPolygon")return new xa(_,_.features[A].geometry)}else if(_.type==="Feature"){const A=_.geometry.type;if(A==="Polygon"||A==="MultiPolygon")return new xa(_,_.geometry)}else if(_.type==="Polygon"||_.type==="MultiPolygon")return new xa(_,_)}return d.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(c){if(c.geometry()!=null&&c.canonicalID()!=null){if(c.geometryType()==="Point")return function(d,_){const A=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],T=d.canonicalID();if(!T)return!1;if(_.type==="Polygon"){const B=rc(_.coordinates,x,T),U=vd(d.geometry(),A,x,T);if(!qu(A,x))return!1;for(const j of U)if(!tc(j,B))return!1}if(_.type==="MultiPolygon"){const B=_r(_.coordinates,x,T),U=vd(d.geometry(),A,x,T);if(!qu(A,x))return!1;for(const j of U)if(!Xn(j,B))return!1}return!0}(c,this.geometries);if(c.geometryType()==="LineString")return function(d,_){const A=[1/0,1/0,-1/0,-1/0],x=[1/0,1/0,-1/0,-1/0],T=d.canonicalID();if(!T)return!1;if(_.type==="Polygon"){const B=rc(_.coordinates,x,T),U=ko(d.geometry(),A,x,T);if(!qu(A,x))return!1;for(const j of U)if(!pr(j,B))return!1}if(_.type==="MultiPolygon"){const B=_r(_.coordinates,x,T),U=ko(d.geometry(),A,x,T);if(!qu(A,x))return!1;for(const j of U)if(!nc(j,B))return!1}return!0}(c,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const ns={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},la=1/298.257223563,Yo=la*(2-la),qh=Math.PI/180;class Zh{static fromTile(c,d,_){const A=Math.PI*(1-2*(c+.5)/Math.pow(2,d)),x=Math.atan(.5*(Math.exp(A)-Math.exp(-A)))/qh;return new Zh(x,_)}static get units(){return ns}constructor(c,d){if(c===void 0)throw new Error("No latitude given.");if(d&&!ns[d])throw new Error(`Unknown unit ${d}. Use one of: ${Object.keys(ns).join(", ")}`);const _=6378.137*qh*(d?ns[d]:1),A=Math.cos(c*qh),x=1/(1-Yo*(1-A*A)),T=Math.sqrt(x);this.kx=_*T*A,this.ky=_*T*x*(1-Yo)}distance(c,d){const _=xs(c[0]-d[0])*this.kx,A=(c[1]-d[1])*this.ky;return Math.sqrt(_*_+A*A)}bearing(c,d){const _=xs(d[0]-c[0])*this.kx;return Math.atan2(_,(d[1]-c[1])*this.ky)/qh}destination(c,d,_){const A=_*qh;return this.offset(c,Math.sin(A)*d,Math.cos(A)*d)}offset(c,d,_){return[c[0]+d/this.kx,c[1]+_/this.ky]}lineDistance(c){let d=0;for(let _=0;_<c.length-1;_++)d+=this.distance(c[_],c[_+1]);return d}area(c){let d=0;for(let _=0;_<c.length;_++){const A=c[_];for(let x=0,T=A.length,B=T-1;x<T;B=x++)d+=xs(A[x][0]-A[B][0])*(A[x][1]+A[B][1])*(_?-1:1)}return Math.abs(d)/2*this.kx*this.ky}along(c,d){let _=0;if(d<=0)return c[0];for(let A=0;A<c.length-1;A++){const x=c[A],T=c[A+1],B=this.distance(x,T);if(_+=B,_>d)return ic(x,T,(d-(_-B))/B)}return c[c.length-1]}pointToSegmentDistance(c,d,_){let[A,x]=d,T=xs(_[0]-A)*this.kx,B=(_[1]-x)*this.ky;if(T!==0||B!==0){const U=(xs(c[0]-A)*this.kx*T+(c[1]-x)*this.ky*B)/(T*T+B*B);U>1?(A=_[0],x=_[1]):U>0&&(A+=T/this.kx*U,x+=B/this.ky*U)}return T=xs(c[0]-A)*this.kx,B=(c[1]-x)*this.ky,Math.sqrt(T*T+B*B)}pointOnLine(c,d){let _=1/0,A=c[0][0],x=c[0][1],T=0,B=0;for(let U=0;U<c.length-1;U++){let j=c[U][0],R=c[U][1],N=xs(c[U+1][0]-j)*this.kx,V=(c[U+1][1]-R)*this.ky,z=0;N===0&&V===0||(z=(xs(d[0]-j)*this.kx*N+(d[1]-R)*this.ky*V)/(N*N+V*V),z>1?(j=c[U+1][0],R=c[U+1][1]):z>0&&(j+=N/this.kx*z,R+=V/this.ky*z)),N=xs(d[0]-j)*this.kx,V=(d[1]-R)*this.ky;const G=N*N+V*V;G<_&&(_=G,A=j,x=R,T=U,B=z)}return{point:[A,x],index:T,t:Math.max(0,Math.min(1,B))}}lineSlice(c,d,_){let A=this.pointOnLine(_,c),x=this.pointOnLine(_,d);if(A.index>x.index||A.index===x.index&&A.t>x.t){const j=A;A=x,x=j}const T=[A.point],B=A.index+1,U=x.index;!_d(_[B],T[0])&&B<=U&&T.push(_[B]);for(let j=B+1;j<=U;j++)T.push(_[j]);return _d(_[U],x.point)||T.push(x.point),T}lineSliceAlong(c,d,_){let A=0;const x=[];for(let T=0;T<_.length-1;T++){const B=_[T],U=_[T+1],j=this.distance(B,U);if(A+=j,A>c&&x.length===0&&x.push(ic(B,U,(c-(A-j))/j)),A>=d)return x.push(ic(B,U,(d-(A-j))/j)),x;A>c&&x.push(U)}return x}bufferPoint(c,d){const _=d/this.ky,A=d/this.kx;return[c[0]-A,c[1]-_,c[0]+A,c[1]+_]}bufferBBox(c,d){const _=d/this.ky,A=d/this.kx;return[c[0]-A,c[1]-_,c[2]+A,c[3]+_]}insideBBox(c,d){return xs(c[0]-d[0])>=0&&xs(c[0]-d[2])<=0&&c[1]>=d[1]&&c[1]<=d[3]}}function _d(g,c){return g[0]===c[0]&&g[1]===c[1]}function ic(g,c,d){const _=xs(c[0]-g[0]);return[g[0]+_*d,g[1]+(c[1]-g[1])*d]}function xs(g){for(;g<-180;)g+=360;for(;g>180;)g-=360;return g}class Yh{constructor(c=[],d=(_,A)=>_<A?-1:_>A?1:0){if(this.data=c,this.length=this.data.length,this.compare=d,this.length>0)for(let _=(this.length>>1)-1;_>=0;_--)this._down(_)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(this.length===0)return;const c=this.data[0],d=this.data.pop();return--this.length>0&&(this.data[0]=d,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:d,compare:_}=this,A=d[c];for(;c>0;){const x=c-1>>1,T=d[x];if(_(A,T)>=0)break;d[c]=T,c=x}d[c]=A}_down(c){const{data:d,compare:_}=this,A=this.length>>1,x=d[c];for(;c<A;){let T=1+(c<<1);const B=T+1;if(B<this.length&&_(d[B],d[T])<0&&(T=B),_(d[T],x)>=0)break;d[c]=d[T],c=T}d[c]=x}}var yn=8192;function dg(g,c){return c.dist-g.dist}const zc=100,Kh=50;function kp(g){const c=[1/0,1/0,-1/0,-1/0];if(c.length!==g.length)return!1;for(let d=0;d<c.length;d++)if(c[d]!==g[d])return!1;return!0}function Op(g){return g[1]-g[0]+1}function Ko(g,c){const d=g[1]>=g[0]&&g[1]<c;return d||console.warn("Distance Expression: Index is out of range"),d}function pg(g,c){if(g[0]>g[1])return[null,null];const d=Op(g);if(c){if(d===2)return[g,null];const _=Math.floor(d/2);return[[g[0],g[0]+_],[g[0]+_,g[1]]]}{if(d===1)return[g,null];const _=Math.floor(d/2)-1;return[[g[0],g[0]+_],[g[0]+_+1,g[1]]]}}function oo(g,c){const d=[1/0,1/0,-1/0,-1/0];if(!Ko(c,g.length))return d;for(let _=c[0];_<=c[1];++_)gd(d,g[_]);return d}function Oo(g){const c=[1/0,1/0,-1/0,-1/0];for(let d=0;d<g.length;++d)for(let _=0;_<g[d].length;++_)gd(c,g[d][_]);return c}function Uc(g,c,d){if(kp(g)||kp(c))return NaN;let _=0,A=0;return g[2]<c[0]&&(_=c[0]-g[2]),g[0]>c[2]&&(_=g[0]-c[2]),g[1]>c[3]&&(A=g[1]-c[3]),g[3]<c[1]&&(A=c[1]-g[3]),d.distance([0,0],[_,A])}function Jh(g){return 360*g-180}function sc(g){return 360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90}function Fo(g,c){const d=Math.pow(2,c.z),_=(g.y/yn+c.y)/d;return[Jh((g.x/yn+c.x)/d),sc(_)]}function Qh(g,c){const d=[];for(let _=0;_<g.length;++_)d.push(Fo(g[_],c));return d}function mg(g,c,d){const _=d.pointOnLine(c,g).point;return d.distance(g,_)}function Fp(g,c,d,_,A){const x=d.slice(_[0],_[1]+1);let T=1/0;for(let B=c[0];B<=c[1];++B)if((T=Math.min(T,mg(g[B],x,A)))===0)return 0;return T}function Es(g,c,d,_,A){const x=Math.min(A.pointToSegmentDistance(g,d,_),A.pointToSegmentDistance(c,d,_)),T=Math.min(A.pointToSegmentDistance(d,g,c),A.pointToSegmentDistance(_,g,c));return Math.min(x,T)}function Np(g,c,d,_,A){if(!Ko(c,g.length)||!Ko(_,d.length))return NaN;let x=1/0;for(let T=c[0];T<c[1];++T)for(let B=_[0];B<_[1];++B){if(Xh(g[T],g[T+1],d[B],d[B+1]))return 0;x=Math.min(x,Es(g[T],g[T+1],d[B],d[B+1],A))}return x}function gg(g,c,d,_,A){if(!Ko(c,g.length)||!Ko(_,d.length))return NaN;let x=1/0;for(let T=c[0];T<=c[1];++T)for(let B=_[0];B<=_[1];++B)if((x=Math.min(x,A.distance(g[T],d[B])))===0)return x;return x}function vg(g,c,d){if(tc(g,c,!0))return 0;let _=1/0;for(const A of c){const x=A.length;if(x<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(A[0]!==A[x-1]&&(_=Math.min(_,d.pointToSegmentDistance(g,A[x-1],A[0])))===0||(_=Math.min(_,mg(g,A,d)))===0)return _}return _}function zp(g,c,d,_){if(!Ko(c,g.length))return NaN;for(let x=c[0];x<=c[1];++x)if(tc(g[x],d,!0))return 0;let A=1/0;for(let x=c[0];x<c[1];++x)for(const T of d)for(let B=0,U=T.length,j=U-1;B<U;j=B++){if(Xh(g[x],g[x+1],T[j],T[B]))return 0;A=Math.min(A,Es(g[x],g[x+1],T[j],T[B],_))}return A}function Jo(g,c){for(const d of g)for(let _=0;_<=d.length-1;++_)if(tc(d[_],c,!0))return!0;return!1}function ef(g,c,d,_=1/0){const A=Oo(g),x=Oo(c);if(_!==1/0&&Uc(A,x,d)>=_)return _;if(qu(A,x)){if(Jo(g,c))return 0}else if(Jo(c,g))return 0;let T=_;for(const B of g)for(let U=0,j=B.length,R=j-1;U<j;R=U++)for(const N of c)for(let V=0,z=N.length,G=z-1;V<z;G=V++){if(Xh(B[R],B[U],N[G],N[V]))return 0;T=Math.min(T,Es(B[R],B[U],N[G],N[V],d))}return T}function Cs(g,c,d,_,A,x,T){if(x===null||T===null)return;const B=Uc(oo(_,x),oo(A,T),d);B<c&&g.push({dist:B,range1:x,range2:T})}function Da(g,c,d,_,A=1/0){let x=Math.min(_.distance(g[0],d[0][0]),A);if(x===0)return x;const T=new Yh([{dist:0,range1:[0,g.length-1],range2:[0,0]}],dg),B=c?Kh:zc,U=Oo(d);for(;T.length;){const j=T.pop();if(j.dist>=x)continue;const R=j.range1;if(Op(R)<=B){if(!Ko(R,g.length))return NaN;if(c){const N=zp(g,R,d,_);if((x=Math.min(x,N))===0)return x}else for(let N=R[0];N<=R[1];++N){const V=vg(g[N],d,_);if((x=Math.min(x,V))===0)return x}}else{const N=pg(R,c);if(N[0]!==null){const V=Uc(oo(g,N[0]),U,_);V<x&&T.push({dist:V,range1:N[0],range2:[0,0]})}if(N[1]!==null){const V=Uc(oo(g,N[1]),U,_);V<x&&T.push({dist:V,range1:N[1],range2:[0,0]})}}}return x}function Ks(g,c,d,_,A,x=1/0){let T=Math.min(x,A.distance(g[0],d[0]));if(T===0)return T;const B=new Yh([{dist:0,range1:[0,g.length-1],range2:[0,d.length-1]}],dg),U=c?Kh:zc,j=_?Kh:zc;for(;B.length;){const R=B.pop();if(R.dist>=T)continue;const N=R.range1,V=R.range2;if(Op(N)<=U&&Op(V)<=j){if(!Ko(N,g.length)||!Ko(V,d.length))return NaN;if(c&&_?T=Math.min(T,Np(g,N,d,V,A)):c||_?c&&!_?T=Math.min(T,Fp(d,V,g,N,A)):!c&&_&&(T=Math.min(T,Fp(g,N,d,V,A))):T=Math.min(T,gg(g,N,d,V,A)),T===0)return T}else{const z=pg(N,c),G=pg(V,_);Cs(B,T,A,g,d,z[0],G[0]),Cs(B,T,A,g,d,z[0],G[1]),Cs(B,T,A,g,d,z[1],G[0]),Cs(B,T,A,g,d,z[1],G[1])}}return T}function xu(g,c,d,_,A=1/0){let x=A;const T=oo(g,[0,g.length-1]);for(const B of d)if(!(x!==1/0&&Uc(T,oo(B,[0,B.length-1]),_)>=x)&&(x=Math.min(x,Ks(g,c,B,!0,_,x)),x===0))return x;return x}function bu(g,c,d,_,A=1/0){let x=A;const T=oo(g,[0,g.length-1]);for(const B of d){if(x!==1/0&&Uc(T,Oo(B),_)>=x)continue;const U=Da(g,c,B,_,x);if(isNaN(U))return U;if((x=Math.min(x,U))===0)return x}return x}function Zu(g){return g==="Point"||g==="MultiPoint"||g==="LineString"||g==="MultiLineString"||g==="Polygon"||g==="MultiPolygon"}class Yu{constructor(c,d){this.type=On,this.geojson=c,this.geometries=d}static parse(c,d){if(c.length!==2)return d.error(`'distance' expression requires either one argument, but found ' ${c.length-1} instead.`);if(Nc(c[1])){const _=c[1];if(_.type==="FeatureCollection"){for(let A=0;A<_.features.length;++A)if(Zu(_.features[A].geometry.type))return new Yu(_,_.features[A].geometry)}else if(_.type==="Feature"){if(Zu(_.geometry.type))return new Yu(_,_.geometry)}else if(Zu(_.type))return new Yu(_,_)}return d.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(c){const d=c.geometry(),_=c.canonicalID();if(d!=null&&_!=null){if(c.geometryType()==="Point")return function(A,x,T){const B=[];for(const j of A)for(const R of j)B.push(Fo(R,x));const U=new Zh(B[0][1],"meters");return T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString"?Ks(B,!1,T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",U):T.type==="MultiLineString"?xu(B,!1,T.coordinates,U):T.type==="Polygon"||T.type==="MultiPolygon"?bu(B,!1,T.type==="Polygon"?[T.coordinates]:T.coordinates,U):null}(d,_,this.geometries);if(c.geometryType()==="LineString")return function(A,x,T){const B=[];for(const j of A){const R=[];for(const N of j)R.push(Fo(N,x));B.push(R)}const U=new Zh(B[0][0][1],"meters");if(T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString")return xu(T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",B,U);if(T.type==="MultiLineString"){let j=1/0;for(let R=0;R<T.coordinates.length;R++){const N=xu(T.coordinates[R],!0,B,U,j);if(isNaN(N))return N;if((j=Math.min(j,N))===0)return j}return j}if(T.type==="Polygon"||T.type==="MultiPolygon"){let j=1/0;for(let R=0;R<B.length;R++){const N=bu(B[R],!0,T.type==="Polygon"?[T.coordinates]:T.coordinates,U,j);if(isNaN(N))return N;if((j=Math.min(j,N))===0)return j}return j}return null}(d,_,this.geometries);if(c.geometryType()==="Polygon")return function(A,x,T){const B=[];for(const j of function(R,N){const V=R.length;if(V<=1)return[R];const z=[];let G,$;for(let K=0;K<V;K++){const te=Lx(R[K]);te!==0&&(R[K].area=Math.abs(te),$===void 0&&($=te<0),$===te<0?(G&&z.push(G),G=[R[K]]):G.push(R[K]))}return G&&z.push(G),z}(A)){const R=[];for(let N=0;N<j.length;++N)R.push(Qh(j[N],x));B.push(R)}const U=new Zh(B[0][0][0][1],"meters");if(T.type==="Point"||T.type==="MultiPoint"||T.type==="LineString")return bu(T.type==="Point"?[T.coordinates]:T.coordinates,T.type==="LineString",B,U);if(T.type==="MultiLineString"){let j=1/0;for(let R=0;R<T.coordinates.length;R++){const N=bu(T.coordinates[R],!0,B,U,j);if(isNaN(N))return N;if((j=Math.min(j,N))===0)return j}return j}return T.type==="Polygon"||T.type==="MultiPolygon"?function(j,R,N){let V=1/0;for(const z of j)for(const G of R){const $=ef(z,G,N,V);if(isNaN($))return $;if((V=Math.min(V,$))===0)return V}return V}(T.type==="Polygon"?[T.coordinates]:T.coordinates,B,U):null}(d,_,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Hs(g,c){switch(g){case"string":return _o(c);case"number":return+c;case"boolean":return!!c;case"color":return vr.parse(c);case"formatted":return La.fromString(_o(c));case"resolvedImage":return qa.fromString(_o(c))}return c}function Kr(g,c,d,_){return _!==void 0&&(g=_*Math.round(g/_)),c!==void 0&&g<c&&(g=c),d!==void 0&&g>d&&(g=d),g}class Ku{constructor(c,d,_){this.type=c,this.key=d,this.scope=_}static parse(c,d){let _=d.expectedType;if(_==null&&(_=ni),c.length<2||c.length>3)return d.error("Invalid number of arguments for 'config' expression.");const A=d.parse(c[1],1);if(!(A instanceof ul))return d.error("Key name of 'config' expression must be a string literal.");if(c.length>=3){const x=d.parse(c[2],2);return x instanceof ul?new Ku(_,_o(A.value),_o(x.value)):d.error("Scope of 'config' expression must be a string literal.")}return new Ku(_,_o(A.value))}evaluate(c){const d=[this.key,this.scope,c.scope].filter(Boolean).join(""),_=c.getConfig(d);if(!_)return null;const{type:A,value:x,values:T,minValue:B,maxValue:U,stepValue:j}=_,R=_.default.evaluate(c);let N=R;if(x){const V=c.scope;c.scope=(V||"").split("").slice(1).join(""),N=x.evaluate(c),c.scope=V}return A&&(N=Hs(A,N)),N===void 0||B===void 0&&U===void 0&&j===void 0||(typeof N=="number"?N=Kr(N,B,U,j):Array.isArray(N)&&(N=N.map(V=>typeof V=="number"?Kr(V,B,U,j):V))),x!==void 0&&N!==void 0&&T&&!T.includes(N)&&(N=R,A&&(N=Hs(A,N))),(A&&A!==this.type||N!==void 0&&Bs(N)!==this.type)&&(N=Hs(this.type.kind,N)),N}eachChild(){}outputDefined(){return!1}serialize(){const c=["config",this.key];return this.scope&&c.concat(this.key),c}}function tf(g){if(g instanceof Bo&&(g.name==="get"&&g.args.length===1||g.name==="feature-state"||g.name==="has"&&g.args.length===1||g.name==="properties"||g.name==="geometry-type"||g.name==="id"||/^filter-/.test(g.name))||g instanceof xa||g instanceof Yu)return!1;let c=!0;return g.eachChild(d=>{c&&!tf(d)&&(c=!1)}),c}function Cl(g){if(g instanceof Bo&&g.name==="feature-state")return!1;let c=!0;return g.eachChild(d=>{c&&!Cl(d)&&(c=!1)}),c}function hl(g){if(g instanceof Ku)return new Set([g.key]);let c=new Set;return g.eachChild(d=>{c=new Set([...c,...hl(d)])}),c}function ac(g,c){if(g instanceof Bo&&c.indexOf(g.name)>=0)return!1;let d=!0;return g.eachChild(_=>{d&&!ac(_,c)&&(d=!1)}),d}class bi{constructor(c,d){this.type=d.type,this.name=c,this.boundExpression=d}static parse(c,d){if(c.length!==2||typeof c[1]!="string")return d.error("'var' expression requires exactly one string literal argument.");const _=c[1];return d.scope.has(_)?new bi(_,d.scope.get(_)):d.error(`Unknown variable "${_}". Make sure "${_}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(c){return this.boundExpression.evaluate(c)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class yd{constructor(c,d=[],_,A=new pd,x=[],T,B){this.registry=c,this.path=d,this.key=d.map(U=>typeof U=="string"?`['${U}']`:`[${U}]`).join(""),this.scope=A,this.errors=x,this.expectedType=_,this._scope=T,this.options=B}parse(c,d,_,A,x={}){return d||_?this.concat(d,null,_,A)._parse(c,x):this._parse(c,x)}parseObjectValue(c,d,_,A,x,T={}){return this.concat(d,_,A,x)._parse(c,T)}_parse(c,d){function _(A,x,T){return T==="assert"?new Ys(x,[A]):T==="coerce"?new ao(x,[A]):A}if(c!==null&&typeof c!="string"&&typeof c!="boolean"&&typeof c!="number"||(c=["literal",c]),Array.isArray(c)){if(c.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const A=typeof c[0]=="string"?this.registry[c[0]]:void 0;if(A){let x=A.parse(c,this);if(!x)return null;if(this.expectedType){const T=this.expectedType,B=x.type;if(T.kind!=="string"&&T.kind!=="number"&&T.kind!=="boolean"&&T.kind!=="object"&&T.kind!=="array"||B.kind!=="value")if(T.kind!=="color"&&T.kind!=="formatted"&&T.kind!=="resolvedImage"||B.kind!=="value"&&B.kind!=="string"){if(this.checkSubtype(T,B))return null}else x=_(x,T,d.typeAnnotation||"coerce");else x=_(x,T,d.typeAnnotation||"assert")}if(!(x instanceof ul)&&x.type.kind!=="resolvedImage"&&_g(x)){const T=new Lp(this._scope,this.options);try{x=new ul(x.type,x.evaluate(T))}catch(B){return this.error(B.message),null}}return x}return ao.parse(["to-array",c],this)}return this.error(c===void 0?"'undefined' value invalid. Use null instead.":typeof c=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof c} instead.`)}concat(c,d,_,A){let x=typeof c=="number"?this.path.concat(c):this.path;x=typeof d=="string"?x.concat(d):x;const T=A?this.scope.concat(A):this.scope;return new yd(this.registry,x,_||null,T,this.errors,this._scope,this.options)}error(c,...d){const _=`${this.key}${d.map(A=>`[${A}]`).join("")}`;this.errors.push(new bs(_,c))}checkSubtype(c,d){const _=Lo(c,d);return _&&this.error(_),_}}var V0=yd;function _g(g){if(g instanceof bi)return _g(g.boundExpression);if(g instanceof Bo&&g.name==="error"||g instanceof Dp||g instanceof xa||g instanceof Yu||g instanceof Ku)return!1;const c=g instanceof ao||g instanceof Ys;let d=!0;return g.eachChild(_=>{d=c?d&&_g(_):d&&_ instanceof ul}),!!d&&tf(g)&&ac(g,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Up(g,c){const d=g.length-1;let _,A,x=0,T=d,B=0;for(;x<=T;)if(B=Math.floor((x+T)/2),_=g[B],A=g[B+1],_<=c){if(B===d||c<A)return B;x=B+1}else{if(!(_>c))throw new Zs("Input is not a number.");T=B-1}return 0}class xd{constructor(c,d,_){this.type=c,this.input=d,this.labels=[],this.outputs=[];for(const[A,x]of _)this.labels.push(A),this.outputs.push(x)}static parse(c,d){if(c.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");const _=d.parse(c[1],1,On);if(!_)return null;const A=[];let x=null;d.expectedType&&d.expectedType.kind!=="value"&&(x=d.expectedType);for(let T=1;T<c.length;T+=2){const B=T===1?-1/0:c[T],U=c[T+1],j=T,R=T+1;if(typeof B!="number")return d.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(A.length&&A[A.length-1][0]>=B)return d.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',j);const N=d.parse(U,R,x);if(!N)return null;x=x||N.type,A.push([B,N])}return new xd(x,_,A)}evaluate(c){const d=this.labels,_=this.outputs;if(d.length===1)return _[0].evaluate(c);const A=this.input.evaluate(c);if(A<=d[0])return _[0].evaluate(c);const x=d.length;return A>=d[x-1]?_[x-1].evaluate(c):_[Up(d,A)].evaluate(c)}eachChild(c){c(this.input);for(const d of this.outputs)c(d)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}serialize(){const c=["step",this.input.serialize()];for(let d=0;d<this.labels.length;d++)d>0&&c.push(this.labels[d]),c.push(this.outputs[d].serialize());return c}}const H0=.95047,j0=1.08883,yg=4/29,Gc=6/29,W0=3*Gc*Gc,xg=Gc*Gc*Gc,bg=Math.PI/180,$0=180/Math.PI;function nf(g){return g>xg?Math.pow(g,1/3):g/W0+yg}function wg(g){return g>Gc?g*g*g:W0*(g-yg)}function Sg(g){return 255*(g<=.0031308?12.92*g:1.055*Math.pow(g,1/2.4)-.055)}function Ag(g){return(g/=255)<=.04045?g/12.92:Math.pow((g+.055)/1.055,2.4)}function X0(g){const c=Ag(g.r),d=Ag(g.g),_=Ag(g.b),A=nf((.4124564*c+.3575761*d+.1804375*_)/H0),x=nf((.2126729*c+.7151522*d+.072175*_)/1);return{l:116*x-16,a:500*(A-x),b:200*(x-nf((.0193339*c+.119192*d+.9503041*_)/j0)),alpha:g.a}}function Tg(g){let c=(g.l+16)/116,d=isNaN(g.a)?c:c+g.a/500,_=isNaN(g.b)?c:c-g.b/200;return c=1*wg(c),d=H0*wg(d),_=j0*wg(_),new vr(Sg(3.2404542*d-1.5371385*c-.4985314*_),Sg(-.969266*d+1.8760108*c+.041556*_),Sg(.0556434*d-.2040259*c+1.0572252*_),g.alpha)}function Dx(g,c,d){const _=c-g;return g+d*(_>180||_<-180?_-360*Math.round(_/360):_)}const bd={forward:X0,reverse:Tg,interpolate:function(g,c,d){return{l:cr(g.l,c.l,d),a:cr(g.a,c.a,d),b:cr(g.b,c.b,d),alpha:cr(g.alpha,c.alpha,d)}}},Gp={forward:function(g){const{l:c,a:d,b:_}=X0(g),A=Math.atan2(_,d)*$0;return{h:A<0?A+360:A,c:Math.sqrt(d*d+_*_),l:c,alpha:g.a}},reverse:function(g){const c=g.h*bg,d=g.c;return Tg({l:g.l,a:Math.cos(c)*d,b:Math.sin(c)*d,alpha:g.alpha})},interpolate:function(g,c,d){return{h:Dx(g.h,c.h,d),c:cr(g.c,c.c,d),l:cr(g.l,c.l,d),alpha:cr(g.alpha,c.alpha,d)}}};var q0=Object.freeze({__proto__:null,hcl:Gp,lab:bd});class fl{constructor(c,d,_,A,x){this.type=c,this.operator=d,this.interpolation=_,this.input=A,this.labels=[],this.outputs=[];for(const[T,B]of x)this.labels.push(T),this.outputs.push(B)}static interpolationFactor(c,d,_,A){let x=0;if(c.name==="exponential")x=Z0(d,c.base,_,A);else if(c.name==="linear")x=Z0(d,1,_,A);else if(c.name==="cubic-bezier"){const T=c.controlPoints;x=new mn(T[0],T[1],T[2],T[3]).solve(Z0(d,1,_,A))}return x}static parse(c,d){let[_,A,x,...T]=c;if(!Array.isArray(A)||A.length===0)return d.error("Expected an interpolation type expression.",1);if(A[0]==="linear")A={name:"linear"};else if(A[0]==="exponential"){const j=A[1];if(typeof j!="number")return d.error("Exponential interpolation requires a numeric base.",1,1);A={name:"exponential",base:j}}else{if(A[0]!=="cubic-bezier")return d.error(`Unknown interpolation type ${String(A[0])}`,1,0);{const j=A.slice(1);if(j.length!==4||j.some(R=>typeof R!="number"||R<0||R>1))return d.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);A={name:"cubic-bezier",controlPoints:j}}}if(c.length-1<4)return d.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if((c.length-1)%2!=0)return d.error("Expected an even number of arguments.");if(x=d.parse(x,2,On),!x)return null;const B=[];let U=null;_==="interpolate-hcl"||_==="interpolate-lab"?U=Gs:d.expectedType&&d.expectedType.kind!=="value"&&(U=d.expectedType);for(let j=0;j<T.length;j+=2){const R=T[j],N=T[j+1],V=j+3,z=j+4;if(typeof R!="number")return d.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',V);if(B.length&&B[B.length-1][0]>=R)return d.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',V);const G=d.parse(N,z,U);if(!G)return null;U=U||G.type,B.push([R,G])}return U.kind==="number"||U.kind==="color"||U.kind==="array"&&U.itemType.kind==="number"&&typeof U.N=="number"?new fl(U,_,A,x,B):d.error(`Type ${Ms(U)} is not interpolatable.`)}evaluate(c){const d=this.labels,_=this.outputs;if(d.length===1)return _[0].evaluate(c);const A=this.input.evaluate(c);if(A<=d[0])return _[0].evaluate(c);const x=d.length;if(A>=d[x-1])return _[x-1].evaluate(c);const T=Up(d,A),B=fl.interpolationFactor(this.interpolation,A,d[T],d[T+1]),U=_[T].evaluate(c),j=_[T+1].evaluate(c);return this.operator==="interpolate"?jh[this.type.kind.toLowerCase()](U,j,B):this.operator==="interpolate-hcl"?Gp.reverse(Gp.interpolate(Gp.forward(U),Gp.forward(j),B)):bd.reverse(bd.interpolate(bd.forward(U),bd.forward(j),B))}eachChild(c){c(this.input);for(const d of this.outputs)c(d)}outputDefined(){return this.outputs.every(c=>c.outputDefined())}serialize(){let c;c=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const d=[this.operator,c,this.input.serialize()];for(let _=0;_<this.labels.length;_++)d.push(this.labels[_],this.outputs[_].serialize());return d}}function Z0(g,c,d,_){const A=_-d,x=g-d;return A===0?0:c===1?x/A:(Math.pow(c,x)-1)/(Math.pow(c,A)-1)}class Vp{constructor(c,d){this.type=c,this.args=d}static parse(c,d){if(c.length<2)return d.error("Expectected at least one argument.");let _=null;const A=d.expectedType;A&&A.kind!=="value"&&(_=A);const x=[];for(const B of c.slice(1)){const U=d.parse(B,1+x.length,_,void 0,{typeAnnotation:"omit"});if(!U)return null;_=_||U.type,x.push(U)}const T=A&&x.some(B=>Lo(A,B.type));return new Vp(T?ni:_,x)}evaluate(c){let d,_=null,A=0;for(const x of this.args){if(A++,_=x.evaluate(c),_&&_ instanceof qa&&!_.available&&(d||(d=_),_=null,A===this.args.length))return d;if(_!==null)break}return _}eachChild(c){this.args.forEach(c)}outputDefined(){return this.args.every(c=>c.outputDefined())}serialize(){const c=["coalesce"];return this.eachChild(d=>{c.push(d.serialize())}),c}}class Hp{constructor(c,d){this.type=d.type,this.bindings=[].concat(c),this.result=d}evaluate(c){return this.result.evaluate(c)}eachChild(c){for(const d of this.bindings)c(d[1]);c(this.result)}static parse(c,d){if(c.length<4)return d.error(`Expected at least 3 arguments, but found ${c.length-1} instead.`);const _=[];for(let x=1;x<c.length-1;x+=2){const T=c[x];if(typeof T!="string")return d.error(`Expected string, but found ${typeof T} instead.`,x);if(/[^a-zA-Z0-9_]/.test(T))return d.error("Variable names must contain only alphanumeric characters or '_'.",x);const B=d.parse(c[x+1],x+1);if(!B)return null;_.push([T,B])}const A=d.parse(c[c.length-1],c.length-1,d.expectedType,_);return A?new Hp(_,A):null}outputDefined(){return this.result.outputDefined()}serialize(){const c=["let"];for(const[d,_]of this.bindings)c.push(d,_.serialize());return c.push(this.result.serialize()),c}}class Mg{constructor(c,d,_){this.type=c,this.index=d,this.input=_}static parse(c,d){if(c.length!==3)return d.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const _=d.parse(c[1],1,On),A=d.parse(c[2],2,so(d.expectedType||ni));return _&&A?new Mg(A.type.itemType,_,A):null}evaluate(c){const d=this.index.evaluate(c),_=this.input.evaluate(c);if(d<0)throw new Zs(`Array index out of bounds: ${d} < 0.`);if(d>=_.length)throw new Zs(`Array index out of bounds: ${d} > ${_.length-1}.`);if(d!==Math.floor(d))throw new Zs(`Array index must be an integer, but found ${d} instead.`);return _[d]}eachChild(c){c(this.index),c(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Eg{constructor(c,d){this.type=Zr,this.needle=c,this.haystack=d}static parse(c,d){if(c.length!==3)return d.error(`Expected 2 arguments, but found ${c.length-1} instead.`);const _=d.parse(c[1],1,ni),A=d.parse(c[2],2,ni);return _&&A?md(_.type,[Zr,ei,On,ec,ni])?new Eg(_,A):d.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ms(_.type)} instead`):null}evaluate(c){const d=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(_==null)return!1;if(!cl(d,["boolean","string","number","null"]))throw new Zs(`Expected first argument to be of type boolean, string, number or null, but found ${Ms(Bs(d))} instead.`);if(!cl(_,["string","array"]))throw new Zs(`Expected second argument to be of type array or string, but found ${Ms(Bs(_))} instead.`);return _.indexOf(d)>=0}eachChild(c){c(this.needle),c(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class rf{constructor(c,d,_){this.type=On,this.needle=c,this.haystack=d,this.fromIndex=_}static parse(c,d){if(c.length<=2||c.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const _=d.parse(c[1],1,ni),A=d.parse(c[2],2,ni);if(!_||!A)return null;if(!md(_.type,[Zr,ei,On,ec,ni]))return d.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ms(_.type)} instead`);if(c.length===4){const x=d.parse(c[3],3,On);return x?new rf(_,A,x):null}return new rf(_,A)}evaluate(c){const d=this.needle.evaluate(c),_=this.haystack.evaluate(c);if(!cl(d,["boolean","string","number","null"]))throw new Zs(`Expected first argument to be of type boolean, string, number or null, but found ${Ms(Bs(d))} instead.`);if(!cl(_,["string","array"]))throw new Zs(`Expected second argument to be of type array or string, but found ${Ms(Bs(_))} instead.`);if(this.fromIndex){const A=this.fromIndex.evaluate(c);return _.indexOf(d,A)}return _.indexOf(d)}eachChild(c){c(this.needle),c(this.haystack),this.fromIndex&&c(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const c=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),c]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Y0{constructor(c,d,_,A,x,T){this.inputType=c,this.type=d,this.input=_,this.cases=A,this.outputs=x,this.otherwise=T}static parse(c,d){if(c.length<5)return d.error(`Expected at least 4 arguments, but found only ${c.length-1}.`);if(c.length%2!=1)return d.error("Expected an even number of arguments.");let _,A;d.expectedType&&d.expectedType.kind!=="value"&&(A=d.expectedType);const x={},T=[];for(let j=2;j<c.length-1;j+=2){let R=c[j];const N=c[j+1];Array.isArray(R)||(R=[R]);const V=d.concat(j);if(R.length===0)return V.error("Expected at least one branch label.");for(const G of R){if(typeof G!="number"&&typeof G!="string")return V.error("Branch labels must be numbers or strings.");if(typeof G=="number"&&Math.abs(G)>Number.MAX_SAFE_INTEGER)return V.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof G=="number"&&Math.floor(G)!==G)return V.error("Numeric branch labels must be integer values.");if(_){if(V.checkSubtype(_,Bs(G)))return null}else _=Bs(G);if(x[String(G)]!==void 0)return V.error("Branch labels must be unique.");x[String(G)]=T.length}const z=d.parse(N,j,A);if(!z)return null;A=A||z.type,T.push(z)}const B=d.parse(c[1],1,ni);if(!B)return null;const U=d.parse(c[c.length-1],c.length-1,A);return U?B.type.kind!=="value"&&d.concat(1).checkSubtype(_,B.type)?null:new Y0(_,A,B,x,T,U):null}evaluate(c){const d=this.input.evaluate(c);return(Bs(d)===this.inputType&&this.outputs[this.cases[d]]||this.otherwise).evaluate(c)}eachChild(c){c(this.input),this.outputs.forEach(c),c(this.otherwise)}outputDefined(){return this.outputs.every(c=>c.outputDefined())&&this.otherwise.outputDefined()}serialize(){const c=["match",this.input.serialize()],d=Object.keys(this.cases).sort(),_=[],A={};for(const T of d){const B=A[this.cases[T]];B===void 0?(A[this.cases[T]]=_.length,_.push([this.cases[T],[T]])):_[B][1].push(T)}const x=T=>this.inputType.kind==="number"?Number(T):T;for(const[T,B]of _)c.push(B.length===1?x(B[0]):B.map(x)),c.push(this.outputs[T].serialize());return c.push(this.otherwise.serialize()),c}}class jp{constructor(c,d,_){this.type=c,this.branches=d,this.otherwise=_}static parse(c,d){if(c.length<4)return d.error(`Expected at least 3 arguments, but found only ${c.length-1}.`);if(c.length%2!=0)return d.error("Expected an odd number of arguments.");let _;d.expectedType&&d.expectedType.kind!=="value"&&(_=d.expectedType);const A=[];for(let T=1;T<c.length-1;T+=2){const B=d.parse(c[T],T,Zr);if(!B)return null;const U=d.parse(c[T+1],T+1,_);if(!U)return null;A.push([B,U]),_=_||U.type}const x=d.parse(c[c.length-1],c.length-1,_);return x?new jp(_,A,x):null}evaluate(c){for(const[d,_]of this.branches)if(d.evaluate(c))return _.evaluate(c);return this.otherwise.evaluate(c)}eachChild(c){for(const[d,_]of this.branches)c(d),c(_);c(this.otherwise)}outputDefined(){return this.branches.every(([c,d])=>d.outputDefined())&&this.otherwise.outputDefined()}serialize(){const c=["case"];return this.eachChild(d=>{c.push(d.serialize())}),c}}class Cg{constructor(c,d,_,A){this.type=c,this.input=d,this.beginIndex=_,this.endIndex=A}static parse(c,d){if(c.length<=2||c.length>=5)return d.error(`Expected 3 or 4 arguments, but found ${c.length-1} instead.`);const _=d.parse(c[1],1,ni),A=d.parse(c[2],2,On);if(!_||!A)return null;if(!md(_.type,[so(ni),ei,ni]))return d.error(`Expected first argument to be of type array or string, but found ${Ms(_.type)} instead`);if(c.length===4){const x=d.parse(c[3],3,On);return x?new Cg(_.type,_,A,x):null}return new Cg(_.type,_,A)}evaluate(c){const d=this.input.evaluate(c),_=this.beginIndex.evaluate(c);if(!cl(d,["string","array"]))throw new Zs(`Expected first argument to be of type array or string, but found ${Ms(Bs(d))} instead.`);if(this.endIndex){const A=this.endIndex.evaluate(c);return d.slice(_,A)}return d.slice(_)}eachChild(c){c(this.input),c(this.beginIndex),this.endIndex&&c(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const c=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),c]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function Wp(g,c){return g==="=="||g==="!="?c.kind==="boolean"||c.kind==="string"||c.kind==="number"||c.kind==="null"||c.kind==="value":c.kind==="string"||c.kind==="number"||c.kind==="value"}function Ig(g,c,d,_){return _.compare(c,d)===0}function wd(g,c,d){const _=g!=="=="&&g!=="!=";return class Zce{constructor(x,T,B){this.type=Zr,this.lhs=x,this.rhs=T,this.collator=B,this.hasUntypedArgument=x.type.kind==="value"||T.type.kind==="value"}static parse(x,T){if(x.length!==3&&x.length!==4)return T.error("Expected two or three arguments.");const B=x[0];let U=T.parse(x[1],1,ni);if(!U)return null;if(!Wp(B,U.type))return T.concat(1).error(`"${B}" comparisons are not supported for type '${Ms(U.type)}'.`);let j=T.parse(x[2],2,ni);if(!j)return null;if(!Wp(B,j.type))return T.concat(2).error(`"${B}" comparisons are not supported for type '${Ms(j.type)}'.`);if(U.type.kind!==j.type.kind&&U.type.kind!=="value"&&j.type.kind!=="value")return T.error(`Cannot compare types '${Ms(U.type)}' and '${Ms(j.type)}'.`);_&&(U.type.kind==="value"&&j.type.kind!=="value"?U=new Ys(j.type,[U]):U.type.kind!=="value"&&j.type.kind==="value"&&(j=new Ys(U.type,[j])));let R=null;if(x.length===4){if(U.type.kind!=="string"&&j.type.kind!=="string"&&U.type.kind!=="value"&&j.type.kind!=="value")return T.error("Cannot use collator to compare non-string types.");if(R=T.parse(x[3],3,ll),!R)return null}return new Zce(U,j,R)}evaluate(x){const T=this.lhs.evaluate(x),B=this.rhs.evaluate(x);if(_&&this.hasUntypedArgument){const U=Bs(T),j=Bs(B);if(U.kind!==j.kind||U.kind!=="string"&&U.kind!=="number")throw new Zs(`Expected arguments for "${g}" to be (string, string) or (number, number), but found (${U.kind}, ${j.kind}) instead.`)}if(this.collator&&!_&&this.hasUntypedArgument){const U=Bs(T),j=Bs(B);if(U.kind!=="string"||j.kind!=="string")return c(x,T,B)}return this.collator?d(x,T,B,this.collator.evaluate(x)):c(x,T,B)}eachChild(x){x(this.lhs),x(this.rhs),this.collator&&x(this.collator)}outputDefined(){return!0}serialize(){const x=[g];return this.eachChild(T=>{x.push(T.serialize())}),x}}}const Bx=wd("==",function(g,c,d){return c===d},Ig),K0=wd("!=",function(g,c,d){return c!==d},function(g,c,d,_){return!Ig(0,c,d,_)}),J0=wd("<",function(g,c,d){return c<d},function(g,c,d,_){return _.compare(c,d)<0}),sf=wd(">",function(g,c,d){return c>d},function(g,c,d,_){return _.compare(c,d)>0}),Q0=wd("<=",function(g,c,d){return c<=d},function(g,c,d,_){return _.compare(c,d)<=0}),oc=wd(">=",function(g,c,d){return c>=d},function(g,c,d,_){return _.compare(c,d)>=0});class Rg{constructor(c,d,_,A,x,T){this.type=ei,this.number=c,this.locale=d,this.currency=_,this.unit=A,this.minFractionDigits=x,this.maxFractionDigits=T}static parse(c,d){if(c.length!==3)return d.error("Expected two arguments.");const _=d.parse(c[1],1,On);if(!_)return null;const A=c[2];if(typeof A!="object"||Array.isArray(A))return d.error("NumberFormat options argument must be an object.");let x=null;if(A.locale&&(x=d.parseObjectValue(A.locale,2,"locale",ei),!x))return null;let T=null;if(A.currency&&(T=d.parseObjectValue(A.currency,2,"currency",ei),!T))return null;let B=null;if(A.unit&&(B=d.parseObjectValue(A.unit,2,"unit",ei),!B))return null;let U=null;if(A["min-fraction-digits"]&&(U=d.parseObjectValue(A["min-fraction-digits"],2,"min-fraction-digits",On),!U))return null;let j=null;return A["max-fraction-digits"]&&(j=d.parseObjectValue(A["max-fraction-digits"],2,"max-fraction-digits",On),!j)?null:new Rg(_,x,T,B,U,j)}evaluate(c){return new Intl.NumberFormat(this.locale?this.locale.evaluate(c):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(c):void 0,unit:this.unit?this.unit.evaluate(c):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(c):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(c):void 0}).format(this.number.evaluate(c))}eachChild(c){c(this.number),this.locale&&c(this.locale),this.currency&&c(this.currency),this.unit&&c(this.unit),this.minFractionDigits&&c(this.minFractionDigits),this.maxFractionDigits&&c(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const c={};return this.locale&&(c.locale=this.locale.serialize()),this.currency&&(c.currency=this.currency.serialize()),this.unit&&(c.unit=this.unit.serialize()),this.minFractionDigits&&(c["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(c["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),c]}}class wu{constructor(c){this.type=On,this.input=c}static parse(c,d){if(c.length!==2)return d.error(`Expected 1 argument, but found ${c.length-1} instead.`);const _=d.parse(c[1],1);return _?_.type.kind!=="array"&&_.type.kind!=="string"&&_.type.kind!=="value"?d.error(`Expected argument of type string or array, but found ${Ms(_.type)} instead.`):new wu(_):null}evaluate(c){const d=this.input.evaluate(c);if(typeof d=="string"||Array.isArray(d))return d.length;throw new Zs(`Expected value to be of type string or array, but found ${Ms(Bs(d))} instead.`)}eachChild(c){c(this.input)}outputDefined(){return!1}serialize(){const c=["length"];return this.eachChild(d=>{c.push(d.serialize())}),c}}function Ju(g){return function(){g=1831565813+(g|=0)|0;let c=Math.imul(g^g>>>15,1|g);return c=c+Math.imul(c^c>>>7,61|c)^c,((c^c>>>14)>>>0)/4294967296}}const Su={"==":Bx,"!=":K0,">":sf,"<":J0,">=":oc,"<=":Q0,array:Ys,at:Mg,boolean:Ys,case:jp,coalesce:Vp,collator:Dp,format:Do,image:Zo,in:Eg,"index-of":rf,interpolate:fl,"interpolate-hcl":fl,"interpolate-lab":fl,length:wu,let:Hp,literal:ul,match:Y0,number:Ys,"number-format":Rg,object:Ys,slice:Cg,step:xd,string:Ys,"to-boolean":ao,"to-color":ao,"to-number":ao,"to-string":ao,var:bi,within:xa,distance:Yu,config:Ku};function $p(g,[c,d,_,A]){c=c.evaluate(g),d=d.evaluate(g),_=_.evaluate(g);const x=A?A.evaluate(g):1,T=Wh(c,d,_,x);if(T)throw new Zs(T);return new vr(c/255*x,d/255*x,_/255*x,x)}function Pg(g,[c,d,_,A]){c=c.evaluate(g),d=d.evaluate(g),_=_.evaluate(g);const x=A?A.evaluate(g):1,T=function(j,R,N,V){return typeof j=="number"&&j>=0&&j<=360?typeof R=="number"&&R>=0&&R<=100&&typeof N=="number"&&N>=0&&N<=100?V===void 0||typeof V=="number"&&V>=0&&V<=1?null:`Invalid hsla value [${[j,R,N,V].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof V=="number"?[j,R,N,V]:[j,R,N]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof V=="number"?[j,R,N,V]:[j,R,N]).join(", ")}]: 'h' must be between 0 and 360.`}(c,d,_,x);if(T)throw new Zs(T);const B=`hsla(${c}, ${d}%, ${_}%, ${x})`,U=vr.parse(B);if(!U)throw new Zs(`Failed to parse HSLA color: ${B}`);return U}function af(g,c){return g in c}function Za(g,c){const d=c[g];return d===void 0?null:d}function of(g){return{type:g}}function kx(g){return{result:"success",value:g}}function ba(g){return{result:"error",value:g}}function lo(g,c){return!!g&&!!g.parameters&&g.parameters.indexOf(c)>-1}function Xp(g){return g["property-type"]==="data-driven"}function Lg(g){return lo(g.expression,"measure-light")}function e_(g){return lo(g.expression,"zoom")}function Dg(g){return!!g.expression&&g.expression.interpolated}function qp(g){return typeof g=="object"&&g!==null&&!Array.isArray(g)}function Bg(g){return g}function t_(g,c){const d=c.type==="color",_=g.stops&&typeof g.stops[0][0]=="object",A=_||!(_||g.property!==void 0),x=g.type||(Dg(c)?"exponential":"interval");if(d&&((g=dd({},g)).stops&&(g.stops=g.stops.map(j=>[j[0],vr.parse(j[1])])),g.default=vr.parse(g.default?g.default:c.default)),g.colorSpace&&g.colorSpace!=="rgb"&&!q0[g.colorSpace])throw new Error(`Unknown color space: ${g.colorSpace}`);let T,B,U;if(x==="exponential")T=Zp;else if(x==="interval")T=n_;else if(x==="categorical"){T=Ox,B=Object.create(null);for(const j of g.stops)B[j[0]]=j[1];U=typeof g.stops[0][0]}else{if(x!=="identity")throw new Error(`Unknown function type "${x}"`);T=kg}if(_){const j={},R=[];for(let z=0;z<g.stops.length;z++){const G=g.stops[z],$=G[0].zoom;j[$]===void 0&&(j[$]={zoom:$,type:g.type,property:g.property,default:g.default,stops:[]},R.push($)),j[$].stops.push([G[0].value,G[1]])}const N=[];for(const z of R)N.push([j[z].zoom,t_(j[z],c)]);const V={name:"linear"};return{kind:"composite",interpolationType:V,interpolationFactor:fl.interpolationFactor.bind(void 0,V),zoomStops:N.map(z=>z[0]),evaluate:({zoom:z},G)=>Zp({stops:N,base:g.base},c,z).evaluate(z,G)}}if(A){const j=x==="exponential"?{name:"exponential",base:g.base!==void 0?g.base:1}:null;return{kind:"camera",interpolationType:j,interpolationFactor:fl.interpolationFactor.bind(void 0,j),zoomStops:g.stops.map(R=>R[0]),evaluate:({zoom:R})=>T(g,c,R,B,U)}}return{kind:"source",evaluate(j,R){const N=R&&R.properties?R.properties[g.property]:void 0;return N===void 0?lf(g.default,c.default):T(g,c,N,B,U)}}}function lf(g,c,d){return g!==void 0?g:c!==void 0?c:d!==void 0?d:void 0}function Ox(g,c,d,_,A){return lf(typeof d===A?_[d]:void 0,g.default,c.default)}function n_(g,c,d){if(vu(d)!=="number")return lf(g.default,c.default);const _=g.stops.length;if(_===1||d<=g.stops[0][0])return g.stops[0][1];if(d>=g.stops[_-1][0])return g.stops[_-1][1];const A=Up(g.stops.map(x=>x[0]),d);return g.stops[A][1]}function Zp(g,c,d){const _=g.base!==void 0?g.base:1;if(vu(d)!=="number")return lf(g.default,c.default);const A=g.stops.length;if(A===1||d<=g.stops[0][0])return g.stops[0][1];if(d>=g.stops[A-1][0])return g.stops[A-1][1];const x=Up(g.stops.map(R=>R[0]),d),T=function(R,N,V,z){const G=z-V,$=R-V;return G===0?0:N===1?$/G:(Math.pow(N,$)-1)/(Math.pow(N,G)-1)}(d,_,g.stops[x][0],g.stops[x+1][0]),B=g.stops[x][1],U=g.stops[x+1][1];let j=jh[c.type]||Bg;if(g.colorSpace&&g.colorSpace!=="rgb"){const R=q0[g.colorSpace];j=(N,V)=>R.reverse(R.interpolate(R.forward(N),R.forward(V),T))}return typeof B.evaluate=="function"?{evaluate(...R){const N=B.evaluate.apply(void 0,R),V=U.evaluate.apply(void 0,R);if(N!==void 0&&V!==void 0)return j(N,V,T)}}:j(B,U,T)}function kg(g,c,d){return c.type==="color"?d=vr.parse(d):c.type==="formatted"?d=La.fromString(d.toString()):c.type==="resolvedImage"?d=qa.fromString(d.toString()):vu(d)===c.type||c.type==="enum"&&c.values[d]||(d=void 0),lf(d,g.default,c.default)}Bo.register(Su,{error:[{kind:"error"},[ei],(g,[c])=>{throw new Zs(c.evaluate(g))}],typeof:[ei,[ni],(g,[c])=>Ms(Bs(c.evaluate(g)))],"to-rgba":[so(On,4),[Gs],(g,[c])=>c.evaluate(g).toRenderColor(null).toArray()],rgb:[Gs,[On,On,On],$p],rgba:[Gs,[On,On,On,On],$p],hsl:[Gs,[On,On,On],Pg],hsla:[Gs,[On,On,On,On],Pg],has:{type:Zr,overloads:[[[ei],(g,[c])=>af(c.evaluate(g),g.properties())],[[ei,vo],(g,[c,d])=>af(c.evaluate(g),d.evaluate(g))]]},get:{type:ni,overloads:[[[ei],(g,[c])=>Za(c.evaluate(g),g.properties())],[[ei,vo],(g,[c,d])=>Za(c.evaluate(g),d.evaluate(g))]]},"feature-state":[ni,[ei],(g,[c])=>Za(c.evaluate(g),g.featureState||{})],properties:[vo,[],g=>g.properties()],"geometry-type":[ei,[],g=>g.geometryType()],id:[ni,[],g=>g.id()],zoom:[On,[],g=>g.globals.zoom],pitch:[On,[],g=>g.globals.pitch||0],"distance-from-center":[On,[],g=>g.distanceFromCenter()],"measure-light":[On,[ei],(g,[c])=>g.measureLight(c.evaluate(g))],"heatmap-density":[On,[],g=>g.globals.heatmapDensity||0],"line-progress":[On,[],g=>g.globals.lineProgress||0],"raster-value":[On,[],g=>g.globals.rasterValue||0],"raster-particle-speed":[On,[],g=>g.globals.rasterParticleSpeed||0],"sky-radial-progress":[On,[],g=>g.globals.skyRadialProgress||0],accumulated:[ni,[],g=>g.globals.accumulated===void 0?null:g.globals.accumulated],"+":[On,of(On),(g,c)=>{let d=0;for(const _ of c)d+=_.evaluate(g);return d}],"*":[On,of(On),(g,c)=>{let d=1;for(const _ of c)d*=_.evaluate(g);return d}],"-":{type:On,overloads:[[[On,On],(g,[c,d])=>c.evaluate(g)-d.evaluate(g)],[[On],(g,[c])=>-c.evaluate(g)]]},"/":[On,[On,On],(g,[c,d])=>c.evaluate(g)/d.evaluate(g)],"%":[On,[On,On],(g,[c,d])=>c.evaluate(g)%d.evaluate(g)],ln2:[On,[],()=>Math.LN2],pi:[On,[],()=>Math.PI],e:[On,[],()=>Math.E],"^":[On,[On,On],(g,[c,d])=>Math.pow(c.evaluate(g),d.evaluate(g))],sqrt:[On,[On],(g,[c])=>Math.sqrt(c.evaluate(g))],log10:[On,[On],(g,[c])=>Math.log(c.evaluate(g))/Math.LN10],ln:[On,[On],(g,[c])=>Math.log(c.evaluate(g))],log2:[On,[On],(g,[c])=>Math.log(c.evaluate(g))/Math.LN2],sin:[On,[On],(g,[c])=>Math.sin(c.evaluate(g))],cos:[On,[On],(g,[c])=>Math.cos(c.evaluate(g))],tan:[On,[On],(g,[c])=>Math.tan(c.evaluate(g))],asin:[On,[On],(g,[c])=>Math.asin(c.evaluate(g))],acos:[On,[On],(g,[c])=>Math.acos(c.evaluate(g))],atan:[On,[On],(g,[c])=>Math.atan(c.evaluate(g))],min:[On,of(On),(g,c)=>Math.min(...c.map(d=>d.evaluate(g)))],max:[On,of(On),(g,c)=>Math.max(...c.map(d=>d.evaluate(g)))],abs:[On,[On],(g,[c])=>Math.abs(c.evaluate(g))],round:[On,[On],(g,[c])=>{const d=c.evaluate(g);return d<0?-Math.round(-d):Math.round(d)}],floor:[On,[On],(g,[c])=>Math.floor(c.evaluate(g))],ceil:[On,[On],(g,[c])=>Math.ceil(c.evaluate(g))],"filter-==":[Zr,[ei,ni],(g,[c,d])=>g.properties()[c.value]===d.value],"filter-id-==":[Zr,[ni],(g,[c])=>g.id()===c.value],"filter-type-==":[Zr,[ei],(g,[c])=>g.geometryType()===c.value],"filter-<":[Zr,[ei,ni],(g,[c,d])=>{const _=g.properties()[c.value],A=d.value;return typeof _==typeof A&&_<A}],"filter-id-<":[Zr,[ni],(g,[c])=>{const d=g.id(),_=c.value;return typeof d==typeof _&&d<_}],"filter->":[Zr,[ei,ni],(g,[c,d])=>{const _=g.properties()[c.value],A=d.value;return typeof _==typeof A&&_>A}],"filter-id->":[Zr,[ni],(g,[c])=>{const d=g.id(),_=c.value;return typeof d==typeof _&&d>_}],"filter-<=":[Zr,[ei,ni],(g,[c,d])=>{const _=g.properties()[c.value],A=d.value;return typeof _==typeof A&&_<=A}],"filter-id-<=":[Zr,[ni],(g,[c])=>{const d=g.id(),_=c.value;return typeof d==typeof _&&d<=_}],"filter->=":[Zr,[ei,ni],(g,[c,d])=>{const _=g.properties()[c.value],A=d.value;return typeof _==typeof A&&_>=A}],"filter-id->=":[Zr,[ni],(g,[c])=>{const d=g.id(),_=c.value;return typeof d==typeof _&&d>=_}],"filter-has":[Zr,[ni],(g,[c])=>c.value in g.properties()],"filter-has-id":[Zr,[],g=>g.id()!==null&&g.id()!==void 0],"filter-type-in":[Zr,[so(ei)],(g,[c])=>c.value.indexOf(g.geometryType())>=0],"filter-id-in":[Zr,[so(ni)],(g,[c])=>c.value.indexOf(g.id())>=0],"filter-in-small":[Zr,[ei,so(ni)],(g,[c,d])=>d.value.indexOf(g.properties()[c.value])>=0],"filter-in-large":[Zr,[ei,so(ni)],(g,[c,d])=>function(_,A,x,T){for(;x<=T;){const B=x+T>>1;if(A[B]===_)return!0;A[B]>_?T=B-1:x=B+1}return!1}(g.properties()[c.value],d.value,0,d.value.length-1)],all:{type:Zr,overloads:[[[Zr,Zr],(g,[c,d])=>c.evaluate(g)&&d.evaluate(g)],[of(Zr),(g,c)=>{for(const d of c)if(!d.evaluate(g))return!1;return!0}]]},any:{type:Zr,overloads:[[[Zr,Zr],(g,[c,d])=>c.evaluate(g)||d.evaluate(g)],[of(Zr),(g,c)=>{for(const d of c)if(d.evaluate(g))return!0;return!1}]]},"!":[Zr,[Zr],(g,[c])=>!c.evaluate(g)],"is-supported-script":[Zr,[ei],(g,[c])=>{const d=g.globals&&g.globals.isSupportedScript;return!d||d(c.evaluate(g))}],upcase:[ei,[ei],(g,[c])=>c.evaluate(g).toUpperCase()],downcase:[ei,[ei],(g,[c])=>c.evaluate(g).toLowerCase()],concat:[ei,of(ni),(g,c)=>c.map(d=>_o(d.evaluate(g))).join("")],"resolved-locale":[ei,[ll],(g,[c])=>c.evaluate(g).resolvedLocale()],random:[On,[On,On,ni],(g,c)=>{const[d,_,A]=c.map(T=>T.evaluate(g));if(d>_||d===_)return d;let x;if(typeof A=="string")x=function(T){let B=0;if(T.length===0)return B;for(let U=0;U<T.length;U++)B=(B<<5)-B+T.charCodeAt(U),B|=0;return B}(A);else{if(typeof A!="number")throw new Zs(`Invalid seed input: ${A}`);x=A}return d+Ju(x)()*(_-d)}]});class Yp{constructor(c,d,_,A){this.expression=c,this._warningHistory={},this._evaluator=new Lp(_,A),this._defaultValue=d?function(x){return x.type==="color"&&(qp(x.default)||Array.isArray(x.default))?new vr(0,0,0,0):x.type==="color"?vr.parse(x.default)||null:x.default===void 0?null:x.default}(d):null,this._enumValues=d&&d.type==="enum"?d.values:null}evaluateWithoutErrorHandling(c,d,_,A,x,T,B,U){return this._evaluator.globals=c,this._evaluator.feature=d,this._evaluator.featureState=_,this._evaluator.canonical=A||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=T,this._evaluator.featureTileCoord=B||null,this._evaluator.featureDistanceData=U||null,this.expression.evaluate(this._evaluator)}evaluate(c,d,_,A,x,T,B,U){this._evaluator.globals=c,this._evaluator.feature=d||null,this._evaluator.featureState=_||null,this._evaluator.canonical=A||null,this._evaluator.availableImages=x||null,this._evaluator.formattedSection=T||null,this._evaluator.featureTileCoord=B||null,this._evaluator.featureDistanceData=U||null;try{const j=this.expression.evaluate(this._evaluator);if(j==null||typeof j=="number"&&j!=j)return this._defaultValue;if(this._enumValues&&!(j in this._enumValues))throw new Zs(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(j)} instead.`);return j}catch(j){return this._warningHistory[j.message]||(this._warningHistory[j.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${j.message}`)),this._defaultValue}}}function Sd(g){return Array.isArray(g)&&g.length>0&&typeof g[0]=="string"&&g[0]in Su}function Ad(g,c,d,_){const A=new V0(Su,[],c?function(T){const B={color:Gs,string:ei,number:On,enum:ei,boolean:Zr,formatted:qo,resolvedImage:gu};return T.type==="array"?so(B[T.value]||ni,T.length):B[T.type]}(c):void 0,void 0,void 0,d,_),x=A.parse(g,void 0,void 0,void 0,c&&c.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?kx(new Yp(x,c,d,_)):ba(A.errors)}class Og{constructor(c,d,_){this.kind=c,this._styleExpression=d,this.isLightConstant=_,this.isStateDependent=c!=="constant"&&!Cl(d.expression),this.configDependencies=hl(d.expression)}evaluateWithoutErrorHandling(c,d,_,A,x,T){return this._styleExpression.evaluateWithoutErrorHandling(c,d,_,A,x,T)}evaluate(c,d,_,A,x,T){return this._styleExpression.evaluate(c,d,_,A,x,T)}}class dl{constructor(c,d,_,A,x){this.kind=c,this.zoomStops=_,this._styleExpression=d,this.isStateDependent=c!=="camera"&&!Cl(d.expression),this.isLightConstant=x,this.configDependencies=hl(d.expression),this.interpolationType=A}evaluateWithoutErrorHandling(c,d,_,A,x,T){return this._styleExpression.evaluateWithoutErrorHandling(c,d,_,A,x,T)}evaluate(c,d,_,A,x,T){return this._styleExpression.evaluate(c,d,_,A,x,T)}interpolationFactor(c,d,_){return this.interpolationType?fl.interpolationFactor(this.interpolationType,c,d,_):0}}function r_(g,c,d,_){if((g=Ad(g,c,d,_)).result==="error")return g;const A=g.value.expression,x=tf(A);if(!x&&!Xp(c))return ba([new bs("","data expressions not supported")]);const T=ac(A,["zoom","pitch","distance-from-center"]);if(!T&&!e_(c))return ba([new bs("","zoom expressions not supported")]);const B=ac(A,["measure-light"]);if(!B&&!Lg(c))return ba([new bs("","measure-light expression not supported")]);const U=c.expression&&c.expression.relaxZoomRestriction,j=Kp(A);return j||T||U?j instanceof bs?ba([j]):j instanceof fl&&!Dg(c)?ba([new bs("",'"interpolate" expressions cannot be used with this property')]):kx(j?new dl(x?"camera":"composite",g.value,j.labels,j instanceof fl?j.interpolation:void 0,B):new Og(x?"constant":"source",g.value,B)):ba([new bs("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Td{constructor(c,d){this._parameters=c,this._specification=d,dd(this,t_(this._parameters,this._specification))}static deserialize(c){return new Td(c._parameters,c._specification)}static serialize(c){return{_parameters:c._parameters,_specification:c._specification}}}function Kp(g){let c=null;if(g instanceof Hp)c=Kp(g.result);else if(g instanceof Vp){for(const d of g.args)if(c=Kp(d),c)break}else(g instanceof xd||g instanceof fl)&&g.input instanceof Bo&&g.input.name==="zoom"&&(c=g);return c instanceof bs||g.eachChild(d=>{const _=Kp(d);_ instanceof bs?c=_:c&&_&&c!==_&&(c=new bs("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),c}var Il,i_,Fx=function(){if(i_)return Il;i_=1,Il=c;var g=3;function c(d,_,A){var x=this.cells=[];if(d instanceof ArrayBuffer){this.arrayBuffer=d;var T=new Int32Array(this.arrayBuffer);d=T[0],this.d=(_=T[1])+2*(A=T[2]);for(var B=0;B<this.d*this.d;B++){var U=T[g+B],j=T[g+B+1];x.push(U===j?null:T.subarray(U,j))}var R=T[g+x.length+1];this.keys=T.subarray(T[g+x.length],R),this.bboxes=T.subarray(R),this.insert=this._insertReadonly}else{this.d=_+2*A;for(var N=0;N<this.d*this.d;N++)x.push([]);this.keys=[],this.bboxes=[]}this.n=_,this.extent=d,this.padding=A,this.scale=_/d,this.uid=0;var V=A/_*d;this.min=-V,this.max=d+V}return c.prototype.insert=function(d,_,A,x,T){this._forEachCell(_,A,x,T,this._insertCell,this.uid++),this.keys.push(d),this.bboxes.push(_),this.bboxes.push(A),this.bboxes.push(x),this.bboxes.push(T)},c.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},c.prototype._insertCell=function(d,_,A,x,T,B){this.cells[T].push(B)},c.prototype.query=function(d,_,A,x,T){var B=this.min,U=this.max;if(d<=B&&_<=B&&U<=A&&U<=x&&!T)return Array.prototype.slice.call(this.keys);var j=[];return this._forEachCell(d,_,A,x,this._queryCell,j,{},T),j},c.prototype._queryCell=function(d,_,A,x,T,B,U,j){var R=this.cells[T];if(R!==null)for(var N=this.keys,V=this.bboxes,z=0;z<R.length;z++){var G=R[z];if(U[G]===void 0){var $=4*G;(j?j(V[$+0],V[$+1],V[$+2],V[$+3]):d<=V[$+2]&&_<=V[$+3]&&A>=V[$+0]&&x>=V[$+1])?(U[G]=!0,B.push(N[G])):U[G]=!1}}},c.prototype._forEachCell=function(d,_,A,x,T,B,U,j){for(var R=this._convertToCellCoord(d),N=this._convertToCellCoord(_),V=this._convertToCellCoord(A),z=this._convertToCellCoord(x),G=R;G<=V;G++)for(var $=N;$<=z;$++){var K=this.d*$+G;if((!j||j(this._convertFromCellCoord(G),this._convertFromCellCoord($),this._convertFromCellCoord(G+1),this._convertFromCellCoord($+1)))&&T.call(this,d,_,A,x,K,B,U,j))return}},c.prototype._convertFromCellCoord=function(d){return(d-this.padding)/this.scale},c.prototype._convertToCellCoord=function(d){return Math.max(0,Math.min(this.d-1,Math.floor(d*this.scale)+this.padding))},c.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var d=this.cells,_=g+this.cells.length+1+1,A=0,x=0;x<this.cells.length;x++)A+=this.cells[x].length;var T=new Int32Array(_+A+this.keys.length+this.bboxes.length);T[0]=this.extent,T[1]=this.n,T[2]=this.padding;for(var B=_,U=0;U<d.length;U++){var j=d[U];T[g+U]=B,T.set(j,B),B+=j.length}return T[g+d.length]=B,T.set(this.keys,B),T[g+d.length+1]=B+=this.keys.length,T.set(this.bboxes,B),B+=this.bboxes.length,T.buffer},Il}(),Vc=h(Fx);const Rl={};function Fn(g,c,d={}){Object.defineProperty(g,"_classRegistryKey",{value:c,writable:!1}),Rl[c]={klass:g,omit:d.omit||[]}}Fn(Object,"Object"),Vc.serialize=function(g,c){const d=g.toArrayBuffer();return c&&c.add(d),{buffer:d}},Vc.deserialize=function(g){return new Vc(g.buffer)},Object.defineProperty(Vc,"name",{value:"Grid"}),Fn(Vc,"Grid"),Fn(vr,"Color"),Fn(Error,"Error"),Fn(La,"Formatted"),Fn(Vs,"FormattedSection"),Fn(qr,"AJAXError"),Fn(qa,"ResolvedImage"),Fn(Td,"StylePropertyFunction"),Fn(Yp,"StyleExpression",{omit:["_evaluator"]}),Fn(dl,"ZoomDependentExpression"),Fn(Og,"ZoomConstantExpression"),Fn(Bo,"CompoundExpression",{omit:["_evaluate"]});for(const g in Su)Rl[Su[g]._classRegistryKey]||Fn(Su[g],`Expression${g}`);function sr(g){return g&&typeof ArrayBuffer<"u"&&(g instanceof ArrayBuffer||g.constructor&&g.constructor.name==="ArrayBuffer")}function Jp(g){return self.ImageBitmap&&g instanceof ImageBitmap}function xo(g,c){if(g==null||typeof g=="boolean"||typeof g=="number"||typeof g=="string"||g instanceof Boolean||g instanceof Number||g instanceof String||g instanceof Date||g instanceof RegExp)return g;if(sr(g)||Jp(g))return c&&c.add(g),g;if(ArrayBuffer.isView(g)){const d=g;return c&&c.add(d.buffer),d}if(g instanceof ImageData)return c&&c.add(g.data.buffer),g;if(Array.isArray(g)){const d=[];for(const _ of g)d.push(xo(_,c));return d}if(g instanceof Map){const d={$name:"Map"};for(const[_,A]of g.entries())d[_]=xo(A);return d}if(g instanceof Set){const d={$name:"Set"};let _=0;for(const A of g.values())d[++_]=xo(A);return d}if(typeof g=="object"){const d=g.constructor,_=d._classRegistryKey;if(!_)throw new Error(`can't serialize object of unregistered class ${_}`);const A=d.serialize?d.serialize(g,c):{};if(!d.serialize){for(const x in g)g.hasOwnProperty(x)&&(Rl[_].omit.indexOf(x)>=0||(A[x]=xo(g[x],c)));g instanceof Error&&(A.message=g.message)}if(A.$name)throw new Error("$name property is reserved for worker serialization logic.");return _!=="Object"&&(A.$name=_),A}throw new Error("can't serialize object of type "+typeof g)}function Qu(g){if(g==null||typeof g=="boolean"||typeof g=="number"||typeof g=="string"||g instanceof Boolean||g instanceof Number||g instanceof String||g instanceof Date||g instanceof RegExp||sr(g)||Jp(g)||ArrayBuffer.isView(g)||g instanceof ImageData)return g;if(Array.isArray(g))return g.map(Qu);if(typeof g=="object"){const c=g.$name||"Object";if(c==="Map"){const A=new Map;for(const x of Object.keys(g))x!=="$name"&&A.set(x,Qu(g[x]));return A}if(c==="Set"){const A=new Set;for(const x of Object.keys(g))x!=="$name"&&A.add(Qu(g[x]));return A}const{klass:d}=Rl[c];if(!d)throw new Error(`can't deserialize unregistered class ${c}`);if(d.deserialize)return d.deserialize(g);const _=Object.create(d.prototype);for(const A of Object.keys(g))A!=="$name"&&(_[A]=Qu(g[A]));return _}throw new Error("can't deserialize object of type "+typeof g)}const Yn={"Latin-1 Supplement":g=>g>=128&&g<=255,Arabic:g=>g>=1536&&g<=1791,"Arabic Supplement":g=>g>=1872&&g<=1919,"Arabic Extended-A":g=>g>=2208&&g<=2303,"Hangul Jamo":g=>g>=4352&&g<=4607,"Unified Canadian Aboriginal Syllabics":g=>g>=5120&&g<=5759,Khmer:g=>g>=6016&&g<=6143,"Unified Canadian Aboriginal Syllabics Extended":g=>g>=6320&&g<=6399,"General Punctuation":g=>g>=8192&&g<=8303,"Letterlike Symbols":g=>g>=8448&&g<=8527,"Number Forms":g=>g>=8528&&g<=8591,"Miscellaneous Technical":g=>g>=8960&&g<=9215,"Control Pictures":g=>g>=9216&&g<=9279,"Optical Character Recognition":g=>g>=9280&&g<=9311,"Enclosed Alphanumerics":g=>g>=9312&&g<=9471,"Geometric Shapes":g=>g>=9632&&g<=9727,"Miscellaneous Symbols":g=>g>=9728&&g<=9983,"Miscellaneous Symbols and Arrows":g=>g>=11008&&g<=11263,"CJK Radicals Supplement":g=>g>=11904&&g<=12031,"Kangxi Radicals":g=>g>=12032&&g<=12255,"Ideographic Description Characters":g=>g>=12272&&g<=12287,"CJK Symbols and Punctuation":g=>g>=12288&&g<=12351,Hiragana:g=>g>=12352&&g<=12447,Katakana:g=>g>=12448&&g<=12543,Bopomofo:g=>g>=12544&&g<=12591,"Hangul Compatibility Jamo":g=>g>=12592&&g<=12687,Kanbun:g=>g>=12688&&g<=12703,"Bopomofo Extended":g=>g>=12704&&g<=12735,"CJK Strokes":g=>g>=12736&&g<=12783,"Katakana Phonetic Extensions":g=>g>=12784&&g<=12799,"Enclosed CJK Letters and Months":g=>g>=12800&&g<=13055,"CJK Compatibility":g=>g>=13056&&g<=13311,"CJK Unified Ideographs Extension A":g=>g>=13312&&g<=19903,"Yijing Hexagram Symbols":g=>g>=19904&&g<=19967,"CJK Unified Ideographs":g=>g>=19968&&g<=40959,"Yi Syllables":g=>g>=40960&&g<=42127,"Yi Radicals":g=>g>=42128&&g<=42191,"Hangul Jamo Extended-A":g=>g>=43360&&g<=43391,"Hangul Syllables":g=>g>=44032&&g<=55215,"Hangul Jamo Extended-B":g=>g>=55216&&g<=55295,"Private Use Area":g=>g>=57344&&g<=63743,"CJK Compatibility Ideographs":g=>g>=63744&&g<=64255,"Arabic Presentation Forms-A":g=>g>=64336&&g<=65023,"Vertical Forms":g=>g>=65040&&g<=65055,"CJK Compatibility Forms":g=>g>=65072&&g<=65103,"Small Form Variants":g=>g>=65104&&g<=65135,"Arabic Presentation Forms-B":g=>g>=65136&&g<=65279,"Halfwidth and Fullwidth Forms":g=>g>=65280&&g<=65519,"CJK Unified Ideographs Extension B":g=>g>=131072&&g<=173791};function Hc(g){for(const c of g)if(em(c.charCodeAt(0)))return!0;return!1}function Qp(g){for(const c of g)if(!Md(c.charCodeAt(0)))return!1;return!0}function Md(g){return!(Yn.Arabic(g)||Yn["Arabic Supplement"](g)||Yn["Arabic Extended-A"](g)||Yn["Arabic Presentation Forms-A"](g)||Yn["Arabic Presentation Forms-B"](g))}function em(g){return!(g!==746&&g!==747&&(g<4352||!(Yn["Bopomofo Extended"](g)||Yn.Bopomofo(g)||Yn["CJK Compatibility Forms"](g)&&!(g>=65097&&g<=65103)||Yn["CJK Compatibility Ideographs"](g)||Yn["CJK Compatibility"](g)||Yn["CJK Radicals Supplement"](g)||Yn["CJK Strokes"](g)||!(!Yn["CJK Symbols and Punctuation"](g)||g>=12296&&g<=12305||g>=12308&&g<=12319||g===12336)||Yn["CJK Unified Ideographs Extension A"](g)||Yn["CJK Unified Ideographs"](g)||Yn["Enclosed CJK Letters and Months"](g)||Yn["Hangul Compatibility Jamo"](g)||Yn["Hangul Jamo Extended-A"](g)||Yn["Hangul Jamo Extended-B"](g)||Yn["Hangul Jamo"](g)||Yn["Hangul Syllables"](g)||Yn.Hiragana(g)||Yn["Ideographic Description Characters"](g)||Yn.Kanbun(g)||Yn["Kangxi Radicals"](g)||Yn["Katakana Phonetic Extensions"](g)||Yn.Katakana(g)&&g!==12540||!(!Yn["Halfwidth and Fullwidth Forms"](g)||g===65288||g===65289||g===65293||g>=65306&&g<=65310||g===65339||g===65341||g===65343||g>=65371&&g<=65503||g===65507||g>=65512&&g<=65519)||!(!Yn["Small Form Variants"](g)||g>=65112&&g<=65118||g>=65123&&g<=65126)||Yn["Unified Canadian Aboriginal Syllabics"](g)||Yn["Unified Canadian Aboriginal Syllabics Extended"](g)||Yn["Vertical Forms"](g)||Yn["Yijing Hexagram Symbols"](g)||Yn["Yi Syllables"](g)||Yn["Yi Radicals"](g))))}function Ed(g){return!(em(g)||function(c){return!!(Yn["Latin-1 Supplement"](c)&&(c===167||c===169||c===174||c===177||c===188||c===189||c===190||c===215||c===247)||Yn["General Punctuation"](c)&&(c===8214||c===8224||c===8225||c===8240||c===8241||c===8251||c===8252||c===8258||c===8263||c===8264||c===8265||c===8273)||Yn["Letterlike Symbols"](c)||Yn["Number Forms"](c)||Yn["Miscellaneous Technical"](c)&&(c>=8960&&c<=8967||c>=8972&&c<=8991||c>=8996&&c<=9e3||c===9003||c>=9085&&c<=9114||c>=9150&&c<=9165||c===9167||c>=9169&&c<=9179||c>=9186&&c<=9215)||Yn["Control Pictures"](c)&&c!==9251||Yn["Optical Character Recognition"](c)||Yn["Enclosed Alphanumerics"](c)||Yn["Geometric Shapes"](c)||Yn["Miscellaneous Symbols"](c)&&!(c>=9754&&c<=9759)||Yn["Miscellaneous Symbols and Arrows"](c)&&(c>=11026&&c<=11055||c>=11088&&c<=11097||c>=11192&&c<=11243)||Yn["CJK Symbols and Punctuation"](c)||Yn.Katakana(c)||Yn["Private Use Area"](c)||Yn["CJK Compatibility Forms"](c)||Yn["Small Form Variants"](c)||Yn["Halfwidth and Fullwidth Forms"](c)||c===8734||c===8756||c===8757||c>=9984&&c<=10087||c>=10102&&c<=10131||c===65532||c===65533)}(g))}function Fg(g){return g>=1424&&g<=2303||Yn["Arabic Presentation Forms-A"](g)||Yn["Arabic Presentation Forms-B"](g)}function Nx(g,c){return!(!c&&Fg(g)||g>=2304&&g<=3583||g>=3840&&g<=4255||Yn.Khmer(g))}function zx(g){for(const c of g)if(Fg(c.charCodeAt(0)))return!0;return!1}const Cd="deferred",cf="loading",Id="loaded";let uf=null,ca="unavailable",lc=null;const Ux=function(g){g&&typeof g=="string"&&g.indexOf("NetworkError")>-1&&(ca="error"),uf&&uf(g)};function s_(){Ng.fire(new Ql("pluginStateChange",{pluginStatus:ca,pluginURL:lc}))}const Ng=new ju,zg=function(){return ca},Ug=function(){if(ca!==Cd||!lc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ca=cf,s_(),lc&&Ds({url:lc},g=>{g?Ux(g):(ca=Id,s_())})},No={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ca===Id||No.applyArabicShaping!=null,isLoading:()=>ca===cf,setState(g){ca=g.pluginStatus,lc=g.pluginURL},isParsed:()=>No.applyArabicShaping!=null&&No.processBidirectionalText!=null&&No.processStyledBidirectionalText!=null,getPluginURL:()=>lc};class ds{constructor(c,d){this.zoom=c,d?(this.now=d.now,this.fadeDuration=d.fadeDuration,this.transition=d.transition,this.pitch=d.pitch,this.brightness=d.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(c){return function(d,_){for(const A of d)if(!Nx(A.charCodeAt(0),_))return!1;return!0}(c,No.isLoaded())}}class hf{constructor(c,d,_,A){this.property=c,this.value=d,this.expression=function(x,T,B,U){if(qp(x))return new Td(x,T);if(Sd(x)||Array.isArray(x)&&x.length>0){const j=r_(x,T,B,U);if(j.result==="error")throw new Error(j.value.map(R=>`${R.key}: ${R.message}`).join(", "));return j.value}{let j=x;return typeof x=="string"&&T.type==="color"&&(j=vr.parse(x)),{kind:"constant",configDependencies:new Set,evaluate:()=>j}}}(d===void 0?c.specification.default:d,c.specification,_,A)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(c,d,_){return this.property.possiblyEvaluate(this,c,d,_)}}class Rd{constructor(c,d,_){this.property=c,this.value=new hf(c,void 0,d,_)}transitioned(c,d){return new nm(this.property,this.value,d,Sr({},c.transition,this.transition),c.now)}untransitioned(){return new nm(this.property,this.value,null,{},0)}}class tm{constructor(c,d,_){this._properties=c,this._values=Object.create(c.defaultTransitionablePropertyValues),this._scope=d,this._options=_,this.configDependencies=new Set}getValue(c){return xi(this._values[c].value.value)}setValue(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new Rd(this._values[c].property,this._scope,this._options)),this._values[c].value=new hf(this._values[c].property,d===null?void 0:xi(d),this._scope,this._options),this._values[c].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[c].value.expression.configDependencies]))}setTransitionOrValue(c,d){d&&(this._options=d);const _=this._properties.properties;if(c)for(const A in c){const x=c[A];if(ar(A,"-transition")){const T=A.slice(0,-11);_[T]&&this.setTransition(T,x)}else _.hasOwnProperty(A)&&this.setValue(A,x)}}getTransition(c){return xi(this._values[c].transition)}setTransition(c,d){this._values.hasOwnProperty(c)||(this._values[c]=new Rd(this._values[c].property)),this._values[c].transition=xi(d)||void 0}serialize(){const c={};for(const d of Object.keys(this._values)){const _=this.getValue(d);_!==void 0&&(c[d]=_);const A=this.getTransition(d);A!==void 0&&(c[`${d}-transition`]=A)}return c}transitioned(c,d){const _=new Pd(this._properties);for(const A of Object.keys(this._values))_._values[A]=this._values[A].transitioned(c,d._values[A]);return _}untransitioned(){const c=new Pd(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].untransitioned();return c}}class nm{constructor(c,d,_,A,x){const T=A.delay||0,B=A.duration||0;x=x||0,this.property=c,this.value=d,this.begin=x+T,this.end=this.begin+B,c.specification.transition&&(A.delay||A.duration)&&(this.prior=_)}possiblyEvaluate(c,d,_){const A=c.now||0,x=this.value.possiblyEvaluate(c,d,_),T=this.prior;if(T){if(A>this.end)return this.prior=null,x;if(this.value.isDataDriven())return this.prior=null,x;if(A<this.begin)return T.possiblyEvaluate(c,d,_);{const B=(A-this.begin)/(this.end-this.begin);return this.property.interpolate(T.possiblyEvaluate(c,d,_),x,Xt(B))}}return x}}class Pd{constructor(c){this._properties=c,this._values=Object.create(c.defaultTransitioningPropertyValues)}possiblyEvaluate(c,d,_){const A=new th(this._properties);for(const x of Object.keys(this._values))A._values[x]=this._values[x].possiblyEvaluate(c,d,_);return A}hasTransition(){for(const c of Object.keys(this._values))if(this._values[c].prior)return!0;return!1}}class a_{constructor(c,d,_){this._properties=c,this._values=Object.create(c.defaultPropertyValues),this._scope=d,this._options=_,this.configDependencies=new Set}getValue(c){return xi(this._values[c].value)}setValue(c,d){this._values[c]=new hf(this._values[c].property,d===null?void 0:xi(d),this._scope,this._options),this._values[c].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[c].expression.configDependencies]))}serialize(){const c={};for(const d of Object.keys(this._values)){const _=this.getValue(d);_!==void 0&&(c[d]=_)}return c}possiblyEvaluate(c,d,_){const A=new th(this._properties);for(const x of Object.keys(this._values))A._values[x]=this._values[x].possiblyEvaluate(c,d,_);return A}}class eh{constructor(c,d,_){this.property=c,this.value=d,this.parameters=_}isConstant(){return this.value.kind==="constant"}constantOr(c){return this.value.kind==="constant"?this.value.value:c}evaluate(c,d,_,A){return this.property.evaluate(this.value,this.parameters,c,d,_,A)}}class th{constructor(c){this._properties=c,this._values=Object.create(c.defaultPossiblyEvaluatedValues)}get(c){return this._values[c]}}class gn{constructor(c){this.specification=c}possiblyEvaluate(c,d){return c.expression.evaluate(d)}interpolate(c,d,_){const A=jh[this.specification.type];return A?A(c,d,_):c}}class Kn{constructor(c,d){this.specification=c,this.overrides=d}possiblyEvaluate(c,d,_,A){return new eh(this,c.expression.kind==="constant"||c.expression.kind==="camera"?{kind:"constant",value:c.expression.evaluate(d,null,{},_,A)}:c.expression,d)}interpolate(c,d,_){if(c.value.kind!=="constant"||d.value.kind!=="constant")return c;if(c.value.value===void 0||d.value.value===void 0)return new eh(this,{kind:"constant",value:void 0},c.parameters);const A=jh[this.specification.type];return A?new eh(this,{kind:"constant",value:A(c.value.value,d.value.value,_)},c.parameters):c}evaluate(c,d,_,A,x,T){return c.kind==="constant"?c.value:c.evaluate(d,_,A,x,T)}}class cc{constructor(c){this.specification=c}possiblyEvaluate(c,d,_,A){return!!c.expression.evaluate(d,null,{},_,A)}interpolate(){return!1}}class Wi{constructor(c){this.properties=c,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const d=new ds(0,{});for(const _ in c){const A=c[_];A.specification.overridable&&this.overridableProperties.push(_);const x=this.defaultPropertyValues[_]=new hf(A,void 0),T=this.defaultTransitionablePropertyValues[_]=new Rd(A);this.defaultTransitioningPropertyValues[_]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[_]=x.possiblyEvaluate(d)}}}Fn(Kn,"DataDrivenProperty"),Fn(gn,"DataConstantProperty"),Fn(cc,"ColorRampProperty");var At=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{"experimental":true}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant","experimental":true},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant","experimental":true}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ks(g){return g instanceof Number||g instanceof String||g instanceof Boolean?g.valueOf():g}function di(g){if(Array.isArray(g))return g.map(di);if(g instanceof Object&&!(g instanceof Number||g instanceof String||g instanceof Boolean)){const c={};for(const d in g)c[d]=di(g[d]);return c}return ks(g)}function Js(g){if(g===!0||g===!1)return!0;if(!Array.isArray(g)||g.length===0)return!1;switch(g[0]){case"has":return g.length>=2&&g[1]!=="$id"&&g[1]!=="$type";case"in":return g.length>=3&&(typeof g[1]!="string"||Array.isArray(g[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return g.length!==3||Array.isArray(g[1])||Array.isArray(g[2]);case"any":case"all":for(const c of g.slice(1))if(!Js(c)&&typeof c!="boolean")return!1;return!0;default:return!0}}function rs(g,c="",d=null,_="fill"){if(g==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Js(g)||(g=df(g));const A=g;let x=!0;try{x=function(N){if(!uc(N))return N;let V=di(N);return ka(V),V=Ba(V),V}(A)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(A,null,2)}
        `)}const T=At[`filter_${_}`],B=Ad(x,T,c,d);let U=null;if(B.result==="error")throw new Error(B.value.map(N=>`${N.key}: ${N.message}`).join(", "));U=(N,V,z)=>B.value.evaluate(N,V,{},z);let j=null,R=null;if(x!==A){const N=Ad(A,T,c,d);if(N.result==="error")throw new Error(N.value.map(V=>`${V.key}: ${V.message}`).join(", "));j=(V,z,G,$,K)=>N.value.evaluate(V,z,{},G,void 0,void 0,$,K),R=!tf(N.value.expression)}return{filter:U,dynamicFilter:j||void 0,needGeometry:ff(x),needFeature:!!R}}function Ba(g){if(!Array.isArray(g))return g;const c=function(d){if(Oa.has(d[0])){for(let _=1;_<d.length;_++)if(uc(d[_]))return!0}return d}(g);return c===!0?c:c.map(d=>Ba(d))}function ka(g){let c=!1;const d=[];if(g[0]==="case"){for(let _=1;_<g.length-1;_+=2)c=c||uc(g[_]),d.push(g[_+1]);d.push(g[g.length-1])}else if(g[0]==="match"){c=c||uc(g[1]);for(let _=2;_<g.length-1;_+=2)d.push(g[_+1]);d.push(g[g.length-1])}else if(g[0]==="step"){c=c||uc(g[1]);for(let _=1;_<g.length-1;_+=2)d.push(g[_+1])}c&&(g.length=0,g.push("any",...d));for(let _=1;_<g.length;_++)ka(g[_])}function uc(g){if(!Array.isArray(g))return!1;if((c=g[0])==="pitch"||c==="distance-from-center")return!0;var c;for(let d=1;d<g.length;d++)if(uc(g[d]))return!0;return!1}const Oa=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function rm(g,c){return g<c?-1:g>c?1:0}function ff(g){if(!Array.isArray(g))return!1;if(g[0]==="within"||g[0]==="distance")return!0;for(let c=1;c<g.length;c++)if(ff(g[c]))return!0;return!1}function df(g){if(!g)return!0;const c=g[0];return g.length<=1?c!=="any":c==="=="?Ld(g[1],g[2],"=="):c==="!="?pf(Ld(g[1],g[2],"==")):c==="<"||c===">"||c==="<="||c===">="?Ld(g[1],g[2],c):c==="any"?(d=g.slice(1),["any"].concat(d.map(df))):c==="all"?["all"].concat(g.slice(1).map(df)):c==="none"?["all"].concat(g.slice(1).map(df).map(pf)):c==="in"?nh(g[1],g.slice(2)):c==="!in"?pf(nh(g[1],g.slice(2))):c==="has"?Ya(g[1]):c!=="!has"||pf(Ya(g[1]));var d}function Ld(g,c,d){switch(g){case"$type":return[`filter-type-${d}`,c];case"$id":return[`filter-id-${d}`,c];default:return[`filter-${d}`,g,c]}}function nh(g,c){if(c.length===0)return!1;switch(g){case"$type":return["filter-type-in",["literal",c]];case"$id":return["filter-id-in",["literal",c]];default:return c.length>200&&!c.some(d=>typeof d!=typeof c[0])?["filter-in-large",g,["literal",c.sort(rm)]]:["filter-in-small",g,["literal",c]]}}function Ya(g){switch(g){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",g]}}function pf(g){return["!",g]}const rh="";function mf(g,c){return c?`${g}${rh}${c}`:g}const Qo="-transition",o_=new Set(["fill","line","background","hillshade","raster"]);class js extends ju{constructor(c,d,_,A,x){if(super(),this.id=c.id,this.fqid=mf(this.id,_),this.type=c.type,this.scope=_,this.lut=A,this.options=x,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,c.type!=="custom"&&(this.metadata=c.metadata,this.minzoom=c.minzoom,this.maxzoom=c.maxzoom,c.type!=="background"&&c.type!=="sky"&&c.type!=="slot"&&(this.source=c.source,this.sourceLayer=c["source-layer"],this.filter=c.filter),c.slot&&(this.slot=c.slot),d.layout&&(this._unevaluatedLayout=new a_(d.layout,this.scope,x),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),d.paint)){this._transitionablePaint=new tm(d.paint,this.scope,x);for(const T in c.paint)this.setPaintProperty(T,c.paint[T]);for(const T in c.layout)this.setLayoutProperty(T,c.layout[T]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new th(d.paint)}}onAdd(c){}onRemove(c){}isDraped(c){return!this.is3D()&&o_.has(this.type)}getLayoutProperty(c){return c==="visibility"?this.visibility:this._unevaluatedLayout.getValue(c)}setLayoutProperty(c,d){if(this.type==="custom"&&c==="visibility")return void(this.visibility=d);const _=this._unevaluatedLayout;_._properties.properties[c]&&(_.setValue(c,d),this.configDependencies=new Set([...this.configDependencies,..._.configDependencies]),c==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})}getPaintProperty(c){return ar(c,Qo)?this._transitionablePaint.getTransition(c.slice(0,-11)):this._transitionablePaint.getValue(c)}setPaintProperty(c,d){const _=this._transitionablePaint,A=_._properties.properties;if(ar(c,Qo)){const N=c.slice(0,-11);return A[N]&&_.setTransition(N,d||void 0),!1}if(!A[c])return!1;const x=_._values[c],T=x.value.isDataDriven(),B=x.value;_.setValue(c,d),this.configDependencies=new Set([...this.configDependencies,..._.configDependencies]),this._handleSpecialPaintPropertyUpdate(c);const U=_._values[c].value,j=U.isDataDriven(),R=ar(c,"pattern")||c==="line-dasharray";return j||T||R||this._handleOverridablePaintPropertyUpdate(c,B,U)}_handleSpecialPaintPropertyUpdate(c){}getProgramIds(){return null}getDefaultProgramParams(c,d,_){return null}_handleOverridablePaintPropertyUpdate(c,d,_){return!1}isHidden(c){return!!(this.minzoom&&c<this.minzoom)||!!(this.maxzoom&&c>=this.maxzoom)||this.visibility==="none"}updateTransitions(c){this._transitioningPaint=this._transitionablePaint.transitioned(c,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(c,d){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(c,void 0,d)),this.paint=this._transitioningPaint.possiblyEvaluate(c,void 0,d)}serialize(){return Hr({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(c,d)=>!(c===void 0||d==="layout"&&!Object.keys(c).length||d==="paint"&&!Object.keys(c).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const c in this.paint._values){const d=this.paint.get(c);if(d instanceof eh&&Xp(d.property.specification)&&(d.value.kind==="source"||d.value.kind==="composite")&&d.value.isStateDependent)return!0}return!1}compileFilter(c){this._filterCompiled||(this._featureFilter=rs(this.filter,this.scope,c),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(c){this._stats&&(c.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(c){}queryIntersectsFeature(c,d,_,A,x,T,B,U,j){}queryIntersectsMatchingFeature(c,d,_,A){}}const Gg={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Pl{constructor(c,d){this._structArray=c,this._pos1=d*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Fi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(c,d){return c._trim(),d&&(c.isTransferred=!0,d.add(c.arrayBuffer)),{length:c.length,arrayBuffer:c.arrayBuffer}}static deserialize(c){const d=Object.create(this.prototype);return d.arrayBuffer=c.arrayBuffer,d.length=c.length,d.capacity=c.arrayBuffer.byteLength/d.bytesPerElement,d._refreshViews(),d}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(c){this.reserve(c),this.length=c}reserve(c){if(c>this.capacity){this.capacity=Math.max(c,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const d=this.uint8;this._refreshViews(),d&&this.uint8.set(d)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...c){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...c){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Qr(g,c=1){let d=0,_=0;return{members:g.map(A=>{const x=Gg[A.type].BYTES_PER_ELEMENT,T=d=Vg(d,Math.max(c,x)),B=A.components||1;return _=Math.max(_,x),d+=x*B,{name:A.name,type:A.type,components:B,offset:T}}),size:Vg(d,Math.max(_,c)),alignment:c}}function Vg(g,c){return Math.ceil(g/c)*c}class hc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d){const _=this.length;return this.resize(_+1),this.emplace(_,c,d)}emplace(c,d,_){const A=2*c;return this.int16[A+0]=d,this.int16[A+1]=_,c}}hc.prototype.bytesPerElement=4,Fn(hc,"StructArrayLayout2i4");class gf extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,_){const A=this.length;return this.resize(A+1),this.emplace(A,c,d,_)}emplace(c,d,_,A){const x=3*c;return this.int16[x+0]=d,this.int16[x+1]=_,this.int16[x+2]=A,c}}gf.prototype.bytesPerElement=6,Fn(gf,"StructArrayLayout3i6");class Qs extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,d,_,A)}emplace(c,d,_,A,x){const T=4*c;return this.int16[T+0]=d,this.int16[T+1]=_,this.int16[T+2]=A,this.int16[T+3]=x,c}}Qs.prototype.bytesPerElement=8,Fn(Qs,"StructArrayLayout4i8");class fc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,_,A,x)}emplace(c,d,_,A,x,T){const B=5*c;return this.int16[B+0]=d,this.int16[B+1]=_,this.int16[B+2]=A,this.int16[B+3]=x,this.int16[B+4]=T,c}}fc.prototype.bytesPerElement=10,Fn(fc,"StructArrayLayout5i10");class el extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,d,_,A,x,T,B)}emplace(c,d,_,A,x,T,B,U){const j=6*c,R=12*c,N=3*c;return this.int16[j+0]=d,this.int16[j+1]=_,this.uint8[R+4]=A,this.uint8[R+5]=x,this.uint8[R+6]=T,this.uint8[R+7]=B,this.float32[N+2]=U,c}}el.prototype.bytesPerElement=12,Fn(el,"StructArrayLayout2i4ub1f12");class Ll extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,d,_,A)}emplace(c,d,_,A,x){const T=4*c;return this.float32[T+0]=d,this.float32[T+1]=_,this.float32[T+2]=A,this.float32[T+3]=x,c}}Ll.prototype.bytesPerElement=16,Fn(Ll,"StructArrayLayout4f16");class ua extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_){const A=this.length;return this.resize(A+1),this.emplace(A,c,d,_)}emplace(c,d,_,A){const x=3*c;return this.float32[x+0]=d,this.float32[x+1]=_,this.float32[x+2]=A,c}}ua.prototype.bytesPerElement=12,Fn(ua,"StructArrayLayout3f12");class jc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,_,A,x)}emplace(c,d,_,A,x,T){const B=6*c,U=3*c;return this.uint16[B+0]=d,this.uint16[B+1]=_,this.uint16[B+2]=A,this.uint16[B+3]=x,this.float32[U+2]=T,c}}jc.prototype.bytesPerElement=12,Fn(jc,"StructArrayLayout4ui1f12");class Au extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,d,_,A)}emplace(c,d,_,A,x){const T=4*c;return this.uint16[T+0]=d,this.uint16[T+1]=_,this.uint16[T+2]=A,this.uint16[T+3]=x,c}}Au.prototype.bytesPerElement=8,Fn(Au,"StructArrayLayout4ui8");class Dd extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T){const B=this.length;return this.resize(B+1),this.emplace(B,c,d,_,A,x,T)}emplace(c,d,_,A,x,T,B){const U=6*c;return this.int16[U+0]=d,this.int16[U+1]=_,this.int16[U+2]=A,this.int16[U+3]=x,this.int16[U+4]=T,this.int16[U+5]=B,c}}Dd.prototype.bytesPerElement=12,Fn(Dd,"StructArrayLayout6i12");class l_ extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B,U,j,R,N,V){const z=this.length;return this.resize(z+1),this.emplace(z,c,d,_,A,x,T,B,U,j,R,N,V)}emplace(c,d,_,A,x,T,B,U,j,R,N,V,z){const G=12*c;return this.int16[G+0]=d,this.int16[G+1]=_,this.int16[G+2]=A,this.int16[G+3]=x,this.uint16[G+4]=T,this.uint16[G+5]=B,this.uint16[G+6]=U,this.uint16[G+7]=j,this.int16[G+8]=R,this.int16[G+9]=N,this.int16[G+10]=V,this.int16[G+11]=z,c}}l_.prototype.bytesPerElement=24,Fn(l_,"StructArrayLayout4i4ui4i24");class Wc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T){const B=this.length;return this.resize(B+1),this.emplace(B,c,d,_,A,x,T)}emplace(c,d,_,A,x,T,B){const U=10*c,j=5*c;return this.int16[U+0]=d,this.int16[U+1]=_,this.int16[U+2]=A,this.float32[j+2]=x,this.float32[j+3]=T,this.float32[j+4]=B,c}}Wc.prototype.bytesPerElement=20,Fn(Wc,"StructArrayLayout3i3f20");class Hg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.uint32[1*c+0]=d,c}}Hg.prototype.bytesPerElement=4,Fn(Hg,"StructArrayLayout1ul4");class Tu extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d){const _=this.length;return this.resize(_+1),this.emplace(_,c,d)}emplace(c,d,_){const A=2*c;return this.uint16[A+0]=d,this.uint16[A+1]=_,c}}Tu.prototype.bytesPerElement=4,Fn(Tu,"StructArrayLayout2ui4");class ih extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B,U,j,R,N,V,z){const G=this.length;return this.resize(G+1),this.emplace(G,c,d,_,A,x,T,B,U,j,R,N,V,z)}emplace(c,d,_,A,x,T,B,U,j,R,N,V,z,G){const $=20*c,K=10*c;return this.int16[$+0]=d,this.int16[$+1]=_,this.int16[$+2]=A,this.int16[$+3]=x,this.int16[$+4]=T,this.float32[K+3]=B,this.float32[K+4]=U,this.float32[K+5]=j,this.float32[K+6]=R,this.int16[$+14]=N,this.uint32[K+8]=V,this.uint16[$+18]=z,this.uint16[$+19]=G,c}}ih.prototype.bytesPerElement=40,Fn(ih,"StructArrayLayout5i4f1i1ul2ui40");class pl extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,d,_,A,x,T,B)}emplace(c,d,_,A,x,T,B,U){const j=8*c;return this.int16[j+0]=d,this.int16[j+1]=_,this.int16[j+2]=A,this.int16[j+4]=x,this.int16[j+5]=T,this.int16[j+6]=B,this.int16[j+7]=U,c}}pl.prototype.bytesPerElement=16,Fn(pl,"StructArrayLayout3i2i2i16");class bo extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,_,A,x)}emplace(c,d,_,A,x,T){const B=4*c,U=8*c;return this.float32[B+0]=d,this.float32[B+1]=_,this.float32[B+2]=A,this.int16[U+6]=x,this.int16[U+7]=T,c}}bo.prototype.bytesPerElement=16,Fn(bo,"StructArrayLayout2f1f2i16");class vf extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T){const B=this.length;return this.resize(B+1),this.emplace(B,c,d,_,A,x,T)}emplace(c,d,_,A,x,T,B){const U=20*c,j=5*c;return this.uint8[U+0]=d,this.uint8[U+1]=_,this.float32[j+1]=A,this.float32[j+2]=x,this.float32[j+3]=T,this.float32[j+4]=B,c}}vf.prototype.bytesPerElement=20,Fn(vf,"StructArrayLayout2ub4f20");class wa extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,_){const A=this.length;return this.resize(A+1),this.emplace(A,c,d,_)}emplace(c,d,_,A){const x=3*c;return this.uint16[x+0]=d,this.uint16[x+1]=_,this.uint16[x+2]=A,c}}wa.prototype.bytesPerElement=6,Fn(wa,"StructArrayLayout3ui6");class Bd extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te,ce,he,ne,de){const ge=this.length;return this.resize(ge+1),this.emplace(ge,c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te,ce,he,ne,de)}emplace(c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te,ce,he,ne,de,ge){const Me=30*c,Be=15*c,Oe=60*c;return this.int16[Me+0]=d,this.int16[Me+1]=_,this.int16[Me+2]=A,this.float32[Be+2]=x,this.float32[Be+3]=T,this.uint16[Me+8]=B,this.uint16[Me+9]=U,this.uint32[Be+5]=j,this.uint32[Be+6]=R,this.uint32[Be+7]=N,this.uint16[Me+16]=V,this.uint16[Me+17]=z,this.uint16[Me+18]=G,this.float32[Be+10]=$,this.float32[Be+11]=K,this.uint8[Oe+48]=te,this.uint8[Oe+49]=ce,this.uint8[Oe+50]=he,this.uint32[Be+13]=ne,this.int16[Me+28]=de,this.uint8[Oe+58]=ge,c}}Bd.prototype.bytesPerElement=60,Fn(Bd,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class c_ extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te,ce,he,ne,de,ge,Me,Be,Oe,Pe,Ye,ze,Qe,ct,ht,ft){const mt=this.length;return this.resize(mt+1),this.emplace(mt,c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te,ce,he,ne,de,ge,Me,Be,Oe,Pe,Ye,ze,Qe,ct,ht,ft)}emplace(c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te,ce,he,ne,de,ge,Me,Be,Oe,Pe,Ye,ze,Qe,ct,ht,ft,mt){const Ct=20*c,_t=40*c,Ut=80*c;return this.float32[Ct+0]=d,this.float32[Ct+1]=_,this.int16[_t+4]=A,this.int16[_t+5]=x,this.int16[_t+6]=T,this.int16[_t+7]=B,this.int16[_t+8]=U,this.int16[_t+9]=j,this.int16[_t+10]=R,this.int16[_t+11]=N,this.int16[_t+12]=V,this.uint16[_t+13]=z,this.uint16[_t+14]=G,this.uint16[_t+15]=$,this.uint16[_t+16]=K,this.uint16[_t+17]=te,this.uint16[_t+18]=ce,this.uint16[_t+19]=he,this.uint16[_t+20]=ne,this.uint16[_t+21]=de,this.uint16[_t+22]=ge,this.uint16[_t+23]=Me,this.uint16[_t+24]=Be,this.uint16[_t+25]=Oe,this.uint16[_t+26]=Pe,this.uint16[_t+27]=Ye,this.uint32[Ct+14]=ze,this.float32[Ct+15]=Qe,this.float32[Ct+16]=ct,this.float32[Ct+17]=ht,this.float32[Ct+18]=ft,this.uint8[Ut+76]=mt,c}}c_.prototype.bytesPerElement=80,Fn(c_,"StructArrayLayout2f9i15ui1ul4f1ub80");class kd extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.float32[1*c+0]=d,c}}kd.prototype.bytesPerElement=4,Fn(kd,"StructArrayLayout1f4");class $c extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x){const T=this.length;return this.resize(T+1),this.emplace(T,c,d,_,A,x)}emplace(c,d,_,A,x,T){const B=5*c;return this.float32[B+0]=d,this.float32[B+1]=_,this.float32[B+2]=A,this.float32[B+3]=x,this.float32[B+4]=T,c}}$c.prototype.bytesPerElement=20,Fn($c,"StructArrayLayout5f20");class jg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,d,_,A,x,T,B)}emplace(c,d,_,A,x,T,B,U){const j=7*c;return this.float32[j+0]=d,this.float32[j+1]=_,this.float32[j+2]=A,this.float32[j+3]=x,this.float32[j+4]=T,this.float32[j+5]=B,this.float32[j+6]=U,c}}jg.prototype.bytesPerElement=28,Fn(jg,"StructArrayLayout7f28");class dc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c,d,_,A){const x=this.length;return this.resize(x+1),this.emplace(x,c,d,_,A)}emplace(c,d,_,A,x){const T=6*c;return this.uint32[3*c+0]=d,this.uint16[T+2]=_,this.uint16[T+3]=A,this.uint16[T+4]=x,c}}dc.prototype.bytesPerElement=12,Fn(dc,"StructArrayLayout1ul3ui12");class u_ extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.uint16[1*c+0]=d,c}}u_.prototype.bytesPerElement=2,Fn(u_,"StructArrayLayout1ui2");class pc extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d){const _=this.length;return this.resize(_+1),this.emplace(_,c,d)}emplace(c,d,_){const A=2*c;return this.float32[A+0]=d,this.float32[A+1]=_,c}}pc.prototype.bytesPerElement=8,Fn(pc,"StructArrayLayout2f8");class Od extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K){const te=this.length;return this.resize(te+1),this.emplace(te,c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K)}emplace(c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te){const ce=16*c;return this.float32[ce+0]=d,this.float32[ce+1]=_,this.float32[ce+2]=A,this.float32[ce+3]=x,this.float32[ce+4]=T,this.float32[ce+5]=B,this.float32[ce+6]=U,this.float32[ce+7]=j,this.float32[ce+8]=R,this.float32[ce+9]=N,this.float32[ce+10]=V,this.float32[ce+11]=z,this.float32[ce+12]=G,this.float32[ce+13]=$,this.float32[ce+14]=K,this.float32[ce+15]=te,c}}Od.prototype.bytesPerElement=64,Fn(Od,"StructArrayLayout16f64");class co extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(c,d,_,A,x,T,B){const U=this.length;return this.resize(U+1),this.emplace(U,c,d,_,A,x,T,B)}emplace(c,d,_,A,x,T,B,U){const j=10*c,R=5*c;return this.uint16[j+0]=d,this.uint16[j+1]=_,this.uint16[j+2]=A,this.uint16[j+3]=x,this.float32[R+2]=T,this.float32[R+3]=B,this.float32[R+4]=U,c}}co.prototype.bytesPerElement=20,Fn(co,"StructArrayLayout4ui3f20");class Wg extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.int16[1*c+0]=d,c}}Wg.prototype.bytesPerElement=2,Fn(Wg,"StructArrayLayout1i2");class im extends Fi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(c){const d=this.length;return this.resize(d+1),this.emplace(d,c)}emplace(c,d){return this.uint8[1*c+0]=d,c}}im.prototype.bytesPerElement=1,Fn(im,"StructArrayLayout1ub1");class Gx extends Pl{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Gx.prototype.size=40;class $g extends ih{get(c){return new Gx(this,c)}}Fn($g,"CollisionBoxArray");class Fd extends Pl{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(c){this._structArray.uint8[this._pos1+49]=c}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(c){this._structArray.uint8[this._pos1+50]=c}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(c){this._structArray.uint32[this._pos4+13]=c}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(c){this._structArray.uint8[this._pos1+58]=c}}Fd.prototype.size=60;class Xg extends Bd{get(c){return new Fd(this,c)}}Fn(Xg,"PlacedSymbolArray");class Vx extends Pl{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(c){this._structArray.uint32[this._pos4+14]=c}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(c){this._structArray.float32[this._pos4+18]=c}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Vx.prototype.size=80;class tl extends c_{get(c){return new Vx(this,c)}}Fn(tl,"SymbolInstanceArray");class qg extends kd{getoffsetX(c){return this.float32[1*c+0]}}Fn(qg,"GlyphOffsetArray");class Zg extends hc{getx(c){return this.int16[2*c+0]}gety(c){return this.int16[2*c+1]}}Fn(Zg,"SymbolLineVertexArray");class Mu extends Pl{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Mu.prototype.size=12;class sm extends dc{get(c){return new Mu(this,c)}}Fn(sm,"FeatureIndexArray");class sh extends Tu{geta_centroid_pos0(c){return this.uint16[2*c+0]}geta_centroid_pos1(c){return this.uint16[2*c+1]}}Fn(sh,"FillExtrusionCentroidArray");class am extends Pl{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}am.prototype.size=6;class om extends gf{get(c){return new am(this,c)}}Fn(om,"FillExtrusionWallArray");const h_=Qr([{name:"a_pos",components:2,type:"Int16"}],4),Hw=Qr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ws{constructor(c=[]){this.segments=c}_prepareSegment(c,d,_,A){let x=this.segments[this.segments.length-1];return c>ws.MAX_VERTEX_ARRAY_LENGTH&&Lt(`Max vertices per segment is ${ws.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${c}`),(!x||x.vertexLength+c>ws.MAX_VERTEX_ARRAY_LENGTH||x.sortKey!==A)&&(x={vertexOffset:d,primitiveOffset:_,vertexLength:0,primitiveLength:0},A!==void 0&&(x.sortKey=A),this.segments.push(x)),x}prepareSegment(c,d,_,A){return this._prepareSegment(c,d.length,_.length,A)}get(){return this.segments}destroy(){for(const c of this.segments)for(const d in c.vaos)c.vaos[d].destroy()}static simpleSegment(c,d,_,A){return new ws([{vertexOffset:c,primitiveOffset:d,vertexLength:_,primitiveLength:A,vaos:{},sortKey:0}])}}function f_(g,c){return 256*(g=jt(Math.floor(g),0,255))+jt(Math.floor(c),0,255)}ws.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Fn(ws,"SegmentVector");const Hx=Qr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),jx=Qr([{name:"a_dash",components:4,type:"Uint16"}]);class _f{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(c,d,_,A){this.ids.push(Wx(c)),this.positions.push(d,_,A)}eachPosition(c,d){const _=Wx(c);let A=0,x=this.ids.length-1;for(;A<x;){const T=A+x>>1;this.ids[T]>=_?x=T:A=T+1}for(;this.ids[A]===_;)d(this.positions[3*A],this.positions[3*A+1],this.positions[3*A+2]),A++}static serialize(c,d){const _=new Float64Array(c.ids),A=new Uint32Array(c.positions);return Nd(_,A,0,_.length-1),d&&(d.add(_.buffer),d.add(A.buffer)),{ids:_,positions:A}}static deserialize(c){const d=new _f;let _;d.ids=c.ids,d.positions=c.positions;for(const A of d.ids)A!==_&&d.uniqueIds.push(A),_=A;return d.indexed=!0,d}}function Wx(g){const c=+g;return!isNaN(c)&&Number.MIN_SAFE_INTEGER<=c&&c<=Number.MAX_SAFE_INTEGER?c:Xa(String(g))}function Nd(g,c,d,_){for(;d<_;){const A=g[d+_>>1];let x=d-1,T=_+1;for(;;){do x++;while(g[x]<A);do T--;while(g[T]>A);if(x>=T)break;D(g,x,T),D(c,3*x,3*T),D(c,3*x+1,3*T+1),D(c,3*x+2,3*T+2)}T-d<_-T?(Nd(g,c,d,T),d=T+1):(Nd(g,c,T+1,_),_=T)}}function D(g,c,d){const _=g[c];g[c]=g[d],g[d]=_}Fn(_f,"FeaturePositionMap");class O{constructor(c){this.gl=c.gl,this.initialized=!1}fetchUniformLocation(c,d){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(c,d),this.initialized=!0),!!this.location}set(c,d,_){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Y extends O{constructor(c){super(c),this.current=0}set(c,d,_){this.fetchUniformLocation(c,d)&&this.current!==_&&(this.current=_,this.gl.uniform1i(this.location,_))}}class se extends O{constructor(c){super(c),this.current=0}set(c,d,_){this.fetchUniformLocation(c,d)&&this.current!==_&&(this.current=_,this.gl.uniform1f(this.location,_))}}class pe extends O{constructor(c){super(c),this.current=[0,0]}set(c,d,_){this.fetchUniformLocation(c,d)&&(_[0]===this.current[0]&&_[1]===this.current[1]||(this.current=_,this.gl.uniform2f(this.location,_[0],_[1])))}}class Te extends O{constructor(c){super(c),this.current=[0,0,0]}set(c,d,_){this.fetchUniformLocation(c,d)&&(_[0]===this.current[0]&&_[1]===this.current[1]&&_[2]===this.current[2]||(this.current=_,this.gl.uniform3f(this.location,_[0],_[1],_[2])))}}class dt extends O{constructor(c){super(c),this.current=[0,0,0,0]}set(c,d,_){this.fetchUniformLocation(c,d)&&(_[0]===this.current[0]&&_[1]===this.current[1]&&_[2]===this.current[2]&&_[3]===this.current[3]||(this.current=_,this.gl.uniform4f(this.location,_[0],_[1],_[2],_[3])))}}class Ot extends O{constructor(c){super(c),this.current=vr.transparent.toRenderColor(null)}set(c,d,_){this.fetchUniformLocation(c,d)&&(_.r===this.current.r&&_.g===this.current.g&&_.b===this.current.b&&_.a===this.current.a||(this.current=_,this.gl.uniform4f(this.location,_.r,_.g,_.b,_.a)))}}const vn=new Float32Array(16);class Wn extends O{constructor(c){super(c),this.current=vn}set(c,d,_){if(this.fetchUniformLocation(c,d)){if(_[12]!==this.current[12]||_[0]!==this.current[0])return this.current=_,void this.gl.uniformMatrix4fv(this.location,!1,_);for(let A=1;A<16;A++)if(_[A]!==this.current[A]){this.current=_,this.gl.uniformMatrix4fv(this.location,!1,_);break}}}}const br=new Float32Array(9),oi=new Float32Array(4);class zr extends O{constructor(c){super(c),this.current=oi}set(c,d,_){if(this.fetchUniformLocation(c,d)){for(let A=0;A<4;A++)if(_[A]!==this.current[A]){this.current=_,this.gl.uniformMatrix2fv(this.location,!1,_);break}}}}function ps(g){return[f_(255*g.r,255*g.g),f_(255*g.b,255*g.a)]}class Ir{constructor(c,d,_,A){this.value=c,this.uniformNames=d.map(x=>`u_${x}`),this.type=_,this.context=A}setUniform(c,d,_,A,x){const T=A.constantOr(this.value);d.set(c,x,T instanceof vr?T.toRenderColor(this.context.lut):T)}getBinding(c,d){return this.type==="color"?new Ot(c):new se(c)}}class ha{constructor(c,d){this.uniformNames=d.map(_=>`u_${_}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(c){this.pixelRatio=c.pixelRatio||1,this.pattern=c.tl.concat(c.br)}setUniform(c,d,_,A,x){const T=x==="u_pattern"||x==="u_dash"?this.pattern:x==="u_pixel_ratio"?this.pixelRatio:null;T&&d.set(c,x,T)}getBinding(c,d){return d==="u_pattern"||d==="u_dash"?new dt(c):new se(c)}}class fa{constructor(c,d,_,A){this.expression=c,this.type=_,this.maxValue=0,this.paintVertexAttributes=d.map(x=>({name:`a_${x}`,type:"Float32",components:_==="color"?2:1,offset:0})),this.paintVertexArray=new A}populatePaintArray(c,d,_,A,x,T,B){const U=this.paintVertexArray.length,j=this.expression.evaluate(new ds(0,{brightness:T}),d,{},x,A,B);this.paintVertexArray.resize(c),this._setPaintValue(U,c,j,this.context)}updatePaintArray(c,d,_,A,x,T,B){const U=this.expression.evaluate({zoom:0,brightness:B},_,A,void 0,x);this._setPaintValue(c,d,U,this.context)}_setPaintValue(c,d,_,A){if(this.type==="color"){const x=ps(_.toRenderColor(A.lut));for(let T=c;T<d;T++)this.paintVertexArray.emplace(T,x[0],x[1])}else{for(let x=c;x<d;x++)this.paintVertexArray.emplace(x,_);this.maxValue=Math.max(this.maxValue,Math.abs(_))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class $t{constructor(c,d,_,A,x,T){this.expression=c,this.uniformNames=d.map(B=>`u_${B}_t`),this.type=_,this.useIntegerZoom=A,this.context=x,this.maxValue=0,this.paintVertexAttributes=d.map(B=>({name:`a_${B}`,type:"Float32",components:_==="color"?4:2,offset:0})),this.paintVertexArray=new T}populatePaintArray(c,d,_,A,x,T,B){const U=this.expression.evaluate(new ds(this.context.zoom,{brightness:T}),d,{},x,A,B),j=this.expression.evaluate(new ds(this.context.zoom+1,{brightness:T}),d,{},x,A,B),R=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValue(R,c,U,j,this.context)}updatePaintArray(c,d,_,A,x,T,B){const U=this.expression.evaluate({zoom:this.context.zoom,brightness:B},_,A,void 0,x),j=this.expression.evaluate({zoom:this.context.zoom+1,brightness:B},_,A,void 0,x);this._setPaintValue(c,d,U,j,this.context)}_setPaintValue(c,d,_,A,x){if(this.type==="color"){const T=ps(_.toRenderColor(x.lut)),B=ps(_.toRenderColor(x.lut));for(let U=c;U<d;U++)this.paintVertexArray.emplace(U,T[0],T[1],B[0],B[1])}else{for(let T=c;T<d;T++)this.paintVertexArray.emplace(T,_,A);this.maxValue=Math.max(this.maxValue,Math.abs(_),Math.abs(A))}}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(c,d,_,A,x){const T=this.useIntegerZoom?Math.floor(_.zoom):_.zoom,B=jt(this.expression.interpolationFactor(T,this.context.zoom,this.context.zoom+1),0,1);d.set(c,x,B)}getBinding(c,d){return new se(c)}}class Nt{constructor(c,d,_,A,x){this.expression=c,this.layerId=x,this.paintVertexAttributes=(_==="array"?jx:Hx).members;for(let T=0;T<d.length;++T);this.paintVertexArray=new A}populatePaintArray(c,d,_,A){const x=this.paintVertexArray.length;this.paintVertexArray.resize(c),this._setPaintValues(x,c,d.patterns&&d.patterns[this.layerId],_)}updatePaintArray(c,d,_,A,x,T,B){this._setPaintValues(c,d,_.patterns&&_.patterns[this.layerId],T)}_setPaintValues(c,d,_,A){if(!A||!_)return;const x=A[_];if(!x)return;const{tl:T,br:B,pixelRatio:U}=x;for(let j=c;j<d;j++)this.paintVertexArray.emplace(j,T[0],T[1],B[0],B[1],U)}upload(c){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=c.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class an{constructor(c,d,_=()=>!0){this.binders={},this._buffers=[],this.context=d;const A=[];for(const x in c.paint._values){const T=c.paint.get(x);if(!_(x)||!(T instanceof eh&&Xp(T.property.specification)))continue;const B=vi(x,c.type),U=T.value,j=T.property.specification.type,R=!!T.property.useIntegerZoom,N=x==="line-dasharray"||x.endsWith("pattern"),V=x==="line-dasharray"&&c.layout.get("line-cap").value.kind!=="constant";if(U.kind!=="constant"||V)if(U.kind==="source"||V||N){const z=b(x,j,"source");this.binders[x]=N?new Nt(U,B,j,z,c.id):new fa(U,B,j,z),A.push(`/a_${x}`)}else{const z=b(x,j,"composite");this.binders[x]=new $t(U,B,j,R,d,z),A.push(`/z_${x}`)}else this.binders[x]=N?new ha(U.value,B):new Ir(U.value,B,j,d),A.push(`/u_${x}`)}this.cacheKey=A.sort().join("")}getMaxValue(c){const d=this.binders[c];return d instanceof fa||d instanceof $t?d.maxValue:0}populatePaintArrays(c,d,_,A,x,T,B){for(const U in this.binders){const j=this.binders[U];j.context=this.context,(j instanceof fa||j instanceof $t||j instanceof Nt)&&j.populatePaintArray(c,d,_,A,x,T,B)}}setConstantPatternPositions(c){for(const d in this.binders){const _=this.binders[d];_ instanceof ha&&_.setConstantPatternPositions(c)}}updatePaintArrays(c,d,_,A,x,T,B,U){let j=!1;const R=Object.keys(c),N=R.length!==0,V=N?R:d.uniqueIds;this.context.lut=x.lut;for(const z in this.binders){const G=this.binders[z];if(G.context=this.context,(G instanceof fa||G instanceof $t||G instanceof Nt)&&(G.expression.isStateDependent===!0||G.expression.isLightConstant===!1)){const $=x.paint.get(z);G.expression=$.value;for(const K of V){const te=c[K.toString()];d.eachPosition(K,(ce,he,ne)=>{const de=A.feature(ce);G.updatePaintArray(he,ne,de,te,T,B,U)})}if(!N)for(const K of _.uniqueIds){const te=c[K.toString()];_.eachPosition(K,(ce,he,ne)=>{const de=A.feature(ce);G.updatePaintArray(he,ne,de,te,T,B,U)})}j=!0}}return j}defines(){const c=[];for(const d in this.binders){const _=this.binders[d];(_ instanceof Ir||_ instanceof ha)&&c.push(..._.uniformNames.map(A=>`#define HAS_UNIFORM_${A}`))}return c}getBinderAttributes(){const c=[];for(const d in this.binders){const _=this.binders[d];if(_ instanceof fa||_ instanceof $t||_ instanceof Nt)for(let A=0;A<_.paintVertexAttributes.length;A++)c.push(_.paintVertexAttributes[A].name)}return c}getBinderUniforms(){const c=[];for(const d in this.binders){const _=this.binders[d];if(_ instanceof Ir||_ instanceof ha||_ instanceof $t)for(const A of _.uniformNames)c.push(A)}return c}getPaintVertexBuffers(){return this._buffers}getUniforms(c){const d=[];for(const _ in this.binders){const A=this.binders[_];if(A instanceof Ir||A instanceof ha||A instanceof $t)for(const x of A.uniformNames)d.push({name:x,property:_,binding:A.getBinding(c,x)})}return d}setUniforms(c,d,_,A,x){for(const{name:T,property:B,binding:U}of _)this.binders[B].setUniform(c,U,x,A.get(B),T)}updatePaintBuffers(){this._buffers=[];for(const c in this.binders){const d=this.binders[c];(d instanceof fa||d instanceof $t||d instanceof Nt)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(c){for(const d in this.binders){const _=this.binders[d];(_ instanceof fa||_ instanceof $t||_ instanceof Nt)&&_.upload(c)}this.updatePaintBuffers()}destroy(){for(const c in this.binders){const d=this.binders[c];(d instanceof fa||d instanceof $t||d instanceof Nt)&&d.destroy()}}}class rr{constructor(c,d,_=()=>!0){this.programConfigurations={};for(const A of c)this.programConfigurations[A.id]=new an(A,d,_);this.needsUpload=!1,this._featureMap=new _f,this._featureMapWithoutIds=new _f,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(c,d,_,A,x,T,B,U){for(const j in this.programConfigurations)this.programConfigurations[j].populatePaintArrays(c,d,A,x,T,B,U);d.id!==void 0?this._featureMap.add(d.id,_,this._bufferOffset,c):(this._featureMapWithoutIds.add(this._idlessCounter,_,this._bufferOffset,c),this._idlessCounter+=1),this._bufferOffset=c,this.needsUpload=!0}updatePaintArrays(c,d,_,A,x,T){for(const B of _)this.needsUpload=this.programConfigurations[B.id].updatePaintArrays(c,this._featureMap,this._featureMapWithoutIds,d,B,A,x,T||0)||this.needsUpload}get(c){return this.programConfigurations[c]}upload(c){if(this.needsUpload){for(const d in this.programConfigurations)this.programConfigurations[d].upload(c);this.needsUpload=!1}}destroy(){for(const c in this.programConfigurations)this.programConfigurations[c].destroy()}}const Rr={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function vi(g,c){return Rr[g]||[g.replace(`${c}-`,"").replace(/-/g,"_")]}const li={"line-pattern":{source:jc,composite:jc},"fill-pattern":{source:jc,composite:jc},"fill-extrusion-pattern":{source:jc,composite:jc},"line-dasharray":{source:Au,composite:Au}},zi={color:{source:pc,composite:Ll},number:{source:kd,composite:pc}};function b(g,c,d){const _=li[g];return _&&_[d]||zi[c][d]}Fn(Ir,"ConstantBinder"),Fn(ha,"PatternConstantBinder"),Fn(fa,"SourceExpressionBinder"),Fn(Nt,"PatternCompositeBinder"),Fn($t,"CompositeExpressionBinder"),Fn(an,"ProgramConfiguration",{omit:["_buffers"]}),Fn(rr,"ProgramConfigurationSet");const u=yn/Math.PI/2,m=5,w=6,I=16383,P=64,F=[P,32,16],W=-u,q=u;function J(g,c,d,_=u){return d=sn(d),[g*Math.sin(d)*_,-c*_,g*Math.cos(d)*_]}function ee(g,c,d){return J(Math.cos(sn(g)),Math.sin(sn(g)),c,d)}const ae=63710088e-1,le=2*Math.PI*ae;class ue{constructor(c,d){if(isNaN(c)||isNaN(d))throw new Error(`Invalid LngLat object: (${c}, ${d})`);if(this.lng=+c,this.lat=+d,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ue(Un(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(c){const d=Math.PI/180,_=this.lat*d,A=c.lat*d,x=Math.sin(_)*Math.sin(A)+Math.cos(_)*Math.cos(A)*Math.cos((c.lng-this.lng)*d);return ae*Math.acos(Math.min(x,1))}toBounds(c=0){const d=360*c/40075017,_=d/Math.cos(Math.PI/180*this.lat);return new ve({lng:this.lng-_,lat:this.lat-d},{lng:this.lng+_,lat:this.lat+d})}toEcef(c){return ee(this.lat,this.lng,u+c*u/ae)}static convert(c){if(c instanceof ue)return c;if(Array.isArray(c)&&(c.length===2||c.length===3))return new ue(Number(c[0]),Number(c[1]));if(!Array.isArray(c)&&typeof c=="object"&&c!==null)return new ue(Number("lng"in c?c.lng:c.lon),Number(c.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class ve{constructor(c,d){if(c)if(d)this.setSouthWest(c).setNorthEast(d);else if(c.length===4){const _=c;this.setSouthWest([_[0],_[1]]).setNorthEast([_[2],_[3]])}else{const _=c;this.setSouthWest(_[0]).setNorthEast(_[1])}}setNorthEast(c){return this._ne=c instanceof ue?new ue(c.lng,c.lat):ue.convert(c),this}setSouthWest(c){return this._sw=c instanceof ue?new ue(c.lng,c.lat):ue.convert(c),this}extend(c){const d=this._sw,_=this._ne;let A,x;if(c instanceof ue)A=c,x=c;else{if(!(c instanceof ve))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(ve.convert(c)):this.extend(ue.convert(c)):typeof c=="object"&&c!==null&&c.hasOwnProperty("lat")&&(c.hasOwnProperty("lon")||c.hasOwnProperty("lng"))?this.extend(ue.convert(c)):this;if(A=c._sw,x=c._ne,!A||!x)return this}return d||_?(d.lng=Math.min(A.lng,d.lng),d.lat=Math.min(A.lat,d.lat),_.lng=Math.max(x.lng,_.lng),_.lat=Math.max(x.lat,_.lat)):(this._sw=new ue(A.lng,A.lat),this._ne=new ue(x.lng,x.lat)),this}getCenter(){return new ue((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ue(this.getWest(),this.getNorth())}getSouthEast(){return new ue(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(c){const{lng:d,lat:_}=ue.convert(c);let A=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(A=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=_&&_<=this._ne.lat&&A}static convert(c){if(c)return c instanceof ve?c:new ve(c)}}const ye=0,be=25.5;function we(g){return le*Math.cos(g*Math.PI/180)}function ke(g){return(180+g)/360}function Ne(g){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+g*Math.PI/360)))/360}function De(g,c){return g/we(c)}function $e(g){return 360*g-180}function je(g){return 360/Math.PI*Math.atan(Math.exp((180-360*g)*Math.PI/180))-90}function et(g,c){return g*we(je(c))}const Ke=85.051129;function tt(g){return Math.cos(sn(jt(g,-Ke,Ke)))}function ut(g,c){const d=jt(c,ye,be),_=Math.pow(2,d);return tt(g)*le/(512*_)}function at(g){return 1/Math.cos(g*Math.PI/180)}function rt(g,c=0){const d=Math.exp(Math.PI*(1-(g.y+c/yn)/(1<<g.z)*2));return 80150034*d/(d*d+1)/yn/(1<<g.z)}class bt{constructor(c,d,_=0){this.x=+c,this.y=+d,this.z=+_}static fromLngLat(c,d=0){const _=ue.convert(c);return new bt(ke(_.lng),Ne(_.lat),De(d,_.lat))}toLngLat(){return new ue($e(this.x),je(this.y))}toAltitude(){return et(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/le*at(je(this.y))}}function Ft(g,c,d,_,A,x,T,B,U){const j=(c+_)/2,R=(d+A)/2,N=new St(j,R);B(N),function(V,z,G,$,K,te){const ce=G-K,he=$-te;return Math.abs(($-z)*ce-(G-V)*he)/Math.hypot(ce,he)}(N.x,N.y,x.x,x.y,T.x,T.y)>=U?(Ft(g,c,d,j,R,x,N,B,U),Ft(g,j,R,_,A,N,T,B,U)):g.push(T)}function Zt(g,c,d){let _=g[0],A=_.x,x=_.y;c(_);const T=[_];for(let B=1;B<g.length;B++){const U=g[B],{x:j,y:R}=U;c(U),Ft(T,A,x,j,R,_,U,c,d),A=j,x=R,_=U}return T}function kt(g,c,d,_){if(_(c,d)){const A=c.add(d)._mult(.5);kt(g,c,A,_),kt(g,A,d,_)}else g.push(d)}function hn(g,c){let d=g[0];const _=[d];for(let A=1;A<g.length;A++){const x=g[A];kt(_,d,x,c),d=x}return _}const wt=Math.pow(2,14)-1,Wt=-wt-1;function Gt(g,c){const d=Math.round(g.x*c),_=Math.round(g.y*c);return g.x=jt(d,Wt,wt),g.y=jt(_,Wt,wt),(d<g.x||d>g.x+1||_<g.y||_>g.y+1)&&Lt("Geometry exceeds allowed extent, reduce your vector tile buffer size"),g}function fn(g,c,d){const _=g.loadGeometry(),A=g.extent,x=yn/A;if(c&&d&&d.projection.isReprojectedInTileSpace){const T=1<<c.z,{scale:B,x:U,y:j,projection:R}=d,N=V=>{const z=$e((c.x+V.x/A)/T),G=je((c.y+V.y/A)/T),$=R.project(z,G);V.x=($.x*B-U)*A,V.y=($.y*B-j)*A};for(let V=0;V<_.length;V++)if(g.type!==1)_[V]=Zt(_[V],N,1);else{const z=[];for(const G of _[V])G.x<0||G.x>=A||G.y<0||G.y>=A||(N(G),z.push(G));_[V]=z}}for(const T of _)for(const B of T)Gt(B,x);return _}function pn(g,c){return{type:g.type,id:g.id,properties:g.properties,geometry:c?fn(g):[]}}function qt(g,c,d,_,A){g.emplaceBack(2*c+(_+1)/2,2*d+(A+1)/2)}function en(g,c,d){g.emplaceBack(c.x,c.y,c.z,d[0]*16384,d[1]*16384,d[2]*16384)}class er{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=c.index,this.hasPattern=!1,this.projection=c.projection,this.layoutVertexArray=new hc,this.indexArray=new wa,this.segments=new ws,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut}),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id)}updateFootprints(c,d){}populate(c,d,_,A){const x=this.layers[0],T=[];let B=null;x.type==="circle"&&(B=x.layout.get("circle-sort-key"));for(const{feature:j,id:R,index:N,sourceLayerIndex:V}of c){const z=this.layers[0]._featureFilter.needGeometry,G=pn(j,z);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),G,_))continue;const $=B?B.evaluate(G,{},_):void 0,K={id:R,properties:j.properties,type:j.type,sourceLayerIndex:V,index:N,geometry:z?G.geometry:fn(j,_,A),patterns:{},sortKey:$};T.push(K)}B&&T.sort((j,R)=>j.sortKey-R.sortKey);let U=null;A.projection.name==="globe"&&(this.globeExtVertexArray=new Dd,U=A.projection);for(const j of T){const{geometry:R,index:N,sourceLayerIndex:V}=j,z=c[N].feature;this.addFeature(j,R,N,d.availableImages,_,U,d.brightness),d.featureIndex.insert(z,R,N,V,this.index)}}update(c,d,_,A,x){const T=Object.keys(c).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(c,d,T?this.stateDependentLayers:this.layers,_,A,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,h_.members),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=c.createVertexBuffer(this.globeExtVertexArray,Hw.members))),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(c,d,_,A,x,T,B){for(const U of d)for(const j of U){const R=j.x,N=j.y;if(R<0||R>=yn||N<0||N>=yn)continue;if(T){const G=T.projectTilePoint(R,N,x),$=T.upVector(x,R,N),K=this.globeExtVertexArray;en(K,G,$),en(K,G,$),en(K,G,$),en(K,G,$)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,c.sortKey),z=V.vertexLength;qt(this.layoutVertexArray,R,N,-1,-1),qt(this.layoutVertexArray,R,N,1,-1),qt(this.layoutVertexArray,R,N,1,1),qt(this.layoutVertexArray,R,N,-1,1),this.indexArray.emplaceBack(z,z+1,z+2),this.indexArray.emplaceBack(z,z+2,z+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,{},A,x,B)}}function xn(g,c){for(let d=0;d<g.length;d++)if(is(c,g[d]))return!0;for(let d=0;d<c.length;d++)if(is(g,c[d]))return!0;return!!ur(g,c)}function Dn(g,c,d){return!!is(g,c)||!!Br(c,g,d)}function yr(g,c){if(g.length===1)return Ui(c,g[0]);for(let d=0;d<c.length;d++){const _=c[d];for(let A=0;A<_.length;A++)if(is(g,_[A]))return!0}for(let d=0;d<g.length;d++)if(Ui(c,g[d]))return!0;for(let d=0;d<c.length;d++)if(ur(g,c[d]))return!0;return!1}function qn(g,c,d){if(g.length>1){if(ur(g,c))return!0;for(let _=0;_<c.length;_++)if(Br(c[_],g,d))return!0}for(let _=0;_<g.length;_++)if(Br(g[_],c,d))return!0;return!1}function ur(g,c){if(g.length===0||c.length===0)return!1;for(let d=0;d<g.length-1;d++){const _=g[d],A=g[d+1];for(let x=0;x<c.length-1;x++)if(Ur(_,A,c[x],c[x+1]))return!0}return!1}function Ur(g,c,d,_){return Kt(g,d,_)!==Kt(c,d,_)&&Kt(g,c,d)!==Kt(g,c,_)}function Br(g,c,d){const _=d*d;if(c.length===1)return g.distSqr(c[0])<_;for(let A=1;A<c.length;A++)if(Ci(g,c[A-1],c[A])<_)return!0;return!1}function Ci(g,c,d){const _=c.distSqr(d);if(_===0)return g.distSqr(c);const A=((g.x-c.x)*(d.x-c.x)+(g.y-c.y)*(d.y-c.y))/_;return g.distSqr(A<0?c:A>1?d:d.sub(c)._mult(A)._add(c))}function Ui(g,c){let d,_,A,x=!1;for(let T=0;T<g.length;T++){d=g[T];for(let B=0,U=d.length-1;B<d.length;U=B++)_=d[B],A=d[U],_.y>c.y!=A.y>c.y&&c.x<(A.x-_.x)*(c.y-_.y)/(A.y-_.y)+_.x&&(x=!x)}return x}function is(g,c){let d=!1;for(let _=0,A=g.length-1;_<g.length;A=_++){const x=g[_],T=g[A];x.y>c.y!=T.y>c.y&&c.x<(T.x-x.x)*(c.y-x.y)/(T.y-x.y)+x.x&&(d=!d)}return d}function Xc(g,c,d,_,A){for(const T of g)if(c<=T.x&&d<=T.y&&_>=T.x&&A>=T.y)return!0;const x=[new St(c,d),new St(c,A),new St(_,A),new St(_,d)];if(g.length>2){for(const T of x)if(is(g,T))return!0}for(let T=0;T<g.length-1;T++)if(ea(g[T],g[T+1],x))return!0;return!1}function ea(g,c,d){const _=d[0],A=d[2];if(g.x<_.x&&c.x<_.x||g.x>A.x&&c.x>A.x||g.y<_.y&&c.y<_.y||g.y>A.y&&c.y>A.y)return!1;const x=Kt(g,c,d[0]);return x!==Kt(g,c,d[1])||x!==Kt(g,c,d[2])||x!==Kt(g,c,d[3])}function Yr(g,c,d,_,A,x){let T=c.y-g.y,B=g.x-c.x;if(x=x||0){const U=T*T+B*B;if(U===0)return!0;const j=Math.sqrt(U);T/=j,B/=j}return!((d.x-g.x)*T+(d.y-g.y)*B-x<0||(_.x-g.x)*T+(_.y-g.y)*B-x<0||(A.x-g.x)*T+(A.y-g.y)*B-x<0)}function Ni(g,c,d,_,A,x,T){return!(Yr(g,c,_,A,x,T)||Yr(c,d,_,A,x,T)||Yr(d,g,_,A,x,T)||Yr(_,A,g,c,d,T)||Yr(A,x,g,c,d,T)||Yr(x,_,g,c,d,T))}function Ss(g,c,d){const _=c.paint.get(g).value;return _.kind==="constant"?_.value:d.programConfigurations.get(c.id).getMaxValue(g)}function Di(g){return Math.sqrt(g[0]*g[0]+g[1]*g[1])}function kr(g,c,d,_,A){if(!c[0]&&!c[1])return g;const x=St.convert(c)._mult(A);d==="viewport"&&x._rotate(-_);const T=[];for(let B=0;B<g.length;B++)T.push(g[B].sub(x));return T}function pi(g,c,d,_){const A=St.convert(g)._mult(_);return c==="viewport"&&A._rotate(-d),A}let Ti,zs;Fn(er,"CircleBucket",{omit:["layers"]});var ta,ai={exports:{}},Fa=(ta||(ta=1,function(g,c){(function(d){function _(x,T,B){var U=A(256*x,256*(T=Math.pow(2,B)-T-1),B),j=A(256*(x+1),256*(T+1),B);return U[0]+","+U[1]+","+j[0]+","+j[1]}function A(x,T,B){var U=2*Math.PI*6378137/256/Math.pow(2,B);return[x*U-2*Math.PI*6378137/2,T*U-2*Math.PI*6378137/2]}d.getURL=function(x,T,B,U,j,R){return R=R||{},x+"?"+["bbox="+_(B,U,j),"format="+(R.format||"image/png"),"service="+(R.service||"WMS"),"version="+(R.version||"1.1.1"),"request="+(R.request||"GetMap"),"srs="+(R.srs||"EPSG:3857"),"width="+(R.width||256),"height="+(R.height||256),"layers="+T].join("&")},d.getTileBBox=_,d.getMercCoords=A,Object.defineProperty(d,"__esModule",{value:!0})})(c)}(0,ai.exports)),ai.exports);class Ka{constructor(c,d,_){this.z=c,this.x=d,this.y=_,this.key=ml(0,c,c,d,_)}equals(c){return this.z===c.z&&this.x===c.x&&this.y===c.y}url(c,d){const _=Fa.getTileBBox(this.x,this.y,this.z),A=function(x,T,B){let U,j="";for(let R=x;R>0;R--)U=1<<R-1,j+=(T&U?1:0)+(B&U?2:0);return j}(this.z,this.x,this.y);return c[(this.x+this.y)%c.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",_)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Na{constructor(c,d){this.wrap=c,this.canonical=d,this.key=ml(c,d.z,d.z,d.x,d.y)}}class Ki{constructor(c,d,_,A,x){this.overscaledZ=c,this.wrap=d,this.canonical=new Ka(_,+A,+x),this.key=d===0&&c===_?this.canonical.key:ml(d,c,_,A,x)}equals(c){return this.overscaledZ===c.overscaledZ&&this.wrap===c.wrap&&this.canonical.equals(c.canonical)}scaledTo(c){const d=this.canonical.z-c;return c>this.canonical.z?new Ki(c,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ki(c,this.wrap,c,this.canonical.x>>d,this.canonical.y>>d)}calculateScaledKey(c,d=!0){if(this.overscaledZ===c&&d)return this.key;if(c>this.canonical.z)return ml(this.wrap*+d,c,this.canonical.z,this.canonical.x,this.canonical.y);{const _=this.canonical.z-c;return ml(this.wrap*+d,c,c,this.canonical.x>>_,this.canonical.y>>_)}}isChildOf(c){if(c.wrap!==this.wrap)return!1;const d=this.canonical.z-c.canonical.z;return c.overscaledZ===0||c.overscaledZ<this.overscaledZ&&c.canonical.z<this.canonical.z&&c.canonical.x===this.canonical.x>>d&&c.canonical.y===this.canonical.y>>d}children(c){if(this.overscaledZ>=c)return[new Ki(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const d=this.canonical.z+1,_=2*this.canonical.x,A=2*this.canonical.y;return[new Ki(d,this.wrap,d,_,A),new Ki(d,this.wrap,d,_+1,A),new Ki(d,this.wrap,d,_,A+1),new Ki(d,this.wrap,d,_+1,A+1)]}isLessThan(c){return this.wrap<c.wrap||!(this.wrap>c.wrap)&&(this.overscaledZ<c.overscaledZ||!(this.overscaledZ>c.overscaledZ)&&(this.canonical.x<c.canonical.x||!(this.canonical.x>c.canonical.x)&&this.canonical.y<c.canonical.y))}wrapped(){return new Ki(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(c){return new Ki(this.overscaledZ,c,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Na(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function ml(g,c,d,_,A){const x=1<<Math.min(d,22);let T=x*(A%x)+_%x;return g&&d<22&&(T+=x*x*((g<0?-2*g-1:2*g)%(1<<2*(22-d)))),16*(32*T+d)+(c-d)}const gl=[g=>{let c=g.canonical.x-1,d=g.wrap;return c<0&&(c=(1<<g.canonical.z)-1,d--),new Ki(g.overscaledZ,d,g.canonical.z,c,g.canonical.y)},g=>{let c=g.canonical.x+1,d=g.wrap;return c===1<<g.canonical.z&&(c=0,d++),new Ki(g.overscaledZ,d,g.canonical.z,c,g.canonical.y)},g=>new Ki(g.overscaledZ,g.wrap,g.canonical.z,g.canonical.x,(g.canonical.y===0?1<<g.canonical.z:g.canonical.y)-1),g=>new Ki(g.overscaledZ,g.wrap,g.canonical.z,g.canonical.x,g.canonical.y===(1<<g.canonical.z)-1?0:g.canonical.y+1)];Fn(Ka,"CanonicalTileID"),Fn(Ki,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const qc=Qr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:mc}=qc,Dl=Qr([{name:"a_pos_3",components:3,type:"Int16"}]);var Zc=Qr([{name:"a_pos",type:"Int16",components:2}]);class yf{constructor(c,d){this.pos=c,this.dir=d}intersectsPlane(c,d,_){const A=Le.vec3.dot(d,this.dir);if(Math.abs(A)<1e-6)return!1;const x=((c[0]-this.pos[0])*d[0]+(c[1]-this.pos[1])*d[1]+(c[2]-this.pos[2])*d[2])/A;return _[0]=this.pos[0]+this.dir[0]*x,_[1]=this.pos[1]+this.dir[1]*x,_[2]=this.pos[2]+this.dir[2]*x,!0}closestPointOnSphere(c,d,_){if(Le.vec3.equals(this.pos,c)||d===0)return _[0]=_[1]=_[2]=0,!1;const[A,x,T]=this.dir,B=this.pos[0]-c[0],U=this.pos[1]-c[1],j=this.pos[2]-c[2],R=A*A+x*x+T*T,N=2*(B*A+U*x+j*T),V=N*N-4*R*(B*B+U*U+j*j-d*d);if(V<0){const z=Math.max(-N/2,0),G=B+A*z,$=U+x*z,K=j+T*z,te=Math.hypot(G,$,K);return _[0]=G*d/te,_[1]=$*d/te,_[2]=K*d/te,!1}{const z=(-N-Math.sqrt(V))/(2*R);if(z<0){const G=Math.hypot(B,U,j);return _[0]=B*d/G,_[1]=U*d/G,_[2]=j*d/G,!1}return _[0]=B+A*z,_[1]=U+x*z,_[2]=j+T*z,!0}}}class zd{constructor(c,d,_,A,x){this.TL=c,this.TR=d,this.BR=_,this.BL=A,this.horizon=x}static fromInvProjectionMatrix(c,d,_){const A=[-1,1,1],x=[1,1,1],T=[1,-1,1],B=[-1,-1,1],U=Le.vec3.transformMat4(A,A,c),j=Le.vec3.transformMat4(x,x,c),R=Le.vec3.transformMat4(T,T,c),N=Le.vec3.transformMat4(B,B,c);return new zd(U,j,R,N,d/_)}}function ah(g,c,d){let _=1/0,A=-1/0;const x=[];for(const T of g){Le.vec3.sub(x,T,c);const B=Le.vec3.dot(x,d);_=Math.min(_,B),A=Math.max(A,B)}return[_,A]}function Yg(g,c){let d=!0;for(let _=0;_<g.planes.length;_++){const A=g.planes[_];let x=0;for(let T=0;T<c.length;T++)x+=Le.vec3.dot(A,c[T])+A[3]>=0;if(x===0)return 0;x!==c.length&&(d=!1)}return d?2:1}function Kg(g,c){for(const d of g.projections){const _=ah(c,g.points[0],d.axis);if(d.projection[1]<_[0]||d.projection[0]>_[1])return 0}return 1}function $x(g,c){let d=0;const _=[0,0,0,0];for(let A=0;A<g.length;A++)_[0]=g[A][0],_[1]=g[A][1],_[2]=g[A][2],_[3]=1,Le.vec4.dot(_,c)>=0&&d++;return d}class Jg{constructor(c,d){this.points=c||new Array(8).fill([0,0,0]),this.planes=d||new Array(6).fill([0,0,0,0]),this.bounds=Ji.fromPoints(this.points),this.projections=[],this.frustumEdges=[Le.vec3.sub([],this.points[2],this.points[3]),Le.vec3.sub([],this.points[0],this.points[3]),Le.vec3.sub([],this.points[4],this.points[0]),Le.vec3.sub([],this.points[5],this.points[1]),Le.vec3.sub([],this.points[6],this.points[2]),Le.vec3.sub([],this.points[7],this.points[3])];for(const _ of this.frustumEdges){const A=[0,-_[2],_[1]],x=[_[2],0,-_[0]];this.projections.push({axis:A,projection:ah(this.points,this.points[0],A)}),this.projections.push({axis:x,projection:ah(this.points,this.points[0],x)})}}static fromInvProjectionMatrix(c,d,_,A){const x=Math.pow(2,_),T=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(j=>{const R=Le.vec4.transformMat4([],j,c),N=1/R[3]/d*x;return Le.vec4.mul(R,R,[N,N,A?1/R[3]:N,N])}),B=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(j=>{const R=Le.vec3.sub([],T[j[0]],T[j[1]]),N=Le.vec3.sub([],T[j[2]],T[j[1]]),V=Le.vec3.normalize([],Le.vec3.cross([],R,N)),z=-Le.vec3.dot(V,T[j[1]]);return V.concat(z)}),U=[];for(let j=0;j<T.length;j++)U.push([T[j][0],T[j][1],T[j][2]]);return new Jg(U,B)}intersectsPrecise(c,d,_){for(let A=0;A<d.length;A++)if(!$x(c,d[A]))return 0;for(let A=0;A<this.planes.length;A++)if(!$x(c,this.planes[A]))return 0;for(const A of _)for(const x of this.frustumEdges){const T=Le.vec3.cross([],A,x),B=Le.vec3.length(T);if(B===0)continue;Le.vec3.scale(T,T,1/B);const U=ah(this.points,this.points[0],T),j=ah(c,this.points[0],T);if(U[0]>j[1]||j[0]>U[1])return 0}return 1}containsPoint(c){for(const d of this.planes){const _=d[3];if(Le.vec3.dot([d[0],d[1],d[2]],c)+_<0)return!1}return!0}}class Ji{static fromPoints(c){const d=[1/0,1/0,1/0],_=[-1/0,-1/0,-1/0];for(const A of c)Le.vec3.min(d,d,A),Le.vec3.max(_,_,A);return new Ji(d,_)}static fromTileIdAndHeight(c,d,_){const A=1<<c.canonical.z,x=c.canonical.x,T=c.canonical.y;return new Ji([x/A,T/A,d],[(x+1)/A,(T+1)/A,_])}static applyTransform(c,d){const _=c.getCorners();for(let A=0;A<_.length;++A)Le.vec3.transformMat4(_[A],_[A],d);return Ji.fromPoints(_)}static applyTransformFast(c,d){const _=[d[12],d[13],d[14]],A=[..._];for(let x=0;x<3;x++)for(let T=0;T<3;T++){const B=d[4*T+x],U=B*c.min[T],j=B*c.max[T];_[x]+=Math.min(U,j),A[x]+=Math.max(U,j)}return new Ji(_,A)}static projectAabbCorners(c,d){const _=c.getCorners();for(let A=0;A<_.length;++A)Le.vec3.transformMat4(_[A],_[A],d);return _}constructor(c,d){this.min=c,this.max=d,this.center=Le.vec3.scale([],Le.vec3.add([],this.min,this.max),.5)}quadrant(c){const d=[c%2==0,c<2],_=Le.vec3.clone(this.min),A=Le.vec3.clone(this.max);for(let x=0;x<d.length;x++)_[x]=d[x]?this.min[x]:this.center[x],A[x]=d[x]?this.center[x]:this.max[x];return A[2]=this.max[2],new Ji(_,A)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}distanceZ(c){return Math.max(Math.min(this.max[2],c[2]),this.min[2])-c[2]}getCorners(){const c=this.min,d=this.max;return[[c[0],c[1],c[2]],[d[0],c[1],c[2]],[d[0],d[1],c[2]],[c[0],d[1],c[2]],[c[0],c[1],d[2]],[d[0],c[1],d[2]],[d[0],d[1],d[2]],[c[0],d[1],d[2]]]}intersects(c){return this.intersectsAabb(c.bounds)?Yg(c,this.getCorners()):0}intersectsFlat(c){return this.intersectsAabb(c.bounds)?Yg(c,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(c,d){return d||this.intersects(c)?Kg(c,this.getCorners()):0}intersectsPreciseFlat(c,d){return d||this.intersectsFlat(c)?Kg(c,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(c){for(let d=0;d<3;++d)if(this.min[d]>c.max[d]||c.min[d]>this.max[d])return!1;return!0}intersectsAabbXY(c){return!(this.min[0]>c.max[0]||c.min[0]>this.max[0]||this.min[1]>c.max[1]||c.min[1]>this.max[1])}encapsulate(c){for(let d=0;d<3;d++)this.min[d]=Math.min(this.min[d],c.min[d]),this.max[d]=Math.max(this.max[d],c.max[d])}encapsulatePoint(c){for(let d=0;d<3;d++)this.min[d]=Math.min(this.min[d],c[d]),this.max[d]=Math.max(this.max[d],c[d])}closestPoint(c){return[Math.max(Math.min(this.max[0],c[0]),this.min[0]),Math.max(Math.min(this.max[1],c[1]),this.min[1]),Math.max(Math.min(this.max[2],c[2]),this.min[2])]}}function lm(g){return g*u/ae}Fn(Ji,"Aabb");const zB=[new Ji([W,W,W],[q,q,q]),new Ji([W,W,W],[0,0,q]),new Ji([0,W,W],[q,0,q]),new Ji([W,0,W],[0,q,q]),new Ji([0,0,W],[q,q,q])];function LE(g,c,d,_=!0){const A=Le.vec3.scale([],g._camera.position,g.worldSize),x=[c,d,1,1];Le.vec4.transformMat4(x,x,g.pixelMatrixInverse),Le.vec4.scale(x,x,1/x[3]);const T=Le.vec3.sub([],x,A),B=Le.vec3.normalize([],T),U=g.globeMatrix,j=[U[12],U[13],U[14]],R=Le.vec3.sub([],j,A),N=Le.vec3.length(R),V=Le.vec3.normalize([],R),z=g.worldSize/(2*Math.PI),G=Le.vec3.dot(V,B),$=Math.asin(z/N);if($<Math.acos(G)){if(!_)return null;const Ye=[],ze=[];Le.vec3.scale(Ye,B,N/G),Le.vec3.normalize(ze,Le.vec3.sub(ze,Ye,R)),Le.vec3.normalize(B,Le.vec3.add(B,R,Le.vec3.scale(B,ze,Math.tan($)*N)))}const K=[];new yf(A,B).closestPointOnSphere(j,z,K);const te=Le.vec3.normalize([],hi(U,0)),ce=Le.vec3.normalize([],hi(U,1)),he=Le.vec3.normalize([],hi(U,2)),ne=Le.vec3.dot(te,K),de=Le.vec3.dot(ce,K),ge=Le.vec3.dot(he,K),Me=ot(Math.asin(-de/z));let Be=ot(Math.atan2(ne,ge));Be=g.center.lng+function(Ye,ze){const Qe=(ze-Ye+180)%360-180;return Qe<-180?Qe+360:Qe}(g.center.lng,Be);const Oe=ke(Be),Pe=jt(Ne(Me),0,1);return new bt(Oe,Pe)}class che{constructor(c,d,_){this.a=Le.vec3.sub([],c,_),this.b=Le.vec3.sub([],d,_),this.center=_;const A=Le.vec3.normalize([],this.a),x=Le.vec3.normalize([],this.b);this.angle=Math.acos(Le.vec3.dot(A,x))}}function UB(g,c){if(g.angle===0)return null;let d;return d=g.a[c]===0?1/g.angle*.5*Math.PI:1/g.angle*Math.atan(g.b[c]/g.a[c]/Math.sin(g.angle)-1/Math.tan(g.angle)),d<0||d>1?null:function(_,A,x,T){const B=Math.sin(x);return _*(Math.sin((1-T)*x)/B)+A*(Math.sin(T*x)/B)}(g.a[c],g.b[c],g.angle,jt(d,0,1))+g.center[c]}function Ud(g){if(g.z<=1)return zB[g.z+2*g.y+g.x];const c=GB(DE(g));return Ji.fromPoints(c)}function cm(g,c,d){return Le.vec3.scale(g,g,1-d),Le.vec3.scaleAndAdd(g,g,c,d)}function K8(g,c,d){for(const _ of g)Le.vec3.transformMat4(_,_,c),Le.vec3.scale(_,_,d)}function J8(g,c,d,_){const A=c/g.worldSize,x=g.globeMatrix;if(d.z<=1){const Oe=Ud(d).getCorners();return K8(Oe,x,A),Ji.fromPoints(Oe)}const T=DE(d,_),B=GB(T,u+lm(g._tileCoverLift));K8(B,x,A);const U=Number.MAX_VALUE,j=[-U,-U,-U],R=[U,U,U];if(T.contains(g.center)){for(const Ye of B)Le.vec3.min(R,R,Ye),Le.vec3.max(j,j,Ye);j[2]=0;const Oe=g.point,Pe=[Oe.x*A,Oe.y*A,0];return Le.vec3.min(R,R,Pe),Le.vec3.max(j,j,Pe),new Ji(R,j)}if(g._tileCoverLift>0){for(const Oe of B)Le.vec3.min(R,R,Oe),Le.vec3.max(j,j,Oe);return new Ji(R,j)}const N=[x[12]*A,x[13]*A,x[14]*A],V=T.getCenter(),z=jt(g.center.lat,-Ke,Ke),G=jt(V.lat,-Ke,Ke),$=ke(g.center.lng),K=Ne(z);let te=$-ke(V.lng);const ce=K-Ne(G);te>.5?te-=1:te<-.5&&(te+=1);let he=0;if(Math.abs(te)>Math.abs(ce))he=te>=0?1:3;else{he=ce>=0?0:2;const Oe=[x[4]*A,x[5]*A,x[6]*A],Pe=-Math.sin(sn(ce>=0?T.getSouth():T.getNorth()))*u;Le.vec3.scaleAndAdd(N,N,Oe,Pe)}const ne=B[he],de=B[(he+1)%4],ge=new che(ne,de,N),Me=[UB(ge,0)||ne[0],UB(ge,1)||ne[1],UB(ge,2)||ne[2]],Be=Qg(g.zoom);if(Be>0){const Oe=function({x:Ye,y:ze,z:Qe},ct,ht,ft,mt){const Ct=1/(1<<Qe);let _t=Ye*Ct,Ut=_t+Ct,Yt=ze*Ct,Dt=Yt+Ct,Rn=0;const bn=(_t+Ut)/2-ft;return bn>.5?Rn=-1:bn<-.5&&(Rn=1),_t=((_t+Rn)*ct-(ft*=ct))*ht+ft,Ut=((Ut+Rn)*ct-ft)*ht+ft,Yt=(Yt*ct-(mt*=ct))*ht+mt,Dt=(Dt*ct-mt)*ht+mt,[[_t,Dt,0],[Ut,Dt,0],[Ut,Yt,0],[_t,Yt,0]]}(d,c,g._pixelsPerMercatorPixel,$,K);for(let Ye=0;Ye<B.length;Ye++)cm(B[Ye],Oe[Ye],Be);const Pe=Le.vec3.add([],Oe[he],Oe[(he+1)%4]);Le.vec3.scale(Pe,Pe,.5),cm(Me,Pe,Be)}for(const Oe of B)Le.vec3.min(R,R,Oe),Le.vec3.max(j,j,Oe);return R[2]=Math.min(ne[2],de[2]),Le.vec3.min(R,R,Me),Le.vec3.max(j,j,Me),new Ji(R,j)}function DE({x:g,y:c,z:d},_=!1){const A=1/(1<<d),x=new ue($e(g*A),c===(1<<d)-1&&_?-90:je((c+1)*A)),T=new ue($e((g+1)*A),c===0&&_?90:je(c*A));return new ve(x,T)}function GB(g,c=u){const d=sn(g.getNorth()),_=sn(g.getSouth()),A=Math.cos(d),x=Math.cos(_),T=Math.sin(d),B=Math.sin(_),U=g.getWest(),j=g.getEast();return[J(x,B,U,c),J(x,B,j,c),J(A,T,j,c),J(A,T,U,c)]}function jw(g,c,d,_){const A=1<<d.z,x=(g/yn+d.x)/A;return ee(je((c/yn+d.y)/A),$e(x),_)}function BE({min:g,max:c}){return I/Math.max(c[0]-g[0],c[1]-g[1],c[2]-g[2])}const Q8=new Float64Array(16);function kE(g){const c=BE(g),d=Le.mat4.fromScaling(Q8,[c,c,c]);return Le.mat4.translate(d,d,Le.vec3.negate([],g.min))}function VB(g){const c=Le.mat4.fromTranslation(Q8,g.min),d=1/BE(g);return Le.mat4.scale(c,c,[d,d,d])}function HB(g){const c=yn/(2*Math.PI);return g/(2*Math.PI)/c}function eV(g,c){return yn/(512*Math.pow(2,g))*BE(Ud(c))}function tV(g,c,d,_,A){const x=HB(d),T=[g,c,-d/(2*Math.PI)],B=Le.mat4.identity(new Float64Array(16));return Le.mat4.translate(B,B,T),Le.mat4.scale(B,B,[x,x,x]),Le.mat4.rotateX(B,B,sn(-A)),Le.mat4.rotateY(B,B,sn(-_)),B}function Qg(g){return mr(m,w,g)}function nV(g,c){const d=ee(c.lat,c.lng),_=function(x){const T=ee(x._center.lat,x._center.lng),B=Le.vec3.fromValues(0,1,0);let U=Le.vec3.cross([],B,T);const j=Le.mat4.fromRotation([],-x.angle,T);U=Le.vec3.transformMat4(U,U,j),Le.mat4.fromRotation(j,-x._pitch,U);const R=Le.vec3.normalize([],T);return Le.vec3.scale(R,R,lm(x.cameraToCenterDistance/x.pixelsPerMeter)),Le.vec3.transformMat4(R,R,j),Le.vec3.add([],T,R)}(g),A=Le.vec3.subtract([],_,d);return Le.vec3.angle(A,d)}function jB(g,c){return nV(g,c)>Math.PI/2*1.01}const rV=sn(85),uhe=Math.cos(rV),hhe=Math.sin(rV),fhe=Le.mat4.create(),iV=g=>{const c=[];return g.paint.get("circle-pitch-alignment")==="map"&&c.push("PITCH_WITH_MAP"),g.paint.get("circle-pitch-scale")==="map"&&c.push("SCALE_WITH_MAP"),c};function sV(g,c,d,_,A,x,T,B,U){if(x&&g.queryGeometry.isAboveHorizon)return!1;x&&(U*=g.pixelToTileUnitsFactor);const j=g.tileID.canonical,R=d.projection.upVectorScale(j,d.center.lat,d.worldSize).metersToTile;for(const N of c)for(const V of N){const z=V.add(B),G=A&&d.elevation?d.elevation.exaggeration()*A.getElevationAt(z.x,z.y,!0):0,$=d.projection.projectTilePoint(z.x,z.y,j);if(G>0){const he=d.projection.upVector(j,z.x,z.y);$.x+=he[0]*R*G,$.y+=he[1]*R*G,$.z+=he[2]*R*G}const K=x?z:dhe($.x,$.y,$.z,_),te=x?g.tilespaceRays.map(he=>mhe(he,G)):g.queryGeometry.screenGeometry,ce=Le.vec4.transformMat4([],[$.x,$.y,$.z,1],_);if(!T&&x?U*=ce[3]/d.cameraToCenterDistance:T&&!x&&(U*=d.cameraToCenterDistance/ce[3]),x){const he=je((V.y/yn+j.y)/(1<<j.z));U/=d.projection.pixelsPerMeter(he,1)/De(1,he)}if(Dn(te,K,U))return!0}return!1}function dhe(g,c,d,_){const A=Le.vec4.transformMat4([],[g,c,d,1],_);return new St(A[0]/A[3],A[1]/A[3])}const aV=Le.vec3.fromValues(0,0,0),phe=Le.vec3.fromValues(0,0,1);function mhe(g,c){const d=Le.vec3.create();return aV[2]=c,g.intersectsPlane(aV,phe,d),new St(d[0],d[1])}class oV extends er{}let lV,cV,uV,hV;function fV(g,{width:c,height:d},_,A){if(A){if(A instanceof Uint8ClampedArray)A=new Uint8Array(A.buffer);else if(A.length!==c*d*_)throw new RangeError("mismatched image size")}else A=new Uint8Array(c*d*_);return g.width=c,g.height=d,g.data=A,g}function dV(g,c,d){const{width:_,height:A}=c;_===g.width&&A===g.height||(WB(g,c,{x:0,y:0},{x:0,y:0},{width:Math.min(g.width,_),height:Math.min(g.height,A)},d,null),g.width=_,g.height=A,g.data=c.data)}function WB(g,c,d,_,A,x,T,B){if(A.width===0||A.height===0)return c;if(A.width>g.width||A.height>g.height||d.x>g.width-A.width||d.y>g.height-A.height)throw new RangeError("out of range source coordinates for image copy");if(A.width>c.width||A.height>c.height||_.x>c.width-A.width||_.y>c.height-A.height)throw new RangeError("out of range destination coordinates for image copy");const U=g.data,j=c.data,R=x===4&&B;for(let N=0;N<A.height;N++){const V=((d.y+N)*g.width+d.x)*x,z=((_.y+N)*c.width+_.x)*x;if(R)for(let G=0;G<A.width;G++){const $=V+G*x+3,K=z+G*x;j[K+0]=255,j[K+1]=255,j[K+2]=255,j[K+3]=U[$]}else if(T)for(let G=0;G<A.width;G++){const $=V+G*x,K=z+G*x,te=U[$+3],ce=new vr(U[$+0]/255*te,U[$+1]/255*te,U[$+2]/255*te,te).toRenderColor(T).toArray();j[K+0]=ce[0],j[K+1]=ce[1],j[K+2]=ce[2],j[K+3]=ce[3]}else for(let G=0;G<A.width*x;G++)j[z+G]=U[V+G]}return c}Fn(oV,"HeatmapBucket",{omit:["layers"]});class ev{constructor(c,d){fV(this,c,1,d)}resize(c){dV(this,new ev(c),1)}clone(){return new ev({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,d,_,A,x){WB(c,d,_,A,x,1,null)}}class vl{constructor(c,d){fV(this,c,4,d)}resize(c){dV(this,new vl(c),4)}replace(c,d){d?this.data.set(c):this.data=c instanceof Uint8ClampedArray?new Uint8Array(c.buffer):c}clone(){return new vl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(c,d,_,A,x,T,B){WB(c,d,_,A,x,4,T,B)}}class pV{constructor(c,d){this.width=c.width,this.height=c.height,this.data=d instanceof Uint8Array?new Float32Array(d.buffer):d}}function Ww(g){const c={},d=g.resolution||256,_=g.clips?g.clips.length:1,A=g.image||new vl({width:d,height:_}),x=(T,B,U)=>{c[g.evaluationKey]=U;const j=g.expression.evaluate(c);j&&(A.data[T+B+0]=Math.floor(255*j.r/j.a),A.data[T+B+1]=Math.floor(255*j.g/j.a),A.data[T+B+2]=Math.floor(255*j.b/j.a),A.data[T+B+3]=Math.floor(255*j.a))};if(g.clips)for(let T=0,B=0;T<_;++T,B+=4*d)for(let U=0,j=0;U<d;U++,j+=4){const R=U/(d-1),{start:N,end:V}=g.clips[T];x(B,j,N*(1-R)+V*R)}else for(let T=0,B=0;T<d;T++,B+=4)x(0,B,T/(d-1));return A}Fn(ev,"AlphaImage"),Fn(vl,"RGBAImage");const ghe=Qr([{name:"a_pos",components:2,type:"Int16"}],4),{members:vhe}=ghe;function $w(g,c,d=2){const _=c&&c.length,A=_?c[0]*d:g.length;let x=mV(g,0,A,d,!0);const T=[];if(!x||x.next===x.prev)return T;let B,U,j;if(_&&(x=function(R,N,V,z){const G=[];for(let $=0,K=N.length;$<K;$++){const te=mV(R,N[$]*z,$<K-1?N[$+1]*z:R.length,z,!1);te===te.next&&(te.steiner=!0),G.push(The(te))}G.sort(whe);for(let $=0;$<G.length;$++)V=She(G[$],V);return V}(g,c,x,d)),g.length>80*d){B=1/0,U=1/0;let R=-1/0,N=-1/0;for(let V=d;V<A;V+=d){const z=g[V],G=g[V+1];z<B&&(B=z),G<U&&(U=G),z>R&&(R=z),G>N&&(N=G)}j=Math.max(R-B,N-U),j=j!==0?32767/j:0}return Xw(x,T,d,B,U,j,0),T}function mV(g,c,d,_,A){let x;if(A===function(T,B,U,j){let R=0;for(let N=B,V=U-j;N<U;N+=j)R+=(T[V]-T[N])*(T[N+1]+T[V+1]),V=N;return R}(g,c,d,_)>0)for(let T=c;T<d;T+=_)x=_V(T/_|0,g[T],g[T+1],x);else for(let T=d-_;T>=c;T-=_)x=_V(T/_|0,g[T],g[T+1],x);return x&&OE(x,x.next)&&(Zw(x),x=x.next),x}function d_(g,c){if(!g)return g;c||(c=g);let d,_=g;do if(d=!1,_.steiner||!OE(_,_.next)&&za(_.prev,_,_.next)!==0)_=_.next;else{if(Zw(_),_=c=_.prev,_===_.next)break;d=!0}while(d||_!==c);return c}function Xw(g,c,d,_,A,x,T){if(!g)return;!T&&x&&function(U,j,R,N){let V=U;do V.z===0&&(V.z=$B(V.x,V.y,j,R,N)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next;while(V!==U);V.prevZ.nextZ=null,V.prevZ=null,function(z){let G,$=1;do{let K,te=z;z=null;let ce=null;for(G=0;te;){G++;let he=te,ne=0;for(let ge=0;ge<$&&(ne++,he=he.nextZ,he);ge++);let de=$;for(;ne>0||de>0&&he;)ne!==0&&(de===0||!he||te.z<=he.z)?(K=te,te=te.nextZ,ne--):(K=he,he=he.nextZ,de--),ce?ce.nextZ=K:z=K,K.prevZ=ce,ce=K;te=he}ce.nextZ=null,$*=2}while(G>1)}(V)}(g,_,A,x);let B=g;for(;g.prev!==g.next;){const U=g.prev,j=g.next;if(x?yhe(g,_,A,x):_he(g))c.push(U.i,g.i,j.i),Zw(g),g=j.next,B=j.next;else if((g=j)===B){T?T===1?Xw(g=xhe(d_(g),c),c,d,_,A,x,2):T===2&&bhe(g,c,d,_,A,x):Xw(d_(g),c,d,_,A,x,1);break}}}function _he(g){const c=g.prev,d=g,_=g.next;if(za(c,d,_)>=0)return!1;const A=c.x,x=d.x,T=_.x,B=c.y,U=d.y,j=_.y,R=A<x?A<T?A:T:x<T?x:T,N=B<U?B<j?B:j:U<j?U:j,V=A>x?A>T?A:T:x>T?x:T,z=B>U?B>j?B:j:U>j?U:j;let G=_.next;for(;G!==c;){if(G.x>=R&&G.x<=V&&G.y>=N&&G.y<=z&&Xx(A,B,x,U,T,j,G.x,G.y)&&za(G.prev,G,G.next)>=0)return!1;G=G.next}return!0}function yhe(g,c,d,_){const A=g.prev,x=g,T=g.next;if(za(A,x,T)>=0)return!1;const B=A.x,U=x.x,j=T.x,R=A.y,N=x.y,V=T.y,z=B<U?B<j?B:j:U<j?U:j,G=R<N?R<V?R:V:N<V?N:V,$=B>U?B>j?B:j:U>j?U:j,K=R>N?R>V?R:V:N>V?N:V,te=$B(z,G,c,d,_),ce=$B($,K,c,d,_);let he=g.prevZ,ne=g.nextZ;for(;he&&he.z>=te&&ne&&ne.z<=ce;){if(he.x>=z&&he.x<=$&&he.y>=G&&he.y<=K&&he!==A&&he!==T&&Xx(B,R,U,N,j,V,he.x,he.y)&&za(he.prev,he,he.next)>=0||(he=he.prevZ,ne.x>=z&&ne.x<=$&&ne.y>=G&&ne.y<=K&&ne!==A&&ne!==T&&Xx(B,R,U,N,j,V,ne.x,ne.y)&&za(ne.prev,ne,ne.next)>=0))return!1;ne=ne.nextZ}for(;he&&he.z>=te;){if(he.x>=z&&he.x<=$&&he.y>=G&&he.y<=K&&he!==A&&he!==T&&Xx(B,R,U,N,j,V,he.x,he.y)&&za(he.prev,he,he.next)>=0)return!1;he=he.prevZ}for(;ne&&ne.z<=ce;){if(ne.x>=z&&ne.x<=$&&ne.y>=G&&ne.y<=K&&ne!==A&&ne!==T&&Xx(B,R,U,N,j,V,ne.x,ne.y)&&za(ne.prev,ne,ne.next)>=0)return!1;ne=ne.nextZ}return!0}function xhe(g,c){let d=g;do{const _=d.prev,A=d.next.next;!OE(_,A)&&gV(_,d,d.next,A)&&qw(_,A)&&qw(A,_)&&(c.push(_.i,d.i,A.i),Zw(d),Zw(d.next),d=g=A),d=d.next}while(d!==g);return d_(d)}function bhe(g,c,d,_,A,x){let T=g;do{let B=T.next.next;for(;B!==T.prev;){if(T.i!==B.i&&Mhe(T,B)){let U=vV(T,B);return T=d_(T,T.next),U=d_(U,U.next),Xw(T,c,d,_,A,x,0),void Xw(U,c,d,_,A,x,0)}B=B.next}T=T.next}while(T!==g)}function whe(g,c){return g.x-c.x}function She(g,c){const d=function(A,x){let T=x;const B=A.x,U=A.y;let j,R=-1/0;do{if(U<=T.y&&U>=T.next.y&&T.next.y!==T.y){const $=T.x+(U-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if($<=B&&$>R&&(R=$,j=T.x<T.next.x?T:T.next,$===B))return j}T=T.next}while(T!==x);if(!j)return null;const N=j,V=j.x,z=j.y;let G=1/0;T=j;do{if(B>=T.x&&T.x>=V&&B!==T.x&&Xx(U<z?B:R,U,V,z,U<z?R:B,U,T.x,T.y)){const $=Math.abs(U-T.y)/(B-T.x);qw(T,A)&&($<G||$===G&&(T.x>j.x||T.x===j.x&&Ahe(j,T)))&&(j=T,G=$)}T=T.next}while(T!==N);return j}(g,c);if(!d)return c;const _=vV(d,g);return d_(_,_.next),d_(d,d.next)}function Ahe(g,c){return za(g.prev,g,c.prev)<0&&za(c.next,g,g.next)<0}function $B(g,c,d,_,A){return(g=1431655765&((g=858993459&((g=252645135&((g=16711935&((g=(g-d)*A|0)|g<<8))|g<<4))|g<<2))|g<<1))|(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-_)*A|0)|c<<8))|c<<4))|c<<2))|c<<1))<<1}function The(g){let c=g,d=g;do(c.x<d.x||c.x===d.x&&c.y<d.y)&&(d=c),c=c.next;while(c!==g);return d}function Xx(g,c,d,_,A,x,T,B){return(A-T)*(c-B)>=(g-T)*(x-B)&&(g-T)*(_-B)>=(d-T)*(c-B)&&(d-T)*(x-B)>=(A-T)*(_-B)}function Mhe(g,c){return g.next.i!==c.i&&g.prev.i!==c.i&&!function(d,_){let A=d;do{if(A.i!==d.i&&A.next.i!==d.i&&A.i!==_.i&&A.next.i!==_.i&&gV(A,A.next,d,_))return!0;A=A.next}while(A!==d);return!1}(g,c)&&(qw(g,c)&&qw(c,g)&&function(d,_){let A=d,x=!1;const T=(d.x+_.x)/2,B=(d.y+_.y)/2;do A.y>B!=A.next.y>B&&A.next.y!==A.y&&T<(A.next.x-A.x)*(B-A.y)/(A.next.y-A.y)+A.x&&(x=!x),A=A.next;while(A!==d);return x}(g,c)&&(za(g.prev,g,c.prev)||za(g,c.prev,c))||OE(g,c)&&za(g.prev,g,g.next)>0&&za(c.prev,c,c.next)>0)}function za(g,c,d){return(c.y-g.y)*(d.x-c.x)-(c.x-g.x)*(d.y-c.y)}function OE(g,c){return g.x===c.x&&g.y===c.y}function gV(g,c,d,_){const A=NE(za(g,c,d)),x=NE(za(g,c,_)),T=NE(za(d,_,g)),B=NE(za(d,_,c));return A!==x&&T!==B||!(A!==0||!FE(g,d,c))||!(x!==0||!FE(g,_,c))||!(T!==0||!FE(d,g,_))||!(B!==0||!FE(d,c,_))}function FE(g,c,d){return c.x<=Math.max(g.x,d.x)&&c.x>=Math.min(g.x,d.x)&&c.y<=Math.max(g.y,d.y)&&c.y>=Math.min(g.y,d.y)}function NE(g){return g>0?1:g<0?-1:0}function qw(g,c){return za(g.prev,g,g.next)<0?za(g,c,g.next)>=0&&za(g,g.prev,c)>=0:za(g,c,g.prev)<0||za(g,g.next,c)<0}function vV(g,c){const d=XB(g.i,g.x,g.y),_=XB(c.i,c.x,c.y),A=g.next,x=c.prev;return g.next=c,c.prev=g,d.next=A,A.prev=d,_.next=d,d.prev=_,x.next=_,_.prev=x,_}function _V(g,c,d,_){const A=XB(g,c,d);return _?(A.next=_.next,A.prev=_,_.next.prev=A,_.next=A):(A.prev=A,A.next=A),A}function Zw(g){g.next.prev=g.prev,g.prev.next=g.next,g.prevZ&&(g.prevZ.nextZ=g.nextZ),g.nextZ&&(g.nextZ.prevZ=g.prevZ)}function XB(g,c,d){return{i:g,x:c,y:d,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function zE(g,c){const d=g.length;if(d<=1)return[g];const _=[];let A,x;for(let T=0;T<d;T++){const B=un(g[T]);B!==0&&(g[T].area=Math.abs(B),x===void 0&&(x=B<0),x===B<0?(A&&_.push(A),A=[g[T]]):A.push(g[T]))}if(A&&_.push(A),c>1)for(let T=0;T<_.length;T++)_[T].length<=c||(U0(_[T],c,1,_[T].length-1,Ehe),_[T]=_[T].slice(0,c));return _}function Ehe(g,c){return c.area-g.area}function qB(g,c,d){const _=d.patternDependencies;let A=!1;for(const x of c){const T=x.paint.get(`${g}-pattern`);T.isConstant()||(A=!0);const B=T.constantOr(null);B&&(A=!0,_[B]=!0)}return A}function ZB(g,c,d,_,A){const x=A.patternDependencies;for(const T of c){const B=T.paint.get(`${g}-pattern`).value;if(B.kind!=="constant"){let U=B.evaluate({zoom:_},d,{},A.availableImages);U=U&&U.name?U.name:U,x[U]=!0,d.patterns[T.id]=U}}return d}class YB{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=c.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new hc,this.indexArray=new wa,this.indexArray2=new Tu,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut}),this.segments=new ws,this.segments2=new ws,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.projection=c.projection}updateFootprints(c,d){}populate(c,d,_,A){this.hasPattern=qB("fill",this.layers,d);const x=this.layers[0].layout.get("fill-sort-key"),T=[];for(const{feature:B,id:U,index:j,sourceLayerIndex:R}of c){const N=this.layers[0]._featureFilter.needGeometry,V=pn(B,N);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),V,_))continue;const z=x?x.evaluate(V,{},_,d.availableImages):void 0,G={id:U,properties:B.properties,type:B.type,sourceLayerIndex:R,index:j,geometry:N?V.geometry:fn(B,_,A),patterns:{},sortKey:z};T.push(G)}x&&T.sort((B,U)=>B.sortKey-U.sortKey);for(const B of T){const{geometry:U,index:j,sourceLayerIndex:R}=B;if(this.hasPattern){const N=ZB("fill",this.layers,B,this.zoom,d);this.patternFeatures.push(N)}else this.addFeature(B,U,j,_,{},d.availableImages,d.brightness);d.featureIndex.insert(c[j].feature,U,j,R,this.index)}}update(c,d,_,A,x){const T=Object.keys(c).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(c,d,T?this.stateDependentLayers:this.layers,_,A,x)}addFeatures(c,d,_,A,x,T){for(const B of this.patternFeatures)this.addFeature(B,B.geometry,B.index,d,_,A,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,vhe),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.indexBuffer2=c.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(c,d,_,A,x,T=[],B){for(const U of zE(d,500)){let j=0;for(const $ of U)j+=$.length;const R=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray),N=R.vertexLength,V=[],z=[];for(const $ of U){if($.length===0)continue;$!==U[0]&&z.push(V.length/2);const K=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),te=K.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(te+$.length-1,te),V.push($[0].x),V.push($[0].y);for(let ce=1;ce<$.length;ce++)this.layoutVertexArray.emplaceBack($[ce].x,$[ce].y),this.indexArray2.emplaceBack(te+ce-1,te+ce),V.push($[ce].x),V.push($[ce].y);K.vertexLength+=$.length,K.primitiveLength+=$.length}const G=$w(V,z);for(let $=0;$<G.length;$+=3)this.indexArray.emplaceBack(N+G[$],N+G[$+1],N+G[$+2]);R.vertexLength+=j,R.primitiveLength+=G.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,x,T,A,B)}}let yV,xV,bV,wV;Fn(YB,"FillBucket",{omit:["layers","patternFeatures"]});class KB{constructor(c,d,_,A){if(this.triangleCount=d.length/3,this.min=new St(0,0),this.max=new St(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||c.length===0)return;const[x,T]=[c[0].clone(),c[0].clone()];for(let N=1;N<c.length;++N){const V=c[N];x.x=Math.min(x.x,V.x),x.y=Math.min(x.y,V.y),T.x=Math.max(T.x,V.x),T.y=Math.max(T.y,V.y)}if(A){const N=Math.ceil(Math.max(T.x-x.x,T.y-x.y)/A);_=Math.max(_,N)}if(_===0)return;this.min=x,this.max=T;const B=this.max.sub(this.min);B.x=Math.max(B.x,1),B.y=Math.max(B.y,1);const U=Math.max(B.x,B.y)/_;this.cellsX=Math.max(1,Math.ceil(B.x/U)),this.cellsY=Math.max(1,Math.ceil(B.y/U)),this.xScale=1/U,this.yScale=1/U;const j=[];for(let N=0;N<this.triangleCount;N++){const V=c[d[3*N+0]].sub(this.min),z=c[d[3*N+1]].sub(this.min),G=c[d[3*N+2]].sub(this.min),$=Gd(Math.floor(Math.min(V.x,z.x,G.x)),this.xScale,this.cellsX),K=Gd(Math.floor(Math.max(V.x,z.x,G.x)),this.xScale,this.cellsX),te=Gd(Math.floor(Math.min(V.y,z.y,G.y)),this.yScale,this.cellsY),ce=Gd(Math.floor(Math.max(V.y,z.y,G.y)),this.yScale,this.cellsY),he=new St(0,0),ne=new St(0,0),de=new St(0,0),ge=new St(0,0);for(let Me=te;Me<=ce;++Me){he.y=ne.y=Me*U,de.y=ge.y=(Me+1)*U;for(let Be=$;Be<=K;++Be)he.x=de.x=Be*U,ne.x=ge.x=(Be+1)*U,(Ni(V,z,G,he,ne,ge)||Ni(V,z,G,he,ge,de))&&j.push({cellIdx:Me*this.cellsX+Be,triIdx:N})}}if(j.length===0)return;j.sort((N,V)=>N.cellIdx-V.cellIdx||N.triIdx-V.triIdx);let R=0;for(;R<j.length;){const N=j[R].cellIdx,V={start:this.payload.length,len:0};for(;R<j.length&&j[R].cellIdx===N;)++V.len,this.payload.push(j[R++].triIdx);this.cells[N]=V}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(c,d){if(this.triangleCount===0||this.cells.length===0||c.x>this.max.x||this.min.x>c.x||c.y>this.max.y||this.min.y>c.y)return;const _=Gd(c.x-this.min.x,this.xScale,this.cellsX),A=Gd(c.y-this.min.y,this.yScale,this.cellsY),x=this.cells[A*this.cellsX+_];if(x){this._lazyInitLookup();for(let T=0;T<x.len;T++){const B=this.payload[x.start+T],U=Math.floor(B/8),j=1<<B%8;if(!(this.lookup[U]&j)&&(this.lookup[U]|=j,d.push(B),d.length===this.triangleCount))return}}}query(c,d,_){if(this.triangleCount===0||this.cells.length===0||c.x>this.max.x||this.min.x>d.x||c.y>this.max.y||this.min.y>d.y)return;this._lazyInitLookup();const A=Gd(c.x-this.min.x,this.xScale,this.cellsX),x=Gd(d.x-this.min.x,this.xScale,this.cellsX),T=Gd(c.y-this.min.y,this.yScale,this.cellsY),B=Gd(d.y-this.min.y,this.yScale,this.cellsY);for(let U=T;U<=B;U++)for(let j=A;j<=x;j++){const R=this.cells[U*this.cellsX+j];if(R)for(let N=0;N<R.len;N++){const V=this.payload[R.start+N],z=Math.floor(V/8),G=1<<V%8;if(!(this.lookup[z]&G)&&(this.lookup[z]|=G,_.push(V),_.length===this.triangleCount))return}}}}function Gd(g,c,d){return Math.max(0,Math.min(d-1,Math.floor(g*c)))}Fn(KB,"TriangleGridIndex");class SV{constructor(c){this.zoom=c.zoom,this.layers=c.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=c.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.footprints=[]}updateFootprints(c,d){for(const _ of this.footprints)d.push({footprint:_,id:c})}populate(c,d,_,A){const x=[];for(const{feature:T,id:B,index:U,sourceLayerIndex:j}of c){const R=this.layers[0]._featureFilter.needGeometry,N=pn(T,R);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),N,_))continue;const V={id:B,properties:T.properties,type:T.type,sourceLayerIndex:j,index:U,geometry:R?N.geometry:fn(T,_,A),patterns:{}};x.push(V)}for(const T of x){const{geometry:B,index:U,sourceLayerIndex:j}=T;this.addFeature(T,B,U,_,{},d.availableImages,d.brightness),d.featureIndex.insert(c[U].feature,B,U,j,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(c){}update(c,d,_,A,x){}destroy(){}addFeature(c,d,_,A,x,T=[],B){for(const U of zE(d,2)){const j=[],R=[],N=[],V=new St(1/0,1/0),z=new St(-1/0,-1/0);for(const K of U)if(K.length!==0){K!==U[0]&&N.push(R.length/2);for(let te=0;te<K.length;te++)R.push(K[te].x),R.push(K[te].y),j.push(K[te]),V.x=Math.min(V.x,K[te].x),V.y=Math.min(V.y,K[te].y),z.x=Math.max(z.x,K[te].x),z.y=Math.max(z.y,K[te].y)}const G=$w(R,N),$=new KB(j,G,8,256);this.footprints.push({vertices:j,indices:G,grid:$,min:V,max:z})}}}Fn(SV,"ClipBucket",{omit:["layers"]});const Che=Qr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Ihe=Qr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),Rhe=Qr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Phe=Qr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Lhe=Qr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Dhe=Qr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Bhe}=Che;var JB,AV,QB,TV,ek,MV,EV,UE={};function CV(){if(AV)return JB;AV=1;var g=cn();function c(A,x,T,B,U){this.properties={},this.extent=T,this.type=0,this._pbf=A,this._geometry=-1,this._keys=B,this._values=U,A.readFields(d,this,x)}function d(A,x,T){A==1?x.id=T.readVarint():A==2?function(B,U){for(var j=B.readVarint()+B.pos;B.pos<j;){var R=U._keys[B.readVarint()],N=U._values[B.readVarint()];U.properties[R]=N}}(T,x):A==3?x.type=T.readVarint():A==4&&(x._geometry=T.pos)}function _(A){for(var x,T,B=0,U=0,j=A.length,R=j-1;U<j;R=U++)B+=((T=A[R]).x-(x=A[U]).x)*(x.y+T.y);return B}return JB=c,c.types=["Unknown","Point","LineString","Polygon"],c.prototype.loadGeometry=function(){var A=this._pbf;A.pos=this._geometry;for(var x,T=A.readVarint()+A.pos,B=1,U=0,j=0,R=0,N=[];A.pos<T;){if(U<=0){var V=A.readVarint();B=7&V,U=V>>3}if(U--,B===1||B===2)j+=A.readSVarint(),R+=A.readSVarint(),B===1&&(x&&N.push(x),x=[]),x.push(new g(j,R));else{if(B!==7)throw new Error("unknown command "+B);x&&x.push(x[0].clone())}}return x&&N.push(x),N},c.prototype.bbox=function(){var A=this._pbf;A.pos=this._geometry;for(var x=A.readVarint()+A.pos,T=1,B=0,U=0,j=0,R=1/0,N=-1/0,V=1/0,z=-1/0;A.pos<x;){if(B<=0){var G=A.readVarint();T=7&G,B=G>>3}if(B--,T===1||T===2)(U+=A.readSVarint())<R&&(R=U),U>N&&(N=U),(j+=A.readSVarint())<V&&(V=j),j>z&&(z=j);else if(T!==7)throw new Error("unknown command "+T)}return[R,V,N,z]},c.prototype.toGeoJSON=function(A,x,T){var B,U,j=this.extent*Math.pow(2,T),R=this.extent*A,N=this.extent*x,V=this.loadGeometry(),z=c.types[this.type];function G(te){for(var ce=0;ce<te.length;ce++){var he=te[ce];te[ce]=[360*(he.x+R)/j-180,360/Math.PI*Math.atan(Math.exp((180-360*(he.y+N)/j)*Math.PI/180))-90]}}switch(this.type){case 1:var $=[];for(B=0;B<V.length;B++)$[B]=V[B][0];G(V=$);break;case 2:for(B=0;B<V.length;B++)G(V[B]);break;case 3:for(V=function(te){var ce=te.length;if(ce<=1)return[te];for(var he,ne,de=[],ge=0;ge<ce;ge++){var Me=_(te[ge]);Me!==0&&(ne===void 0&&(ne=Me<0),ne===Me<0?(he&&de.push(he),he=[te[ge]]):he.push(te[ge]))}return he&&de.push(he),de}(V),B=0;B<V.length;B++)for(U=0;U<V[B].length;U++)G(V[B][U])}V.length===1?V=V[0]:z="Multi"+z;var K={type:"Feature",geometry:{type:z,coordinates:V},properties:this.properties};return"id"in this&&(K.id=this.id),K},JB}function IV(){if(TV)return QB;TV=1;var g=CV();function c(_,A){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=_,this._keys=[],this._values=[],this._features=[],_.readFields(d,this,A),this.length=this._features.length}function d(_,A,x){_===15?A.version=x.readVarint():_===1?A.name=x.readString():_===5?A.extent=x.readVarint():_===2?A._features.push(x.pos):_===3?A._keys.push(x.readString()):_===4&&A._values.push(function(T){for(var B=null,U=T.readVarint()+T.pos;T.pos<U;){var j=T.readVarint()>>3;B=j===1?T.readString():j===2?T.readFloat():j===3?T.readDouble():j===4?T.readVarint64():j===5?T.readVarint():j===6?T.readSVarint():j===7?T.readBoolean():null}return B}(x))}return QB=c,c.prototype.feature=function(_){if(_<0||_>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[_];var A=this._pbf.readVarint()+this._pbf.pos;return new g(this._pbf,A,this.extent,this._keys,this._values)},QB}function RV(){return EV||(EV=1,UE.VectorTile=function(){if(MV)return ek;MV=1;var g=IV();function c(d,_,A){if(d===3){var x=new g(A,A.readVarint()+A.pos);x.length&&(_[x.name]=x)}}return ek=function(d,_){this.layers=d.readFields(c,{},_)},ek}(),UE.VectorTileFeature=CV(),UE.VectorTileLayer=IV()),UE}var qx=RV();class p_ extends St{constructor(c,d,_){super(c,d),this.z=_}}class PV extends p_{constructor(c,d,_,A){super(c,d,_),this.w=A}}function GE(g,c,d,_){const A=[],x=_===0?(T,B,U,j,R,N)=>{T.push(new St(N,U+(N-B)/(j-B)*(R-U)))}:(T,B,U,j,R,N)=>{T.push(new St(B+(N-U)/(R-U)*(j-B),N))};for(const T of g){const B=[];for(const U of T){if(U.length<=2)continue;const j=[];for(let V=0;V<U.length-1;V++){const z=U[V].x,G=U[V].y,$=U[V+1].x,K=U[V+1].y,te=_===0?z:G,ce=_===0?$:K;te<c?ce>c&&x(j,z,G,$,K,c):te>d?ce<d&&x(j,z,G,$,K,d):j.push(U[V]),ce<c&&te>=c&&x(j,z,G,$,K,c),ce>d&&te<=d&&x(j,z,G,$,K,d)}let R=U[U.length-1];const N=_===0?R.x:R.y;N>=c&&N<=d&&j.push(R),j.length&&(R=j[j.length-1],j[0].x===R.x&&j[0].y===R.y||j.push(j[0]),B.push(j))}B.length&&A.push(B)}return A}function LV(g,c,d,_){const A=d==="x"?"y":"x",x=(_-g[d])/(c[d]-g[d]);g[A]=g[A]+(c[A]-g[A])*x,g[d]=_,g.hasOwnProperty("z")&&(g.z=cr(g.z,c.z,x)),g.hasOwnProperty("w")&&(g.w=cr(g.w,c.w,x))}function DV(g,c,d,_){const A=d,x=_;for(const T of["x","y"]){let B=g,U=c;B[T]>=U[T]&&(B=c,U=g),B[T]<A&&U[T]>A&&LV(B,U,T,A),B[T]<x&&U[T]>x&&LV(U,B,T,x)}}const VE=Number.MAX_SAFE_INTEGER;function BV(g,c,d,_){return g.order<c||g.order===VE||!(g.clipMask&d)||function(A,x){return x.length!==0&&x.find(T=>T===A)===void 0}(_,g.clipScope)}function HE(g,c){return g.x-c.x||g.y-c.y}function kV(g,c){return HE(g.min,c.min)===0&&HE(g.max,c.max)===0}function tk(g,c){return!(g.min.x>c.max.x||g.max.x<c.min.x||g.min.y>c.max.y||g.max.y<c.min.y)}function nk(g,c){if(g.length!==c.length)return!1;for(let d=0;d<g.length;d++)if(g[d].sourceId!==c[d].sourceId||!kV(g[d],c[d])||g[d].order!==c[d].order||g[d].clipMask!==c[d].clipMask||!Jt(g[d].clipScope,c[d].clipScope))return!1;return!0}function OV(g,c,d){const _=1/yn,A=1/(1<<d.canonical.z),x=(c.x*_+d.canonical.x)*A+d.wrap,T=(c.y*_+d.canonical.y)*A;return{min:new St((g.x*_+d.canonical.x)*A+d.wrap,(g.y*_+d.canonical.y)*A),max:new St(x,T)}}function khe(g,c,d){const _=1<<d.canonical.z,A=((c.x-d.wrap)*_-d.canonical.x)*yn,x=(c.y*_-d.canonical.y)*yn;return{min:new St(((g.x-d.wrap)*_-d.canonical.x)*yn,(g.y*_-d.canonical.y)*yn),max:new St(A,x)}}function FV(g,c,d,_,A,x,T){const B=g.indices,U=g.vertices,j=[];for(let R=_;R<_+A;R+=3){const N=c[d[R+0]+x],V=c[d[R+1]+x],z=c[d[R+2]+x],G=Math.min(N.x,V.x,z.x),$=Math.max(N.x,V.x,z.x),K=Math.min(N.y,V.y,z.y),te=Math.max(N.y,V.y,z.y);j.length=0,g.grid.query(new St(G,K),new St($,te),j);for(let ce=0;ce<j.length;ce++){const he=j[ce];if(Ni(U[B[3*he+0]],U[B[3*he+1]],U[B[3*he+2]],N,V,z,T))return!0}}return!1}function NV(g,c,d,_){if(!g||!d)return!1;let A=g.vertices;if(!c.canonical.equals(_.canonical)||c.wrap!==_.wrap){if(d.vertices.length<g.vertices.length)return NV(d,_,g,c);const x=c.canonical,T=_.canonical,B=Math.pow(2,T.z-x.z);A=g.vertices.map(U=>new St((U.x+x.x*yn)*B-T.x*yn,(U.y+x.y*yn)*B-T.y*yn))}return FV(d,A,g.indices,0,g.indices.length,0,0)}function zV(g,c,d,_){const A=Math.pow(2,_.z-d.z);return new St((g+d.x*yn)*A-_.x*yn,(c+d.y*yn)*A-_.y*yn)}function UV(g,c){const d=[];c.grid.queryPoint(g,d);const _=c.indices,A=c.vertices;for(let x=0;x<d.length;x++){const T=d[x];if(is([A[_[3*T+0]],A[_[3*T+1]],A[_[3*T+2]]],g))return!0}return!1}const rk=[new St(0,0),new St(yn,0),new St(yn,yn),new St(0,yn)];function GV(g,c){const d=[];let _=[];if(!c||g.length<2)return[g];if(g.length===2)return ea(g[0],g[1],rk)?[g]:[];for(let A=0;A<g.length+2;A++){const x=g[A%g.length],T=g[(A+1)%g.length],B=ea(A===0?g[g.length-1]:g[(A-1)%g.length],x,rk),U=ea(x,T,rk),j=B||U;j&&_.push(x),j&&U||_.length>0&&(_.length>1&&d.push(_),_=[])}return _.length>1&&d.push(_),d}const ik=qx.VectorTileFeature.types,Ohe=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],Fhe=["fill-extrusion-flood-light-ground-radius"],Nhe=Math.pow(2,13),zhe=Math.pow(2,15)-1,VV=new St(0,1),tv=2147483648;function Yw(g,c,d,_,A,x,T,B){g.emplaceBack((c<<1)+T,(d<<1)+x,(Math.floor(_*Nhe)<<1)+A,Math.round(B))}function Kw(g,c,d){g.emplaceBack(c.x*yn,c.y*yn,d?1:0)}function jE(g,c,d,_,A,x){g.emplaceBack(c.x,c.y,(d.x<<1)+_,(d.y<<1)+A,x)}function Jw(g,c,d){g.emplaceBack(c.x,c.y,c.z,d[0]*16384,d[1]*16384,d[2]*16384)}class HV{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class jV{constructor(){this.centroidXY=new St(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new St(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new St(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new St(this.max.x-this.min.x,this.max.y-this.min.y)}}class WV{constructor(){this.acc=new St(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(c,d){c.min.x===Number.MAX_VALUE&&(c.min.x=c.max.x=d.x,c.min.y=c.max.y=d.y)}appendEdge(c,d,_){this.accCount++,this.acc._add(d);let A=!!this.borders;d.x<c.min.x?(c.min.x=d.x,A=!0):d.x>c.max.x&&(c.max.x=d.x,A=!0),d.y<c.min.y?(c.min.y=d.y,A=!0):d.y>c.max.y&&(c.max.y=d.y,A=!0),((d.x===0||d.x===yn)&&d.x===_.x)!=((d.y===0||d.y===yn)&&d.y===_.y)&&this.processBorderOverlap(d,_),A&&this.checkBorderIntersection(d,_)}checkBorderIntersection(c,d){d.x<0!=c.x<0&&this.addBorderIntersection(0,cr(d.y,c.y,(0-d.x)/(c.x-d.x))),d.x>yn!=c.x>yn&&this.addBorderIntersection(1,cr(d.y,c.y,(yn-d.x)/(c.x-d.x))),d.y<0!=c.y<0&&this.addBorderIntersection(2,cr(d.x,c.x,(0-d.y)/(c.y-d.y))),d.y>yn!=c.y>yn&&this.addBorderIntersection(3,cr(d.x,c.x,(yn-d.y)/(c.y-d.y)))}addBorderIntersection(c,d){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const _=this.borders[c];d<_[0]&&(_[0]=d),d>_[1]&&(_[1]=d)}processBorderOverlap(c,d){if(c.x===d.x){if(c.y===d.y)return;const _=c.x===0?0:1;this.addBorderIntersection(_,d.y),this.addBorderIntersection(_,c.y)}else{const _=c.y===0?2:3;this.addBorderIntersection(_,d.x),this.addBorderIntersection(_,c.x)}}centroid(){return this.accCount===0?new St(0,0):new St(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((c,d)=>c+ +(d[0]!==Number.MAX_VALUE),0):0}}function $V(g,c){const d=g.add(c)._unit(),_=jt(g.x*d.x+g.y*d.y,-1,1);var A,x,T;return T=Math.acos(_),Math.min(4,Math.max(-4,Math.tan(T)))/4*zhe*((A=g).x*(x=c).y-A.y*x.x<0?-1:1)}const Uhe=[g=>g.x<0,g=>g.x>yn,g=>g.y<0,g=>g.y>yn];function Ghe(g,c,d,_){const A=[4];if(_===0)return A;d._mult(_);const x=g.sub(d),T=c.sub(d),B=[g,c,x,T];for(let U=0;U<4;U++)for(const j of B)if(Uhe[U](j)){A.push(U);break}return A}class XV{constructor(c){this.vertexArray=new fc,this.indexArray=new wa,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut},d=>Fhe.includes(d)),this._segments=new ws,this.hiddenByLandmarkVertexArray=new im,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ws}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(c,d,_,A=!1){const x=c.length;if(x>2){let T=Math.max(0,this._segments.get().length-1);const B=this._segments._prepareSegment(4*x,this.vertexArray.length,2*this._segmentToGroundQuads[T].length);let U;T!==this._segments.get().length-1&&(T++,this._segmentToGroundQuads[T]=[],this._segmentToRegionTriCounts[T]=[0,0,0,0,0]);{const j=c[0],R=c[1];U=$V(j.sub(c[x-1])._perp()._unit(),R.sub(j)._perp()._unit())}for(let j=0;j<x;j++){const R=j===x-1?0:j+1,N=c[j],V=c[R],z=c[R===x-1?0:R+1],G=V.sub(N)._perp()._unit(),$=$V(G,z.sub(V)._perp()._unit()),K=U,te=$;if(sk(N,V,d)||A&&YV(N,d)&&YV(V,d)){U=$;continue}const ce=B.vertexLength;jE(this.vertexArray,N,V,1,1,K),jE(this.vertexArray,N,V,1,0,K),jE(this.vertexArray,N,V,0,1,te),jE(this.vertexArray,N,V,0,0,te),B.vertexLength+=4;const he=Ghe(N,V,G,_);for(const ne of he)this._segmentToGroundQuads[T].push({id:ce,region:ne}),this._segmentToRegionTriCounts[T][ne]+=2,B.primitiveLength+=2;U=$}}}prepareBorderSegments(){if(!this.hasData())return;const c=this._segments.get(),d=c.length;for(let _=0;_<d;_++)this._segmentToGroundQuads[_].sort((A,x)=>A.region-x.region);for(let _=0;_<d;_++){const A=this._segmentToGroundQuads[_],x=c[_],T=this._segmentToRegionTriCounts[_];T.reduce((U,j)=>U+j,0);let B=0;for(let U=0;U<=4;U++){const j=T[U];if(j!==0){let R=this.regionSegments[U];R||(R=this.regionSegments[U]=new ws);const N={vertexOffset:x.vertexOffset,primitiveOffset:x.primitiveOffset+B,vertexLength:x.vertexLength,primitiveLength:j};R.get().push(N)}B+=j}for(let U=0;U<A.length;U++){const j=A[U].id;this.indexArray.emplaceBack(j,j+1,j+3),this.indexArray.emplaceBack(j,j+3,j+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(c,d,_,A,x,T){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,c,d,_,A,x,T)}upload(c){this.hasData()&&(this.vertexBuffer=c.createVertexBuffer(this.vertexArray,Ihe.members),this.indexBuffer=c.createIndexBuffer(this.indexArray))}uploadPaintProperties(c){this.hasData()&&this.programConfigurations.upload(c)}update(c,d,_,A,x,T){this.hasData()&&this.programConfigurations.updatePaintArrays(c,d,_,A,x,T)}updateHiddenByLandmark(c){if(!this.hasData())return;const d=c.groundVertexCount+c.groundVertexArrayOffset;if(c.groundVertexCount===0)return;const _=c.flags&tv?1:0;for(let A=c.groundVertexArrayOffset;A<d;++A)this.hiddenByLandmarkVertexArray.emplace(A,_);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(c){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=c.createVertexBuffer(this.hiddenByLandmarkVertexArray,Lhe.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let c=0;c<=4;c++){const d=this.regionSegments[c];d&&d.destroy()}}}}class WE{constructor(c){this.zoom=c.zoom,this.canonical=c.canonical,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=c.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=c.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new wa,this.footprintVertices=new hc,this.footprintSegments=[],this.layoutVertexArray=new Qs,this.centroidVertexArray=new sh,this.wallVertexArray=new om,this.indexArray=new wa,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut},d=>Ohe.includes(d)),this.segments=new ws,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.groundEffect=new XV(c),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(c,d){}populate(c,d,_,A){this.features=[],this.hasPattern=qB("fill-extrusion",this.layers,d),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=rt(_),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:x,id:T,index:B,sourceLayerIndex:U}of c){const j=this.layers[0]._featureFilter.needGeometry,R=pn(x,j);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),R,_))continue;const N={id:T,sourceLayerIndex:U,index:B,geometry:j?R.geometry:fn(x,_,A),properties:x.properties,type:x.type,patterns:{}},V=this.layoutVertexArray.length,z=ik[N.type]==="Polygon";if(this.hasPattern)this.features.push(ZB("fill-extrusion",this.layers,N,this.zoom,d));else if(this.wallMode)for(const G of N.geometry)for(const $ of GV(G,z))this.addFeature(N,[$],B,_,{},d.availableImages,A,d.brightness);else this.addFeature(N,N.geometry,B,_,{},d.availableImages,A,d.brightness);d.featureIndex.insert(x,N.geometry,B,U,this.index,V)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(c,d,_,A,x,T){for(const B of this.features){const U=ik[B.type]==="Polygon",{geometry:j}=B;if(this.wallMode)for(const R of j)for(const N of GV(R,U))this.addFeature(B,[N],B.index,d,_,A,x,T);else this.addFeature(B,j,B.index,d,_,A,x,T)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(c,d,_,A,x){const T=Object.keys(c).length!==0;if(T&&!this.stateDependentLayers.length)return;const B=T?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(c,d,B,_,A,x),this.groundEffect.update(c,d,B,_,A,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,Bhe),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.wallVertexBuffer=c.createVertexBuffer(this.wallVertexArray,Phe.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=c.createVertexBuffer(this.layoutVertexExtArray,Dhe.members,!0)),this.groundEffect.upload(c)),this.groundEffect.uploadPaintProperties(c),this.programConfigurations.upload(c),this.uploaded=!0}uploadCentroid(c){this.groundEffect.uploadHiddenByLandmark(c),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=c.createVertexBuffer(this.centroidVertexArray,Rhe.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(c,d,_,A,x,T,B,U){const j=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(c,{})/this.tileToMeter,R=[new St(0,0),new St(yn,yn)],N=B.projection,V=N.name==="globe",z=this.wallMode||ik[c.type]==="Polygon",G=new WV;G.centroidDataIndex=this.centroidData.length;const $=new jV,K=this.layers[0].paint.get("fill-extrusion-base").evaluate(c,{},A)<=0,te=this.layers[0].paint.get("fill-extrusion-height").evaluate(c,{},A);let ce;if($.height=te,$.vertexArrayOffset=this.layoutVertexArray.length,$.groundVertexArrayOffset=this.groundEffect.vertexArray.length,V&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Dd),this.wallMode){if(V)return void Lt("Non zero fill-extrusion-line-width is not yet supported on globe.");if(d.length!==1)return;ce=function(Pe){const Ye=Pe[0].x===Pe[Pe.length-1].x&&Pe[0].y===Pe[Pe.length-1].y;(function(dn){let tn=0;const nr=dn.length;for(let In=0;In<nr;In++)tn+=(dn[(In+1)%nr].x-dn[In].x)*(dn[(In+1)%nr].y+dn[In].y);return tn>=0})(Pe)||(Pe=Pe.reverse());const Qe={geometry:[],joinNormals:[],indices:[]},ct=[],ht=[],ft=[];let mt=Pe.length;if(mt<(Ye?3:2))return Qe;for(;mt>=2&&Pe[mt-1].equals(Pe[mt-2]);)mt--;let Ct,_t,Ut,Yt,Dt,Rn=0;for(;Rn<mt-1&&Pe[Rn].equals(Pe[Rn+1]);)Rn++;Ye&&(Ct=Pe[mt-2],Dt=Pe[Rn].sub(Ct)._unit()._perp());for(let dn=Rn;dn<mt;dn++){if(Ut=dn===mt-1?Ye?Pe[Rn+1]:void 0:Pe[dn+1],Ut&&Pe[dn].equals(Ut))continue;Dt&&(Yt=Dt),Ct&&(_t=Ct),Ct=Pe[dn],Dt=Ut?Ut.sub(Ct)._unit()._perp():Yt,Yt=Yt||Dt;let tn=Yt.add(Dt);tn.x===0&&tn.y===0||tn._unit();const nr=tn.x*Dt.x+tn.y*Dt.y,In=nr!==0?1/nr:1/0,Nn=Yt.x*Dt.y-Yt.y*Dt.x>0;let wr="miter";const Or=2;wr==="miter"&&In>Or&&(wr="bevel"),wr==="bevel"&&(In>100&&(wr="flipbevel"),In<Or&&(wr="miter"));const Pr=(Lr,jr,Wr,Gi)=>{const Mi=new St(Lr.x,Lr.y),Tr=new St(Lr.x,Lr.y);Mi.x+=jr.x*Gi,Mi.y+=jr.y*Gi,Tr.x-=jr.x*Math.max(Wr,1),Tr.y-=jr.y*Math.max(Wr,1),ft.push(jr),ct.push(Mi),ht.push(Tr)};if(wr==="miter")tn._mult(In),Pr(Ct,tn,0,0);else if(wr==="flipbevel")tn=Dt.mult(-1),Pr(Ct,tn,0,0),Pr(Ct,tn.mult(-1),0,0);else{const Lr=-Math.sqrt(In*In-1),jr=Nn?Lr:0,Wr=Nn?0:Lr;_t&&Pr(Ct,Yt,jr,Wr),Ut&&Pr(Ct,Dt,jr,Wr)}}Qe.geometry=[...ct,...ht.reverse(),ct[0]],Qe.joinNormals=[...ft,...ft.reverse(),ft[ft.length-1]];const bn=Qe.geometry.length-1;for(let dn=0;dn<bn/2;dn++)if(dn+1<bn/2){let tn=dn,nr=dn+1,In=bn-1-dn,Nn=bn-2-dn;tn=tn===0?bn-1:tn-1,nr=nr===0?bn-1:nr-1,In=In===0?bn-1:In-1,Nn=Nn===0?bn-1:Nn-1,Qe.indices.push(In),Qe.indices.push(nr),Qe.indices.push(tn),Qe.indices.push(In),Qe.indices.push(Nn),Qe.indices.push(nr)}return Qe}(d[0]),d=[ce.geometry]}const he=(Pe,Ye)=>Pe<(Ye.length-1)/2||Pe===Ye.length-1,ne=this.wallMode?[d]:zE(d,500);for(let Pe=ne.length-1;Pe>=0;Pe--){const Ye=ne[Pe];(Ye.length===0||(de=Ye[0]).every(ze=>ze.x<=0)||de.every(ze=>ze.x>=yn)||de.every(ze=>ze.y<=0)||de.every(ze=>ze.y>=yn))&&ne.splice(Pe,1)}var de;let ge;if(V)ge=eH(ne,R,A);else{ge=[];for(const Pe of ne)ge.push({polygon:Pe,bounds:R})}const Me=z?this.edgeRadius:0,Be=Me>0&&this.zoom<17,Oe=(Pe,Ye)=>{if(Pe.length===0)return!1;const ze=Pe[Pe.length-1];return Ye.x===ze.x&&Ye.y===ze.y};for(const{polygon:Pe,bounds:Ye}of ge){let ze=0,Qe=0;for(const mt of Pe)z&&!mt[0].equals(mt[mt.length-1])&&mt.push(mt[0]),Qe+=z?mt.length-1:mt.length;const ct=this.segments.prepareSegment((z?5:4)*Qe,this.layoutVertexArray,this.indexArray);$.footprintSegIdx<0&&($.footprintSegIdx=this.footprintSegments.length),$.polygonSegIdx<0&&($.polygonSegIdx=this.polygonSegments.length);const ht={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},ft=new HV;if(ft.vertexOffset=this.footprintVertices.length,ft.indexOffset=3*this.footprintIndices.length,ft.ringIndices=[],z){const mt=[],Ct=[];ze=ct.vertexLength;for(let Ut=0;Ut<Pe.length;Ut++){const Yt=Pe[Ut];Yt.length&&Ut!==0&&Ct.push(mt.length/2);const Dt=[];let Rn,bn;Rn=Yt[1].sub(Yt[0])._perp()._unit(),ft.ringIndices.push(Yt.length-1);for(let dn=1;dn<Yt.length;dn++){const tn=Yt[dn],nr=Yt[dn===Yt.length-1?1:dn+1],In=tn.clone();if(Me){bn=nr.sub(tn)._perp()._unit();const Nn=Rn.add(bn)._unit(),wr=Me*Math.min(4,1/(Rn.x*Nn.x+Rn.y*Nn.y));In.x+=wr*Nn.x,In.y+=wr*Nn.y,In.x=Math.round(In.x),In.y=Math.round(In.y),Rn=bn}if(!K||Me!==0&&!Be||Oe(Dt,In)||Dt.push(In),Yw(this.layoutVertexArray,In.x,In.y,0,0,1,1,0),this.wallMode){const Nn=he(dn,Yt);Kw(this.wallVertexArray,ce.joinNormals[dn],!Nn)}ct.vertexLength++,this.footprintVertices.emplaceBack(tn.x,tn.y),mt.push(tn.x,tn.y),V&&Jw(this.layoutVertexExtArray,N.projectTilePoint(In.x,In.y,A),N.upVector(A,In.x,In.y))}K&&(Me===0||Be)&&(Dt.length!==0&&Oe(Dt,Dt[0])&&Dt.pop(),this.groundEffect.addData(Dt,Ye,j))}const _t=this.wallMode?ce.indices:$w(mt,Ct);for(let Ut=0;Ut<_t.length;Ut+=3)this.footprintIndices.emplaceBack(ft.vertexOffset+_t[Ut+0],ft.vertexOffset+_t[Ut+1],ft.vertexOffset+_t[Ut+2]),this.indexArray.emplaceBack(ze+_t[Ut],ze+_t[Ut+2],ze+_t[Ut+1]),ct.primitiveLength++;ft.indexCount+=_t.length,ft.vertexCount+=this.footprintVertices.length-ft.vertexOffset}for(let mt=0;mt<Pe.length;mt++){const Ct=Pe[mt];G.startRing($,Ct[0]);let _t=Ct.length>4&&KV(Ct[Ct.length-2],Ct[0],Ct[1]),Ut=Me?Vhe(Ct[Ct.length-2],Ct[0],Ct[1],Me):0;const Yt=[];let Dt,Rn,bn;Rn=Ct[1].sub(Ct[0])._perp()._unit();let dn=!0;for(let tn=1,nr=0;tn<Ct.length;tn++){let In=Ct[tn-1],Nn=Ct[tn];const wr=Ct[tn===Ct.length-1?1:tn+1];if(G.appendEdge($,Nn,In),sk(Nn,In,Ye)){Me&&(Rn=wr.sub(Nn)._perp()._unit(),dn=!dn);continue}const Or=Nn.sub(In)._perp(),Pr=Or.x/(Math.abs(Or.x)+Math.abs(Or.y)),Lr=Or.y>0?1:0,jr=In.dist(Nn);if(nr+jr>32768&&(nr=0),Me){bn=wr.sub(Nn)._perp()._unit();let Tr=ZV(In,Nn,wr,qV(Rn,bn),Me);isNaN(Tr)&&(Tr=0);const _i=Nn.sub(In)._unit();In=In.add(_i.mult(Ut))._round(),Nn=Nn.add(_i.mult(-Tr))._round(),Ut=Tr,Rn=bn,K&&this.zoom>=17&&(Oe(Yt,In)||Yt.push(In),Oe(Yt,Nn)||Yt.push(Nn))}const Wr=ct.vertexLength,Gi=Ct.length>4&&KV(In,Nn,wr);let Mi=JV(nr,_t,dn);if(Yw(this.layoutVertexArray,In.x,In.y,Pr,Lr,0,0,Mi),Yw(this.layoutVertexArray,In.x,In.y,Pr,Lr,0,1,Mi),this.wallMode){const Tr=he(tn-1,Ct),_i=ce.joinNormals[tn-1];Kw(this.wallVertexArray,_i,Tr),Kw(this.wallVertexArray,_i,Tr)}if(nr+=jr,Mi=JV(nr,Gi,!dn),_t=Gi,Yw(this.layoutVertexArray,Nn.x,Nn.y,Pr,Lr,0,0,Mi),Yw(this.layoutVertexArray,Nn.x,Nn.y,Pr,Lr,0,1,Mi),this.wallMode){const Tr=he(tn,Ct),_i=ce.joinNormals[tn];Kw(this.wallVertexArray,_i,Tr),Kw(this.wallVertexArray,_i,Tr)}if(ct.vertexLength+=4,this.indexArray.emplaceBack(Wr+0,Wr+1,Wr+2),this.indexArray.emplaceBack(Wr+1,Wr+3,Wr+2),ct.primitiveLength+=2,Me){const Tr=ze+(tn===1?Ct.length-2:tn-2),_i=tn===1?ze:Tr+1;if(this.indexArray.emplaceBack(Wr+1,Tr,Wr+3),this.indexArray.emplaceBack(Tr,_i,Wr+3),ct.primitiveLength+=2,Dt===void 0&&(Dt=Wr),!sk(wr,Ct[tn],Ye)){const wi=tn===Ct.length-1?Dt:ct.vertexLength;this.indexArray.emplaceBack(Wr+2,Wr+3,wi),this.indexArray.emplaceBack(Wr+3,wi+1,wi),this.indexArray.emplaceBack(Wr+3,_i,wi+1),ct.primitiveLength+=3}dn=!dn}if(V){const Tr=this.layoutVertexExtArray,_i=N.projectTilePoint(In.x,In.y,A),wi=N.projectTilePoint(Nn.x,Nn.y,A),ss=N.upVector(A,In.x,In.y),Ws=N.upVector(A,Nn.x,Nn.y);Jw(Tr,_i,ss),Jw(Tr,_i,ss),Jw(Tr,wi,Ws),Jw(Tr,wi,Ws)}}z&&(ze+=Ct.length-1),K&&Me&&this.zoom>=17&&(Yt.length!==0&&Oe(Yt,Yt[0])&&Yt.pop(),this.groundEffect.addData(Yt,Ye,j,Me>0))}this.footprintSegments.push(ft),ht.triangleCount=this.indexArray.length-ht.triangleArrayOffset,this.polygonSegments.push(ht),++$.footprintSegLen,++$.polygonSegLen}if($.vertexCount=this.layoutVertexArray.length-$.vertexArrayOffset,$.groundVertexCount=this.groundEffect.vertexArray.length-$.groundVertexArrayOffset,$.vertexCount!==0){if($.centroidXY=G.borders?VV:this.encodeCentroid(G,$),this.centroidData.push($),G.borders){this.featuresOnBorder.push(G);const Pe=this.featuresOnBorder.length-1;for(let Ye=0;Ye<G.borders.length;Ye++)G.borders[Ye][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Ye].push(Pe)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,x,T,A,U),this.groundEffect.addPaintPropertiesData(c,_,x,T,A,U),this.maxHeight=Math.max(this.maxHeight,te)}}sortBorders(){for(let c=0;c<this.borderFeatureIndices.length;c++)this.borderFeatureIndices[c].sort((d,_)=>this.featuresOnBorder[d].borders[c][0]-this.featuresOnBorder[_].borders[c][0])}splitToSubtiles(){const c=[];for(let B=0;B<this.centroidData.length;B++){const U=this.centroidData[B],j=+(U.min.y+U.max.y>yn),R=2*j+(+(U.min.x+U.max.x>yn)^j);for(let N=0;N<U.polygonSegLen;N++){const V=U.polygonSegIdx+N;c.push({centroidIdx:B,subtile:R,polygonSegmentIdx:V,triangleSegmentIdx:this.polygonSegments[V].triangleSegIdx})}}const d=new wa;c.sort((B,U)=>B.triangleSegmentIdx===U.triangleSegmentIdx?B.subtile-U.subtile:B.triangleSegmentIdx-U.triangleSegmentIdx);let _=0,A=0,x=0;for(const B of c){if(B.triangleSegmentIdx!==_)break;x++}const T=c.length;for(;A!==c.length;){_=c[A].triangleSegmentIdx;let B=0,U=A,j=A;for(let R=U;R<x&&c[R].subtile===B;R++)j++;for(;U!==x;){const R=c[U];B=R.subtile;const N=this.centroidData[R.centroidIdx].min.clone(),V=this.centroidData[R.centroidIdx].max.clone(),z={vertexOffset:this.segments.segments[_].vertexOffset,primitiveOffset:d.length,vertexLength:this.segments.segments[_].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let G=U;G<j;G++){const $=c[G],K=this.polygonSegments[$.polygonSegmentIdx],te=this.centroidData[$.centroidIdx].min,ce=this.centroidData[$.centroidIdx].max,he=this.indexArray.uint16;for(let ne=K.triangleArrayOffset;ne<K.triangleArrayOffset+K.triangleCount;ne++)d.emplaceBack(he[3*ne],he[3*ne+1],he[3*ne+2]);z.primitiveLength+=K.triangleCount,N.x=Math.min(N.x,te.x),N.y=Math.min(N.y,te.y),V.x=Math.max(V.x,ce.x),V.y=Math.max(V.y,ce.y)}z.primitiveLength>0&&this.triangleSubSegments.push({segment:z,min:N,max:V}),U=j;for(let G=U;G<x&&c[G].subtile===c[U].subtile;G++)j++}A=x;for(let R=A;R<T&&c[R].triangleSegmentIdx===c[A].triangleSegmentIdx;R++)x++}d._trim(),this.indexArray=d}getVisibleSegments(c,d,_){const A=new ws;if(this.wallMode){for(const $ of this.triangleSubSegments)A.segments.push($.segment);return A}let x=0,T=0;const B=1<<c.canonical.z;if(d){const $=d.getMinMaxForTile(c);$&&(x=$.min,T=$.max)}T+=this.maxHeight;const U=c.toUnwrapped();let j;const R=[U.canonical.x/B+U.wrap,U.canonical.y/B],N=[(U.canonical.x+1)/B+U.wrap,(U.canonical.y+1)/B],V=($,K,te)=>[$[0]*(1-te[0])+K[0]*te[0],$[1]*(1-te[1])+K[1]*te[1]],z=[],G=[];for(const $ of this.triangleSubSegments){z[0]=$.min.x/yn,z[1]=$.min.y/yn,G[0]=$.max.x/yn,G[1]=$.max.y/yn;const K=V(R,N,z),te=V(R,N,G);if(new Ji([K[0],K[1],x],[te[0],te[1],T]).intersectsPrecise(_)===0){j&&(A.segments.push(j),j=void 0);continue}const ce=$.segment;j&&j.vertexOffset!==ce.vertexOffset&&(A.segments.push(j),j=void 0),j?(j.vertexLength+=ce.vertexLength,j.primitiveLength+=ce.primitiveLength):j={vertexOffset:ce.vertexOffset,primitiveLength:ce.primitiveLength,vertexLength:ce.vertexLength,primitiveOffset:ce.primitiveOffset,sortKey:void 0,vaos:{}}}return j&&A.segments.push(j),A}encodeCentroid(c,d){const _=c.centroid(),A=d.span(),x=Math.min(7,Math.round(A.x*this.tileToMeter/10)),T=Math.min(7,Math.round(A.y*this.tileToMeter/10));return new St(jt(_.x,1,yn-1)<<3|x,jt(_.y,1,yn-1)<<3|T)}encodeBorderCentroid(c){if(!c.borders)return new St(0,0);const d=c.borders,_=Number.MAX_VALUE;if(d[0][0]!==_||d[1][0]!==_){const A=d[0][0]!==_?0:1;return new St(6|(d[0][0]!==_?0:65528),(d[A][0]+d[A][1])/2<<3|6)}{const A=d[2][0]!==_?2:3;return new St((d[A][0]+d[A][1])/2<<3|6,6|(d[2][0]!==_?0:65528))}}showCentroid(c){const d=this.centroidData[c.centroidDataIndex];d.flags&=tv,d.centroidXY.x=0,d.centroidXY.y=0,this.writeCentroidToBuffer(d)}writeCentroidToBuffer(c){this.groundEffect.updateHiddenByLandmark(c);const d=c.vertexArrayOffset,_=c.vertexCount+c.vertexArrayOffset,A=c.flags&tv?VV:c.centroidXY,x=this.centroidVertexArray.geta_centroid_pos0(d);if(this.centroidVertexArray.geta_centroid_pos1(d)!==A.y||x!==A.x){for(let T=d;T<_;++T)this.centroidVertexArray.emplace(T,A.x,A.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const c of this.centroidData)this.writeCentroidToBuffer(c)}updateReplacement(c,d,_){if(d.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=d.updateTime;const A=d.getReplacementRegionsForTile(c.toUnwrapped());if(nk(this.activeReplacements,A))return;if(this.activeReplacements=A,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const T of this.centroidData)T.flags&=2147483647;const x=[];for(const T of this.activeReplacements){if(T.order<_)continue;const B=Math.pow(2,T.footprintTileId.canonical.z-c.canonical.z);for(const U of this.centroidData)if(!(U.flags&tv||T.min.x>U.max.x||U.min.x>T.max.x||T.min.y>U.max.y||U.min.y>T.max.y))for(let j=0;j<U.footprintSegLen;j++){const R=this.footprintSegments[U.footprintSegIdx+j];if(x.length=0,Hhe(this.footprintVertices,R.vertexOffset,R.vertexCount,T.footprintTileId.canonical,c.canonical,x),FV(T.footprint,x,this.footprintIndices.uint16,R.indexOffset,R.indexCount,-R.vertexOffset,-B)){U.flags|=tv;break}}}for(const T of this.centroidData)this.writeCentroidToBuffer(T);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(c,d,_){let A=!1;for(let x=0;x<_.footprintSegLen;x++){const T=this.footprintSegments[_.footprintSegIdx+x];let B=0;for(const U of T.ringIndices){for(let j=B,R=U+B-1;j<U+B;R=j++){const N=this.footprintVertices.int16[2*(j+T.vertexOffset)+0],V=this.footprintVertices.int16[2*(j+T.vertexOffset)+1],z=this.footprintVertices.int16[2*(R+T.vertexOffset)+1];V>d!=z>d&&c<(this.footprintVertices.int16[2*(R+T.vertexOffset)+0]-N)*(d-V)/(z-V)+N&&(A=!A)}B=U}}return A}getHeightAtTileCoord(c,d){let _=Number.NEGATIVE_INFINITY,A=!0;const x=4*(c+yn)*yn+(d+yn);if(this.partLookup.hasOwnProperty(x)){const T=this.partLookup[x];return T?{height:T.height,hidden:!!(T.flags&tv)}:void 0}for(const T of this.centroidData)c>T.max.x||T.min.x>c||d>T.max.y||T.min.y>d||this.footprintContainsPoint(c,d,T)&&T&&T.height>_&&(_=T.height,this.partLookup[x]=T,A=!!(T.flags&tv));if(_!==Number.NEGATIVE_INFINITY)return{height:_,hidden:A};this.partLookup[x]=void 0}}function qV(g,c){const d=g.add(c)._unit();return g.x*d.x+g.y*d.y}function Vhe(g,c,d,_){const A=c.sub(g)._perp()._unit(),x=d.sub(c)._perp()._unit();return ZV(g,c,d,qV(A,x),_)}function ZV(g,c,d,_,A){const x=Math.sqrt(1-_*_);return Math.min(g.dist(c)/3,c.dist(d)/3,A*x/_)}function sk(g,c,d){return g.x<d[0].x&&c.x<d[0].x||g.x>d[1].x&&c.x>d[1].x||g.y<d[0].y&&c.y<d[0].y||g.y>d[1].y&&c.y>d[1].y}function YV(g,c){return g.x<c[0].x||g.x>c[1].x||g.y<c[0].y||g.y>c[1].y}function KV(g,c,d){if(g.x<0||g.x>=yn||c.x<0||c.x>=yn||d.x<0||d.x>=yn)return!1;const _=d.sub(c),A=_.perp(),x=g.sub(c);return(_.x*x.x+_.y*x.y)/Math.sqrt((_.x*_.x+_.y*_.y)*(x.x*x.x+x.y*x.y))>-.866&&A.x*x.x+A.y*x.y<0}function JV(g,c,d){const _=c?2|g:-3&g;return d?1|_:-2&_}function QV(){const g=Math.PI/32,c=Math.tan(g),d=ae;return d*Math.sqrt(1+2*c*c)-d}function eH(g,c,d){const _=1<<d.z,A=$e(d.x/_),x=$e((d.x+1)/_),T=je(d.y/_),B=je((d.y+1)/_);return function(U,j,R,N,V=0,z){const G=[];if(!U.length||!R||!N)return G;const $=(ge,Me)=>{for(const Be of ge)G.push({polygon:Be,bounds:Me})},K=Math.ceil(Math.log2(R)),te=Math.ceil(Math.log2(N)),ce=K-te,he=[];for(let ge=0;ge<Math.abs(ce);ge++)he.push(ce>0?0:1);for(let ge=0;ge<Math.min(K,te);ge++)he.push(0),he.push(1);let ne=U;if(ne=GE(ne,j[0].y-V,j[1].y+V,1),ne=GE(ne,j[0].x-V,j[1].x+V,0),!ne.length)return G;const de=[];for(he.length?de.push({polygons:ne,bounds:j,depth:0}):$(ne,j);de.length;){const ge=de.pop(),Me=ge.depth,Be=he[Me],Oe=ge.bounds[0],Pe=ge.bounds[1],Ye=Be===0?Oe.x:Oe.y,ze=Be===0?Pe.x:Pe.y,Qe=z?z(Be,Ye,ze):.5*(Ye+ze),ct=GE(ge.polygons,Ye-V,Qe+V,Be),ht=GE(ge.polygons,Qe-V,ze+V,Be);if(ct.length){const ft=[Oe,new St(Be===0?Qe:Pe.x,Be===1?Qe:Pe.y)];he.length>Me+1?de.push({polygons:ct,bounds:ft,depth:Me+1}):$(ct,ft)}if(ht.length){const ft=[new St(Be===0?Qe:Oe.x,Be===1?Qe:Oe.y),Pe];he.length>Me+1?de.push({polygons:ht,bounds:ft,depth:Me+1}):$(ht,ft)}}return G}(g,c,Math.ceil((x-A)/11.25),Math.ceil((T-B)/11.25),1,(U,j,R)=>{if(U===0)return .5*(j+R);{const N=je((d.y+j/yn)/_);return(Ne(.5*(je((d.y+R/yn)/_)+N))*_-d.y)*yn}})}function Hhe(g,c,d,_,A,x){const T=Math.pow(2,_.z-A.z);for(let B=0;B<d;B++){let U=g.int16[2*(B+c)+0],j=g.int16[2*(B+c)+1];U=(U+A.x*yn)*T-_.x*yn,j=(j+A.y*yn)*T-_.y*yn,x.push(new St(U,j))}}let tH,nH;function Qw(g,c){return g.x*c.x+g.y*c.y}function rH(g,c){if(g.length===1){let d=0;const _=c[d++];let A;for(;!A||_.equals(A);)if(A=c[d++],!A)return 1/0;for(;d<c.length;d++){const x=c[d],T=g[0],B=A.sub(_),U=x.sub(_),j=T.sub(_),R=Qw(B,B),N=Qw(B,U),V=Qw(U,U),z=Qw(j,B),G=Qw(j,U),$=R*V-N*N,K=(V*z-N*G)/$,te=(R*G-N*z)/$,ce=_.z*(1-K-te)+A.z*K+x.z*te;if(isFinite(ce))return ce}return 1/0}{let d=1/0;for(const _ of c)d=Math.min(d,_.z);return d}}function iH(g,c,d,_,A,x,T,B){const U=T*A.getElevationAt(g,c,!0,!0),j=x[0]!==0,R=j?x[1]===0?T*(x[0]/7-450):T*function(N,V,z){const G=Math.floor(V[0]/8),$=Math.floor(V[1]/8),K=10*(V[0]-8*G),te=10*(V[1]-8*$),ce=N.getElevationAt(G,$,!0,!0),he=N.getMeterToDEM(z),ne=Math.floor(.5*(K*he-1)),de=Math.floor(.5*(te*he-1)),ge=N.tileCoordToPixel(G,$),Me=2*ne+1,Be=2*de+1,Oe=function(ht,ft,mt,Ct,_t){return[ht.getElevationAtPixel(ft,mt,!0),ht.getElevationAtPixel(ft+_t,mt,!0),ht.getElevationAtPixel(ft,mt+_t,!0),ht.getElevationAtPixel(ft+Ct,mt+_t,!0)]}(N,ge.x-ne,ge.y-de,Me,Be),Pe=Math.abs(Oe[0]-Oe[1]),Ye=Math.abs(Oe[2]-Oe[3]),ze=Math.abs(Oe[0]-Oe[2])+Math.abs(Oe[1]-Oe[3]),Qe=Math.min(.25,.5*he*(Pe+Ye)/Me),ct=Math.min(.25,.5*he*ze/Be);return ce+Math.max(Qe*K,ct*te)}(A,x,B):U;return{base:U+(d===0)?-1:d,top:j?Math.max(R+_,U+d+2):U+_}}Fn(WE,"FillExtrusionBucket",{omit:["layers","features"]}),Fn(jV,"PartData"),Fn(HV,"FootprintSegment"),Fn(WV,"BorderCentroidData"),Fn(XV,"GroundEffect");const jhe=Qr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Whe=Qr([{name:"a_z_offset",components:1,type:"Float32"}],4),{members:$he}=jhe,Xhe=Qr([{name:"a_packed",components:4,type:"Float32"}]),{members:qhe}=Xhe,Zhe=Qr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Yhe}=Zhe;class sH{constructor(c,d){this.width=c,this.height=d,this.nextRow=0,this.image=new ev({width:c,height:d}),this.positions={},this.uploaded=!1}getDash(c,d){const _=this.getKey(c,d);return this.positions[_]}trim(){const c=this.width,d=this.height=ui(this.nextRow);this.image.resize({width:c,height:d})}getKey(c,d){return c.join(",")+d}getDashRanges(c,d,_){const A=[];let x=c.length%2==1?-c[c.length-1]*_:0,T=c[0]*_,B=!0;A.push({left:x,right:T,isDash:B,zeroLength:c[0]===0});let U=c[0];for(let j=1;j<c.length;j++){B=!B;const R=c[j];x=U*_,U+=R,T=U*_,A.push({left:x,right:T,isDash:B,zeroLength:R===0})}return A}addRoundDash(c,d,_){const A=d/2;for(let x=-_;x<=_;x++){const T=this.width*(this.nextRow+_+x);let B=0,U=c[B];for(let j=0;j<this.width;j++){j/U.right>1&&(U=c[++B]);const R=Math.abs(j-U.left),N=Math.abs(j-U.right),V=Math.min(R,N);let z;const G=x/_*(A+1);if(U.isDash){const $=A-Math.abs(G);z=Math.sqrt(V*V+$*$)}else z=A-Math.sqrt(V*V+G*G);this.image.data[T+j]=Math.max(0,Math.min(255,z+128))}}}addRegularDash(c,d){for(let U=c.length-1;U>=0;--U){const j=c[U],R=c[U+1];j.zeroLength?c.splice(U,1):R&&R.isDash===j.isDash&&(R.left=j.left,c.splice(U,1))}const _=c[0],A=c[c.length-1];_.isDash===A.isDash&&(_.left=A.left-this.width,A.right=_.right+this.width);const x=this.width*this.nextRow;let T=0,B=c[T];for(let U=0;U<this.width;U++){U/B.right>1&&(B=c[++T]);const j=Math.abs(U-B.left),R=Math.abs(U-B.right),N=Math.min(j,R);this.image.data[x+U]=Math.max(0,Math.min(255,(B.isDash?N:-N)+d+128))}}addDash(c,d){const _=this.getKey(c,d);if(this.positions[_])return this.positions[_];const A=d==="round",x=A?7:0,T=2*x+1;if(this.nextRow+T>this.height)return Lt("LineAtlas out of space"),null;c.length===0&&c.push(1);let B=0;for(let R=0;R<c.length;R++)c[R]<0&&(Lt("Negative value is found in line dasharray, replacing values with 0"),c[R]=0),B+=c[R];if(B!==0){const R=this.width/B,N=this.getDashRanges(c,this.width,R);A?this.addRoundDash(N,R,x):this.addRegularDash(N,d==="square"?.5*R:0)}const U=this.nextRow+x;this.nextRow+=T;const j={tl:[U,x],br:[B,0]};return this.positions[_]=j,j}}Fn(sH,"LineAtlas");const Khe=qx.VectorTileFeature.types,Jhe=Math.cos(Math.PI/180*37.5),Qhe=Math.cos(Math.PI/180*5);class ak{constructor(c){this.zoom=c.zoom,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(d=>d.fqid),this.index=c.index,this.projection=c.projection,this.hasPattern=!1,this.hasZOffset=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(d=>{this.gradients[d.id]={}}),this.layoutVertexArray=new el,this.layoutVertexArray2=new Ll,this.patternVertexArray=new ua,this.indexArray=new wa,this.programConfigurations=new rr(c.layers,{zoom:c.zoom,lut:c.lut}),this.segments=new ws,this.maxLineLength=0,this.zOffsetVertexArray=new kd,this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.tessellationStep=c.tessellationStep?c.tessellationStep:yn/64}updateFootprints(c,d){}populate(c,d,_,A){this.hasPattern=qB("line",this.layers,d);const x=this.layers[0].layout.get("line-sort-key"),T=this.layers[0].layout.get("line-z-offset");this.hasZOffset=!T.isConstant()||!!T.constantOr(0);const B=[];for(const{feature:N,id:V,index:z,sourceLayerIndex:G}of c){const $=this.layers[0]._featureFilter.needGeometry,K=pn(N,$);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),K,_))continue;const te=x?x.evaluate(K,{},_):void 0,ce={id:V,properties:N.properties,type:N.type,sourceLayerIndex:G,index:z,geometry:$?K.geometry:fn(N,_,A),patterns:{},sortKey:te};B.push(ce)}x&&B.sort((N,V)=>N.sortKey-V.sortKey);const{lineAtlas:U,featureIndex:j}=d,R=this.addConstantDashes(U);for(const N of B){const{geometry:V,index:z,sourceLayerIndex:G}=N;if(R&&this.addFeatureDashes(N,U),this.hasPattern){const $=ZB("line",this.layers,N,this.zoom,d);this.patternFeatures.push($)}else this.addFeature(N,V,z,_,U.positions,d.availableImages,d.brightness);j.insert(c[z].feature,V,z,G,this.index)}}addConstantDashes(c){let d=!1;for(const _ of this.layers){const A=_.paint.get("line-dasharray").value,x=_.layout.get("line-cap").value;if(A.kind!=="constant"||x.kind!=="constant")d=!0;else{const T=x.value,B=A.value;if(!B)continue;c.addDash(B,T)}}return d}addFeatureDashes(c,d){const _=this.zoom;for(const A of this.layers){const x=A.paint.get("line-dasharray").value,T=A.layout.get("line-cap").value;if(x.kind==="constant"&&T.kind==="constant")continue;let B,U;if(x.kind==="constant"){if(B=x.value,!B)continue}else B=x.evaluate({zoom:_},c);U=T.kind==="constant"?T.value:T.evaluate({zoom:_},c),d.addDash(B,U),c.patterns[A.id]=d.getKey(B,U)}}update(c,d,_,A,x){const T=Object.keys(c).length!==0;T&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(c,d,T?this.stateDependentLayers:this.layers,_,A,x)}addFeatures(c,d,_,A,x,T){for(const B of this.patternFeatures)this.addFeature(B,B.geometry,B.index,d,_,A,T)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(c){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=c.createVertexBuffer(this.layoutVertexArray2,qhe)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=c.createVertexBuffer(this.patternVertexArray,Yhe)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=c.createVertexBuffer(this.zOffsetVertexArray,Whe.members,!0)),this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,$he),this.indexBuffer=c.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(c),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(c){if(c.properties&&c.properties.hasOwnProperty("mapbox_clip_start")&&c.properties.hasOwnProperty("mapbox_clip_end"))return{start:+c.properties.mapbox_clip_start,end:+c.properties.mapbox_clip_end}}addFeature(c,d,_,A,x,T,B){const U=this.layers[0].layout,j=U.get("line-join").evaluate(c,{}),R=U.get("line-cap").evaluate(c,{}),N=U.get("line-miter-limit"),V=U.get("line-round-limit");this.lineClips=this.lineFeatureClips(c);for(const z of d)this.addLine(z,c,A,j,R,N,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,c,_,x,T,A,B)}addLine(c,d,_,A,x,T,B){this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.currentVertex=void 0;const U={zoom:this.zoom,lineProgress:void 0},j=this.layers[0].layout,R=A==="none";if(this.patternJoinNone=this.hasPattern&&R,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<c.length-1;ge++)this.totalDistance+=c[ge].dist(c[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const N=Khe[d.type]==="Polygon";let V=c.length;for(;V>=2&&c[V-1].equals(c[V-2]);)V--;let z=0;for(;z<V-1&&c[z].equals(c[z+1]);)z++;if(V<(N?3:2))return;A==="bevel"&&(T=1.05);const G=this.overscaling<=16?15*yn/(512*this.overscaling):0,$=this.segments.prepareSegment(10*V,this.layoutVertexArray,this.indexArray);let K,te,ce,he,ne,de;this.e1=this.e2=-1,N&&(K=c[V-2],ne=c[z].sub(K)._unit()._perp());for(let ge=z;ge<V;ge++){if(ce=ge===V-1?N?c[z+1]:void 0:c[ge+1],ce&&c[ge].equals(ce))continue;if(ne&&(he=ne),K&&(te=K),K=c[ge],this.hasZOffset){const ft=j.get("line-z-offset").value;if(ft.kind==="constant")de=ft.value;else{if(this.lineClips){const mt=this.totalDistance/(this.lineClips.end-this.lineClips.start);U.lineProgress=(mt*this.lineClips.start+this.distance+(te?te.dist(K):0))/mt}else Lt(`line-z-offset evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`),U.lineProgress=0;de=ft.evaluate(U,d)}de=de||0}ne=ce?ce.sub(K)._unit()._perp():he,he=he||ne;const Me=te&&ce;let Be=Me?A:N||R?"butt":x;const Oe=he.x*ne.x+he.y*ne.y;if(R){const ft=function(mt){if(mt.patternJoinNone){const Ct=mt.segmentPoints.length/2,_t=mt.lineSoFar-mt.segmentStart;for(let Ut=0;Ut<Ct;++Ut){const Yt=mt.segmentPoints[2*Ut+1],Dt=Math.round(mt.segmentPoints[2*Ut])+.5+.25*Yt;mt.patternVertexArray.emplaceBack(Dt,_t,mt.segmentStart),mt.patternVertexArray.emplaceBack(Dt,_t,mt.segmentStart)}mt.segmentPoints.length=0}mt.e1=mt.e2=-1};if(Me&&Oe<Qhe){this.updateDistance(te,K),this.addCurrentVertex(K,he,1,1,$,de),ft(this),this.addCurrentVertex(K,ne,-1,-1,$,de);continue}if(te){if(!ce){this.updateDistance(te,K),this.addCurrentVertex(K,he,1,1,$,de),ft(this);continue}Be="miter"}}let Pe=he.add(ne);Pe.x===0&&Pe.y===0||Pe._unit();const Ye=Pe.x*ne.x+Pe.y*ne.y,ze=Ye!==0?1/Ye:1/0,Qe=2*Math.sqrt(2-2*Ye),ct=Ye<Jhe&&te&&ce,ht=he.x*ne.y-he.y*ne.x>0;if(ct&&ge>z){const ft=K.dist(te);if(ft>2*G){const mt=K.sub(K.sub(te)._mult(G/ft)._round());this.updateDistance(te,mt),this.addCurrentVertex(mt,he,0,0,$,de),te=mt}}if(Me&&Be==="round"&&(ze<B?Be="miter":ze<=2&&(Be="fakeround")),Be==="miter"&&ze>T&&(Be="bevel"),Be==="bevel"&&(ze>2&&(Be="flipbevel"),ze<T&&(Be="miter")),te&&this.updateDistance(te,K),Be==="miter")Pe._mult(ze),this.addCurrentVertex(K,Pe,0,0,$,de);else if(Be==="flipbevel"){if(ze>100)Pe=ne.mult(-1);else{const ft=ze*he.add(ne).mag()/he.sub(ne).mag();Pe._perp()._mult(ft*(ht?-1:1))}this.addCurrentVertex(K,Pe,0,0,$,de),this.addCurrentVertex(K,Pe.mult(-1),0,0,$,de)}else if(Be==="bevel"||Be==="fakeround"){const ft=-Math.sqrt(ze*ze-1),mt=ht?ft:0,Ct=ht?0:ft;if(te&&this.addCurrentVertex(K,he,mt,Ct,$,de),Be==="fakeround"){const _t=Math.round(180*Qe/Math.PI/20);for(let Ut=1;Ut<_t;Ut++){let Yt=Ut/_t;if(Yt!==.5){const Rn=Yt-.5;Yt+=Yt*Rn*(Yt-1)*((1.0904+Oe*(Oe*(3.55645-1.43519*Oe)-3.2452))*Rn*Rn+(.848013+Oe*(.215638*Oe-1.06021)))}const Dt=ne.sub(he)._mult(Yt)._add(he)._unit()._mult(ht?-1:1);this.addHalfVertex(K,Dt.x,Dt.y,!1,ht,0,$,de)}}ce&&this.addCurrentVertex(K,ne,-mt,-Ct,$,de)}else Be==="butt"?this.addCurrentVertex(K,Pe,0,0,$,de):Be==="square"?(te||this.addCurrentVertex(K,Pe,-1,-1,$,de),this.addCurrentVertex(K,Pe,0,0,$,de),te&&this.addCurrentVertex(K,Pe,1,1,$,de)):Be==="round"&&(te&&(this.addCurrentVertex(K,he,0,0,$,de),this.addCurrentVertex(K,he,1,1,$,de,!0)),ce&&(this.addCurrentVertex(K,ne,-1,-1,$,de,!0),this.addCurrentVertex(K,ne,0,0,$,de)));if(ct&&ge<V-1){const ft=K.dist(ce);if(ft>2*G){const mt=K.add(ce.sub(K)._mult(G/ft)._round());this.updateDistance(K,mt),this.addCurrentVertex(mt,ne,0,0,$,de),K=mt}}}}addVerticesTo(c,d,_,A,x,T,B,U,j,R){const N=(d.w-c.w)/this.tessellationStep|0;if(N>1){this.lineSoFar=c.w;const V=(d.x-c.x)/N,z=(d.y-c.y)/N,G=(d.z-c.z)/N,$=(d.w-c.w)/N;for(let K=1;K<N;++K)c.x+=V,c.y+=z,c.z+=G,this.lineSoFar+=$,this.addHalfVertex(c,_,A,R,!1,B,j,c.z),this.addHalfVertex(c,x,T,R,!0,-U,j,c.z)}this.lineSoFar=d.w,this.addHalfVertex(d,_,A,R,!1,B,j,d.z),this.addHalfVertex(d,x,T,R,!0,-U,j,d.z)}addCurrentVertex(c,d,_,A,x,T,B=!1){const U=d.x+d.y*_,j=d.y-d.x*_,R=d.y*A-d.x,N=-d.y-d.x*A;if(T!=null){const z=yn+10,G=T,$=new PV(c.x,c.y,G,this.lineSoFar),K=aH(c,-10,z),te=this.lineSoFar;if(this.currentVertex)if(K){const ce=this.currentVertexIsOutside,he=this.currentVertex,ne=new PV(c.x,c.y,G,this.lineSoFar);DV(he,ne,-10,z),aH(ne,-10,z)||(ce&&(this.e1=this.e2=-1,this.lineSoFar=he.w,this.addHalfVertex(he,U,j,B,!1,_,x,he.z),this.addHalfVertex(he,R,N,B,!0,-A,x,he.z)),this.addVerticesTo(he,ne,U,j,R,N,_,A,x,B))}else{const ce=this.currentVertex;this.currentVertexIsOutside&&(DV(ce,$,-10,z),this.e1=this.e2=-1,this.lineSoFar=ce.w,this.addHalfVertex(ce,U,j,B,!1,_,x,ce.z),this.addHalfVertex(ce,R,N,B,!0,-A,x,ce.z)),this.addVerticesTo(ce,$,U,j,R,N,_,A,x,B)}else K||(this.addHalfVertex(c,U,j,B,!1,_,x,T),this.addHalfVertex(c,R,N,B,!0,-A,x,T));this.currentVertex=$,this.currentVertexIsOutside=K,this.lineSoFar=te}else this.addHalfVertex(c,U,j,B,!1,_,x,T),this.addHalfVertex(c,R,N,B,!0,-A,x,T)}addHalfVertex({x:c,y:d},_,A,x,T,B,U,j){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),T||this.segmentPoints.push(this.lineSoFar-this.segmentStart,B)),this.layoutVertexArray.emplaceBack((c<<1)+(x?1:0),(d<<1)+(T?1:0),Math.round(63*_)+128,Math.round(63*A)+128,1+(B===0?0:B<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const R=U.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,R),U.primitiveLength++),T?this.e2=R:this.e1=R,j!=null&&this.zOffsetVertexArray.emplaceBack(j)}updateScaledDistance(){if(this.lineClips){const c=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=c*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(c,d){this.distance+=c.dist(d),this.updateScaledDistance()}}function aH(g,c,d){return g.x<c||g.x>d||g.y<c||g.y>d}let oH,lH;function cH(g,c,d){return c*(yn/(g.tileSize*Math.pow(2,d-g.tileID.overscaledZ)))}function uH(g,c){return 1/cH(g,1,c.tileZoom)}function hH(g,c,d,_){return g.translatePosMatrix(_||c.tileID.projMatrix,c,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}Fn(ak,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const fH=g=>{const c=[];dH(g)&&c.push("RENDER_LINE_DASH"),g.paint.get("line-gradient")&&c.push("RENDER_LINE_GRADIENT");const d=g.paint.get("line-trim-offset");d[0]===0&&d[1]===0||c.push("RENDER_LINE_TRIM_OFFSET"),g.paint.get("line-border-width").constantOr(1)!==0&&c.push("RENDER_LINE_BORDER");const _=g.layout.get("line-join").constantOr("miter")==="none",A=!!g.paint.get("line-pattern").constantOr(1);return _&&A&&c.push("LINE_JOIN_NONE"),c};function dH(g){const c=g.paint.get("line-dasharray").value;return c.value||c.kind!=="constant"}let ok;const pH=()=>ok||(ok={layout:oH||(oH=new Wi({"line-cap":new Kn(At.layout_line["line-cap"]),"line-join":new Kn(At.layout_line["line-join"]),"line-miter-limit":new gn(At.layout_line["line-miter-limit"]),"line-round-limit":new gn(At.layout_line["line-round-limit"]),"line-sort-key":new Kn(At.layout_line["line-sort-key"]),"line-z-offset":new Kn(At.layout_line["line-z-offset"]),visibility:new gn(At.layout_line.visibility)})),paint:lH||(lH=new Wi({"line-opacity":new Kn(At.paint_line["line-opacity"]),"line-color":new Kn(At.paint_line["line-color"]),"line-translate":new gn(At.paint_line["line-translate"]),"line-translate-anchor":new gn(At.paint_line["line-translate-anchor"]),"line-width":new Kn(At.paint_line["line-width"]),"line-gap-width":new Kn(At.paint_line["line-gap-width"]),"line-offset":new Kn(At.paint_line["line-offset"]),"line-blur":new Kn(At.paint_line["line-blur"]),"line-dasharray":new Kn(At.paint_line["line-dasharray"]),"line-pattern":new Kn(At.paint_line["line-pattern"]),"line-gradient":new cc(At.paint_line["line-gradient"]),"line-trim-offset":new gn(At.paint_line["line-trim-offset"]),"line-trim-fade-range":new gn(At.paint_line["line-trim-fade-range"]),"line-trim-color":new gn(At.paint_line["line-trim-color"]),"line-emissive-strength":new gn(At.paint_line["line-emissive-strength"]),"line-border-width":new Kn(At.paint_line["line-border-width"]),"line-border-color":new Kn(At.paint_line["line-border-color"]),"line-occlusion-opacity":new gn(At.paint_line["line-occlusion-opacity"])}))},ok);class efe extends Kn{possiblyEvaluate(c,d){return d=new ds(Math.floor(d.zoom),{now:d.now,fadeDuration:d.fadeDuration,transition:d.transition}),super.possiblyEvaluate(c,d)}evaluate(c,d,_,A){return d=Sr({},d,{zoom:Math.floor(d.zoom)}),super.evaluate(c,d,_,A)}}let eS;function mH(g,c){return c>0?c+2*g:g}const tfe=Qr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nfe=Qr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),rfe=Qr([{name:"a_projected_pos",components:4,type:"Float32"}],4);Qr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const ife=Qr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),sfe=Qr([{name:"a_texb",components:2,type:"Uint16"}]),afe=Qr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),ofe=Qr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Qr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const gH=Qr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),lfe=Qr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Qr([{name:"triangle",components:3,type:"Uint16"}]),Qr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Qr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Qr([{type:"Float32",name:"offsetX"}]),Qr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var zo=24;const xf=128;function lk(g,c){const{expression:d}=c;if(d.kind==="constant")return{kind:"constant",layoutSize:d.evaluate(new ds(g+1))};if(d.kind==="source")return{kind:"source"};{const{zoomStops:_,interpolationType:A}=d;let x=0;for(;x<_.length&&_[x]<=g;)x++;x=Math.max(0,x-1);let T=x;for(;T<_.length&&_[T]<g+1;)T++;T=Math.min(_.length-1,T);const B=_[x],U=_[T];return d.kind==="composite"?{kind:"composite",minZoom:B,maxZoom:U,interpolationType:A}:{kind:"camera",minZoom:B,maxZoom:U,minSize:d.evaluate(new ds(B)),maxSize:d.evaluate(new ds(U)),interpolationType:A}}}function $E(g,{uSize:c,uSizeT:d},{lowerSize:_,upperSize:A}){return g.kind==="source"?_/xf:g.kind==="composite"?cr(_/xf,A/xf,d):c}function Zx(g,c){let d=0,_=0;if(g.kind==="constant")_=g.layoutSize;else if(g.kind!=="source"){const{interpolationType:A,minZoom:x,maxZoom:T}=g,B=A?jt(fl.interpolationFactor(A,c,x,T),0,1):0;g.kind==="camera"?_=cr(g.minSize,g.maxSize,B):d=B}return{uSizeT:d,uSize:_}}var cfe=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:xf,evaluateSizeForFeature:$E,evaluateSizeForZoom:Zx,getSizeData:lk});function ufe(g,c,d){return g.sections.forEach(_=>{_.text=function(A,x,T){const B=x.layout.get("text-transform").evaluate(T,{});return B==="uppercase"?A=A.toLocaleUpperCase():B==="lowercase"&&(A=A.toLocaleLowerCase()),No.applyArabicShaping&&(A=No.applyArabicShaping(A)),A}(_.text,c,d)}),g}const tS={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function hfe(g){return g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""}function ffe(g){return g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""||g===""}var vH,ck,_H,uk={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function dfe(){return vH||(vH=1,uk.read=function(g,c,d,_,A){var x,T,B=8*A-_-1,U=(1<<B)-1,j=U>>1,R=-7,N=d?A-1:0,V=d?-1:1,z=g[c+N];for(N+=V,x=z&(1<<-R)-1,z>>=-R,R+=B;R>0;x=256*x+g[c+N],N+=V,R-=8);for(T=x&(1<<-R)-1,x>>=-R,R+=_;R>0;T=256*T+g[c+N],N+=V,R-=8);if(x===0)x=1-j;else{if(x===U)return T?NaN:1/0*(z?-1:1);T+=Math.pow(2,_),x-=j}return(z?-1:1)*T*Math.pow(2,x-_)},uk.write=function(g,c,d,_,A,x){var T,B,U,j=8*x-A-1,R=(1<<j)-1,N=R>>1,V=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=_?0:x-1,G=_?1:-1,$=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(B=isNaN(c)?1:0,T=R):(T=Math.floor(Math.log(c)/Math.LN2),c*(U=Math.pow(2,-T))<1&&(T--,U*=2),(c+=T+N>=1?V/U:V*Math.pow(2,1-N))*U>=2&&(T++,U/=2),T+N>=R?(B=0,T=R):T+N>=1?(B=(c*U-1)*Math.pow(2,A),T+=N):(B=c*Math.pow(2,N-1)*Math.pow(2,A),T=0));A>=8;g[d+z]=255&B,z+=G,B/=256,A-=8);for(T=T<<A|B,j+=A;j>0;g[d+z]=255&T,z+=G,T/=256,j-=8);g[d+z-G]|=128*$}),uk}function yH(){if(_H)return ck;_H=1,ck=c;var g=dfe();function c(ne){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(ne)?ne:new Uint8Array(ne||0),this.pos=0,this.type=0,this.length=this.buf.length}c.Varint=0,c.Fixed64=1,c.Bytes=2,c.Fixed32=5;var d=4294967296,_=1/d,A=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function x(ne){return ne.type===c.Bytes?ne.readVarint()+ne.pos:ne.pos+1}function T(ne,de,ge){return ge?4294967296*de+(ne>>>0):4294967296*(de>>>0)+(ne>>>0)}function B(ne,de,ge){var Me=de<=16383?1:de<=2097151?2:de<=268435455?3:Math.floor(Math.log(de)/(7*Math.LN2));ge.realloc(Me);for(var Be=ge.pos-1;Be>=ne;Be--)ge.buf[Be+Me]=ge.buf[Be]}function U(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeVarint(ne[ge])}function j(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeSVarint(ne[ge])}function R(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeFloat(ne[ge])}function N(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeDouble(ne[ge])}function V(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeBoolean(ne[ge])}function z(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeFixed32(ne[ge])}function G(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeSFixed32(ne[ge])}function $(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeFixed64(ne[ge])}function K(ne,de){for(var ge=0;ge<ne.length;ge++)de.writeSFixed64(ne[ge])}function te(ne,de){return(ne[de]|ne[de+1]<<8|ne[de+2]<<16)+16777216*ne[de+3]}function ce(ne,de,ge){ne[ge]=de,ne[ge+1]=de>>>8,ne[ge+2]=de>>>16,ne[ge+3]=de>>>24}function he(ne,de){return(ne[de]|ne[de+1]<<8|ne[de+2]<<16)+(ne[de+3]<<24)}return c.prototype={destroy:function(){this.buf=null},readFields:function(ne,de,ge){for(ge=ge||this.length;this.pos<ge;){var Me=this.readVarint(),Be=Me>>3,Oe=this.pos;this.type=7&Me,ne(Be,de,this),this.pos===Oe&&this.skip(Me)}return de},readMessage:function(ne,de){return this.readFields(ne,de,this.readVarint()+this.pos)},readFixed32:function(){var ne=te(this.buf,this.pos);return this.pos+=4,ne},readSFixed32:function(){var ne=he(this.buf,this.pos);return this.pos+=4,ne},readFixed64:function(){var ne=te(this.buf,this.pos)+te(this.buf,this.pos+4)*d;return this.pos+=8,ne},readSFixed64:function(){var ne=te(this.buf,this.pos)+he(this.buf,this.pos+4)*d;return this.pos+=8,ne},readFloat:function(){var ne=g.read(this.buf,this.pos,!0,23,4);return this.pos+=4,ne},readDouble:function(){var ne=g.read(this.buf,this.pos,!0,52,8);return this.pos+=8,ne},readVarint:function(ne){var de,ge,Me=this.buf;return de=127&(ge=Me[this.pos++]),ge<128?de:(de|=(127&(ge=Me[this.pos++]))<<7,ge<128?de:(de|=(127&(ge=Me[this.pos++]))<<14,ge<128?de:(de|=(127&(ge=Me[this.pos++]))<<21,ge<128?de:function(Be,Oe,Pe){var Ye,ze,Qe=Pe.buf;if(Ye=(112&(ze=Qe[Pe.pos++]))>>4,ze<128||(Ye|=(127&(ze=Qe[Pe.pos++]))<<3,ze<128)||(Ye|=(127&(ze=Qe[Pe.pos++]))<<10,ze<128)||(Ye|=(127&(ze=Qe[Pe.pos++]))<<17,ze<128)||(Ye|=(127&(ze=Qe[Pe.pos++]))<<24,ze<128)||(Ye|=(1&(ze=Qe[Pe.pos++]))<<31,ze<128))return T(Be,Ye,Oe);throw new Error("Expected varint not more than 10 bytes")}(de|=(15&(ge=Me[this.pos]))<<28,ne,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var ne=this.readVarint();return ne%2==1?(ne+1)/-2:ne/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var ne=this.readVarint()+this.pos,de=this.pos;return this.pos=ne,ne-de>=12&&A?function(ge,Me,Be){return A.decode(ge.subarray(Me,Be))}(this.buf,de,ne):function(ge,Me,Be){for(var Oe="",Pe=Me;Pe<Be;){var Ye,ze,Qe,ct=ge[Pe],ht=null,ft=ct>239?4:ct>223?3:ct>191?2:1;if(Pe+ft>Be)break;ft===1?ct<128&&(ht=ct):ft===2?(192&(Ye=ge[Pe+1]))==128&&(ht=(31&ct)<<6|63&Ye)<=127&&(ht=null):ft===3?(ze=ge[Pe+2],(192&(Ye=ge[Pe+1]))==128&&(192&ze)==128&&((ht=(15&ct)<<12|(63&Ye)<<6|63&ze)<=2047||ht>=55296&&ht<=57343)&&(ht=null)):ft===4&&(ze=ge[Pe+2],Qe=ge[Pe+3],(192&(Ye=ge[Pe+1]))==128&&(192&ze)==128&&(192&Qe)==128&&((ht=(15&ct)<<18|(63&Ye)<<12|(63&ze)<<6|63&Qe)<=65535||ht>=1114112)&&(ht=null)),ht===null?(ht=65533,ft=1):ht>65535&&(ht-=65536,Oe+=String.fromCharCode(ht>>>10&1023|55296),ht=56320|1023&ht),Oe+=String.fromCharCode(ht),Pe+=ft}return Oe}(this.buf,de,ne)},readBytes:function(){var ne=this.readVarint()+this.pos,de=this.buf.subarray(this.pos,ne);return this.pos=ne,de},readPackedVarint:function(ne,de){if(this.type!==c.Bytes)return ne.push(this.readVarint(de));var ge=x(this);for(ne=ne||[];this.pos<ge;)ne.push(this.readVarint(de));return ne},readPackedSVarint:function(ne){if(this.type!==c.Bytes)return ne.push(this.readSVarint());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readSVarint());return ne},readPackedBoolean:function(ne){if(this.type!==c.Bytes)return ne.push(this.readBoolean());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readBoolean());return ne},readPackedFloat:function(ne){if(this.type!==c.Bytes)return ne.push(this.readFloat());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readFloat());return ne},readPackedDouble:function(ne){if(this.type!==c.Bytes)return ne.push(this.readDouble());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readDouble());return ne},readPackedFixed32:function(ne){if(this.type!==c.Bytes)return ne.push(this.readFixed32());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readFixed32());return ne},readPackedSFixed32:function(ne){if(this.type!==c.Bytes)return ne.push(this.readSFixed32());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readSFixed32());return ne},readPackedFixed64:function(ne){if(this.type!==c.Bytes)return ne.push(this.readFixed64());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readFixed64());return ne},readPackedSFixed64:function(ne){if(this.type!==c.Bytes)return ne.push(this.readSFixed64());var de=x(this);for(ne=ne||[];this.pos<de;)ne.push(this.readSFixed64());return ne},skip:function(ne){var de=7&ne;if(de===c.Varint)for(;this.buf[this.pos++]>127;);else if(de===c.Bytes)this.pos=this.readVarint()+this.pos;else if(de===c.Fixed32)this.pos+=4;else{if(de!==c.Fixed64)throw new Error("Unimplemented type: "+de);this.pos+=8}},writeTag:function(ne,de){this.writeVarint(ne<<3|de)},realloc:function(ne){for(var de=this.length||16;de<this.pos+ne;)de*=2;if(de!==this.length){var ge=new Uint8Array(de);ge.set(this.buf),this.buf=ge,this.length=de}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(ne){this.realloc(4),ce(this.buf,ne,this.pos),this.pos+=4},writeSFixed32:function(ne){this.realloc(4),ce(this.buf,ne,this.pos),this.pos+=4},writeFixed64:function(ne){this.realloc(8),ce(this.buf,-1&ne,this.pos),ce(this.buf,Math.floor(ne*_),this.pos+4),this.pos+=8},writeSFixed64:function(ne){this.realloc(8),ce(this.buf,-1&ne,this.pos),ce(this.buf,Math.floor(ne*_),this.pos+4),this.pos+=8},writeVarint:function(ne){(ne=+ne||0)>268435455||ne<0?function(de,ge){var Me,Be;if(de>=0?(Me=de%4294967296|0,Be=de/4294967296|0):(Be=~(-de/4294967296),4294967295^(Me=~(-de%4294967296))?Me=Me+1|0:(Me=0,Be=Be+1|0)),de>=18446744073709552e3||de<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");ge.realloc(10),function(Oe,Pe,Ye){Ye.buf[Ye.pos++]=127&Oe|128,Oe>>>=7,Ye.buf[Ye.pos++]=127&Oe|128,Oe>>>=7,Ye.buf[Ye.pos++]=127&Oe|128,Oe>>>=7,Ye.buf[Ye.pos++]=127&Oe|128,Ye.buf[Ye.pos]=127&(Oe>>>=7)}(Me,0,ge),function(Oe,Pe){var Ye=(7&Oe)<<4;Pe.buf[Pe.pos++]|=Ye|((Oe>>>=3)?128:0),Oe&&(Pe.buf[Pe.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Pe.buf[Pe.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Pe.buf[Pe.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Pe.buf[Pe.pos++]=127&Oe|((Oe>>>=7)?128:0),Oe&&(Pe.buf[Pe.pos++]=127&Oe)))))}(Be,ge)}(ne,this):(this.realloc(4),this.buf[this.pos++]=127&ne|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=127&(ne>>>=7)|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=127&(ne>>>=7)|(ne>127?128:0),ne<=127||(this.buf[this.pos++]=ne>>>7&127))))},writeSVarint:function(ne){this.writeVarint(ne<0?2*-ne-1:2*ne)},writeBoolean:function(ne){this.writeVarint(!!ne)},writeString:function(ne){ne=String(ne),this.realloc(4*ne.length),this.pos++;var de=this.pos;this.pos=function(Me,Be,Oe){for(var Pe,Ye,ze=0;ze<Be.length;ze++){if((Pe=Be.charCodeAt(ze))>55295&&Pe<57344){if(!Ye){Pe>56319||ze+1===Be.length?(Me[Oe++]=239,Me[Oe++]=191,Me[Oe++]=189):Ye=Pe;continue}if(Pe<56320){Me[Oe++]=239,Me[Oe++]=191,Me[Oe++]=189,Ye=Pe;continue}Pe=Ye-55296<<10|Pe-56320|65536,Ye=null}else Ye&&(Me[Oe++]=239,Me[Oe++]=191,Me[Oe++]=189,Ye=null);Pe<128?Me[Oe++]=Pe:(Pe<2048?Me[Oe++]=Pe>>6|192:(Pe<65536?Me[Oe++]=Pe>>12|224:(Me[Oe++]=Pe>>18|240,Me[Oe++]=Pe>>12&63|128),Me[Oe++]=Pe>>6&63|128),Me[Oe++]=63&Pe|128)}return Oe}(this.buf,ne,this.pos);var ge=this.pos-de;ge>=128&&B(de,ge,this),this.pos=de-1,this.writeVarint(ge),this.pos+=ge},writeFloat:function(ne){this.realloc(4),g.write(this.buf,ne,this.pos,!0,23,4),this.pos+=4},writeDouble:function(ne){this.realloc(8),g.write(this.buf,ne,this.pos,!0,52,8),this.pos+=8},writeBytes:function(ne){var de=ne.length;this.writeVarint(de),this.realloc(de);for(var ge=0;ge<de;ge++)this.buf[this.pos++]=ne[ge]},writeRawMessage:function(ne,de){this.pos++;var ge=this.pos;ne(de,this);var Me=this.pos-ge;Me>=128&&B(ge,Me,this),this.pos=ge-1,this.writeVarint(Me),this.pos+=Me},writeMessage:function(ne,de,ge){this.writeTag(ne,c.Bytes),this.writeRawMessage(de,ge)},writePackedVarint:function(ne,de){de.length&&this.writeMessage(ne,U,de)},writePackedSVarint:function(ne,de){de.length&&this.writeMessage(ne,j,de)},writePackedBoolean:function(ne,de){de.length&&this.writeMessage(ne,V,de)},writePackedFloat:function(ne,de){de.length&&this.writeMessage(ne,R,de)},writePackedDouble:function(ne,de){de.length&&this.writeMessage(ne,N,de)},writePackedFixed32:function(ne,de){de.length&&this.writeMessage(ne,z,de)},writePackedSFixed32:function(ne,de){de.length&&this.writeMessage(ne,G,de)},writePackedFixed64:function(ne,de){de.length&&this.writeMessage(ne,$,de)},writePackedSFixed64:function(ne,de){de.length&&this.writeMessage(ne,K,de)},writeBytesField:function(ne,de){this.writeTag(ne,c.Bytes),this.writeBytes(de)},writeFixed32Field:function(ne,de){this.writeTag(ne,c.Fixed32),this.writeFixed32(de)},writeSFixed32Field:function(ne,de){this.writeTag(ne,c.Fixed32),this.writeSFixed32(de)},writeFixed64Field:function(ne,de){this.writeTag(ne,c.Fixed64),this.writeFixed64(de)},writeSFixed64Field:function(ne,de){this.writeTag(ne,c.Fixed64),this.writeSFixed64(de)},writeVarintField:function(ne,de){this.writeTag(ne,c.Varint),this.writeVarint(de)},writeSVarintField:function(ne,de){this.writeTag(ne,c.Varint),this.writeSVarint(de)},writeStringField:function(ne,de){this.writeTag(ne,c.Bytes),this.writeString(de)},writeFloatField:function(ne,de){this.writeTag(ne,c.Fixed32),this.writeFloat(de)},writeDoubleField:function(ne,de){this.writeTag(ne,c.Fixed64),this.writeDouble(de)},writeBooleanField:function(ne,de){this.writeVarintField(ne,!!de)}},ck}var XE=h(yH());const hk=3;function pfe(g,c,d){c.glyphs=[],g===1&&d.readMessage(mfe,c)}function mfe(g,c,d){if(g===3){const{id:_,bitmap:A,width:x,height:T,left:B,top:U,advance:j}=d.readMessage(gfe,{});c.glyphs.push({id:_,bitmap:new ev({width:x+2*hk,height:T+2*hk},A),metrics:{width:x,height:T,left:B,top:U,advance:j}})}else g===4?c.ascender=d.readSVarint():g===5&&(c.descender=d.readSVarint())}function gfe(g,c,d){g===1?c.id=d.readVarint():g===2?c.bitmap=d.readBytes():g===3?c.width=d.readVarint():g===4?c.height=d.readVarint():g===5?c.left=d.readSVarint():g===6?c.top=d.readSVarint():g===7&&(c.advance=d.readVarint())}const xH=hk,Eu={horizontal:1,vertical:2,horizontalOnly:3};class nS{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(c,d){const _=new nS;return _.scale=c||1,_.fontStack=d,_}static forImage(c){const d=new nS;return d.imageName=c,d}}class Yx{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(c,d){const _=new Yx;for(let A=0;A<c.sections.length;A++){const x=c.sections[A];x.image?_.addImageSection(x):_.addTextSection(x,d)}return _}length(){return this.text.length}getSection(c){return this.sections[this.sectionIndex[c]]}getSections(){return this.sections}getSectionIndex(c){return this.sectionIndex[c]}getCodePoint(c){return this.text.codePointAt(c)}verticalizePunctuation(c){this.text=function(d,_){let A="";for(let x=0;x<d.length;x++){const T=d.charCodeAt(x+1)||null,B=d.charCodeAt(x-1)||null;A+=!_&&(T&&Ed(T)&&!tS[d[x+1]]||B&&Ed(B)&&!tS[d[x-1]])||!tS[d[x]]?d[x]:tS[d[x]]}return A}(this.text,c)}trim(){let c=0;for(let _=0;_<this.text.length&&qE[this.text.charCodeAt(_)];_++)c++;let d=this.text.length;for(let _=this.text.length-1;_>=0&&_>=c&&qE[this.text.charCodeAt(_)];_--)d--;this.text=this.text.substring(c,d),this.sectionIndex=this.sectionIndex.slice(c,d)}substring(c,d){const _=new Yx;return _.text=this.text.substring(c,d),_.sectionIndex=this.sectionIndex.slice(c,d),_.sections=this.sections,_}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((c,d)=>Math.max(c,this.sections[d].scale),0)}addTextSection(c,d){this.text+=c.text,this.sections.push(nS.forText(c.scale,c.fontStack||d));const _=this.sections.length-1;for(let A=0;A<c.text.length;++A)this.sectionIndex.push(_)}addImageSection(c){const d=c.image?c.image.namePrimary:"";if(d.length===0)return void Lt("Can't add FormattedSection with an empty image.");const _=this.getNextImageSectionCharCode();_?(this.text+=String.fromCodePoint(_),this.sections.push(nS.forImage(d)),this.sectionIndex.push(this.sections.length-1)):Lt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function fk(g,c,d,_,A,x,T,B,U,j,R,N,V,z,G){const $=Yx.fromFeature(g,A);N===Eu.vertical&&$.verticalizePunctuation(V);let K=[];const te=function(ge,Me,Be,Oe,Pe,Ye){if(!ge)return[];const ze=[],Qe=function(mt,Ct,_t,Ut,Yt,Dt){let Rn=0;for(let bn=0;bn<mt.length();bn++){const dn=mt.getSection(bn);Rn+=bH(mt.getCodePoint(bn),dn,Ut,Yt,Ct,Dt)}return Rn/Math.max(1,Math.ceil(Rn/_t))}(ge,Me,Be,Oe,Pe,Ye),ct=ge.text.indexOf("")>=0;let ht=0;for(let mt=0;mt<ge.length();mt++){const Ct=ge.getSection(mt),_t=ge.getCodePoint(mt);if(qE[_t]||(ht+=bH(_t,Ct,Oe,Pe,Me,Ye)),mt<ge.length()-1){const Ut=!((ft=_t)<11904||!(Yn["Bopomofo Extended"](ft)||Yn.Bopomofo(ft)||Yn["CJK Compatibility Forms"](ft)||Yn["CJK Compatibility Ideographs"](ft)||Yn["CJK Compatibility"](ft)||Yn["CJK Radicals Supplement"](ft)||Yn["CJK Strokes"](ft)||Yn["CJK Symbols and Punctuation"](ft)||Yn["CJK Unified Ideographs Extension A"](ft)||Yn["CJK Unified Ideographs"](ft)||Yn["Enclosed CJK Letters and Months"](ft)||Yn["Halfwidth and Fullwidth Forms"](ft)||Yn.Hiragana(ft)||Yn["Ideographic Description Characters"](ft)||Yn["Kangxi Radicals"](ft)||Yn["Katakana Phonetic Extensions"](ft)||Yn.Katakana(ft)||Yn["Vertical Forms"](ft)||Yn["Yi Radicals"](ft)||Yn["Yi Syllables"](ft)));(vfe[_t]||Ut||Ct.imageName)&&ze.push(SH(mt+1,ht,Qe,ze,_fe(_t,ge.getCodePoint(mt+1),Ut&&ct),!1))}}var ft;return AH(SH(ge.length(),ht,Qe,ze,0,!0))}($,j,x,c,_,z),{processBidirectionalText:ce,processStyledBidirectionalText:he}=No;if(ce&&$.sections.length===1){const ge=ce($.toString(),te);for(const Me of ge){const Be=new Yx;Be.text=Me,Be.sections=$.sections;for(let Oe=0;Oe<Me.length;Oe++)Be.sectionIndex.push(0);K.push(Be)}}else if(he){const ge=he($.text,$.sectionIndex,te);for(const Me of ge){const Be=new Yx;Be.text=Me[0],Be.sectionIndex=Me[1],Be.sections=$.sections,K.push(Be)}}else K=function(ge,Me){const Be=[],Oe=ge.text;let Pe=0;for(const Ye of Me)Be.push(ge.substring(Pe,Ye)),Pe=Ye;return Pe<Oe.length&&Be.push(ge.substring(Pe,Oe.length)),Be}($,te);const ne=[],de={positionedLines:ne,text:$.toString(),top:R[1],bottom:R[1],left:R[0],right:R[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ge,Me,Be,Oe,Pe,Ye,ze,Qe,ct,ht,ft,mt){let Ct=0,_t=0,Ut=0;const Yt=Qe==="right"?1:Qe==="left"?0:.5;let Dt=!1;for(const In of Pe){const Nn=In.getSections();for(const wr of Nn){if(wr.imageName)continue;const Or=Me[wr.fontStack];if(Or&&(Dt=Or.ascender!==void 0&&Or.descender!==void 0,!Dt))break}if(!Dt)break}let Rn=0;for(const In of Pe){In.trim();const Nn=In.getMaxScale(),wr=(Nn-1)*zo,Or={positionedGlyphs:[],lineOffset:0};ge.positionedLines[Rn]=Or;const Pr=Or.positionedGlyphs;let Lr=0;if(!In.length()){_t+=Ye,++Rn;continue}let jr=0,Wr=0;for(let Mi=0;Mi<In.length();Mi++){const Tr=In.getSection(Mi),_i=In.getSectionIndex(Mi),wi=In.getCodePoint(Mi);let ss=Tr.scale,Ws=null,pa=null,$s=null,Os=zo,uo=0;const Sa=!(ct===Eu.horizontal||!ft&&!em(wi)||ft&&(qE[wi]||(bn=wi,Yn.Arabic(bn)||Yn["Arabic Supplement"](bn)||Yn["Arabic Extended-A"](bn)||Yn["Arabic Presentation Forms-A"](bn)||Yn["Arabic Presentation Forms-B"](bn))));if(Tr.imageName){const Uo=Oe[Tr.imageName];if(!Uo)continue;$s=Tr.imageName,ge.iconsInText=ge.iconsInText||!0,pa=Uo.paddedRect;const Qi=Uo.displaySize;ss=ss*zo/mt,Ws={width:Qi[0],height:Qi[1],left:0,top:-xH,advance:Sa?Qi[1]:Qi[0],localGlyph:!1},uo=Dt?-Ws.height*ss:Nn*zo-17-Qi[1]*ss,Os=Ws.advance;const gc=(Sa?Qi[0]:Qi[1])*ss-zo*Nn;gc>0&&gc>Lr&&(Lr=gc)}else{const Uo=Be[Tr.fontStack];if(!Uo)continue;Uo[wi]&&(pa=Uo[wi]);const Qi=Me[Tr.fontStack];if(!Qi)continue;const gc=Qi.glyphs[wi];if(!gc)continue;if(Ws=gc.metrics,Os=wi!==8203?zo:0,Dt){const Tf=Qi.ascender!==void 0?Math.abs(Qi.ascender):0,lh=Qi.descender!==void 0?Math.abs(Qi.descender):0,ch=(Tf+lh)*ss;jr<ch&&(jr=ch,Wr=(Tf-lh)/2*ss),uo=-Tf*ss}else uo=(Nn-ss)*zo-17}Sa?(ge.verticalizable=!0,Pr.push({glyph:wi,imageName:$s,x:Ct,y:_t+uo,vertical:Sa,scale:ss,localGlyph:Ws.localGlyph,fontStack:Tr.fontStack,sectionIndex:_i,metrics:Ws,rect:pa}),Ct+=Os*ss+ht):(Pr.push({glyph:wi,imageName:$s,x:Ct,y:_t+uo,vertical:Sa,scale:ss,localGlyph:Ws.localGlyph,fontStack:Tr.fontStack,sectionIndex:_i,metrics:Ws,rect:pa}),Ct+=Ws.advance*ss+ht)}Pr.length!==0&&(Ut=Math.max(Ct-ht,Ut),Dt?TH(Pr,Yt,Lr,Wr,Ye*Nn/2):TH(Pr,Yt,Lr,0,Ye/2)),Ct=0;const Gi=Ye*Nn+Lr;Or.lineOffset=Math.max(Lr,wr),_t+=Gi,++Rn}var bn;const dn=_t,{horizontalAlign:tn,verticalAlign:nr}=dk(ze);(function(In,Nn,wr,Or,Pr,Lr){const jr=(Nn-wr)*Pr,Wr=-Lr*Or;for(const Gi of In)for(const Mi of Gi.positionedGlyphs)Mi.x+=jr,Mi.y+=Wr})(ge.positionedLines,Yt,tn,nr,Ut,dn),ge.top+=-nr*dn,ge.bottom=ge.top+dn,ge.left+=-tn*Ut,ge.right=ge.left+Ut,ge.hasBaseline=Dt}(de,c,d,_,K,T,B,U,N,j,V,G),!function(ge){for(const Me of ge)if(Me.positionedGlyphs.length!==0)return!1;return!0}(ne)&&de}const qE={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},vfe={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function bH(g,c,d,_,A,x){if(c.imageName){const T=_[c.imageName];return T?T.displaySize[0]*c.scale*zo/x+A:0}{const T=d[c.fontStack],B=T&&T.glyphs[g];return B?B.metrics.advance*c.scale+A:0}}function wH(g,c,d,_){const A=Math.pow(g-c,2);return _?g<c?A/2:2*A:A+Math.abs(d)*d}function _fe(g,c,d){let _=0;return g===10&&(_-=1e4),d&&(_+=150),g!==40&&g!==65288||(_+=50),c!==41&&c!==65289||(_+=50),_}function SH(g,c,d,_,A,x){let T=null,B=wH(c,d,A,x);for(const U of _){const j=wH(c-U.x,d,A,x)+U.badness;j<=B&&(T=U,B=j)}return{index:g,x:c,priorBreak:T,badness:B}}function AH(g){return g?AH(g.priorBreak).concat(g.index):[]}function dk(g){let c=.5,d=.5;switch(g){case"right":case"top-right":case"bottom-right":c=1;break;case"left":case"top-left":case"bottom-left":c=0}switch(g){case"bottom":case"bottom-right":case"bottom-left":d=1;break;case"top":case"top-right":case"top-left":d=0}return{horizontalAlign:c,verticalAlign:d}}function TH(g,c,d,_,A){if(!(c||d||_||A))return;const x=g.length-1,T=g[x],B=(T.x+T.metrics.advance*T.scale)*c;for(let U=0;U<=x;U++)g[U].x-=B,g[U].y+=d+_+A}function yfe(g,c,d,_){const{horizontalAlign:A,verticalAlign:x}=dk(_),T=d[0]-g.displaySize[0]*A,B=d[1]-g.displaySize[1]*x;return{imagePrimary:g,imageSecondary:c,top:B,bottom:B+g.displaySize[1],left:T,right:T+g.displaySize[0]}}function MH(g,c,d,_,A,x){const T=g.imagePrimary;let B;if(T.content){const K=T.content,te=T.pixelRatio||1;B=[K[0]/te,K[1]/te,T.displaySize[0]-K[2]/te,T.displaySize[1]-K[3]/te]}const U=c.left*x,j=c.right*x;let R,N,V,z;d==="width"||d==="both"?(z=A[0]+U-_[3],N=A[0]+j+_[1]):(z=A[0]+(U+j-T.displaySize[0])/2,N=z+T.displaySize[0]);const G=c.top*x,$=c.bottom*x;return d==="height"||d==="both"?(R=A[1]+G-_[0],V=A[1]+$+_[2]):(R=A[1]+(G+$-T.displaySize[1])/2,V=R+T.displaySize[1]),{imagePrimary:T,imageSecondary:void 0,top:R,right:N,bottom:V,left:z,collisionPadding:B}}class um extends St{constructor(c,d,_,A,x){super(c,d),this.angle=A,this.z=_,x!==void 0&&(this.segment=x)}clone(){return new um(this.x,this.y,this.z,this.angle,this.segment)}}function EH(g,c,d,_,A){if(c.segment===void 0)return!0;let x=c,T=c.segment+1,B=0;for(;B>-d/2;){if(T--,T<0)return!1;B-=g[T].dist(x),x=g[T]}B+=g[T].dist(g[T+1]),T++;const U=[];let j=0;for(;B<d/2;){const R=g[T],N=g[T+1];if(!N)return!1;let V=g[T-1].angleTo(R)-R.angleTo(N);for(V=Math.abs((V+3*Math.PI)%(2*Math.PI)-Math.PI),U.push({distance:B,angleDelta:V}),j+=V;B-U[0].distance>_;)j-=U.shift().angleDelta;if(j>A)return!1;T++,B+=R.dist(N)}return!0}function CH(g){let c=0;for(let d=0;d<g.length-1;d++)c+=g[d].dist(g[d+1]);return c}function IH(g,c,d){return g?.6*c*d:0}function RH(g,c){return Math.max(g?g.right-g.left:0,c?c.right-c.left:0)}function xfe(g,c,d,_,A,x){const T=IH(d,A,x),B=RH(d,_)*x;let U=0;const j=CH(g)/2;for(let R=0;R<g.length-1;R++){const N=g[R],V=g[R+1],z=N.dist(V);if(U+z>j){const G=(j-U)/z,$=cr(N.x,V.x,G),K=cr(N.y,V.y,G),te=new um($,K,0,V.angleTo(N),R);return!T||EH(g,te,B,T,c)?te:void 0}U+=z}}function bfe(g,c,d,_,A,x,T,B,U){const j=IH(_,x,T),R=RH(_,A),N=R*T,V=g[0].x===0||g[0].x===U||g[0].y===0||g[0].y===U;return c-N<c/4&&(c=N+c/4),PH(g,V?c/2*B%c:(R/2+2*x)*T*B%c,c,j,d,N,V,!1,U)}function PH(g,c,d,_,A,x,T,B,U){const j=x/2,R=CH(g);let N=0,V=c-d,z=[];for(let G=0;G<g.length-1;G++){const $=g[G],K=g[G+1],te=$.dist(K),ce=K.angleTo($);for(;V+d<N+te;){V+=d;const he=(V-N)/te,ne=cr($.x,K.x,he),de=cr($.y,K.y,he);if(ne>=0&&ne<U&&de>=0&&de<U&&V-j>=0&&V+j<=R){const ge=new um(ne,de,0,ce,G);_&&!EH(g,ge,x,_,A)||z.push(ge)}}N+=te}return B||z.length||T||(z=PH(g,N/2,d,_,A,x,T,!0,U)),z}function LH(g,c,d,_,A){const x=[];for(let T=0;T<g.length;T++){const B=g[T];let U;for(let j=0;j<B.length-1;j++){let R=B[j],N=B[j+1];R.x<c&&N.x<c||(R.x<c?R=new St(c,R.y+(c-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x<c&&(N=new St(c,R.y+(c-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y<d&&N.y<d||(R.y<d?R=new St(R.x+(d-R.y)/(N.y-R.y)*(N.x-R.x),d)._round():N.y<d&&(N=new St(R.x+(d-R.y)/(N.y-R.y)*(N.x-R.x),d)._round()),R.x>=_&&N.x>=_||(R.x>=_?R=new St(_,R.y+(_-R.x)/(N.x-R.x)*(N.y-R.y))._round():N.x>=_&&(N=new St(_,R.y+(_-R.x)/(N.x-R.x)*(N.y-R.y))._round()),R.y>=A&&N.y>=A||(R.y>=A?R=new St(R.x+(A-R.y)/(N.y-R.y)*(N.x-R.x),A)._round():N.y>=A&&(N=new St(R.x+(A-R.y)/(N.y-R.y)*(N.x-R.x),A)._round()),U&&R.equals(U[U.length-1])||(U=[R],x.push(U)),U.push(N)))))}}return x}function DH(g){let c=0,d=0;for(const T of g)c+=T.w*T.h,d=Math.max(d,T.w);g.sort((T,B)=>B.h-T.h);const _=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(c/.95)),d),h:1/0}];let A=0,x=0;for(const T of g)for(let B=_.length-1;B>=0;B--){const U=_[B];if(!(T.w>U.w||T.h>U.h)){if(T.x=U.x,T.y=U.y,x=Math.max(x,T.y+T.h),A=Math.max(A,T.x+T.w),T.w===U.w&&T.h===U.h){const j=_.pop();B<_.length&&(_[B]=j)}else T.h===U.h?(U.x+=T.w,U.w-=T.w):T.w===U.w?(U.y+=T.h,U.h-=T.h):(_.push({x:U.x+T.w,y:U.y,w:U.w-T.w,h:T.h}),U.y+=T.h,U.h-=T.h);break}}return{w:A,h:x,fill:c/(A*x)||0}}Fn(um,"Anchor");const rS=1;class pk{constructor(c,{pixelRatio:d,version:_,stretchX:A,stretchY:x,content:T},B){this.paddedRect=c,this.pixelRatio=d,this.stretchX=A,this.stretchY=x,this.content=T,this.version=_,this.padding=B}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class BH{constructor(c,d,_){const A={},x={};this.haveRenderCallbacks=[];const T=[];this.addImages(c,A,rS,T),this.addImages(d,x,2,T);const{w:B,h:U}=DH(T),j=new vl({width:B||1,height:U||1});for(const R in c){const N=c[R],V=A[R].paddedRect;vl.copy(N.data,j,{x:0,y:0},{x:V.x+rS,y:V.y+rS},N.data,_,N.sdf)}for(const R in d){const N=d[R],V=x[R].paddedRect;let z=x[R].padding;const G=V.x+z,$=V.y+z,K=N.data.width,te=N.data.height;z=z>1?z-1:z,vl.copy(N.data,j,{x:0,y:0},{x:G,y:$},N.data,_),vl.copy(N.data,j,{x:0,y:te-z},{x:G,y:$-z},{width:K,height:z},_),vl.copy(N.data,j,{x:0,y:0},{x:G,y:$+te},{width:K,height:z},_),vl.copy(N.data,j,{x:K-z,y:0},{x:G-z,y:$},{width:z,height:te},_),vl.copy(N.data,j,{x:0,y:0},{x:G+K,y:$},{width:z,height:te},_),vl.copy(N.data,j,{x:K-z,y:te-z},{x:G-z,y:$-z},{width:z,height:z},_),vl.copy(N.data,j,{x:0,y:te-z},{x:G+K,y:$-z},{width:z,height:z},_),vl.copy(N.data,j,{x:0,y:0},{x:G+K,y:$+te},{width:z,height:z},_),vl.copy(N.data,j,{x:K-z,y:0},{x:G-z,y:$+te},{width:z,height:z},_)}this.image=j,this.iconPositions=A,this.patternPositions=x}addImages(c,d,_,A){for(const x in c){const T=c[x],B={x:0,y:0,w:T.data.width+2*_,h:T.data.height+2*_};A.push(B),d[x]=new pk(B,T,_),T.hasRenderCallback&&this.haveRenderCallbacks.push(x)}}patchUpdatedImages(c,d,_){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(A=>c.hasImage(A,_)),c.dispatchRenderCallbacks(this.haveRenderCallbacks,_);for(const A in c.getUpdatedImages(_))this.patchUpdatedImage(this.iconPositions[A],c.getImage(A,_),d),this.patchUpdatedImage(this.patternPositions[A],c.getImage(A,_),d)}patchUpdatedImage(c,d,_){if(!c||!d||c.version===d.version)return;c.version=d.version;const[A,x]=c.tl;_.update(d.data,{position:{x:A,y:x}})}}Fn(pk,"ImagePosition"),Fn(BH,"ImageAtlas");const iS=1e20;function kH(g,c,d,_,A,x,T,B,U){for(let j=c;j<c+_;j++)OH(g,d*x+j,x,A,T,B,U);for(let j=d;j<d+A;j++)OH(g,j*x+c,1,_,T,B,U)}function OH(g,c,d,_,A,x,T){x[0]=0,T[0]=-iS,T[1]=iS,A[0]=g[c];for(let B=1,U=0,j=0;B<_;B++){A[B]=g[c+B*d];const R=B*B;do{const N=x[U];j=(A[B]-A[N]+R-N*N)/(B-N)/2}while(j<=T[U]&&--U>-1);U++,x[U]=B,T[U]=j,T[U+1]=iS}for(let B=0,U=0;B<_;B++){for(;T[U+1]<B;)U++;const j=x[U],R=B-j;g[c+B*d]=A[j]+R*R}}const bf=2,mk={none:0,ideographs:1,all:2};class Kx{constructor(c,d,_){this.requestManager=c,this.localGlyphMode=d,this.localFontFamily=_,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(c,d){this.urls[d]=c}getGlyphs(c,d,_){const A=[],x=this.urls[d]||nt.GLYPHS_URL;for(const T in c)for(const B of c[T])A.push({stack:T,id:B});tr(A,({stack:T,id:B},U)=>{let j=this.entries[T];j||(j=this.entries[T]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let R=j.glyphs[B];if(R!==void 0)return void U(null,{stack:T,id:B,glyph:R});if(R=this._tinySDF(j,T,B),R)return j.glyphs[B]=R,void U(null,{stack:T,id:B,glyph:R});const N=Math.floor(B/256);if(256*N>65535)return void U(new Error("glyphs > 65535 not supported"));if(j.ranges[N])return void U(null,{stack:T,id:B,glyph:R});let V=j.requests[N];V||(V=j.requests[N]=[],Kx.loadGlyphRange(T,N,x,this.requestManager,(z,G)=>{if(G){j.ascender=G.ascender,j.descender=G.descender;for(const $ in G.glyphs)this._doesCharSupportLocalGlyph(+$)||(j.glyphs[+$]=G.glyphs[+$]);j.ranges[N]=!0}for(const $ of V)$(z,G);delete j.requests[N]})),V.push((z,G)=>{z?U(z):G&&U(null,{stack:T,id:B,glyph:G.glyphs[B]||null})})},(T,B)=>{if(T)_(T);else if(B){const U={};for(const{stack:j,id:R,glyph:N}of B)U[j]===void 0&&(U[j]={}),U[j].glyphs===void 0&&(U[j].glyphs={}),U[j].glyphs[R]=N&&{id:N.id,bitmap:N.bitmap.clone(),metrics:N.metrics},U[j].ascender=this.entries[j].ascender,U[j].descender=this.entries[j].descender;_(null,U)}})}_doesCharSupportLocalGlyph(c){return this.localGlyphMode!==mk.none&&(this.localGlyphMode===mk.all?!!this.localFontFamily:!!this.localFontFamily&&(Yn["CJK Unified Ideographs"](c)||Yn["Hangul Syllables"](c)||Yn.Hiragana(c)||Yn.Katakana(c)||Yn["CJK Symbols and Punctuation"](c)||Yn["CJK Unified Ideographs Extension A"](c)||Yn["CJK Unified Ideographs Extension B"](c)))}_tinySDF(c,d,_){const A=this.localFontFamily;if(!A||!this._doesCharSupportLocalGlyph(_))return;let x=c.tinySDF;if(!x){let $="400";/bold/i.test(d)?$="900":/medium/i.test(d)?$="500":/light/i.test(d)&&($="200"),x=c.tinySDF=new Kx.TinySDF({fontFamily:A,fontWeight:$,fontSize:24*bf,buffer:3*bf,radius:8*bf}),x.fontWeight=$}if(this.localGlyphs[x.fontWeight][_])return this.localGlyphs[x.fontWeight][_];const T=String.fromCodePoint(_),{data:B,width:U,height:j,glyphWidth:R,glyphHeight:N,glyphLeft:V,glyphTop:z,glyphAdvance:G}=x.draw(T);return this.localGlyphs[x.fontWeight][_]={id:_,bitmap:new ev({width:U,height:j},B),metrics:{width:R/bf,height:N/bf,left:V/bf,top:z/bf-27,advance:G/bf,localGlyph:!0}}}}Kx.loadGlyphRange=function(g,c,d,_,A){const x=256*c,T=x+255,B=_.transformRequest(_.normalizeGlyphsURL(d).replace("{fontstack}",g).replace("{range}",`${x}-${T}`),Yi.Glyphs);Ds(B,(U,j)=>{if(U)A(U);else if(j){const R={},N=function(V){return new XE(V).readFields(pfe,{})}(j);for(const V of N.glyphs)R[V.id]=V;A(null,{glyphs:R,ascender:N.ascender,descender:N.descender})}})},Kx.TinySDF=class{constructor({fontSize:g=24,buffer:c=3,radius:d=8,cutoff:_=.25,fontFamily:A="sans-serif",fontWeight:x="normal",fontStyle:T="normal"}={}){this.buffer=c,this.cutoff=_,this.radius=d;const B=this.size=g+4*c,U=this._createCanvas(B),j=this.ctx=U.getContext("2d",{willReadFrequently:!0});j.font=`${T} ${x} ${g}px ${A}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(B*B),this.gridInner=new Float64Array(B*B),this.f=new Float64Array(B),this.z=new Float64Array(B+1),this.v=new Uint16Array(B)}_createCanvas(g){const c=document.createElement("canvas");return c.width=c.height=g,c}draw(g){const{width:c,actualBoundingBoxAscent:d,actualBoundingBoxDescent:_,actualBoundingBoxLeft:A,actualBoundingBoxRight:x}=this.ctx.measureText(g),T=Math.ceil(d),B=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-A))),U=Math.min(this.size-this.buffer,T+Math.ceil(_)),j=B+2*this.buffer,R=U+2*this.buffer,N=Math.max(j*R,0),V=new Uint8ClampedArray(N),z={data:V,width:j,height:R,glyphWidth:B,glyphHeight:U,glyphTop:T,glyphLeft:0,glyphAdvance:c};if(B===0||U===0)return z;const{ctx:G,buffer:$,gridInner:K,gridOuter:te}=this;G.clearRect($,$,B,U),G.fillText(g,$,$+T);const ce=G.getImageData($,$,B,U);te.fill(iS,0,N),K.fill(0,0,N);for(let he=0;he<U;he++)for(let ne=0;ne<B;ne++){const de=ce.data[4*(he*B+ne)+3]/255;if(de===0)continue;const ge=(he+$)*j+ne+$;if(de===1)te[ge]=0,K[ge]=iS;else{const Me=.5-de;te[ge]=Me>0?Me*Me:0,K[ge]=Me<0?Me*Me:0}}kH(te,0,0,j,R,j,this.f,this.v,this.z),kH(K,$,$,B,U,j,this.f,this.v,this.z);for(let he=0;he<N;he++){const ne=Math.sqrt(te[he])-Math.sqrt(K[he]);V[he]=Math.round(255-255*(ne/this.radius+this.cutoff))}return z}};const nv=rS;function FH(g,c,d,_){const A=[],x=g.imagePrimary,T=x.pixelRatio,B=x.paddedRect.w-2*nv,U=x.paddedRect.h-2*nv,j=g.right-g.left,R=g.bottom-g.top,N=x.stretchX||[[0,B]],V=x.stretchY||[[0,U]],z=(Ye,ze)=>Ye+ze[1]-ze[0],G=N.reduce(z,0),$=V.reduce(z,0),K=B-G,te=U-$;let ce=0,he=G,ne=0,de=$,ge=0,Me=K,Be=0,Oe=te;if(x.content&&_){const Ye=x.content;ce=ZE(N,0,Ye[0]),ne=ZE(V,0,Ye[1]),he=ZE(N,Ye[0],Ye[2]),de=ZE(V,Ye[1],Ye[3]),ge=Ye[0]-ce,Be=Ye[1]-ne,Me=Ye[2]-Ye[0]-he,Oe=Ye[3]-Ye[1]-de}const Pe=(Ye,ze,Qe,ct)=>{const ht=YE(Ye.stretch-ce,he,j,g.left),ft=KE(Ye.fixed-ge,Me,Ye.stretch,G),mt=YE(ze.stretch-ne,de,R,g.top),Ct=KE(ze.fixed-Be,Oe,ze.stretch,$),_t=YE(Qe.stretch-ce,he,j,g.left),Ut=KE(Qe.fixed-ge,Me,Qe.stretch,G),Yt=YE(ct.stretch-ne,de,R,g.top),Dt=KE(ct.fixed-Be,Oe,ct.stretch,$),Rn=new St(ht,mt),bn=new St(_t,mt),dn=new St(_t,Yt),tn=new St(ht,Yt),nr=new St(ft/T,Ct/T),In=new St(Ut/T,Dt/T),Nn=c*Math.PI/180;if(Nn){const Wr=Math.sin(Nn),Gi=Math.cos(Nn),Mi=[Gi,-Wr,Wr,Gi];Rn._matMult(Mi),bn._matMult(Mi),tn._matMult(Mi),dn._matMult(Mi)}const wr=Ye.stretch+Ye.fixed,Or=Qe.stretch+Qe.fixed,Pr=ze.stretch+ze.fixed,Lr=ct.stretch+ct.fixed,jr=g.imageSecondary;return{tl:Rn,tr:bn,bl:tn,br:dn,texPrimary:{x:x.paddedRect.x+nv+wr,y:x.paddedRect.y+nv+Pr,w:Or-wr,h:Lr-Pr},texSecondary:jr?{x:jr.paddedRect.x+nv+wr,y:jr.paddedRect.y+nv+Pr,w:Or-wr,h:Lr-Pr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nr,pixelOffsetBR:In,minFontScaleX:Me/T/j,minFontScaleY:Oe/T/R,isSDF:d}};if(_&&(x.stretchX||x.stretchY)){const Ye=NH(N,K,G),ze=NH(V,te,$);for(let Qe=0;Qe<Ye.length-1;Qe++){const ct=Ye[Qe],ht=Ye[Qe+1];for(let ft=0;ft<ze.length-1;ft++)A.push(Pe(ct,ze[ft],ht,ze[ft+1]))}}else A.push(Pe({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:U+1}));return A}function ZE(g,c,d){let _=0;for(const A of g)_+=Math.max(c,Math.min(d,A[1]))-Math.max(c,Math.min(d,A[0]));return _}function NH(g,c,d){const _=[{fixed:-nv,stretch:0}];for(const[A,x]of g){const T=_[_.length-1];_.push({fixed:A-T.stretch,stretch:T.stretch}),_.push({fixed:A-T.stretch,stretch:T.stretch+(x-A)})}return _.push({fixed:c+nv,stretch:d}),_}function YE(g,c,d,_){return g/c*d+_}function KE(g,c,d,_){return g-c*d/_}function wfe(g,c,d,_){const A=c+g.positionedLines[_].lineOffset;return _===0?d+A/2:d+(A+(c+g.positionedLines[_-1].lineOffset))/2}function Sfe(g,c=1,d=!1){let _=1/0,A=1/0,x=-1/0,T=-1/0;const B=g[0];for(let z=0;z<B.length;z++){const G=B[z];(!z||G.x<_)&&(_=G.x),(!z||G.y<A)&&(A=G.y),(!z||G.x>x)&&(x=G.x),(!z||G.y>T)&&(T=G.y)}const U=Math.min(x-_,T-A);let j=U/2;const R=new Yh([],Afe);if(U===0)return new St(_,A);for(let z=_;z<x;z+=U)for(let G=A;G<T;G+=U)R.push(new Jx(z+j,G+j,j,g));let N=function(z){let G=0,$=0,K=0;const te=z[0];for(let ce=0,he=te.length,ne=he-1;ce<he;ne=ce++){const de=te[ce],ge=te[ne],Me=de.x*ge.y-ge.x*de.y;$+=(de.x+ge.x)*Me,K+=(de.y+ge.y)*Me,G+=3*Me}return new Jx($/G,K/G,0,z)}(g),V=R.length;for(;R.length;){const z=R.pop();(z.d>N.d||!N.d)&&(N=z,d&&console.log("found best %d after %d probes",Math.round(1e4*z.d)/1e4,V)),z.max-N.d<=c||(j=z.h/2,R.push(new Jx(z.p.x-j,z.p.y-j,j,g)),R.push(new Jx(z.p.x+j,z.p.y-j,j,g)),R.push(new Jx(z.p.x-j,z.p.y+j,j,g)),R.push(new Jx(z.p.x+j,z.p.y+j,j,g)),V+=4)}return d&&(console.log(`num probes: ${V}`),console.log(`best distance: ${N.d}`)),N.p}function Afe(g,c){return c.max-g.max}class Jx{constructor(c,d,_,A){this.p=new St(c,d),this.h=_,this.d=function(x,T){let B=!1,U=1/0;for(let j=0;j<T.length;j++){const R=T[j];for(let N=0,V=R.length,z=V-1;N<V;z=N++){const G=R[N],$=R[z];G.y>x.y!=$.y>x.y&&x.x<($.x-G.x)*(x.y-G.y)/($.y-G.y)+G.x&&(B=!B),U=Math.min(U,Ci(x,G,$))}}return(B?1:-1)*Math.sqrt(U)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}}const gk=Number.POSITIVE_INFINITY,Tfe=Math.sqrt(2);function zH(g,[c,d]){let _=0,A=0;if(d===gk){c<0&&(c=0);const x=c/Tfe;switch(g){case"top-right":case"top-left":A=x-7;break;case"bottom-right":case"bottom-left":A=7-x;break;case"bottom":A=7-c;break;case"top":A=c-7}switch(g){case"top-right":case"bottom-right":_=-x;break;case"top-left":case"bottom-left":_=x;break;case"left":_=c;break;case"right":_=-c}}else{switch(c=Math.abs(c),d=Math.abs(d),g){case"top-right":case"top-left":case"top":A=d-7;break;case"bottom-right":case"bottom-left":case"bottom":A=7-d}switch(g){case"top-right":case"bottom-right":case"right":_=-c;break;case"top-left":case"bottom-left":case"left":_=c}}return[_,A]}function vk(g){switch(g){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Mfe(g,c,d,_,A,x,T,B,U,j,R,N,V,z,G){let $=x.textMaxSize.evaluate(c,{},N);$===void 0&&($=T);const K=g.layers[0].layout,te=K.get("icon-offset").evaluate(c,{},N),ce=GH(d.horizontal)||d.vertical,he=V.name==="globe",ne=zo,de=T/ne,ge=g.tilePixelRatio*$/ne,Me=(ht=g.overscaling,g.zoom>18&&ht>2&&(ht>>=1),Math.max(yn/(512*ht),1)*K.get("symbol-spacing")),Be=K.get("text-padding")*g.tilePixelRatio,Oe=K.get("icon-padding")*g.tilePixelRatio,Pe=sn(K.get("text-max-angle")),Ye=K.get("text-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",ze=K.get("icon-rotation-alignment")==="map"&&K.get("symbol-placement")!=="point",Qe=K.get("symbol-placement"),ct=Me/2;var ht;const ft=K.get("icon-text-fit").evaluate(c,{},N),mt=K.get("icon-text-fit-padding").evaluate(c,{},N),Ct=ft!=="none";let _t;g.hasAnyIconTextFit===!1&&Ct&&(g.hasAnyIconTextFit=!0),_&&Ct&&(g.allowVerticalPlacement&&d.vertical&&(_t=MH(_,d.vertical,ft,mt,te,de)),ce&&(_=MH(_,ce,ft,mt,te,de)));const Ut=(Yt,Dt,Rn)=>{if(Dt.x<0||Dt.x>=yn||Dt.y<0||Dt.y>=yn)return;let bn=null;if(he){const{x:dn,y:tn,z:nr}=V.projectTilePoint(Dt.x,Dt.y,Rn);bn={anchor:new um(dn,tn,nr,0,void 0),up:V.upVector(Rn,Dt.x,Dt.y)}}(function(dn,tn,nr,In,Nn,wr,Or,Pr,Lr,jr,Wr,Gi,Mi,Tr,_i,wi,ss,Ws,pa,$s,Os,uo,Sa,Uo,Qi,gc,Tf){const lh=dn.addToLineVertexArray(tn,In);let ch,__,ov,y_,wS,lj,cj,uj=0,hj=0,fj=0,dj=0,$k=-1,Xk=-1;const Vd={};let pj=Xa("");const x_=nr?nr.anchor:tn,qk=Lr.layout.get("icon-text-fit").evaluate(Os,{},Qi)!=="none";let Zk=0,Yk=0;if(Lr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Zk,Yk]=Lr.layout.get("text-offset").evaluate(Os,{},Qi).map(Yc=>Yc*zo):(Zk=Lr.layout.get("text-radial-offset").evaluate(Os,{},Qi)*zo,Yk=gk),dn.allowVerticalPlacement&&Nn.vertical){const Yc=Nn.vertical;if(_i)lj=_k(Yc),Pr&&(cj=_k(Pr));else{const Kc=Lr.layout.get("text-rotate").evaluate(Os,{},Qi)+90;ov=JE(jr,x_,tn,Wr,Gi,Mi,Yc,Tr,Kc,wi),Pr&&(y_=JE(jr,x_,tn,Wr,Gi,Mi,Pr,Ws,Kc))}}if(wr){const Yc=Lr.layout.get("icon-rotate").evaluate(Os,{},Qi),Kc=FH(wr,Yc,Sa,qk),a1=Pr?FH(Pr,Yc,Sa,qk):void 0;__=JE(jr,x_,tn,Wr,Gi,Mi,wr,Ws,Yc),uj=4*Kc.length;const mj=dn.iconSizeData;let b_=null;mj.kind==="source"?(b_=[xf*Lr.layout.get("icon-size").evaluate(Os,{},Qi)],b_[0]>rv&&Lt(`${dn.layerIds[0]}: Value for "icon-size" is >= ${sS}. Reduce your "icon-size".`)):mj.kind==="composite"&&(b_=[xf*uo.compositeIconSizes[0].evaluate(Os,{},Qi),xf*uo.compositeIconSizes[1].evaluate(Os,{},Qi)],(b_[0]>rv||b_[1]>rv)&&Lt(`${dn.layerIds[0]}: Value for "icon-size" is >= ${sS}. Reduce your "icon-size".`)),dn.addSymbols(dn.icon,Kc,b_,$s,pa,Os,!1,nr,tn,lh.lineStartIndex,lh.lineLength,-1,Uo,Qi,gc,Tf),$k=dn.icon.placedSymbolArray.length-1,a1&&(hj=4*a1.length,dn.addSymbols(dn.icon,a1,b_,$s,pa,Os,Eu.vertical,nr,tn,lh.lineStartIndex,lh.lineLength,-1,Uo,Qi,gc,Tf),Xk=dn.icon.placedSymbolArray.length-1)}for(const Yc in Nn.horizontal){const Kc=Nn.horizontal[Yc];ch||(pj=Xa(Kc.text),_i?wS=_k(Kc):ch=JE(jr,x_,tn,Wr,Gi,Mi,Kc,Tr,Lr.layout.get("text-rotate").evaluate(Os,{},Qi),wi));const a1=Kc.positionedLines.length===1;if(fj+=UH(dn,nr,tn,Kc,Or,Lr,_i,Os,wi,lh,Nn.vertical?Eu.horizontal:Eu.horizontalOnly,a1?Object.keys(Nn.horizontal):[Yc],Vd,$k,uo,Uo,Qi,gc),a1)break}Nn.vertical&&(dj+=UH(dn,nr,tn,Nn.vertical,Or,Lr,_i,Os,wi,lh,Eu.vertical,["vertical"],Vd,Xk,uo,Uo,Qi,gc));let lv=-1;const Kk=(Yc,Kc)=>Yc?Math.max(Yc,Kc):Kc;lv=Kk(wS,lv),lv=Kk(lj,lv),lv=Kk(cj,lv);const Gde=lv>-1?1:0;dn.glyphOffsetArray.length>=65535&&Lt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Os.sortKey!==void 0&&dn.addToSortKeyRanges(dn.symbolInstances.length,Os.sortKey),dn.symbolInstances.emplaceBack(tn.x,tn.y,x_.x,x_.y,x_.z,Vd.right>=0?Vd.right:-1,Vd.center>=0?Vd.center:-1,Vd.left>=0?Vd.left:-1,Vd.vertical>=0?Vd.vertical:-1,$k,Xk,pj,ch!==void 0?ch:dn.collisionBoxArray.length,ch!==void 0?ch+1:dn.collisionBoxArray.length,ov!==void 0?ov:dn.collisionBoxArray.length,ov!==void 0?ov+1:dn.collisionBoxArray.length,__!==void 0?__:dn.collisionBoxArray.length,__!==void 0?__+1:dn.collisionBoxArray.length,y_||dn.collisionBoxArray.length,y_?y_+1:dn.collisionBoxArray.length,Wr,fj,dj,uj,hj,Gde,0,Zk,Yk,lv,0,qk?1:0)})(g,Dt,bn,Yt,d,_,A,_t,g.layers[0],g.collisionBoxArray,c.index,c.sourceLayerIndex,g.index,Be,Ye,U,0,Oe,ze,te,c,x,j,R,N,z,G)};if(Qe==="line")for(const Yt of LH(c.geometry,0,0,yn,yn)){const Dt=bfe(Yt,Me,Pe,d.vertical||ce,_,ne,ge,g.overscaling,yn);for(const Rn of Dt)ce&&Efe(g,ce.text,ct,Rn)||Ut(Yt,Rn,N)}else if(Qe==="line-center"){for(const Yt of c.geometry)if(Yt.length>1){const Dt=xfe(Yt,Pe,d.vertical||ce,_,ne,ge);Dt&&Ut(Yt,Dt,N)}}else if(c.type==="Polygon")for(const Yt of zE(c.geometry,0)){const Dt=Sfe(Yt,16);Ut(Yt[0],new um(Dt.x,Dt.y,0,0,void 0),N)}else if(c.type==="LineString")for(const Yt of c.geometry)Ut(Yt,new um(Yt[0].x,Yt[0].y,0,0,void 0),N);else if(c.type==="Point")for(const Yt of c.geometry)for(const Dt of Yt)Ut([Dt],new um(Dt.x,Dt.y,0,0,void 0),N)}const sS=255,rv=sS*xf;function UH(g,c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K,te){const ce=function(de,ge,Me,Be,Oe,Pe,Ye,ze){const Qe=[];if(ge.positionedLines.length===0)return Qe;const ct=Be.layout.get("text-rotate").evaluate(Pe,{})*Math.PI/180,ht=function(Ut){const Yt=Ut[0],Dt=Ut[1],Rn=Yt*Dt;return Rn>0?[Yt,-Dt]:Rn<0?[-Yt,Dt]:Yt===0?[Dt,Yt]:[Dt,-Yt]}(Me);let ft=Math.abs(ge.top-ge.bottom);for(const Ut of ge.positionedLines)ft-=Ut.lineOffset;const mt=ge.positionedLines.length,Ct=ft/mt;let _t=ge.top-Me[1];for(let Ut=0;Ut<mt;++Ut){const Yt=ge.positionedLines[Ut];_t=wfe(ge,Ct,_t,Ut);for(const Dt of Yt.positionedGlyphs){if(!Dt.rect)continue;const Rn=Dt.rect||{};let bn=xH+1,dn=!0,tn=1,nr=0;if(Dt.imageName){const $s=Ye[Dt.imageName];if(!$s)continue;if($s.sdf){Lt("SDF images are not supported in formatted text and will be ignored.");continue}dn=!1,tn=$s.pixelRatio,bn=rS/tn}const In=(Oe||ze)&&Dt.vertical,Nn=Dt.metrics.advance*Dt.scale/2,wr=Dt.metrics,Or=Dt.rect;if(Or===null)continue;ze&&ge.verticalizable&&(nr=Dt.imageName?Nn-Dt.metrics.width*Dt.scale/2:0);const Pr=Oe?[Dt.x+Nn,Dt.y]:[0,0];let Lr=[0,0],jr=[0,0],Wr=!1;Oe||(In?(jr=[Dt.x+Nn+ht[0],Dt.y+ht[1]-nr],Wr=!0):Lr=[Dt.x+Nn+Me[0],Dt.y+Me[1]-nr]);const Gi=Or.w*Dt.scale/(tn*(Dt.localGlyph?bf:1)),Mi=Or.h*Dt.scale/(tn*(Dt.localGlyph?bf:1));let Tr,_i,wi,ss;if(In){const $s=Dt.y-_t,Os=new St(-Nn,Nn-$s),uo=-Math.PI/2,Sa=new St(...jr);Tr=new St(-Nn+Lr[0],Lr[1]),Tr._rotateAround(uo,Os)._add(Sa),Tr.x+=-$s+Nn,Tr.y-=(wr.left-bn)*Dt.scale;const Uo=Dt.imageName?wr.advance*Dt.scale:zo*Dt.scale,Qi=String.fromCodePoint(Dt.glyph);hfe(Qi)?Tr.x+=(1-bn)*Dt.scale:ffe(Qi)?Tr.x+=Uo-wr.height*Dt.scale+(-bn-1)*Dt.scale:Tr.x+=Dt.imageName||wr.width+2*bn===Or.w&&wr.height+2*bn===Or.h?(Uo-Mi)/2:(Uo-(wr.height+2*bn)*Dt.scale)/2,_i=new St(Tr.x,Tr.y-Gi),wi=new St(Tr.x+Mi,Tr.y),ss=new St(Tr.x+Mi,Tr.y-Gi)}else{const $s=(wr.left-bn)*Dt.scale-Nn+Lr[0],Os=(-wr.top-bn)*Dt.scale+Lr[1],uo=$s+Gi,Sa=Os+Mi;Tr=new St($s,Os),_i=new St(uo,Os),wi=new St($s,Sa),ss=new St(uo,Sa)}if(ct){let $s;$s=Oe?new St(0,0):Wr?new St(ht[0],ht[1]):new St(Me[0],Me[1]),Tr._rotateAround(ct,$s),_i._rotateAround(ct,$s),wi._rotateAround(ct,$s),ss._rotateAround(ct,$s)}const Ws=new St(0,0),pa=new St(0,0);Qe.push({tl:Tr,tr:_i,bl:wi,br:ss,texPrimary:Rn,texSecondary:void 0,writingMode:ge.writingMode,glyphOffset:Pr,sectionIndex:Dt.sectionIndex,isSDF:dn,pixelOffsetTL:Ws,pixelOffsetBR:pa,minFontScaleX:0,minFontScaleY:0})}}return Qe}(0,_,U,x,T,B,A,g.allowVerticalPlacement),he=g.textSizeData;let ne=null;he.kind==="source"?(ne=[xf*x.layout.get("text-size").evaluate(B,{},K)],ne[0]>rv&&Lt(`${g.layerIds[0]}: Value for "text-size" is >= ${sS}. Reduce your "text-size".`)):he.kind==="composite"&&(ne=[xf*G.compositeTextSizes[0].evaluate(B,{},K),xf*G.compositeTextSizes[1].evaluate(B,{},K)],(ne[0]>rv||ne[1]>rv)&&Lt(`${g.layerIds[0]}: Value for "text-size" is >= ${sS}. Reduce your "text-size".`)),g.addSymbols(g.text,ce,ne,U,T,B,R,c,d,j.lineStartIndex,j.lineLength,z,$,K,te,!1);for(const de of N)V[de]=g.text.placedSymbolArray.length-1;return 4*ce.length}function GH(g){for(const c in g)return g[c];return null}function JE(g,c,d,_,A,x,T,B,U,j){let R=T.top,N=T.bottom,V=T.left,z=T.right;const G=T.collisionPadding;if(G&&(V-=G[0],R-=G[1],z+=G[2],N+=G[3]),U){const $=new St(V,R),K=new St(z,R),te=new St(V,N),ce=new St(z,N),he=sn(U);let ne=new St(0,0);j&&(ne=new St(j[0],j[1])),$._rotateAround(he,ne),K._rotateAround(he,ne),te._rotateAround(he,ne),ce._rotateAround(he,ne),V=Math.min($.x,K.x,te.x,ce.x),z=Math.max($.x,K.x,te.x,ce.x),R=Math.min($.y,K.y,te.y,ce.y),N=Math.max($.y,K.y,te.y,ce.y)}return g.emplaceBack(c.x,c.y,c.z,d.x,d.y,V,R,z,N,B,_,A,x),g.length-1}function _k(g){g.collisionPadding&&(g.top-=g.collisionPadding[1],g.bottom+=g.collisionPadding[3]);const c=g.bottom-g.top;return c>0?Math.max(10,c):null}function Efe(g,c,d,_){const A=g.compareText;if(c in A){const x=A[c];for(let T=x.length-1;T>=0;T--)if(_.dist(x[T])<d)return!0}else A[c]=[];return A[c].push(_),!1}function VH(g,c){const d=g.fovAboveCenter,_=g.elevation?g.elevation.getMinElevationBelowMSL()*c:0,A=(g._camera.position[2]*g.worldSize-_)/Math.cos(g._pitch),x=Math.sin(d)*A/Math.sin(Math.max(Math.PI/2-g._pitch-d,.01));let T=Math.sin(g._pitch)*x+A;const B=A*(1/g._horizonShift);return g.elevation&&g.elevation.exaggeration()!==0||(T*=1+Math.max(g.zoom-17,0)),Math.min(1.01*T,B)}function aS(g,c){if(!c.isReprojectedInTileSpace)return{scale:1<<g.z,x:g.x,y:g.y,x2:g.x+1,y2:g.y+1,projection:c};const d=Math.pow(2,-g.z),_=g.x*d,A=(g.x+1)*d,x=g.y*d,T=(g.y+1)*d,B=$e(_),U=$e(A),j=je(x),R=je(T),N=c.project(B,j),V=c.project(U,j),z=c.project(U,R),G=c.project(B,R);let $=Math.min(N.x,V.x,z.x,G.x),K=Math.min(N.y,V.y,z.y,G.y),te=Math.max(N.x,V.x,z.x,G.x),ce=Math.max(N.y,V.y,z.y,G.y);const he=d/16;function ne(ge,Me,Be,Oe,Pe,Ye){const ze=(Be+Pe)/2,Qe=(Oe+Ye)/2,ct=c.project($e(ze),je(Qe)),ht=Math.max(0,$-ct.x,K-ct.y,ct.x-te,ct.y-ce);$=Math.min($,ct.x),te=Math.max(te,ct.x),K=Math.min(K,ct.y),ce=Math.max(ce,ct.y),ht>he&&(ne(ge,ct,Be,Oe,ze,Qe),ne(ct,Me,ze,Qe,Pe,Ye))}ne(N,V,_,x,A,x),ne(V,z,A,x,A,T),ne(z,G,A,T,_,T),ne(G,N,_,T,_,x),$-=he,K-=he,te+=he,ce+=he;const de=1/Math.max(te-$,ce-K);return{scale:de,x:$*de,y:K*de,x2:te*de,y2:ce*de,projection:c}}function HH(g,{x:c,y:d},_=0){return new St(((c-_)*g.scale-g.x)*yn,(d*g.scale-g.y)*yn)}const Cfe=Le.mat4.identity(new Float32Array(16));class iv{constructor(c){this.spec=c,this.name=c.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(c,d){return{x:0,y:0,z:0}}unproject(c,d){return new ue(0,0)}projectTilePoint(c,d,_){return{x:c,y:d,z:0}}locationPoint(c,d,_=!0){return c._coordinatePoint(c.locationCoordinate(d),_)}pixelsPerMeter(c,d){return De(1,c)*d}pixelSpaceConversion(c,d,_){return 1}farthestPixelDistance(c){return VH(c,c.pixelsPerMeter)}pointCoordinate(c,d,_,A){const x=c.horizonLineFromTop(!1),T=new St(d,Math.max(x,_));return c.rayIntersectionCoordinate(c.pointRayIntersection(T,A))}pointCoordinate3D(c,d,_){const A=new St(d,_);if(c.elevation)return c.elevation.pointCoordinate(A);{const x=this.pointCoordinate(c,A.x,A.y,0);return[x.x,x.y,x.z]}}isPointAboveHorizon(c,d){if(c.elevation&&c.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(c,d.x,d.y);const _=c.horizonLineFromTop();return d.y<_}createInversionMatrix(c,d){return Cfe}createTileMatrix(c,d,_){let A,x,T;const B=_.canonical,U=Le.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const j=aS(B,this);A=1,x=j.x+_.wrap*j.scale,T=j.y,Le.mat4.scale(U,U,[A/j.scale,A/j.scale,c.pixelsPerMeter/d])}else A=d/c.zoomScale(B.z),x=(B.x+Math.pow(2,B.z)*_.wrap)*A,T=B.y*A;return Le.mat4.translate(U,U,[x,T,0]),Le.mat4.scale(U,U,[A/yn,A/yn,1]),U}upVector(c,d,_){return[0,0,1]}upVectorScale(c,d,_){return{metersToTile:1}}}class Ife extends iv{constructor(c){super(c),this.range=[4,7],this.center=c.center||[-96,37.5];const[d,_]=this.parallels=c.parallels||[29.5,45.5],A=Math.sin(sn(d));this.n=(A+Math.sin(sn(_)))/2,this.c=1+A*(2*this.n-A),this.r0=Math.sqrt(this.c)/this.n}project(c,d){const{n:_,c:A,r0:x}=this,T=sn(c-this.center[0]),B=sn(d),U=Math.sqrt(A-2*_*Math.sin(B))/_;return{x:U*Math.sin(T*_),y:U*Math.cos(T*_)-x,z:0}}unproject(c,d){const{n:_,c:A,r0:x}=this,T=x+d;let B=Math.atan2(c,Math.abs(T))*Math.sign(T);T*_<0&&(B-=Math.PI*Math.sign(c)*Math.sign(T));const U=sn(this.center[0])*_;B=Un(B,-Math.PI-U,Math.PI-U);const j=jt(ot(B/_)+this.center[0],-180,180),R=Math.asin(jt((A-(c*c+T*T)*_*_)/(2*_),-1,1)),N=jt(ot(R),-Ke,Ke);return new ue(j,N)}}const oS=1.340264,lS=-.081106,cS=893e-6,uS=.003796,QE=Math.sqrt(3)/2;class Rfe extends iv{project(c,d){d=d/180*Math.PI,c=c/180*Math.PI;const _=Math.asin(QE*Math.sin(d)),A=_*_,x=A*A*A;return{x:.5*(c*Math.cos(_)/(QE*(oS+3*lS*A+x*(7*cS+9*uS*A)))/Math.PI+.5),y:1-.5*(_*(oS+lS*A+x*(cS+uS*A))/Math.PI+1),z:0}}unproject(c,d){c=(2*c-.5)*Math.PI;let _=d=(2*(1-d)-1)*Math.PI,A=_*_,x=A*A*A;for(let R,N,V,z=0;z<12&&(N=_*(oS+lS*A+x*(cS+uS*A))-d,V=oS+3*lS*A+x*(7*cS+9*uS*A),R=N/V,_=jt(_-R,-Math.PI/3,Math.PI/3),A=_*_,x=A*A*A,!(Math.abs(R)<1e-12));++z);const T=QE*c*(oS+3*lS*A+x*(7*cS+9*uS*A))/Math.cos(_),B=Math.asin(Math.sin(_)/QE),U=jt(180*T/Math.PI,-180,180),j=jt(180*B/Math.PI,-Ke,Ke);return new ue(U,j)}}class Pfe extends iv{constructor(c){super(c),this.wrap=!0,this.supportsWorldCopies=!0}project(c,d){return{x:.5+c/360,y:.5-d/360,z:0}}unproject(c,d){const _=360*(c-.5),A=jt(360*(.5-d),-Ke,Ke);return new ue(_,A)}}const Qx=Math.PI/2;function eC(g){return Math.tan((Qx+g)/2)}class Lfe extends iv{constructor(c){super(c),this.center=c.center||[0,30];const[d,_]=this.parallels=c.parallels||[30,30];let A=sn(d),x=sn(_);this.southernCenter=A+x<0,this.southernCenter&&(A=-A,x=-x);const T=Math.cos(A),B=eC(A);this.n=A===x?Math.sin(A):Math.log(T/Math.cos(x))/Math.log(eC(x)/B),this.f=T*Math.pow(eC(A),this.n)/this.n}project(c,d){d=sn(d),this.southernCenter&&(d=-d),c=sn(c-this.center[0]);const _=1e-6,{n:A,f:x}=this;x>0?d<-Qx+_&&(d=-Qx+_):d>Qx-_&&(d=Qx-_);const T=x/Math.pow(eC(d),A);let B=T*Math.sin(A*c),U=x-T*Math.cos(A*c);return B=.5*(B/Math.PI+.5),U=.5*(U/Math.PI+.5),{x:B,y:this.southernCenter?U:1-U,z:0}}unproject(c,d){c=(2*c-.5)*Math.PI,this.southernCenter&&(d=1-d),d=(2*(1-d)-.5)*Math.PI;const{n:_,f:A}=this,x=A-d,T=Math.sign(x),B=Math.sign(_)*Math.sqrt(c*c+x*x);let U=Math.atan2(c,Math.abs(x))*T;x*_<0&&(U-=Math.PI*Math.sign(c)*T);const j=jt(ot(U/_)+this.center[0],-180,180),R=jt(ot(2*Math.atan(Math.pow(A/B,1/_))-Qx),-Ke,Ke);return new ue(j,this.southernCenter?-R:R)}}class jH extends iv{constructor(c){super(c),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(c,d){return{x:ke(c),y:Ne(d),z:0}}unproject(c,d){const _=$e(c),A=je(d);return new ue(_,A)}}const WH=sn(Ke);class Dfe extends iv{project(c,d){const _=(d=sn(d))*d,A=_*_;return{x:.5*((c=sn(c))*(.8707-.131979*_+A*(A*(.003971*_-.001529*A)-.013791))/Math.PI+.5),y:1-.5*(d*(1.007226+_*(.015085+A*(.028874*_-.044475-.005916*A)))/Math.PI+1),z:0}}unproject(c,d){c=(2*c-.5)*Math.PI;let _=d=(2*(1-d)-1)*Math.PI,A=25,x=0,T=_*_;do{T=_*_;const j=T*T;x=(_*(1.007226+T*(.015085+j*(.028874*T-.044475-.005916*j)))-d)/(1.007226+T*(.045255+j*(.259866*T-.311325-.005916*11*j))),_=jt(_-x,-WH,WH)}while(Math.abs(x)>1e-6&&--A>0);T=_*_;const B=jt(ot(c/(.8707+T*(T*(T*T*T*(.003971-.001529*T)-.013791)-.131979))),-180,180),U=ot(_);return new ue(B,U)}}const $H=sn(Ke);class Bfe extends iv{project(c,d){d=sn(d),c=sn(c);const _=Math.cos(d),A=2/Math.PI,x=Math.acos(_*Math.cos(c/2)),T=Math.sin(x)/x,B=.5*(c*A+2*_*Math.sin(c/2)/T)||0,U=.5*(d+Math.sin(d)/T)||0;return{x:.5*(B/Math.PI+.5),y:1-.5*(U/Math.PI+1),z:0}}unproject(c,d){let _=c=(2*c-.5)*Math.PI,A=d=(2*(1-d)-1)*Math.PI,x=25;const T=1e-6;let B=0,U=0;do{const j=Math.cos(A),R=Math.sin(A),N=2*R*j,V=R*R,z=j*j,G=Math.cos(_/2),$=Math.sin(_/2),K=2*G*$,te=$*$,ce=1-z*G*G,he=ce?1/ce:0,ne=ce?Math.acos(j*G)*Math.sqrt(1/ce):0,de=.5*(2*ne*j*$+2*_/Math.PI)-c,ge=.5*(ne*R+A)-d,Me=.5*he*(z*te+ne*j*G*V)+1/Math.PI,Be=he*(K*N/4-ne*R*$),Oe=.125*he*(N*$-ne*R*z*K),Pe=.5*he*(V*G+ne*te*j)+.5,Ye=Be*Oe-Pe*Me;B=(ge*Be-de*Pe)/Ye,U=(de*Oe-ge*Me)/Ye,_=jt(_-B,-Math.PI,Math.PI),A=jt(A-U,-$H,$H)}while((Math.abs(B)>T||Math.abs(U)>T)&&--x>0);return new ue(ot(_),ot(A))}}class XH extends iv{constructor(c){super(c),this.center=c.center||[0,0],this.parallels=c.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(sn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(c,d){const{scale:_,cosPhi:A}=this;return{x:sn(c)*A*_+.5,y:-Math.sin(sn(d))/A*_+.5,z:0}}unproject(c,d){const{scale:_,cosPhi:A}=this,x=-(d-.5)/_,T=jt(ot((c-.5)/_)/A,-180,180),B=Math.asin(jt(x*A,-1,1)),U=jt(ot(B),-Ke,Ke);return new ue(T,U)}}class kfe extends jH{constructor(c){super(c),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(c,d,_){const A=jw(c,d,_),x=kE(Ud(_));return Le.vec3.transformMat4(A,A,x),{x:A[0],y:A[1],z:A[2]}}locationPoint(c,d){const _=ee(d.lat,d.lng),A=Le.vec3.normalize([],_),x=c.elevation?c.elevation.getAtPointOrZero(c.locationCoordinate(d),c._centerAltitude):c._centerAltitude,T=De(1,0)*yn*x;Le.vec3.scaleAndAdd(_,_,A,T);const B=Le.mat4.identity(new Float64Array(16));return Le.mat4.multiply(B,c.pixelMatrix,c.globeMatrix),Le.vec3.transformMat4(_,_,B),new St(_[0],_[1])}pixelsPerMeter(c,d){return De(1,0)*d}pixelSpaceConversion(c,d,_){const A=De(1,c)*d,x=cr(De(1,45)*d,A,_);return this.pixelsPerMeter(c,d)/x}createTileMatrix(c,d,_){const A=VB(Ud(_.canonical));return Le.mat4.multiply(new Float64Array(16),c.globeMatrix,A)}createInversionMatrix(c,d){const{center:_}=c,A=kE(Ud(d));return Le.mat4.rotateY(A,A,sn(_.lng)),Le.mat4.rotateX(A,A,sn(_.lat)),Le.mat4.scale(A,A,[c._pixelsPerMercatorPixel,c._pixelsPerMercatorPixel,1]),Float32Array.from(A)}pointCoordinate(c,d,_,A){return LE(c,d,_,!0)||new bt(0,0)}pointCoordinate3D(c,d,_){const A=this.pointCoordinate(c,d,_,0);return[A.x,A.y,A.z]}isPointAboveHorizon(c,d){return!LE(c,d.x,d.y,!1)}farthestPixelDistance(c){const d=function(A,x){const T=A.cameraToCenterDistance,B=A._centerAltitude*x,U=A._camera,j=A._camera.forward(),R=Le.vec3.add([],Le.vec3.scale([],j,-T),[0,0,B]),N=A.worldSize/(2*Math.PI),V=[0,0,-N],z=A.width/A.height,G=Math.tan(A.fovAboveCenter),$=Le.vec3.scale([],U.up(),G),K=Le.vec3.scale([],U.right(),G*z),te=Le.vec3.normalize([],Le.vec3.add([],Le.vec3.add([],j,$),K)),ce=[];let he;if(new yf(R,te).closestPointOnSphere(V,N,ce)){const ne=Le.vec3.add([],ce,V),de=Le.vec3.sub([],ne,R);he=Math.cos(A.fovAboveCenter)*Le.vec3.length(de)}else{const ne=Le.vec3.sub([],R,V),de=Le.vec3.sub([],V,R);Le.vec3.normalize(de,de);const ge=Le.vec3.length(ne)-N;he=Math.sqrt(ge*(ge+2*N));const Me=Math.acos(he/(N+ge))-Math.acos(Le.vec3.dot(j,de));he*=Math.cos(Me)}return 1.01*he}(c,this.pixelsPerMeter(c.center.lat,c.worldSize)),_=Qg(c.zoom);if(_>0){const A=VH(c,De(1,c.center.lat)*c.worldSize),x=c.worldSize/(2*Math.PI),T=Math.max(c.width,c.height)/c.worldSize*Math.PI;return cr(d,A+x*(1-Math.cos(T)),Math.pow(_,10))}return d}upVector(c,d,_){return jw(d,_,c,1)}upVectorScale(c){return{metersToTile:lm(BE(Ud(c)))}}}function qH(g){const c=g.parallels,d=!!c&&Math.abs(c[0]+c[1])<.01;switch(g.name){case"mercator":return new jH(g);case"equirectangular":return new Pfe(g);case"naturalEarth":return new Dfe(g);case"equalEarth":return new Rfe(g);case"winkelTripel":return new Bfe(g);case"albers":return d?new XH(g):new Ife(g);case"lambertConformalConic":return d?new XH(g):new Lfe(g);case"globe":return new kfe(g)}throw new Error(`Invalid projection name: ${g.name}`)}const Ofe=qx.VectorTileFeature.types,Ffe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tC(g,c,d,_,A,x,T,B,U,j,R,N,V){const z=B?Math.min(rv,Math.round(B[0])):0,G=B?Math.min(rv,Math.round(B[1])):0;g.emplaceBack(c,d,Math.round(32*_),Math.round(32*A),x,T,(z<<1)+(U?1:0),G,16*j,16*R,256*N,256*V)}function nC(g,c,d){g.emplaceBack(c,d)}function rC(g,c,d,_,A,x,T){g.emplaceBack(c,d,_,A,x,T)}function iC(g,c,d,_,A){g.emplaceBack(c,d,_,A),g.emplaceBack(c,d,_,A),g.emplaceBack(c,d,_,A),g.emplaceBack(c,d,_,A)}function Nfe(g){for(const c of g.sections)if(zx(c.text))return!0;return!1}class yk{constructor(c){this.layoutVertexArray=new l_,this.indexArray=new wa,this.programConfigurations=c,this.segments=new ws,this.dynamicLayoutVertexArray=new Ll,this.opacityVertexArray=new Hg,this.placedSymbolArray=new Xg,this.iconTransitioningVertexArray=new Tu,this.globeExtVertexArray=new Wc,this.zOffsetVertexArray=new kd}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(c,d,_,A,x){this.isEmpty()||(_&&(this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,tfe.members),this.indexBuffer=c.createIndexBuffer(this.indexArray,d),this.dynamicLayoutVertexBuffer=c.createVertexBuffer(this.dynamicLayoutVertexArray,rfe.members,!0),this.opacityVertexBuffer=c.createVertexBuffer(this.opacityVertexArray,Ffe,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=c.createVertexBuffer(this.iconTransitioningVertexArray,sfe.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=c.createVertexBuffer(this.globeExtVertexArray,nfe.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||x)&&(this.zOffsetVertexBuffer=c.createVertexBuffer(this.zOffsetVertexArray,ife.members,!0)),this.opacityVertexBuffer.itemSize=1),(_||A)&&this.programConfigurations.upload(c))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Fn(yk,"SymbolBuffers");class xk{constructor(c,d,_){this.layoutVertexArray=new c,this.layoutAttributes=d,this.indexArray=new _,this.segments=new ws,this.collisionVertexArray=new vf,this.collisionVertexArrayExt=new Ll}upload(c){this.layoutVertexBuffer=c.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=c.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=c.createVertexBuffer(this.collisionVertexArray,afe.members,!0),this.collisionVertexBufferExt=c.createVertexBuffer(this.collisionVertexArrayExt,ofe.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Fn(xk,"CollisionBuffers");class sC{constructor(c){this.collisionBoxArray=c.collisionBoxArray,this.zoom=c.zoom,this.lut=c.lut,this.overscaling=c.overscaling,this.layers=c.layers,this.layerIds=this.layers.map(T=>T.fqid),this.index=c.index,this.pixelRatio=c.pixelRatio,this.sourceLayerIndex=c.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Le.mat4.identity([]),this.placementViewportMatrix=Le.mat4.identity([]);const d=this.layers[0]._unevaluatedLayout._values;this.textSizeData=lk(this.zoom,d["text-size"]),this.iconSizeData=lk(this.zoom,d["icon-size"]);const _=this.layers[0].layout,A=_.get("symbol-sort-key"),x=_.get("symbol-z-order");this.canOverlap=_.get("text-allow-overlap")||_.get("icon-allow-overlap")||_.get("text-ignore-placement")||_.get("icon-ignore-placement"),this.sortFeaturesByKey=x!=="viewport-y"&&A.constantOr(1)!==void 0,this.sortFeaturesByY=(x==="viewport-y"||x==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=_.get("text-writing-mode").map(T=>Eu[T]),this.stateDependentLayerIds=this.layers.filter(T=>T.isStateDependent()).map(T=>T.id),this.sourceID=c.sourceID,this.projection=c.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=_.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new yk(new rr(this.layers,{zoom:this.zoom,lut:this.lut},c=>c.startsWith("text")||c.startsWith("symbol"))),this.icon=new yk(new rr(this.layers,{zoom:this.zoom,lut:this.lut},c=>c.startsWith("icon")||c.startsWith("symbol"))),this.glyphOffsetArray=new qg,this.lineVertexArray=new Zg,this.symbolInstances=new tl}calculateGlyphDependencies(c,d,_,A,x){for(let T=0;T<c.length;T++){const B=c.codePointAt(T);if(B===void 0)break;if(d[B]=!0,A&&x&&B<=65535){const U=tS[c.charAt(T)];U&&(d[U.charCodeAt(0)]=!0)}}}updateFootprints(c,d){}updateReplacement(c,d){if(d.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=d.updateTime;const _=d.getReplacementRegionsForTile(c.toUnwrapped(),!0);return!nk(this.activeReplacements,_)&&(this.activeReplacements=_,!0)}populate(c,d,_,A){const x=this.layers[0],T=x.layout,B=this.projection.name==="globe",U=T.get("text-font"),j=T.get("text-field"),R=T.get("icon-image"),N=(j.value.kind!=="constant"||j.value.value instanceof La&&!j.value.value.isEmpty()||j.value.value.toString().length>0)&&(U.value.kind!=="constant"||U.value.value.length>0),V=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,z=T.get("symbol-sort-key");if(this.features=[],!N&&!V)return;const G=d.iconDependencies,$=d.glyphDependencies,K=d.availableImages,te=new ds(this.zoom);for(const{feature:ce,id:he,index:ne,sourceLayerIndex:de}of c){const ge=x._featureFilter.needGeometry,Me=pn(ce,ge);if(!x._featureFilter.filter(te,Me,_))continue;if(ge||(Me.geometry=fn(ce,_,A)),B&&ce.type!==1&&_.z<=5){const Ye=Me.geometry,ze=.98078528056,Qe=(ct,ht)=>{const ft=jw(ct.x,ct.y,_,1),mt=jw(ht.x,ht.y,_,1);return Le.vec3.dot(ft,mt)<ze};for(let ct=0;ct<Ye.length;ct++)Ye[ct]=hn(Ye[ct],Qe)}let Be,Oe;if(N){const Ye=x.getValueAndResolveTokens("text-field",Me,_,K),ze=La.factory(Ye);Nfe(ze)&&(this.hasRTLText=!0),(!this.hasRTLText||zg()==="unavailable"||this.hasRTLText&&No.isParsed())&&(Be=ufe(ze,x,Me))}if(V){const Ye=x.getValueAndResolveTokens("icon-image",Me,_,K);Oe=Ye instanceof qa?Ye:qa.fromString(Ye)}if(!Be&&!Oe)continue;const Pe=this.sortFeaturesByKey?z.evaluate(Me,{},_):void 0;if(this.features.push({id:he,text:Be,icon:Oe,index:ne,sourceLayerIndex:de,geometry:Me.geometry,properties:ce.properties,type:Ofe[ce.type],sortKey:Pe}),Oe&&(G[Oe.namePrimary]=!0,Oe.nameSecondary&&(G[Oe.nameSecondary]=!0)),Be){const Ye=U.evaluate(Me,{},_).join(","),ze=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Eu.vertical)>=0;for(const Qe of Be.sections)if(Qe.image)G[Qe.image.namePrimary]=!0;else{const ct=Hc(Be.toString()),ht=Qe.fontStack||Ye,ft=$[ht]=$[ht]||{};this.calculateGlyphDependencies(Qe.text,ft,ze,this.allowVerticalPlacement,ct)}}}T.get("symbol-placement")==="line"&&(this.features=function(ce){const he={},ne={},de=[];let ge=0;function Me(Ye){de.push(ce[Ye]),ge++}function Be(Ye,ze,Qe){const ct=ne[Ye];return delete ne[Ye],ne[ze]=ct,de[ct].geometry[0].pop(),de[ct].geometry[0]=de[ct].geometry[0].concat(Qe[0]),ct}function Oe(Ye,ze,Qe){const ct=he[ze];return delete he[ze],he[Ye]=ct,de[ct].geometry[0].shift(),de[ct].geometry[0]=Qe[0].concat(de[ct].geometry[0]),ct}function Pe(Ye,ze,Qe){const ct=Qe?ze[0][ze[0].length-1]:ze[0][0];return`${Ye}:${ct.x}:${ct.y}`}for(let Ye=0;Ye<ce.length;Ye++){const ze=ce[Ye],Qe=ze.geometry,ct=ze.text?ze.text.toString():null;if(!ct){Me(Ye);continue}const ht=Pe(ct,Qe),ft=Pe(ct,Qe,!0);if(ht in ne&&ft in he&&ne[ht]!==he[ft]){const mt=Oe(ht,ft,Qe),Ct=Be(ht,ft,de[mt].geometry);delete he[ht],delete ne[ft],ne[Pe(ct,de[Ct].geometry,!0)]=Ct,de[mt].geometry=null}else ht in ne?Be(ht,ft,Qe):ft in he?Oe(ht,ft,Qe):(Me(Ye),he[ht]=ge-1,ne[ft]=ge-1)}return de.filter(Ye=>Ye.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ce,he)=>ce.sortKey-he.sortKey)}update(c,d,_,A,x){const T=Object.keys(c).length!==0;if(T&&!this.stateDependentLayers.length)return;const B=T?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(c,d,B,_,A,x),this.icon.programConfigurations.updatePaintArrays(c,d,B,_,A,x)}updateZOffset(){const c=(x,T,B)=>{_+=T,_>x.length&&x.resize(_);for(let U=-T;U<0;U++)x.emplace(U+_,B)},d=(x,T,B)=>{A+=T,A>x.length&&x.resize(A);for(let U=-T;U<0;U++)x.emplace(U+A,B)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let _=0,A=0;for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x),{numHorizontalGlyphVertices:B,numVerticalGlyphVertices:U,numIconVertices:j}=T,R=T.zOffset,N=j>0;if((B>0||U>0)&&(c(this.text.zOffsetVertexArray,B,R),c(this.text.zOffsetVertexArray,U,R)),N){const{placedIconSymbolIndex:V,verticalPlacedIconSymbolIndex:z}=T;V>=0&&d(this.icon.zOffsetVertexArray,j,R),z>=0&&d(this.icon.zOffsetVertexArray,T.numVerticalIconVertices,R)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(c){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(c),this.iconCollisionBox.upload(c)),this.text.upload(c,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(c,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=qH(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(c,d){const _=this.lineVertexArray.length;if(c.segment!==void 0)for(const{x:A,y:x}of d)this.lineVertexArray.emplaceBack(A,x);return{lineStartIndex:_,lineLength:this.lineVertexArray.length-_}}addSymbols(c,d,_,A,x,T,B,U,j,R,N,V,z,G,$,K){const te=c.indexArray,ce=c.layoutVertexArray,he=c.globeExtVertexArray,ne=c.segments.prepareSegment(4*d.length,ce,te,this.canOverlap?T.sortKey:void 0),de=this.glyphOffsetArray.length,ge=ne.vertexLength,Me=this.allowVerticalPlacement&&B===Eu.vertical?Math.PI/2:0,Be=T.text&&T.text.sections;for(let Pe=0;Pe<d.length;Pe++){const{tl:Ye,tr:ze,bl:Qe,br:ct,texPrimary:ht,texSecondary:ft,pixelOffsetTL:mt,pixelOffsetBR:Ct,minFontScaleX:_t,minFontScaleY:Ut,glyphOffset:Yt,isSDF:Dt,sectionIndex:Rn}=d[Pe],bn=ne.vertexLength,dn=Yt[1];if(tC(ce,j.x,j.y,Ye.x,dn+Ye.y,ht.x,ht.y,_,Dt,mt.x,mt.y,_t,Ut),tC(ce,j.x,j.y,ze.x,dn+ze.y,ht.x+ht.w,ht.y,_,Dt,Ct.x,mt.y,_t,Ut),tC(ce,j.x,j.y,Qe.x,dn+Qe.y,ht.x,ht.y+ht.h,_,Dt,mt.x,Ct.y,_t,Ut),tC(ce,j.x,j.y,ct.x,dn+ct.y,ht.x+ht.w,ht.y+ht.h,_,Dt,Ct.x,Ct.y,_t,Ut),U){const{x:tn,y:nr,z:In}=U.anchor,[Nn,wr,Or]=U.up;rC(he,tn,nr,In,Nn,wr,Or),rC(he,tn,nr,In,Nn,wr,Or),rC(he,tn,nr,In,Nn,wr,Or),rC(he,tn,nr,In,Nn,wr,Or),iC(c.dynamicLayoutVertexArray,tn,nr,In,Me)}else iC(c.dynamicLayoutVertexArray,j.x,j.y,j.z,Me);if(K){const tn=ft||ht;nC(c.iconTransitioningVertexArray,tn.x,tn.y),nC(c.iconTransitioningVertexArray,tn.x+tn.w,tn.y),nC(c.iconTransitioningVertexArray,tn.x,tn.y+tn.h),nC(c.iconTransitioningVertexArray,tn.x+tn.w,tn.y+tn.h)}te.emplaceBack(bn,bn+1,bn+2),te.emplaceBack(bn+1,bn+2,bn+3),ne.vertexLength+=4,ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Yt[0]),Pe!==d.length-1&&Rn===d[Pe+1].sectionIndex||c.programConfigurations.populatePaintArrays(ce.length,T,T.index,{},z,G,$,Be&&Be[Rn])}const Oe=U?U.anchor:j;c.placedSymbolArray.emplaceBack(Oe.x,Oe.y,Oe.z,j.x,j.y,de,this.glyphOffsetArray.length-de,ge,R,N,j.segment,_?_[0]:0,_?_[1]:0,A[0],A[1],B,0,!1,0,V,0)}_commitLayoutVertex(c,d,_,A,x,T,B){c.emplaceBack(d,_,A,x,T,Math.round(B.x),Math.round(B.y))}_addCollisionDebugVertices(c,d,_,A,x,T,B){const U=_.segments.prepareSegment(4,_.layoutVertexArray,_.indexArray),j=U.vertexLength,R=B.tileAnchorX,N=B.tileAnchorY;for(let z=0;z<4;z++)_.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(_.collisionVertexArrayExt,d,c.padding,B.zOffset),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x1,c.y1)),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x2,c.y1)),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x2,c.y2)),this._commitLayoutVertex(_.layoutVertexArray,A,x,T,R,N,new St(c.x1,c.y2)),U.vertexLength+=4;const V=_.indexArray;V.emplaceBack(j,j+1),V.emplaceBack(j+1,j+2),V.emplaceBack(j+2,j+3),V.emplaceBack(j+3,j),U.primitiveLength+=4}_addTextDebugCollisionBoxes(c,d,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceTextSize(c,T,d,B);this._addCollisionDebugVertices(U,j,this.textCollisionBox,U.projectedAnchorX,U.projectedAnchorY,U.projectedAnchorZ,T)}}_addIconDebugCollisionBoxes(c,d,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceIconSize(c,d,T.placedIconSymbolIndex);this._addCollisionDebugVertices(U,j,this.iconCollisionBox,U.projectedAnchorX,U.projectedAnchorY,U.projectedAnchorZ,T)}}generateCollisionDebugBuffers(c,d){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xk(pl,gH.members,Tu),this.iconCollisionBox=new xk(pl,gH.members,Tu);const _=Zx(this.iconSizeData,c),A=Zx(this.textSizeData,c);for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(A,c,d,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(A,c,d,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(_,c,d,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(_,c,d,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(c,d,_,A){const x=this.text.placedSymbolArray.get(d.rightJustifiedTextSymbolIndex>=0?d.rightJustifiedTextSymbolIndex:d.centerJustifiedTextSymbolIndex>=0?d.centerJustifiedTextSymbolIndex:d.leftJustifiedTextSymbolIndex>=0?d.leftJustifiedTextSymbolIndex:d.verticalPlacedTextSymbolIndex>=0?d.verticalPlacedTextSymbolIndex:A),T=$E(this.textSizeData,c,x)/zo;return this.tilePixelRatio*T}getSymbolInstanceIconSize(c,d,_){const A=this.icon.placedSymbolArray.get(_),x=$E(this.iconSizeData,c,A);return this.tilePixelRatio*x}_commitDebugCollisionVertexUpdate(c,d,_,A){c.emplaceBack(d,-_,-_,A),c.emplaceBack(d,_,-_,A),c.emplaceBack(d,_,_,A),c.emplaceBack(d,-_,_,A)}_updateTextDebugCollisionBoxes(c,d,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceTextSize(c,T,d,B);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,j,U.padding,T.zOffset)}}_updateIconDebugCollisionBoxes(c,d,_,A,x,T){for(let B=A;B<x;B++){const U=_.get(B),j=this.getSymbolInstanceIconSize(c,d,T.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,j,U.padding,T.zOffset)}}updateCollisionDebugBuffers(c,d){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const _=Zx(this.iconSizeData,c),A=Zx(this.textSizeData,c);for(let x=0;x<this.symbolInstances.length;x++){const T=this.symbolInstances.get(x);this._updateTextDebugCollisionBoxes(A,c,d,T.textBoxStartIndex,T.textBoxEndIndex,T),this._updateTextDebugCollisionBoxes(A,c,d,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._updateIconDebugCollisionBoxes(_,c,d,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._updateIconDebugCollisionBoxes(_,c,d,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(c,d,_,A,x,T,B,U,j){const R={};if(d<_){const{x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(d);R.textBox={x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.textFeatureIndex=de}if(A<x){const{x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(A);R.verticalTextBox={x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.verticalTextFeatureIndex=de}if(T<B){const{x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(T);R.iconBox={x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.iconFeatureIndex=de}if(U<j){const{x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne,featureIndex:de}=c.get(U);R.verticalIconBox={x1:N,y1:V,x2:z,y2:G,padding:$,projectedAnchorX:K,projectedAnchorY:te,projectedAnchorZ:ce,tileAnchorX:he,tileAnchorY:ne},R.verticalIconFeatureIndex=de}return R}deserializeCollisionBoxes(c){this.collisionArrays=[];for(let d=0;d<this.symbolInstances.length;d++){const _=this.symbolInstances.get(d);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(c,_.textBoxStartIndex,_.textBoxEndIndex,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_.iconBoxStartIndex,_.iconBoxEndIndex,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(c,d){const _=c.placedSymbolArray.get(d),A=_.vertexStartIndex+4*_.numGlyphs;for(let x=_.vertexStartIndex;x<A;x+=4)c.indexArray.emplaceBack(x,x+1,x+2),c.indexArray.emplaceBack(x+1,x+2,x+3)}getSortedSymbolIndexes(c){if(this.sortedAngle===c&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const d=Math.sin(c),_=Math.cos(c),A=[],x=[],T=[];for(let B=0;B<this.symbolInstances.length;++B){T.push(B);const U=this.symbolInstances.get(B);A.push(0|Math.round(d*U.tileAnchorX+_*U.tileAnchorY)),x.push(U.featureIndex)}return T.sort((B,U)=>A[B]-A[U]||x[U]-x[B]),T}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let c=0;c<this.symbolInstances.length;++c)this.symbolInstanceIndexesSortedZOffset.push(c)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((c,d)=>this.symbolInstances.get(d).zOffset-this.symbolInstances.get(c).zOffset)}addToSortKeyRanges(c,d){const _=this.sortKeyRanges[this.sortKeyRanges.length-1];_&&_.sortKey===d?_.symbolInstanceEnd=c+1:this.sortKeyRanges.push({sortKey:d,symbolInstanceStart:c,symbolInstanceEnd:c+1})}sortFeatures(c){if(this.sortFeaturesByY&&this.sortedAngle!==c&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(c),this.sortedAngle=c,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const d of this.symbolInstanceIndexes){const _=this.symbolInstances.get(d);this.featureSortOrder.push(_.featureIndex);const{rightJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:x,leftJustifiedTextSymbolIndex:T,verticalPlacedTextSymbolIndex:B,placedIconSymbolIndex:U,verticalPlacedIconSymbolIndex:j}=_;A>=0&&this.addIndicesForPlacedSymbol(this.text,A),x>=0&&x!==A&&this.addIndicesForPlacedSymbol(this.text,x),T>=0&&T!==x&&T!==A&&this.addIndicesForPlacedSymbol(this.text,T),B>=0&&this.addIndicesForPlacedSymbol(this.text,B),U>=0&&this.addIndicesForPlacedSymbol(this.icon,U),j>=0&&this.addIndicesForPlacedSymbol(this.icon,j)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let ZH,YH,bk;Fn(sC,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),sC.addDynamicAttributes=iC;class KH{constructor(c){this.type=c.property.overrides?c.property.overrides.runtimeType:ec,this.defaultValue=c}evaluate(c){if(c.formattedSection){const d=this.defaultValue.property.overrides;if(d&&d.hasOverride(c.formattedSection))return d.getOverride(c.formattedSection)}return c.feature&&c.featureState?this.defaultValue.evaluate(c.feature,c.featureState):this.defaultValue.property.specification.default}eachChild(c){this.defaultValue.isConstant()||c(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Fn(KH,"FormatSectionOverride",{omit:["defaultValue"]});const wk=()=>bk||(bk={layout:ZH||(ZH=new Wi({"symbol-placement":new gn(At.layout_symbol["symbol-placement"]),"symbol-spacing":new gn(At.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new gn(At.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Kn(At.layout_symbol["symbol-sort-key"]),"symbol-z-order":new gn(At.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new gn(At.layout_symbol["symbol-z-elevate"]),"icon-allow-overlap":new gn(At.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new gn(At.layout_symbol["icon-ignore-placement"]),"icon-optional":new gn(At.layout_symbol["icon-optional"]),"icon-rotation-alignment":new gn(At.layout_symbol["icon-rotation-alignment"]),"icon-size":new Kn(At.layout_symbol["icon-size"]),"icon-text-fit":new Kn(At.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Kn(At.layout_symbol["icon-text-fit-padding"]),"icon-image":new Kn(At.layout_symbol["icon-image"]),"icon-rotate":new Kn(At.layout_symbol["icon-rotate"]),"icon-padding":new gn(At.layout_symbol["icon-padding"]),"icon-keep-upright":new gn(At.layout_symbol["icon-keep-upright"]),"icon-offset":new Kn(At.layout_symbol["icon-offset"]),"icon-anchor":new Kn(At.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new gn(At.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new gn(At.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new gn(At.layout_symbol["text-rotation-alignment"]),"text-field":new Kn(At.layout_symbol["text-field"]),"text-font":new Kn(At.layout_symbol["text-font"]),"text-size":new Kn(At.layout_symbol["text-size"]),"text-max-width":new Kn(At.layout_symbol["text-max-width"]),"text-line-height":new Kn(At.layout_symbol["text-line-height"]),"text-letter-spacing":new Kn(At.layout_symbol["text-letter-spacing"]),"text-justify":new Kn(At.layout_symbol["text-justify"]),"text-radial-offset":new Kn(At.layout_symbol["text-radial-offset"]),"text-variable-anchor":new gn(At.layout_symbol["text-variable-anchor"]),"text-anchor":new Kn(At.layout_symbol["text-anchor"]),"text-max-angle":new gn(At.layout_symbol["text-max-angle"]),"text-writing-mode":new gn(At.layout_symbol["text-writing-mode"]),"text-rotate":new Kn(At.layout_symbol["text-rotate"]),"text-padding":new gn(At.layout_symbol["text-padding"]),"text-keep-upright":new gn(At.layout_symbol["text-keep-upright"]),"text-transform":new Kn(At.layout_symbol["text-transform"]),"text-offset":new Kn(At.layout_symbol["text-offset"]),"text-allow-overlap":new gn(At.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new gn(At.layout_symbol["text-ignore-placement"]),"text-optional":new gn(At.layout_symbol["text-optional"]),visibility:new gn(At.layout_symbol.visibility)})),paint:YH||(YH=new Wi({"icon-opacity":new Kn(At.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Kn(At.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Kn(At.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Kn(At.paint_symbol["text-emissive-strength"]),"icon-color":new Kn(At.paint_symbol["icon-color"]),"icon-halo-color":new Kn(At.paint_symbol["icon-halo-color"]),"icon-halo-width":new Kn(At.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Kn(At.paint_symbol["icon-halo-blur"]),"icon-translate":new gn(At.paint_symbol["icon-translate"]),"icon-translate-anchor":new gn(At.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Kn(At.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Kn(At.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Kn(At.paint_symbol["text-occlusion-opacity"]),"text-color":new Kn(At.paint_symbol["text-color"],{runtimeType:Gs,getOverride:g=>g.textColor,hasOverride:g=>!!g.textColor}),"text-halo-color":new Kn(At.paint_symbol["text-halo-color"]),"text-halo-width":new Kn(At.paint_symbol["text-halo-width"]),"text-halo-blur":new Kn(At.paint_symbol["text-halo-blur"]),"text-translate":new gn(At.paint_symbol["text-translate"]),"text-translate-anchor":new gn(At.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new gn(At.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new gn(At.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new gn(At.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new gn(At.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Kn(At.paint_symbol["symbol-z-offset"]),"symbol-elevation-reference":new gn(At.paint_symbol["symbol-elevation-reference"])}))},bk);class aC extends js{constructor(c,d,_,A){super(c,wk(),d,_,A),this._colorAdjustmentMatrix=Le.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=c.paint!==void 0&&("icon-occlusion-opacity"in c.paint||"text-occlusion-opacity"in c.paint)}recalculate(c,d){super.recalculate(c,d),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const _=this.layout.get("text-writing-mode");if(_){const A=[];for(const x of _)A.indexOf(x)<0&&A.push(x);this.layout._values["text-writing-mode"]=A}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(c,d,_,A){return this._saturation===c&&this._contrast===d&&this._brightnessMin===_&&this._brightnessMax===A||(this._colorAdjustmentMatrix=function(x,T,B,U){x=Xe(x),T=Ce(T);const j=Le.mat4.create(),R=x/3,N=1-2*R,V=[N,R,R,0,R,N,R,0,R,R,N,0,0,0,0,1],z=.5-.5*T,G=U-B;return Le.mat4.multiply(j,[G,0,0,0,0,G,0,0,0,0,G,0,B,B,B,1],[T,0,0,0,0,T,0,0,0,0,T,0,z,z,z,1]),Le.mat4.multiply(j,j,V),j}(c,d,_,A),this._saturation=c,this._contrast=d,this._brightnessMin=_,this._brightnessMax=A),this._colorAdjustmentMatrix}getValueAndResolveTokens(c,d,_,A){const x=this.layout.get(c).evaluate(d,{},_,A),T=this._unevaluatedLayout._values[c];return T.isDataDriven()||Sd(T.value)||!x?x:function(B,U){return U.replace(/{([^{}]+)}/g,(j,R)=>R in B?String(B[R]):"")}(d.properties,x)}createBucket(c){return new sC(c)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const c of wk().paint.overridableProperties){if(!aC.hasPaintOverride(this.layout,c))continue;const d=this.paint.get(c),_=new KH(d),A=new Yp(_,d.property.specification,this.scope,this.options);let x=null;x=d.value.kind==="constant"||d.value.kind==="source"?new Og("source",A):new dl("composite",A,d.value.zoomStops,d.value._interpolationType),this.paint._values[c]=new eh(d.property,x,d.parameters)}}_handleOverridablePaintPropertyUpdate(c,d,_){return!(!this.layout||d.isDataDriven()||_.isDataDriven())&&aC.hasPaintOverride(this.layout,c)}static hasPaintOverride(c,d){const _=c.get("text-field"),A=wk().paint.properties[d];let x=!1;const T=B=>{for(const U of B)if(A.overrides&&A.overrides.hasOverride(U))return void(x=!0)};if(_.value.kind==="constant"&&_.value.value instanceof La)T(_.value.value.sections);else if(_.value.kind==="source"){const B=j=>{x||(j instanceof ul&&Bs(j.value)===qo?T(j.value.sections):j instanceof Do?T(j.sections):j.eachChild(B))},U=_.value;U._styleExpression&&B(U._styleExpression.expression)}return x}getProgramIds(){return["symbol"]}getDefaultProgramParams(c,d,_){return{config:new an(this,{zoom:d,lut:_}),overrideFog:!1}}}let JH,QH,e9,t9;var Sk=Qr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Ak(g){switch(g){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Tk(g){switch(g){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class Mk{constructor(c,d,_,A){this.context=c,this.format=_,this.useMipmap=A&&A.useMipmap,this.texture=c.gl.createTexture(),this.update(d,{premultiply:A&&A.premultiply})}update(c,d){const _=c&&c instanceof HTMLVideoElement&&c.width===0?c.videoWidth:c.width,A=c&&c instanceof HTMLVideoElement&&c.height===0?c.videoHeight:c.height,{context:x}=this,{gl:T}=x,{x:B,y:U}=d&&d.position?d.position:{x:0,y:0},j=Math.max(B+_,this.size?this.size[0]:0),R=Math.max(U+A,this.size?this.size[1]:0);!this.size||this.size[0]===j&&this.size[1]===R||(T.bindTexture(T.TEXTURE_2D,null),T.deleteTexture(this.texture),this.texture=T.createTexture(),this.size=null),T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA8&&(!d||d.premultiply!==!1));const N=c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||ImageBitmap&&c instanceof ImageBitmap;if(!this.size&&j>0&&R>0){const V=this.useMipmap?Math.floor(Math.log2(Math.max(j,R)))+1:1;T.texStorage2D(T.TEXTURE_2D,V,this.format,j,R),this.size=[j,R]}if(this.size)if(N)T.texSubImage2D(T.TEXTURE_2D,0,B,U,Ak(this.format),Tk(this.format),c);else{const V=c.data;V&&T.texSubImage2D(T.TEXTURE_2D,0,B,U,_,A,Ak(this.format),Tk(this.format),V)}this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(c,d,_=!1){const{context:A}=this,{gl:x}=A;x.bindTexture(x.TEXTURE_2D,this.texture),c!==this.minFilter&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,c),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,this.useMipmap&&!_?c===x.NEAREST?x.NEAREST_MIPMAP_NEAREST:x.LINEAR_MIPMAP_LINEAR:c),this.minFilter=c),d!==this.wrapS&&(x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,d),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,d),this.wrapS=d)}bindExtraParam(c,d,_,A){const{context:x}=this,{gl:T}=x;T.bindTexture(T.TEXTURE_2D,this.texture),d!==this.magFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,d),this.magFilter=d),c!==this.minFilter&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,this.useMipmap?c===T.NEAREST?T.NEAREST_MIPMAP_NEAREST:T.LINEAR_MIPMAP_LINEAR:c),this.minFilter=c),_!==this.wrapS&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,_),this.wrapS=_),A!==this.wrapT&&(T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,A),this.wrapT=A)}destroy(){const{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}class oC{constructor(c,d){this.context=c,this.texture=d}bind(c,d){const{context:_}=this,{gl:A}=_;A.bindTexture(A.TEXTURE_2D,this.texture),c!==this.minFilter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,c),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,c),this.minFilter=c),d!==this.wrapS&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,d),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,d),this.wrapS=d)}}function lC(g,c,d,_,A,x,T,B){const U=[g,c,1,d,_,1,A,x,1],j=[T,B,1],R=Le.mat3.adjoint([],U),[N,V,z]=Le.vec3.transformMat3(j,j,R);return Le.mat3.multiply(U,U,[N,0,0,0,V,0,0,0,z])}function n9(g,c,d,_,A,x,T,B){const U=function(j,R,N,V,z,G,$,K){const te=lC(0,0,1,0,1,1,0,1),ce=lC(j,R,N,V,z,G,$,K),he=Le.mat3.adjoint([],te);return Le.mat3.multiply(ce,ce,he)}(g,c,d,_,A,x,T,B);return[U[2]/U[8]/yn,U[5]/U[8]/yn]}function cC(g){return[g[0],Math.min(Math.max(g[1],-Ke),Ke)]}class r9 extends ju{constructor(c,d,_,A){super(),this.id=c,this.dispatcher=_,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(A),this.options=d,this._dirty=!1}load(c,d){if(this._loaded=d||!1,this.fire(new Ql("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return c&&(this.coordinates=c),this._loaded=!0,void this._finishLoading();this._imageRequest=Ts(this.map._requestManager.transformRequest(this.url,Yi.Image),(_,A)=>{this._imageRequest=null,this._loaded=!0,_?this.fire(new Cp(_)):A&&(this.image=A instanceof HTMLImageElement?En.getImageData(A):A,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,c&&(this.coordinates=c),this._finishLoading())})}loaded(){return this._loaded}updateImage(c){return c.url?(this._imageRequest&&c.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=c.url,this.load(c.coordinates,this._loaded),this):this}setTexture(c){if(!(c.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new oC(this.map.painter.context,c.handle),this.width=c.dimensions[0],this.height=c.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ql("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(c){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof oC||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(c){if(this.coordinates=c,this._boundsArray=void 0,this._unsupportedCoords=!1,!c.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let d=c[0][1],_=c[0][1];for(const x of c)x[1]>_&&(_=x[1]),x[1]<d&&(d=x[1]);const A=(_+d)/2;if(A>Ke?this.onNorthPole=!0:A<-Ke&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const x=c.map(bt.fromLngLat);this.tileID=function(T){let B=1/0,U=1/0,j=-1/0,R=-1/0;for(const $ of T)B=Math.min(B,$.x),U=Math.min(U,$.y),j=Math.max(j,$.x),R=Math.max(R,$.y);const N=Math.max(j-B,R-U),V=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),z=Math.pow(2,V);let G=Math.floor((B+j)/2*z);return G>1&&(G-=1),new Ka(V,G,Math.floor((U+R)/2*z))}(x),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ql("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(c){for(const te in this.tiles){const ce=this.tiles[te];ce.state!=="loaded"&&(ce.state="loaded",ce.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const d=aS(new Ka(0,0,0),this.map.transform.projection),_=[d.projection.project(this.coordinates[0][0],this.coordinates[0][1]),d.projection.project(this.coordinates[1][0],this.coordinates[1][1]),d.projection.project(this.coordinates[2][0],this.coordinates[2][1]),d.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(te){const ce=te[1].x-te[0].x,he=te[1].y-te[0].y,ne=te[2].x-te[1].x,de=te[2].y-te[1].y,ge=te[3].x-te[2].x,Me=te[3].y-te[2].y,Be=te[0].x-te[3].x,Oe=te[0].y-te[3].y,Pe=ce*de-ne*he,Ye=ne*Me-ge*de,ze=ge*Oe-Be*Me,Qe=Be*he-ce*Oe;return Pe>0&&Ye>0&&ze>0&&Qe>0||Pe<0&&Ye<0&&ze<0&&Qe<0}(_))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const A=aS(this.tileID,this.map.transform.projection),[x,T,B,U]=this.coordinates.map(te=>{const ce=A.projection.project(te[0],te[1]);return HH(A,ce)._round()});this.perspectiveTransform=n9(x.x,x.y,T.x,T.y,B.x,B.y,U.x,U.y);const j=this._boundsArray=new Qs;j.emplaceBack(x.x,x.y,0,0),j.emplaceBack(T.x,T.y,yn,0),j.emplaceBack(U.x,U.y,0,yn),j.emplaceBack(B.x,B.y,yn,yn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=c.createVertexBuffer(j,Sk.members),this.boundsSegments=ws.simpleSegment(0,0,4,2);const R=[],N=[cC((V=this.coordinates)[0]),cC(V[1]),cC(V[2]),cC(V[3])];var V;const[z,G,$,K]=function(te){let ce=te[0][0],he=ce,ne=te[0][1],de=ne;for(let ge=1;ge<te.length;ge++)te[ge][0]<ce?ce=te[ge][0]:te[ge][0]>he&&(he=te[ge][0]),te[ge][1]<ne?ne=te[ge][1]:te[ge][1]>de&&(de=te[ge][1]);return[ce,ne,he-ce,de-ne]}(N);{const te=new Qs,[ce,he,ne,de]=function(mt){let Ct=mt[0].x,_t=Ct,Ut=mt[0].y,Yt=Ut;for(let Dt=1;Dt<mt.length;Dt++)mt[Dt].x<Ct?Ct=mt[Dt].x:mt[Dt].x>_t&&(_t=mt[Dt].x),mt[Dt].y<Ut?Ut=mt[Dt].y:mt[Dt].y>Yt&&(Yt=mt[Dt].y);return[Ct,Ut,_t-Ct,Yt-Ut]}(_),ge=mt=>[(mt.x-ce)/ne,(mt.y-he)/de],[Me,Be,Oe,Pe]=_.map(ge),Ye=function(mt,Ct,_t,Ut,Yt,Dt,Rn,bn){const dn=lC(0,0,1,0,1,1,0,1),tn=lC(mt,Ct,_t,Ut,Yt,Dt,Rn,bn),nr=Le.mat3.adjoint([],tn);return Le.mat3.multiply(dn,dn,nr)}(Me[0],Me[1],Be[0],Be[1],Oe[0],Oe[1],Pe[0],Pe[1]);this.elevatedGlobePerspectiveTransform=n9(Me[0],Me[1],Be[0],Be[1],Oe[0],Oe[1],Pe[0],Pe[1]);const ze=(mt,Ct)=>{R.push(mt.lng);const _t=Math.round((mt.lng-z)/$*yn),Ut=Math.round((mt.lat-G)/K*yn),Yt=ge(Ct),Dt=Le.vec3.transformMat3([],[Yt[0],Yt[1],1],Ye),Rn=Math.round(Dt[0]/Dt[2]*yn),bn=Math.round(Dt[1]/Dt[2]*yn);te.emplaceBack(_t,Ut,Rn,bn)},Qe=_[3].x-_[0].x,ct=_[3].y-_[0].y,ht=_[2].x-_[1].x,ft=_[2].y-_[1].y;for(let mt=0;mt<65;mt++){const Ct=mt/64,_t=[_[0].x+Ct*Qe,_[0].y+Ct*ct],Ut=[_[1].x+Ct*ht,_[1].y+Ct*ft],Yt=Ut[0]-_t[0],Dt=Ut[1]-_t[1];for(let Rn=0;Rn<65;Rn++){const bn=Rn/64,dn={x:_t[0]+Yt*bn,y:_t[1]+Dt*bn,z:0};ze(d.projection.unproject(dn.x,dn.y),dn)}}this.elevatedGlobeVertexBuffer=c.createVertexBuffer(te,Sk.members)}{this.maxLongitudeTriangleSize=0;let te=[],ce=new wa;const he=(ne,de,ge)=>{ce.emplaceBack(ne,de,ge);const Me=R[ne],Be=R[de],Oe=R[ge],Pe=Math.min(Math.min(Me,Be),Oe),Ye=Math.max(Math.max(Me,Be),Oe)-Pe;Ye>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ye),te.push(Pe+Ye/2)};for(let ne=0;ne<64;ne++)for(let de=0;de<64;de++){const ge=65*ne+de,Me=ge+1,Be=ge+65,Oe=Be+1;he(ge,Be,Me),he(Me,Be,Oe)}[te,ce]=function(ne,de){const ge=Array.from({length:ne.length},(Oe,Pe)=>Pe);ge.sort((Oe,Pe)=>ne[Oe]-ne[Pe]);const Me=[],Be=new wa;for(let Oe=0;Oe<ge.length;Oe++){const Pe=ge[Oe];Me.push(ne[Pe]);const Ye=3*Pe,ze=Ye+1;Be.emplaceBack(de.uint16[Ye],de.uint16[ze],de.uint16[ze+1])}return[Me,Be]}(te,ce),this.elevatedGlobeTrianglesCenterLongitudes=te,this.elevatedGlobeIndexBuffer=c.createIndexBuffer(ce)}this.elevatedGlobeSegments=ws.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,$/yn,0,K/yn,0,0,G,z,0])}prepare(){const c=Object.keys(this.tiles).length!==0;if(this.tileID&&!c)return;const d=this.map.painter.context,_=d.gl;!this._dirty||this.texture instanceof oC||(this.texture?this.texture.update(this.image):(this.texture=new Mk(d,this.image,_.RGBA8),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE)),this._dirty=!1),c&&this._prepareData(d)}loadTile(c,d){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},d(null)):(c.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(c){const d=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!d)return null;const _=this.elevatedGlobeTrianglesCenterLongitudes;let A=(x=c+180)+360*Math.round((_[0]-x)/360);var x;const T=new ws,B=(N,V)=>{T.segments.push({vertexOffset:0,primitiveOffset:N,vertexLength:d.segments[0].vertexLength,primitiveLength:V,sortKey:void 0,vaos:{}})},U=.51*this.maxLongitudeTriangleSize;if(Math.abs(_[0]-A)<=U){const N=xe(_,0,_.length,A+U);return N===_.length||B(N,Tt(_,N+1,_.length,A+360-U)-N),T}A<_[0]&&(A+=360);const j=Tt(_,0,_.length,A-U);if(j===_.length)return B(0,_.length),T;B(0,j-0);const R=xe(_,j+1,_.length,A+U);return R!==_.length&&B(R,_.length-R),T}}const zfe=(Math.pow(256,2)-1)/16907520;class i9 extends js{constructor(c,d,_,A){super(c,{layout:e9||(e9=new Wi({visibility:new gn(At.layout_raster.visibility)})),paint:t9||(t9=new Wi({"raster-opacity":new gn(At.paint_raster["raster-opacity"]),"raster-color":new cc(At.paint_raster["raster-color"]),"raster-color-mix":new gn(At.paint_raster["raster-color-mix"]),"raster-color-range":new gn(At.paint_raster["raster-color-range"]),"raster-hue-rotate":new gn(At.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new gn(At.paint_raster["raster-brightness-min"]),"raster-brightness-max":new gn(At.paint_raster["raster-brightness-max"]),"raster-saturation":new gn(At.paint_raster["raster-saturation"]),"raster-contrast":new gn(At.paint_raster["raster-contrast"]),"raster-resampling":new gn(At.paint_raster["raster-resampling"]),"raster-fade-duration":new gn(At.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new gn(At.paint_raster["raster-emissive-strength"]),"raster-array-band":new gn(At.paint_raster["raster-array-band"]),"raster-elevation":new gn(At.paint_raster["raster-elevation"])}))},d,_,A),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(c){return!(c&&c._source instanceof r9&&(c._source.onNorthPole||c._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(c){c!=="raster-color"&&c!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(c){if(!this.hasColorMap()||!this._curRampRange)return;const d=this._transitionablePaint._values["raster-color"].value.expression,[_,A]=c||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(_)&&isNaN(A)||_===this._curRampRange[0]&&A===this._curRampRange[1]||(this.colorRamp=Ww({expression:d,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:_,end:A}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[_,A])}}let s9,a9,o9,l9,c9;class u9 extends js{constructor(c,d,_,A){super(c,{layout:s9||(s9=new Wi({visibility:new gn(At["layout_raster-particle"].visibility)})),paint:a9||(a9=new Wi({"raster-particle-array-band":new gn(At["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new gn(At["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new cc(At["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new gn(At["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new gn(At["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new gn(At["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new gn(At["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new gn(At["paint_raster-particle"]["raster-particle-elevation"])}))},d,_,A),this._updateColorRamp(),this.lastInvalidatedAt=En.now()}onRemove(c){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(c){return!1}_handleSpecialPaintPropertyUpdate(c){c!=="raster-particle-color"&&c!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),c==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const c=this._transitionablePaint._values["raster-particle-color"].value.expression,d=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Ww({expression:c,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:d}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=En.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class Ufe extends js{constructor(c,d){super(c,{},d,null),this.implementation=c,c.slot&&(this.slot=c.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(c){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(c){this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)}onRemove(c){this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)}}function Ek(g,c,d){const _=[0,0,1],A=Le.quat.identity([]);return Le.quat.rotateY(A,A,d?-sn(g)+Math.PI:sn(g)),Le.quat.rotateX(A,A,-sn(c)),Le.vec3.transformQuat(_,_,A),Le.vec3.normalize(_,_)}function h9(g,c){const d=uC(g.projection,g.zoom,g.width,g.height),_=function(x,T,B,U,j){const R=new ue(B.lng-180*sv,B.lat),N=new ue(B.lng+180*sv,B.lat),V=x.project(R.lng,R.lat),z=x.project(N.lng,N.lat),G=-Math.atan2(z.y-V.y,z.x-V.x),$=bt.fromLngLat(B);$.y=jt($.y,-1+sv,1-sv);const K=$.toLngLat(),te=x.project(K.lng,K.lat),ce=bt.fromLngLat(K);ce.x+=sv;const he=ce.toLngLat(),ne=x.project(he.lng,he.lat),de=d9(ne.x-te.x,ne.y-te.y,G),ge=bt.fromLngLat(K);ge.y+=sv;const Me=ge.toLngLat(),Be=x.project(Me.lng,Me.lat),Oe=d9(Be.x-te.x,Be.y-te.y,G),Pe=Math.abs(de.x)/Math.abs(Oe.y),Ye=Le.mat4.identity([]);Le.mat4.rotateZ(Ye,Ye,-G*(1-(j?0:U)));const ze=Le.mat4.identity([]);return Le.mat4.scale(ze,ze,[1,1-(1-Pe)*U,1]),ze[4]=-Oe.x/Oe.y*U,Le.mat4.rotateZ(ze,ze,G),Le.mat4.multiply(ze,Ye,ze),ze}(g.projection,0,g.center,d,c),A=f9(g);return Le.mat4.scale(_,_,[A,A,1]),_}function f9(g){const c=g.projection,d=uC(g.projection,g.zoom,g.width,g.height),_=Ck(c,g.center),A=Ck(c,ue.convert(c.center));return Math.pow(2,_*d+(1-d)*A)}function uC(g,c,d,_,A=1/0){const x=g.range;if(!x)return 0;const T=Math.min(A,Math.max(d,_)),B=Math.log(T/1024)/Math.LN2;return mr(x[0]+B,x[1]+B,c)}const sv=1/4e4;function Ck(g,c){const d=jt(c.lat,-Ke,Ke),_=new ue(c.lng-180*sv,d),A=new ue(c.lng+180*sv,d),x=g.project(_.lng,d),T=g.project(A.lng,d),B=bt.fromLngLat(_),U=bt.fromLngLat(A),j=T.x-x.x,R=T.y-x.y,N=U.x-B.x,V=U.y-B.y,z=Math.sqrt((N*N+V*V)/(j*j+R*R));return Math.log(z)/Math.LN2}function d9(g,c,d){const _=Math.cos(d),A=Math.sin(d);return{x:g*_-c*A,y:g*A+c*_}}function p9(g,c,d){Le.mat4.identity(g),Le.mat4.rotateZ(g,g,sn(c[2])),Le.mat4.rotateX(g,g,sn(c[0])),Le.mat4.rotateY(g,g,sn(c[1])),Le.mat4.scale(g,g,d),Le.mat4.multiply(g,g,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function hC(g,c,d,_,A,x,T,B){const U=[d[0]-c[0],d[1]-c[1],0],j=[_[0]-c[0],_[1]-c[1],0];if(Le.vec3.length(U)<1e-12||Le.vec3.length(j)<1e-12)return Le.quat.identity(g);const R=Le.vec3.cross([],U,j);Le.vec3.normalize(R,R),Le.vec3.subtract(j,_,c),U[2]=(x-A)*B,j[2]=(T-A)*B;const N=U;return Le.vec3.cross(N,U,j),Le.vec3.normalize(N,N),Le.quat.rotationTo(g,R,N)}function Ik(g,c,d=!1){const _=Qg(c.zoom),A=function(x,T,B){const U=T.worldSize,j=[x[12],x[13],x[14]],R=je(j[1]/U),N=$e(j[0]/U),V=Le.mat4.identity([]),z=De(1,R)*U,G=De(1,0)*U*ut(R,T.zoom),$=1/HB(U);let K=G*$;if(B){const ne=uC(T.projection,T.zoom,T.width,T.height,1024);K=$*T.projection.pixelSpaceConversion(T.center.lat,U,ne)}const te=ee(R,N);Le.vec3.add(te,te,Le.vec3.scale([],Le.vec3.normalize([],te),z*K*j[2]));const ce=function(ne){const de=[ne[0],ne[1],ne[2]];let ge=[0,1,0];const Me=Le.vec3.cross([],ge,de);return Le.vec3.cross(ge,de,Me),Le.vec3.squaredLength(ge)===0&&(ge=[0,1,0],Le.vec3.cross(Me,de,ge)),Le.vec3.normalize(Me,Me),Le.vec3.normalize(ge,ge),Le.vec3.normalize(de,de),[Me[0],Me[1],Me[2],0,ge[0],ge[1],ge[2],0,de[0],de[1],de[2],0,ne[0],ne[1],ne[2],1]}(te);Le.mat4.scale(V,V,[K,K,K*z]),Le.mat4.translate(V,V,[-j[0],-j[1],-j[2]]);const he=Le.mat4.multiply([],T.globeMatrix,ce);return Le.mat4.multiply(he,he,V),Le.mat4.multiply(he,he,x),he}(g,c,d);if(_>0){const x=function(T,B){const U=B.worldSize,j=De(1,0)*U*ut(B.center.lat,B.zoom)/HB(U),R=De(1,B.center.lat)*U,N=Le.mat4.identity([]);return Le.mat4.rotateY(N,N,sn(B.center.lng)),Le.mat4.rotateX(N,N,sn(B.center.lat)),Le.mat4.translate(N,N,[0,0,u]),Le.mat4.scale(N,N,[j,j,j*R]),Le.mat4.translate(N,N,[B.point.x-.5*U,B.point.y-.5*U,0]),Le.mat4.multiply(N,N,T),Le.mat4.multiply(N,B.globeMatrix,N)}(g,c);return function(T,B,U){const j=(G,$,K)=>{const te=Le.vec3.length(G),ce=Le.vec3.length($),he=cm(G,$,K);return Le.vec3.scale(he,he,1/Le.vec3.length(he)*cr(te,ce,K))},R=j([T[0],T[1],T[2]],[B[0],B[1],B[2]],U),N=j([T[4],T[5],T[6]],[B[4],B[5],B[6]],U),V=j([T[8],T[9],T[10]],[B[8],B[9],B[10]],U),z=cm([T[12],T[13],T[14]],[B[12],B[13],B[14]],U);return[R[0],R[1],R[2],0,N[0],N[1],N[2],0,V[0],V[1],V[2],0,z[0],z[1],z[2],1]}(A,x,_)}return A}function m9(g,c,d,_){const A=Ji.projectAabbCorners(_,d);let x=Number.MAX_VALUE,T=-1;for(let j=0;j<A.length;++j){const R=A[j];R[0]=(.5*R[0]+.5)*c.width,R[1]=(.5-.5*R[1])*c.height,R[2]<x&&(T=j,x=R[2])}const B=j=>new St(A[j][0],A[j][1]);let U;switch(T){case 0:case 6:U=[B(1),B(5),B(4),B(7),B(3),B(2),B(1)];break;case 1:case 7:U=[B(0),B(4),B(5),B(6),B(2),B(3),B(0)];break;case 3:case 5:U=[B(1),B(0),B(4),B(7),B(6),B(2),B(1)];break;default:U=[B(1),B(5),B(6),B(7),B(3),B(0),B(1)]}if(xn(g,U))return x}const Gfe=Qr([{name:"a_pos_3f",components:3,type:"Float32"}]),Vfe=Qr([{name:"a_color_3f",components:3,type:"Float32"}]),Hfe=Qr([{name:"a_color_4f",components:4,type:"Float32"}]),jfe=Qr([{name:"a_uv_2f",components:2,type:"Float32"}]),Wfe=Qr([{name:"a_normal_3f",components:3,type:"Float32"}]),$fe=Qr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),Xfe=Qr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),g9={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class fC{constructor(c,d,_,A){this.message=(c?`${c}: `:"")+_,A&&(this.identifier=A),d!=null&&d.__line__&&(this.line=d.__line__)}}function v9(g,c){const d=g.indexOf("://")===-1;try{return new URL(g,d&&c?"http://example.com":void 0),!0}catch{return!1}}class _9{constructor(c,d){this.feature=c,this.instancedDataOffset=d,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class y9{constructor(){this.instancedDataArray=new Od,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Rk{constructor(c){this.zoom=c.zoom,this.canonical=c.canonical,this.layers=c.layers,this.layerIds=this.layers.map(d=>d.fqid),this.projection=c.projection,this.index=c.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(d=>d.isStateDependent()).map(d=>d.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(c,d){}populate(c,d,_,A){this.tileToMeter=rt(_);const x=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:T,id:B,index:U,sourceLayerIndex:j}of c){const R=B??(T.properties&&T.properties.hasOwnProperty("id")?T.properties.id:void 0),N=pn(T,x);if(!this.layers[0]._featureFilter.filter(new ds(this.zoom),N,_))continue;const V={id:R,sourceLayerIndex:j,index:U,geometry:x?N.geometry:fn(T,_,A),properties:T.properties,type:T.type,patterns:{}},z=this.addFeature(V,V.geometry,N);z&&d.featureIndex.insert(T,V.geometry,U,j,this.index,this.instancesPerModel[z].instancedDataArray.length,yn/32)}this.lookup=null}update(c,d,_,A){for(const x in this.instancesPerModel){const T=this.instancesPerModel[x];for(const B in c)T.idToFeaturesIndex.hasOwnProperty(B)&&(this.evaluate(T.features[T.idToFeaturesIndex[B]],c[B],T,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let c=!1;for(const d in this.instancesPerModel){const _=this.instancesPerModel[d];for(const A of _.features){const x=this.layers[0],T=A.feature,B=this.canonical,U=x.paint.get("model-rotation").evaluate(T,{},B),j=x.paint.get("model-scale").evaluate(T,{},B),R=x.paint.get("model-translation").evaluate(T,{},B);Le.vec3.exactEquals(A.rotation,U)&&Le.vec3.exactEquals(A.scale,j)&&Le.vec3.exactEquals(A.translation,R)||(this.evaluate(A,A.featureStates,_,!0),c=!0)}}return c}updateReplacement(c,d,_,A){if(d.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=d.updateTime;const x=d.getReplacementRegionsForTile(c.toUnwrapped(),!0);if(nk(this.activeReplacements,x))return!1;this.activeReplacements=x;let T=!1;for(const B in this.instancesPerModel){const U=this.instancesPerModel[B],j=U.instancedDataArray;for(const R of U.features){const N=R.instancedDataOffset,V=R.instancedDataCount;for(let z=0;z<V;z++){const G=16*(z+N);let $=j.float32[G+0];const K=$>yn;$=K?$-yn:$;const te=Math.floor($),ce=j.float32[G+1];let he=!1;for(const ne of this.activeReplacements)if(!BV(ne,_,g9.Model,A)&&!(ne.min.x>te||te>ne.max.x||ne.min.y>ce||ce>ne.max.y)&&(he=UV(zV(te,ce,c.canonical,ne.footprintTileId.canonical),ne.footprint),he))break;j.float32[G]=he?$+yn:$,T=T||he!==K}}}return T}isEmpty(){for(const c in this.instancesPerModel)if(this.instancesPerModel[c].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(c){if(!this.uploaded)for(const d in this.instancesPerModel){const _=this.instancesPerModel[d];_.instancedDataArray.length<0||_.instancedDataArray.length===0||(_.instancedDataBuffer?_.instancedDataBuffer.updateData(_.instancedDataArray):_.instancedDataBuffer=c.createVertexBuffer(_.instancedDataArray,$fe.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const d in this.instancesPerModel){const _=this.instancesPerModel[d];_.instancedDataArray.length!==0&&_.instancedDataBuffer&&_.instancedDataBuffer.destroy()}const c=this.layers[0].modelManager;if(c&&this.modelUris)for(const d of this.modelUris)c.removeModel(d,"")}addFeature(c,d,_){const A=this.layers[0],x=A.layout.get("model-id").evaluate(_,{},this.canonical);if(!x)return Lt(`modelId is not evaluated for layer ${A.id} and it is not going to get rendered.`),x;v9(x,!1)&&(this.modelUris.includes(x)||this.modelUris.push(x)),this.instancesPerModel[x]||(this.instancesPerModel[x]=new y9);const T=this.instancesPerModel[x],B=T.instancedDataArray,U=new _9(_,B.length);for(const j of d)for(const R of j){if(R.x<0||R.x>=yn||R.y<0||R.y>=yn)continue;const N=(this.lookupDim-1)/yn,V=this.lookupDim*(R.y*N|0)+R.x*N|0;if(this.lookup){if(this.lookup[V]!==0)continue;this.lookup[V]=1}this.instanceCount++;const z=B.length;B.resize(z+1),T.instancesEvaluatedElevation.push(0),B.float32[16*z]=R.x,B.float32[16*z+1]=R.y}return U.instancedDataCount=T.instancedDataArray.length-U.instancedDataOffset,U.instancedDataCount>0&&(c.id&&(T.idToFeaturesIndex[c.id]=T.features.length),T.features.push(U),this.evaluate(U,{},T,!1)),x}getModelUris(){return this.modelUris}evaluate(c,d,_,A){const x=this.layers[0],T=c.feature,B=this.canonical,U=c.rotation=x.paint.get("model-rotation").evaluate(T,d,B),j=c.scale=x.paint.get("model-scale").evaluate(T,d,B),R=c.translation=x.paint.get("model-translation").evaluate(T,d,B),N=x.paint.get("model-color").evaluate(T,d,B);N.a=x.paint.get("model-color-mix-intensity").evaluate(T,d,B);const V=[];this.maxVerticalOffset<R[2]&&(this.maxVerticalOffset=R[2]),this.maxScale=Math.max(Math.max(this.maxScale,j[0]),Math.max(j[1],j[2])),p9(V,U,j);const z=Math.round(100*N.a)+N.b/1.05;for(let G=0;G<c.instancedDataCount;++G){const $=c.instancedDataOffset+G,K=16*$,te=_.instancedDataArray.float32;let ce=0;A&&(ce=te[K+6]-_.instancesEvaluatedElevation[$]);const he=0|te[K+1];te[K]=(0|te[K])+N.r/1.05,te[K+1]=he+N.g/1.05,te[K+2]=z,te[K+3]=1/(B.z>10?this.tileToMeter:rt(B,he)),te[K+4]=R[0],te[K+5]=R[1],te[K+6]=R[2]+ce,te[K+7]=V[0],te[K+8]=V[1],te[K+9]=V[2],te[K+10]=V[4],te[K+11]=V[5],te[K+12]=V[6],te[K+13]=V[8],te[K+14]=V[9],te[K+15]=V[10],_.instancesEvaluatedElevation[$]=R[2]}}}let x9,b9;Fn(Rk,"ModelBucket",{omit:["layers"]}),Fn(y9,"PerModelAttributes"),Fn(_9,"ModelFeature");const m_=64,e1={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function w9(g,c,d,_,A,x,T,B,U,j=!1){const R=d.zoom,N=d.project(_),V=ut(_.lat,R),z=1/V;Le.mat4.identity(g),Le.mat4.translate(g,g,[N.x+T[0]*z,N.y+T[1]*z,T[2]]);let G=1,$=1;const K=d.worldSize;if(j){if(d.projection.name==="mercator"){let ne=0;d.elevation&&(ne=d.elevation.getAtPointOrZero(new bt(N.x/K,N.y/K),0));const de=Le.vec4.transformMat4([],[N.x,N.y,ne,1],d.projMatrix)[3]/d.cameraToCenterDistance;G=de,$=de*ut(d.center.lat,R)}else if(d.projection.name==="globe"){const ne=Ik(g,d),de=Le.mat4.multiply([],d.projMatrix,ne),ge=[0,0,0,1];Le.vec4.transformMat4(ge,ge,de);const Me=ge[3]/d.cameraToCenterDistance,Be=Qg(R),Oe=d.projection.pixelsPerMeter(_.lat,K)*ut(_.lat,R),Pe=d.projection.pixelsPerMeter(d.center.lat,K)*ut(d.center.lat,R);G=Me/cr(Oe,tt(d.center.lat),Be),$=Me*V/Oe,G*=Pe,$*=Pe}}else G=z;Le.mat4.scale(g,g,[G,G,$]);const te=[...g],ce=c.orientation,he=[];if(p9(he,[ce[0]+A[0],ce[1]+A[1],ce[2]+A[2]],x),Le.mat4.multiply(g,te,he),B&&d.elevation){let ne=0;const de=[];if(U&&d.elevation){ne=function(Be,Oe,Pe,Ye,ze){const Qe=Oe.elevation;if(!Qe)return 0;const ct=Ji.projectAabbCorners(Pe,Ye),ht=De(1,ze.lat)*Oe.worldSize,ft=function(nr,In){const Nn=[0,0,1],wr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Or of wr){const Pr=nr[Or.corners[0]],Lr=nr[Or.corners[1]],jr=nr[Or.corners[2]],Wr=[Lr[0]-Pr[0],Lr[1]-Pr[1],In*(Lr[2]-Pr[2])],Gi=Le.vec3.cross(Wr,Wr,[jr[0]-Pr[0],jr[1]-Pr[1],In*(jr[2]-Pr[2])]);Le.vec3.normalize(Gi,Gi),Or.dotProductWithUp=Le.vec3.dot(Gi,Nn)}return wr.sort((Or,Pr)=>Or.dotProductWithUp-Pr.dotProductWithUp),wr[0].corners}(ct,ht),mt=ct[ft[0]],Ct=ct[ft[1]],_t=ct[ft[2]],Ut=ct[ft[3]],Yt=Qe.getAtPointOrZero(new bt(mt[0]/Oe.worldSize,mt[1]/Oe.worldSize),0),Dt=Qe.getAtPointOrZero(new bt(Ct[0]/Oe.worldSize,Ct[1]/Oe.worldSize),0),Rn=Qe.getAtPointOrZero(new bt(_t[0]/Oe.worldSize,_t[1]/Oe.worldSize),0),bn=Qe.getAtPointOrZero(new bt(Ut[0]/Oe.worldSize,Ut[1]/Oe.worldSize),0),dn=(Yt+bn)/2,tn=(Dt+Rn)/2;return dn>tn?Dt<Rn?hC(Be,Ct,Ut,mt,Dt,bn,Yt,ht):hC(Be,_t,mt,Ut,Rn,Yt,bn,ht):Yt<bn?hC(Be,mt,Ct,_t,Yt,Dt,Rn,ht):hC(Be,Ut,_t,Ct,bn,Rn,Dt,ht),Math.max(dn,tn)}(de,d,c.aabb,g,_);const ge=Le.mat4.fromQuat([],de),Me=Le.mat4.multiply([],ge,he);Le.mat4.multiply(g,te,Me)}else ne=d.elevation.getAtPointOrZero(new bt(N.x/K,N.y/K),0);ne!==0&&(g[14]+=ne)}}function hS(g,c,d=!1){g.uploaded||(g.gfxTexture=new Mk(c,g.image,d?c.gl.R8:c.gl.RGBA8,{useMipmap:g.sampler.minFilter>=c.gl.NEAREST_MIPMAP_NEAREST}),g.uploaded=!0,g.image=null)}function qfe(g,c,d){g.indexBuffer=c.createIndexBuffer(g.indexArray,!1,!0),g.vertexBuffer=c.createVertexBuffer(g.vertexArray,Gfe.members,!1,!0),g.normalArray&&(g.normalBuffer=c.createVertexBuffer(g.normalArray,Wfe.members,!1,!0)),g.texcoordArray&&(g.texcoordBuffer=c.createVertexBuffer(g.texcoordArray,jfe.members,!1,!0)),g.colorArray&&(g.colorBuffer=c.createVertexBuffer(g.colorArray,(g.colorArray.bytesPerElement===12?Vfe:Hfe).members,!1,!0)),g.featureArray&&(g.pbrBuffer=c.createVertexBuffer(g.featureArray,Xfe.members,!0)),g.segments=ws.simpleSegment(0,0,g.vertexArray.length,g.indexArray.length);const _=g.material;_.pbrMetallicRoughness.baseColorTexture&&hS(_.pbrMetallicRoughness.baseColorTexture,c),_.pbrMetallicRoughness.metallicRoughnessTexture&&hS(_.pbrMetallicRoughness.metallicRoughnessTexture,c),_.normalTexture&&hS(_.normalTexture,c),_.occlusionTexture&&hS(_.occlusionTexture,c,d),_.emissionTexture&&hS(_.emissionTexture,c)}function Pk(g,c,d){if(g.meshes)for(const _ of g.meshes)qfe(_,c,d);if(g.children)for(const _ of g.children)Pk(_,c,d)}function dC(g){if(g.meshes)for(const c of g.meshes)c.indexArray.destroy(),c.vertexArray.destroy(),c.colorArray&&c.colorArray.destroy(),c.normalArray&&c.normalArray.destroy(),c.texcoordArray&&c.texcoordArray.destroy(),c.featureArray&&c.featureArray.destroy();if(g.children)for(const c of g.children)dC(c)}function Lk(g){if(g.meshes)for(const d of g.meshes)d.vertexBuffer&&(d.vertexBuffer.destroy(),d.indexBuffer.destroy(),d.normalBuffer&&d.normalBuffer.destroy(),d.texcoordBuffer&&d.texcoordBuffer.destroy(),d.colorBuffer&&d.colorBuffer.destroy(),d.pbrBuffer&&d.pbrBuffer.destroy(),d.segments.destroy(),d.material&&((c=d.material).pbrMetallicRoughness.baseColorTexture&&c.pbrMetallicRoughness.baseColorTexture.gfxTexture&&c.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),c.pbrMetallicRoughness.metallicRoughnessTexture&&c.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&c.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),c.normalTexture&&c.normalTexture.gfxTexture&&c.normalTexture.gfxTexture.destroy(),c.emissionTexture&&c.emissionTexture.gfxTexture&&c.emissionTexture.gfxTexture.destroy(),c.occlusionTexture&&c.occlusionTexture.gfxTexture&&c.occlusionTexture.gfxTexture.destroy()));var c;if(g.children)for(const d of g.children)Lk(d)}class t1{constructor(c,d,_){this._demTile=c,this._dem=this._demTile.dem,this._scale=d,this._offset=_}static create(c,d,_){const A=_||c.findDEMTileFor(d);if(!A||!A.dem)return;const x=A.dem,T=A.tileID,B=1<<d.canonical.z-T.canonical.z;return new t1(A,x.dim/yn/B,[(d.canonical.x/B-T.canonical.x)*x.dim,(d.canonical.y/B-T.canonical.y)*x.dim])}tileCoordToPixel(c,d){const _=d*this._scale+this._offset[1],A=Math.floor(c*this._scale+this._offset[0]),x=Math.floor(_);return new St(A,x)}getElevationAt(c,d,_,A){const x=c*this._scale+this._offset[0],T=d*this._scale+this._offset[1],B=Math.floor(x),U=Math.floor(T),j=this._dem;return A=!!A,_?cr(cr(j.get(B,U,A),j.get(B,U+1,A),T-U),cr(j.get(B+1,U,A),j.get(B+1,U+1,A),T-U),x-B):j.get(B,U,A)}getElevationAtPixel(c,d,_){return this._dem.get(c,d,!!_)}getMeterToDEM(c){return(1<<this._demTile.tileID.canonical.z)*De(1,c)*this._dem.stride}}const Dk=new Float32Array(262144),g_=new Uint8Array(262144);function S9(g){let c=0;if(g.meshes)for(const d of g.meshes)c=Math.max(c,d.aabb.max[2]);if(g.children)for(const d of g.children)c=Math.max(c,S9(d));return c}function A9(g,c,d){if(g.meshes)for(const _ of g.meshes)_.aabb.min[0]!==1/0&&d.insert(c,_.aabb.min[0],_.aabb.min[1],_.aabb.max[0],_.aabb.max[1]);if(g.children)for(const _ of g.children)A9(_,c,d)}const T9=["","wall","door","roof","window","lamp","logo"];class M9{constructor(c){this.node=c,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:c.id,geometry:[],properties:{height:S9(c)}},this.aabb=this._getLocalBounds()}_getLocalBounds(){if(!this.node.meshes)return new Ji([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let c=0;const d=new Ji([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const _ of this.node.meshes)this.node.lightMeshIndex!==c&&(_.transformedAabb=Ji.applyTransformFast(_.aabb,this.node.matrix),d.encapsulate(_.transformedAabb)),c++;this.aabb=d}return this.aabb}}class pC{constructor(c,d,_,A,x,T){this.id=d,this.modelTraits|=e1.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,_&&(this.modelTraits|=e1.HasMapboxMeshFeatures),A&&(this.modelTraits|=e1.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=x,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const B of c)this.nodesInfo.push(new M9(B)),A9(B,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0)}updateFootprints(c,d){for(const _ of this.getNodesInfo()){const A=_.node;A.footprint&&d.push({footprint:A.footprint,id:c})}}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(c){if(!this.needsUpload)return;const d=this.getNodesInfo();for(const _ of d){const A=_.node;this.uploaded?this.updatePbrBuffer(A):Pk(A,c,!0)}for(const _ of d)dC(_.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(c){let d=!1;if(!c.meshes)return d;for(const _ of c.meshes)_.pbrBuffer&&(_.pbrBuffer.updateData(_.featureArray),d=!0);return d}needsReEvaluation(c,d,_){const A=c.transform.projectionOptions,x=c.style.getBrightness(),T=this.brightness!==x;return!!(!this.uploaded||this.dirty||A.name!==this.projection.name||fS(_.paint.get("model-color").value,T)||fS(_.paint.get("model-color-mix-intensity").value,T)||fS(_.paint.get("model-roughness").value,T)||fS(_.paint.get("model-emissive-strength").value,T)||fS(_.paint.get("model-height-based-emissive-strength-multiplier").value,T))&&(this.projection=A,this.brightness=x,!0)}evaluateScale(c,d){if(c.transform.zoom===this.zoom)return;this.zoom=c.transform.zoom;const _=this.getNodesInfo(),A=this.id.canonical;for(const x of _){const T=x.feature;x.evaluatedScale=d.paint.get("model-scale").evaluate(T,{},A)}}evaluate(c){const d=this.getNodesInfo();for(const _ of d){if(!_.node.meshes)continue;const A=_.feature,x=_.node.meshes&&_.node.meshes[0].featureData,T=_.evaluatedColor[2],B=_.evaluatedRMEA[2],U=this.id.canonical;if(_.hasTranslucentParts=!1,x){for(let j=0;j<T9.length;j++){const R=T9[j];R.length&&(A.properties.part=R);const N=c.paint.get("model-color").evaluate(A,{},U).toRenderColor(null),V=c.paint.get("model-color-mix-intensity").evaluate(A,{},U);_.evaluatedColor[j]=[N.r,N.g,N.b,V],_.evaluatedRMEA[j][0]=c.paint.get("model-roughness").evaluate(A,{},U),_.evaluatedRMEA[j][2]=c.paint.get("model-emissive-strength").evaluate(A,{},U),_.evaluatedRMEA[j][3]=N.a,_.emissionHeightBasedParams[j]=c.paint.get("model-height-based-emissive-strength-multiplier").evaluate(A,{},U),!_.hasTranslucentParts&&N.a<1&&(_.hasTranslucentParts=!0)}delete A.properties.part,Yfe(_,T!==_.evaluatedColor[2]||B!==_.evaluatedRMEA[2],this.modelTraits)}else _.evaluatedRMEA[0][2]=c.paint.get("model-emissive-strength").evaluate(A,{},U);_.evaluatedScale=c.paint.get("model-scale").evaluate(A,{},U),this.updatePbrBuffer(_.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(c,d,_,A){const x=c.findDEMTileFor(_);if(x&&(x.tileID.canonical!==this.terrainTile||d!==this.terrainExaggeration)){if(x.dem&&x.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=x.tileID.overscaledZ;const T=t1.create(c,_,x);if(!T)return;this.modelTraits&e1.HasMapboxMeshFeatures&&this.updateDEM(c,T,_,A);for(const B of this.getNodesInfo()){const U=B.node;if(!U.footprint||!U.footprint.vertices||!U.footprint.vertices.length)continue;const j=U.footprint.vertices;let R=T.getElevationAt(j[0].x,j[0].y,!0,!0);for(let N=1;N<j.length;N++)R=Math.min(R,T.getElevationAt(j[N].x,j[N].y,!0,!0));U.elevation=R}}this.terrainTile=x.tileID.canonical,this.terrainExaggeration=d}}updateDEM(c,d,_,A){let x=d._dem._modifiedForSources[A];if(x===void 0&&(d._dem._modifiedForSources[A]=[],x=d._dem._modifiedForSources[A]),x.includes(_.canonical))return;const T=d._dem.dim;x.push(_.canonical);let B=!1;for(const U of this.getNodesInfo()){const j=U.node;if(!j.footprint||!j.footprint.grid)continue;const R=j.footprint.grid,N=d.tileCoordToPixel(R.min.x,R.min.y),V=d.tileCoordToPixel(R.max.x,R.max.y),z=Math.min(Math.min(T-V.y,N.x),Math.min(N.y,T-V.x));if(z<0)continue;const G=jt(z,2,5);let $=Math.max(0,N.x-G),K=Math.max(0,N.y-G),te=Math.min(V.x+G,T-1),ce=Math.min(V.y+G,T-1);for(let ge=K;ge<=ce;++ge)for(let Me=$;Me<=te;++Me)g_[ge*T+Me]=255;let he=0,ne=0;for(let ge=0;ge<R.cellsY;++ge)for(let Me=0;Me<R.cellsX;++Me){if(!R.cells[ge*R.cellsX+Me])continue;const Be=d.tileCoordToPixel(R.min.x+Me/R.xScale,R.min.y+ge/R.yScale),Oe=d.tileCoordToPixel(R.min.x+(Me+1)/R.xScale,R.min.y+(ge+1)/R.yScale);for(let Pe=Be.y;Pe<=Math.min(Oe.y+1,T-1);++Pe)for(let Ye=Be.x;Ye<=Math.min(Oe.x+1,T-1);++Ye)g_[Pe*T+Ye]===255&&(g_[Pe*T+Ye]=0,he+=d.getElevationAtPixel(Ye,Pe),ne++)}const de=he/ne;$=Math.max(1,N.x-G),K=Math.max(1,N.y-G),te=Math.min(V.x+G,T-2),ce=Math.min(V.y+G,T-2),B=!0;for(let ge=K;ge<=ce;++ge)for(let Me=$;Me<=te;++Me)g_[ge*T+Me]===0&&(Dk[ge*T+Me]=d._dem.set(Me,ge,de));for(let ge=1;ge<G;++ge){$=Math.max(1,N.x-ge),K=Math.max(1,N.y-ge),te=Math.min(V.x+ge,T-2),ce=Math.min(V.y+ge,T-2);for(let Me=K;Me<=ce;++Me)for(let Be=$;Be<=te;++Be){const Oe=Me*T+Be;if(g_[Oe]===255){let Pe=0,Ye=0,ze=-1,Qe=-1;for(let ct=-1;ct<=1;++ct)for(let ht=-1;ht<=1;++ht){const ft=(Me+ct)*T+Be+ht;if(g_[ft]>=ge)continue;const mt=Dk[ft],Ct=Math.abs(mt);Ct>Ye&&(Pe=mt,Ye=Ct,ze=ht,Qe=ct)}if(Ye>.1){const ct=1-(ge+.5*Math.abs(ze*Qe))/G;let ht=d._dem.get(Be,Me)+Pe*ct;const ft=d._dem.get(Be+ze,Me+Qe),mt=d._dem.get(Be-ze,Me-Qe,!0);(ht-ft)*(ht-mt)>0&&(ht=(ft+mt)/2),Dk[Oe]=d._dem.set(Be,Me,ht),g_[Oe]=ge}}}}}B&&(d._demTile.needsDEMTextureUpload=!0,d._dem._timestamp=En.now())}getNodesInfo(){return this.nodesInfo}destroy(){const c=this.getNodesInfo();for(const d of c)dC(d.node),Lk(d.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(c,d){if(d.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=d.updateTime;const _=d.getReplacementRegionsForTile(c.toUnwrapped()),A=this.getNodesInfo();for(let x=0;x<this.nodesInfo.length;x++){const T=A[x].node;A[x].hiddenByReplacement=!!T.footprint&&!_.find(B=>B.footprint===T.footprint)}}getHeightAtTileCoord(c,d){const _=this.getNodesInfo(),A=[],x=[0,0,0],T=Le.mat4.identity([]);for(let B=0;B<this.nodesInfo.length;B++){const U=_[B],j=U.node.meshes[0],R=j.transformedAabb;if(c<R.min[0]||d<R.min[1]||c>R.max[0]||d>R.max[1])continue;if(U.node.hidden===!0)return{height:1/0,maxHeight:U.feature.properties.height,hidden:!1,verticalScale:U.evaluatedScale[2]};Le.mat4.invert(T,U.node.matrix),x[0]=c,x[1]=d,Le.vec3.transformMat4(x,x,T);const N=(x[0]-j.aabb.min[0])/(j.aabb.max[0]-j.aabb.min[0])*m_|0,V=Math.min(63,(x[1]-j.aabb.min[1])/(j.aabb.max[1]-j.aabb.min[1])*m_|0)*m_+Math.min(63,N),z=j.heightmap[V];if(!(z<0&&U.node.footprint))return U.hiddenByReplacement?void 0:{height:z,maxHeight:U.feature.properties.height,hidden:!1,verticalScale:U.evaluatedScale[2]};if(U.node.footprint.grid.query(new St(c,d),new St(c,d),A),A.length>0)return{height:void 0,maxHeight:U.feature.properties.height,hidden:U.hiddenByReplacement,verticalScale:U.evaluatedScale[2]}}}}function fS(g,c){return!g.isLightConstant&&c}function Zfe(g,c,d,_,A,x,T,B){let U=(61440&c|(61440&c)>>4)>>8,j=(3840&c|(3840&c)>>4)>>4,R=240&c|(240&c)>>4;d[3]>0&&(U=cr(U,255*d[0],d[3]),j=cr(j,255*d[1],d[3]),R=cr(R,255*d[2],d[3]));const N=U<<8|j,V=R<<8|Math.floor(255*_[3]),z=function(ge){const Me=jt(ge,0,2);return Math.min(Math.round(.5*Me*255),255)}(_[2])<<8|15*_[0]<<4|15*_[1],G=jt(A[0],0,1),$=jt(A[1],0,1),K=jt(A[2],0,1),te=jt(A[3],0,1);let ce,he,ne,de;if(G!==$&&T!==x&&$!==G){const ge=T-x;he=1/(ge*($-G)),ne=-(x+ge*G)/(ge*($-G));const Me=jt(A[4],-1,1);de=Math.pow(10,Me),ce=255*K<<8|255*te}else ce=65535,he=0,ne=1,de=1;if(g.emplaceBack(N,V,z,ce,he,ne,de),B){const ge=B.length;B.clear();for(let Me=0;Me<ge;Me++)B.emplaceBack(N,V,z,ce,he,ne,de)}}function Yfe(g,c,d){const _=g.node;let A=0;const x=d&e1.HasMeshoptCompression;for(const T of _.meshes){if(_.lights&&_.lightMeshIndex===A||!T.featureData)continue;T.featureArray=new co,T.featureArray.reserve(T.featureData.length);let B=c;for(const U of T.featureData){const j=x?65535&U:U>>16&65535,R=x?U>>16&65535:65535&U,N=(15&R)<8?15&R:0,V=g.evaluatedRMEA[N],z=g.evaluatedColor[N],G=g.emissionHeightBasedParams[N];let $;if(B&&N===2&&_.lights&&($=new co,$.resize(10*_.lights.length)),Zfe(T.featureArray,j,z,V,G,T.aabb.min[2],T.aabb.max[2],$),$&&B){B=!1;const K=_.meshes[_.lightMeshIndex];K.featureArray=$,K.featureArray._trim()}}T.featureArray._trim(),A++}}function E9(g,c,d,_){const A=1<<g.z;c.lat=je((_/yn+g.y)/A),c.lng=$e((d/yn+g.x)/A)}Fn(pC,"Tiled3dModelBucket",{omit:["layers"]}),Fn(M9,"Tiled3dModelFeature");const Kfe={circle:class extends js{constructor(g,c,d,_){super(g,{layout:Ti||(Ti=new Wi({"circle-sort-key":new Kn(At.layout_circle["circle-sort-key"]),visibility:new gn(At.layout_circle.visibility)})),paint:zs||(zs=new Wi({"circle-radius":new Kn(At.paint_circle["circle-radius"]),"circle-color":new Kn(At.paint_circle["circle-color"]),"circle-blur":new Kn(At.paint_circle["circle-blur"]),"circle-opacity":new Kn(At.paint_circle["circle-opacity"]),"circle-translate":new gn(At.paint_circle["circle-translate"]),"circle-translate-anchor":new gn(At.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new gn(At.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new gn(At.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Kn(At.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Kn(At.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Kn(At.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new gn(At.paint_circle["circle-emissive-strength"])}))},c,d,_)}createBucket(g){return new er(g)}queryRadius(g){const c=g;return Ss("circle-radius",this,c)+Ss("circle-stroke-width",this,c)+Di(this.paint.get("circle-translate"))}queryIntersectsFeature(g,c,d,_,A,x,T,B){const U=pi(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),j=this.paint.get("circle-radius").evaluate(c,d)+this.paint.get("circle-stroke-width").evaluate(c,d);return sV(g,_,x,T,B,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",U,j)}getProgramIds(){return["circle"]}getDefaultProgramParams(g,c,d){const _=iV(this);return{config:new an(this,{zoom:c,lut:d}),defines:_,overrideFog:!1}}},heatmap:class extends js{createBucket(g){return new oV(g)}constructor(g,c,d,_){super(g,{layout:lV||(lV=new Wi({visibility:new gn(At.layout_heatmap.visibility)})),paint:cV||(cV=new Wi({"heatmap-radius":new Kn(At.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Kn(At.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new gn(At.paint_heatmap["heatmap-intensity"]),"heatmap-color":new cc(At.paint_heatmap["heatmap-color"]),"heatmap-opacity":new gn(At.paint_heatmap["heatmap-opacity"])}))},c,d,_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(g){g==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ww({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(g){return Ss("heatmap-radius",this,g)}queryIntersectsFeature(g,c,d,_,A,x,T,B){const U=this.paint.get("heatmap-radius").evaluate(c,d);return sV(g,_,x,T,B,!0,!0,new St(0,0),U)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(g,c,d){return g==="heatmap"?{config:new an(this,{zoom:c,lut:d}),overrideFog:!1}:{}}},hillshade:class extends js{constructor(g,c,d,_){super(g,{layout:uV||(uV=new Wi({visibility:new gn(At.layout_hillshade.visibility)})),paint:hV||(hV=new Wi({"hillshade-illumination-direction":new gn(At.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new gn(At.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new gn(At.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new gn(At.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new gn(At.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new gn(At.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new gn(At.paint_hillshade["hillshade-emissive-strength"])}))},c,d,_)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(g,c,d){return{overrideFog:!1}}},fill:class extends js{constructor(g,c,d,_){super(g,{layout:yV||(yV=new Wi({"fill-sort-key":new Kn(At.layout_fill["fill-sort-key"]),visibility:new gn(At.layout_fill.visibility)})),paint:xV||(xV=new Wi({"fill-antialias":new gn(At.paint_fill["fill-antialias"]),"fill-opacity":new Kn(At.paint_fill["fill-opacity"]),"fill-color":new Kn(At.paint_fill["fill-color"]),"fill-outline-color":new Kn(At.paint_fill["fill-outline-color"]),"fill-translate":new gn(At.paint_fill["fill-translate"]),"fill-translate-anchor":new gn(At.paint_fill["fill-translate-anchor"]),"fill-pattern":new Kn(At.paint_fill["fill-pattern"]),"fill-emissive-strength":new gn(At.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Kn(At.paint_fill["fill-z-offset"])}))},c,d,_)}getProgramIds(){const g=this.paint.get("fill-pattern"),c=g&&g.constantOr(1),d=[c?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&d.push(c&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),d}getDefaultProgramParams(g,c,d){return{config:new an(this,{zoom:c,lut:d}),overrideFog:!1}}recalculate(g,c){super.recalculate(g,c);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(g){return new YB(g)}queryRadius(){return Di(this.paint.get("fill-translate"))}queryIntersectsFeature(g,c,d,_,A,x){return!g.queryGeometry.isAboveHorizon&&yr(kr(g.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),_)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends js{constructor(g,c,d,_){super(g,{layout:tH||(tH=new Wi({visibility:new gn(At["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new gn(At["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:nH||(nH=new Wi({"fill-extrusion-opacity":new gn(At["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Kn(At["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new gn(At["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new gn(At["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Kn(At["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Kn(At["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Kn(At["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new gn(At["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new gn(At["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new gn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new gn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Kn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Kn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new gn(At["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new gn(At["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new gn(At["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new gn(At["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Kn(At["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Kn(At["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new gn(At["paint_fill-extrusion"]["fill-extrusion-cast-shadows"])}))},c,d,_),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(g){return new WE(g)}queryRadius(){return Di(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(g,c,d,_,A,x,T,B,U){const j=pi(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),R=this.paint.get("fill-extrusion-height").evaluate(c,d),N=this.paint.get("fill-extrusion-base").evaluate(c,d),V=[0,0],z=B&&x.elevation,G=x.elevation?x.elevation.exaggeration():1,$=g.tile.getBucket(this);if(z&&$ instanceof WE){const ne=$.centroidVertexArray,de=U+1;de<ne.length&&(V[0]=ne.geta_centroid_pos0(de),V[1]=ne.geta_centroid_pos1(de))}if(V[0]===0&&V[1]===1)return!1;x.projection.name==="globe"&&(_=eH([_],[new St(0,0),new St(yn,yn)],g.tileID.canonical).map(ne=>ne.polygon).flat());const K=z?B:null,[te,ce]=function(ne,de,ge,Me,Be,Oe,Pe,Ye,ze,Qe,ct){return ne.projection.name==="globe"?function(ht,ft,mt,Ct,_t,Ut,Yt,Dt,Rn,bn,dn){const tn=[],nr=[],In=ht.projection.upVectorScale(dn,ht.center.lat,ht.worldSize).metersToTile,Nn=[0,0,0,1],wr=[0,0,0,1],Or=(Lr,jr,Wr,Gi)=>{Lr[0]=jr,Lr[1]=Wr,Lr[2]=Gi,Lr[3]=1},Pr=QV();mt>0&&(mt+=Pr),Ct+=Pr;for(const Lr of ft){const jr=[],Wr=[];for(const Gi of Lr){const Mi=Gi.x+_t.x,Tr=Gi.y+_t.y,_i=ht.projection.projectTilePoint(Mi,Tr,dn),wi=ht.projection.upVector(dn,Gi.x,Gi.y);let ss=mt,Ws=Ct;if(Yt){const pa=iH(Mi,Tr,mt,Ct,Yt,Dt,Rn,bn);ss+=pa.base,Ws+=pa.top}mt!==0?Or(Nn,_i.x+wi[0]*In*ss,_i.y+wi[1]*In*ss,_i.z+wi[2]*In*ss):Or(Nn,_i.x,_i.y,_i.z),Or(wr,_i.x+wi[0]*In*Ws,_i.y+wi[1]*In*Ws,_i.z+wi[2]*In*Ws),Le.vec3.transformMat4(Nn,Nn,Ut),Le.vec3.transformMat4(wr,wr,Ut),jr.push(new p_(Nn[0],Nn[1],Nn[2])),Wr.push(new p_(wr[0],wr[1],wr[2]))}tn.push(jr),nr.push(Wr)}return[tn,nr]}(ne,de,ge,Me,Be,Oe,Pe,Ye,ze,Qe,ct):Pe?function(ht,ft,mt,Ct,_t,Ut,Yt,Dt,Rn){const bn=[],dn=[],tn=[0,0,0,1];for(const nr of ht){const In=[],Nn=[];for(const wr of nr){const Or=wr.x+Ct.x,Pr=wr.y+Ct.y,Lr=iH(Or,Pr,ft,mt,Ut,Yt,Dt,Rn);tn[0]=Or,tn[1]=Pr,tn[2]=Lr.base,tn[3]=1,Le.vec4.transformMat4(tn,tn,_t),tn[3]=Math.max(tn[3],1e-5);const jr=new p_(tn[0]/tn[3],tn[1]/tn[3],tn[2]/tn[3]);tn[0]=Or,tn[1]=Pr,tn[2]=Lr.top,tn[3]=1,Le.vec4.transformMat4(tn,tn,_t),tn[3]=Math.max(tn[3],1e-5);const Wr=new p_(tn[0]/tn[3],tn[1]/tn[3],tn[2]/tn[3]);In.push(jr),Nn.push(Wr)}bn.push(In),dn.push(Nn)}return[bn,dn]}(de,ge,Me,Be,Oe,Pe,Ye,ze,Qe):function(ht,ft,mt,Ct,_t){const Ut=[],Yt=[],Dt=_t[8]*ft,Rn=_t[9]*ft,bn=_t[10]*ft,dn=_t[11]*ft,tn=_t[8]*mt,nr=_t[9]*mt,In=_t[10]*mt,Nn=_t[11]*mt;for(const wr of ht){const Or=[],Pr=[];for(const Lr of wr){const jr=Lr.x+Ct.x,Wr=Lr.y+Ct.y,Gi=_t[0]*jr+_t[4]*Wr+_t[12],Mi=_t[1]*jr+_t[5]*Wr+_t[13],Tr=_t[2]*jr+_t[6]*Wr+_t[14],_i=_t[3]*jr+_t[7]*Wr+_t[15],wi=Gi+Dt,ss=Mi+Rn,Ws=Tr+bn,pa=Math.max(_i+dn,1e-5),$s=Gi+tn,Os=Mi+nr,uo=Tr+In,Sa=Math.max(_i+Nn,1e-5);Or.push(new p_(wi/pa,ss/pa,Ws/pa)),Pr.push(new p_($s/Sa,Os/Sa,uo/Sa))}Ut.push(Or),Yt.push(Pr)}return[Ut,Yt]}(de,ge,Me,Be,Oe)}(x,_,N,R,j,T,K,V,G,x.center.lat,g.tileID.canonical),he=g.queryGeometry;return function(ne,de,ge){let Me=1/0;yr(ge,de)&&(Me=rH(ge,de[0]));for(let Be=0;Be<de.length;Be++){const Oe=de[Be],Pe=ne[Be];for(let Ye=0;Ye<Oe.length-1;Ye++){const ze=Oe[Ye],Qe=[ze,Oe[Ye+1],Pe[Ye+1],Pe[Ye],ze];xn(ge,Qe)&&(Me=Math.min(Me,rH(ge,Qe)))}}return Me!==1/0&&Me}(te,ce,he.isPointQuery()?he.screenBounds:he.screenGeometry)}},line:class extends js{constructor(g,c,d,_){const A=pH();super(g,A,c,d,_),A.layout&&(this.layout=new th(A.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(g){if(g==="line-gradient"){const c=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=c._styleExpression&&c._styleExpression.expression instanceof xd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(g,c){super.recalculate(g,c),this.paint._values["line-floorwidth"]=(()=>{if(eS)return eS;const d=pH();return eS=new efe(d.paint.properties["line-width"].specification),eS.useIntegerZoom=!0,eS})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,g)}createBucket(g){return new ak(g)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(g,c,d){const _=fH(this);return{config:new an(this,{zoom:c,lut:d}),defines:_,overrideFog:!1}}queryRadius(g){const c=g,d=mH(Ss("line-width",this,c),Ss("line-gap-width",this,c)),_=Ss("line-offset",this,c);return d/2+Math.abs(_)+Di(this.paint.get("line-translate"))}queryIntersectsFeature(g,c,d,_,A,x){if(g.queryGeometry.isAboveHorizon)return!1;const T=kr(g.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),x.angle,g.pixelToTileUnitsFactor),B=g.pixelToTileUnitsFactor/2*mH(this.paint.get("line-width").evaluate(c,d),this.paint.get("line-gap-width").evaluate(c,d)),U=this.paint.get("line-offset").evaluate(c,d);return U&&(_=function(j,R){const N=[],V=new St(0,0);for(let z=0;z<j.length;z++){const G=j[z],$=[];for(let K=0;K<G.length;K++){const te=G[K],ce=G[K+1],he=K===0?V:te.sub(G[K-1])._unit()._perp(),ne=K===G.length-1?V:ce.sub(te)._unit()._perp(),de=he._add(ne)._unit();de._mult(1/(de.x*ne.x+de.y*ne.y)),$.push(de._mult(R)._add(te))}N.push($)}return N}(_,U*g.pixelToTileUnitsFactor)),function(j,R,N){for(let V=0;V<R.length;V++){const z=R[V];if(j.length>=3){for(let G=0;G<z.length;G++)if(is(j,z[G]))return!0}if(qn(j,z,N))return!0}return!1}(T,_,B)}isTileClipped(){return!0}isDraped(g){const c=this.layout.get("line-z-offset");return c.isConstant()&&!c.constantOr(0)}},symbol:aC,background:class extends js{constructor(g,c,d,_){super(g,{layout:JH||(JH=new Wi({visibility:new gn(At.layout_background.visibility)})),paint:QH||(QH=new Wi({"background-pitch-alignment":new gn(At.paint_background["background-pitch-alignment"]),"background-color":new gn(At.paint_background["background-color"]),"background-pattern":new gn(At.paint_background["background-pattern"]),"background-opacity":new gn(At.paint_background["background-opacity"]),"background-emissive-strength":new gn(At.paint_background["background-emissive-strength"])}))},c,d,_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(g,c,d){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:i9,"raster-particle":u9,sky:class extends js{constructor(g,c,d,_){super(g,{layout:o9||(o9=new Wi({visibility:new gn(At.layout_sky.visibility)})),paint:l9||(l9=new Wi({"sky-type":new gn(At.paint_sky["sky-type"]),"sky-atmosphere-sun":new gn(At.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new gn(At.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new gn(At.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new gn(At.paint_sky["sky-gradient-radius"]),"sky-gradient":new cc(At.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new gn(At.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new gn(At.paint_sky["sky-atmosphere-color"]),"sky-opacity":new gn(At.paint_sky["sky-opacity"])}))},c,d,_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(g){g==="sky-gradient"?this._updateColorRamp():g!=="sky-atmosphere-sun"&&g!=="sky-atmosphere-halo-color"&&g!=="sky-atmosphere-color"&&g!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ww({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(g){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const c=g.style.light.properties.get("position");return this._lightPosition.azimuthal!==c.azimuthal||this._lightPosition.polar!==c.polar}return!1}getCenter(g,c){if(this.paint.get("sky-type")==="atmosphere"){const _=this.paint.get("sky-atmosphere-sun"),A=!_,x=g.style.light,T=x.properties.get("position");return A&&x.properties.get("anchor")==="viewport"&&Lt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),A?Ek(T.azimuthal,90-T.polar,c):Ek(_[0],90-_[1],c)}const d=this.paint.get("sky-gradient-center");return Ek(d[0],90-d[1],c)}isSky(){return!0}markSkyboxValid(g){this._skyboxInvalidated=!1,this._lightPosition=g.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const g=this.paint.get("sky-type");return g==="atmosphere"?["skyboxCapture","skybox"]:g==="gradient"?["skyboxGradient"]:null}},slot:class extends js{constructor(g,c,d,_){super(g,{paint:c9||(c9=new Wi({}))},c,null)}},model:class extends js{constructor(g,c,d,_){super(g,{layout:x9||(x9=new Wi({visibility:new gn(At.layout_model.visibility),"model-id":new Kn(At.layout_model["model-id"])})),paint:b9||(b9=new Wi({"model-opacity":new gn(At.paint_model["model-opacity"]),"model-rotation":new Kn(At.paint_model["model-rotation"]),"model-scale":new Kn(At.paint_model["model-scale"]),"model-translation":new Kn(At.paint_model["model-translation"]),"model-color":new Kn(At.paint_model["model-color"]),"model-color-mix-intensity":new Kn(At.paint_model["model-color-mix-intensity"]),"model-type":new gn(At.paint_model["model-type"]),"model-cast-shadows":new gn(At.paint_model["model-cast-shadows"]),"model-receive-shadows":new gn(At.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new gn(At.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Kn(At.paint_model["model-emissive-strength"]),"model-roughness":new Kn(At.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Kn(At.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new gn(At.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new gn(At.paint_model["model-front-cutoff"])}))},c,d,_),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(g){return new Rk(g)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(g){return g instanceof pC?yn-1:0}queryIntersectsFeature(g,c,d,_,A,x){if(!this.modelManager)return!1;const T=this.modelManager,B=g.tile.getBucket(this);if(!(B&&B instanceof Rk))return!1;const U=B;for(const j in U.instancesPerModel){const R=U.instancesPerModel[j],N=c.id!==void 0?c.id:c.properties&&c.properties.hasOwnProperty("id")?c.properties.id:void 0;if(R.idToFeaturesIndex.hasOwnProperty(N)){const V=R.features[R.idToFeaturesIndex[N]],z=T.getModel(j,this.scope);if(!z)return!1;let G=Le.mat4.create();const $=new ue(0,0),K=U.canonical;let te=Number.MAX_VALUE;for(let ce=0;ce<V.instancedDataCount;++ce){const he=16*(V.instancedDataOffset+ce),ne=R.instancedDataArray.float32,de=[ne[he+4],ne[he+5],ne[he+6]];E9(K,$,ne[he],0|ne[he+1]),w9(G,z,x,$,V.rotation,V.scale,de,!1,!1,!1),x.projection.name==="globe"&&(G=Ik(G,x));const ge=Le.mat4.multiply([],x.projMatrix,G),Me=g.queryGeometry,Be=m9(Me.isPointQuery()?Me.screenBounds:Me.screenGeometry,x,ge,z.aabb);Be!=null&&(te=Math.min(Be,te))}return te!==Number.MAX_VALUE&&te}}return!1}_handleOverridablePaintPropertyUpdate(g,c,d){return!(!this.layout||c.isDataDriven()||d.isDataDriven()||g!=="model-color"&&g!=="model-color-mix-intensity"&&g!=="model-rotation"&&g!=="model-scale"&&g!=="model-translation"&&g!=="model-emissive-strength")}_isPropertyZoomDependent(g){const c=this._transitionablePaint._values[g];return c!=null&&c.value!=null&&c.value.expression!=null&&c.value.expression instanceof dl}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}queryIntersectsMatchingFeature(g,c,d,_){const A=g.tile,x=A.getBucket(this);let T=null,B=Number.MAX_VALUE;if(!(x&&x instanceof pC))return{queryFeature:T,intersectionZ:B};const U=x.getNodesInfo()[c];if(U.hiddenByReplacement||!U.node.meshes||!d.filter(new ds(A.tileID.overscaledZ),U.feature,A.tileID.canonical))return{queryFeature:T,intersectionZ:B};const j=U.node,R=_.calculatePosMatrix(A.tileID.toUnwrapped(),_.worldSize),N=U.evaluatedScale;let V=0;_.elevation&&j.elevation&&(V=j.elevation*_.elevation.exaggeration()),Le.mat4.translate(R,R,[(j.anchor?j.anchor[0]:0)*(N[0]-1),(j.anchor?j.anchor[1]:0)*(N[1]-1),V]),Le.mat4.scale(R,R,N),Le.mat4.multiply(R,R,j.matrix);const z=g.queryGeometry,G=z.isPointQuery()?z.screenBounds:z.screenGeometry,$=function(te){const ce=Le.mat4.multiply([],R,te.matrix),he=Le.mat4.multiply(ce,_.expandedFarZProjMatrix,ce);for(let ne=0;ne<te.meshes.length;++ne){const de=te.meshes[ne];if(ne===te.lightMeshIndex)continue;const ge=m9(G,_,he,de.aabb);ge!=null&&(B=Math.min(ge,B))}if(te.children)for(const ne of te.children)$(ne)};if($(j),B===Number.MAX_VALUE)return{queryFeature:T,intersectionZ:B};const K=new ue(0,0);return E9(A.tileID.canonical,K,U.node.anchor[0],U.node.anchor[1]),T={type:"Feature",geometry:{type:"Point",coordinates:[K.lng,K.lat]},properties:U.feature.properties,id:U.feature.id,state:{},layer:this.serialize()},{queryFeature:T,intersectionZ:B}}},clip:class extends js{constructor(g,c,d,_){super(g,{layout:bV||(bV=new Wi({"clip-layer-types":new gn(At.layout_clip["clip-layer-types"]),"clip-layer-scope":new gn(At.layout_clip["clip-layer-scope"])})),paint:wV||(wV=new Wi({}))},c,d,_)}recalculate(g,c){super.recalculate(g,c)}createBucket(g){return new SV(g)}isTileClipped(){return!0}is3D(){return!0}}};class Jfe{constructor(c){this._callback=c,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Qfe{constructor(){this.tasks={},this.taskQueue=[],Fr(["process"],this),this.invoker=new Jfe(this.process),this.nextId=0}add(c,d){const _=this.nextId++,A=function({type:x,isSymbolTile:T,zoom:B}){return B=B||0,x==="message"?0:x!=="maybePrepare"||T?x!=="parseTile"||T?x==="parseTile"&&T?300-B:x==="maybePrepare"&&T?400-B:500:200-B:100-B}(d);if(A===0){try{c()}finally{}return null}return this.tasks[_]={fn:c,metadata:d,priority:A,id:_},this.taskQueue.push(_),this.invoker.trigger(),{cancel:()=>{delete this.tasks[_]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(_=>!!this.tasks[_]),!this.taskQueue.length)return;const c=this.pick();if(c===null)return;const d=this.tasks[c];if(delete this.tasks[c],this.taskQueue.length&&this.invoker.trigger(),!d)return;d.fn()}finally{}}pick(){let c=null,d=1/0;for(let A=0;A<this.taskQueue.length;A++){const x=this.tasks[this.taskQueue[A]];x.priority<d&&(d=x.priority,c=A)}if(c===null)return null;const _=this.taskQueue[c];return this.taskQueue.splice(c,1),_}remove(){this.invoker.remove()}}class C9{constructor(c,d,_){this.target=c,this.parent=d,this.mapId=_,this.callbacks={},this.cancelCallbacks={},Fr(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Qfe}send(c,d,_,A,x=!1,T){const B=Math.round(1e18*Math.random()).toString(36).substring(0,10);_&&(_.metadata=T,this.callbacks[B]=_);const U=new Set;return this.target.postMessage({id:B,type:c,hasCallback:!!_,targetMapId:A,mustQueue:x,sourceMapId:this.mapId,data:xo(d,U)},U),{cancel:()=>{_&&delete this.callbacks[B],this.target.postMessage({id:B,type:"<cancel>",targetMapId:A,sourceMapId:this.mapId})}}}receive(c){const d=c.data,_=d.id;if(_&&(!d.targetMapId||this.mapId===d.targetMapId))if(d.type==="<cancel>"){const A=this.cancelCallbacks[_];delete this.cancelCallbacks[_],A&&A.cancel()}else if(d.mustQueue||Ar()){const A=this.callbacks[_],x=this.scheduler.add(()=>this.processTask(_,d),A&&A.metadata||{type:"message"});x&&(this.cancelCallbacks[_]=x)}else this.processTask(_,d)}processTask(c,d){if(delete this.cancelCallbacks[c],d.type==="<response>"){const _=this.callbacks[c];delete this.callbacks[c],_&&(d.error?_(Qu(d.error)):_(null,Qu(d.data)))}else{const _=new Set,A=d.hasCallback?(T,B)=>{this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:T?xo(T):null,data:xo(B,_)},_)}:T=>{},x=Qu(d.data);if(this.parent[d.type])this.parent[d.type](d.sourceMapId,x,A);else if(this.parent.getWorkerSource){const T=d.type.split(".");this.parent.getWorkerSource(d.sourceMapId,T[0],x.source,x.scope)[T[1]](x,A)}else A(new Error(`Could not find function ${d.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class n1{constructor(c,d){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=ir();const _=this.workerPool.acquire(this.id);for(let A=0;A<_.length;A++){const x=new n1.Actor(_[A],d,this.id);x.name=`Worker ${A}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(c,d,_){tr(this.actors,(A,x)=>{A.send(c,d,x)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(c=>{c.remove()}),this.actors=[],this.workerPool.release(this.id)}}n1.Actor=C9;class I9{constructor(c){this.size=c,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(c,d){const _=this.toIdx(c,d);return{min:this.minimums[_],max:this.maximums[_]}}isLeaf(c,d){return this.leaves[this.toIdx(c,d)]}toIdx(c,d){return d*this.size+c}}function R9(g,c,d,_){let A=0,x=Number.MAX_VALUE;for(let T=0;T<3;T++)if(Math.abs(_[T])<1e-15){if(d[T]<g[T]||d[T]>c[T])return null}else{const B=1/_[T];let U=(g[T]-d[T])*B,j=(c[T]-d[T])*B;if(U>j){const R=U;U=j,j=R}if(U>A&&(A=U),j<x&&(x=j),A>x)return null}return A}function P9(g,c,d,_,A,x,T,B,U,j,R){const N=_-g,V=A-c,z=x-d,G=T-g,$=B-c,K=U-d,te=R[1]*K-R[2]*$,ce=R[2]*G-R[0]*K,he=R[0]*$-R[1]*G,ne=N*te+V*ce+z*he;if(Math.abs(ne)<1e-15)return null;const de=1/ne,ge=j[0]-g,Me=j[1]-c,Be=j[2]-d,Oe=(ge*te+Me*ce+Be*he)*de;if(Oe<0||Oe>1)return null;const Pe=Me*z-Be*V,Ye=Be*N-ge*z,ze=ge*V-Me*N,Qe=(R[0]*Pe+R[1]*Ye+R[2]*ze)*de;return Qe<0||Oe+Qe>1?null:(G*Pe+$*Ye+K*ze)*de}function L9(g,c,d){return(g-c)/(d-c)}function D9(g,c,d,_,A,x,T,B,U){const j=1<<d,R=x-_,N=T-A,V=(g+1)/j*R+_,z=(c+0)/j*N+A,G=(c+1)/j*N+A;B[0]=(g+0)/j*R+_,B[1]=z,U[0]=V,U[1]=G}class B9{constructor(c){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=c,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const d=function(x){const T=Math.ceil(Math.log2(x.dim/8)),B=[];let U=Math.ceil(Math.pow(2,T));const j=1/U,R=(z,G,$,K,te)=>{const ce=K?1:0,he=(z+1)*$-ce,ne=G*$,de=(G+1)*$-ce;te[0]=z*$,te[1]=ne,te[2]=he,te[3]=de};let N=new I9(U);const V=[];for(let z=0;z<U*U;z++){R(z%U,Math.floor(z/U),j,!1,V);const G=av(V[0],V[1],x),$=av(V[2],V[1],x),K=av(V[2],V[3],x),te=av(V[0],V[3],x);N.minimums.push(Math.min(G,$,K,te)),N.maximums.push(Math.max(G,$,K,te)),N.leaves.push(1)}for(B.push(N),U/=2;U>=1;U/=2){const z=B[B.length-1];N=new I9(U);for(let G=0;G<U*U;G++){R(G%U,Math.floor(G/U),2,!0,V);const $=z.getElevation(V[0],V[1]),K=z.getElevation(V[2],V[1]),te=z.getElevation(V[2],V[3]),ce=z.getElevation(V[0],V[3]),he=z.isLeaf(V[0],V[1]),ne=z.isLeaf(V[2],V[1]),de=z.isLeaf(V[2],V[3]),ge=z.isLeaf(V[0],V[3]),Me=Math.min($.min,K.min,te.min,ce.min),Be=Math.max($.max,K.max,te.max,ce.max),Oe=he&&ne&&de&&ge;N.maximums.push(Be),N.minimums.push(Me),N.leaves.push(Be-Me<=5&&Oe?1:0)}B.push(N)}return B}(this.dem),_=d.length-1,A=d[_];this._addNode(A.minimums[0],A.maximums[0],A.leaves[0]),this._construct(d,0,0,_,0)}raycastRoot(c,d,_,A,x,T,B=1){return R9([c,d,-100],[_,A,this.maximums[0]*B],x,T)}raycast(c,d,_,A,x,T,B=1){if(!this.nodeCount)return null;const U=this.raycastRoot(c,d,_,A,x,T,B);if(U==null)return null;const j=[],R=[],N=[],V=[],z=[{idx:0,t:U,nodex:0,nodey:0,depth:0}];for(;z.length>0;){const{idx:G,t:$,nodex:K,nodey:te,depth:ce}=z.pop();if(this.leaves[G]){D9(K,te,ce,c,d,_,A,N,V);const ne=1<<ce,de=(K+0)/ne,ge=(K+1)/ne,Me=(te+0)/ne,Be=(te+1)/ne,Oe=av(de,Me,this.dem)*B,Pe=av(ge,Me,this.dem)*B,Ye=av(ge,Be,this.dem)*B,ze=av(de,Be,this.dem)*B,Qe=P9(N[0],N[1],Oe,V[0],N[1],Pe,V[0],V[1],Ye,x,T),ct=P9(V[0],V[1],Ye,N[0],V[1],ze,N[0],N[1],Oe,x,T),ht=Math.min(Qe!==null?Qe:Number.MAX_VALUE,ct!==null?ct:Number.MAX_VALUE);if(ht!==Number.MAX_VALUE)return ht;{const ft=Le.vec3.scaleAndAdd([],x,T,$);if(k9(Oe,Pe,ze,Ye,L9(ft[0],N[0],V[0]),L9(ft[1],N[1],V[1]))>=ft[2])return $}continue}let he=0;for(let ne=0;ne<this._siblingOffset.length;ne++){D9((K<<1)+this._siblingOffset[ne][0],(te<<1)+this._siblingOffset[ne][1],ce+1,c,d,_,A,N,V),N[2]=-100,V[2]=this.maximums[this.childOffsets[G]+ne]*B;const de=R9(N,V,x,T);if(de!=null){const ge=de;j[ne]=ge;let Me=!1;for(let Be=0;Be<he&&!Me;Be++)ge>=j[R[Be]]&&(R.splice(Be,0,ne),Me=!0);Me||(R[he]=ne),he++}}for(let ne=0;ne<he;ne++){const de=R[ne];z.push({idx:this.childOffsets[G]+de,t:j[de],nodex:(K<<1)+this._siblingOffset[de][0],nodey:(te<<1)+this._siblingOffset[de][1],depth:ce+1})}}return null}_addNode(c,d,_){return this.minimums.push(c),this.maximums.push(d),this.leaves.push(_),this.childOffsets.push(0),this.nodeCount++}_construct(c,d,_,A,x){if(c[A].isLeaf(d,_)===1)return;this.childOffsets[x]||(this.childOffsets[x]=this.nodeCount);const T=A-1,B=c[T];let U=0,j=0;for(let R=0;R<this._siblingOffset.length;R++){const N=2*d+this._siblingOffset[R][0],V=2*_+this._siblingOffset[R][1],z=B.getElevation(N,V),G=B.isLeaf(N,V),$=this._addNode(z.min,z.max,G);G&&(U|=1<<R),j||(j=$)}for(let R=0;R<this._siblingOffset.length;R++)U&1<<R||this._construct(c,2*d+this._siblingOffset[R][0],2*_+this._siblingOffset[R][1],T,j+R)}}function k9(g,c,d,_,A,x){return cr(cr(g,d,x),cr(c,_,x),A)}function av(g,c,d){const _=d.dim,A=jt(g*_-.5,0,_-1),x=jt(c*_-.5,0,_-1),T=Math.floor(A),B=Math.floor(x),U=Math.min(T+1,_-1),j=Math.min(B+1,_-1);return k9(d.get(T,B),d.get(U,B),d.get(T,j),d.get(U,j),A-T,x-B)}const ede={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function tde(g,c,d){return(256*g*256+256*c+d)/10-1e4}function nde(g,c,d){return 256*g+c+d/256-32768}class mC{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(c,d,_,A=!1){if(this.uid=c,d.height!==d.width)throw new RangeError("DEM tiles must be square");if(_&&_!=="mapbox"&&_!=="terrarium")return void Lt(`"${_}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=d.height;const x=this.dim=d.height-2,T=new Uint32Array(d.data.buffer);if(this.pixels=new Uint8Array(d.data.buffer),this.floatView=new Float32Array(d.data.buffer),this.borderReady=A,this._modifiedForSources={},!A){for(let U=0;U<x;U++)T[this._idx(-1,U)]=T[this._idx(0,U)],T[this._idx(x,U)]=T[this._idx(x-1,U)],T[this._idx(U,-1)]=T[this._idx(U,0)],T[this._idx(U,x)]=T[this._idx(U,x-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(x,-1)]=T[this._idx(x-1,0)],T[this._idx(-1,x)]=T[this._idx(0,x-1)],T[this._idx(x,x)]=T[this._idx(x-1,x-1)]}const B=_==="terrarium"?nde:tde;for(let U=0;U<T.length;++U){const j=4*U;this.floatView[U]=B(this.pixels[j],this.pixels[j+1],this.pixels[j+2])}this._timestamp=En.now()}_buildQuadTree(){this._tree=new B9(this)}get(c,d,_=!1){_&&(c=jt(c,-1,this.dim),d=jt(d,-1,this.dim));const A=this._idx(c,d);return this.floatView[A]}set(c,d,_){const A=this._idx(c,d),x=this.floatView[A];return this.floatView[A]=_,_-x}static getUnpackVector(c){return ede[c]}_idx(c,d){if(c<-1||c>=this.dim+1||d<-1||d>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(d+1)*this.stride+(c+1)}static pack(c,d){const _=[0,0,0,0],A=mC.getUnpackVector(d);let x=Math.floor((c+A[3])/A[2]);return _[2]=x%256,x=Math.floor(x/256),_[1]=x%256,x=Math.floor(x/256),_[0]=x,_}getPixels(){return new pV({width:this.stride,height:this.stride},this.pixels)}backfillBorder(c,d,_){if(this.dim!==c.dim)throw new Error("dem dimension mismatch");let A=d*this.dim,x=d*this.dim+this.dim,T=_*this.dim,B=_*this.dim+this.dim;switch(d){case-1:A=x-1;break;case 1:x=A+1}switch(_){case-1:T=B-1;break;case 1:B=T+1}const U=-d*this.dim,j=-_*this.dim;for(let R=T;R<B;R++)for(let N=A;N<x;N++){const V=4*this._idx(N,R),z=4*this._idx(N+U,R+j);this.pixels[V+0]=c.pixels[z+0],this.pixels[V+1]=c.pixels[z+1],this.pixels[V+2]=c.pixels[z+2],this.pixels[V+3]=c.pixels[z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function rde(g,c,d){g===1?c.header_length=d.readFixed32():g===2?c.x=d.readVarint():g===3?c.y=d.readVarint():g===4?c.z=d.readVarint():g===5&&c.layers.push(function(_,A){return _.readFields(lde,{version:0,name:"",units:"",tilesize:0,buffer:0,pixel_format:0,data_index:[]},A)}(d,d.readVarint()+d.pos))}function ide(g,c,d){g===1?(c.delta_filter=function(_,A){return _.readFields(sde,{block_size:0},A)}(d,d.readVarint()+d.pos),c.filter="delta_filter"):g===2?(d.readVarint(),c.filter="zigzag_filter"):g===3?(d.readVarint(),c.filter="bitshuffle_filter"):g===4&&(d.readVarint(),c.filter="byteshuffle_filter")}function sde(g,c,d){g===1&&(c.block_size=d.readVarint())}function ade(g,c,d){g===1?(d.readVarint(),c.codec="gzip_data"):g===2?(d.readVarint(),c.codec="jpeg_image"):g===3?(d.readVarint(),c.codec="webp_image"):g===4&&(d.readVarint(),c.codec="png_image")}function ode(g,c,d){g===1?c.first_byte=d.readFixed64():g===2?c.last_byte=d.readFixed64():g===3?c.filters.push(function(_,A){return _.readFields(ide,{},A)}(d,d.readVarint()+d.pos)):g===4?c.codec=function(_,A){return _.readFields(ade,{},A)}(d,d.readVarint()+d.pos):g===5?c.deprecated_offset=d.readFloat():g===6?c.deprecated_scale=d.readFloat():g===7?c.bands.push(d.readString()):g===8?c.offset=d.readDouble():g===9&&(c.scale=d.readDouble())}function lde(g,c,d){g===1?c.version=d.readVarint():g===2?c.name=d.readString():g===3?c.units=d.readString():g===4?c.tilesize=d.readVarint():g===5?c.buffer=d.readVarint():g===6?c.pixel_format=d.readVarint():g===7&&c.data_index.push(function(_,A){return _.readFields(ode,{first_byte:0,last_byte:0,filters:[],codec:null,offset:0,scale:0,deprecated_offset:0,deprecated_scale:0,bands:[]},A)}(d,d.readVarint()+d.pos))}function cde(g,c,d){if(g===2)(function(_,A,x){_.readFields(ude,x,A)})(d,d.readVarint()+d.pos,c);else if(g===3)throw new Error("Not implemented")}function ude(g,c,d){if(g===1){let _=0;const A=d.readVarint()+d.pos;for(;d.pos<A;)c[_++]=d.readVarint()}}Fn(mC,"DEMData"),Fn(B9,"DemMinMaxQuadTree",{omit:["dem"]});class hde{constructor(c){this.capacity=c,this.cache=new Map}get(c){if(!this.cache.has(c))return;const d=this.cache.get(c);return this.cache.delete(c),this.cache.set(c,d),d}put(c,d){this.cache.has(c)?this.cache.delete(c):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(c,d)}}function fde(g,c){if(c.length!==4)throw new Error(`Expected data of dimension 4 but got ${c.length}.`);let d=c[3];for(let _=2;_>=1;_--){const A=_===1?1:0,x=_===2?1:0;for(let T=0;T<c[0];T++){const B=c[1]*T;for(let U=A;U<c[1];U++){const j=c[2]*(U+B);for(let R=x;R<c[2];R++){const N=c[3]*(R+j);for(let V=0;V<c[3];V++){const z=N+V;g[z]+=g[z-d]}}}}d*=c[_]}return g}function dde(g){for(let c=0,d=g.length;c<d;c++)g[c]=g[c]>>>1^-(1&g[c]);return g}function pde(g,c){switch(c){case"uint32":return g;case"uint16":for(let d=0;d<g.length;d+=2){const _=g[d],A=g[d+1];g[d]=(240&_)>>4|(61440&_)>>8|(240&A)<<4|61440&A,g[d+1]=15&_|(3840&_)>>4|(15&A)<<8|(3840&A)<<4}return g;case"uint8":for(let d=0;d<g.length;d+=4){const _=g[d],A=g[d+1],x=g[d+2],T=g[d+3];g[d+0]=(192&_)>>6|(192&A)>>4|(192&x)>>2|192&T,g[d+1]=(48&_)>>4|(48&A)>>2|48&x|(48&T)<<2,g[d+2]=(12&_)>>2|12&A|(12&x)<<2|(12&T)<<4,g[d+3]=3&_|(3&A)<<2|(3&x)<<4|(3&T)<<6}return g;default:throw new Error(`Invalid pixel format, "${c}"`)}}var Cu=Uint8Array,dS=Uint16Array,mde=Int32Array,O9=new Cu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),F9=new Cu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gde=new Cu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),N9=function(g,c){for(var d=new dS(31),_=0;_<31;++_)d[_]=c+=1<<g[_-1];var A=new mde(d[30]);for(_=1;_<30;++_)for(var x=d[_];x<d[_+1];++x)A[x]=x-d[_]<<5|_;return{b:d,r:A}},z9=N9(O9,2),U9=z9.b,vde=z9.r;U9[28]=258,vde[258]=28;for(var _de=N9(F9,0).b,G9=new dS(32768),da=0;da<32768;++da){var r1=(43690&da)>>1|(21845&da)<<1;G9[da]=((65280&(r1=(61680&(r1=(52428&r1)>>2|(13107&r1)<<2))>>4|(3855&r1)<<4))>>8|(255&r1)<<8)>>1}var pS=function(g,c,d){for(var _=g.length,A=0,x=new dS(c);A<_;++A)g[A]&&++x[g[A]-1];var T,B=new dS(c);for(A=1;A<c;++A)B[A]=B[A-1]+x[A-1]<<1;T=new dS(1<<c);var U=15-c;for(A=0;A<_;++A)if(g[A])for(var j=A<<4|g[A],R=c-g[A],N=B[g[A]-1]++<<R,V=N|(1<<R)-1;N<=V;++N)T[G9[N]>>U]=j;return T},mS=new Cu(288);for(da=0;da<144;++da)mS[da]=8;for(da=144;da<256;++da)mS[da]=9;for(da=256;da<280;++da)mS[da]=7;for(da=280;da<288;++da)mS[da]=8;var V9=new Cu(32);for(da=0;da<32;++da)V9[da]=5;var yde=pS(mS,9),xde=pS(V9,5),Bk=function(g){for(var c=g[0],d=1;d<g.length;++d)g[d]>c&&(c=g[d]);return c},wf=function(g,c,d){var _=c/8|0;return(g[_]|g[_+1]<<8)>>(7&c)&d},kk=function(g,c){var d=c/8|0;return(g[d]|g[d+1]<<8|g[d+2]<<16)>>(7&c)},bde=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Sf=function(g,c,d){var _=new Error(c||bde[g]);if(_.code=g,Error.captureStackTrace&&Error.captureStackTrace(_,Sf),!d)throw _;return _},wde=new Cu(0),Sde=typeof TextDecoder<"u"&&new TextDecoder;try{Sde.decode(wde,{stream:!0})}catch{}const Ade={gzip_data:"gzip"};class oh extends Error{constructor(c){super(c),this.name="MRTError"}}const Tde={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},H9={uint32:1,uint16:2,uint8:4},Mde={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Ok;class Fk{constructor(c=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=c}getLayer(c){const d=this.layers[c];if(!d)throw new oh(`Layer '${c}' not found`);return d}getHeaderLength(c){const d=new Uint8Array(c),_=new DataView(c);if(d[0]!==13)throw new oh("File is not a valid MRT.");return _.getUint32(1,!0)}parseHeader(c){const d=new Uint8Array(c),_=this.getHeaderLength(c);if(d.length<_)throw new oh(`Expected header with length >= ${_} but got buffer of length ${d.length}`);const A=function(x,T){return x.readFields(rde,{header_length:0,x:0,y:0,z:0,layers:[]},void 0)}(new Ok(d.subarray(0,_)));if(!isNaN(this.x)&&(this.x!==A.x||this.y!==A.y||this.z!==A.z))throw new oh(`Invalid attempt to parse header ${A.z}/${A.x}/${A.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=A.x,this.y=A.y,this.z=A.z;for(const x of A.layers)this.layers[x.name]=new Ede(x,{cacheSize:this._cacheSize});return this}createDecodingTask(c){const d=[],_=this.getLayer(c.layerName);for(let A of c.blockIndices){const x=_.dataIndex[A],T=x.first_byte-c.firstByte,B=x.last_byte-c.firstByte;if(_._blocksInProgress.has(A))continue;const U={layerName:_.name,firstByte:T,lastByte:B,pixelFormat:_.pixelFormat,blockIndex:A,blockShape:[x.bands.length].concat(_.bandShape),buffer:_.buffer,codec:x.codec.codec,filters:x.filters.map(j=>j.filter)};_._blocksInProgress.add(A),d.push(U)}return new j9(d,()=>{d.forEach(A=>_._blocksInProgress.delete(A.blockIndex))},(A,x)=>{if(d.forEach(T=>_._blocksInProgress.delete(T.blockIndex)),A)throw A;x.forEach(T=>{this.getLayer(T.layerName).processDecodedData(T)})})}}class Ede{constructor({version:c,name:d,units:_,tilesize:A,pixel_format:x,buffer:T,data_index:B},U){if(this.version=c,this.version!==1)throw new oh(`Cannot parse raster layer encoded with MRT version ${c}`);this.name=d,this.units=_,this.tileSize=A,this.buffer=T,this.pixelFormat=Tde[x],this.dataIndex=B,this.bandShape=[A+2*T,A+2*T,H9[this.pixelFormat]],this._decodedBlocks=new hde(U?U.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return H9[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:c})=>c).flat()}processDecodedData(c){const d=c.blockIndex.toString();this._decodedBlocks.get(d)||this._decodedBlocks.put(d,c.data)}getBlockForBand(c){let d=0;switch(typeof c){case"string":for(const[_,A]of this.dataIndex.entries()){for(const[x,T]of A.bands.entries())if(T===c)return{bandIndex:d+x,blockIndex:_,blockBandIndex:x};d+=A.bands.length}break;case"number":for(const[_,A]of this.dataIndex.entries()){if(c>=d&&c<d+A.bands.length)return{bandIndex:c,blockIndex:_,blockBandIndex:c-d};d+=A.bands.length}break;default:throw new oh(`Invalid band \`${JSON.stringify(c)}\`. Expected string or integer.`)}throw new oh(`Band not found: ${JSON.stringify(c)}`)}getDataRange(c){let d=1/0,_=-1/0;const A=[],x=new Set;for(const T of c){const{blockIndex:B}=this.getBlockForBand(T);if(B<0)throw new oh(`Invalid band: ${JSON.stringify(T)}`);const U=this.dataIndex[B];A.includes(B)||A.push(B),x.add(B),d=Math.min(d,U.first_byte),_=Math.max(_,U.last_byte)}if(x.size>this.cacheSize)throw new oh(`Number of blocks to decode (${x.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:d,lastByte:_,blockIndices:A}}hasBand(c){const{blockIndex:d}=this.getBlockForBand(c);return d>=0}hasDataForBand(c){const{blockIndex:d}=this.getBlockForBand(c);return d>=0&&!!this._decodedBlocks.get(d.toString())}getBandView(c){const{blockIndex:d,blockBandIndex:_}=this.getBlockForBand(c),A=this._decodedBlocks.get(d.toString());if(!A)throw new oh(`Data for band ${JSON.stringify(c)} of layer "${this.name}" not decoded.`);const x=this.dataIndex[d],T=this.bandShape.reduce((j,R)=>j*R,1),B=_*T,U=A.subarray(B,B+T);return{data:U,bytes:new Uint8Array(U.buffer).subarray(U.byteOffset,U.byteOffset+U.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:x.offset!==0?x.offset:x.deprecated_offset,scale:x.scale!==0?x.scale:x.deprecated_scale}}}Fk.setPbf=function(g){Ok=g};class j9{constructor(c,d,_){this.tasks=c,this._onCancel=d,this._onComplete=_,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(c,d){this._finalized||(this._onComplete(c,d),this._finalized=!0)}}Fk.performDecoding=function(g,c){const d=new Uint8Array(g);return Promise.all(c.tasks.map(_=>{const{layerName:A,firstByte:x,lastByte:T,pixelFormat:B,blockShape:U,blockIndex:j,filters:R,codec:N}=_,V=d.subarray(x,T+1),z=new Uint32Array(U[0]*U[1]*U[2]);let G;if(N!=="gzip_data")throw new oh(`Unhandled codec: ${N}`);return G=function($,K){if(!globalThis.DecompressionStream&&K==="gzip_data")return Promise.resolve(((ne=function(Me){Me[0]==31&&Me[1]==139&&Me[2]==8||Sf(6,"invalid gzip data");var Be=Me[3],Oe=10;4&Be&&(Oe+=2+(Me[10]|Me[11]<<8));for(var Pe=(Be>>3&1)+(Be>>4&1);Pe>0;Pe-=!Me[Oe++]);return Oe+(2&Be)}(he=$))+8>he.length&&Sf(6,"invalid gzip data"),function(Me,Be,Oe,Pe){var Ye=Me.length;if(!Ye||Be.f&&!Be.l)return Oe||new Cu(0);var ze=!Oe,Qe=ze||Be.i!=2,ct=Be.i;ze&&(Oe=new Cu(3*Ye));var ht,ft,mt=function(ov){var y_=Oe.length;if(ov>y_){var wS=new Cu(Math.max(2*y_,ov));wS.set(Oe),Oe=wS}},Ct=Be.f||0,_t=Be.p||0,Ut=Be.b||0,Yt=Be.l,Dt=Be.d,Rn=Be.m,bn=Be.n,dn=8*Ye;do{if(!Yt){Ct=wf(Me,_t,1);var tn=wf(Me,_t+1,3);if(_t+=3,!tn){var nr=Me[(Tr=4+((_t+7)/8|0))-4]|Me[Tr-3]<<8,In=Tr+nr;if(In>Ye){ct&&Sf(0);break}Qe&&mt(Ut+nr),Oe.set(Me.subarray(Tr,In),Ut),Be.b=Ut+=nr,Be.p=_t=8*In,Be.f=Ct;continue}if(tn==1)Yt=yde,Dt=xde,Rn=9,bn=5;else if(tn==2){var Nn=wf(Me,_t,31)+257,wr=wf(Me,_t+10,15)+4,Or=Nn+wf(Me,_t+5,31)+1;_t+=14;for(var Pr=new Cu(Or),Lr=new Cu(19),jr=0;jr<wr;++jr)Lr[gde[jr]]=wf(Me,_t+3*jr,7);_t+=3*wr;var Wr=Bk(Lr),Gi=(1<<Wr)-1,Mi=pS(Lr,Wr);for(jr=0;jr<Or;){var Tr,_i=Mi[wf(Me,_t,Gi)];if(_t+=15&_i,(Tr=_i>>4)<16)Pr[jr++]=Tr;else{var wi=0,ss=0;for(Tr==16?(ss=3+wf(Me,_t,3),_t+=2,wi=Pr[jr-1]):Tr==17?(ss=3+wf(Me,_t,7),_t+=3):Tr==18&&(ss=11+wf(Me,_t,127),_t+=7);ss--;)Pr[jr++]=wi}}var Ws=Pr.subarray(0,Nn),pa=Pr.subarray(Nn);Rn=Bk(Ws),bn=Bk(pa),Yt=pS(Ws,Rn),Dt=pS(pa,bn)}else Sf(1);if(_t>dn){ct&&Sf(0);break}}Qe&&mt(Ut+131072);for(var $s=(1<<Rn)-1,Os=(1<<bn)-1,uo=_t;;uo=_t){var Sa=(wi=Yt[kk(Me,_t)&$s])>>4;if((_t+=15&wi)>dn){ct&&Sf(0);break}if(wi||Sf(2),Sa<256)Oe[Ut++]=Sa;else{if(Sa==256){uo=_t,Yt=null;break}var Uo=Sa-254;Sa>264&&(Uo=wf(Me,_t,(1<<(Tf=O9[jr=Sa-257]))-1)+U9[jr],_t+=Tf);var Qi=Dt[kk(Me,_t)&Os],gc=Qi>>4;if(Qi||Sf(3),_t+=15&Qi,pa=_de[gc],gc>3){var Tf=F9[gc];pa+=kk(Me,_t)&(1<<Tf)-1,_t+=Tf}if(_t>dn){ct&&Sf(0);break}Qe&&mt(Ut+131072);var lh=Ut+Uo;if(Ut<pa){var ch=0-pa,__=Math.min(pa,lh);for(ch+Ut<0&&Sf(3);Ut<__;++Ut)Oe[Ut]=(void 0)[ch+Ut]}for(;Ut<lh;++Ut)Oe[Ut]=Oe[Ut-pa]}}Be.l=Yt,Be.p=uo,Be.b=Ut,Be.f=Ct,Yt&&(Ct=1,Be.m=Rn,Be.d=Dt,Be.n=bn)}while(!Ct);return Ut!=Oe.length&&ze?(ht=Oe,((ft=Ut)==null||ft>ht.length)&&(ft=ht.length),new Cu(ht.subarray(0,ft))):Oe.subarray(0,Ut)}(he.subarray(ne,-8),{i:2},new Cu(((te=he)[(ce=te.length)-4]|te[ce-3]<<8|te[ce-2]<<16|te[ce-1]<<24)>>>0))));var te,ce,he,ne;const de=Ade[K];if(!de)throw new Error(`Unhandled codec: ${K}`);const ge=new globalThis.DecompressionStream(de);return new Response(new Blob([$]).stream().pipeThrough(ge)).arrayBuffer().then(Me=>new Uint8Array(Me))}(V,N).then($=>(function(K,te){K.readFields(cde,te)}(new Ok($),z),new Mde[B](z.buffer))),G.then($=>{for(let K=R.length-1;K>=0;K--)switch(R[K]){case"delta_filter":fde($,U);break;case"zigzag_filter":dde($);break;case"bitshuffle_filter":pde($,B);break;default:throw new oh(`Unhandled filter "${R[K]}"`)}return{layerName:A,blockIndex:j,data:$}}).catch($=>{throw $})}))},Fn(j9,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});var gS={workerUrl:"",workerClass:null,workerParams:void 0};const Nk="mapboxgl_preloaded_worker_pool";class vS{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<vS.workerCount;)this.workers.push(gS.workerClass!=null?new gS.workerClass:new self.Worker(gS.workerUrl,gS.workerParams));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.workers&&this.numActive()===0&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Nk]}numActive(){return Object.keys(this.active).length}}let _S;function gC(){return _S||(_S=new vS),_S}vS.workerCount=2;let yS,zk,Af,i1,Uk,s1=null;function W9(){return Ar()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:zk||nt.DRACO_URL}function $9(){if(Ar()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(i1)return i1;const g=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return i1=WebAssembly.validate(g)?nt.MESHOPT_SIMD_URL:nt.MESHOPT_URL,i1}const vC={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Cde={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},xS={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function X9(g,c,d){const _=d.json.bufferViews.length,A=d.buffers.length;c.bufferView=_,d.json.bufferViews[_]={buffer:A,byteLength:g.byteLength},d.buffers[A]=g}const Gk="KHR_draco_mesh_compression";function Ide(g,c){const d=g.extensions&&g.extensions[Gk];if(!d)return;const _=new Af.Decoder,A=K9(c,d.bufferView),x=new Af.Mesh;if(!_.DecodeArrayToMesh(A,A.byteLength,x))throw new Error("Failed to decode Draco mesh");const T=c.json.accessors[g.indices],B=vC[T.componentType],U=T.count*B.BYTES_PER_ELEMENT,j=Af._malloc(U);B===Uint16Array?_.GetTrianglesUInt16Array(x,U,j):_.GetTrianglesUInt32Array(x,U,j),X9(Af.memory.buffer.slice(j,j+U),T,c),Af._free(j);for(const R of Object.keys(d.attributes)){const N=_.GetAttributeByUniqueId(x,d.attributes[R]),V=c.json.accessors[g.attributes[R]],z=Cde[V.componentType],G=V.count*xS[V.type]*vC[V.componentType].BYTES_PER_ELEMENT,$=Af._malloc(G);_.GetAttributeDataArrayForAllPoints(x,N,Af[z],G,$),X9(Af.memory.buffer.slice($,$+G),V,c),Af._free($)}_.destroy(),x.destroy(),delete g.extensions[Gk]}const _C="EXT_meshopt_compression";function Rde(g,c){if(!g.extensions||!g.extensions[_C])return;const d=g.extensions[_C],_=new Uint8Array(c.buffers[d.buffer],d.byteOffset||0,d.byteLength||0),A=new Uint8Array(d.count*d.byteStride);Uk.decodeGltfBuffer(A,d.count,d.byteStride,_,d.mode,d.filter),g.buffer=c.buffers.length,g.byteOffset=0,c.buffers[g.buffer]=A.buffer,delete g.extensions[_C]}const q9=1179937895,Z9=new TextDecoder("utf8");function Y9(g,c){return new URL(g,c).href}function Pde(g,c,d,_){return fetch(Y9(g.uri,_)).then(A=>A.arrayBuffer()).then(A=>{c.buffers[d]=A})}function K9(g,c){const d=g.json.bufferViews[c];return new Uint8Array(g.buffers[d.buffer],d.byteOffset||0,d.byteLength)}function Lde(g,c,d,_){if(g.uri){const A=Y9(g.uri,_);return fetch(A).then(x=>x.blob()).then(x=>createImageBitmap(x)).then(x=>{c.images[d]=x})}if(g.bufferView!==void 0){const A=K9(c,g.bufferView),x=new Blob([A],{type:g.mimeType});return createImageBitmap(x).then(T=>{c.images[d]=T})}}function J9(g,c=0,d){const _={json:null,images:[],buffers:[]};if(new Uint32Array(g,c,1)[0]===q9){const R=new Uint32Array(g,c);let N=2;const V=(R[N++]>>2)-3,z=R[N++]>>2;if(N++,_.json=JSON.parse(Z9.decode(R.subarray(N,N+z))),N+=z,N<V){const G=R[N++];N++;const $=c+(N<<2);_.buffers[0]=g.slice($,$+G)}}else _.json=JSON.parse(Z9.decode(new Uint8Array(g,c)));const{buffers:A,images:x,meshes:T,extensionsUsed:B,bufferViews:U}=_.json;let j=Promise.resolve();if(A){const R=[];for(let N=0;N<A.length;N++){const V=A[N];V.uri?R.push(Pde(V,_,N,d)):_.buffers[N]||(_.buffers[N]=null)}j=Promise.all(R)}return j.then(()=>{const R=[],N=B&&B.includes(Gk),V=B&&B.includes(_C);if(N&&R.push(function(){if(!Af)return yS??(yS=function(z){let G,$=null;function K(){G=new Uint8Array($.buffer)}function te(){throw new Error("Unexpected Draco error.")}const ce={a:{a:te,d:function(he,ne,de){return G.copyWithin(he,ne,ne+de)},c:function(he){const ne=G.length,de=Math.max(he>>>0,Math.ceil(1.2*ne)),ge=Math.ceil((de-ne)/65536);try{return $.grow(ge),K(),!0}catch{return!1}},b:te}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(z,ce):z.then(he=>he.arrayBuffer()).then(he=>WebAssembly.instantiate(he,ce))).then(he=>{const{Rb:ne,Qb:de,P:ge,T:Me,X:Be,Ja:Oe,La:Pe,Qa:Ye,Va:ze,Wa:Qe,eb:ct,jb:ht,f:ft,e:mt,yb:Ct,zb:_t,Ab:Ut,Bb:Yt,Db:Dt,Gb:Rn}=he.instance.exports;$=mt;const bn=(()=>{let dn=0,tn=0,nr=0,In=0;return Nn=>{nr&&(ne(In),ne(dn),tn+=nr,nr=dn=0),dn||(tn+=128,dn=de(tn));const wr=Nn.length+7&-8;let Or=dn;wr>=tn&&(nr=wr,Or=In=de(wr));for(let Pr=0;Pr<Nn.length;Pr++)G[Or+Pr]=Nn[Pr];return Or}})();return K(),ft(),{memory:mt,_free:ne,_malloc:de,Mesh:class{constructor(){this.ptr=ge()}destroy(){Me(this.ptr)}},Decoder:class{constructor(){this.ptr=Oe()}destroy(){ht(this.ptr)}DecodeArrayToMesh(dn,tn,nr){const In=bn(dn),Nn=Pe(this.ptr,In,tn,nr.ptr);return!!Be(Nn)}GetAttributeByUniqueId(dn,tn){return{ptr:Ye(this.ptr,dn.ptr,tn)}}GetTrianglesUInt16Array(dn,tn,nr){ze(this.ptr,dn.ptr,tn,nr)}GetTrianglesUInt32Array(dn,tn,nr){Qe(this.ptr,dn.ptr,tn,nr)}GetAttributeDataArrayForAllPoints(dn,tn,nr,In,Nn){ct(this.ptr,dn.ptr,tn.ptr,nr,In,Nn)}},DT_INT8:Ct(),DT_UINT8:_t(),DT_INT16:Ut(),DT_UINT16:Yt(),DT_UINT32:Dt(),DT_FLOAT32:Rn()}})}(fetch(W9())),yS.then(z=>{Af=z,yS=void 0}))}()),V&&R.push(function(){if(Uk)return;const z=function(G){let $;const K=WebAssembly.instantiateStreaming(G,{}).then(he=>{$=he.instance,$.exports.__wasm_call_ctors()}),te={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ce={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:K,supported:!0,decodeGltfBuffer(he,ne,de,ge,Me,Be){(function(Oe,Pe,Ye,ze,Qe,ct,ht){const ft=Oe.exports.sbrk,mt=ze+3&-4,Ct=ft(mt*Qe),_t=ft(ct.length),Ut=new Uint8Array(Oe.exports.memory.buffer);Ut.set(ct,_t);const Yt=Pe(Ct,ze,Qe,_t,ct.length);if(Yt===0&&ht&&ht(Ct,mt,Qe),Ye.set(Ut.subarray(Ct,Ct+ze*Qe)),ft(Ct-ft(0)),Yt!==0)throw new Error(`Malformed buffer data: ${Yt}`)})($,$.exports[ce[Me]],he,ne,de,ge,$.exports[te[Be]])}}}(fetch($9()));return z.ready.then(()=>{Uk=z})}()),x)for(let z=0;z<x.length;z++)R.push(Lde(x[z],_,z,d));return(R.length?Promise.all(R):Promise.resolve()).then(()=>{if(N&&T)for(const{primitives:z}of T)for(const G of z)Ide(G,_);if(V&&T&&U)for(const z of U)Rde(z,_);return _})})}function v_(g,c){const d=g.json.bufferViews[c.bufferView],_=vC[c.componentType];return new _(g.buffers[d.buffer],(c.byteOffset||0)+(d.byteOffset||0),c.count*(d.byteStride&&d.byteStride!==xS[c.type]*_.BYTES_PER_ELEMENT?d.byteStride/_.BYTES_PER_ELEMENT:xS[c.type]))}function Vk(g,c,d,_){const A=vC[c.componentType],x=function(R){switch(R){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(A),T=g.json.bufferViews[c.bufferView],B=T.byteStride?T.byteStride/A.BYTES_PER_ELEMENT:xS[c.type],U=d.float32,j=U.length/d.capacity;for(let R=0,N=0;R<c.count*B;R+=B,N+=j)for(let V=0;V<j;V++)U[N+V]=_[R+V]*x;d._trim()}function Dde(g,c,d){const _=g.indices,A=g.attributes,x={};x.indexArray=new wa;const T=c.json.accessors[_],B=T.count/3;x.indexArray.reserve(B);const U=v_(c,T);for(let V=0;V<B;V++)x.indexArray.emplaceBack(U[3*V],U[3*V+1],U[3*V+2]);x.indexArray._trim(),x.vertexArray=new ua;const j=c.json.accessors[A.POSITION];x.vertexArray.reserve(j.count);const R=v_(c,j);for(let V=0;V<j.count;V++)x.vertexArray.emplaceBack(R[3*V],R[3*V+1],R[3*V+2]);if(x.vertexArray._trim(),x.aabb=new Ji(j.min,j.max),x.centroid=function(V,z){const G=[0,0,0],$=V.length;if($>0){for(let K=0;K<$;K++){const te=3*V[K];G[0]+=z[te],G[1]+=z[te+1],G[2]+=z[te+2]}G[0]/=$,G[1]/=$,G[2]/=$}return G}(U,R),A.COLOR_0!==void 0){const V=c.json.accessors[A.COLOR_0],z=xS[V.type],G=v_(c,V);x.colorArray=z===3?new ua:new Ll,x.colorArray.resize(V.count),Vk(c,V,x.colorArray,G)}if(A.NORMAL!==void 0){x.normalArray=new ua;const V=c.json.accessors[A.NORMAL];x.normalArray.resize(V.count);const z=v_(c,V);Vk(c,V,x.normalArray,z)}if(A.TEXCOORD_0!==void 0&&d.length>0){x.texcoordArray=new pc;const V=c.json.accessors[A.TEXCOORD_0];x.texcoordArray.resize(V.count);const z=v_(c,V);Vk(c,V,x.texcoordArray,z)}if(A._FEATURE_ID_RGBA4444!==void 0){const V=c.json.accessors[A._FEATURE_ID_RGBA4444];c.json.extensionsUsed&&c.json.extensionsUsed.includes("EXT_meshopt_compression")&&(x.featureData=v_(c,V))}A._FEATURE_RGBA4444!==void 0&&(x.featureData=new Uint32Array(v_(c,c.json.accessors[A._FEATURE_RGBA4444]).buffer));const N=g.material;return x.material=function(V,z){const{emissiveFactor:G=[0,0,0],alphaMode:$="OPAQUE",alphaCutoff:K=.5,normalTexture:te,occlusionTexture:ce,emissiveTexture:he,doubleSided:ne}=V,{baseColorFactor:de=[1,1,1,1],metallicFactor:ge=1,roughnessFactor:Me=1,baseColorTexture:Be,metallicRoughnessTexture:Oe}=V.pbrMetallicRoughness||{},Pe=ce?z[ce.index]:void 0;if(ce&&ce.extensions&&ce.extensions.KHR_texture_transform&&Pe){const Ye=ce.extensions.KHR_texture_transform;Pe.offsetScale=[Ye.offset[0],Ye.offset[1],Ye.scale[0],Ye.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new vr(...de),metallicFactor:ge,roughnessFactor:Me,baseColorTexture:Be?z[Be.index]:void 0,metallicRoughnessTexture:Oe?z[Oe.index]:void 0},doubleSided:ne,emissiveFactor:G,alphaMode:$,alphaCutoff:K,normalTexture:te?z[te.index]:void 0,occlusionTexture:Pe,emissionTexture:he?z[he.index]:void 0,defined:V.defined===void 0}}(N!==void 0?c.json.materials[N]:{defined:!1},d),x}function Q9(g,c,d){const{matrix:_,rotation:A,translation:x,scale:T,mesh:B,extras:U,children:j}=g,R={};if(R.matrix=_||Le.mat4.fromRotationTranslationScale([],A||[0,0,0,1],x||[0,0,0],T||[1,1,1]),B!==void 0){R.meshes=d[B];const N=R.anchor=[0,0];for(const V of R.meshes){const{min:z,max:G}=V.aabb;N[0]+=z[0]+G[0],N[1]+=z[1]+G[1]}N[0]=Math.floor(N[0]/R.meshes.length/2),N[1]=Math.floor(N[1]/R.meshes.length/2)}if(U&&(U.id&&(R.id=U.id),U.lights&&(R.lights=function(N){if(!N.length)return[];const V=function(te){const ce=atob(te),he=new Uint8Array(ce.length);for(let ne=0;ne<ce.length;ne++)he[ne]=ce.codePointAt(ne);return he}(N),z=[],G=V.length/24,$=new Uint16Array(V.buffer),K=new Float32Array(V.buffer);for(let te=0;te<G;te++){const ce=$[2*te*6]/30,he=$[2*te*6+1]/30,ne=$[2*te*6+10]/100,de=K[6*te+1],ge=K[6*te+2],Me=K[6*te+3],Be=K[6*te+4],Oe=Me-de,Pe=Be-ge,Ye=Math.hypot(Oe,Pe);z.push({pos:[de+.5*Oe,ge+.5*Pe,he],normal:[Pe/Ye,-Oe/Ye,0],width:Ye,height:ce,depth:ne,points:[de,ge,Me,Be]})}return z}(U.lights))),j){const N=[];for(const V of j)N.push(Q9(c.json.nodes[V],c,d));R.children=N}return R}function Bde(g){if(g.vertices.length===0||g.indices.length===0)return null;const c=new KB(g.vertices,g.indices,8,256),[d,_]=[c.min.clone(),c.max.clone()];return{vertices:g.vertices,indices:g.indices,grid:c,min:d,max:_}}function kde(g){if(!g.extras||!g.extras.ground)return null;const c=g.extras.ground;if(!c||!Array.isArray(c)||c.length===0)return null;const d=c[0];if(!d||!Array.isArray(d)||d.length===0)return null;const _=[];for(const T of d){if(!Array.isArray(T)||T.length!==2)continue;const B=T[0],U=T[1];typeof B=="number"&&typeof U=="number"&&_.push(new St(B,U))}if(_.length<3)return null;_.length>1&&_[_.length-1].equals(_[0])&&_.pop();let A=0;for(let T=0;T<_.length;T++){const B=_[T],U=_[(T+1)%_.length],j=_[(T+2)%_.length];A+=(B.x-U.x)*(j.y-U.y)-(j.x-U.x)*(B.y-U.y)}A>0&&_.reverse();const x=$w(_.flatMap(T=>[T.x,T.y]),[]);return x.length===0?null:{vertices:_,indices:x}}function Ode(g,c){const d=[],_=[];let A=0;const x=[];for(const T of g){A=d.length;const B=T.vertexArray.float32,U=T.indexArray.uint16;for(let j=0;j<T.vertexArray.length;j++)x[0]=B[3*j+0],x[1]=B[3*j+1],x[2]=B[3*j+2],Le.vec3.transformMat4(x,x,c),d.push(new St(x[0],x[1]));for(let j=0;j<3*T.indexArray.length;j++)_.push(U[j]+A)}if(_.length%3!=0)return null;for(let T=0;T<_.length;T+=3){const B=d[_[T+0]],U=d[_[T+1]],j=d[_[T+2]];(B.x-U.x)*(j.y-U.y)-(j.x-U.x)*(B.y-U.y)>0&&([_[T+1],_[T+2]]=[_[T+2],_[T+1]])}return{vertices:d,indices:_}}function ej(g){const c=function(U,j){const R=[],N=WebGL2RenderingContext;if(U.json.textures)for(const V of U.json.textures){const z={magFilter:N.LINEAR,minFilter:N.NEAREST,wrapS:N.REPEAT,wrapT:N.REPEAT};V.sampler!==void 0&&Object.assign(z,U.json.samplers[V.sampler]),R.push({image:j[V.source],sampler:z,uploaded:!1})}return R}(g,g.images),d=function(U,j){const R=[];for(const N of U.json.meshes){const V=[];for(const z of N.primitives)V.push(Dde(z,U,j));R.push(V)}return R}(g,c),{scenes:_,scene:A,nodes:x}=g.json,T=_?_[A||0].nodes:x,B=[];for(const U of T)B.push(Q9(x[U],g,d));return function(U,j,R){const N={},V=new Set;for(let z=0;z<U.length;z++){const G=R[j[z]];if(!G.extras)continue;const $=G.extras["mapbox:footprint:version"],K=G.extras["mapbox:footprint:id"];($||K)&&V.add(z),$==="1.0.0"&&K&&(N[K]=z)}for(let z=0;z<U.length;z++){if(V.has(z))continue;const G=U[z],$=R[j[z]];if(!$.extras)continue;let K=null;G.id in N&&(K=Ode(U[N[G.id]].meshes,G.matrix)),K||(K=kde($)),K&&(G.footprint=Bde(K))}if(V.size>0){const z=Array.from(V.values()).sort((G,$)=>G-$);for(let G=z.length-1;G>=0;G--)U.splice(z[G],1)}}(B,T,g.json.nodes),B}function Fde(g){g.heightmap=new Float32Array(4096),g.heightmap.fill(-1);const c=g.vertexArray.float32,d=g.aabb.min[0]-1,_=g.aabb.min[1]-1,A=m_/(g.aabb.max[0]-d+2),x=m_/(g.aabb.max[1]-_+2);for(let T=0;T<c.length;T+=3){const B=c[T+2],U=(c[T+0]-d)*A|0,j=(c[T+1]-_)*x|0;B>g.heightmap[j*m_+U]&&(g.heightmap[j*m_+U]=B)}}function Nde(g,c){const d={};d.indexArray=new wa,d.indexArray.reserve(4*g.length),d.vertexArray=new ua,d.vertexArray.reserve(10*g.length),d.colorArray=new Ll,d.vertexArray.reserve(10*g.length);let _=0;for(const T of g){const B=Math.min(10,Math.max(4,1.3*T.height))*c,U=[-T.normal[1],T.normal[0],0],j=Math.min(.29,.1*T.width/T.depth),R=T.width-2*T.depth*c*(j+.01),N=Le.vec3.scaleAndAdd([],T.pos,U,R/2),V=Le.vec3.scaleAndAdd([],T.pos,U,-R/2),z=[N[0],N[1],N[2]+T.height],G=[V[0],V[1],V[2]+T.height],$=Le.vec3.scaleAndAdd([],T.normal,U,j);Le.vec3.scale($,$,B);const K=Le.vec3.scaleAndAdd([],T.normal,U,-j);Le.vec3.scale(K,K,B),Le.vec3.add($,N,$),Le.vec3.add(K,V,K),N[2]+=.1,V[2]+=.1,d.vertexArray.emplaceBack($[0],$[1],$[2]),d.vertexArray.emplaceBack(K[0],K[1],K[2]),d.vertexArray.emplaceBack(N[0],N[1],N[2]),d.vertexArray.emplaceBack(V[0],V[1],V[2]),d.vertexArray.emplaceBack(z[0],z[1],z[2]),d.vertexArray.emplaceBack(G[0],G[1],G[2]),d.vertexArray.emplaceBack(N[0],N[1],N[2]),d.vertexArray.emplaceBack(V[0],V[1],V[2]),d.vertexArray.emplaceBack($[0],$[1],$[2]),d.vertexArray.emplaceBack(K[0],K[1],K[2]);const te=R/B/2;d.colorArray.emplaceBack(-te-j,-1,te,.8),d.colorArray.emplaceBack(te+j,-1,te,.8),d.colorArray.emplaceBack(-te,0,te,1.3),d.colorArray.emplaceBack(te,0,te,1.3),d.colorArray.emplaceBack(te+j,-.8,te,.7),d.colorArray.emplaceBack(te+j,-.8,te,.7),d.colorArray.emplaceBack(0,0,te,1.3),d.colorArray.emplaceBack(0,0,te,1.3),d.colorArray.emplaceBack(te+j,-1.2,te,.8),d.colorArray.emplaceBack(te+j,-1.2,te,.8),d.indexArray.emplaceBack(6+_,4+_,8+_),d.indexArray.emplaceBack(7+_,9+_,5+_),d.indexArray.emplaceBack(0+_,1+_,2+_),d.indexArray.emplaceBack(1+_,3+_,2+_),_+=10}const A={defined:!0,emissiveFactor:[0,0,0]},x={};return x.baseColorFactor=vr.white,A.pbrMetallicRoughness=x,d.material=A,d.aabb=new Ji([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),d}class tj{constructor(c){this._stringToNumber={},this._numberToString=[];for(let d=0;d<c.length;d++){const _=c[d];this._stringToNumber[_]=d,this._numberToString[d]=_}}encode(c){return this._stringToNumber[c]}decode(c){return this._numberToString[c]}}const zde=["id","tile","layer","source","sourceLayer","state"];class nj{constructor(c,d,_,A,x){this.type="Feature",this._vectorTileFeature=c,this._z=d,this._x=_,this._y=A,this.properties=c.properties,this.id=x}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(c){this._geometry=c}toJSON(){const c={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const d of zde)this[d]!==void 0&&(c[d]=this[d]);return c}}class rj{constructor(c,d){this.tileID=c,this.x=c.canonical.x,this.y=c.canonical.y,this.z=c.canonical.z,this.grid=new Vc(yn,16,0),this.featureIndexArray=new sm,this.promoteId=d,this.is3DTile=!1}insert(c,d,_,A,x,T=0,B=0){const U=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(_,A,x,T);const j=this.grid;for(let R=0;R<d.length;R++){const N=d[R],V=[1/0,1/0,-1/0,-1/0];for(let z=0;z<N.length;z++){const G=N[z];V[0]=Math.min(V[0],G.x),V[1]=Math.min(V[1],G.y),V[2]=Math.max(V[2],G.x),V[3]=Math.max(V[3],G.y)}B!==0&&(V[0]-=B,V[1]-=B,V[2]+=B,V[3]+=B),V[0]<yn&&V[1]<yn&&V[2]>=0&&V[3]>=0&&j.insert(U,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new qx.VectorTile(new XE(this.rawTileData)).layers,this.sourceLayerCoder=new tj(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const c in this.vtLayers)this.vtFeatures[c]=[]}return this.vtLayers}query(c,d,_,A){this.loadVTLayers();const x=c.params||{},T=rs(x.filter),B=c.tileResult,U=c.transform,j=B.bufferedTilespaceBounds,R=this.grid.query(j.min.x,j.min.y,j.max.x,j.max.y,(G,$,K,te)=>Xc(B.bufferedTilespaceGeometry,G,$,K,te));R.sort(Ude);let N=null;U.elevation&&R.length>0&&(N=t1.create(U.elevation,this.tileID));const V={};let z;for(let G=0;G<R.length;G++){const $=R[G];if($===z)continue;z=$;const K=this.featureIndexArray.get($);let te=null;if(this.is3DTile){const ce=this.bucketLayerIDs[0][0],he=d[ce];if(he.type!=="model")continue;const{queryFeature:ne,intersectionZ:de}=he.queryIntersectsMatchingFeature(B,K.featureIndex,T,U);ne&&this.appendToResult(V,ce,K.featureIndex,ne,de)}else this.loadMatchingFeature(V,K,T,x.layers,x.availableImages,d,_,A,(ce,he,ne,de=0)=>(te||(te=fn(ce,this.tileID.canonical,c.tileTransform)),he.queryIntersectsFeature(B,ce,ne,te,this.z,c.transform,c.pixelPosMatrix,N,de)))}return V}loadMatchingFeature(c,d,_,A,x,T,B,U,j){const{featureIndex:R,bucketIndex:N,sourceLayerIndex:V,layoutVertexArrayOffset:z}=d,G=this.bucketLayerIDs[N];if(A&&!function(ce,he){for(let ne=0;ne<ce.length;ne++)if(he.indexOf(ce[ne])>=0)return!0;return!1}(A,G))return;const $=this.sourceLayerCoder.decode(V),K=this.vtLayers[$].feature(R);if(_.needGeometry){const ce=pn(K,!0);if(!_.filter(new ds(this.tileID.overscaledZ),ce,this.tileID.canonical))return}else if(!_.filter(new ds(this.tileID.overscaledZ),K))return;const te=this.getId(K,$);for(let ce=0;ce<G.length;ce++){const he=G[ce];if(A&&A.indexOf(he)<0)continue;const ne=T[he];if(!ne)continue;let de={};te!==void 0&&U&&(de=U.getState(ne.sourceLayer||"_geojsonTileLayer",te));const ge=!j||j(K,ne,de,z);if(!ge)continue;const Me=new nj(K,this.z,this.x,this.y,te),Be=Sr({},B[he]);Be.paint=ij(Be.paint,ne.paint,K,de,x),Be.layout=ij(Be.layout,ne.layout,K,de,x),Me.layer=Be,this.appendToResult(c,he,R,Me,ge)}}appendToResult(c,d,_,A,x){let T=c[d];T===void 0&&(T=c[d]=[]),T.push({featureIndex:_,feature:A,intersectionZ:x})}lookupSymbolFeatures(c,d,_,A,x,T,B,U){const j={};this.loadVTLayers();const R=rs(x);for(const N of c)this.loadMatchingFeature(j,{bucketIndex:_,sourceLayerIndex:A,featureIndex:N,layoutVertexArrayOffset:0},R,T,B,U,d);return j}loadFeature(c){const{featureIndex:d,sourceLayerIndex:_}=c;this.loadVTLayers();const A=this.sourceLayerCoder.decode(_),x=this.vtFeatures[A];if(x[d])return x[d];const T=this.vtLayers[A].feature(d);return x[d]=T,T}hasLayer(c){for(const d of this.bucketLayerIDs)for(const _ of d)if(c===_)return!0;return!1}getId(c,d){let _=c.id;if(this.promoteId){const A=typeof this.promoteId=="string"?this.promoteId:this.promoteId[d];A!=null&&(_=c.properties[A]),typeof _=="boolean"&&(_=Number(_))}return _}}function ij(g,c,d,_,A){return Nr(g,(x,T)=>{const B=c instanceof th?c.get(T):null;return B&&B.evaluate?B.evaluate(d,_,A):B})}function Ude(g,c){return c-g}Fn(rj,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const sj=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Hk{static from(c){if(!(c instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[d,_]=new Uint8Array(c,0,2);if(d!==219)throw new Error("Data does not appear to be in a KDBush format.");const A=_>>4;if(A!==1)throw new Error(`Got v${A} data when expected v1.`);const x=sj[15&_];if(!x)throw new Error("Unrecognized array type.");const[T]=new Uint16Array(c,2,1),[B]=new Uint32Array(c,4,1);return new Hk(B,T,x,c)}constructor(c,d=64,_=Float64Array,A){if(isNaN(c)||c<0)throw new Error(`Unpexpected numItems value: ${c}.`);this.numItems=+c,this.nodeSize=Math.min(Math.max(+d,2),65535),this.ArrayType=_,this.IndexArrayType=c<65536?Uint16Array:Uint32Array;const x=sj.indexOf(this.ArrayType),T=2*c*this.ArrayType.BYTES_PER_ELEMENT,B=c*this.IndexArrayType.BYTES_PER_ELEMENT,U=(8-B%8)%8;if(x<0)throw new Error(`Unexpected typed array class: ${_}.`);A&&A instanceof ArrayBuffer?(this.data=A,this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+B+U,2*c),this._pos=2*c,this._finished=!0):(this.data=new ArrayBuffer(8+T+B+U),this.ids=new this.IndexArrayType(this.data,8,c),this.coords=new this.ArrayType(this.data,8+B+U,2*c),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+x]),new Uint16Array(this.data,2,1)[0]=d,new Uint32Array(this.data,4,1)[0]=c)}add(c,d){const _=this._pos>>1;return this.ids[_]=_,this.coords[this._pos++]=c,this.coords[this._pos++]=d,_}finish(){const c=this._pos>>1;if(c!==this.numItems)throw new Error(`Added ${c} items when expected ${this.numItems}.`);return jk(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(c,d,_,A){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:x,coords:T,nodeSize:B}=this,U=[0,x.length-1,0],j=[];for(;U.length;){const R=U.pop()||0,N=U.pop()||0,V=U.pop()||0;if(N-V<=B){for(let K=V;K<=N;K++){const te=T[2*K],ce=T[2*K+1];te>=c&&te<=_&&ce>=d&&ce<=A&&j.push(x[K])}continue}const z=V+N>>1,G=T[2*z],$=T[2*z+1];G>=c&&G<=_&&$>=d&&$<=A&&j.push(x[z]),(R===0?c<=G:d<=$)&&(U.push(V),U.push(z-1),U.push(1-R)),(R===0?_>=G:A>=$)&&(U.push(z+1),U.push(N),U.push(1-R))}return j}within(c,d,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:A,coords:x,nodeSize:T}=this,B=[0,A.length-1,0],U=[],j=_*_;for(;B.length;){const R=B.pop()||0,N=B.pop()||0,V=B.pop()||0;if(N-V<=T){for(let K=V;K<=N;K++)oj(x[2*K],x[2*K+1],c,d)<=j&&U.push(A[K]);continue}const z=V+N>>1,G=x[2*z],$=x[2*z+1];oj(G,$,c,d)<=j&&U.push(A[z]),(R===0?c-_<=G:d-_<=$)&&(B.push(V),B.push(z-1),B.push(1-R)),(R===0?c+_>=G:d+_>=$)&&(B.push(z+1),B.push(N),B.push(1-R))}return U}}function jk(g,c,d,_,A,x){if(A-_<=d)return;const T=_+A>>1;aj(g,c,T,_,A,x),jk(g,c,d,_,T-1,1-x),jk(g,c,d,T+1,A,1-x)}function aj(g,c,d,_,A,x){for(;A>_;){if(A-_>600){const j=A-_+1,R=d-_+1,N=Math.log(j),V=.5*Math.exp(2*N/3),z=.5*Math.sqrt(N*V*(j-V)/j)*(R-j/2<0?-1:1);aj(g,c,d,Math.max(_,Math.floor(d-R*V/j+z)),Math.min(A,Math.floor(d+(j-R)*V/j+z)),x)}const T=c[2*d+x];let B=_,U=A;for(bS(g,c,_,d),c[2*A+x]>T&&bS(g,c,_,A);B<U;){for(bS(g,c,B,U),B++,U--;c[2*B+x]<T;)B++;for(;c[2*U+x]>T;)U--}c[2*_+x]===T?bS(g,c,_,U):(U++,bS(g,c,U,A)),U<=d&&(_=U+1),d<=U&&(A=U-1)}}function bS(g,c,d,_){Wk(g,d,_),Wk(c,2*d,2*_),Wk(c,2*d+1,2*_+1)}function Wk(g,c,d){const _=g[c];g[c]=g[d],g[d]=_}function oj(g,c,d,_){const A=g-d,x=c-_;return A*A+x*x}a.$=tm,a.A=class extends fC{},a.B=vu,a.C=dd,a.D=ks,a.E=ju,a.F=Dg,a.G=Xp,a.H=e_,a.I=pk,a.J=Sd,a.K=di,a.L=r_,a.M=Ad,a.N=Cl,a.O=ac,a.P=St,a.Q=tf,a.R=Yi,a.S=Bo,a.T=Mk,a.U=Rp,a.V=fC,a.W=Js,a.X=qp,a.Y=Lg,a.Z=function(g){const c=g.value;let d=[];if(!c)return d;const _=vu(c);return _!=="string"?(d=d.concat([new fC(g.key,c,`string expected, "${_}" found`)]),d):(v9(c,!0)||(d=d.concat([new fC(g.key,c,`invalid url "${c}"`)])),d)},a._=At,a.a=function(g){return nt.API_CDN_URL_REGEX.test(g)},a.a$=u_,a.a0=Wi,a.a1=gn,a.a2=class{constructor(g){this.specification=g}possiblyEvaluate(g,c){return Cn(g.expression.evaluate(c))}interpolate(g,c,d){return{x:cr(g.x,c.x,d),y:cr(g.y,c.y,d),z:cr(g.z,c.z,d),azimuthal:cr(g.azimuthal,c.azimuthal,d),polar:cr(g.polar,c.polar,d)}}},a.a3=ds,a.a4=dl,a.a5=bt,a.a6=Le,a.a7=mr,a.a8=th,a.a9=Qg,a.aA=Ki,a.aB=i9,a.aC=u9,a.aD=r9,a.aE=function(g,c){const d=document.createElement("video");d.muted=!0,d.onloadstart=function(){c(null,d)};for(let _=0;_<g.length;_++){const A=document.createElement("source");fs(g[_])||(d.crossOrigin="Anonymous"),A.src=g[_],d.appendChild(A)}return{cancel:()=>{}}},a.aF=oC,a.aG=function(g){return fetch(g).then(c=>c.arrayBuffer()).then(c=>J9(c,0,g))},a.aH=ej,a.aI=class{constructor(g,c,d,_){this.id=g,this.position=c!=null?new ue(c[0],c[1]):new ue(0,0),this.orientation=d??[0,0,0],this.nodes=_,this.uploaded=!1,this.aabb=new Ji([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(g,c){if(Le.mat4.multiply(g.matrix,c,g.matrix),g.meshes)for(const d of g.meshes){const _=Ji.applyTransformFast(d.aabb,g.matrix);this.aabb.encapsulate(_)}if(g.children)for(const d of g.children)this._applyTransformations(d,g.matrix)}computeBoundsAndApplyParent(){const g=Le.mat4.identity([]);for(const c of this.nodes)this._applyTransformations(c,g)}computeModelMatrix(g,c,d,_,A,x,T=!1){w9(this.matrix,this,g.transform,this.position,c,d,_,A,x,T)}upload(g){if(!this.uploaded){for(const c of this.nodes)Pk(c,g);for(const c of this.nodes)dC(c);this.uploaded=!0}}destroy(){for(const g of this.nodes)Lk(g)}},a.aJ=Fr,a.aK=aS,a.aL=$e,a.aM=je,a.aN=Qs,a.aO=wa,a.aP=ir,a.aQ=$g,a.aR=sC,a.aS=function(){No.isLoading()||No.isLoaded()||zg()!=="deferred"||Ug()},a.aT=rs,a.aU=pn,a.aV=nj,a.aW=Vr,a.aX=ak,a.aY=YB,a.aZ=fn,a.a_=hc,a.aa=cr,a.ab=yn,a.ac=fd,a.ad=class{constructor(g){this.specification=g}possiblyEvaluate(g,c){return function([d,_]){const A=Cn([1,d,_]);return{x:A.x,y:A.y,z:A.z}}(g.expression.evaluate(c))}interpolate(g,c,d){return{x:cr(g.x,c.x,d),y:cr(g.y,c.y,d),z:cr(g.z,c.z,d)}}},a.ae=function(g,c,d=0,_=!0){const A=new St(d,d),x=g.sub(A),T=c.add(A),B=[x,new St(T.x,x.y),T,new St(x.x,T.y)];return _&&B.push(x.clone()),B},a.af=function(g,c){const d=[];for(let _=0;_<g.length;_++){const A=Un(_-1,-1,g.length-1),x=Un(_+1,-1,g.length-1),T=g[_],B=g[x],U=g[A].sub(T).unit(),j=B.sub(T).unit(),R=j.angleWithSep(U.x,U.y),N=U.add(j).unit().mult(-1*c/Math.sin(R/2));d.push(T.add(N))}return d},a.ag=HH,a.ah=Xc,a.ai=function(g,c,d=0){return Le.vec3.fromValues(((c.x-d)*g.scale-g.x)*yn,(c.y*g.scale-g.y)*yn,et(c.z,c.y))},a.aj=yf,a.ak=cH,a.al=function(g){let c=1/0,d=1/0,_=-1/0,A=-1/0;for(const x of g)c=Math.min(c,x.x),d=Math.min(d,x.y),_=Math.max(_,x.x),A=Math.max(A,x.y);return{min:new St(c,d),max:new St(_,A)}},a.am=ke,a.an=is,a.ao=Zt,a.ap=jt,a.aq=u,a.ar=function(g,c){const d={};for(let _=0;_<c.length;_++){const A=c[_];A in g&&(d[A]=g[A])}return d},a.as=ve,a.at=Ne,a.au=class{constructor(g){this.entries={},this.scheduler=g}request(g,c,d,_){const A=this.entries[g]=this.entries[g]||{callbacks:[]};if(A.result){const[x,T]=A.result;return this.scheduler?this.scheduler.add(()=>{_(x,T)},c):_(x,T),()=>{}}return A.callbacks.push(_),A.cancel||(A.cancel=d((x,T)=>{A.result=[x,T];for(const B of A.callbacks)this.scheduler?this.scheduler.add(()=>{B(x,T)},c):B(x,T);setTimeout(()=>delete this.entries[g],3e3)})),()=>{A.result||(A.callbacks=A.callbacks.filter(x=>x!==_),A.callbacks.length||(A.cancel(),delete this.entries[g]))}}},a.av=mf,a.aw=function(g,c,d){const _=JSON.stringify(g.request);return g.data&&(this.deduped.entries[_]={result:[null,g.data]}),this.deduped.request(_,{type:"parseTile",isSymbolTile:g.isSymbolTile,zoom:g.tileZoom},A=>{const x=Ds(g.request,(T,B,U,j)=>{T?A(T):B&&A(null,{vectorTile:d?void 0:new qx.VectorTile(new XE(B)),rawData:B,cacheControl:U,expires:j})});return()=>{x.cancel(),A()}},c)},a.ax=function(g){gr++,gr>It&&(g.getActor().send("enforceCacheSizeLimit",Et),gr=0)},a.ay=Mn,a.az=function(g){return g<=1?1:Math.pow(2,Math.floor(Math.log(g)/Math.LN2))},a.b=function(g){return nt.API_FONTS_REGEX.test(g)},a.b$=function(g){const{x:c,y:d}=g.point,{lng:_,lat:A}=g._center;return tV(c,d,g.worldSize,_,A)},a.b0=Zc,a.b1=ws,a.b2=$w,a.b3=Sk,a.b4=function(g,c){const d=Qg(c.zoom);if(d===0)return Ud(g);const _=DE(g),A=GB(_),x=ke(_.getWest())*c.worldSize,T=ke(_.getEast())*c.worldSize,B=Ne(_.getNorth())*c.worldSize,U=Ne(_.getSouth())*c.worldSize,j=[x,B,0],R=[T,B,0],N=[x,U,0],V=[T,U,0],z=Le.mat4.invert([],c.globeMatrix);return Le.vec3.transformMat4(j,j,z),Le.vec3.transformMat4(R,R,z),Le.vec3.transformMat4(N,N,z),Le.vec3.transformMat4(V,V,z),A[0]=cm(A[0],N,d),A[1]=cm(A[1],V,d),A[2]=cm(A[2],R,d),A[3]=cm(A[3],j,d),Ji.fromPoints(A)},a.b5=kE,a.b6=jw,a.b7=cm,a.b8=gf,a.b9=Dl,a.bA=Un,a.bB=sn,a.bC=hi,a.bD=De,a.bE=function(g,c,d){g[4*c+0]=d[0],g[4*c+1]=d[1],g[4*c+2]=d[2],g[4*c+3]=d[3]},a.bF=Wn,a.bG=pe,a.bH=Te,a.bI=se,a.bJ=Y,a.bK=ue,a.bL=qH,a.bM=Na,a.bN=Jg,a.bO=f9,a.bP=Ka,a.bQ=J8,a.bR=function(g,c,d,_,A,x,T,B,U){if(U.name==="globe")return J8(g,c,new Ka(d,_,A),!1);const j=aS({z:d,x:_,y:A},U);return new Ji([(x+j.x/j.scale)*c,c*(j.y/j.scale),T],[(x+j.x2/j.scale)*c,c*(j.y2/j.scale),B])},a.bS=function(g,c,d){let _=0;for(let A=0;A<2;++A)g[A]>0&&(_+=(g[A]-0)*(g[A]-0)),c[A]<0&&(_+=(0-c[A])*(0-c[A]));return _},a.bT=Ke,a.bU=w,a.bV=function(g){const c=Le.mat4.identity(new Float64Array(16));Le.mat4.multiply(c,g.pixelMatrix,g.globeMatrix);const d=[0,W,0],_=[0,q,0];return Le.vec3.transformMat4(d,d,c),Le.vec3.transformMat4(_,_,c),[d[0]>0&&d[0]<=g.width&&d[1]>0&&d[1]<=g.height&&!jB(g,new ue(g.center.lat,90)),_[0]>0&&_[0]<=g.width&&_[1]>0&&_[1]<=g.height&&!jB(g,new ue(g.center.lat,-90))]},a.bW=function(g,c){const{scale:d}=g.tileTransform,_=d*yn/(g.tileSize*Math.pow(2,c.zoom-g.tileID.overscaledZ+g.tileID.canonical.z));return Le.mat2.scale(new Float32Array(4),c.inverseAdjustmentMatrix,[_,_])},a.bX=uC,a.bY=h9,a.bZ=function(g){const c=h9(g,!0);return Le.mat2.invert([],[c[0],c[1],c[4],c[5]])},a.b_=zd,a.ba=Fk,a.bb=XE,a.bc=Ds,a.bd=function(g){const c=[];for(const d in g)c.push(g[d]);return c},a.be=function(g,c){const d=[];for(const _ in g)_ in c||d.push(_);return d},a.bf=tr,a.bg=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.bh=Jt,a.bi=function(g,c){const{x:d,y:_}=g.point,A=tV(d,_,g.worldSize/g._pixelsPerMercatorPixel,0,0);return Le.mat4.multiply(A,A,VB(Ud(c)))},a.bj=Zx,a.bk=Eu,a.bl=$E,a.bm=function(g,c,d,_,A){const x=5*c+2;g.float32[x+0]=d,g.float32[x+1]=_,g.float32[x+2]=A},a.bn=iC,a.bo=LH,a.bp=xn,a.bq=zo,a.br=BV,a.bs=g9,a.bt=zV,a.bu=UV,a.bv=vk,a.bw=zH,a.bx=dk,a.by=Hk,a.bz=vr,a.c=pt,a.c$=gl,a.c0=ot,a.c1=ml,a.c2=m,a.c3=function(g){const c=Math.round((g+45+360)%360/90)%4;return Ge[c]},a.c4=45,a.c5=we,a.c6=dt,a.c7=function(g,c,d){const _=Math.sqrt(g*g+c*c+d*d),A=_>0?Math.acos(d/_)*Gn:0;let x=g!==0||c!==0?Math.atan2(-c,-g)*Gn+90:0;return x<0&&(x+=360),[_,x,A]},a.c8=rt,a.c9=Ji,a.cA=function(g){const c=Ke-5;g=jt(g,-c,c)/c*90;const d=Math.pow(Math.abs(Math.sin(sn(g))),3);return Math.round(d*(F.length-1))},a.cB=function(g,c,d,_){const A=c.getNorth(),x=c.getSouth(),T=c.getWest(),B=c.getEast(),U=1<<g.z,j=B-T,R=A-x,N=j/P,V=-R/F[d],z=[0,N,0,V,0,0,A,T,0];if(g.z>0){const G=180/_;Le.mat3.multiply(z,z,[G/j+1,0,0,0,G/R+1,0,-.5*G/N,.5*G/V,1])}return z[2]=U,z[5]=g.x,z[8]=g.y,z},a.cC=Ud,a.cD=function(g,c,d){const _=Le.mat4.identity(new Float64Array(16)),A=(c/(1<<g)-.5)*Math.PI*2;return Le.mat4.rotateY(_,d.globeMatrix,A),Float32Array.from(_)},a.cE=class{isDataAvailableAtPoint(g){const c=this._source();if(this.isUsingMockSource()||!c||g.y<0||g.y>1)return!1;const d=c.getSource().maxzoom,_=1<<d,A=Math.floor(g.x),x=Math.floor((g.x-A)*_),T=Math.floor(g.y*_),B=this.findDEMTileFor(new Ki(d,A,d,x,T));return!(!B||!B.dem)}getAtPointOrZero(g,c=0){return this.getAtPoint(g,c)||0}getAtPoint(g,c,d=!0){if(this.isUsingMockSource())return null;c==null&&(c=null);const _=this._source();if(!_||g.y<0||g.y>1)return c;const A=_.getSource().maxzoom,x=1<<A,T=Math.floor(g.x),B=g.x-T,U=new Ki(A,T,A,Math.floor(B*x),Math.floor(g.y*x)),j=this.findDEMTileFor(U);if(!j||!j.dem)return c;const R=j.dem,N=1<<j.tileID.canonical.z,V=(B*N-j.tileID.canonical.x)*R.dim,z=(g.y*N-j.tileID.canonical.y)*R.dim,G=Math.floor(V),$=Math.floor(z);return(d?this.exaggeration():1)*cr(cr(R.get(G,$),R.get(G,$+1),z-$),cr(R.get(G+1,$),R.get(G+1,$+1),z-$),V-G)}getAtTileOffset(g,c,d){const _=1<<g.canonical.z;return this.getAtPointOrZero(new bt(g.wrap+(g.canonical.x+c/yn)/_,(g.canonical.y+d/yn)/_))}getAtTileOffsetFunc(g,c,d,_){return A=>{const x=this.getAtTileOffset(g,A.x,A.y),T=_.upVector(g.canonical,A.x,A.y),B=_.upVectorScale(g.canonical,c,d).metersToTile;return Le.vec3.scale(T,T,x*B),T}}getForTilePoints(g,c,d,_){if(this.isUsingMockSource())return!1;const A=t1.create(this,g,_);return!!A&&(c.forEach(x=>{x[2]=this.exaggeration()*A.getElevationAt(x[0],x[1],d)}),!0)}getMinMaxForTile(g){if(this.isUsingMockSource())return null;const c=this.findDEMTileFor(g);if(!c||!c.dem)return null;const d=c.dem.tree,_=c.tileID,A=1<<g.canonical.z-_.canonical.z;let x=g.canonical.x/A-_.canonical.x,T=g.canonical.y/A-_.canonical.y,B=0;for(let U=0;U<g.canonical.z-_.canonical.z&&!d.leaves[B];U++){x*=2,T*=2;const j=2*Math.floor(T)+Math.floor(x);B=d.childOffsets[B]+j,x%=1,T%=1}return{min:this.exaggeration()*d.minimums[B],max:this.exaggeration()*d.maximums[B]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(g,c,d){throw new Error("Pure virtual method called.")}pointCoordinate(g){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(g){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const g=this.visibleDemTiles;if(g.length===0)return null;let c=!1,d=Number.MAX_VALUE,_=Number.MIN_VALUE;for(const A of g){const x=this.getMinMaxForTile(A.tileID);x&&(d=Math.min(d,x.min),_=Math.max(_,x.max),c=!0)}return c?{min:d,max:_}:null}},a.cF=pV,a.cG=lm,a.cH=function(g,c){return[Math.pow(g[0],2.2)*c,Math.pow(g[1],2.2)*c,Math.pow(g[2],2.2)*c]},a.cI=eV,a.cJ=Xe,a.cK=Ce,a.cL=256,a.cM=function(g,c){const d=[0,0,0],_=kE(Ud(c.canonical));return Le.vec3.transformMat4(d,d,_),Le.vec3.transformMat4(d,d,g),d},a.cN=g=>({u_camera_to_center_distance:new se(g),u_extrude_scale:new zr(g),u_device_pixel_ratio:new se(g),u_matrix:new Wn(g),u_inv_rot_matrix:new Wn(g),u_merc_center:new pe(g),u_tile_id:new Te(g),u_zoom_transition:new se(g),u_up_dir:new Te(g),u_emissive_strength:new se(g)}),a.cO=g=>({u_matrix:new Wn(g),u_pixels_to_tile_units:new zr(g),u_device_pixel_ratio:new se(g),u_units_to_pixels:new pe(g),u_dash_image:new Y(g),u_gradient_image:new Y(g),u_image_height:new se(g),u_texsize:new pe(g),u_tile_units_to_pixels:new se(g),u_alpha_discard_threshold:new se(g),u_trim_offset:new pe(g),u_trim_fade_range:new pe(g),u_trim_color:new dt(g),u_emissive_strength:new se(g)}),a.cP=g=>({u_matrix:new Wn(g),u_texsize:new pe(g),u_pixels_to_tile_units:new zr(g),u_device_pixel_ratio:new se(g),u_image:new Y(g),u_units_to_pixels:new pe(g),u_tile_units_to_pixels:new se(g),u_alpha_discard_threshold:new se(g),u_trim_offset:new pe(g)}),a.cQ=bo,a.cR=lfe,a.cS=cfe,a.cT=iV,a.cU=(g,c,d,_,A,x)=>{const T=g.transform,B=T.projection.name==="globe";let U;if(x.paint.get("circle-pitch-alignment")==="map")if(B){const R=eV(T.zoom,c.canonical)*T._pixelsPerMercatorPixel;U=Float32Array.from([R,0,0,R])}else U=T.calculatePixelsToTileUnitsMatrix(d);else U=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const j={u_camera_to_center_distance:g.transform.getCameraToCenterDistance(T.projection),u_matrix:g.translatePosMatrix(c.projMatrix,d,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:En.devicePixelRatio,u_extrude_scale:U,u_inv_rot_matrix:fhe,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:x.paint.get("circle-emissive-strength")};if(B){j.u_inv_rot_matrix=_,j.u_merc_center=A,j.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],j.u_zoom_transition=Qg(T.zoom);const R=A[0]*yn,N=A[1]*yn;j.u_up_dir=T.projection.upVector(new Ka(0,0,0),R,N)}return j},a.cV=fH,a.cW=(g,c,d,_,A,x)=>{const T=g.transform;return{u_matrix:hH(g,c,d,_),u_texsize:c.imageAtlasTexture?c.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(c),u_device_pixel_ratio:A,u_image:0,u_tile_units_to_pixels:uH(c,T),u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:x}},a.cX=(g,c,d,_,A,x,T)=>{const B=g.transform,U=B.calculatePixelsToTileUnitsMatrix(c);return{u_matrix:hH(g,c,d,_),u_pixels_to_tile_units:U,u_device_pixel_ratio:x,u_units_to_pixels:[1/B.pixelsToGLUnits[0],1/B.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:A,u_texsize:dH(d)&&c.lineAtlasTexture?c.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:uH(c,g.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:d.paint.get("line-trim-fade-range"),u_trim_color:d.paint.get("line-trim-color").toRenderColor(d.lut).toArray01(),u_emissive_strength:d.paint.get("line-emissive-strength")}},a.cY=ui,a.cZ=Ww,a.c_=QV,a.ca=Cn,a.cb=function(g){return[Math.pow(g[0],1/2.2),Math.pow(g[1],1/2.2),Math.pow(g[2],1/2.2)]},a.cc=function(g){return g({pluginStatus:ca,pluginURL:lc}),Ng.on("pluginStateChange",g),g},a.cd=n1,a.ce=gC,a.cf=Kx,a.cg=mk,a.ch=ys,a.ci=Ux,a.cj=yt,a.ck=Xa,a.cl=xi,a.cm=function(g){const c=g.indexOf(rh);return c>=0?g.slice(0,c):g},a.cn=function(g){return g.indexOf(rh)>=0},a.co=function(g){const c=g.indexOf(rh);return c>=0?g.slice(c+1):""},a.cp=function(g){const c=[],d=g.id;return d===void 0&&c.push({message:`layers.${d}: missing required property "id"`}),g.render===void 0&&c.push({message:`layers.${d}: missing required method "render"`}),g.renderingMode&&g.renderingMode!=="2d"&&g.renderingMode!=="3d"&&c.push({message:`layers.${d}: property "renderingMode" must be either "2d" or "3d"`}),c},a.cq=function(g,c,d,_){return g.type==="custom"?new Ufe(g,c):new Kfe[g.type](g,c,d,_)},a.cr=Hr,a.cs=Ng,a.ct=$a,a.cu=Ot,a.cv=class extends O{constructor(g){super(g),this.current=br}set(g,c,d){if(this.fetchUniformLocation(g,c)){for(let _=0;_<9;_++)if(d[_]!==this.current[_]){this.current=d,this.gl.uniformMatrix3fv(this.location,!1,d);break}}}},a.cw=Xt,a.cx=function(g,c,d){const _=Qg(d.zoom),A=g.style.map._antialias,x=c.options.extStandardDerivativesForceOff||g.terrain&&g.terrain.exaggeration()>0;return _===0&&!A&&!x},a.cy=function(g){const c=g.pixelsPerMeter,d=c/De(1,g.center.lat),_=Le.mat4.identity(new Float64Array(16));return Le.mat4.translate(_,_,[g.point.x,g.point.y,0]),Le.mat4.scale(_,_,[d,d,c]),Float32Array.from(_)},a.cz=DE,a.d=function(g){return nt.API_TILEJSON_REGEX.test(g)},a.d$=h,a.d0=WE,a.d1=tv,a.d2=450,a.d3=7,a.d4=zfe,a.d5=Qr,a.d6=Wg,a.d7=256,a.d8=VB,a.d9=ua,a.dA=nV,a.dB=function(g){const c=[0,0,0],d=Le.mat4.identity(new Float64Array(16));return Le.mat4.multiply(d,g.pixelMatrix,g.globeMatrix),Le.vec3.transformMat4(c,c,d),new St(c[0],c[1])},a.dC=function(g,c,d=!1){if(ca===Cd||ca===cf||ca===Id)throw new Error("setRTLTextPlugin cannot be called multiple times.");lc=En.resolveURL(g),ca=Cd,uf=c,s_(),d||Ug()},a.dD=zg,a.dE=function(){gC().acquire(Nk)},a.dF=function(){const g=_S;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(Nk),_S=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},a.dG=vS,a.dH=function(g){const c=$n();if(!c)return;const d=c.delete(Mt);g&&d.catch(g).then(()=>g())},a.dI=gS,a.dJ=W9,a.dK=function(g){zk=En.resolveURL(g),s1||(s1=new n1(gC(),new ju)),s1.broadcast("setDracoUrl",zk)},a.dL=$9,a.dM=function(g){i1=En.resolveURL(g),s1||(s1=new n1(gC(),new ju)),s1.broadcast("setMeshoptUrl",i1)},a.dN=Fn,a.dO=ev,a.dP=bf,a.dQ=tj,a.dR=rj,a.dS=sH,a.dT=Nr,a.dU=BH,a.dV=function(g,c,d,_,A,x,T,B,U,j,R){g.createArrays(),g.tilePixelRatio=yn/(512*g.overscaling),g.compareText={},g.iconsNeedLinear=!1;const N=g.layers[0].layout,V=g.layers[0]._unevaluatedLayout._values,z={};if(g.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:ce}=g.textSizeData;z.compositeTextSizes=[V["text-size"].possiblyEvaluate(new ds(te),B),V["text-size"].possiblyEvaluate(new ds(ce),B)]}if(g.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:ce}=g.iconSizeData;z.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new ds(te),B),V["icon-size"].possiblyEvaluate(new ds(ce),B)]}z.layoutTextSize=V["text-size"].possiblyEvaluate(new ds(U+1),B),z.layoutIconSize=V["icon-size"].possiblyEvaluate(new ds(U+1),B),z.textMaxSize=V["text-size"].possiblyEvaluate(new ds(18),B);const G=N.get("text-rotation-alignment")==="map"&&N.get("symbol-placement")!=="point",$=N.get("text-size");let K=!1;for(const te of g.features)if(te.icon&&te.icon.nameSecondary){K=!0;break}for(const te of g.features){const ce=N.get("text-font").evaluate(te,{},B).join(","),he=$.evaluate(te,{},B),ne=z.layoutTextSize.evaluate(te,{},B),de=(z.layoutIconSize.evaluate(te,{},B),{horizontal:{},vertical:void 0}),ge=te.text;let Me,Be=[0,0];if(ge){const Ye=ge.toString(),ze=N.get("text-letter-spacing").evaluate(te,{},B)*zo,Qe=N.get("text-line-height").evaluate(te,{},B)*zo,ct=Qp(Ye)?ze:0,ht=N.get("text-anchor").evaluate(te,{},B),ft=N.get("text-variable-anchor");if(!ft){const Yt=N.get("text-radial-offset").evaluate(te,{},B);Be=Yt?zH(ht,[Yt*zo,gk]):N.get("text-offset").evaluate(te,{},B).map(Dt=>Dt*zo)}let mt=G?"center":N.get("text-justify").evaluate(te,{},B);const Ct=N.get("symbol-placement")==="point",_t=Ct?N.get("text-max-width").evaluate(te,{},B)*zo:1/0,Ut=Yt=>{g.allowVerticalPlacement&&Hc(Ye)&&(de.vertical=fk(ge,c,d,A,ce,_t,Qe,ht,Yt,ct,Be,Eu.vertical,!0,ne,he))};if(!G&&ft){const Yt=mt==="auto"?ft.map(Rn=>vk(Rn)):[mt];let Dt=!1;for(let Rn=0;Rn<Yt.length;Rn++){const bn=Yt[Rn];if(!de.horizontal[bn])if(Dt)de.horizontal[bn]=de.horizontal[0];else{const dn=fk(ge,c,d,A,ce,_t,Qe,"center",bn,ct,Be,Eu.horizontal,!1,ne,he);dn&&(de.horizontal[bn]=dn,Dt=dn.positionedLines.length===1)}}Ut("left")}else{if(mt==="auto"&&(mt=vk(ht)),Ct||N.get("text-writing-mode").indexOf("horizontal")>=0||!Hc(Ye)){const Yt=fk(ge,c,d,A,ce,_t,Qe,ht,mt,ct,Be,Eu.horizontal,!1,ne,he);Yt&&(de.horizontal[mt]=Yt)}Ut(Ct?"left":mt)}}let Oe=!1;if(te.icon&&te.icon.namePrimary){const Ye=_[te.icon.namePrimary];Ye&&(Me=yfe(A[te.icon.namePrimary],te.icon.nameSecondary?A[te.icon.nameSecondary]:void 0,N.get("icon-offset").evaluate(te,{},B),N.get("icon-anchor").evaluate(te,{},B)),Oe=Ye.sdf,g.sdfIcons===void 0?g.sdfIcons=Ye.sdf:g.sdfIcons!==Ye.sdf&&Lt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ye.pixelRatio!==g.pixelRatio||N.get("icon-rotate").constantOr(1)!==0)&&(g.iconsNeedLinear=!0))}const Pe=GH(de.horizontal)||de.vertical;g.iconsInText||(g.iconsInText=!!Pe&&Pe.iconsInText),(Pe||Me)&&Mfe(g,te,de,Me,_,z,ne,0,Be,Oe,T,B,j,R,K)}x&&g.generateCollisionDebugBuffers(U,g.collisionBoxArray)},a.dW=qx,a.dX=mC,a.dY=cn,a.dZ=RV,a.d_=yH,a.da=$c,a.db=jg,a.dc=function(g,c,d,_,A){return jt((g-c)/(d-c)*(A-_)+_,_,A)},a.dd=Ju,a.de=ut,a.df=class{constructor(g,c,d,_){this.context=g,this.format=_,this.size=d,this.texture=g.gl.createTexture();const[A,x,T]=this.size,{gl:B}=g;B.bindTexture(B.TEXTURE_3D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(!1),B.texImage3D(B.TEXTURE_3D,0,this.format,A,x,T,0,Ak(this.format),Tk(this.format),c.data)}bind(g,c){const{context:d}=this,{gl:_}=d;_.bindTexture(_.TEXTURE_3D,this.texture),g!==this.minFilter&&(_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MAG_FILTER,g),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_MIN_FILTER,g),this.minFilter=g),c!==this.wrapS&&(_.texParameteri(_.TEXTURE_3D,_.TEXTURE_WRAP_S,c),_.texParameteri(_.TEXTURE_3D,_.TEXTURE_WRAP_T,c),this.wrapS=c)}destroy(){const{gl:g}=this.context;g.deleteTexture(this.texture),this.texture=null}},a.dg=Ik,a.dh=[1,1,1],a.di=t1,a.dj=e1,a.dk=Tu,a.dl=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new St(1/0,1/0),max:new St(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(g,c=!1){const d=OV(new St(0,0),new St(yn,yn),g),_=[];if(c&&!tk(d,this._globalClipBounds))return _;for(const A of this._activeRegions){if(A.hiddenByOverlap||!tk(d,A))continue;const x=khe(A.min,A.max,g);_.push({min:x.min,max:x.max,sourceId:this._sourceIds[A.priority],footprint:A.footprint,footprintTileId:A.tileId,order:A.order,clipMask:A.clipMask,clipScope:A.clipScope})}return _}setSources(g){this._setSources(g.map(c=>({getSourceId:()=>c.cache.id,getFootprints:()=>{const d=[];for(const _ of c.cache.getVisibleCoordinates()){const A=c.cache.getTile(_).buckets[c.layer];A&&A.updateFootprints(_.toUnwrapped(),d)}return d},getOrder:()=>c.order,getClipMask:()=>c.clipMask,getClipScope:()=>c.clipScope})))}_addSource(g){const c=g.getFootprints();if(c.length===0)return;const d=g.getOrder(),_=g.getClipMask(),A=g.getClipScope();for(const x of c){if(!x.footprint)continue;const T=OV(x.footprint.min,x.footprint.max,x.id);this._activeRegions.push({min:T.min,max:T.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:x.id,footprint:x.footprint,order:d,clipMask:_,clipScope:A})}this._sourceIds.push(g.getSourceId())}_computeReplacement(){this._activeRegions.sort((c,d)=>c.priority-d.priority||HE(c.min,d.min)||HE(c.max,d.max)||c.order-d.order||c.clipMask-d.clipMask||function(_,A){const x=(T,B)=>T+B;return _.length-A.length||_.reduce(x,"").localeCompare(A.reduce(x,""))}(c.clipScope,d.clipScope));let g=this._activeRegions.length!==this._prevRegions.length;if(!g){let c=0;for(;!g&&c!==this._activeRegions.length;){const d=this._activeRegions[c],_=this._prevRegions[c];g=d.priority!==_.priority||!kV(d,_)||d.order!==_.order||d.clipMask!==_.clipMask||!Jt(d.clipScope,_.clipScope),++c}}if(g){++this._updateTime;for(const d of this._activeRegions)d.order!==VE&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,d.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,d.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,d.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,d.max.y));const c=d=>{const _=this._activeRegions;if(d>=_.length)return d;const A=_[d].priority;for(;d<_.length&&_[d].priority===A;)++d;return d};if(this._sourceIds.length>1){let d=0,_=c(d);for(;d!==_;){let A=d;const x=d;for(;A!==_;){const T=this._activeRegions[A];T.hiddenByOverlap=!1;for(let B=0;B<x;B++){const U=this._activeRegions[B];if(!U.hiddenByOverlap&&T.order===VE&&tk(T,U)&&(T.hiddenByOverlap=NV(T.footprint,T.tileId,U.footprint,U.tileId),T.hiddenByOverlap))break}++A}d=_,_=c(d)}}}}_setSources(g){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let c=g.length-1;c>=0;c--)this._addSource(g[c]);this._computeReplacement()}},a.dm=class{constructor(g){this._createGrid(g),this._createPoles(g)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const g of this._poleSegments)g.destroy();for(const g of this._gridSegments)g.withSkirts.destroy(),g.withoutSkirts.destroy()}_fillGridMeshWithLods(g,c){const d=new hc,_=new wa,A=[],x=g+1+2,T=c[0]+1,B=c[0]+1+(1+c.length),U=(j,R,N)=>{let V=j===x-1?j-2:j===0?j:j-1;return V+=N?24575:0,[V,R]};for(let j=0;j<x;++j)d.emplaceBack(...U(j,0,!0));for(let j=0;j<T;++j)for(let R=0;R<x;++R)d.emplaceBack(...U(R,j,(R===0||R===x-1)&&!0));for(let j=0;j<c.length;++j){const R=c[j];for(let N=0;N<x;++N)d.emplaceBack(...U(N,R,!0))}for(let j=0;j<c.length;++j){const R=_.length,N=c[j]+1+2,V=new wa;for(let $=0;$<N-1;$++){const K=$===N-2,te=K?x*(B-c.length+j-$):x;for(let ce=0;ce<x-1;ce++){const he=$*x+ce;$===0||K||ce===0||ce===x-2?(V.emplaceBack(he+1,he,he+te),V.emplaceBack(he+te,he+te+1,he+1)):(_.emplaceBack(he+1,he,he+te),_.emplaceBack(he+te,he+te+1,he+1))}}const z=ws.simpleSegment(0,R,d.length,_.length-R);for(let $=0;$<V.uint16.length;$+=3)_.emplaceBack(V.uint16[$],V.uint16[$+1],V.uint16[$+2]);const G=ws.simpleSegment(0,R,d.length,_.length-R);A.push({withoutSkirts:z,withSkirts:G})}return{vertices:d,indices:_,segments:A}}_createGrid(g){const c=this._fillGridMeshWithLods(P,F);this._gridSegments=c.segments,this._gridBuffer=g.createVertexBuffer(c.vertices,Zc.members),this._gridIndexBuffer=g.createIndexBuffer(c.indices,!0)}_createPoles(g){const c=new wa;for(let T=0;T<=P;T++)c.emplaceBack(0,T+1,T+2);this._poleIndexBuffer=g.createIndexBuffer(c,!0);const d=new $c,_=new $c,A=new $c,x=new $c;this._poleSegments=[];for(let T=0,B=0;T<m;T++){const U=360/(1<<T);d.emplaceBack(0,-u,0,.5,0),_.emplaceBack(0,-u,0,.5,1),A.emplaceBack(0,-u,0,.5,.5),x.emplaceBack(0,-u,0,.5,.5);for(let j=0;j<=P;j++){let R=j/P,N=0;const V=cr(0,U,R),[z,G,$]=J(uhe,hhe,V,u);d.emplaceBack(z,G,$,R,N),_.emplaceBack(z,G,$,R,1-N);const K=sn(V);R=.5+.5*Math.sin(K),N=.5+.5*Math.cos(K),A.emplaceBack(z,G,$,R,N),x.emplaceBack(z,G,$,R,1-N)}this._poleSegments.push(ws.simpleSegment(B,0,66,64)),B+=66}this._poleNorthVertexBuffer=g.createVertexBuffer(d,mc,!1),this._poleSouthVertexBuffer=g.createVertexBuffer(_,mc,!1),this._texturedPoleNorthVertexBuffer=g.createVertexBuffer(A,mc,!1),this._texturedPoleSouthVertexBuffer=g.createVertexBuffer(x,mc,!1)}getGridBuffers(g,c){return[this._gridBuffer,this._gridIndexBuffer,c?this._gridSegments[g].withSkirts:this._gridSegments[g].withoutSkirts]}getPoleBuffers(g,c){return[c?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,c?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[g]]}},a.dn=VE,a.dp=An,a.dq=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},a.dr=Sn,a.ds=at,a.dt=ee,a.du=function([g,c,d]){const _=Math.hypot(g,c,d),A=Math.atan2(g,d),x=.5*Math.PI-Math.acos(-c/_);return new ue(ot(A),ot(x))},a.dv=Ck,a.dw=ae,a.dx=function(g){const c=g.navigator?g.navigator.userAgent:null;return!!function(d){if(Ls==null){const _=d.navigator?d.navigator.userAgent:null;Ls=!!d.safari||!(!_||!(/\b(iPad|iPhone|iPod)\b/.test(_)||_.match("Safari")&&!_.match("Chrome")))}return Ls}(g)&&c&&(c.match("Version/15.4")||c.match("Version/15.5")||c.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.dy=function(g,c){Et=g,It=c},a.dz=jB,a.e=nt,a.e0=function(g){let c=0;if(new Uint32Array(g,0,1)[0]!==q9){const d=new Uint32Array(g,0,7),[,,_,A,x,T]=d;c=d.byteLength+A+x+T+x,(_!==g.byteLength||c>=g.byteLength)&&Lt("Invalid b3dm header information.")}return J9(g,c)},a.e1=function(g,c){const d=ej(g);for(const _ of d){for(const A of _.meshes)Fde(A);_.lights&&(_.lightMeshIndex=_.meshes.length,_.meshes.push(Nde(_.lights,c)))}return d},a.e2=pC,a.e3=C9,a.e4=No,a.e5=function(g){lr(),_n!=null&&_n.then(c=>{c.keys().then(d=>{for(let _=0;_<d.length-g;_++)c.delete(d[_])})})},a.f=function(g){return g.indexOf("mapbox:")===0},a.g=function(g,c){return $a(Sr(g,{method:"GET"}),c)},a.h=Je,a.i=function(g){return nt.API_STYLE_REGEX.test(g)&&!pt(g)},a.j=function(g){return decodeURIComponent(atob(g).split("").map(c=>"%"+("00"+c.charCodeAt(0).toString(16)).slice(-2)).join(""))},a.k=function(g){return btoa(encodeURIComponent(g).replace(/%([0-9A-F]{2})/g,(c,d)=>String.fromCharCode(+("0x"+d))))},a.l=Sr,a.m=dr,a.n=function(g,c){return $a(Sr(g,{type:"json"}),c)},a.o=Ts,a.p=function(g,c){return $a(Sr(g,{method:"POST"}),c)},a.q=En,a.r=vl,a.s=function(g){try{const c=self[g];return c.setItem("_mapbox_test_",1),c.removeItem("_mapbox_test_"),!0}catch{return!1}},a.t=Cp,a.u=function(){return function g(c){return c?(c^Math.random()*(16>>c/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,g)}()},a.v=function(g){return!!g&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(g)},a.w=Lt,a.x=Ql,a.y=2,a.z=DH}),o(["./shared"],function(a){function h(Tt){const xe=Tt?Tt.url.toString():void 0;return xe?performance.getEntriesByName(xe):[]}function f(Tt){if(typeof Tt=="number"||typeof Tt=="boolean"||typeof Tt=="string"||Tt==null)return JSON.stringify(Tt);if(Array.isArray(Tt)){let Ce="[";for(const Xe of Tt)Ce+=`${f(Xe)},`;return`${Ce}]`}let xe="{";for(const Ce of Object.keys(Tt).sort())xe+=`${Ce}:${f(Tt[Ce])},`;return`${xe}}`}function p(Tt){let xe="";for(const Ce of a.bg)xe+=`/${f(Tt[Ce])}`;return xe}class v{constructor(xe){this.keyCache={},this._layers={},this._layerConfigs={},xe&&this.replace(xe)}replace(xe,Ce){this._layerConfigs={},this._layers={},this.update(xe,[],Ce)}update(xe,Ce,Xe){this._options=Xe;for(const Je of xe)this._layerConfigs[Je.id]=Je,(this._layers[Je.id]=a.cq(Je,this.scope,null,this._options)).compileFilter(Xe),this.keyCache[Je.id]&&delete this.keyCache[Je.id];for(const Je of Ce)delete this.keyCache[Je],delete this._layerConfigs[Je],delete this._layers[Je];this.familiesBySource={};const nt=function(Je,pt){const Rt={};for(let Pt=0;Pt<Je.length;Pt++){const zt=pt&&pt[Je[Pt].id]||p(Je[Pt]);pt&&(pt[Je[Pt].id]=zt);let Bt=Rt[zt];Bt||(Bt=Rt[zt]=[]),Bt.push(Je[Pt])}const gt=[];for(const Pt in Rt)gt.push(Rt[Pt]);return gt}(a.bd(this._layerConfigs),this.keyCache);for(const Je of nt){const pt=Je.map(ln=>this._layers[ln.id]),Rt=pt[0];if(Rt.visibility==="none")continue;const gt=Rt.source||"";let Pt=this.familiesBySource[gt];Pt||(Pt=this.familiesBySource[gt]={});const zt=Rt.sourceLayer||"_geojsonTileLayer";let Bt=Pt[zt];Bt||(Bt=Pt[zt]=[]),Bt.push(pt)}}}const y=1*a.dP;class S{constructor(xe){const Ce={},Xe=[];for(const Rt in xe){const gt=xe[Rt],Pt=Ce[Rt]={};for(const zt in gt.glyphs){const Bt=gt.glyphs[+zt];if(!Bt||Bt.bitmap.width===0||Bt.bitmap.height===0)continue;const ln=Bt.metrics.localGlyph?y:1,Mn={x:0,y:0,w:Bt.bitmap.width+2*ln,h:Bt.bitmap.height+2*ln};Xe.push(Mn),Pt[zt]=Mn}}const{w:nt,h:Je}=a.z(Xe),pt=new a.dO({width:nt||1,height:Je||1});for(const Rt in xe){const gt=xe[Rt];for(const Pt in gt.glyphs){const zt=gt.glyphs[+Pt];if(!zt||zt.bitmap.width===0||zt.bitmap.height===0)continue;const Bt=Ce[Rt][Pt],ln=zt.metrics.localGlyph?y:1;a.dO.copy(zt.bitmap,pt,{x:0,y:0},{x:Bt.x+ln,y:Bt.y+ln},zt.bitmap)}}this.image=pt,this.positions=Ce}}a.dN(S,"GlyphAtlas");class C{constructor(xe){this.tileID=new a.aA(xe.tileID.overscaledZ,xe.tileID.wrap,xe.tileID.canonical.z,xe.tileID.canonical.x,xe.tileID.canonical.y),this.tileZoom=xe.tileZoom,this.uid=xe.uid,this.zoom=xe.zoom,this.lut=xe.lut,this.canonical=xe.tileID.canonical,this.pixelRatio=xe.pixelRatio,this.tileSize=xe.tileSize,this.source=xe.source,this.scope=xe.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=xe.showCollisionBoxes,this.collectResourceTiming=!!xe.collectResourceTiming,this.promoteId=xe.promoteId,this.isSymbolTile=xe.isSymbolTile,this.tileTransform=a.aK(xe.tileID.canonical,xe.projection),this.projection=xe.projection,this.brightness=xe.brightness,this.extraShadowCaster=!!xe.extraShadowCaster,this.tessellationStep=xe.tessellationStep}parse(xe,Ce,Xe,nt,Je){this.status="parsing",this.data=xe,this.collisionBoxArray=new a.aQ;const pt=new a.dQ(Object.keys(xe.layers).sort()),Rt=new a.dR(this.tileID,this.promoteId);Rt.bucketLayerIDs=[];const gt={},Pt=new a.dS(256,256),zt={featureIndex:Rt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Pt,availableImages:Xe,brightness:this.brightness},Bt=Ce.familiesBySource[this.source];for(const Et in Bt){const It=xe.layers[Et];if(!It)continue;let wn=!1,_n=!1,zn=!1;for(const gr of Bt[Et])gr[0].type==="symbol"?wn=!0:_n=!0,gr[0].is3D()&&gr[0].type!=="model"&&(zn=!0);if(this.extraShadowCaster&&!zn||this.isSymbolTile===!0&&!wn||this.isSymbolTile===!1&&!_n)continue;It.version===1&&a.w(`Vector tile source "${this.source}" layer "${Et}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const $n=pt.encode(Et),lr=[];for(let gr=0;gr<It.length;gr++){const dr=It.feature(gr),fi=Rt.getId(dr,Et);lr.push({feature:dr,id:fi,index:gr,sourceLayerIndex:$n})}for(const gr of Bt[Et]){const dr=gr[0];(!this.extraShadowCaster||dr.is3D()&&dr.type!=="model")&&(this.isSymbolTile!==void 0&&dr.type==="symbol"!==this.isSymbolTile||dr.minzoom&&this.zoom<Math.floor(dr.minzoom)||dr.maxzoom&&this.zoom>=dr.maxzoom||dr.visibility!=="none"&&(M(gr,this.zoom,zt.brightness,Xe),(gt[dr.id]=dr.createBucket({index:Rt.bucketLayerIDs.length,layers:gr,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:$n,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(lr,zt,this.tileID.canonical,this.tileTransform),Rt.bucketLayerIDs.push(gr.map(fi=>fi.id))))}}let ln,Mn,En,Ve;Pt.trim();const yt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Mt=()=>{if(ln)return this.status="done",Je(ln);if(this.extraShadowCaster)this.status="done",Je(null,{buckets:a.bd(gt).filter(Et=>!Et.isEmpty()),featureIndex:Rt,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:zt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Mn&&En&&Ve){const Et=new S(Mn),It=new a.dU(En,Ve,this.lut);for(const wn in gt){const _n=gt[wn];_n instanceof a.aR?(M(_n.layers,this.zoom,zt.brightness,Xe),a.dV(_n,Mn,Et.positions,En,It.iconPositions,this.showCollisionBoxes,Xe,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):_n.hasPattern&&(_n instanceof a.aX||_n instanceof a.aY||_n instanceof a.d0)&&(M(_n.layers,this.zoom,zt.brightness,Xe),_n.addFeatures(zt,this.tileID.canonical,It.patternPositions,Xe,this.tileTransform,this.brightness))}this.status="done",Je(null,{buckets:a.bd(gt).filter(wn=>!wn.isEmpty()),featureIndex:Rt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Et.image,lineAtlas:Pt,imageAtlas:It,brightness:zt.brightness})}};if(!this.extraShadowCaster){const Et=a.dT(zt.glyphDependencies,_n=>Object.keys(_n).map(Number));Object.keys(Et).length?nt.send("getGlyphs",{uid:this.uid,stacks:Et,scope:this.scope},(_n,zn)=>{ln||(ln=_n,Mn=zn,Mt())},void 0,!1,yt):Mn={};const It=Object.keys(zt.iconDependencies);It.length?nt.send("getImages",{icons:It,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(_n,zn)=>{ln||(ln=_n,En=zn,Mt())},void 0,!1,yt):En={};const wn=Object.keys(zt.patternDependencies);wn.length?nt.send("getImages",{icons:wn,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(_n,zn)=>{ln||(ln=_n,Ve=zn,Mt())},void 0,!1,yt):Ve={}}Mt()}}function M(Tt,xe,Ce,Xe){const nt=new a.a3(xe,{brightness:Ce});for(const Je of Tt)Je.recalculate(nt,Xe)}class E extends a.E{constructor(xe,Ce,Xe,nt,Je,pt){super(),this.actor=xe,this.layerIndex=Ce,this.availableImages=Xe,this.loadVectorData=Je||a.aw,this.loading={},this.loaded={},this.deduped=new a.au(xe.scheduler),this.isSpriteLoaded=nt,this.scheduler=xe.scheduler,this.brightness=pt}loadTile(xe,Ce){const Xe=xe.uid,nt=xe&&xe.request,Je=nt&&nt.collectResourceTiming,pt=this.loading[Xe]=new C(xe);pt.abort=this.loadVectorData(xe,(Rt,gt)=>{const Pt=!this.loading[Xe];if(delete this.loading[Xe],Pt||Rt||!gt)return pt.status="done",Pt||(this.loaded[Xe]=pt),Ce(Rt);const zt=gt.rawData,Bt={};gt.expires&&(Bt.expires=gt.expires),gt.cacheControl&&(Bt.cacheControl=gt.cacheControl),pt.vectorTile=gt.vectorTile||new a.dW.VectorTile(new a.bb(zt));const ln=()=>{pt.parse(pt.vectorTile,this.layerIndex,this.availableImages,this.actor,(Mn,En)=>{if(Mn||!En)return Ce(Mn);const Ve={};if(Je){const yt=h(nt);yt.length>0&&(Ve.resourceTiming=JSON.parse(JSON.stringify(yt)))}Ce(null,a.l({rawTileData:zt.slice(0)},En,Bt,Ve))})};this.isSpriteLoaded?ln():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(ln,{type:"parseTile",isSymbolTile:xe.isSymbolTile,zoom:xe.tileZoom}):ln()}),this.loaded=this.loaded||{},this.loaded[Xe]=pt})}reloadTile(xe,Ce){const Xe=this.loaded,nt=xe.uid;if(Xe&&Xe[nt]){const Je=Xe[nt];Je.showCollisionBoxes=xe.showCollisionBoxes,Je.projection=xe.projection,Je.brightness=xe.brightness,Je.tileTransform=a.aK(xe.tileID.canonical,xe.projection),Je.extraShadowCaster=xe.extraShadowCaster,Je.lut=xe.lut;const pt=(Rt,gt)=>{const Pt=Je.reloadCallback;Pt&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,Pt)),Ce(Rt,gt)};Je.status==="parsing"?Je.reloadCallback=pt:Je.status==="done"&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,pt):pt())}else Ce(null,void 0)}abortTile(xe,Ce){const Xe=xe.uid,nt=this.loading[Xe];nt&&(nt.abort&&nt.abort(),delete this.loading[Xe]),Ce()}removeTile(xe,Ce){const Xe=this.loaded,nt=xe.uid;Xe&&Xe[nt]&&delete Xe[nt],Ce()}}class L{loadTile(xe,Ce){const{uid:Xe,encoding:nt,rawImageData:Je,padding:pt}=xe,Rt=ImageBitmap&&Je instanceof ImageBitmap?this.getImageData(Je,pt):Je;Ce(null,new a.dX(Xe,Rt,nt,pt<1))}getImageData(xe,Ce){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(xe.width,xe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=xe.width,this.offscreenCanvas.height=xe.height,this.offscreenCanvasContext.drawImage(xe,0,0,xe.width,xe.height);const Xe=this.offscreenCanvasContext.getImageData(-Ce,-Ce,xe.width+2*Ce,xe.height+2*Ce);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Xe}}a.ba.setPbf(a.bb);class k{decodeRasterArray({task:xe,buffer:Ce},Xe){a.ba.performDecoding(Ce,xe).then(nt=>{Xe(null,nt)},nt=>{Xe(nt)})}}const H=a.dW.VectorTileFeature.prototype.toGeoJSON;class X{constructor(xe){this._feature=xe,this.extent=a.ab,this.type=xe.type,this.properties=xe.tags,"id"in xe&&!isNaN(xe.id)&&(this.id=parseInt(xe.id,10))}loadGeometry(){if(this._feature.type===1){const xe=[];for(const Ce of this._feature.geometry)xe.push([new a.P(Ce[0],Ce[1])]);return xe}{const xe=[];for(const Ce of this._feature.geometry){const Xe=[];for(const nt of Ce)Xe.push(new a.P(nt[0],nt[1]));xe.push(Xe)}return xe}}toGeoJSON(xe,Ce,Xe){return H.call(this,xe,Ce,Xe)}}class Z{constructor(xe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.ab,this.length=xe.length,this._features=xe}feature(xe){return new X(this._features[xe])}}const Q=64/4096,re=128;class ie{constructor(){this.features=new Map}clear(){this.features.clear()}load(xe=[],Ce){for(const Xe of xe){const nt=Xe.id;if(nt==null)continue;let Je=this.features.get(nt);Je&&this.updateCache(Je,Ce),Xe.geometry?(Je=fe(Xe),this.updateCache(Je,Ce),this.features.set(nt,Je)):this.features.delete(nt),this.updateCache(Je,Ce)}}updateCache(xe,Ce){for(const{canonical:Xe,uid:nt}of Object.values(Ce)){const{z:Je,x:pt,y:Rt}=Xe;oe(xe,Math.pow(2,Je),pt,Rt)&&delete Ce[nt]}}getTile(xe,Ce,Xe){const nt=Math.pow(2,xe),Je=[];for(const pt of this.features.values())oe(pt,nt,Ce,Xe)&&Je.push(He(pt,nt,Ce,Xe));return{features:Je}}getFeatures(){return[...this.features.values()]}}function oe({minX:Tt,minY:xe,maxX:Ce,maxY:Xe},nt,Je,pt){return Tt<(Je+1+Q)/nt&&xe<(pt+1+Q)/nt&&Ce>(Je-Q)/nt&&Xe>(pt-Q)/nt}function fe(Tt){const{id:xe,geometry:Ce,properties:Xe}=Tt;if(!Ce)return;if(Ce.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:nt,coordinates:Je}=Ce,pt={id:xe,type:1,geometry:[],tags:Xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},Rt=pt.geometry;if(nt==="Point")Se(Je,Rt,pt);else if(nt==="MultiPoint")for(const gt of Je)Se(gt,Rt,pt);else if(nt==="LineString")pt.type=2,Ee(Je,Rt,pt);else if(nt==="MultiLineString")pt.type=2,Ie(Je,Rt,pt);else if(nt==="Polygon")pt.type=3,Ie(Je,Rt,pt,!0);else{if(nt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");pt.type=3;for(const gt of Je)Ie(gt,Rt,pt,!0)}return pt}function Se([Tt,xe],Ce,Xe){const nt=a.am(Tt);let Je=a.at(xe);Je=Je<0?0:Je>1?1:Je,Ce.push(nt,Je),Xe.minX=Math.min(Xe.minX,nt),Xe.minY=Math.min(Xe.minY,Je),Xe.maxX=Math.max(Xe.maxX,nt),Xe.maxY=Math.max(Xe.maxY,Je)}function Ee(Tt,xe,Ce,Xe=!1,nt=!1){const Je=[];for(const pt of Tt)Se(pt,Je,Ce);xe.push(Je),Xe&&function(pt,Rt){let gt=0;for(let Pt=0,zt=pt.length,Bt=zt-2;Pt<zt;Bt=Pt,Pt+=2)gt+=(pt[Pt]-pt[Bt])*(pt[Pt+1]+pt[Bt+1]);if(gt>0===Rt)for(let Pt=0,zt=pt.length;Pt<zt/2;Pt+=2){const Bt=pt[Pt],ln=pt[Pt+1];pt[Pt]=pt[zt-2-Pt],pt[Pt+1]=pt[zt-1-Pt],pt[zt-2-Pt]=Bt,pt[zt-1-Pt]=ln}}(Je,nt)}function Ie(Tt,xe,Ce,Xe=!1){for(let nt=0;nt<Tt.length;nt++)Ee(Tt[nt],xe,Ce,Xe,nt===0)}function He(Tt,xe,Ce,Xe){const{id:nt,type:Je,geometry:pt,tags:Rt}=Tt,gt=[];if(Je===1)(function(Pt,zt,Bt,ln,Mn){for(let En=0;En<Pt.length;En+=2){const Ve=Math.round(a.ab*(Pt[En+0]*zt-Bt)),yt=Math.round(a.ab*(Pt[En+1]*zt-ln));Mn.push([Ve,yt])}})(pt,xe,Ce,Xe,gt);else for(const Pt of pt)Re(Pt,xe,Ce,Xe,gt);return{id:nt,type:Je,geometry:gt,tags:Rt}}function Re(Tt,xe,Ce,Xe,nt){const Je=-re,pt=a.ab+re;let Rt;for(let gt=0;gt<Tt.length-2;gt+=2){let Pt=Math.round(a.ab*(Tt[gt+0]*xe-Ce)),zt=Math.round(a.ab*(Tt[gt+1]*xe-Xe)),Bt=Math.round(a.ab*(Tt[gt+2]*xe-Ce)),ln=Math.round(a.ab*(Tt[gt+3]*xe-Xe));const Mn=Bt-Pt,En=ln-zt;Pt<Je&&Bt<Je||(Pt<Je?(zt+=Math.round(En*((Je-Pt)/Mn)),Pt=Je):Bt<Je&&(ln=zt+Math.round(En*((Je-Pt)/Mn)),Bt=Je),zt<Je&&ln<Je||(zt<Je?(Pt+=Math.round(Mn*((Je-zt)/En)),zt=Je):ln<Je&&(Bt=Pt+Math.round(Mn*((Je-zt)/En)),ln=Je),Pt>=pt&&Bt>=pt||(Pt>=pt?(zt+=Math.round(En*((pt-Pt)/Mn)),Pt=pt):Bt>=pt&&(ln=zt+Math.round(En*((pt-Pt)/Mn)),Bt=pt),zt>=pt&&ln>=pt||(zt>=pt?(Pt+=Math.round(Mn*((pt-zt)/En)),zt=pt):ln>=pt&&(Bt=Pt+Math.round(Mn*((pt-zt)/En)),ln=pt),Rt&&Pt===Rt[Rt.length-1][0]&&zt===Rt[Rt.length-1][1]||(Rt=[[Pt,zt]],nt.push(Rt)),Rt.push([Bt,ln])))))}}var st,_e,We,Ue={exports:{}},vt=function(){if(We)return Ue.exports;We=1;var Tt=a.d_(),xe=function(){if(_e)return st;_e=1;var zt=a.dY(),Bt=a.dZ().VectorTileFeature;function ln(En,Ve){this.options=Ve||{},this.features=En,this.length=En.length}function Mn(En,Ve){this.id=typeof En.id=="number"?En.id:void 0,this.type=En.type,this.rawGeometry=En.type===1?[En.geometry]:En.geometry,this.properties=En.tags,this.extent=Ve||4096}return st=ln,ln.prototype.feature=function(En){return new Mn(this.features[En],this.options.extent)},Mn.prototype.loadGeometry=function(){var En=this.rawGeometry;this.geometry=[];for(var Ve=0;Ve<En.length;Ve++){for(var yt=En[Ve],Mt=[],Et=0;Et<yt.length;Et++)Mt.push(new zt(yt[Et][0],yt[Et][1]));this.geometry.push(Mt)}return this.geometry},Mn.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var En=this.geometry,Ve=1/0,yt=-1/0,Mt=1/0,Et=-1/0,It=0;It<En.length;It++)for(var wn=En[It],_n=0;_n<wn.length;_n++){var zn=wn[_n];Ve=Math.min(Ve,zn.x),yt=Math.max(yt,zn.x),Mt=Math.min(Mt,zn.y),Et=Math.max(Et,zn.y)}return[Ve,Mt,yt,Et]},Mn.prototype.toGeoJSON=Bt.prototype.toGeoJSON,st}();function Ce(zt){var Bt=new Tt;return function(ln,Mn){for(var En in ln.layers)Mn.writeMessage(3,Xe,ln.layers[En])}(zt,Bt),Bt.finish()}function Xe(zt,Bt){var ln;Bt.writeVarintField(15,zt.version||1),Bt.writeStringField(1,zt.name||""),Bt.writeVarintField(5,zt.extent||4096);var Mn={keys:[],values:[],keycache:{},valuecache:{}};for(ln=0;ln<zt.length;ln++)Mn.feature=zt.feature(ln),Bt.writeMessage(2,nt,Mn);var En=Mn.keys;for(ln=0;ln<En.length;ln++)Bt.writeStringField(3,En[ln]);var Ve=Mn.values;for(ln=0;ln<Ve.length;ln++)Bt.writeMessage(4,Pt,Ve[ln])}function nt(zt,Bt){var ln=zt.feature;ln.id!==void 0&&Bt.writeVarintField(1,ln.id),Bt.writeMessage(2,Je,zt),Bt.writeVarintField(3,ln.type),Bt.writeMessage(4,gt,ln)}function Je(zt,Bt){var ln=zt.feature,Mn=zt.keys,En=zt.values,Ve=zt.keycache,yt=zt.valuecache;for(var Mt in ln.properties){var Et=ln.properties[Mt],It=Ve[Mt];if(Et!==null){It===void 0&&(Mn.push(Mt),Ve[Mt]=It=Mn.length-1),Bt.writeVarint(It);var wn=typeof Et;wn!=="string"&&wn!=="boolean"&&wn!=="number"&&(Et=JSON.stringify(Et));var _n=wn+":"+Et,zn=yt[_n];zn===void 0&&(En.push(Et),yt[_n]=zn=En.length-1),Bt.writeVarint(zn)}}}function pt(zt,Bt){return(Bt<<3)+(7&zt)}function Rt(zt){return zt<<1^zt>>31}function gt(zt,Bt){for(var ln=zt.loadGeometry(),Mn=zt.type,En=0,Ve=0,yt=ln.length,Mt=0;Mt<yt;Mt++){var Et=ln[Mt],It=1;Mn===1&&(It=Et.length),Bt.writeVarint(pt(1,It));for(var wn=Mn===3?Et.length-1:Et.length,_n=0;_n<wn;_n++){_n===1&&Mn!==1&&Bt.writeVarint(pt(2,wn-1));var zn=Et[_n].x-En,$n=Et[_n].y-Ve;Bt.writeVarint(Rt(zn)),Bt.writeVarint(Rt($n)),En+=zn,Ve+=$n}Mn===3&&Bt.writeVarint(pt(7,1))}}function Pt(zt,Bt){var ln=typeof zt;ln==="string"?Bt.writeStringField(1,zt):ln==="boolean"?Bt.writeBooleanField(7,zt):ln==="number"&&(zt%1!=0?Bt.writeDoubleField(3,zt):zt<0?Bt.writeSVarintField(6,zt):Bt.writeVarintField(5,zt))}return Ue.exports=Ce,Ue.exports.fromVectorTileJs=Ce,Ue.exports.fromGeojsonVt=function(zt,Bt){Bt=Bt||{};var ln={};for(var Mn in zt)ln[Mn]=new xe(zt[Mn].features,Bt),ln[Mn].name=Mn,ln[Mn].version=Bt.version,ln[Mn].extent=Bt.extent;return Ce({layers:ln})},Ue.exports.GeoJSONWrapper=xe,Ue.exports}(),xt=a.d$(vt);const Vt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Tt=>Tt},lt=Math.fround||(Ht=new Float32Array(1),Tt=>(Ht[0]=+Tt,Ht[0]));var Ht;const Qt=3,rn=5,jn=6;class Bn{constructor(xe){this.options=Object.assign(Object.create(Vt),xe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(xe){const{log:Ce,minZoom:Xe,maxZoom:nt}=this.options;Ce&&console.time("total time");const Je=`prepare ${xe.length} points`;Ce&&console.time(Je),this.points=xe;const pt=[];for(let gt=0;gt<xe.length;gt++){const Pt=xe[gt];if(!Pt.geometry)continue;const[zt,Bt]=Pt.geometry.coordinates,ln=lt(qe(zt)),Mn=lt(mn(Bt));pt.push(ln,Mn,1/0,gt,-1,1),this.options.reduce&&pt.push(0)}let Rt=this.trees[nt+1]=this._createTree(pt);Ce&&console.timeEnd(Je);for(let gt=nt;gt>=Xe;gt--){const Pt=+Date.now();Rt=this.trees[gt]=this._createTree(this._cluster(Rt,gt)),Ce&&console.log("z%d: %d clusters in %dms",gt,Rt.numItems,+Date.now()-Pt)}return Ce&&console.timeEnd("total time"),this}getClusters(xe,Ce){let Xe=((xe[0]+180)%360+360)%360-180;const nt=Math.max(-90,Math.min(90,xe[1]));let Je=xe[2]===180?180:((xe[2]+180)%360+360)%360-180;const pt=Math.max(-90,Math.min(90,xe[3]));if(xe[2]-xe[0]>=360)Xe=-180,Je=180;else if(Xe>Je){const Bt=this.getClusters([Xe,nt,180,pt],Ce),ln=this.getClusters([-180,nt,Je,pt],Ce);return Bt.concat(ln)}const Rt=this.trees[this._limitZoom(Ce)],gt=Rt.range(qe(Xe),mn(pt),qe(Je),mn(nt)),Pt=Rt.data,zt=[];for(const Bt of gt){const ln=this.stride*Bt;zt.push(Pt[ln+rn]>1?Tn(Pt,ln,this.clusterProps):this.points[Pt[ln+Qt]])}return zt}getChildren(xe){const Ce=this._getOriginId(xe),Xe=this._getOriginZoom(xe),nt="No cluster with the specified id.",Je=this.trees[Xe];if(!Je)throw new Error(nt);const pt=Je.data;if(Ce*this.stride>=pt.length)throw new Error(nt);const Rt=this.options.radius/(this.options.extent*Math.pow(2,Xe-1)),gt=Je.within(pt[Ce*this.stride],pt[Ce*this.stride+1],Rt),Pt=[];for(const zt of gt){const Bt=zt*this.stride;pt[Bt+4]===xe&&Pt.push(pt[Bt+rn]>1?Tn(pt,Bt,this.clusterProps):this.points[pt[Bt+Qt]])}if(Pt.length===0)throw new Error(nt);return Pt}getLeaves(xe,Ce,Xe){const nt=[];return this._appendLeaves(nt,xe,Ce=Ce||10,Xe=Xe||0,0),nt}getTile(xe,Ce,Xe){const nt=this.trees[this._limitZoom(xe)],Je=Math.pow(2,xe),{extent:pt,radius:Rt}=this.options,gt=Rt/pt,Pt=(Xe-gt)/Je,zt=(Xe+1+gt)/Je,Bt={features:[]};return this._addTileFeatures(nt.range((Ce-gt)/Je,Pt,(Ce+1+gt)/Je,zt),nt.data,Ce,Xe,Je,Bt),Ce===0&&this._addTileFeatures(nt.range(1-gt/Je,Pt,1,zt),nt.data,Je,Xe,Je,Bt),Ce===Je-1&&this._addTileFeatures(nt.range(0,Pt,gt/Je,zt),nt.data,-1,Xe,Je,Bt),Bt.features.length?Bt:null}getClusterExpansionZoom(xe){let Ce=this._getOriginZoom(xe)-1;for(;Ce<=this.options.maxZoom;){const Xe=this.getChildren(xe);if(Ce++,Xe.length!==1)break;xe=Xe[0].properties.cluster_id}return Ce}_appendLeaves(xe,Ce,Xe,nt,Je){const pt=this.getChildren(Ce);for(const Rt of pt){const gt=Rt.properties;if(gt&&gt.cluster?Je+gt.point_count<=nt?Je+=gt.point_count:Je=this._appendLeaves(xe,gt.cluster_id,Xe,nt,Je):Je<nt?Je++:xe.push(Rt),xe.length===Xe)break}return Je}_createTree(xe){const Ce=new a.by(xe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Xe=0;Xe<xe.length;Xe+=this.stride)Ce.add(xe[Xe],xe[Xe+1]);return Ce.finish(),Ce.data=xe,Ce}_addTileFeatures(xe,Ce,Xe,nt,Je,pt){for(const Rt of xe){const gt=Rt*this.stride,Pt=Ce[gt+rn]>1;let zt,Bt,ln;if(Pt)zt=Le(Ce,gt,this.clusterProps),Bt=Ce[gt],ln=Ce[gt+1];else{const Ve=this.points[Ce[gt+Qt]];zt=Ve.properties;const[yt,Mt]=Ve.geometry.coordinates;Bt=qe(yt),ln=mn(Mt)}const Mn={type:1,geometry:[[Math.round(this.options.extent*(Bt*Je-Xe)),Math.round(this.options.extent*(ln*Je-nt))]],tags:zt};let En;En=Pt||this.options.generateId?Ce[gt+Qt]:this.points[Ce[gt+Qt]].id,En!==void 0&&(Mn.id=En),pt.features.push(Mn)}}_limitZoom(xe){return Math.max(this.options.minZoom,Math.min(Math.floor(+xe),this.options.maxZoom+1))}_cluster(xe,Ce){const{radius:Xe,extent:nt,reduce:Je,minPoints:pt}=this.options,Rt=Xe/(nt*Math.pow(2,Ce)),gt=xe.data,Pt=[],zt=this.stride;for(let Bt=0;Bt<gt.length;Bt+=zt){if(gt[Bt+2]<=Ce)continue;gt[Bt+2]=Ce;const ln=gt[Bt],Mn=gt[Bt+1],En=xe.within(gt[Bt],gt[Bt+1],Rt),Ve=gt[Bt+rn];let yt=Ve;for(const Mt of En){const Et=Mt*zt;gt[Et+2]>Ce&&(yt+=gt[Et+rn])}if(yt>Ve&&yt>=pt){let Mt,Et=ln*Ve,It=Mn*Ve,wn=-1;const _n=(Bt/zt<<5)+(Ce+1)+this.points.length;for(const zn of En){const $n=zn*zt;if(gt[$n+2]<=Ce)continue;gt[$n+2]=Ce;const lr=gt[$n+rn];Et+=gt[$n]*lr,It+=gt[$n+1]*lr,gt[$n+4]=_n,Je&&(Mt||(Mt=this._map(gt,Bt,!0),wn=this.clusterProps.length,this.clusterProps.push(Mt)),Je(Mt,this._map(gt,$n)))}gt[Bt+4]=_n,Pt.push(Et/yt,It/yt,1/0,_n,-1,yt),Je&&Pt.push(wn)}else{for(let Mt=0;Mt<zt;Mt++)Pt.push(gt[Bt+Mt]);if(yt>1)for(const Mt of En){const Et=Mt*zt;if(!(gt[Et+2]<=Ce)){gt[Et+2]=Ce;for(let It=0;It<zt;It++)Pt.push(gt[Et+It])}}}}return Pt}_getOriginId(xe){return xe-this.points.length>>5}_getOriginZoom(xe){return(xe-this.points.length)%32}_map(xe,Ce,Xe){if(xe[Ce+rn]>1){const pt=this.clusterProps[xe[Ce+jn]];return Xe?Object.assign({},pt):pt}const nt=this.points[xe[Ce+Qt]].properties,Je=this.options.map(nt);return Xe&&Je===nt?Object.assign({},Je):Je}}function Tn(Tt,xe,Ce){return{type:"Feature",id:Tt[xe+Qt],properties:Le(Tt,xe,Ce),geometry:{type:"Point",coordinates:[(Xe=Tt[xe],360*(Xe-.5)),cn(Tt[xe+1])]}};var Xe}function Le(Tt,xe,Ce){const Xe=Tt[xe+rn],nt=Xe>=1e4?`${Math.round(Xe/1e3)}k`:Xe>=1e3?Math.round(Xe/100)/10+"k":Xe,Je=Tt[xe+jn],pt=Je===-1?{}:Object.assign({},Ce[Je]);return Object.assign(pt,{cluster:!0,cluster_id:Tt[xe+Qt],point_count:Xe,point_count_abbreviated:nt})}function qe(Tt){return Tt/360+.5}function mn(Tt){const xe=Math.sin(Tt*Math.PI/180),Ce=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return Ce<0?0:Ce>1?1:Ce}function cn(Tt){const xe=(180-360*Tt)*Math.PI/180;return 360*Math.atan(Math.exp(xe))/Math.PI-90}function St(Tt,xe,Ce,Xe){let nt=Xe;const Je=xe+(Ce-xe>>1);let pt,Rt=Ce-xe;const gt=Tt[xe],Pt=Tt[xe+1],zt=Tt[Ce],Bt=Tt[Ce+1];for(let ln=xe+3;ln<Ce;ln+=3){const Mn=Jt(Tt[ln],Tt[ln+1],gt,Pt,zt,Bt);if(Mn>nt)pt=ln,nt=Mn;else if(Mn===nt){const En=Math.abs(ln-Je);En<Rt&&(pt=ln,Rt=En)}}nt>Xe&&(pt-xe>3&&St(Tt,xe,pt,Xe),Tt[pt+2]=nt,Ce-pt>3&&St(Tt,pt,Ce,Xe))}function Jt(Tt,xe,Ce,Xe,nt,Je){let pt=nt-Ce,Rt=Je-Xe;if(pt!==0||Rt!==0){const gt=((Tt-Ce)*pt+(xe-Xe)*Rt)/(pt*pt+Rt*Rt);gt>1?(Ce=nt,Xe=Je):gt>0&&(Ce+=pt*gt,Xe+=Rt*gt)}return pt=Tt-Ce,Rt=xe-Xe,pt*pt+Rt*Rt}function kn(Tt,xe,Ce,Xe){const nt={id:Tt??null,type:xe,geometry:Ce,tags:Xe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")Gn(nt,Ce);else if(xe==="Polygon")Gn(nt,Ce[0]);else if(xe==="MultiLineString")for(const Je of Ce)Gn(nt,Je);else if(xe==="MultiPolygon")for(const Je of Ce)Gn(nt,Je[0]);return nt}function Gn(Tt,xe){for(let Ce=0;Ce<xe.length;Ce+=3)Tt.minX=Math.min(Tt.minX,xe[Ce]),Tt.minY=Math.min(Tt.minY,xe[Ce+1]),Tt.maxX=Math.max(Tt.maxX,xe[Ce]),Tt.maxY=Math.max(Tt.maxY,xe[Ce+1])}function sn(Tt,xe,Ce,Xe){if(!xe.geometry)return;const nt=xe.geometry.coordinates;if(nt&&nt.length===0)return;const Je=xe.geometry.type,pt=Math.pow(Ce.tolerance/((1<<Ce.maxZoom)*Ce.extent),2);let Rt=[],gt=xe.id;if(Ce.promoteId?gt=xe.properties[Ce.promoteId]:Ce.generateId&&(gt=Xe||0),Je==="Point")ot(nt,Rt);else if(Je==="MultiPoint")for(const Pt of nt)ot(Pt,Rt);else if(Je==="LineString")Ge(nt,Rt,pt,!1);else if(Je==="MultiLineString"){if(Ce.lineMetrics){for(const Pt of nt)Rt=[],Ge(Pt,Rt,pt,!1),Tt.push(kn(gt,"LineString",Rt,xe.properties));return}Xt(nt,Rt,pt,!1)}else if(Je==="Polygon")Xt(nt,Rt,pt,!0);else{if(Je!=="MultiPolygon"){if(Je==="GeometryCollection"){for(const Pt of xe.geometry.geometries)sn(Tt,{id:gt,geometry:Pt,properties:xe.properties},Ce,Xe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Pt of nt){const zt=[];Xt(Pt,zt,pt,!0),Rt.push(zt)}}Tt.push(kn(gt,Je,Rt,xe.properties))}function ot(Tt,xe){xe.push(An(Tt[0]),Sn(Tt[1]),0)}function Ge(Tt,xe,Ce,Xe){let nt,Je,pt=0;for(let gt=0;gt<Tt.length;gt++){const Pt=An(Tt[gt][0]),zt=Sn(Tt[gt][1]);xe.push(Pt,zt,0),gt>0&&(pt+=Xe?(nt*zt-Pt*Je)/2:Math.sqrt(Math.pow(Pt-nt,2)+Math.pow(zt-Je,2))),nt=Pt,Je=zt}const Rt=xe.length-3;xe[2]=1,St(xe,0,Rt,Ce),xe[Rt+2]=1,xe.size=Math.abs(pt),xe.start=0,xe.end=xe.size}function Xt(Tt,xe,Ce,Xe){for(let nt=0;nt<Tt.length;nt++){const Je=[];Ge(Tt[nt],Je,Ce,Xe),xe.push(Je)}}function An(Tt){return Tt/360+.5}function Sn(Tt){const xe=Math.sin(Tt*Math.PI/180),Ce=.5-.25*Math.log((1+xe)/(1-xe))/Math.PI;return Ce<0?0:Ce>1?1:Ce}function jt(Tt,xe,Ce,Xe,nt,Je,pt,Rt){if(Xe/=xe,Je>=(Ce/=xe)&&pt<Xe)return Tt;if(pt<Ce||Je>=Xe)return null;const gt=[];for(const Pt of Tt){const zt=Pt.geometry;let Bt=Pt.type;const ln=nt===0?Pt.minX:Pt.minY,Mn=nt===0?Pt.maxX:Pt.maxY;if(ln>=Ce&&Mn<Xe){gt.push(Pt);continue}if(Mn<Ce||ln>=Xe)continue;let En=[];if(Bt==="Point"||Bt==="MultiPoint")mr(zt,En,Ce,Xe,nt);else if(Bt==="LineString")Un(zt,En,Ce,Xe,nt,!1,Rt.lineMetrics);else if(Bt==="MultiLineString")Sr(zt,En,Ce,Xe,nt,!1);else if(Bt==="Polygon")Sr(zt,En,Ce,Xe,nt,!0);else if(Bt==="MultiPolygon")for(const Ve of zt){const yt=[];Sr(Ve,yt,Ce,Xe,nt,!0),yt.length&&En.push(yt)}if(En.length){if(Rt.lineMetrics&&Bt==="LineString"){for(const Ve of En)gt.push(kn(Pt.id,Bt,Ve,Pt.tags));continue}Bt!=="LineString"&&Bt!=="MultiLineString"||(En.length===1?(Bt="LineString",En=En[0]):Bt="MultiLineString"),Bt!=="Point"&&Bt!=="MultiPoint"||(Bt=En.length===3?"Point":"MultiPoint"),gt.push(kn(Pt.id,Bt,En,Pt.tags))}}return gt.length?gt:null}function mr(Tt,xe,Ce,Xe,nt){for(let Je=0;Je<Tt.length;Je+=3){const pt=Tt[Je+nt];pt>=Ce&&pt<=Xe&&Ln(xe,Tt[Je],Tt[Je+1],Tt[Je+2])}}function Un(Tt,xe,Ce,Xe,nt,Je,pt){let Rt=tr(Tt);const gt=nt===0?ir:ui;let Pt,zt,Bt=Tt.start;for(let yt=0;yt<Tt.length-3;yt+=3){const Mt=Tt[yt],Et=Tt[yt+1],It=Tt[yt+2],wn=Tt[yt+3],_n=Tt[yt+4],zn=nt===0?Mt:Et,$n=nt===0?wn:_n;let lr=!1;pt&&(Pt=Math.sqrt(Math.pow(Mt-wn,2)+Math.pow(Et-_n,2))),zn<Ce?$n>Ce&&(zt=gt(Rt,Mt,Et,wn,_n,Ce),pt&&(Rt.start=Bt+Pt*zt)):zn>Xe?$n<Xe&&(zt=gt(Rt,Mt,Et,wn,_n,Xe),pt&&(Rt.start=Bt+Pt*zt)):Ln(Rt,Mt,Et,It),$n<Ce&&zn>=Ce&&(zt=gt(Rt,Mt,Et,wn,_n,Ce),lr=!0),$n>Xe&&zn<=Xe&&(zt=gt(Rt,Mt,Et,wn,_n,Xe),lr=!0),!Je&&lr&&(pt&&(Rt.end=Bt+Pt*zt),xe.push(Rt),Rt=tr(Tt)),pt&&(Bt+=Pt)}let ln=Tt.length-3;const Mn=Tt[ln],En=Tt[ln+1],Ve=nt===0?Mn:En;Ve>=Ce&&Ve<=Xe&&Ln(Rt,Mn,En,Tt[ln+2]),ln=Rt.length-3,Je&&ln>=3&&(Rt[ln]!==Rt[0]||Rt[ln+1]!==Rt[1])&&Ln(Rt,Rt[0],Rt[1],Rt[2]),Rt.length&&xe.push(Rt)}function tr(Tt){const xe=[];return xe.size=Tt.size,xe.start=Tt.start,xe.end=Tt.end,xe}function Sr(Tt,xe,Ce,Xe,nt,Je){for(const pt of Tt)Un(pt,xe,Ce,Xe,nt,Je,!1)}function Ln(Tt,xe,Ce,Xe){Tt.push(xe,Ce,Xe)}function ir(Tt,xe,Ce,Xe,nt,Je){const pt=(Je-xe)/(Xe-xe);return Ln(Tt,Je,Ce+(nt-Ce)*pt,1),pt}function ui(Tt,xe,Ce,Xe,nt,Je){const pt=(Je-Ce)/(nt-Ce);return Ln(Tt,xe+(Xe-xe)*pt,Je,1),pt}function Fr(Tt,xe){const Ce=[];for(let Xe=0;Xe<Tt.length;Xe++){const nt=Tt[Xe],Je=nt.type;let pt;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")pt=ar(nt.geometry,xe);else if(Je==="MultiLineString"||Je==="Polygon"){pt=[];for(const Rt of nt.geometry)pt.push(ar(Rt,xe))}else if(Je==="MultiPolygon"){pt=[];for(const Rt of nt.geometry){const gt=[];for(const Pt of Rt)gt.push(ar(Pt,xe));pt.push(gt)}}Ce.push(kn(nt.id,Je,pt,nt.tags))}return Ce}function ar(Tt,xe){const Ce=[];Ce.size=Tt.size,Tt.start!==void 0&&(Ce.start=Tt.start,Ce.end=Tt.end);for(let Xe=0;Xe<Tt.length;Xe+=3)Ce.push(Tt[Xe]+xe,Tt[Xe+1],Tt[Xe+2]);return Ce}function Nr(Tt,xe){if(Tt.transformed)return Tt;const Ce=1<<Tt.z,Xe=Tt.x,nt=Tt.y;for(const Je of Tt.features){const pt=Je.geometry,Rt=Je.type;if(Je.geometry=[],Rt===1)for(let gt=0;gt<pt.length;gt+=2)Je.geometry.push(Hr(pt[gt],pt[gt+1],xe,Ce,Xe,nt));else for(let gt=0;gt<pt.length;gt++){const Pt=[];for(let zt=0;zt<pt[gt].length;zt+=2)Pt.push(Hr(pt[gt][zt],pt[gt][zt+1],xe,Ce,Xe,nt));Je.geometry.push(Pt)}}return Tt.transformed=!0,Tt}function Hr(Tt,xe,Ce,Xe,nt,Je){return[Math.round(Ce*(Tt*Xe-nt)),Math.round(Ce*(xe*Xe-Je))]}function xi(Tt,xe,Ce,Xe,nt){const Je=xe===nt.maxZoom?0:nt.tolerance/((1<<xe)*nt.extent),pt={features:[],numPoints:0,numSimplified:0,numFeatures:Tt.length,source:null,x:Ce,y:Xe,z:xe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Rt of Tt)Fe(pt,Rt,Je,nt);return pt}function Fe(Tt,xe,Ce,Xe){const nt=xe.geometry,Je=xe.type,pt=[];if(Tt.minX=Math.min(Tt.minX,xe.minX),Tt.minY=Math.min(Tt.minY,xe.minY),Tt.maxX=Math.max(Tt.maxX,xe.maxX),Tt.maxY=Math.max(Tt.maxY,xe.maxY),Je==="Point"||Je==="MultiPoint")for(let Rt=0;Rt<nt.length;Rt+=3)pt.push(nt[Rt],nt[Rt+1]),Tt.numPoints++,Tt.numSimplified++;else if(Je==="LineString")Lt(pt,nt,Tt,Ce,!1,!1);else if(Je==="MultiLineString"||Je==="Polygon")for(let Rt=0;Rt<nt.length;Rt++)Lt(pt,nt[Rt],Tt,Ce,Je==="Polygon",Rt===0);else if(Je==="MultiPolygon")for(let Rt=0;Rt<nt.length;Rt++){const gt=nt[Rt];for(let Pt=0;Pt<gt.length;Pt++)Lt(pt,gt[Pt],Tt,Ce,!0,Pt===0)}if(pt.length){let Rt=xe.tags||null;if(Je==="LineString"&&Xe.lineMetrics){Rt={};for(const Pt in xe.tags)Rt[Pt]=xe.tags[Pt];Rt.mapbox_clip_start=nt.start/nt.size,Rt.mapbox_clip_end=nt.end/nt.size}const gt={geometry:pt,type:Je==="Polygon"||Je==="MultiPolygon"?3:Je==="LineString"||Je==="MultiLineString"?2:1,tags:Rt};xe.id!==null&&(gt.id=xe.id),Tt.features.push(gt)}}function Lt(Tt,xe,Ce,Xe,nt,Je){const pt=Xe*Xe;if(Xe>0&&xe.size<(nt?pt:Xe))return void(Ce.numPoints+=xe.length/3);const Rt=[];for(let gt=0;gt<xe.length;gt+=3)(Xe===0||xe[gt+2]>pt)&&(Ce.numSimplified++,Rt.push(xe[gt],xe[gt+1])),Ce.numPoints++;nt&&function(gt,Pt){let zt=0;for(let Bt=0,ln=gt.length,Mn=ln-2;Bt<ln;Mn=Bt,Bt+=2)zt+=(gt[Bt]-gt[Mn])*(gt[Bt+1]+gt[Mn+1]);if(zt>0===Pt)for(let Bt=0,ln=gt.length;Bt<ln/2;Bt+=2){const Mn=gt[Bt],En=gt[Bt+1];gt[Bt]=gt[ln-2-Bt],gt[Bt+1]=gt[ln-1-Bt],gt[ln-2-Bt]=Mn,gt[ln-1-Bt]=En}}(Rt,Je),Tt.push(Rt)}const Kt={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class un{constructor(xe,Ce){const Xe=(Ce=this.options=function(Je,pt){for(const Rt in pt)Je[Rt]=pt[Rt];return Je}(Object.create(Kt),Ce)).debug;if(Xe&&console.time("preprocess data"),Ce.maxZoom<0||Ce.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ce.promoteId&&Ce.generateId)throw new Error("promoteId and generateId cannot be used together.");let nt=function(Je,pt){const Rt=[];if(Je.type==="FeatureCollection")for(let gt=0;gt<Je.features.length;gt++)sn(Rt,Je.features[gt],pt,gt);else sn(Rt,Je.type==="Feature"?Je:{geometry:Je},pt);return Rt}(xe,Ce);this.tiles={},this.tileCoords=[],Xe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ce.indexMaxZoom,Ce.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),nt=function(Je,pt){const Rt=pt.buffer/pt.extent;let gt=Je;const Pt=jt(Je,1,-1-Rt,Rt,0,-1,2,pt),zt=jt(Je,1,1-Rt,2+Rt,0,-1,2,pt);return(Pt||zt)&&(gt=jt(Je,1,-Rt,1+Rt,0,-1,2,pt)||[],Pt&&(gt=Fr(Pt,1).concat(gt)),zt&&(gt=gt.concat(Fr(zt,-1)))),gt}(nt,Ce),nt.length&&this.splitTile(nt,0,0,0),Xe&&(nt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(xe,Ce,Xe,nt,Je,pt,Rt){const gt=[xe,Ce,Xe,nt],Pt=this.options,zt=Pt.debug;for(;gt.length;){nt=gt.pop(),Xe=gt.pop(),Ce=gt.pop(),xe=gt.pop();const Bt=1<<Ce,ln=Cn(Ce,Xe,nt);let Mn=this.tiles[ln];if(!Mn&&(zt>1&&console.time("creation"),Mn=this.tiles[ln]=xi(xe,Ce,Xe,nt,Pt),this.tileCoords.push({z:Ce,x:Xe,y:nt}),zt)){zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ce,Xe,nt,Mn.numFeatures,Mn.numPoints,Mn.numSimplified),console.timeEnd("creation"));const lr=`z${Ce}`;this.stats[lr]=(this.stats[lr]||0)+1,this.total++}if(Mn.source=xe,Je==null){if(Ce===Pt.indexMaxZoom||Mn.numPoints<=Pt.indexMaxPoints)continue}else{if(Ce===Pt.maxZoom||Ce===Je)continue;if(Je!=null){const lr=Je-Ce;if(Xe!==pt>>lr||nt!==Rt>>lr)continue}}if(Mn.source=null,xe.length===0)continue;zt>1&&console.time("clipping");const En=.5*Pt.buffer/Pt.extent,Ve=.5-En,yt=.5+En,Mt=1+En;let Et=null,It=null,wn=null,_n=null,zn=jt(xe,Bt,Xe-En,Xe+yt,0,Mn.minX,Mn.maxX,Pt),$n=jt(xe,Bt,Xe+Ve,Xe+Mt,0,Mn.minX,Mn.maxX,Pt);xe=null,zn&&(Et=jt(zn,Bt,nt-En,nt+yt,1,Mn.minY,Mn.maxY,Pt),It=jt(zn,Bt,nt+Ve,nt+Mt,1,Mn.minY,Mn.maxY,Pt),zn=null),$n&&(wn=jt($n,Bt,nt-En,nt+yt,1,Mn.minY,Mn.maxY,Pt),_n=jt($n,Bt,nt+Ve,nt+Mt,1,Mn.minY,Mn.maxY,Pt),$n=null),zt>1&&console.timeEnd("clipping"),gt.push(Et||[],Ce+1,2*Xe,2*nt),gt.push(It||[],Ce+1,2*Xe,2*nt+1),gt.push(wn||[],Ce+1,2*Xe+1,2*nt),gt.push(_n||[],Ce+1,2*Xe+1,2*nt+1)}}getTile(xe,Ce,Xe){xe=+xe,Ce=+Ce,Xe=+Xe;const nt=this.options,{extent:Je,debug:pt}=nt;if(xe<0||xe>24)return null;const Rt=1<<xe,gt=Cn(xe,Ce=Ce+Rt&Rt-1,Xe);if(this.tiles[gt])return Nr(this.tiles[gt],Je);pt>1&&console.log("drilling down to z%d-%d-%d",xe,Ce,Xe);let Pt,zt=xe,Bt=Ce,ln=Xe;for(;!Pt&&zt>0;)zt--,Bt>>=1,ln>>=1,Pt=this.tiles[Cn(zt,Bt,ln)];return Pt&&Pt.source?(pt>1&&(console.log("found parent tile z%d-%d-%d",zt,Bt,ln),console.time("drilling down")),this.splitTile(Pt.source,zt,Bt,ln,xe,Ce,Xe),pt>1&&console.timeEnd("drilling down"),this.tiles[gt]?Nr(this.tiles[gt],Je):null):null}}function Cn(Tt,xe,Ce){return 32*((1<<Tt)*Ce+xe)+Tt}function Ar(Tt,xe){const Ce=Tt.tileID.canonical;if(!this._geoJSONIndex)return void xe(null,null);const Xe=this._geoJSONIndex.getTile(Ce.z,Ce.x,Ce.y);if(!Xe)return void xe(null,null);const nt=new Z(Xe.features);let Je=xt(nt);Je.byteOffset===0&&Je.byteLength===Je.buffer.byteLength||(Je=new Uint8Array(Je)),xe(null,{vectorTile:nt,rawData:Je.buffer})}class Vr extends E{constructor(xe,Ce,Xe,nt,Je,pt){super(xe,Ce,Xe,nt,Ar,pt),Je&&(this.loadGeoJSON=Je),this._dynamicIndex=new ie}loadData(xe,Ce){const Xe=xe&&xe.request,nt=Xe&&Xe.collectResourceTiming;this.loadGeoJSON(xe,(Je,pt)=>{if(Je||!pt)return Ce(Je);if(typeof pt!="object")return Ce(new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`));{try{if(xe.filter){const gt=a.M(xe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(gt.result==="error")throw new Error(gt.value.map(Pt=>`${Pt.key}: ${Pt.message}`).join(", "));pt.features=pt.features.filter(Pt=>gt.value.evaluate({zoom:0},Pt))}xe.dynamic?(pt.type==="Feature"&&(pt={type:"FeatureCollection",features:[pt]}),xe.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(pt.features,this.loaded),xe.cluster&&(pt.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=xe.cluster?new Bn(function({superclusterOptions:gt,clusterProperties:Pt}){if(!Pt||!gt)return gt;const zt={},Bt={},ln={accumulated:null,zoom:0},Mn={properties:null},En=Object.keys(Pt);for(const Ve of En){const[yt,Mt]=Pt[Ve],Et=a.M(Mt),It=a.M(typeof yt=="string"?[yt,["accumulated"],["get",Ve]]:yt);zt[Ve]=Et.value,Bt[Ve]=It.value}return gt.map=Ve=>{Mn.properties=Ve;const yt={};for(const Mt of En)yt[Mt]=zt[Mt].evaluate(ln,Mn);return yt},gt.reduce=(Ve,yt)=>{Mn.properties=yt;for(const Mt of En)ln.accumulated=Ve[Mt],Ve[Mt]=Bt[Mt].evaluate(ln,Mn)},gt}(xe)).load(pt.features):xe.dynamic?this._dynamicIndex:function(gt,Pt){return new un(gt,Pt)}(pt,xe.geojsonVtOptions)}catch(gt){return Ce(gt)}const Rt={};if(nt){const gt=h(Xe);gt&&(Rt.resourceTiming={},Rt.resourceTiming[xe.source]=JSON.parse(JSON.stringify(gt)))}Ce(null,Rt)}})}reloadTile(xe,Ce){const Xe=this.loaded;return Xe&&Xe[xe.uid]?xe.partial?Ce(null,void 0):super.reloadTile(xe,Ce):this.loadTile(xe,Ce)}loadGeoJSON(xe,Ce){if(xe.request)a.n(xe.request,Ce);else{if(typeof xe.data!="string")return Ce(new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`));try{return Ce(null,JSON.parse(xe.data))}catch{return Ce(new Error(`Input data given to '${xe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(xe,Ce){try{Ce(null,this._geoJSONIndex.getClusterExpansionZoom(xe.clusterId))}catch(Xe){Ce(Xe)}}getClusterChildren(xe,Ce){try{Ce(null,this._geoJSONIndex.getChildren(xe.clusterId))}catch(Xe){Ce(Xe)}}getClusterLeaves(xe,Ce){try{Ce(null,this._geoJSONIndex.getLeaves(xe.clusterId,xe.limit,xe.offset))}catch(Xe){Ce(Xe)}}}class hs{constructor(xe,Ce){this.tileID=new a.aA(xe.tileID.overscaledZ,xe.tileID.wrap,xe.tileID.canonical.z,xe.tileID.canonical.x,xe.tileID.canonical.y),this.tileZoom=xe.tileZoom,this.uid=xe.uid,this.zoom=xe.zoom,this.canonical=xe.tileID.canonical,this.pixelRatio=xe.pixelRatio,this.tileSize=xe.tileSize,this.source=xe.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=xe.projection,this.brightness=Ce}parse(xe,Ce,Xe,nt){this.status="parsing";const Je=new a.aA(Xe.tileID.overscaledZ,Xe.tileID.wrap,Xe.tileID.canonical.z,Xe.tileID.canonical.x,Xe.tileID.canonical.y),pt={},Rt=Ce.familiesBySource[Xe.source],gt=new a.dR(Je,Xe.promoteId);return gt.bucketLayerIDs=[],gt.is3DTile=!0,a.e0(xe).then(Pt=>{if(!Pt)return nt(new Error("Could not parse tile"));const zt=a.e1(Pt,1/a.c8(Xe.tileID.canonical)),Bt=Pt.json.extensionsUsed&&Pt.json.extensionsUsed.includes("MAPBOX_mesh_features")||Pt.json.asset.extras&&Pt.json.asset.extras.MAPBOX_mesh_features,ln=Pt.json.extensionsUsed&&Pt.json.extensionsUsed.includes("EXT_meshopt_compression"),Mn=new a.a3(this.zoom,{brightness:this.brightness});for(const En in Rt)for(const Ve of Rt[En]){const yt=Ve[0];gt.bucketLayerIDs.push(Ve.map(Et=>Et.id)),yt.recalculate(Mn,[]);const Mt=new a.e2(zt,Je,Bt,ln,this.brightness,gt);Bt||(Mt.needsUpload=!0),pt[yt.fqid]=Mt,Mt.evaluate(yt)}this.status="done",nt(null,{buckets:pt,featureIndex:gt})}).catch(Pt=>nt(new Error(Pt.message)))}}class Ls{constructor(xe,Ce,Xe,nt,Je,pt){this.actor=xe,this.layerIndex=Ce,this.brightness=pt,this.loading={},this.loaded={}}loadTile(xe,Ce){const Xe=xe.uid,nt=this.loading[Xe]=new hs(xe,this.brightness);a.bc(xe.request,(Je,pt)=>{const Rt=!this.loading[Xe];return delete this.loading[Xe],Rt||Je?(nt.status="done",Rt||(this.loaded[Xe]=nt),Ce(Je)):pt&&pt.byteLength!==0?void nt.parse(pt,this.layerIndex,xe,(gt,Pt)=>{nt.status="done",this.loaded=this.loaded||{},this.loaded[Xe]=nt,gt||!Pt?Ce(gt):Ce(null,Pt)}):(nt.status="done",this.loaded[Xe]=nt,Ce())})}reloadTile(xe,Ce){const Xe=this.loaded,nt=xe.uid;if(Xe&&Xe[nt]){const Je=Xe[nt];Je.projection=xe.projection,Je.brightness=xe.brightness;const pt=(Rt,gt)=>{Je.reloadCallback&&(delete Je.reloadCallback,this.loadTile(xe,Ce)),Ce(Rt,gt)};Je.status==="parsing"?Je.reloadCallback=pt:Je.status==="done"&&this.loadTile(xe,Ce)}}abortTile(xe,Ce){const Xe=xe.uid;this.loading[Xe]&&delete this.loading[Xe],Ce()}removeTile(xe,Ce){const Xe=this.loaded,nt=xe.uid;Xe&&Xe[nt]&&delete Xe[nt],Ce()}}class hi{constructor(xe){this.self=xe,this.actor=new a.e3(xe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.bL({name:"mercator"}),this.workerSourceTypes={vector:E,geojson:Vr,"batched-model":Ls},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ce,Xe)=>{if(this.workerSourceTypes[Ce])throw new Error(`Worker source with name "${Ce}" already registered.`);this.workerSourceTypes[Ce]=Xe},this.self.registerRTLTextPlugin=Ce=>{if(a.e4.isParsed())throw new Error("RTL text plugin already registered.");a.e4.applyArabicShaping=Ce.applyArabicShaping,a.e4.processBidirectionalText=Ce.processBidirectionalText,a.e4.processStyledBidirectionalText=Ce.processStyledBidirectionalText}}clearCaches(xe,Ce,Xe){delete this.layerIndexes[xe],delete this.availableImages[xe],delete this.workerSources[xe],delete this.demWorkerSources[xe],delete this.rasterArrayWorkerSource,Xe()}checkIfReady(xe,Ce,Xe){Xe()}setReferrer(xe,Ce){this.referrer=Ce}spriteLoaded(xe,{scope:Ce,isLoaded:Xe}){if(this.isSpriteLoaded[xe]||(this.isSpriteLoaded[xe]={}),this.isSpriteLoaded[xe][Ce]=Xe,this.workerSources[xe]&&this.workerSources[xe][Ce])for(const nt in this.workerSources[xe][Ce]){const Je=this.workerSources[xe][Ce][nt];for(const pt in Je){const Rt=Je[pt];Rt instanceof E&&(Rt.isSpriteLoaded=Xe,Rt.fire(new a.x("isSpriteLoaded")))}}}setImages(xe,{scope:Ce,images:Xe},nt){if(this.availableImages[xe]||(this.availableImages[xe]={}),this.availableImages[xe][Ce]=Xe,this.workerSources[xe]&&this.workerSources[xe][Ce]){for(const Je in this.workerSources[xe][Ce]){const pt=this.workerSources[xe][Ce][Je];for(const Rt in pt)pt[Rt].availableImages=Xe}nt()}else nt()}setProjection(xe,Ce){this.projections[xe]=a.bL(Ce)}setBrightness(xe,Ce,Xe){this.brightness=Ce,Xe()}setLayers(xe,Ce,Xe){this.getLayerIndex(xe,Ce.scope).replace(Ce.layers,Ce.options),Xe()}updateLayers(xe,Ce,Xe){this.getLayerIndex(xe,Ce.scope).update(Ce.layers,Ce.removedIds,Ce.options),Xe()}loadTile(xe,Ce,Xe){Ce.projection=this.projections[xe]||this.defaultProjection,this.getWorkerSource(xe,Ce.type,Ce.source,Ce.scope).loadTile(Ce,Xe)}loadDEMTile(xe,Ce,Xe){this.getDEMWorkerSource(xe,Ce.source,Ce.scope).loadTile(Ce,Xe)}decodeRasterArray(xe,Ce,Xe){this.getRasterArrayWorkerSource().decodeRasterArray(Ce,Xe)}reloadTile(xe,Ce,Xe){Ce.projection=this.projections[xe]||this.defaultProjection,this.getWorkerSource(xe,Ce.type,Ce.source,Ce.scope).reloadTile(Ce,Xe)}abortTile(xe,Ce,Xe){this.getWorkerSource(xe,Ce.type,Ce.source,Ce.scope).abortTile(Ce,Xe)}removeTile(xe,Ce,Xe){this.getWorkerSource(xe,Ce.type,Ce.source,Ce.scope).removeTile(Ce,Xe)}removeSource(xe,Ce,Xe){if(!(this.workerSources[xe]&&this.workerSources[xe][Ce.scope]&&this.workerSources[xe][Ce.scope][Ce.type]&&this.workerSources[xe][Ce.scope][Ce.type][Ce.source]))return;const nt=this.workerSources[xe][Ce.scope][Ce.type][Ce.source];delete this.workerSources[xe][Ce.scope][Ce.type][Ce.source],nt.removeSource!==void 0?nt.removeSource(Ce,Xe):Xe()}loadWorkerSource(xe,Ce,Xe){try{this.self.importScripts(Ce.url),Xe()}catch(nt){Xe(nt.toString())}}syncRTLPluginState(xe,Ce,Xe){try{a.e4.setState(Ce);const nt=a.e4.getPluginURL();if(a.e4.isLoaded()&&!a.e4.isParsed()&&nt!=null){this.self.importScripts(nt);const Je=a.e4.isParsed();Xe(Je?void 0:new Error(`RTL Text Plugin failed to import scripts from ${nt}`),Je)}}catch(nt){Xe(nt.toString())}}setDracoUrl(xe,Ce){this.dracoUrl=Ce}getAvailableImages(xe,Ce){this.availableImages[xe]||(this.availableImages[xe]={});let Xe=this.availableImages[xe][Ce];return Xe||(Xe=[]),Xe}getLayerIndex(xe,Ce){this.layerIndexes[xe]||(this.layerIndexes[xe]={});let Xe=this.layerIndexes[xe][Ce];return Xe||(Xe=this.layerIndexes[xe][Ce]=new v,Xe.scope=Ce),Xe}getWorkerSource(xe,Ce,Xe,nt){return this.workerSources[xe]||(this.workerSources[xe]={}),this.workerSources[xe][nt]||(this.workerSources[xe][nt]={}),this.workerSources[xe][nt][Ce]||(this.workerSources[xe][nt][Ce]={}),this.isSpriteLoaded[xe]||(this.isSpriteLoaded[xe]={}),this.workerSources[xe][nt][Ce][Xe]||(this.workerSources[xe][nt][Ce][Xe]=new this.workerSourceTypes[Ce]({send:(Je,pt,Rt,gt,Pt,zt)=>{this.actor.send(Je,pt,Rt,xe,Pt,zt)},scheduler:this.actor.scheduler},this.getLayerIndex(xe,nt),this.getAvailableImages(xe,nt),this.isSpriteLoaded[xe][nt],void 0,this.brightness)),this.workerSources[xe][nt][Ce][Xe]}getDEMWorkerSource(xe,Ce,Xe){return this.demWorkerSources[xe]||(this.demWorkerSources[xe]={}),this.demWorkerSources[xe][Xe]||(this.demWorkerSources[xe][Xe]={}),this.demWorkerSources[xe][Xe][Ce]||(this.demWorkerSources[xe][Xe][Ce]=new L),this.demWorkerSources[xe][Xe][Ce]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new k),this.rasterArrayWorkerSource}enforceCacheSizeLimit(xe,Ce){a.e5(Ce)}getWorkerPerformanceMetrics(xe,Ce,Xe){Xe(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new hi(self)),hi}),o(["./shared"],function(a){var h="3.7.0";const f={create:"create",load:"load",fullLoad:"fullLoad"},p={mark(b){performance.mark(b)},measure(b,u,m){performance.measure(b,u,m)}};function v(b){const u=b.name.split("?")[0];return a.a(u)&&u.includes("mapbox-gl.js")?"javascript":a.a(u)&&u.includes("mapbox-gl.css")?"css":a.b(u)?"fontRange":a.c(u)?"sprite":a.i(u)?"style":a.d(u)?"tilejson":"other"}var y,S={},C=function(){if(y)return S;function b(w){return!u(w)}function u(w){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var P,F,W=new Blob([""],{type:"text/javascript"}),q=URL.createObjectURL(W);try{F=new Worker(q),P=!0}catch{P=!1}return F&&F.terminate(),URL.revokeObjectURL(q),P}()?function(){var P=document.createElement("canvas");P.width=P.height=1;var F=P.getContext("2d");if(!F)return!1;var W=F.getImageData(0,0,1,1);return W&&W.width===P.width}()?(m[I=w&&w.failIfMajorPerformanceCaveat]===void 0&&(m[I]=function(P){var F,W=function(q){var J=document.createElement("canvas"),ee=Object.create(b.webGLContextAttributes);return ee.failIfMajorPerformanceCaveat=q,J.getContext("webgl2",ee)}(P);if(!W)return!1;try{F=W.createShader(W.VERTEX_SHADER)}catch{return!1}return!(!F||W.isContextLost())&&(W.shaderSource(F,"void main() {}"),W.compileShader(F),W.getShaderParameter(F,W.COMPILE_STATUS)===!0)}(I)),m[I]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var I}y=1,S.supported=b,S.notSupportedReason=u;var m={};return b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},S}();function M(b,u,m){const w=document.createElement(b);return u!=null&&(w.className=u),m&&m.appendChild(w),w}function E(b,u,m){const w=document.createElementNS("http://www.w3.org/2000/svg",b);for(const I of Object.keys(u))w.setAttributeNS(null,I,String(u[I]));return m&&m.appendChild(w),w}const L=typeof document<"u"?document.documentElement&&document.documentElement.style:null,k=L&&L.userSelect!==void 0?"userSelect":"WebkitUserSelect";let H;function X(){L&&k&&(H=L[k],L[k]="none")}function Z(){L&&k&&(L[k]=H)}function Q(b){b.preventDefault(),b.stopPropagation(),window.removeEventListener("click",Q,!0)}function re(){window.addEventListener("click",Q,!0),window.setTimeout(()=>{window.removeEventListener("click",Q,!0)},0)}function ie(b,u){const m=b.getBoundingClientRect();return Se(b,m,u)}function oe(b,u){const m=b.getBoundingClientRect(),w=[];for(let I=0;I<u.length;I++)w.push(Se(b,m,u[I]));return w}function fe(b){return window.InstallTrigger!==void 0&&b.button===2&&b.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:b.button}function Se(b,u,m){const w=b.offsetWidth===u.width?1:b.offsetWidth/u.width;return new a.P((m.clientX-u.left)*w,(m.clientY-u.top)*w)}const Ee="01",Ie="NO_ACCESS_TOKEN";class He{constructor(u,m,w){this._transformRequestFn=u,this._customAccessToken=m,this._silenceAuthErrors=!!w,this._createSkuToken()}_createSkuToken(){const u=function(){let m="";for(let w=0;w<10;w++)m+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ee,m].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=u.token,this._skuTokenExpiresAt=u.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(u,m){return this._transformRequestFn&&this._transformRequestFn(u,m)||{url:u}}normalizeStyleURL(u,m){if(!a.f(u))return u;const w=st(u);return w.params.push(`sdk=js-${h}`),w.path=`/styles/v1${w.path}`,this._makeAPIURL(w,this._customAccessToken||m)}normalizeGlyphsURL(u,m){if(!a.f(u))return u;const w=st(u);return w.path=`/fonts/v1${w.path}`,this._makeAPIURL(w,this._customAccessToken||m)}normalizeModelURL(u,m){if(!a.f(u))return u;const w=st(u);return w.path=`/models/v1${w.path}`,this._makeAPIURL(w,this._customAccessToken||m)}normalizeSourceURL(u,m,w,I){if(!a.f(u))return u;const P=st(u);return P.path=`/v4/${P.authority}.json`,P.params.push("secure"),w&&P.params.push(`language=${w}`),I&&P.params.push(`worldview=${I}`),this._makeAPIURL(P,this._customAccessToken||m)}normalizeSpriteURL(u,m,w,I){const P=st(u);return a.f(u)?(P.path=`/styles/v1${P.path}/sprite${m}${w}`,this._makeAPIURL(P,this._customAccessToken||I)):(P.path+=`${m}${w}`,_e(P))}normalizeTileURL(u,m,w){if(this._isSkuTokenExpired()&&this._createSkuToken(),u&&!a.f(u))return u;const I=st(u);I.path=I.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${m||w&&I.authority!=="raster"&&w===512?"@2x":""}${a.m.supported?".webp":"$1"}`),I.authority==="raster"?I.path=`/${a.e.RASTER_URL_PREFIX}${I.path}`:I.authority==="rasterarrays"?I.path=`/${a.e.RASTERARRAYS_URL_PREFIX}${I.path}`:I.authority==="3dtiles"?I.path=`/${a.e.TILES3D_URL_PREFIX}${I.path}`:(I.path=I.path.replace(/^.+\/v4\//,"/"),I.path=`/${a.e.TILE_URL_VERSION}${I.path}`);const P=this._customAccessToken||function(F){for(const W of F){const q=W.match(/^access_token=(.*)$/);if(q)return q[1]}return null}(I.params)||a.e.ACCESS_TOKEN;return a.e.REQUIRE_ACCESS_TOKEN&&P&&this._skuToken&&I.params.push(`sku=${this._skuToken}`),this._makeAPIURL(I,P)}canonicalizeTileURL(u,m){const w=st(u);if(!w.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!w.path.match(/\.[\w]+$/))return u;let I="mapbox://";w.path.match(/^\/raster\/v1\//)?I+=`raster/${w.path.replace(`/${a.e.RASTER_URL_PREFIX}/`,"")}`:w.path.match(/^\/rasterarrays\/v1\//)?I+=`rasterarrays/${w.path.replace(`/${a.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:I+=`tiles/${w.path.replace(`/${a.e.TILE_URL_VERSION}/`,"")}`;let P=w.params;return m&&(P=P.filter(F=>!F.match(/^access_token=/))),P.length&&(I+=`?${P.join("&")}`),I}canonicalizeTileset(u,m){const w=!!m&&a.f(m),I=[];for(const P of u.tiles||[])a.h(P)?I.push(this.canonicalizeTileURL(P,w)):I.push(P);return I}_makeAPIURL(u,m){const w="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",I=st(a.e.API_URL);if(u.protocol=I.protocol,u.authority=I.authority,u.protocol==="http"){const P=u.params.indexOf("secure");P>=0&&u.params.splice(P,1)}if(I.path!=="/"&&(u.path=`${I.path}${u.path}`),!a.e.REQUIRE_ACCESS_TOKEN)return _e(u);if(m=m||a.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!m)throw new Error(`An API access token is required to use Mapbox GL. ${w}`);if(m[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${w}`)}return u.params=u.params.filter(P=>P.indexOf("access_token")===-1),u.params.push(`access_token=${m||""}`),_e(u)}}const Re=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function st(b){const u=b.match(Re);if(!u)throw new Error("Unable to parse URL object");return{protocol:u[1],authority:u[2],path:u[3]||"/",params:u[4]?u[4].split("&"):[]}}function _e(b){const u=b.params.length?`?${b.params.join("&")}`:"";return`${b.protocol}://${b.authority}${b.path}${u}`}const We="mapbox.eventData";function Ue(b){if(!b)return null;const u=b.split(".");if(!u||u.length!==3)return null;try{return JSON.parse(a.j(u[1]))}catch{return null}}class vt{constructor(u){this.type=u,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(u){const m=Ue(a.e.ACCESS_TOKEN);let w="";return w=m&&m.u?a.k(m.u):a.e.ACCESS_TOKEN||"",u?`${We}.${u}:${w}`:`${We}:${w}`}fetchEventData(){const u=a.s("localStorage"),m=this.getStorageKey(),w=this.getStorageKey("uuid");if(u)try{const I=localStorage.getItem(m);I&&(this.eventData=JSON.parse(I));const P=localStorage.getItem(w);P&&(this.anonId=P)}catch{a.w("Unable to read from LocalStorage")}}saveEventData(){const u=a.s("localStorage"),m=this.getStorageKey(),w=this.getStorageKey("uuid"),I=this.anonId;if(u&&I)try{localStorage.setItem(w,I),Object.keys(this.eventData).length>=1&&localStorage.setItem(m,JSON.stringify(this.eventData))}catch{a.w("Unable to write to LocalStorage")}}processRequests(u){}postEvent(u,m,w,I){if(!a.e.EVENTS_URL)return;const P=st(a.e.EVENTS_URL);P.params.push(`access_token=${I||a.e.ACCESS_TOKEN||""}`);const F={event:this.type,created:new Date(u).toISOString()},W=m?a.l(F,m):F,q={url:_e(P),headers:{"Content-Type":"text/plain"},body:JSON.stringify([W])};this.pendingRequest=a.p(q,J=>{this.pendingRequest=null,w(J),this.saveEventData(),this.processRequests(I)})}queueRequest(u,m){this.queue.push(u),this.processRequests(m)}}const xt=new class extends vt{constructor(b){super("appUserTurnstile"),this._customAccessToken=b}postTurnstileEvent(b,u){a.e.EVENTS_URL&&a.e.ACCESS_TOKEN&&Array.isArray(b)&&b.some(m=>a.f(m)||a.h(m))&&this.queueRequest(Date.now(),u)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const u=Ue(a.e.ACCESS_TOKEN),m=u?u.u:a.e.ACCESS_TOKEN;let w=m!==this.eventData.tokenU;a.v(this.anonId)||(this.anonId=a.u(),w=!0);const I=this.queue.shift();if(this.eventData.lastSuccess){const P=new Date(this.eventData.lastSuccess),F=new Date(I),W=(I-this.eventData.lastSuccess)/864e5;w=w||W>=1||W<-1||P.getDate()!==F.getDate()}else w=!0;w?this.postEvent(I,{sdkIdentifier:"mapbox-gl-js",sdkVersion:h,skuId:Ee,"enabled.telemetry":!1,userId:this.anonId},P=>{P||(this.eventData.lastSuccess=I,this.eventData.tokenU=m)},b):this.processRequests()}},Vt=xt.postTurnstileEvent.bind(xt),lt=new class extends vt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(b,u,m,w){this.skuToken=u,this.errorCb=w,a.e.EVENTS_URL&&(m||a.e.ACCESS_TOKEN?this.queueRequest({id:b,timestamp:Date.now()},m):this.errorCb(new Error(Ie)))}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{id:u,timestamp:m}=this.queue.shift();u&&this.success[u]||(this.anonId||this.fetchEventData(),a.v(this.anonId)||(this.anonId=a.u()),this.postEvent(m,{sdkIdentifier:"mapbox-gl-js",sdkVersion:h,skuId:Ee,skuToken:this.skuToken,userId:this.anonId},w=>{w?this.errorCb(w):u&&(this.success[u]=!0)},b))}remove(){this.errorCb=null}},Ht=lt.postMapLoadEvent.bind(lt),Qt=new class extends vt{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(b){let u=this.mapInstanceIdMap.get(b);return u||(u=a.u(),this.mapInstanceIdMap.set(b,u)),u}getEventId(b){const u=this.eventIdPerMapInstanceMap.get(b)||0;return this.eventIdPerMapInstanceMap.set(b,u+1),u}postStyleLoadEvent(b,u){const{map:m,style:w,importedStyles:I}=u;if(!a.e.EVENTS_URL||!b&&!a.e.ACCESS_TOKEN)return;const P=this.getMapInstanceId(m),F={mapInstanceId:P,eventId:this.getEventId(P),style:w};I.length&&(F.importedStyles=I),this.queueRequest({timestamp:Date.now(),payload:F},b)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:u,payload:m}=this.queue.shift();this.postEvent(u,m,()=>{},b)}},rn=Qt.postStyleLoadEvent.bind(Qt),jn=new class extends vt{constructor(){super("gljs.performance")}postPerformanceEvent(b,u){a.e.EVENTS_URL&&(b||a.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:u},b)}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:u,performanceData:m}=this.queue.shift(),w=function(I){const P=performance.getEntriesByType("resource"),F=performance.getEntriesByType("mark"),W=function(ue){const ve={};if(ue){for(const ye in ue)if(ye!=="other")for(const be of ue[ye]){const we=`${ye}ResolveRangeMin`,ke=`${ye}ResolveRangeMax`,Ne=`${ye}RequestCount`,De=`${ye}RequestCachedCount`;ve[we]=Math.min(ve[we]||1/0,be.startTime),ve[ke]=Math.max(ve[ke]||-1/0,be.responseEnd);const $e=je=>{ve[je]===void 0&&(ve[je]=0),++ve[je]};be.transferSize!==void 0&&be.transferSize===0&&$e(De),$e(Ne)}}return ve}(function(ue,ve){const ye={};if(ue)for(const be of ue){const we=ve(be);ye[we]===void 0&&(ye[we]=[]),ye[we].push(be)}return ye}(P,v)),q=window.devicePixelRatio,J=navigator.connection||navigator.mozConnection||navigator.webkitConnection,ee=J?J.effectiveType:void 0,ae={counters:[],metadata:[],attributes:[]},le=(ue,ve,ye)=>{ye!=null&&ue.push({name:ve,value:ye.toString()})};for(const ue in W)le(ae.counters,ue,W[ue]);if(I.interactionRange[0]!==1/0&&I.interactionRange[1]!==-1/0&&(le(ae.counters,"interactionRangeMin",I.interactionRange[0]),le(ae.counters,"interactionRangeMax",I.interactionRange[1])),F)for(const ue of Object.keys(f)){const ve=f[ue],ye=F.find(be=>be.name===ve);ye&&le(ae.counters,ve,ye.startTime)}return le(ae.counters,"visibilityHidden",I.visibilityHidden),le(ae.attributes,"style",function(ue){if(ue)for(const ve of ue){const ye=ve.name.split("?")[0];if(a.i(ye)){const be=ye.split("/").slice(-2);if(be.length===2)return`mapbox://styles/${be[0]}/${be[1]}`}}}(P)),le(ae.attributes,"terrainEnabled",I.terrainEnabled?"true":"false"),le(ae.attributes,"fogEnabled",I.fogEnabled?"true":"false"),le(ae.attributes,"projection",I.projection),le(ae.attributes,"zoom",I.zoom),le(ae.metadata,"devicePixelRatio",q),le(ae.metadata,"connectionEffectiveType",ee),le(ae.metadata,"navigatorUserAgent",navigator.userAgent),le(ae.metadata,"screenWidth",window.screen.width),le(ae.metadata,"screenHeight",window.screen.height),le(ae.metadata,"windowWidth",window.innerWidth),le(ae.metadata,"windowHeight",window.innerHeight),le(ae.metadata,"mapWidth",I.width/q),le(ae.metadata,"mapHeight",I.height/q),le(ae.metadata,"webglRenderer",I.renderer),le(ae.metadata,"webglVendor",I.vendor),le(ae.metadata,"sdkVersion",h),le(ae.metadata,"sdkIdentifier","mapbox-gl-js"),ae}(m);for(const I of w.metadata);for(const I of w.counters);for(const I of w.attributes);this.postEvent(u,w,()=>{},b)}},Bn=jn.postPerformanceEvent.bind(jn),Tn=new class extends vt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(b,u,m,w){if(!a.e.API_URL||!a.e.SESSION_PATH)return;const I=st(a.e.API_URL+a.e.SESSION_PATH);I.params.push(`sku=${u||""}`),I.params.push(`access_token=${w||a.e.ACCESS_TOKEN||""}`);const P={url:_e(I),headers:{"Content-Type":"text/plain"}};this.pendingRequest=a.g(P,F=>{this.pendingRequest=null,m(F),this.saveEventData(),this.processRequests(w)})}getSessionAPI(b,u,m,w){this.skuToken=u,this.errorCb=w,a.e.SESSION_PATH&&a.e.API_URL&&(m||a.e.ACCESS_TOKEN?this.queueRequest({id:b,timestamp:Date.now()},m):this.errorCb(new Error(Ie)))}processRequests(b){if(this.pendingRequest||this.queue.length===0)return;const{id:u,timestamp:m}=this.queue.shift();u&&this.success[u]||this.getSession(m,this.skuToken,w=>{w?this.errorCb(w):u&&(this.success[u]=!0)},b)}remove(){this.errorCb=null}},Le=Tn.getSessionAPI.bind(Tn),qe=new Set;function mn(b,u){u?qe.add(b):qe.delete(b)}class cn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(u,m){this._updatedSourceCaches[u]=m,this.setDirty()}discardSourceCacheUpdate(u){delete this._updatedSourceCaches[u]}updateLayer(u){const m=u.scope;this._updatedLayers[m]=this._updatedLayers[m]||new Set,this._updatedLayers[m].add(u.id),this.setDirty()}removeLayer(u){const m=u.scope;this._removedLayers[m]=this._removedLayers[m]||{},this._updatedLayers[m]=this._updatedLayers[m]||new Set,this._removedLayers[m][u.id]=u,this._updatedLayers[m].delete(u.id),this._updatedPaintProps.delete(u.fqid),this.setDirty()}getRemovedLayer(u){return this._removedLayers[u.scope]?this._removedLayers[u.scope][u.id]:null}discardLayerRemoval(u){this._removedLayers[u.scope]&&delete this._removedLayers[u.scope][u.id]}getLayerUpdatesByScope(){const u={};for(const m in this._updatedLayers)u[m]=u[m]||{},u[m].updatedIds=Array.from(this._updatedLayers[m].values());for(const m in this._removedLayers)u[m]=u[m]||{},u[m].removedIds=Object.keys(this._removedLayers[m]);return u}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(u){this._updatedPaintProps.add(u.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(u){this._updatedImages.add(u),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function St(b){const{userImage:u}=b;return!!(u&&u.render&&u.render())&&(b.data.replace(new Uint8Array(u.data.buffer)),!0)}class Jt extends a.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(u){this.images[u]={},this.loaded[u]=!1,this.updatedImages[u]={},this.patterns[u]={},this.callbackDispatchedThisFrame[u]={},this.atlasImage[u]=new a.r({width:1,height:1})}isLoaded(){for(const u in this.loaded)if(!this.loaded[u])return!1;return!0}setLoaded(u,m){if(this.loaded[m]!==u&&(this.loaded[m]=u,u)){for(const{ids:w,callback:I}of this.requestors)this._notify(w,m,I);this.requestors=[]}}hasImage(u,m){return!!this.getImage(u,m)}getImage(u,m){return this.images[m][u]}addImage(u,m,w){this._validate(u,w)&&(this.images[m][u]=w)}_validate(u,m){let w=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new a.t(new Error(`Image "${u}" has invalid "stretchX" value`))),w=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new a.t(new Error(`Image "${u}" has invalid "stretchY" value`))),w=!1),this._validateContent(m.content,m)||(this.fire(new a.t(new Error(`Image "${u}" has invalid "content" value`))),w=!1),w}_validateStretch(u,m){if(!u)return!0;let w=0;for(const I of u){if(I[0]<w||I[1]<I[0]||m<I[1])return!1;w=I[1]}return!0}_validateContent(u,m){return!(u&&(u.length!==4||u[0]<0||m.data.width<u[0]||u[1]<0||m.data.height<u[1]||u[2]<0||m.data.width<u[2]||u[3]<0||m.data.height<u[3]||u[2]<u[0]||u[3]<u[1]))}updateImage(u,m,w){w.version=this.images[m][u].version+1,this.images[m][u]=w,this.updatedImages[m][u]=!0}removeImage(u,m){const w=this.images[m][u];delete this.images[m][u],delete this.patterns[m][u],w.userImage&&w.userImage.onRemove&&w.userImage.onRemove()}listImages(u){return Object.keys(this.images[u])}getImages(u,m,w){let I=!0;const P=!!this.loaded[m];if(!P)for(const F of u)this.images[m][F]||(I=!1);P||I?this._notify(u,m,w):this.requestors.push({ids:u,scope:m,callback:w})}getUpdatedImages(u){return this.updatedImages[u]}_notify(u,m,w){const I={};for(const P of u){this.images[m][P]||this.fire(new a.x("styleimagemissing",{id:P}));const F=this.images[m][P];F?I[P]={data:F.data.clone(),pixelRatio:F.pixelRatio,sdf:F.sdf,version:F.version,stretchX:F.stretchX,stretchY:F.stretchY,content:F.content,hasRenderCallback:!!(F.userImage&&F.userImage.render)}:a.w(`Image "${P}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}w(null,I)}getPixelSize(u){const{width:m,height:w}=this.atlasImage[u];return{width:m,height:w}}getPattern(u,m,w){const I=this.patterns[m][u],P=this.getImage(u,m);if(!P)return null;if(I&&I.position.version===P.version)return I.position;if(I)I.position.version=P.version;else{const F={w:P.data.width+2*a.y,h:P.data.height+2*a.y,x:0,y:0},W=new a.I(F,P,a.y);this.patterns[m][u]={bin:F,position:W}}return this._updatePatternAtlas(m,w),this.patterns[m][u].position}bind(u,m){const w=u.gl;let I=this.atlasTexture[m];I?this.dirty&&(I.update(this.atlasImage[m]),this.dirty=!1):(I=new a.T(u,this.atlasImage[m],w.RGBA8),this.atlasTexture[m]=I),I.bind(w.LINEAR,w.CLAMP_TO_EDGE)}_updatePatternAtlas(u,m){const w=[];for(const W in this.patterns[u])w.push(this.patterns[u][W].bin);const{w:I,h:P}=a.z(w),F=this.atlasImage[u];F.resize({width:I||1,height:P||1});for(const W in this.patterns[u]){const{bin:q,position:J}=this.patterns[u][W];let ee=J.padding;const ae=q.x+ee,le=q.y+ee,ue=this.images[u][W].data,ve=ue.width,ye=ue.height;ee=ee>1?ee-1:ee,a.r.copy(ue,F,{x:0,y:0},{x:ae,y:le},{width:ve,height:ye},m),a.r.copy(ue,F,{x:0,y:ye-ee},{x:ae,y:le-ee},{width:ve,height:ee},m),a.r.copy(ue,F,{x:0,y:0},{x:ae,y:le+ye},{width:ve,height:ee},m),a.r.copy(ue,F,{x:ve-ee,y:0},{x:ae-ee,y:le},{width:ee,height:ye},m),a.r.copy(ue,F,{x:0,y:0},{x:ae+ve,y:le},{width:ee,height:ye},m),a.r.copy(ue,F,{x:ve-ee,y:ye-ee},{x:ae-ee,y:le-ee},{width:ee,height:ee},m),a.r.copy(ue,F,{x:0,y:ye-ee},{x:ae+ve,y:le-ee},{width:ee,height:ee},m),a.r.copy(ue,F,{x:0,y:0},{x:ae+ve,y:le+ye},{width:ee,height:ee},m),a.r.copy(ue,F,{x:ve-ee,y:0},{x:ae-ee,y:le+ye},{width:ee,height:ee},m)}this.dirty=!0}beginFrame(){for(const u in this.images)this.callbackDispatchedThisFrame[u]={}}dispatchRenderCallbacks(u,m){for(const w of u){if(this.callbackDispatchedThisFrame[m][w])continue;this.callbackDispatchedThisFrame[m][w]=!0;const I=this.images[m][w];St(I)&&this.updateImage(w,m,I)}}}function kn(b){const u=b.key,m=b.value,w=b.valueSpec||{},I=b.objectElementValidators||{},P=b.style,F=b.styleSpec;let W=[];const q=a.B(m);if(q!=="object")return[new a.V(u,m,`object expected, ${q} found`)];for(const J in m){const ee=J.split(".")[0];let ae;I[ee]?ae=I[ee]:w[ee]?ae=Lt:I["*"]?ae=I["*"]:w["*"]&&(ae=Lt),ae?W=W.concat(ae({key:(u&&`${u}.`)+J,value:m[J],valueSpec:w[ee]||w["*"],style:P,styleSpec:F,object:m,objectKey:J},m)):W.push(new a.A(u,m[J],`unknown property "${J}"`))}for(const J in w)I[J]||w[J].required&&w[J].default===void 0&&m[J]===void 0&&W.push(new a.V(u,m,`missing required property "${J}"`));return W}function Gn(b){const u=b.value,m=b.valueSpec,w=b.style,I=b.styleSpec,P=b.key,F=b.arrayElementValidator||Lt;if(a.B(u)!=="array")return[new a.V(P,u,`array expected, ${a.B(u)} found`)];if(m.length&&u.length!==m.length)return[new a.V(P,u,`array length ${m.length} expected, length ${u.length} found`)];if(m["min-length"]&&u.length<m["min-length"])return[new a.V(P,u,`array length at least ${m["min-length"]} expected, length ${u.length} found`)];let W={type:m.value,values:m.values,minimum:m.minimum,maximum:m.maximum,function:void 0};I.$version<7&&(W.function=m.function),a.B(m.value)==="object"&&(W=m.value);let q=[];for(let J=0;J<u.length;J++)q=q.concat(F({array:u,arrayIndex:J,value:u[J],valueSpec:W,style:w,styleSpec:I,key:`${P}[${J}]`},!0));return q}function sn(b){const u=b.key,m=b.value,w=b.valueSpec;let I=a.B(m);if(I==="number"&&m!=m&&(I="NaN"),I!=="number")return[new a.V(u,m,`number expected, ${I} found`)];if("minimum"in w){let P=w.minimum;if(a.B(w.minimum)==="array"&&(P=w.minimum[b.arrayIndex]),m<P)return[new a.V(u,m,`${m} is less than the minimum value ${P}`)]}if("maximum"in w){let P=w.maximum;if(a.B(w.maximum)==="array"&&(P=w.maximum[b.arrayIndex]),m>P)return[new a.V(u,m,`${m} is greater than the maximum value ${P}`)]}return[]}function ot(b){const u=b.valueSpec,m=a.D(b.value.type);let w,I,P,F={};const W=m!=="categorical"&&b.value.property===void 0,q=!W,J=a.B(b.value.stops)==="array"&&a.B(b.value.stops[0])==="array"&&a.B(b.value.stops[0][0])==="object",ee=kn({key:b.key,value:b.value,valueSpec:b.styleSpec.function,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{stops:function(ue){if(m==="identity")return[new a.V(ue.key,ue.value,'identity function may not have a "stops" property')];let ve=[];const ye=ue.value;return ve=ve.concat(Gn({key:ue.key,value:ye,valueSpec:ue.valueSpec,style:ue.style,styleSpec:ue.styleSpec,arrayElementValidator:ae})),a.B(ye)==="array"&&ye.length===0&&ve.push(new a.V(ue.key,ye,"array must have at least one stop")),ve},default:function(ue){return Lt({key:ue.key,value:ue.value,valueSpec:u,style:ue.style,styleSpec:ue.styleSpec})}}});return m==="identity"&&W&&ee.push(new a.V(b.key,b.value,'missing required property "property"')),m==="identity"||b.value.stops||ee.push(new a.V(b.key,b.value,'missing required property "stops"')),m==="exponential"&&b.valueSpec.expression&&!a.F(b.valueSpec)&&ee.push(new a.V(b.key,b.value,"exponential functions not supported")),b.styleSpec.$version>=8&&(q&&!a.G(b.valueSpec)?ee.push(new a.V(b.key,b.value,"property functions not supported")):W&&!a.H(b.valueSpec)&&ee.push(new a.V(b.key,b.value,"zoom functions not supported"))),m!=="categorical"&&!J||b.value.property!==void 0||ee.push(new a.V(b.key,b.value,'"property" property is required')),ee;function ae(ue){let ve=[];const ye=ue.value,be=ue.key;if(a.B(ye)!=="array")return[new a.V(be,ye,`array expected, ${a.B(ye)} found`)];if(ye.length!==2)return[new a.V(be,ye,`array length 2 expected, length ${ye.length} found`)];if(J){if(a.B(ye[0])!=="object")return[new a.V(be,ye,`object expected, ${a.B(ye[0])} found`)];if(ye[0].zoom===void 0)return[new a.V(be,ye,"object stop key must have zoom")];if(ye[0].value===void 0)return[new a.V(be,ye,"object stop key must have value")];const we=a.D(ye[0].zoom);if(typeof we!="number")return[new a.V(be,ye[0].zoom,"stop zoom values must be numbers")];if(P&&P>we)return[new a.V(be,ye[0].zoom,"stop zoom values must appear in ascending order")];we!==P&&(P=we,I=void 0,F={}),ve=ve.concat(kn({key:`${be}[0]`,value:ye[0],valueSpec:{zoom:{}},style:ue.style,styleSpec:ue.styleSpec,objectElementValidators:{zoom:sn,value:le}}))}else ve=ve.concat(le({key:`${be}[0]`,value:ye[0],valueSpec:{},style:ue.style,styleSpec:ue.styleSpec},ye));return a.J(a.K(ye[1]))?ve.concat([new a.V(`${be}[1]`,ye[1],"expressions are not allowed in function stops.")]):ve.concat(Lt({key:`${be}[1]`,value:ye[1],valueSpec:u,style:ue.style,styleSpec:ue.styleSpec}))}function le(ue,ve){const ye=a.B(ue.value),be=a.D(ue.value),we=ue.value!==null?ue.value:ve;if(w){if(ye!==w)return[new a.V(ue.key,we,`${ye} stop domain type must match previous stop domain type ${w}`)]}else w=ye;if(ye!=="number"&&ye!=="string"&&ye!=="boolean"&&typeof be!="number"&&typeof be!="string"&&typeof be!="boolean")return[new a.V(ue.key,we,"stop domain value must be a number, string, or boolean")];if(ye!=="number"&&m!=="categorical"){let ke=`number expected, ${ye} found`;return a.G(u)&&m===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new a.V(ue.key,we,ke)]}return m!=="categorical"||ye!=="number"||typeof be=="number"&&isFinite(be)&&Math.floor(be)===be?m!=="categorical"&&ye==="number"&&typeof be=="number"&&typeof I=="number"&&I!==void 0&&be<I?[new a.V(ue.key,we,"stop domain values must appear in ascending order")]:(I=be,m==="categorical"&&be in F?[new a.V(ue.key,we,"stop domain values must be unique")]:(F[be]=!0,[])):[new a.V(ue.key,we,`integer expected, found ${String(be)}`)]}}function Ge(b){const u=(b.expressionContext==="property"?a.L:a.M)(a.K(b.value),b.valueSpec);if(u.result==="error")return u.value.map(w=>new a.V(`${b.key}${w.key}`,b.value,w.message));const m=u.value.expression||u.value._styleExpression.expression;if(b.expressionContext==="property"&&b.propertyKey==="text-font"&&!m.outputDefined())return[new a.V(b.key,b.value,`Invalid data expression for "${b.propertyKey}". Output values must be contained as literals within the expression.`)];if(b.expressionContext==="property"&&b.propertyType==="layout"&&!a.N(m))return[new a.V(b.key,b.value,'"feature-state" data expressions are not supported with layout properties.')];if(b.expressionContext==="filter")return Xt(m,b);if(b.expressionContext&&b.expressionContext.indexOf("cluster")===0){if(!a.O(m,["zoom","feature-state"]))return[new a.V(b.key,b.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(b.expressionContext==="cluster-initial"&&!a.Q(m))return[new a.V(b.key,b.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xt(b,u){const m=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(u.valueSpec&&u.valueSpec.expression)for(const I of u.valueSpec.expression.parameters)m.delete(I);if(m.size===0)return[];const w=[];return b instanceof a.S&&m.has(b.name)?[new a.V(u.key,u.value,`["${b.name}"] expression is not supported in a filter for a ${u.object.type} layer with id: ${u.object.id}`)]:(b.eachChild(I=>{w.push(...Xt(I,u))}),w)}function An(b){const u=b.key,m=b.value,w=b.valueSpec,I=[];return Array.isArray(w.values)?w.values.indexOf(a.D(m))===-1&&I.push(new a.V(u,m,`expected one of [${w.values.join(", ")}], ${JSON.stringify(m)} found`)):Object.keys(w.values).indexOf(a.D(m))===-1&&I.push(new a.V(u,m,`expected one of [${Object.keys(w.values).join(", ")}], ${JSON.stringify(m)} found`)),I}function Sn(b){return a.W(a.K(b.value))?Ge(a.C({},b,{expressionContext:"filter",valueSpec:b.styleSpec[`filter_${b.layerType||"fill"}`]})):jt(b)}function jt(b){const u=b.value,m=b.key;if(a.B(u)!=="array")return[new a.V(m,u,`array expected, ${a.B(u)} found`)];const w=b.styleSpec;let I,P=[];if(u.length<1)return[new a.V(m,u,"filter array must have at least 1 element")];switch(P=P.concat(An({key:`${m}[0]`,value:u[0],valueSpec:w.filter_operator,style:b.style,styleSpec:b.styleSpec})),a.D(u[0])){case"<":case"<=":case">":case">=":u.length>=2&&a.D(u[1])==="$type"&&P.push(new a.V(m,u,`"$type" cannot be use with operator "${u[0]}"`));case"==":case"!=":u.length!==3&&P.push(new a.V(m,u,`filter array for operator "${u[0]}" must have 3 elements`));case"in":case"!in":u.length>=2&&(I=a.B(u[1]),I!=="string"&&P.push(new a.V(`${m}[1]`,u[1],`string expected, ${I} found`)));for(let F=2;F<u.length;F++)I=a.B(u[F]),a.D(u[1])==="$type"?P=P.concat(An({key:`${m}[${F}]`,value:u[F],valueSpec:w.geometry_type,style:b.style,styleSpec:b.styleSpec})):I!=="string"&&I!=="number"&&I!=="boolean"&&P.push(new a.V(`${m}[${F}]`,u[F],`string, number, or boolean expected, ${I} found`));break;case"any":case"all":case"none":for(let F=1;F<u.length;F++)P=P.concat(jt({key:`${m}[${F}]`,value:u[F],style:b.style,styleSpec:b.styleSpec}));break;case"has":case"!has":I=a.B(u[1]),u.length!==2?P.push(new a.V(m,u,`filter array for "${u[0]}" operator must have 2 elements`)):I!=="string"&&P.push(new a.V(`${m}[1]`,u[1],`string expected, ${I} found`))}return P}function mr(b,u){const m=b.key,w=b.style,I=b.layer,P=b.styleSpec,F=b.value,W=b.objectKey,q=P[`${u}_${b.layerType}`];if(!q)return[];const J=W.match(/^(.*)-transition$/);if(u==="paint"&&J&&q[J[1]]&&q[J[1]].transition)return Lt({key:m,value:F,valueSpec:P.transition,style:w,styleSpec:P});const ee=b.valueSpec||q[W];if(!ee)return[new a.A(m,F,`unknown property "${W}"`)];let ae;if(a.B(F)==="string"&&a.G(ee)&&!ee.tokens&&(ae=/^{([^}]+)}$/.exec(F))){const ue=`\`{ "type": "identity", "property": ${ae?JSON.stringify(ae[1]):'"_"'} }\``;return[new a.V(m,F,`"${W}" does not support interpolation syntax
Use an identity property function instead: ${ue}.`)]}const le=[];if(b.layerType==="symbol")W!=="text-field"||!w||w.glyphs||w.imports||le.push(new a.V(m,F,'use of "text-field" requires a style "glyphs" property')),W==="text-font"&&a.X(a.K(F))&&a.D(F.type)==="identity"&&le.push(new a.V(m,F,'"text-font" does not support identity functions'));else if(b.layerType==="model"&&u==="paint"&&I&&I.layout&&I.layout.hasOwnProperty("model-id")&&a.G(ee)&&(a.Y(ee)||a.H(ee))){const ue=a.L(a.K(F),ee),ve=ue.value.expression||ue.value._styleExpression.expression;ve&&!a.O(ve,["measure-light"])&&(W==="model-emissive-strength"&&a.Q(ve)&&a.N(ve)||le.push(new a.V(m,F,`${W} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return le.concat(Lt({key:b.key,value:F,valueSpec:ee,style:w,styleSpec:P,expressionContext:"property",propertyType:u,propertyKey:W}))}function Un(b){return mr(b,"paint")}function tr(b){return mr(b,"layout")}function Sr(b){let u=[];const m=b.value,w=b.key,I=b.style,P=b.styleSpec;m.type||m.ref||u.push(new a.V(w,m,'either "type" or "ref" is required'));let F=a.D(m.type);const W=a.D(m.ref);if(m.id){const q=a.D(m.id);for(let J=0;J<b.arrayIndex;J++){const ee=I.layers[J];a.D(ee.id)===q&&u.push(new a.V(w,m.id,`duplicate layer id "${m.id}", previously used at line ${ee.id.__line__}`))}}if("ref"in m){let q;["type","source","source-layer","filter","layout"].forEach(J=>{J in m&&u.push(new a.V(w,m[J],`"${J}" is prohibited for ref layers`))}),I.layers.forEach(J=>{a.D(J.id)===W&&(q=J)}),q?q.ref?u.push(new a.V(w,m.ref,"ref cannot reference another ref layer")):F=a.D(q.type):typeof W=="string"&&u.push(new a.V(w,m.ref,`ref layer "${W}" not found`))}else if(F!=="background"&&F!=="sky"&&F!=="slot")if(m.source){const q=I.sources&&I.sources[m.source],J=q&&a.D(q.type);q?J==="vector"&&F==="raster"?u.push(new a.V(w,m.source,`layer "${m.id}" requires a raster source`)):J==="raster"&&F!=="raster"?u.push(new a.V(w,m.source,`layer "${m.id}" requires a vector source`)):J!=="vector"||m["source-layer"]?J==="raster-dem"&&F!=="hillshade"?u.push(new a.V(w,m.source,"raster-dem source can only be used with layer type 'hillshade'.")):J!=="raster-array"||["raster","raster-particle"].includes(F)?F!=="line"||!m.paint||!m.paint["line-gradient"]&&!m.paint["line-trim-offset"]||J==="geojson"&&q.lineMetrics?F==="raster-particle"&&J!=="raster-array"&&u.push(new a.V(w,m.source,`layer "${m.id}" requires a 'raster-array' source.`)):u.push(new a.V(w,m,`layer "${m.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):u.push(new a.V(w,m.source,"raster-array source can only be used with layer type 'raster'.")):u.push(new a.V(w,m,`layer "${m.id}" must specify a "source-layer"`)):u.push(new a.V(w,m.source,`source "${m.source}" not found`))}else u.push(new a.V(w,m,'missing required property "source"'));return u=u.concat(kn({key:w,value:m,valueSpec:P.layer,style:b.style,styleSpec:b.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Lt({key:`${w}.type`,value:m.type,valueSpec:P.layer.type,style:b.style,styleSpec:b.styleSpec,object:m,objectKey:"type"}),filter:q=>Sn(a.C({layerType:F},q)),layout:q=>kn({layer:m,key:q.key,value:q.value,valueSpec:{},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":J=>tr(a.C({layerType:F},J))}}),paint:q=>kn({layer:m,key:q.key,value:q.value,valueSpec:{},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{"*":J=>Un(a.C({layerType:F,layer:m},J))}})}})),u}function Ln(b){const u=b.value,m=b.key,w=a.B(u);return w!=="string"?[new a.V(m,u,`string expected, ${w} found`)]:[]}const ir={promoteId:function({key:b,value:u}){if(a.B(u)==="string")return Ln({key:b,value:u});{const m=[];for(const w in u)m.push(...Ln({key:`${b}.${w}`,value:u[w]}));return m}}};function ui(b){const u=b.value,m=b.key,w=b.styleSpec,I=b.style;if(!u.type)return[new a.V(m,u,'"type" is required')];const P=a.D(u.type);let F=[];switch(["vector","raster","raster-dem","raster-array"].includes(P)&&(u.url||u.tiles||F.push(new a.A(m,u,'Either "url" or "tiles" is required.'))),P){case"vector":case"raster":case"raster-dem":case"raster-array":return F=F.concat(kn({key:m,value:u,valueSpec:w[`source_${P.replace("-","_")}`],style:b.style,styleSpec:w,objectElementValidators:ir})),F;case"geojson":if(F=kn({key:m,value:u,valueSpec:w.source_geojson,style:I,styleSpec:w,objectElementValidators:ir}),u.cluster)for(const W in u.clusterProperties){const[q,J]=u.clusterProperties[W],ee=typeof q=="string"?[q,["accumulated"],["get",W]]:q;F.push(...Ge({key:`${m}.${W}.map`,value:J,expressionContext:"cluster-map"})),F.push(...Ge({key:`${m}.${W}.reduce`,value:ee,expressionContext:"cluster-reduce"}))}return F;case"video":return kn({key:m,value:u,valueSpec:w.source_video,style:I,styleSpec:w});case"image":return kn({key:m,value:u,valueSpec:w.source_image,style:I,styleSpec:w});case"canvas":return[new a.V(m,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return An({key:`${m}.type`,value:u.type,valueSpec:{values:Fr(w)},style:I,styleSpec:w})}}function Fr(b){return b.source.reduce((u,m)=>{const w=b[m];return w.type.type==="enum"&&(u=u.concat(Object.keys(w.type.values))),u},[])}function ar(b){const u=b.value,m=b.styleSpec,w=m.light,I=b.style;let P=[];const F=a.B(u);if(u===void 0)return P;if(F!=="object")return P=P.concat([new a.V("light",u,`object expected, ${F} found`)]),P;for(const W in u){const q=W.match(/^(.*)-transition$/);P=P.concat(q&&w[q[1]]&&w[q[1]].transition?Lt({key:W,value:u[W],valueSpec:m.transition,style:I,styleSpec:m}):w[W]?Lt({key:W,value:u[W],valueSpec:w[W],style:I,styleSpec:m}):[new a.V(W,u[W],`unknown property "${W}"`)])}return P}function Nr(b){const u=b.value;let m=[];if(!u)return m;const w=a.B(u);if(w!=="object")return m=m.concat([new a.V("light-3d",u,`object expected, ${w} found`)]),m;const I=b.styleSpec,P=I["light-3d"],F=b.key,W=b.style,q=b.style.lights;for(const ae of["type","id"])if(!(ae in u))return m=m.concat([new a.V("light-3d",u,`missing property ${ae} on light`)]),m;if(u.type&&q)for(let ae=0;ae<b.arrayIndex;ae++){const le=a.D(u.type),ue=q[ae];a.D(ue.type)===le&&m.push(new a.V(F,u.id,`duplicate light type "${u.type}", previously defined at line ${ue.id.__line__}`))}const J=`properties_light_${u.type}`;if(!(J in I))return m=m.concat([new a.V("light-3d",u,`Invalid light type ${u.type}`)]),m;const ee=I[J];for(const ae in u)if(ae==="properties"){const le=u[ae],ue=a.B(le);if(ue!=="object")return m=m.concat([new a.V("properties",le,`object expected, ${ue} found`)]),m;for(const ve in le)m=m.concat(ee[ve]?Lt({key:ve,value:le[ve],valueSpec:ee[ve],style:W,styleSpec:I}):[new a.A(b.key,le[ve],`unknown property "${ve}"`)])}else{const le=ae.match(/^(.*)-transition$/);m=m.concat(le&&P[le[1]]&&P[le[1]].transition?Lt({key:ae,value:u[ae],valueSpec:I.transition,style:W,styleSpec:I}):P[ae]?Lt({key:ae,value:u[ae],valueSpec:P[ae],style:W,styleSpec:I}):[new a.A(ae,u[ae],`unknown property "${ae}"`)])}return m}function Hr(b){const u=b.value,m=b.key,w=b.style,I=b.styleSpec,P=I.terrain;let F=[];const W=a.B(u);if(u===void 0||W==="null")return F;if(W!=="object")return F=F.concat([new a.V("terrain",u,`object expected, ${W} found`)]),F;for(const q in u){const J=q.match(/^(.*)-transition$/);F=F.concat(J&&P[J[1]]&&P[J[1]].transition?Lt({key:q,value:u[q],valueSpec:I.transition,style:w,styleSpec:I}):P[q]?Lt({key:q,value:u[q],valueSpec:P[q],style:w,styleSpec:I}):[new a.A(q,u[q],`unknown property "${q}"`)])}if(u.source){const q=w.sources&&w.sources[u.source],J=q&&a.D(q.type);q?J!=="raster-dem"&&F.push(new a.V(m,u.source,`terrain cannot be used with a source of type ${String(J)}, it only be used with a "raster-dem" source type`)):F.push(new a.V(m,u.source,`source "${u.source}" not found`))}else F.push(new a.V(m,u,'terrain is missing required property "source"'));return F}function xi(b){const u=b.value,m=b.style,w=b.styleSpec,I=w.fog;let P=[];const F=a.B(u);if(u===void 0)return P;if(F!=="object")return P=P.concat([new a.V("fog",u,`object expected, ${F} found`)]),P;for(const W in u){const q=W.match(/^(.*)-transition$/);P=P.concat(q&&I[q[1]]&&I[q[1]].transition?Lt({key:W,value:u[W],valueSpec:w.transition,style:m,styleSpec:w}):I[W]?Lt({key:W,value:u[W],valueSpec:I[W],style:m,styleSpec:w}):[new a.A(W,u[W],`unknown property "${W}"`)])}return P}const Fe={"*":()=>[],array:Gn,boolean:function(b){const u=b.value,m=b.key,w=a.B(u);return w!=="boolean"?[new a.V(m,u,`boolean expected, ${w} found`)]:[]},number:sn,color:function(b){const u=b.key,m=b.value,w=a.B(m);return w!=="string"?[new a.V(u,m,`color expected, ${w} found`)]:a.U.parseCSSColor(m)===null?[new a.V(u,m,`color expected, "${m}" found`)]:[]},enum:An,filter:Sn,function:ot,layer:Sr,object:kn,source:ui,model:a.Z,light:ar,"light-3d":Nr,terrain:Hr,fog:xi,string:Ln,formatted:function(b){return Ln(b).length===0?[]:Ge(b)},resolvedImage:function(b){return Ln(b).length===0?[]:Ge(b)},projection:function(b){const u=b.value,m=b.styleSpec,w=m.projection,I=b.style;let P=[];const F=a.B(u);if(F==="object")for(const W in u)P=P.concat(Lt({key:W,value:u[W],valueSpec:w[W],style:I,styleSpec:m}));else F!=="string"&&(P=P.concat([new a.V("projection",u,`object or string expected, ${F} found`)]));return P},import:function(b){const{value:u,styleSpec:m}=b,{data:w,...I}=u;Object.defineProperty(I,"__line__",{value:u.__line__,enumerable:!1});let P=kn(a.C({},b,{value:I,valueSpec:m.import}));return a.D(I.id)===""&&P.push(new a.V(`${b.key}.id`,I,"import id can't be an empty string")),w&&(P=P.concat(un(w,m,{key:`${b.key}.data`}))),P}};function Lt(b,u=!1){const m=b.value,w=b.valueSpec,I=b.styleSpec;if(w.expression&&a.X(a.D(m)))return ot(b);if(w.expression&&a.J(a.K(m)))return Ge(b);if(w.type&&Fe[w.type]){const P=Fe[w.type](b);return u===!0&&P.length>0&&a.B(b.value)==="array"?Ge(b):P}return kn(a.C({},b,{valueSpec:w.type?I[w.type]:w}))}function Kt(b){const u=b.value,m=b.key,w=Ln(b);return w.length||(u.indexOf("{fontstack}")===-1&&w.push(new a.V(m,u,'"glyphs" url must include a "{fontstack}" token')),u.indexOf("{range}")===-1&&w.push(new a.V(m,u,'"glyphs" url must include a "{range}" token'))),w}function un(b,u=a._,m={}){return Lt({key:m.key||"",value:b,valueSpec:u.$root,styleSpec:u,style:b,objectElementValidators:{glyphs:Kt,"*":()=>[]}})}function Cn(b,u=a._){return Je(un(b,u))}const Ar=b=>Je(ui(b)),Vr=b=>Je(ar(b)),hs=b=>Je(Nr(b)),Ls=b=>Je(Hr(b)),hi=b=>Je(xi(b)),Tt=b=>Je(Sr(b)),xe=b=>Je(Sn(b)),Ce=b=>Je(Un(b)),Xe=b=>Je(tr(b)),nt=b=>Je(a.Z(b));function Je(b){return b.slice().sort((u,m)=>u.line&&m.line?u.line-m.line:0)}function pt(b,u){let m=!1;if(u&&u.length)for(const w of u)w instanceof a.A?a.w(w.message):(b.fire(new a.t(new Error(w.message))),m=!0);return m}let Rt;class gt extends a.E{constructor(u,m="flat"){super(),this._transitionable=new a.$(Rt||(Rt=new a.a0({anchor:new a.a1(a._.light.anchor),position:new a.a2(a._.light.position),color:new a.a1(a._.light.color),intensity:new a.a1(a._.light.intensity)}))),this.setLight(u,m),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(u,m,w={}){this._validate(Vr,u,w)||(this._transitionable.setTransitionOrValue(u),this.id=m)}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,m,w){return(!w||w.validate!==!1)&&pt(this,u.call(Cn,a.l({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a._})))}}const Pt=new a.a0({source:new a.a1(a._.terrain.source),exaggeration:new a.a1(a._.terrain.exaggeration)});let zt=class extends a.E{constructor(b,u,m,w){super(),this.scope=m,this._transitionable=new a.$(Pt,m,w),this._transitionable.setTransitionOrValue(b,w),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(b,u){this._transitionable.setTransitionOrValue(b,u)}updateTransitions(b){this._transitioning=this._transitionable.transitioned(b,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(b){this.properties=this._transitioning.possiblyEvaluate(b)}getExaggeration(b){return this._transitioning.possiblyEvaluate(new a.a3(b)).get("exaggeration")}isZoomDependent(){const b=this._transitionable._values.exaggeration;return b!=null&&b.value!=null&&b.value.expression!=null&&b.value.expression instanceof a.a4}};const Bt=45,ln=65,Mn=.05;function En(b,u,m,w){const I=a.a7(Bt,ln,m),[P,F]=Ve(b,w);let W=1-Math.min(1,Math.exp((u-P)/(F-P)*-6));return W*=W*W,W=Math.min(1,1.00747*W),W*I*b.alpha}function Ve(b,u){const m=.5/Math.tan(.5*u);return[b.range[0]+m,b.range[1]+m]}function yt(b,u,m,w,I){const P=a.a6.vec3.transformMat4([],[u,m,w],I.mercatorFogMatrix);return En(b,a.a6.vec3.length(P),I.pitch,I._fov)}function Mt(b,u,m,w,I,P,F){const W=[[m,w,0],[I,w,0],[I,P,0],[m,P,0]];let q=Number.MAX_VALUE,J=-Number.MAX_VALUE;for(const ee of W){const ae=a.a6.vec3.transformMat4([],ee,u),le=a.a6.vec3.length(ae);q=Math.min(q,le),J=Math.max(J,le)}return[En(b,q,F.pitch,F._fov),En(b,J,F.pitch,F._fov)]}const Et=new a.a0({range:new a.a1(a._.fog.range),color:new a.a1(a._.fog.color),"high-color":new a.a1(a._.fog["high-color"]),"space-color":new a.a1(a._.fog["space-color"]),"horizon-blend":new a.a1(a._.fog["horizon-blend"]),"star-intensity":new a.a1(a._.fog["star-intensity"]),"vertical-range":new a.a1(a._.fog["vertical-range"])});class It extends a.E{constructor(u,m,w,I){super(),this._transitionable=new a.$(Et,w,new Map(I)),this.set(u,I),this._transitioning=this._transitionable.untransitioned(),this._transform=m,this.properties=new a.a8(Et),this.scope=w}get state(){const u=this._transform,m=u.projection.name==="globe",w=a.a9(u.zoom),I=this.properties.get("range"),P=[.5,3];return{range:m?[a.aa(P[0],I[0],w),a.aa(P[1],I[1],w)]:I,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(u,m,w={}){if(this._validate(hi,u,w))return;const I=a.l({},u);for(const P of Object.keys(a._.fog))I[P]===void 0&&(I[P]=a._.fog[P].default);this._options=I,this._transitionable.setTransitionOrValue(this._options,m)}getOpacity(u){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.a7(Bt,ln,u))*m.a}getOpacityAtLatLng(u,m){return this._transform.projection.supportsFog?function(w,I,P){const F=a.a5.fromLngLat(I),W=P.elevation?P.elevation.getAtPointOrZero(F):0;return yt(w,F.x,F.y,W,P)}(this.state,u,m):0}getOpacityForTile(u){if(!this._transform.projection.supportsFog)return[1,1];const m=this._transform.calculateFogTileMatrix(u.toUnwrapped());return Mt(this.state,m,0,0,a.ab,a.ab,this._transform)}getOpacityForBounds(u,m,w,I,P){return this._transform.projection.supportsFog?Mt(this.state,u,m,w,I,P,this._transform):[1,1]}getFovAdjustedRange(u){return this._transform.projection.supportsFog?Ve(this.state,u):[0,1]}isVisibleOnFrustum(u){if(!this._transform.projection.supportsFog)return!1;const m=[4,5,6,7];for(const w of m){const I=u.points[w];let P;if(I[2]>=0)P=I;else{const F=u.points[w-4];P=a.ac(F,I,F[2]/(F[2]-I[2]))}if(yt(this.state,P[0],P[1],0,this._transform)>=Mn)return!0}return!1}updateConfig(u){this._transitionable.setTransitionOrValue(this._options,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}_validate(u,m,w){return(!w||w.validate!==!1)&&pt(this,u.call(Cn,a.l({value:m,style:{glyphs:!0,sprite:!0},styleSpec:a._})))}}class wn extends a.E{constructor(u,m,w,I){super(),this.scope=w,this._options=u,this.properties=new a.a8(m),this._transitionable=new a.$(m,w,new Map(I)),this._transitionable.setTransitionOrValue(u.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(u){this._transitionable.setTransitionOrValue(this._options.properties,new Map(u))}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(u,m){this._options=u,this._transitionable.setTransitionOrValue(u.properties,m)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}let _n,zn;class $n{constructor(u,m,w,I){this.screenBounds=u,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=w,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,I)}static createFromScreenPoints(u,m){let w,I;if(u instanceof a.P||typeof u[0]=="number"){const P=a.P.convert(u);w=[P],I=m.isPointAboveHorizon(P)}else{const P=a.P.convert(u[0]),F=a.P.convert(u[1]);w=[P,F],I=a.ae(P,F).every(W=>m.isPointAboveHorizon(W))}return new $n(w,m.getCameraPoint(),I,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(u){return a.ae(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],u)}bufferedCameraGeometry(u){const m=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],I=a.ae(m,w,0,!1);return this.cameraPoint.y>w.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<w.x?I.splice(3,0,this.cameraPoint):this.cameraPoint.x>=w.x?I[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(I[3]=this.cameraPoint)),a.af(I,u)}bufferedCameraGeometryGlobe(u){const m=this.screenBounds[0],w=this.screenBounds.length===1?this.screenBounds[0].add(new a.P(1,1)):this.screenBounds[1],I=a.ae(m,w,u),P=this.cameraPoint.clone();switch(3*((P.y>m.y)+(P.y>w.y))+((P.x>m.x)+(P.x>w.x))){case 0:I[0]=P,I[4]=P.clone();break;case 1:I.splice(1,0,P);break;case 2:I[1]=P;break;case 3:I.splice(4,0,P);break;case 5:I.splice(2,0,P);break;case 6:I[3]=P;break;case 7:I.splice(3,0,P);break;case 8:I[2]=P}return I}containsTile(u,m,w,I=0){const P=u.queryPadding/m._pixelsPerMercatorPixel+1,F=w?this._bufferedCameraMercator(P,m):this._bufferedScreenMercator(P,m);let W=u.tileID.wrap+(F.unwrapped?I:0);const q=F.polygon.map(be=>a.ag(u.tileTransform,be,W));if(!a.ah(q,0,0,a.ab,a.ab))return;W=u.tileID.wrap+(this.screenGeometryMercator.unwrapped?I:0);const J=this.screenGeometryMercator.polygon.map(be=>a.ai(u.tileTransform,be,W)),ee=J.map(be=>new a.P(be[0],be[1])),ae=m.getFreeCameraOptions().position||new a.a5(0,0,0),le=a.ai(u.tileTransform,ae,W),ue=J.map(be=>{const we=a.a6.vec3.sub(be,be,le);return a.a6.vec3.normalize(we,we),new a.aj(le,we)}),ve=a.ak(u,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:ee,tilespaceRays:ue,bufferedTilespaceGeometry:q,bufferedTilespaceBounds:(ye=a.al(q),ye.min.x=a.ap(ye.min.x,0,a.ab),ye.min.y=a.ap(ye.min.y,0,a.ab),ye.max.x=a.ap(ye.max.x,0,a.ab),ye.max.y=a.ap(ye.max.y,0,a.ab),ye),tile:u,tileID:u.tileID,pixelToTileUnitsFactor:ve};var ye}_bufferedScreenMercator(u,m){const w=dr(u);if(this._screenRaycastCache[w])return this._screenRaycastCache[w];{let I;return I=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(u),m):{polygon:this.bufferedScreenGeometry(u).map(P=>m.pointCoordinate3D(P)),unwrapped:!0},this._screenRaycastCache[w]=I,I}}_bufferedCameraMercator(u,m){const w=dr(u);if(this._cameraRaycastCache[w])return this._cameraRaycastCache[w];{let I;return I=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(u),m):{polygon:this.bufferedCameraGeometry(u).map(P=>m.pointCoordinate3D(P)),unwrapped:!0},this._cameraRaycastCache[w]=I,I}}_projectAndResample(u,m){const w=function(P,F){const W=a.a6.mat4.multiply([],F.pixelMatrix,F.globeMatrix),q=[0,-a.aq,0,1],J=[0,a.aq,0,1],ee=[0,0,0,1];a.a6.vec4.transformMat4(q,q,W),a.a6.vec4.transformMat4(J,J,W),a.a6.vec4.transformMat4(ee,ee,W);const ae=new a.P(q[0]/q[3],q[1]/q[3]),le=new a.P(J[0]/J[3],J[1]/J[3]),ue=a.an(P,ae)&&q[3]<ee[3],ve=a.an(P,le)&&J[3]<ee[3];if(!ue&&!ve)return null;const ye=function(et,Ke,tt){for(let ut=1;ut<et.length;ut++){const at=gr(Ke.pointCoordinate3D(et[ut-1]).x),rt=gr(Ke.pointCoordinate3D(et[ut]).x);if(tt<0){if(at<rt)return{idx:ut,t:-at/(rt-1-at)}}else if(rt<at)return{idx:ut,t:(1-at)/(rt+1-at)}}return null}(P,F,ue?-1:1);if(!ye)return null;const{idx:be,t:we}=ye;let ke=be>1?lr(P.slice(0,be),F):[],Ne=be<P.length?lr(P.slice(be),F):[];ke=ke.map(et=>new a.P(gr(et.x),et.y)),Ne=Ne.map(et=>new a.P(gr(et.x),et.y));const De=[...ke];De.length===0&&De.push(Ne[Ne.length-1]);const $e=a.aa(De[De.length-1].y,(Ne.length===0?ke[0]:Ne[0]).y,we);let je;return je=ue?[new a.P(0,$e),new a.P(0,0),new a.P(1,0),new a.P(1,$e)]:[new a.P(1,$e),new a.P(1,1),new a.P(0,1),new a.P(0,$e)],De.push(...je),Ne.length===0?De.push(ke[0]):De.push(...Ne),{polygon:De.map(et=>new a.a5(et.x,et.y)),unwrapped:!1}}(u,m);if(w)return w;const I=function(P,F){let W=!1,q=-1/0,J=0;for(let ae=0;ae<P.length-1;ae++)P[ae].x>q&&(q=P[ae].x,J=ae);for(let ae=0;ae<P.length-1;ae++){const le=(J+ae)%(P.length-1),ue=P[le],ve=P[le+1];Math.abs(ue.x-ve.x)>.5&&(ue.x<ve.x?(ue.x+=1,le===0&&(P[P.length-1].x+=1)):(ve.x+=1,le+1===P.length-1&&(P[0].x+=1)),W=!0)}const ee=a.am(F.center.lng);return W&&ee<Math.abs(ee-1)&&P.forEach(ae=>{ae.x-=1}),{polygon:P,unwrapped:W}}(lr(u,m).map(P=>new a.P(gr(P.x),P.y)),m);return{polygon:I.polygon.map(P=>new a.a5(P.x,P.y)),unwrapped:I.unwrapped}}}function lr(b,u){return a.ao(b,m=>{const w=u.pointCoordinate3D(m);m.x=w.x,m.y=w.y},1/256)}function gr(b){return b<0?1+b%1:b%1}function dr(b){return 100*b|0}function fi(b,u,m,w,I){const P=function(W,q){if(W)return I(W);if(q){if(b.url&&q.tiles&&b.tiles&&delete b.tiles,q.variants){if(!Array.isArray(q.variants))return I(new Error("variants must be an array"));for(const ee of q.variants){if(ee==null||typeof ee!="object"||ee.constructor!==Object)return I(new Error("variant must be an object"));if(!Array.isArray(ee.capabilities))return I(new Error("capabilities must be an array"));if(ee.capabilities.length===1&&ee.capabilities[0]==="meshopt"){q=a.l(q,ee);break}}}const J=a.ar(a.l(q,b),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);q.vector_layers&&(J.vectorLayers=q.vector_layers,J.vectorLayerIds=J.vectorLayers.map(ee=>ee.id)),q.raster_layers&&(J.rasterLayers=q.raster_layers,J.rasterLayerIds=J.rasterLayers.map(ee=>ee.id)),J.tiles=u.canonicalizeTileset(J,b.url),I(null,J)}},F=function(W,q,J){if(!W)return null;if(!q&&!J)return W;J=J||W.worldview_default;const ee=Object.values(W.language||{});if(ee.length===0)return null;const ae=Object.values(W.worldview||{});if(ae.length===0)return null;const le=ee.every(ve=>ve===q),ue=ae.every(ve=>ve===J);return le&&ue?W:q in(W.language_options||{})||J in(W.worldview_options||{})?null:W.language_options&&W.worldview_options?W:null}(b.data,m,w);return F?a.q.frame(()=>P(null,F)):b.url?a.n(u.transformRequest(u.normalizeSourceURL(b.url,null,m,w),a.R.Source),P):a.q.frame(()=>{const{data:W,...q}=b;P(null,q)})}class Oi{constructor(u,m,w){this.bounds=a.as.convert(this.validateBounds(u)),this.minzoom=m||0,this.maxzoom=w||24}validateBounds(u){return Array.isArray(u)&&u.length===4?[Math.max(-180,u[0]),Math.max(-90,u[1]),Math.min(180,u[2]),Math.min(90,u[3])]:[-180,-90,180,90]}contains(u){const m=Math.pow(2,u.z),w=Math.floor(a.am(this.bounds.getWest())*m),I=Math.floor(a.at(this.bounds.getNorth())*m),P=Math.ceil(a.am(this.bounds.getEast())*m),F=Math.ceil(a.at(this.bounds.getSouth())*m);return u.x>=w&&u.x<P&&u.y>=I&&u.y<F}}class ji extends a.E{constructor(u,m,w,I){if(super(),this.id=u,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.l(this,a.ar(m,["url","scheme","tileSize","promoteId"])),this._options=a.l({type:"vector"},m),this._collectResourceTiming=!!m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(I),this._tileWorkers={},this._deduped=new a.au}load(u){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,w=this.map._worldview;this._tileJSONRequest=fi(this._options,this.map._requestManager,m,w,(I,P)=>{this._tileJSONRequest=null,this._loaded=!0,I?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),w&&w.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${w}`),this.fire(new a.t(I))):P&&(a.l(this,P),P.bounds&&(this.tileBounds=new Oi(P.bounds,this.minzoom,this.maxzoom)),Vt(P.tiles,this.map._requestManager._customAccessToken),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),u&&u(I)})}loaded(){return this._loaded}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest();const u=a.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(u))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(u){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}loadTile(u,m){const w=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme)),I=this.map._requestManager.transformRequest(w,a.R.Tile),P=this.map.style?this.map.style.getLut(this.scope):null,F={request:I,data:void 0,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,lut:P?{image:P.image.clone()}:null,tileSize:this.tileSize*u.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:u.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:u.isExtraShadowCaster,tessellationStep:this.map._tessellationStep};if(F.request.collectResourceTiming=this._collectResourceTiming,u.actor&&u.state!=="expired")u.state==="loading"?u.reloadCallback=m:u.request=u.actor.send("reloadTile",F,W.bind(this));else if(u.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)u.request=u.actor.send("loadTile",F,W.bind(this),void 0,!0);else{const q=a.aw.call({deduped:this._deduped},F,(J,ee)=>{J||!ee?W.call(this,J):(F.data={cacheControl:ee.cacheControl,expires:ee.expires,rawData:ee.rawData.slice(0)},u.actor&&u.actor.send("loadTile",F,W.bind(this),void 0,!0))},!0);u.request={cancel:q}}function W(q,J){return delete u.request,u.aborted?m(null):q&&q.status!==404?m(q):(J&&J.resourceTiming&&(u.resourceTiming=J.resourceTiming),this.map._refreshExpiredTiles&&J&&u.setExpiryData(J),u.loadVectorData(J,this.map.painter),a.ax(this.dispatcher),m(null),void(u.reloadCallback&&(this.loadTile(u,u.reloadCallback),u.reloadCallback=null)))}}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.actor&&u.actor.send("abortTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(u,m){u.actor&&u.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id,scope:this.scope}),u.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class As extends a.E{constructor(u,m,w,I){super(),this.id=u,this.dispatcher=w,this.setEventedParent(I),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.l({type:"raster"},m),a.l(this,a.ar(m,["url","scheme","tileSize"]))}load(u){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"})),this._tileJSONRequest=fi(this._options,this.map._requestManager,null,null,(m,w)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new a.t(m)):w&&(a.l(this,w),w.bounds&&(this.tileBounds=new Oi(w.bounds,this.minzoom,this.maxzoom)),Vt(w.tiles),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),u&&u(m)})}loaded(){return this._loaded}onAdd(u){this.map=u,this.load()}reload(){this.cancelTileJSONRequest();const u=a.av(this.id,this.scope);this.load(()=>this.map.style.clearSource(u))}setTiles(u){return this._options.tiles=u,this.reload(),this}setUrl(u){return this.url=u,this._options.url=u,this.reload(),this}onRemove(u){this.cancelTileJSONRequest()}serialize(){return a.l({},this._options)}hasTile(u){return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,m){const w=a.q.devicePixelRatio>=2,I=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),w,this.tileSize);u.request=a.o(this.map._requestManager.transformRequest(I,a.R.Tile),(P,F,W,q)=>(delete u.request,u.aborted?(u.state="unloaded",m(null)):P?(u.state="errored",m(P)):F?(this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:W,expires:q}),u.setTexture(F,this.map.painter),u.state="loaded",a.ax(this.dispatcher),void m(null)):m(null)))}abortTile(u,m){u.request&&(u.request.cancel(),delete u.request),m&&m()}unloadTile(u,m){u.texture&&u.texture instanceof a.T?(u.destroy(!0),u.texture&&u.texture instanceof a.T&&this.map.painter.saveTileTexture(u.texture)):u.destroy(),m&&m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Cr extends As{constructor(u,m,w,I){super(u,m,w,I),this.type="raster-array",this.maxzoom=22,this._options=a.l({type:"raster-array"},m)}triggerRepaint(u){const m=this.map.painter._terrain,w=this.map.style.getSourceCache(this.id);m&&m.enabled&&w&&m._clearRenderCacheForTile(w.id,u.tileID),this.map.triggerRepaint()}loadTile(u,m){const w=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),I=this.map._requestManager.transformRequest(w,a.R.Tile);u.requestParams=I,u.actor||(u.actor=this.dispatcher.getActor()),u.request=u.fetchHeader(void 0,(P,F,W,q)=>{if(delete u.request,u.aborted)return u.state="unloaded",m(null);if(P)return P.code===20?void 0:(u.state="errored",m(P));this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:W,expires:q}),u.state="empty",m(null)})}unloadTile(u,m){const w=u.texture;w&&w instanceof a.T?(u.destroy(!0),this.map.painter.saveTileTexture(w)):(u.destroy(),u.flushQueues(),u._isHeaderLoaded=!1,delete u._mrt,delete u.textureDescriptor),u.fbo&&(u.fbo.destroy(),delete u.fbo),delete u.request,delete u.requestParams,delete u.neighboringTiles,u.state="unloaded"}prepareTile(u,m,w){u._isHeaderLoaded&&(u.state!=="empty"&&(u.state="reloading"),u.fetchBand(m,w,(I,P)=>{if(I)return u.state="errored",this.fire(new a.t(I)),void this.triggerRepaint(u);P&&(u.setTexture(P,this.map.painter),u.state="loaded",this.triggerRepaint(u))}))}getInitialBand(u){if(!this.rasterLayers)return 0;const m=this.rasterLayers.find(({id:P})=>P===u),w=m&&m.fields,I=w&&w.bands&&w.bands;return I?I[0]:0}getTextureDescriptor(u,m,w){if(!u)return;const I=m.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!I)return;let P=null;m instanceof a.aB?P=m.paint.get("raster-array-band"):m instanceof a.aC&&(P=m.paint.get("raster-particle-array-band"));const F=P||this.getInitialBand(I);if(F!=null)if(u.textureDescriptor){if(!u.updateNeeded(I,F)||w)return Object.assign({},u.textureDescriptor,{texture:u.texture})}else this.prepareTile(u,I,F)}}const Qn={vector:ji,raster:As,"raster-dem":class extends As{constructor(b,u,m,w){super(b,u,m,w),this.type="raster-dem",this.maxzoom=22,this._options=a.l({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox"}loadTile(b,u){const m=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function w(I,P){I&&(b.state="errored",u(I)),P&&(b.dem=P,b.dem.onDeserialize(),b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0,b.state="loaded",u(null))}b.request=a.o(this.map._requestManager.transformRequest(m,a.R.Tile),(function(I,P,F,W){if(delete b.request,b.aborted)b.state="unloaded",u(null);else if(I)b.state="errored",u(I);else if(P){this.map._refreshExpiredTiles&&b.setExpiryData({cacheControl:F,expires:W});const q=ImageBitmap&&P instanceof ImageBitmap&&a.ay(),J=1-(P.width-a.az(P.width))/2;J<1||b.neighboringTiles||(b.neighboringTiles=this._getNeighboringTiles(b.tileID));const ee=q?P:a.q.getImageData(P,J),ae={uid:b.uid,coord:b.tileID,source:this.id,scope:this.scope,rawImageData:ee,encoding:this.encoding,padding:J};b.actor&&b.state!=="expired"||(b.actor=this.dispatcher.getActor(),b.actor.send("loadDEMTile",ae,w.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(b){const u=b.canonical,m=Math.pow(2,u.z),w=(u.x-1+m)%m,I=u.x===0?b.wrap-1:b.wrap,P=(u.x+1+m)%m,F=u.x+1===m?b.wrap+1:b.wrap,W={};return W[new a.aA(b.overscaledZ,I,u.z,w,u.y).key]={backfilled:!1},W[new a.aA(b.overscaledZ,F,u.z,P,u.y).key]={backfilled:!1},u.y>0&&(W[new a.aA(b.overscaledZ,I,u.z,w,u.y-1).key]={backfilled:!1},W[new a.aA(b.overscaledZ,b.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},W[new a.aA(b.overscaledZ,F,u.z,P,u.y-1).key]={backfilled:!1}),u.y+1<m&&(W[new a.aA(b.overscaledZ,I,u.z,w,u.y+1).key]={backfilled:!1},W[new a.aA(b.overscaledZ,b.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},W[new a.aA(b.overscaledZ,F,u.z,P,u.y+1).key]={backfilled:!1}),W}},"raster-array":Cr,geojson:class extends a.E{constructor(b,u,m,w){super(),this.id=b,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(w),this._data=u.data,this._options=a.l({},u),this._collectResourceTiming=u.collectResourceTiming,u.maxzoom!==void 0&&(this.maxzoom=u.maxzoom),u.minzoom!==void 0&&(this.minzoom=u.minzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId;const I=a.ab/this.tileSize;this.workerOptions=a.l({source:this.id,scope:this.scope,cluster:u.cluster||!1,geojsonVtOptions:{buffer:(u.buffer!==void 0?u.buffer:128)*I,tolerance:(u.tolerance!==void 0?u.tolerance:.375)*I,extent:a.ab,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:u.clusterMaxZoom!==void 0?u.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,u.clusterMinPoints||2),extent:a.ab,radius:(u.clusterRadius!==void 0?u.clusterRadius:50)*I,log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter,dynamic:u.dynamic},u.workerOptions)}onAdd(b){this.map=b,this.setData(this._data)}setData(b){return this._data=b,this._updateWorkerData(),this}updateData(b){if(!this._options.dynamic)return this.fire(new a.t(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof b!="string"&&(b.type==="Feature"&&(b={type:"FeatureCollection",features:[b]}),b.type!=="FeatureCollection"))return this.fire(new a.t(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof b!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const u=new Map;for(const m of this._data.features)u.set(m.id,m);for(const m of b.features)u.set(m.id,m);this._data.features=[...u.values()]}else this._data=b;return this._updateWorkerData(!0),this}getClusterExpansionZoom(b,u){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:b,source:this.id,scope:this.scope},u),this}getClusterChildren(b,u){return this.actor.send("geojson.getClusterChildren",{clusterId:b,source:this.id,scope:this.scope},u),this}getClusterLeaves(b,u,m,w){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:b,limit:u,offset:m},w),this}_updateWorkerData(b=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.x("dataloading",{dataType:"source"})),this._loaded=!1;const u=a.l({append:b},this.workerOptions);u.scope=this.scope;const m=this._data;typeof m=="string"?(u.request=this.map._requestManager.transformRequest(a.q.resolveURL(m),a.R.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(m),this._pendingLoad=this.actor.send(`${this.type}.loadData`,u,(w,I)=>{if(this._loaded=!0,this._pendingLoad=null,w)this.fire(new a.t(w));else{const P={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&I&&I.resourceTiming&&I.resourceTiming[this.id]&&(P.resourceTiming=I.resourceTiming[this.id]),b&&(this._partialReload=!0),this.fire(new a.x("data",P)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(b),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(b,u){const m=b.actor?"reloadTile":"loadTile";b.actor=this.actor;const w=this.map.style?this.map.style.getLut(this.scope):null,I=this._partialReload,P={type:this.type,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:w?{image:w.image.clone()}:null,scope:this.scope,pixelRatio:a.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,partial:I};b.request=this.actor.send(m,P,(F,W)=>I&&!W?(b.state="loaded",u(null)):(delete b.request,b.destroy(),b.aborted?u(null):F?u(F):(b.loadVectorData(W,this.map.painter,m==="reloadTile"),u(null))),void 0,m==="loadTile")}abortTile(b){b.request&&(b.request.cancel(),delete b.request),b.aborted=!0}unloadTile(b,u){this.actor.send("removeTile",{uid:b.uid,type:this.type,source:this.id,scope:this.scope}),b.destroy()}onRemove(b){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends a.aD{constructor(b,u,m,w){super(b,u,m,w),this.roundZoom=!0,this.type="video",this.options=u}load(){this._loaded=!1;const b=this.options;this.urls=[];for(const u of b.urls)this.urls.push(this.map._requestManager.transformRequest(u,a.R.Source).url);a.aE(this.urls,(u,m)=>{this._loaded=!0,u?this.fire(new a.t(u)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(b){if(this.video){const u=this.video.seekable;b<u.start(0)||b>u.end(0)?this.fire(new a.t(new a.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=b}}getVideo(){return this.video}onAdd(b){this.map||(this.map=b,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const b=this.map.painter.context,u=b.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new a.T(b,this.video,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(b)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:a.aD,model:class extends a.E{constructor(b,u,m,w){super(),this.id=b,this.type="model",this.models=[],this._loaded=!1,this._options=u}load(){const b=[];for(const u in this._options.models){const m=this._options.models[u],w=a.aG(this.map._requestManager.transformRequest(m.uri,a.R.Model).url).then(I=>{if(!I)return;const P=a.aH(I),F=new a.aI(u,m.position,m.orientation,P);F.computeBoundsAndApplyParent(),this.models.push(F)}).catch(I=>{this.fire(new a.t(new Error(`Could not load model ${u} from ${m.uri}: ${I.message}`)))});b.push(w)}return Promise.allSettled(b).then(()=>{this._loaded=!0,this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(u=>{this.fire(new a.t(new Error(`Could not load models: ${u.message}`)))})}onAdd(b){this.map=b,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(b,u){}serialize(){return{type:"model"}}},"batched-model":class extends a.E{constructor(b,u,m,w){super(),this.type="batched-model",this.id=b,this.tileSize=512,this._options=u,this.tiles=this._options.tiles,this.maxzoom=u.maxzoom||19,this.minzoom=u.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=m,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(w)}onAdd(b){this.map=b,this.load()}load(b){this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"}));const u=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=fi(this._options,this.map._requestManager,u,m,(w,I)=>{this._tileJSONRequest=null,this._loaded=!0,w?(u&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${u}`),m&&m.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new a.t(w))):I&&(a.l(this,I),I.bounds&&(this.tileBounds=new Oi(I.bounds,this.minzoom,this.maxzoom)),Vt(I.tiles,this.map._requestManager._customAccessToken),this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))),b&&b(w)})}hasTransition(){return!1}hasTile(b){return!this.tileBounds||this.tileBounds.contains(b.canonical)}loaded(){return this._loaded}loadTile(b,u){const m=this.map._requestManager.normalizeTileURL(b.tileID.canonical.url(this.tiles,this.scheme)),w={request:this.map._requestManager.transformRequest(m,a.R.Tile),data:void 0,uid:b.uid,tileID:b.tileID,tileZoom:b.tileZoom,zoom:b.tileID.overscaledZ,tileSize:this.tileSize*b.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:b.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(b.actor&&b.state!=="expired")if(b.state==="loading")b.reloadCallback=u;else{if(b.buckets){const P=Object.values(b.buckets);for(const F of P)F.dirty=!0;return void(b.state="loaded")}b.request=b.actor.send("reloadTile",w,I.bind(this))}else b.actor=this.dispatcher.getActor(),b.request=b.actor.send("loadTile",w,I.bind(this),void 0,!0);function I(P,F){return b.aborted?u(null):P&&P.status!==404?u(P):(F&&(F.resourceTiming&&(b.resourceTiming=F.resourceTiming),this.map._refreshExpiredTiles&&b.setExpiryData(F),b.buckets={...b.buckets,...F.buckets},F.featureIndex&&(b.latestFeatureIndex=F.featureIndex)),b.state="loaded",void u(null))}}serialize(){return a.l({},this._options)}},canvas:class extends a.aD{constructor(b,u,m,w){super(b,u,m,w),u.coordinates?Array.isArray(u.coordinates)&&u.coordinates.length===4&&!u.coordinates.some(I=>!Array.isArray(I)||I.length!==2||I.some(P=>typeof P!="number"))||this.fire(new a.t(new a.V(`sources.${b}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.t(new a.V(`sources.${b}`,null,'missing required property "coordinates"'))),u.animate&&typeof u.animate!="boolean"&&this.fire(new a.t(new a.V(`sources.${b}`,null,'optional "animate" property must be a boolean value'))),u.canvas?typeof u.canvas=="string"||u.canvas instanceof HTMLCanvasElement||this.fire(new a.t(new a.V(`sources.${b}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.t(new a.V(`sources.${b}`,null,'missing required property "canvas"'))),this.options=u,this.animate=u.animate===void 0||u.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.t(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(b){this.map=b,this.load(),this.canvas&&this.animate&&this.play()}onRemove(b){this.pause()}prepare(){let b=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,b=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,b=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const u=this.map.painter.context;this.texture?!b&&!this._playing||this.texture instanceof a.aF||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.T(u,this.canvas,u.gl.RGBA8,{premultiply:!0}),this._prepareData(u)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const b of[this.canvas.width,this.canvas.height])if(isNaN(b)||b<=0)return!0;return!1}},custom:class extends a.E{constructor(b,u,m,w){super(),this.id=b,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=u,this.setEventedParent(w),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.t(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.t(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Oi(this._implementation.bounds,this.minzoom,this.maxzoom)),u.update=this._update.bind(this),u.clearTiles=this._clearTiles.bind(this),u.coveringTiles=this._coveringTiles.bind(this),a.l(this,a.ar(u,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.ar(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.x("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(b){this.map=b,this._loaded=!1,this.fire(new a.x("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(b),this.load()}onRemove(b){this._implementation.onRemove&&this._implementation.onRemove(b)}hasTile(b){if(this._implementation.hasTile){const{x:u,y:m,z:w}=b.canonical;return this._implementation.hasTile({x:u,y:m,z:w})}return!this.tileBounds||this.tileBounds.contains(b.canonical)}loadTile(b,u){const{x:m,y:w,z:I}=b.tileID.canonical,P=new AbortController;b.request=Promise.resolve(this._implementation.loadTile({x:m,y:w,z:I},{signal:P.signal})).then((function(F){return delete b.request,b.aborted?(b.state="unloaded",u(null)):F===void 0?(b.state="errored",u(null)):F===null?(this.loadTileData(b,{width:this.tileSize,height:this.tileSize,data:null}),b.state="loaded",u(null)):function(W){return W instanceof ImageData||W instanceof HTMLCanvasElement||W instanceof ImageBitmap||W instanceof HTMLImageElement}(F)?(this.loadTileData(b,F),b.state="loaded",void u(null)):(b.state="errored",u(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(F=>{F.code!==20&&(b.state="errored",u(F))}),b.request.cancel=()=>P.abort()}loadTileData(b,u){b.setTexture(u,this.map.painter)}unloadTile(b,u){if(b.texture&&b.texture instanceof a.T?(b.destroy(!0),b.texture&&b.texture instanceof a.T&&this.map.painter.saveTileTexture(b.texture)):b.destroy(),this._implementation.unloadTile){const{x:m,y:w,z:I}=b.tileID.canonical;this._implementation.unloadTile({x:m,y:w,z:I})}u&&u()}abortTile(b,u){b.request&&b.request.cancel&&(b.request.cancel(),delete b.request),u&&u()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(b=>({x:b.canonical.x,y:b.canonical.y,z:b.canonical.z}))}_clearTiles(){const b=a.av(this.id,this.scope);this.map.style.clearSource(b)}_update(){this.fire(new a.x("data",{dataType:"source",sourceDataType:"content"}))}}},Yi=function(b,u,m,w){const I=new Qn[u.type](b,u,m,w);if(I.id!==b)throw new Error(`Expected Source id to be ${b} instead of ${I.id}`);return a.aJ(["load","abort","unload","serialize","prepare"],I),I};function qr(b,u){const m=a.a6.mat4.identity([]);return a.a6.mat4.scale(m,m,[.5*b.width,.5*-b.height,1]),a.a6.mat4.translate(m,m,[1,-1,0]),a.a6.mat4.multiply(m,m,b.calculateProjMatrix(u.toUnwrapped())),Float32Array.from(m)}function ys(b,u,m,w,I,P,F,W=!1){const q=b.tilesIn(w,F,W);q.sort(Ds);const J=[];for(const ae of q)J.push({wrappedTileID:ae.tile.tileID.wrapped().key,queryResults:ae.tile.queryRenderedFeatures(u,m,b._state,ae,I,P,qr(b.transform,ae.tile.tileID),W)});const ee=function(ae){const le={},ue={};for(const ve of ae){const ye=ve.queryResults,be=ve.wrappedTileID,we=ue[be]=ue[be]||{};for(const ke in ye){const Ne=ye[ke],De=we[ke]=we[ke]||{},$e=le[ke]=le[ke]||[];for(const je of Ne)De[je.featureIndex]||(De[je.featureIndex]=!0,$e.push(je))}}return le}(J);for(const ae in ee)ee[ae].forEach(le=>{const ue=le.feature,ve=ue.layer;ve&&ve.type!=="background"&&ve.type!=="sky"&&ve.type!=="slot"&&(ue.source=ve.source,ve["source-layer"]&&(ue.sourceLayer=ve["source-layer"]),ue.state=ue.id!==void 0?b.getFeatureState(ve["source-layer"],ue.id):{})});return ee}function $a(b,u){const m=b.getRenderableIds().map(P=>b.getTileByID(P)),w=[],I={};for(let P=0;P<m.length;P++){const F=m[P],W=F.tileID.canonical.key;I[W]||(I[W]=!0,F.querySourceFeatures(w,u))}return w}function Ds(b,u){const m=b.tileID,w=u.tileID;return m.overscaledZ-w.overscaledZ||m.canonical.y-w.canonical.y||m.wrap-w.wrap||m.canonical.x-w.canonical.x}const fs=32,Li=33,oa=new Uint16Array(8184);for(let b=0;b<2046;b++){let u=b+2,m=0,w=0,I=0,P=0,F=0,W=0;for(1&u?I=P=F=fs:m=w=W=fs;(u>>=1)>1;){const J=m+I>>1,ee=w+P>>1;1&u?(I=m,P=w,m=F,w=W):(m=I,w=P,I=F,P=W),F=J,W=ee}const q=4*b;oa[q+0]=m,oa[q+1]=w,oa[q+2]=I,oa[q+3]=P}const Pa=new Uint16Array(2178),Ts=new Uint8Array(1089),Oc=new Uint16Array(1089);function Po(b){return b===0?-.03125:b===32?.03125:0}const ud={type:2,extent:a.ab,loadGeometry:()=>[[new a.P(0,0),new a.P(a.ab+1,0),new a.P(a.ab+1,a.ab+1),new a.P(0,a.ab+1),new a.P(0,0)]]};class Fc{constructor(u,m,w,I,P){this.tileID=u,this.uid=a.aP(),this.uses=0,this.tileSize=m,this.tileZoom=w,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=P,I&&I.style&&(this._lastUpdatedBrightness=I.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",I&&I.transform&&(this.projection=I.transform.projection)}registerFadeDuration(u){const m=u+this.timeAdded;m<a.q.now()||this.fadeEndTime&&m<this.fadeEndTime||(this.fadeEndTime=m)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=a.aK(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(u,m,w){if(this.unloadVectorData(),this.state="loaded",u){u.featureIndex&&(this.latestFeatureIndex=u.featureIndex,u.rawTileData?(this.latestRawTileData=u.rawTileData,this.latestFeatureIndex.rawTileData=u.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=u.collisionBoxArray,this.buckets=function(I,P){const F={};if(!P)return F;for(const W of I){const q=W.layerIds.map(J=>P.getLayer(J)).filter(Boolean);if(q.length!==0){W.layers=q,W.stateDependentLayerIds&&(W.stateDependentLayers=W.stateDependentLayerIds.map(J=>q.filter(ee=>ee.id===J)[0]));for(const J of q)F[J.fqid]=W}}return F}(u.buckets,m.style),this.hasSymbolBuckets=!1;for(const I in this.buckets){const P=this.buckets[I];if(P instanceof a.aR){if(this.hasSymbolBuckets=!0,!w)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const I in this.buckets){const P=this.buckets[I];if(P instanceof a.aR&&P.hasRTLText){this.hasRTLText=!0,a.aS();break}}this.queryPadding=0;for(const I in this.buckets){const P=this.buckets[I],F=m.style.getOwnLayer(I);if(!F)continue;const W=F.queryRadius(P);this.queryPadding=Math.max(this.queryPadding,W)}u.imageAtlas&&(this.imageAtlas=u.imageAtlas),u.glyphAtlasImage&&(this.glyphAtlasImage=u.glyphAtlasImage),u.lineAtlas&&(this.lineAtlas=u.lineAtlas),this._lastUpdatedBrightness=u.brightness}else this.collisionBoxArray=new a.aQ}unloadVectorData(){if(this.hasData()){for(const u in this.buckets)this.buckets[u].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(u){return this.buckets[u.fqid]}upload(u){for(const I in this.buckets){const P=this.buckets[I];P.uploadPending()&&P.upload(u)}const m=u.gl,w=this.imageAtlas;if(w&&!w.uploaded){const I=!!Object.keys(w.patternPositions).length;this.imageAtlasTexture=new a.T(u,w.image,m.RGBA8,{useMipmap:I}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new a.T(u,this.glyphAtlasImage,m.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new a.T(u,this.lineAtlas.image,m.R8),this.lineAtlas.uploaded=!0)}prepare(u,m,w){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(u,this.imageAtlasTexture,w),!m||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const I=m.style.getBrightness();(this._lastUpdatedBrightness||I)&&(this._lastUpdatedBrightness&&I&&Math.abs(this._lastUpdatedBrightness-I)<.001||(this._lastUpdatedBrightness=I,this.updateBuckets(m)))}queryRenderedFeatures(u,m,w,I,P,F,W,q){return this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)?this.latestFeatureIndex.query({tileResult:I,pixelPosMatrix:W,transform:F,params:P,tileTransform:this.tileTransform},u,m,w):{}}querySourceFeatures(u,m){const w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;const I=w.loadVTLayers(),P=m?m.sourceLayer:"",F=I._geojsonTileLayer||I[P];if(!F)return;const W=a.aT(m&&m.filter),{z:q,x:J,y:ee}=this.tileID.canonical,ae={z:q,x:J,y:ee};for(let le=0;le<F.length;le++){const ue=F.feature(le);if(W.needGeometry){const be=a.aU(ue,!0);if(!W.filter(new a.a3(this.tileID.overscaledZ),be,this.tileID.canonical))continue}else if(!W.filter(new a.a3(this.tileID.overscaledZ),ue))continue;const ve=w.getId(ue,P),ye=new a.aV(ue,q,J,ee,ve);ye.tile=ae,u.push(ye)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(u){const m=this.expirationTime;if(u.cacheControl){const w=a.aW(u.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else u.expires&&(this.expirationTime=new Date(u.expires).getTime());if(this.expirationTime){const w=Date.now();let I=!1;if(this.expirationTime>w)I=!1;else if(m)if(this.expirationTime<m)I=!0;else{const P=this.expirationTime-m;P?this.expirationTime=w+Math.max(P,3e4):I=!0}else I=!0;I?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(u,m){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(u).length!==0&&m&&this.updateBuckets(m)}updateBuckets(u){if(!this.latestFeatureIndex)return;const m=this.latestFeatureIndex.loadVTLayers(),w=u.style.listImages(),I=u.style.getBrightness();for(const P in this.buckets){if(!u.style.hasLayer(P))continue;const F=this.buckets[P],W=F.layers[0].sourceLayer||"_geojsonTileLayer",q=m[W],J=u.style.getOwnSourceCache(F.layers[0].source);let ee={};J&&(ee=J._state.getState(W,void 0)),F.update(ee,q,w,this.imageAtlas&&this.imageAtlas.patternPositions||{},I),(F instanceof a.aX||F instanceof a.aY)&&u._terrain&&u._terrain.enabled&&J&&F.programConfigurations.needsUpload&&u._terrain._clearRenderCacheForTile(J.id,this.tileID);const ae=u&&u.style&&u.style.getOwnLayer(P);ae&&(this.queryPadding=Math.max(this.queryPadding,ae.queryRadius(F)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(u){this.symbolFadeHoldUntil=a.q.now()+u}setTexture(u,m){const w=m.context,I=w.gl;this.texture=this.texture||m.getTileTexture(u.width),this.texture&&this.texture instanceof a.T?this.texture.update(u):(this.texture=new a.T(w,u,I.RGBA8,{useMipmap:!0}),this.texture.bind(I.LINEAR,I.CLAMP_TO_EDGE))}setDependencies(u,m){const w={};for(const I of m)w[I]=!0;this.dependencies[u]=w}hasDependency(u,m){for(const w of u){const I=this.dependencies[w];if(I){for(const P of m)if(I[P])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(u,m){if(!m||m.name==="mercator"||this._tileDebugBuffer)return;const w=a.aZ(ud,this.tileID.canonical,this.tileTransform)[0],I=new a.a_,P=new a.a$;for(let F=0;F<w.length;F++){const{x:W,y:q}=w[F];I.emplaceBack(W,q),P.emplaceBack(F)}P.emplaceBack(0),this._tileDebugIndexBuffer=u.createIndexBuffer(P),this._tileDebugBuffer=u.createVertexBuffer(I,a.b0.members),this._tileDebugSegments=a.b1.simpleSegment(0,0,I.length,P.length)}_makeTileBoundsBuffers(u,m){if(this._tileBoundsBuffer||!m||m.name==="mercator")return;const w=a.aZ(ud,this.tileID.canonical,this.tileTransform)[0];let I,P;if(this.isRaster){const F=function(W,q){const J=a.aK(W,q),ee=Math.pow(2,W.z);for(let be=0;be<Li;be++)for(let we=0;we<Li;we++){const ke=a.aL((W.x+(we+Po(we))/fs)/ee),Ne=a.aM((W.y+(be+Po(be))/fs)/ee),De=q.project(ke,Ne),$e=be*Li+we;Pa[2*$e+0]=Math.round((De.x*J.scale-J.x)*a.ab),Pa[2*$e+1]=Math.round((De.y*J.scale-J.y)*a.ab)}Ts.fill(0),Oc.fill(0);for(let be=2045;be>=0;be--){const we=4*be,ke=oa[we+0],Ne=oa[we+1],De=oa[we+2],$e=oa[we+3],je=ke+De>>1,et=Ne+$e>>1,Ke=je+et-Ne,tt=et+ke-je,ut=Ne*Li+ke,at=$e*Li+De,rt=et*Li+je,bt=Math.hypot((Pa[2*ut+0]+Pa[2*at+0])/2-Pa[2*rt+0],(Pa[2*ut+1]+Pa[2*at+1])/2-Pa[2*rt+1])>=16;Ts[rt]=Ts[rt]||(bt?1:0),be<1022&&(Ts[rt]=Ts[rt]||Ts[(Ne+tt>>1)*Li+(ke+Ke>>1)]||Ts[($e+tt>>1)*Li+(De+Ke>>1)])}const ae=new a.aN,le=new a.aO;let ue=0;function ve(be,we){const ke=we*Li+be;return Oc[ke]===0&&(ae.emplaceBack(Pa[2*ke+0],Pa[2*ke+1],be*a.ab/fs,we*a.ab/fs),Oc[ke]=++ue),Oc[ke]-1}function ye(be,we,ke,Ne,De,$e){const je=be+ke>>1,et=we+Ne>>1;if(Math.abs(be-De)+Math.abs(we-$e)>1&&Ts[et*Li+je])ye(De,$e,be,we,je,et),ye(ke,Ne,De,$e,je,et);else{const Ke=ve(be,we),tt=ve(ke,Ne),ut=ve(De,$e);le.emplaceBack(Ke,tt,ut)}}return ye(0,0,fs,fs,fs,0),ye(fs,fs,0,0,0,fs),{vertices:ae,indices:le}}(this.tileID.canonical,m);I=F.vertices,P=F.indices}else{I=new a.aN,P=new a.aO;for(const{x:W,y:q}of w)I.emplaceBack(W,q,0,0);const F=a.b2(I.int16,void 0,4);for(let W=0;W<F.length;W+=3)P.emplaceBack(F[W],F[W+1],F[W+2])}this._tileBoundsBuffer=u.createVertexBuffer(I,a.b3.members),this._tileBoundsIndexBuffer=u.createIndexBuffer(P),this._tileBoundsSegments=a.b1.simpleSegment(0,0,I.length,P.length)}_makeGlobeTileDebugBuffers(u,m){const w=m.projection;if(!w||w.name!=="globe"||m.freezeTileCoverage)return;const I=this.tileID.canonical,P=a.b4(I,m),F=a.b5(P),W=a.a9(m.zoom);let q;W>0&&(q=a.a6.mat4.invert(new Float64Array(16),m.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(u,I,m,F,q,W),this._makeGlobeTileDebugTextBuffer(u,I,m,F,q,W)}_globePoint(u,m,w,I,P,F,W){let q=a.b6(u,m,w);if(F){const J=1<<w.z,ee=a.am(I.center.lng),ae=a.at(I.center.lat),le=(w.x+.5)/J-ee;let ue=0;le>.5?ue=-1:le<-.5&&(ue=1);let ve=(u/a.ab+w.x)/J+ue,ye=(m/a.ab+w.y)/J;ve=(ve-ee)*I._pixelsPerMercatorPixel+ee,ye=(ye-ae)*I._pixelsPerMercatorPixel+ae;const be=[ve*I.worldSize,ye*I.worldSize,0];a.a6.vec3.transformMat4(be,be,F),q=a.b7(q,be,W)}return a.a6.vec3.transformMat4(q,q,P)}_makeGlobeTileDebugBorderBuffer(u,m,w,I,P,F){const W=new a.a_,q=new a.a$,J=new a.b8,ee=(le,ue,ve,ye,be)=>{const we=(ve-le)/(be-1),ke=(ye-ue)/(be-1),Ne=W.length;for(let De=0;De<be;De++){const $e=le+De*we,je=ue+De*ke;W.emplaceBack($e,je);const et=this._globePoint($e,je,m,w,I,P,F);J.emplaceBack(et[0],et[1],et[2]),q.emplaceBack(Ne+De)}},ae=a.ab;ee(0,0,ae,0,16),ee(ae,0,ae,ae,16),ee(ae,ae,0,ae,16),ee(0,ae,0,0,16),this._tileDebugIndexBuffer=u.createIndexBuffer(q),this._tileDebugBuffer=u.createVertexBuffer(W,a.b0.members),this._globeTileDebugBorderBuffer=u.createVertexBuffer(J,a.b9.members),this._tileDebugSegments=a.b1.simpleSegment(0,0,W.length,q.length)}_makeGlobeTileDebugTextBuffer(u,m,w,I,P,F){const W=a.ab/4,q=new a.a_,J=new a.aO,ee=new a.b8,ae=25;J.reserve(32),q.reserve(ae),ee.reserve(ae);const le=(ue,ve)=>ae*ue+ve;for(let ue=0;ue<ae;ue++){const ve=ue*W;for(let ye=0;ye<ae;ye++){const be=ye*W;q.emplaceBack(be,ve);const we=this._globePoint(be,ve,m,w,I,P,F);ee.emplaceBack(we[0],we[1],we[2])}}for(let ue=0;ue<4;ue++)for(let ve=0;ve<4;ve++){const ye=le(ue,ve),be=le(ue,ve+1),we=le(ue+1,ve),ke=le(ue+1,ve+1);J.emplaceBack(ye,be,we),J.emplaceBack(we,be,ke)}this._tileDebugTextIndexBuffer=u.createIndexBuffer(J),this._tileDebugTextBuffer=u.createVertexBuffer(q,a.b0.members),this._globeTileDebugTextBuffer=u.createVertexBuffer(ee,a.b9.members),this._tileDebugTextSegments=a.b1.simpleSegment(0,0,ae,32)}destroy(u=!1){for(const m in this.buckets)this.buckets[m].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!u&&this.texture&&this.texture instanceof a.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}a.ba.setPbf(a.bb);class cg extends Fc{constructor(u,m,w,I,P){super(u,m,w,I,P),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(u,m){const w=m.context,I=w.gl;this.texture=this.texture||m.getTileTexture(u.width),this.texture&&this.texture instanceof a.T?this.texture.update(u,{premultiply:!1}):this.texture=new a.T(w,u,I.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(u=16384,m){const w=this._mrt=new a.ba(30),I=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(u-1)}});return this.entireBuffer=null,this.request=a.bc(I,(P,F,W,q)=>{if(P)m(P);else try{const J=w.getHeaderLength(F);if(J>u)return void(this.request=this.fetchHeader(J,m));w.parseHeader(F),this._isHeaderLoaded=!0;let ee=0;for(const ae of Object.values(w.layers))ee=Math.max(ee,ae.dataIndex[ae.dataIndex.length-1].last_byte);F.byteLength>=ee&&(this.entireBuffer=F),m(null,this.entireBuffer||F,W,q)}catch(J){m(J)}}),this.request}fetchBand(u,m,w){const I=this._mrt;if(!this._isHeaderLoaded||!I)return void w(new Error("Tile header is not ready"));const P=this.actor;if(!P)return void w(new Error("Can't fetch tile band without an actor"));let F;const W=(ae,le)=>{F.complete(ae,le),ae?w(ae):(this.updateTextureDescriptor(u,m),w(null,this.textureDescriptor&&this.textureDescriptor.img))},q=(ae,le)=>{if(ae)return w(ae);const ue=P.send("decodeRasterArray",{buffer:le,task:F},W,void 0,!0);this._workQueue.push(()=>{ue&&ue.cancel(),F.cancel()})},J=I.getLayer(u);if(!J)return void w(new Error(`Unknown sourceLayer "${u}"`));if(J.hasDataForBand(m))return this.updateTextureDescriptor(u,m),void w(null,this.textureDescriptor?this.textureDescriptor.img:null);const ee=J.getDataRange([m]);if(F=I.createDecodingTask(ee),!F||F.tasks.length)if(this.flushQueues(),this.entireBuffer)q(null,this.entireBuffer.slice(ee.firstByte,ee.lastByte+1));else{const ae=Object.assign({},this.requestParams,{headers:{Range:`bytes=${ee.firstByte}-${ee.lastByte}`}}),le=a.bc(ae,q);this._fetchQueue.push(()=>{le.cancel(),F.cancel()})}else w(null)}updateNeeded(u,m){return(!this.textureDescriptor||this.textureDescriptor.band!==m||this.textureDescriptor.layer!==u)&&this.state!=="errored"}updateTextureDescriptor(u,m){if(!this._mrt)return;const w=this._mrt.getLayer(u);if(!w||!w.hasBand(m)||!w.hasDataForBand(m))return;const{bytes:I,tileSize:P,buffer:F,offset:W,scale:q}=w.getBandView(m),J=P+2*F,ee={data:I,width:J,height:J},ae=this.texture;ae&&ae instanceof a.T&&ae.update(ee,{premultiply:!1}),this.textureDescriptor={layer:u,band:m,img:ee,buffer:F,offset:W,tileSize:P,format:w.pixelFormat,mix:[q,256*q,65536*q,16777216*q]}}}class Ep{constructor(u,m){this.max=u,this.onRemove=m,this.reset()}reset(){for(const u in this.data)for(const m of this.data[u])m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value);return this.data={},this.order=[],this}add(u,m,w){const I=u.wrapped().key;this.data[I]===void 0&&(this.data[I]=[]);const P={value:m,timeout:void 0};if(w!==void 0&&(P.timeout=setTimeout(()=>{this.remove(u,P)},w)),this.data[I].push(P),this.order.push(I),this.order.length>this.max){const F=this._getAndRemoveByKey(this.order[0]);F&&this.onRemove(F)}return this}has(u){return u.wrapped().key in this.data}getAndRemove(u){return this.has(u)?this._getAndRemoveByKey(u.wrapped().key):null}_getAndRemoveByKey(u){const m=this.data[u].shift();return m.timeout&&clearTimeout(m.timeout),this.data[u].length===0&&delete this.data[u],this.order.splice(this.order.indexOf(u),1),m.value}getByKey(u){const m=this.data[u];return m?m[0].value:null}get(u){return this.has(u)?this.data[u.wrapped().key][0].value:null}remove(u,m){if(!this.has(u))return this;const w=u.wrapped().key,I=m===void 0?0:this.data[w].indexOf(m),P=this.data[w][I];return this.data[w].splice(I,1),P.timeout&&clearTimeout(P.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(P.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(u){for(this.max=u;this.order.length>this.max;){const m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}filter(u){const m=[];for(const w in this.data)for(const I of this.data[w])u(I.value)||m.push(I);for(const w of m)this.remove(w.value.tileID,w)}}class ug{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(u,m,w){const I=String(m);if(this.stateChanges[u]=this.stateChanges[u]||{},this.stateChanges[u][I]=this.stateChanges[u][I]||{},a.l(this.stateChanges[u][I],w),this.deletedStates[u]===null){this.deletedStates[u]={};for(const P in this.state[u])P!==I&&(this.deletedStates[u][P]=null)}else if(this.deletedStates[u]&&this.deletedStates[u][I]===null){this.deletedStates[u][I]={};for(const P in this.state[u][I])w[P]||(this.deletedStates[u][I][P]=null)}else for(const P in w)this.deletedStates[u]&&this.deletedStates[u][I]&&this.deletedStates[u][I][P]===null&&delete this.deletedStates[u][I][P]}removeFeatureState(u,m,w){if(this.deletedStates[u]===null)return;const I=String(m);if(this.deletedStates[u]=this.deletedStates[u]||{},w&&m!==void 0)this.deletedStates[u][I]!==null&&(this.deletedStates[u][I]=this.deletedStates[u][I]||{},this.deletedStates[u][I][w]=null);else if(m!==void 0)if(this.stateChanges[u]&&this.stateChanges[u][I])for(w in this.deletedStates[u][I]={},this.stateChanges[u][I])this.deletedStates[u][I][w]=null;else this.deletedStates[u][I]=null;else this.deletedStates[u]=null}getState(u,m){const w=this.state[u]||{},I=this.stateChanges[u]||{},P=this.deletedStates[u];if(P===null)return{};if(m!==void 0){const W=String(m),q=a.l({},w[W],I[W]);if(P){const J=P[m];if(J===null)return{};for(const ee in J)delete q[ee]}return q}const F=a.l({},w,I);if(P)for(const W in P)delete F[W];return F}initializeTileState(u,m){u.setFeatureState(this.state,m)}coalesceChanges(u,m){const w={};for(const I in this.stateChanges){this.state[I]=this.state[I]||{};const P={};for(const F in this.stateChanges[I])this.state[I][F]||(this.state[I][F]={}),a.l(this.state[I][F],this.stateChanges[I][F]),P[F]=this.state[I][F];w[I]=P}for(const I in this.deletedStates){this.state[I]=this.state[I]||{};const P={};if(this.deletedStates[I]===null)for(const F in this.state[I])P[F]={},this.state[I][F]={};else for(const F in this.deletedStates[I]){if(this.deletedStates[I][F]===null)this.state[I][F]={};else if(this.state[I][F])for(const W of Object.keys(this.deletedStates[I][F]))delete this.state[I][F][W];P[F]=this.state[I][F]}w[I]=w[I]||{},a.l(w[I],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0)for(const I in u)u[I].setFeatureState(w,m)}}class Xa extends a.E{constructor(u,m,w){super(),this.id=u,this._onlySymbols=w,m.on("data",I=>{I.dataType==="source"&&I.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&I.dataType==="source"&&I.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),m.on("error",()=>{this._sourceErrored=!0}),this._source=m,this._tiles={},this._cache=new Ep(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new ug,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(u){this.map=u,this._minTileCacheSize=this._minTileCacheSize===void 0&&u?u._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&u?u._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const u in this._tiles){const m=this._tiles[u];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const u=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,u&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(u,m){return u.isSymbolTile=this._onlySymbols,u.isExtraShadowCaster=this._shadowCasterTiles[u.tileID.key],this._source.loadTile(u,m)}_unloadTile(u){if(this._source.unloadTile)return this._source.unloadTile(u)}_abortTile(u){if(this._source.abortTile)return this._source.abortTile(u)}serialize(){return this._source.serialize()}prepare(u){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const m in this._tiles){const w=this._tiles[m];w.upload(u),w.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return a.bd(this._tiles).map(u=>u.tileID).sort(Ql).map(u=>u.key)}getRenderableIds(u,m){const w=[];for(const I in this._tiles)this._isIdRenderable(+I,u,m)&&w.push(this._tiles[I]);return u?w.sort((I,P)=>{const F=I.tileID,W=P.tileID,q=new a.P(F.canonical.x,F.canonical.y)._rotate(this.transform.angle),J=new a.P(W.canonical.x,W.canonical.y)._rotate(this.transform.angle);return F.overscaledZ-W.overscaledZ||J.y-q.y||J.x-q.x}).map(I=>I.tileID.key):w.map(I=>I.tileID).sort(Ql).map(I=>I.key)}hasRenderableParent(u){const m=this.findLoadedParent(u,0);return!!m&&this._isIdRenderable(m.tileID.key)}_isIdRenderable(u,m,w){return this._tiles[u]&&this._tiles[u].hasData()&&!this._coveredTiles[u]&&(m||!this._tiles[u].holdingForFade())&&(w||!this._shadowCasterTiles[u])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)this._tiles[u].state!=="errored"&&this._reloadTile(+u,"reloading")}}_reloadTile(u,m){const w=this._tiles[u];w&&(w.state!=="loading"&&(w.state=m),this._loadTile(w,this._tileLoaded.bind(this,w,u,m)))}_tileLoaded(u,m,w,I){if(I)if(u.state="errored",I.status!==404)this._source.fire(new a.t(I,{tile:u}));else{if(this._source.fire(new a.x("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:u})),!(u.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const P=this.map.painter.terrain;this.update(this.transform,P.getScaledDemTileSize(),!0),P.resetTileLookupCache(this.id)}else this.update(this.transform)}else u.timeAdded=a.q.now(),w==="expired"&&(u.refreshedUponExpiration=!0),this._setTileReloadTimer(m,u),this._source.type==="raster-dem"&&u.dem&&this._backfillDEM(u),this._state.initializeTileState(u,this.map?this.map.painter:null),this._source.fire(new a.x("data",{dataType:"source",tile:u,coord:u.tileID,sourceCacheId:this.id}))}_backfillDEM(u){const m=this.getRenderableIds();for(let I=0;I<m.length;I++){const P=m[I];if(u.neighboringTiles&&u.neighboringTiles[P]){const F=this.getTileByID(P);w(u,F),w(F,u)}}function w(I,P){if(!I.dem||I.dem.borderReady)return;I.needsHillshadePrepare=!0,I.needsDEMTextureUpload=!0;let F=P.tileID.canonical.x-I.tileID.canonical.x;const W=P.tileID.canonical.y-I.tileID.canonical.y,q=Math.pow(2,I.tileID.canonical.z),J=P.tileID.key;F===0&&W===0||Math.abs(W)>1||(Math.abs(F)>1&&(Math.abs(F+q)===1?F+=q:Math.abs(F-q)===1&&(F-=q)),P.dem&&I.dem&&(I.dem.backfillBorder(P.dem,F,W),I.neighboringTiles&&I.neighboringTiles[J]&&(I.neighboringTiles[J].backfilled=!0)))}}getTile(u){return this.getTileByID(u.key)}getTileByID(u){return this._tiles[u]}_retainLoadedChildren(u,m,w,I){for(const P in this._tiles){let F=this._tiles[P];if(I[P]||!F.hasData()||F.tileID.overscaledZ<=m||F.tileID.overscaledZ>w)continue;let W=F.tileID;for(;F&&F.tileID.overscaledZ>m+1;){const J=F.tileID.scaledTo(F.tileID.overscaledZ-1);F=this._tiles[J.key],F&&F.hasData()&&(W=J)}let q=W;for(;q.overscaledZ>m;)if(q=q.scaledTo(q.overscaledZ-1),u[q.key]){I[W.key]=W;break}}}findLoadedParent(u,m){if(u.key in this._loadedParentTiles){const w=this._loadedParentTiles[u.key];return w&&w.tileID.overscaledZ>=m?w:null}for(let w=u.overscaledZ-1;w>=m;w--){const I=u.scaledTo(w),P=this._getLoadedTile(I);if(P)return P}}_getLoadedTile(u){const m=this._tiles[u.key];return m&&m.hasData()?m:this._cache.getByKey(this._source.reparseOverscaled?u.wrapped().key:u.canonical.key)}updateCacheSize(u,m){m=m||this._source.tileSize;const w=Math.ceil(u.width/m)+1,I=Math.ceil(u.height/m)+1,P=Math.floor(w*I*5),F=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,P):P,W=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,F):F;this._cache.setMaxSize(W)}handleWrapJump(u){const m=Math.round((u-(this._prevLng===void 0?u:this._prevLng))/360);if(this._prevLng=u,m){const w={};for(const I in this._tiles){const P=this._tiles[I];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+m),w[P.tileID.key]=P}this._tiles=w;for(const I in this._timers)clearTimeout(this._timers[I]),delete this._timers[I];for(const I in this._tiles)this._setTileReloadTimer(+I,this._tiles[I])}}update(u,m,w,I){if(this.transform=u,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!w)return;this.updateCacheSize(u,m),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const P=this._source.type==="batched-model";let F;if(this.used||this.usedForTerrain){if(this._source.tileID)F=u.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new a.aA(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y));else if(this.tileCoverLift!==0){const J=u.clone();J.tileCoverLift=this.tileCoverLift,F=J.coveringTiles({tileSize:m||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!w,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.minzoom<=1&&u.projection.name==="globe"&&(F.push(new a.aA(1,0,1,0,0)),F.push(new a.aA(1,0,1,1,0)),F.push(new a.aA(1,0,1,0,1)),F.push(new a.aA(1,0,1,1,1)))}else if(F=u.coveringTiles({tileSize:m||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!w,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:P}),this._source.hasTile){const J=this._source.hasTile.bind(this._source);F=F.filter(ee=>J(ee))}}else F=[];if(F.length>0&&this.castsShadows&&I&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Cp(this._source.type)){const J=u.coveringZoomLevel({tileSize:m||this._source.tileSize,roundZoom:this._source.roundZoom&&!w}),ee=Math.min(J,this._source.maxzoom);if(P){const ae=u.extendTileCover(F,ee);for(const le of ae)F.push(le)}else{const ae=u.extendTileCover(F,ee,I);for(const le of ae)this._shadowCasterTiles[le.key]=!0,F.push(le)}}const W=this._updateRetainedTiles(F);if(Cp(this._source.type)&&F.length!==0){const J={},ee={},ae=Object.keys(W);for(const ue of ae){const ve=W[ue],ye=this._tiles[ue];if(!ye||ye.fadeEndTime&&ye.fadeEndTime<=a.q.now())continue;const be=this.findLoadedParent(ve,Math.max(ve.overscaledZ-Xa.maxOverzooming,this._source.minzoom));be&&(this._addTile(be.tileID),J[be.tileID.key]=be.tileID),ee[ue]=ve}const le=F[F.length-1].overscaledZ;for(const ue in this._tiles){const ve=this._tiles[ue];if(W[ue]||!ve.hasData())continue;let ye=ve.tileID;for(;ye.overscaledZ>le;){ye=ye.scaledTo(ye.overscaledZ-1);const be=this._tiles[ye.key];if(be&&be.hasData()&&ee[ye.key]){W[ue]=ve.tileID;break}}}for(const ue in J)W[ue]||(this._coveredTiles[ue]=!0,W[ue]=J[ue])}for(const J in W)this._tiles[J].clearFadeHold();const q=a.be(this._tiles,W);for(const J of q){const ee=this._tiles[J];ee.hasSymbolBuckets&&!ee.holdingForFade()?ee.setHoldDuration(this.map._fadeDuration):ee.hasSymbolBuckets&&!ee.symbolFadeFinished()||this._removeTile(+J)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const u in this._tiles)this._tiles[u].holdingForFade()&&this._removeTile(+u)}_updateRetainedTiles(u){const m={};if(u.length===0)return m;const w={},I=u.reduce((J,ee)=>Math.min(J,ee.overscaledZ),1/0),P=u[0].overscaledZ,F=Math.max(P-Xa.maxOverzooming,this._source.minzoom),W=Math.max(P+Xa.maxUnderzooming,this._source.minzoom),q={};for(const J of u){const ee=this._addTile(J);m[J.key]=J,ee.hasData()||I<this._source.maxzoom&&(q[J.key]=J)}this._retainLoadedChildren(q,I,W,m);for(const J of u){let ee=this._tiles[J.key];if(ee.hasData())continue;if(J.canonical.z>=this._source.maxzoom){const le=J.children(this._source.maxzoom)[0],ue=this.getTile(le);if(ue&&ue.hasData()){m[le.key]=le;continue}}else{const le=J.children(this._source.maxzoom);if(m[le[0].key]&&m[le[1].key]&&m[le[2].key]&&m[le[3].key])continue}let ae=ee.wasRequested();for(let le=J.overscaledZ-1;le>=F;--le){const ue=J.scaledTo(le);if(w[ue.key]||(w[ue.key]=!0,ee=this.getTile(ue),!ee&&ae&&(ee=this._addTile(ue)),ee&&(m[ue.key]=ue,ae=ee.wasRequested(),ee.hasData())))break}}return m}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const u in this._tiles){const m=[];let w,I=this._tiles[u].tileID;for(;I.overscaledZ>0;){if(I.key in this._loadedParentTiles){w=this._loadedParentTiles[I.key];break}m.push(I.key);const P=I.scaledTo(I.overscaledZ-1);if(w=this._getLoadedTile(P),w)break;I=P}for(const P of m)this._loadedParentTiles[P]=w}}_addTile(u){let m=this._tiles[u.key];if(m)return m.isExtraShadowCaster!==!0||this._shadowCasterTiles[u.key]||this._reloadTile(u.key,"reloading"),m;m=this._cache.getAndRemove(u),m&&(this._setTileReloadTimer(u.key,m),m.tileID=u,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[u.key]&&(clearTimeout(this._cacheTimers[u.key]),delete this._cacheTimers[u.key],this._setTileReloadTimer(u.key,m)));const w=!!m;if(!w){const I=this.map?this.map.painter:null,P=this._source.tileSize*u.overscaleFactor();m=this._source.type==="raster-array"?new cg(u,P,this.transform.tileZoom,I,this._isRaster):new Fc(u,P,this.transform.tileZoom,I,this._isRaster),this._loadTile(m,this._tileLoaded.bind(this,m,u.key,m.state))}return m?(m.uses++,this._tiles[u.key]=m,w||this._source.fire(new a.x("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m):null}_setTileReloadTimer(u,m){u in this._timers&&(clearTimeout(this._timers[u]),delete this._timers[u]);const w=m.getExpiryTimeout();w&&(this._timers[u]=setTimeout(()=>{this._reloadTile(u,"expired"),delete this._timers[u]},w))}_removeTile(u){const m=this._tiles[u];m&&(m.uses--,delete this._tiles[u],this._timers[u]&&(clearTimeout(this._timers[u]),delete this._timers[u]),m.uses>0||(m.hasData()&&m.state!=="reloading"||m.state==="empty"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const u in this._tiles)this._removeTile(+u);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(u,m,w){const I=[],P=this.transform;if(!P)return I;const F=P.projection.name==="globe",W=a.am(P.center.lng);for(const q in this._tiles){const J=this._tiles[q];if(w&&J.clearQueryDebugViz(),J.holdingForFade())continue;let ee;if(F){const ae=J.tileID.canonical;if(ae.z===0){const le=[Math.abs(a.ap(W,...hd(ae,-1))-W),Math.abs(a.ap(W,...hd(ae,1))-W)];ee=[0,2*le.indexOf(Math.min(...le))-1]}else{const le=[Math.abs(a.ap(W,...hd(ae,-1))-W),Math.abs(a.ap(W,...hd(ae,0))-W),Math.abs(a.ap(W,...hd(ae,1))-W)];ee=[le.indexOf(Math.min(...le))-1]}}else ee=[0];for(const ae of ee){const le=u.containsTile(J,P,m,ae);le&&I.push(le)}}return I}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(u){return this._getRenderableCoordinates(u)}_getRenderableCoordinates(u,m){const w=this.getRenderableIds(u,m).map(P=>this._tiles[P].tileID),I=this.transform.projection.name==="globe";for(const P of w)P.projMatrix=this.transform.calculateProjMatrix(P.toUnwrapped()),P.expandedProjMatrix=I?this.transform.calculateProjMatrix(P.toUnwrapped(),!1,!0):P.projMatrix;return w}sortCoordinatesByDistance(u){const m=u.slice(),w=this.transform._camera.position,I=this.transform._camera.forward(),P={};for(const F of m){const W=1/(1<<F.canonical.z);P[F.key]=((F.canonical.x+.5)*W+F.wrap-w[0])*I[0]+((F.canonical.y+.5)*W-w[1])*I[1]-w[2]*I[2]}return m.sort((F,W)=>P[F.key]-P[W.key]),m}hasTransition(){if(this._source.hasTransition())return!0;if(Cp(this._source.type))for(const u in this._tiles){const m=this._tiles[u];if(m.fadeEndTime!==void 0&&m.fadeEndTime>=a.q.now())return!0}return!1}setFeatureState(u,m,w){this._state.updateState(u=u||"_geojsonTileLayer",m,w)}removeFeatureState(u,m,w){this._state.removeFeatureState(u=u||"_geojsonTileLayer",m,w)}getFeatureState(u,m){return this._state.getState(u=u||"_geojsonTileLayer",m)}setDependencies(u,m,w){const I=this._tiles[u];I&&I.setDependencies(m,w)}reloadTilesForDependencies(u,m){for(const w in this._tiles)this._tiles[w].hasDependency(u,m)&&this._reloadTile(+w,"reloading");this._cache.filter(w=>!w.hasDependency(u,m))}_preloadTiles(u,m){if(!this._sourceLoaded){const q=()=>{this._sourceLoaded&&(this._source.off("data",q),this._preloadTiles(u,m))};return void this._source.on("data",q)}const w=new Map,I=Array.isArray(u)?u:[u],P=this.map.painter.terrain,F=this.usedForTerrain&&P?P.getScaledDemTileSize():this._source.tileSize;for(const q of I){const J=q.coveringTiles({tileSize:F,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const ee of J)w.set(ee.key,ee);this.usedForTerrain&&q.updateElevation(!1)}const W=Array.from(w.values());a.bf(W,(q,J)=>{const ee=new Fc(q,this._source.tileSize*q.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(ee,ae=>{this._source.type==="raster-dem"&&ee.dem&&this._backfillDEM(ee),J(ae,ee)})},m)}}function Ql(b,u){const m=Math.abs(2*b.wrap)-+(b.wrap<0),w=Math.abs(2*u.wrap)-+(u.wrap<0);return b.overscaledZ-u.overscaledZ||w-m||u.canonical.y-b.canonical.y||u.canonical.x-b.canonical.x}function Cp(b){return b==="raster"||b==="image"||b==="video"||b==="custom"}function hd(b,u){const m=1<<b.z;return[b.x/m+u,(b.x+1)/m+u]}Xa.maxOverzooming=10,Xa.maxUnderzooming=3;class Ip{constructor(u){this.style=u,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const u=!1,m=!1;for(const w in this.style._mergedLayers){const I=this.style._mergedLayers[w];if(I.type==="fill-extrusion")this.layers.push({layer:I,visible:u,visibilityChanged:m});else if(I.type==="model"){const P=this.style.getLayerSource(I);P&&P.type==="batched-model"&&this.layers.push({layer:I,visible:u,visibilityChanged:m})}}}onNewFrame(u){this.layersGotHidden=!1;for(const m of this.layers){const w=m.layer;let I=!1;w.type==="fill-extrusion"?I=!w.isHidden(u)&&w.paint.get("fill-extrusion-opacity")>0:w.type==="model"&&(I=!w.isHidden(u)&&w.paint.get("model-opacity")>0),this.layersGotHidden=this.layersGotHidden||!I&&m.visible,m.visible=I}}updateZOffset(u,m){this.currentBuildingBuckets=[];for(const I of this.layers){const P=I.layer,F=this.style.getLayerSourceCache(P);let W=1;P.type==="fill-extrusion"&&(W=I.visible?P.paint.get("fill-extrusion-vertical-scale"):0);let q=F?F.getTile(m):null;if(!q&&F&&m.canonical.z>F.getSource().minzoom){let J=m.scaledTo(Math.min(F.getSource().maxzoom,m.overscaledZ-1));for(;J.overscaledZ>=F.getSource().minzoom&&(q=F.getTile(J),!q&&J.overscaledZ!==0);)J=J.scaledTo(J.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:q?q.getBucket(P):null,tileID:q?q.tileID:m,verticalScale:W})}u.hasAnyZOffset=!1;let w=!1;for(let I=0;I<u.symbolInstances.length;I++){const P=u.symbolInstances.get(I),F=P.zOffset,W=this._getHeightAtTileOffset(m,P.tileAnchorX,P.tileAnchorY);P.zOffset=W!==Number.NEGATIVE_INFINITY?W:F,w||F===P.zOffset||(w=!0),u.hasAnyZOffset||P.zOffset===0||(u.hasAnyZOffset=!0)}w&&(u.zOffsetBuffersNeedUpload=!0,u.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(u,m,w,I){let P=m,F=w;if(u.canonical.z!==I.canonical.z){const W=I.canonical,q=1/(1<<u.canonical.z-W.z);P=(m+u.canonical.x*a.ab)*q-W.x*a.ab|0,F=(w+u.canonical.y*a.ab)*q-W.y*a.ab|0}return{tileX:P,tileY:F}}_getHeightAtTileOffset(u,m,w){let I,P;for(let F=0;F<this.layers.length;++F){if(this.layers[F].layer.type!=="fill-extrusion")continue;const{bucket:W,tileID:q,verticalScale:J}=this.currentBuildingBuckets[F];if(!W)continue;const{tileX:ee,tileY:ae}=this._mapCoordToOverlappingTile(u,m,w,q),le=W.getHeightAtTileCoord(ee,ae);le&&le.height!==void 0&&(le.hidden?I=le.height:P=Math.max(le.height*J,P||0))}if(P!==void 0)return P;for(let F=0;F<this.layers.length;++F){const W=this.layers[F];if(W.layer.type!=="model"||!W.visible)continue;const{bucket:q,tileID:J}=this.currentBuildingBuckets[F];if(!q)continue;const{tileX:ee,tileY:ae}=this._mapCoordToOverlappingTile(u,m,w,J),le=q.getHeightAtTileCoord(ee,ae);if(le&&!le.hidden)return le.height===void 0&&I!==void 0?Math.min(le.maxHeight,I)*le.verticalScale:le.height?le.height*le.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function ju(b,u){const m={};for(const w in b)w!=="ref"&&(m[w]=b[w]);return a.bg.forEach(w=>{w in u&&(m[w]=u[w])}),m}function Hh(b){b=b.slice();const u=Object.create(null);for(let m=0;m<b.length;m++)u[b[m].id]=b[m];for(let m=0;m<b.length;m++)"ref"in b[m]&&(b[m]=ju(b[m],u[b[m].ref]));return b}const si={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Rp(b,u,m){m.push({command:si.addSource,args:[b,u[b]]})}function vr(b,u,m){u.push({command:si.removeSource,args:[b]}),m[b]=!0}function Rx(b,u,m,w){vr(b,m,w),Rp(b,u,m)}function cr(b,u,m){let w;for(w in b[m])if(b[m].hasOwnProperty(w)&&w!=="data"&&!a.bh(b[m][w],u[m][w]))return!1;for(w in u[m])if(u[m].hasOwnProperty(w)&&w!=="data"&&!a.bh(b[m][w],u[m][w]))return!1;return!0}function fd(b,u,m,w,I,P){let F;for(F in u=u||{},b=b||{})b.hasOwnProperty(F)&&(a.bh(b[F],u[F])||m.push({command:P,args:[w,F,u[F],I]}));for(F in u)u.hasOwnProperty(F)&&!b.hasOwnProperty(F)&&(a.bh(b[F],u[F])||m.push({command:P,args:[w,F,u[F],I]}))}function jh(b){return b.id}function dd(b,u){return b[u.id]=u,b}class bs{constructor(u,m){this.reset(u,m)}reset(u,m){this.points=u||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(u){if(this.points.length===1)return this.points[0];u=a.ap(u,0,1);let m=1,w=this._distances[m];const I=u*this.paddedLength+this.padding;for(;w<I&&m<this._distances.length;)w=this._distances[++m];const P=m-1,F=this._distances[P],W=w-F,q=W>0?(I-F)/W:0;return this.points[P].mult(1-q).add(this.points[m].mult(q))}}class pd{constructor(u,m,w){const I=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(u/w),this.yCellCount=Math.ceil(m/w);for(let F=0;F<this.xCellCount*this.yCellCount;F++)I.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=u,this.height=m,this.xScale=this.xCellCount/u,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(u,m,w,I,P){this._forEachCell(m,w,I,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(u),this.bboxes.push(m),this.bboxes.push(w),this.bboxes.push(I),this.bboxes.push(P)}insertCircle(u,m,w,I){this._forEachCell(m-I,w-I,m+I,w+I,this._insertCircleCell,this.circleUid++),this.circleKeys.push(u),this.circles.push(m),this.circles.push(w),this.circles.push(I)}_insertBoxCell(u,m,w,I,P,F){this.boxCells[P].push(F)}_insertCircleCell(u,m,w,I,P,F){this.circleCells[P].push(F)}_query(u,m,w,I,P,F){if(w<0||u>this.width||I<0||m>this.height)return!P&&[];const W=[];if(u<=0&&m<=0&&this.width<=w&&this.height<=I){if(P)return!0;for(let q=0;q<this.boxKeys.length;q++)W.push({key:this.boxKeys[q],x1:this.bboxes[4*q],y1:this.bboxes[4*q+1],x2:this.bboxes[4*q+2],y2:this.bboxes[4*q+3]});for(let q=0;q<this.circleKeys.length;q++){const J=this.circles[3*q],ee=this.circles[3*q+1],ae=this.circles[3*q+2];W.push({key:this.circleKeys[q],x1:J-ae,y1:ee-ae,x2:J+ae,y2:ee+ae})}return F?W.filter(F):W}return this._forEachCell(u,m,w,I,this._queryCell,W,{hitTest:P,seenUids:{box:{},circle:{}}},F),P?W.length>0:W}_queryCircle(u,m,w,I,P){const F=u-w,W=u+w,q=m-w,J=m+w;if(W<0||F>this.width||J<0||q>this.height)return!I&&[];const ee=[];return this._forEachCell(F,q,W,J,this._queryCellCircle,ee,{hitTest:I,circle:{x:u,y:m,radius:w},seenUids:{box:{},circle:{}}},P),I?ee.length>0:ee}query(u,m,w,I,P){return this._query(u,m,w,I,!1,P)}hitTest(u,m,w,I,P){return this._query(u,m,w,I,!0,P)}hitTestCircle(u,m,w,I){return this._queryCircle(u,m,w,!0,I)}_queryCell(u,m,w,I,P,F,W,q){const J=W.seenUids,ee=this.boxCells[P];if(ee!==null){const le=this.bboxes;for(const ue of ee)if(!J.box[ue]){J.box[ue]=!0;const ve=4*ue;if(u<=le[ve+2]&&m<=le[ve+3]&&w>=le[ve+0]&&I>=le[ve+1]&&(!q||q(this.boxKeys[ue]))){if(W.hitTest)return F.push(!0),!0;F.push({key:this.boxKeys[ue],x1:le[ve],y1:le[ve+1],x2:le[ve+2],y2:le[ve+3]})}}}const ae=this.circleCells[P];if(ae!==null){const le=this.circles;for(const ue of ae)if(!J.circle[ue]){J.circle[ue]=!0;const ve=3*ue;if(this._circleAndRectCollide(le[ve],le[ve+1],le[ve+2],u,m,w,I)&&(!q||q(this.circleKeys[ue]))){if(W.hitTest)return F.push(!0),!0;{const ye=le[ve],be=le[ve+1],we=le[ve+2];F.push({key:this.circleKeys[ue],x1:ye-we,y1:be-we,x2:ye+we,y2:be+we})}}}}}_queryCellCircle(u,m,w,I,P,F,W,q){const J=W.circle,ee=W.seenUids,ae=this.boxCells[P];if(ae!==null){const ue=this.bboxes;for(const ve of ae)if(!ee.box[ve]){ee.box[ve]=!0;const ye=4*ve;if(this._circleAndRectCollide(J.x,J.y,J.radius,ue[ye+0],ue[ye+1],ue[ye+2],ue[ye+3])&&(!q||q(this.boxKeys[ve])))return F.push(!0),!0}}const le=this.circleCells[P];if(le!==null){const ue=this.circles;for(const ve of le)if(!ee.circle[ve]){ee.circle[ve]=!0;const ye=3*ve;if(this._circlesCollide(ue[ye],ue[ye+1],ue[ye+2],J.x,J.y,J.radius)&&(!q||q(this.circleKeys[ve])))return F.push(!0),!0}}}_forEachCell(u,m,w,I,P,F,W,q){const J=this._convertToXCellCoord(u),ee=this._convertToYCellCoord(m),ae=this._convertToXCellCoord(w),le=this._convertToYCellCoord(I);for(let ue=J;ue<=ae;ue++)for(let ve=ee;ve<=le;ve++)if(P.call(this,u,m,w,I,this.xCellCount*ve+ue,F,W,q))return}_convertToXCellCoord(u){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(u*this.xScale)))}_convertToYCellCoord(u){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(u*this.yScale)))}_circlesCollide(u,m,w,I,P,F){const W=I-u,q=P-m,J=w+F;return J*J>W*W+q*q}_circleAndRectCollide(u,m,w,I,P,F,W){const q=(F-I)/2,J=Math.abs(u-(I+q));if(J>q+w)return!1;const ee=(W-P)/2,ae=Math.abs(m-(P+ee));if(ae>ee+w)return!1;if(J<=q||ae<=ee)return!0;const le=J-q,ue=ae-ee;return le*le+ue*ue<=w*w}}const ec={unknown:0,flipRequired:1,flipNotRequired:2},On=Math.tan(85*Math.PI/180);function ei(b,u,m,w,I,P,F){const W=a.a6.mat4.create();if(m)if(P.name==="globe"){const q=a.bi(I,u);a.a6.mat4.multiply(W,W,q)}else{const q=a.a6.mat2.invert([],F);W[0]=q[0],W[1]=q[1],W[4]=q[2],W[5]=q[3],w||a.a6.mat4.rotateZ(W,W,I.angle)}else a.a6.mat4.multiply(W,I.labelPlaneMatrix,b);return W}function Zr(b,u,m,w,I,P,F){const W=ei(b,u,m,w,I,P,F);return P.name==="globe"&&m||(W[2]=W[6]=W[10]=W[14]=0),W}function Gs(b,u,m,w,I,P,F){if(m){if(P.name==="globe"){const W=ei(b,u,m,w,I,P,F);return a.a6.mat4.invert(W,W),a.a6.mat4.multiply(W,b,W),W}{const W=a.a6.mat4.clone(b),q=a.a6.mat4.identity([]);return q[0]=F[0],q[1]=F[1],q[4]=F[2],q[5]=F[3],a.a6.mat4.multiply(W,W,q),w||a.a6.mat4.rotateZ(W,W,-I.angle),W}}return I.glCoordMatrix}function vo(b,u,m,w){const I=[b,u,m,1];m?a.a6.vec4.transformMat4(I,I,w):hg(I,I,w);const P=I[3];return I[0]/=P,I[1]/=P,I[2]/=P,I}function ni(b,u){return Math.min(.5+b/u*.5,1.5)}function ll(b,u){const m=b[0]/b[3],w=b[1]/b[3];return m>=-u[0]&&m<=u[0]&&w>=-u[1]&&w<=u[1]}function qo(b,u,m,w,I,P,F,W,q,J){const ee=m.transform,ae=w?b.textSizeData:b.iconSizeData,le=a.bj(ae,m.transform.zoom),ue=ee.projection.name==="globe",ve=[256/m.width*2+1,256/m.height*2+1],ye=w?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;ye.clear();let be=null;ue&&(be=w?b.text.globeExtVertexArray:b.icon.globeExtVertexArray);const we=b.lineVertexArray,ke=w?b.text.placedSymbolArray:b.icon.placedSymbolArray,Ne=m.transform.width/m.transform.height;let De,$e=!1;for(let je=0;je<ke.length;je++){const et=ke.get(je),{numGlyphs:Ke,writingMode:tt}=et;if(tt!==a.bk.vertical||$e||De===a.bk.horizontal||($e=!0),De=tt,(et.hidden||tt===a.bk.vertical)&&!$e){cl(Ke,ye);continue}$e=!1;const ut=new a.P(et.tileAnchorX,et.tileAnchorY);let{x:at,y:rt,z:bt}=ee.projection.projectTilePoint(ut.x,ut.y,J.canonical);if(q){const[qt,en,er]=q(ut);at+=qt,rt+=en,bt+=er}const Ft=[at,rt,bt,1];if(a.a6.vec4.transformMat4(Ft,Ft,u),!ll(Ft,ve)){cl(Ke,ye);continue}const Zt=Ft[3],kt=ni(m.transform.getCameraToCenterDistance(ee.projection),Zt),hn=a.bl(ae,le,et),wt=F?hn/kt:hn*kt,Wt=vo(at,rt,bt,I);if(Wt[3]<=0){cl(Ke,ye);continue}let Gt={};const fn=F?null:q,pn=Ms(et,wt,!1,W,u,I,P,b.glyphOffsetArray,we,ye,be,Wt,ut,Gt,Ne,fn,ee.projection,J,F);$e=pn.useVertical,fn&&pn.needsFlipping&&(Gt={}),(pn.notEnoughRoom||$e||pn.needsFlipping&&Ms(et,wt,!0,W,u,I,P,b.glyphOffsetArray,we,ye,be,Wt,ut,Gt,Ne,fn,ee.projection,J,F).notEnoughRoom)&&cl(Ke,ye)}w?(b.text.dynamicLayoutVertexBuffer.updateData(ye),be&&b.text.globeExtVertexBuffer&&b.text.globeExtVertexBuffer.updateData(be)):(b.icon.dynamicLayoutVertexBuffer.updateData(ye),be&&b.icon.globeExtVertexBuffer&&b.icon.globeExtVertexBuffer.updateData(be))}function gu(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye){const{lineStartIndex:be,glyphStartIndex:we,segment:ke}=W,Ne=we+W.numGlyphs,De=be+W.lineLength,$e=u.getoffsetX(we),je=u.getoffsetX(Ne-1),et=md(b*$e,m,w,I,P,F,ke,be,De,q,J,ee,ae,le,!0,ue,ve,ye);if(!et)return null;const Ke=md(b*je,m,w,I,P,F,ke,be,De,q,J,ee,ae,le,!0,ue,ve,ye);return Ke?{first:et,last:Ke}:null}function so(b,u,m,w){return b===a.bk.horizontal&&Math.abs(w)>Math.abs(m)?{useVertical:!0}:b===a.bk.vertical?w>0?{needsFlipping:!0}:null:u!==ec.unknown&&function(I,P){return I===0||Math.abs(P/I)>On}(m,w)?u===ec.flipRequired?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function Ms(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye,be,we,ke){const Ne=u/24,De=b.lineOffsetX*Ne,$e=b.lineOffsetY*Ne,{lineStartIndex:je,glyphStartIndex:et,numGlyphs:Ke,segment:tt,writingMode:ut,flipState:at}=b,rt=je+b.lineLength,bt=Ft=>{if(ee){const[wt,Wt,Gt]=Ft.up,fn=J.length;a.bm(ee,fn+0,wt,Wt,Gt),a.bm(ee,fn+1,wt,Wt,Gt),a.bm(ee,fn+2,wt,Wt,Gt),a.bm(ee,fn+3,wt,Wt,Gt)}const[Zt,kt,hn]=Ft.point;a.bn(J,Zt,kt,hn,Ft.angle)};if(Ke>1){const Ft=gu(Ne,W,De,$e,m,ae,le,b,q,P,ue,ye,!1,be,we,ke);if(!Ft)return{notEnoughRoom:!0};if(w&&!m){let[Zt,kt,hn]=Ft.first.point,[wt,Wt,Gt]=Ft.last.point;[Zt,kt]=vo(Zt,kt,hn,F),[wt,Wt]=vo(wt,Wt,Gt,F);const fn=so(ut,at,(wt-Zt)*ve,Wt-kt);if(b.flipState=fn&&fn.needsFlipping?ec.flipRequired:ec.flipNotRequired,fn)return fn}bt(Ft.first);for(let Zt=et+1;Zt<et+Ke-1;Zt++){const kt=md(Ne*W.getoffsetX(Zt),De,$e,m,ae,le,tt,je,rt,q,P,ue,ye,!1,!1,be,we,ke);if(!kt)return J.length-=4*(Zt-et),{notEnoughRoom:!0};bt(kt)}bt(Ft.last)}else{if(w&&!m){const Zt=vo(le.x,le.y,0,I),kt=je+tt+1,hn=new a.P(q.getx(kt),q.gety(kt)),wt=vo(hn.x,hn.y,0,I),Wt=wt[3]>0?wt:Lo(le,hn,Zt,1,I,void 0,be,we.canonical),Gt=so(ut,at,(Wt[0]-Zt[0])*ve,Wt[1]-Zt[1]);if(b.flipState=Gt&&Gt.needsFlipping?ec.flipRequired:ec.flipNotRequired,Gt)return Gt}const Ft=md(Ne*W.getoffsetX(et),De,$e,m,ae,le,tt,je,rt,q,P,ue,ye,!1,!1,be,we,ke);if(!Ft)return{notEnoughRoom:!0};bt(Ft)}return{}}function Px(b,u,m,w,I){const{x:P,y:F,z:W}=w.projectTilePoint(b.x,b.y,u);if(!I)return vo(P,F,W,m);const[q,J,ee]=I(b);return vo(P+q,F+J,W+ee,m)}function Lo(b,u,m,w,I,P,F,W){const q=Px(b.sub(u)._unit()._add(b),W,I,F,P);return a.a6.vec3.sub(q,m,q),a.a6.vec3.normalize(q,q),a.a6.vec3.scaleAndAdd(q,m,q,w)}function md(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye,be,we){const ke=w?b-u:b+u;let Ne=ke>0?1:-1,De=0;w&&(Ne*=-1,De=Math.PI),Ne<0&&(De+=Math.PI);let $e=W+F+(Ne>0?0:1)|0,je=I,et=I,Ke=0,tt=0;const ut=Math.abs(ke),at=[],rt=[];let bt=P,Ft=bt;const Zt=()=>Lo(Ft,bt,et,ut-Ke+1,ee,le,ye,be.canonical);for(;Ke+tt<=ut;){if($e+=Ne,$e<W||$e>=q)return null;if(et=je,Ft=bt,at.push(et),ue&&rt.push(Ft),bt=new a.P(J.getx($e),J.gety($e)),je=ae[$e],!je){const en=Px(bt,be.canonical,ee,ye,le);je=en[3]>0?ae[$e]=en:Zt()}Ke+=tt,tt=a.a6.vec3.distance(et,je)}ve&&le&&(ae[$e]&&(je=Zt(),tt=a.a6.vec3.distance(et,je)),ae[$e]=je);const kt=(ut-Ke)/tt,hn=bt.sub(Ft)._mult(kt)._add(Ft),wt=a.a6.vec3.sub([],je,et),Wt=a.a6.vec3.scaleAndAdd([],et,wt,kt);let Gt=[0,0,1],fn=wt[0],pn=wt[1];if(we&&(Gt=ye.upVector(be.canonical,hn.x,hn.y),Gt[0]!==0||Gt[1]!==0||Gt[2]!==1)){const en=[Gt[2],0,-Gt[0]],er=a.a6.vec3.cross([],Gt,en);a.a6.vec3.normalize(en,en),a.a6.vec3.normalize(er,er),fn=a.a6.vec3.dot(wt,en),pn=a.a6.vec3.dot(wt,er)}if(m){const en=a.a6.vec3.cross([],Gt,wt);a.a6.vec3.normalize(en,en),a.a6.vec3.scaleAndAdd(Wt,Wt,en,m*Ne)}const qt=De+Math.atan2(pn,fn);return at.push(Wt),ue&&rt.push(hn),{point:Wt,angle:qt,path:at,tilePath:rt,up:Gt}}function cl(b,u){const m=u.length,w=m+4*b;u.resize(w),u.float32.fill(-1/0,4*m,4*w)}function hg(b,u,m){const w=u[0],I=u[1];return b[0]=m[0]*w+m[4]*I+m[12],b[1]=m[1]*w+m[5]*I+m[13],b[3]=m[3]*w+m[7]*I+m[15],b}const Vs=100;class La{constructor(u,m,w=new pd(u.width+200,u.height+200,25),I=new pd(u.width+200,u.height+200,25)){this.transform=u,this.grid=w,this.ignoredGrid=I,this.pitchfactor=Math.cos(u._pitch)*u.cameraToCenterDistance,this.screenRightBoundary=u.width+Vs,this.screenBottomBoundary=u.height+Vs,this.gridRightBoundary=u.width+200,this.gridBottomBoundary=u.height+200,this.fogState=m}placeCollisionBox(u,m,w,I,P,F,W,q){let J=w.projectedAnchorX,ee=w.projectedAnchorY,ae=w.projectedAnchorZ;const le=w.elevation,ue=w.tileID,ve=u.getProjection();if(le&&ue){const[je,et,Ke]=ve.upVector(ue.canonical,w.tileAnchorX,w.tileAnchorY),tt=ve.upVectorScale(ue.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;J+=je*le*tt,ee+=et*le*tt,ae+=Ke*le*tt}const ye=this.projectAndGetPerspectiveRatio(W,J,ee,ae,w.tileID,ve.name==="globe"||!!le||this.transform.pitch>0,ve),be=F*ye.perspectiveRatio,we=(w.x1*m+I.x-w.padding)*be+ye.point.x,ke=(w.y1*m+I.y-w.padding)*be+ye.point.y,Ne=(w.x2*m+I.x+w.padding)*be+ye.point.x,De=(w.y2*m+I.y+w.padding)*be+ye.point.y,$e=ye.perspectiveRatio<=.55||ye.occluded;return!this.isInsideGrid(we,ke,Ne,De)||!P&&this.grid.hitTest(we,ke,Ne,De,q)||$e?{box:[],offscreen:!1,occluded:ye.occluded}:{box:[we,ke,Ne,De],offscreen:this.isOffscreen(we,ke,Ne,De),occluded:!1}}placeCollisionCircles(u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye){const be=[],we=this.transform.elevation,ke=u.getProjection(),Ne=we?we.getAtTileOffsetFunc(ye,this.transform.center.lat,this.transform.worldSize,ke):null,De=new a.P(w.tileAnchorX,w.tileAnchorY);let{x:$e,y:je,z:et}=ke.projectTilePoint(De.x,De.y,ye.canonical);if(Ne){const[hn,wt,Wt]=Ne(De);$e+=hn,je+=wt,et+=Wt}const Ke=ke.name==="globe",tt=this.projectAndGetPerspectiveRatio(W,$e,je,et,ye,Ke||!!we||this.transform.pitch>0,ke),{perspectiveRatio:ut}=tt,at=(ae?F/ut:F*ut)/a.bq,rt=vo($e,je,et,q),bt=tt.signedDistanceFromCamera>0?gu(at,P,w.lineOffsetX*at,w.lineOffsetY*at,!1,rt,De,w,I,q,{},we&&!ae?Ne:null,ae&&!!we,ke,ye,ae):null;let Ft=!1,Zt=!1,kt=!0;if(bt&&!tt.occluded){const hn=.5*ue*ut+ve,wt=new a.P(-100,-100),Wt=new a.P(this.screenRightBoundary,this.screenBottomBoundary),Gt=new bs,{first:fn,last:pn}=bt,qt=fn.path.length;let en=[];for(let Dn=qt-1;Dn>=1;Dn--)en.push(fn.path[Dn]);for(let Dn=1;Dn<pn.path.length;Dn++)en.push(pn.path[Dn]);const er=2.5*hn;J&&(en=en.map(([Dn,yr,qn],ur)=>(Ne&&!Ke&&(qn=Ne(ur<qt-1?fn.tilePath[qt-1-ur]:pn.tilePath[ur-qt+2])[2]),vo(Dn,yr,qn,J))),en.some(Dn=>Dn[3]<=0)&&(en=[]));let xn=[];if(en.length>0){let Dn=1/0,yr=-1/0,qn=1/0,ur=-1/0;for(const Ur of en)Dn=Math.min(Dn,Ur[0]),qn=Math.min(qn,Ur[1]),yr=Math.max(yr,Ur[0]),ur=Math.max(ur,Ur[1]);yr>=wt.x&&Dn<=Wt.x&&ur>=wt.y&&qn<=Wt.y&&(xn=[en.map(Ur=>new a.P(Ur[0],Ur[1]))],(Dn<wt.x||yr>Wt.x||qn<wt.y||ur>Wt.y)&&(xn=a.bo(xn,wt.x,wt.y,Wt.x,Wt.y)))}for(const Dn of xn){Gt.reset(Dn,.25*hn);let yr=0;yr=Gt.length<=.5*hn?1:Math.ceil(Gt.paddedLength/er)+1;for(let qn=0;qn<yr;qn++){const ur=qn/Math.max(yr-1,1),Ur=Gt.lerp(ur),Br=Ur.x+Vs,Ci=Ur.y+Vs;be.push(Br,Ci,hn,0);const Ui=Br-hn,is=Ci-hn,Xc=Br+hn,ea=Ci+hn;if(kt=kt&&this.isOffscreen(Ui,is,Xc,ea),Zt=Zt||this.isInsideGrid(Ui,is,Xc,ea),!m&&this.grid.hitTestCircle(Br,Ci,hn,le)&&(Ft=!0,!ee))return{circles:[],offscreen:!1,collisionDetected:Ft,occluded:!1}}}}return{circles:!ee&&Ft||!Zt?[]:be,offscreen:kt,collisionDetected:Ft,occluded:tt.occluded}}queryRenderedSymbols(u){if(u.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let w=1/0,I=1/0,P=-1/0,F=-1/0;for(const ee of u){const ae=new a.P(ee.x+Vs,ee.y+Vs);w=Math.min(w,ae.x),I=Math.min(I,ae.y),P=Math.max(P,ae.x),F=Math.max(F,ae.y),m.push(ae)}const W=this.grid.query(w,I,P,F).concat(this.ignoredGrid.query(w,I,P,F)),q={},J={};for(const ee of W){const ae=ee.key;if(q[ae.bucketInstanceId]===void 0&&(q[ae.bucketInstanceId]={}),q[ae.bucketInstanceId][ae.featureIndex])continue;const le=[new a.P(ee.x1,ee.y1),new a.P(ee.x2,ee.y1),new a.P(ee.x2,ee.y2),new a.P(ee.x1,ee.y2)];a.bp(m,le)&&(q[ae.bucketInstanceId][ae.featureIndex]=!0,J[ae.bucketInstanceId]===void 0&&(J[ae.bucketInstanceId]=[]),J[ae.bucketInstanceId].push(ae.featureIndex))}return J}insertCollisionBox(u,m,w,I,P){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:w,featureIndex:I,collisionGroupID:P},u[0],u[1],u[2],u[3])}insertCollisionCircles(u,m,w,I,P){const F=m?this.ignoredGrid:this.grid,W={bucketInstanceId:w,featureIndex:I,collisionGroupID:P};for(let q=0;q<u.length;q+=4)F.insertCircle(W,u[q],u[q+1],u[q+2])}projectAndGetPerspectiveRatio(u,m,w,I,P,F,W){const q=[m,w,I,1];let J=!1;I||this.transform.pitch>0?(a.a6.vec4.transformMat4(q,q,u),this.fogState&&P&&W.name!=="globe"&&(J=function(le,ue,ve,ye,be,we){const ke=we.calculateFogTileMatrix(be),Ne=[ue,ve,ye];return a.a6.vec3.transformMat4(Ne,Ne,ke),En(le,a.a6.vec3.length(Ne),we.pitch,we._fov)}(this.fogState,m,w,I,P.toUnwrapped(),this.transform)>.9)):hg(q,q,u);const ee=q[3];return{point:new a.P((q[0]/ee+1)/2*this.transform.width+Vs,(-q[1]/ee+1)/2*this.transform.height+Vs),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(W)/ee*.5,1.5),signedDistanceFromCamera:ee,occluded:F&&q[2]>ee||J}}isOffscreen(u,m,w,I){return w<Vs||u>=this.screenRightBoundary||I<Vs||m>this.screenBottomBoundary}isInsideGrid(u,m,w,I){return w>=0&&u<this.gridRightBoundary&&I>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const u=a.a6.mat4.identity([]);return a.a6.mat4.translate(u,u,[-100,-100,0]),u}}function qa(b,u,m){const w=u.createTileMatrix(b,b.worldSize,m.toUnwrapped());return a.a6.mat4.multiply(new Float32Array(16),b.projMatrix,w)}function Wh(b,u,m){if(u.projection.name===m.projection.name)return b.projMatrix;const w=m.clone();return w.setProjection(u.projection),qa(w,u.getProjection(),b)}function Nc(b,u,m){return u.name===m.projection.name?b.projMatrix:qa(m,u,b)}class Bs{constructor(u,m,w,I){this.opacity=u?Math.max(0,Math.min(1,u.opacity+(u.placed?m:-m))):I&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class _o{constructor(u,m,w,I,P,F=!1){this.text=new Bs(u?u.text:null,m,w,P),this.icon=new Bs(u?u.icon:null,m,I,P),this.clipped=F}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class ul{constructor(u,m,w,I=!1){this.text=u,this.icon=m,this.skipFade=w,this.clipped=I}}class Zs{constructor(){this.invProjMatrix=a.a6.mat4.create(),this.viewportMatrix=a.a6.mat4.create(),this.circles=[]}}class Wu{constructor(u,m,w,I,P){this.bucketInstanceId=u,this.featureIndex=m,this.sourceLayerIndex=w,this.bucketIndex=I,this.tileID=P}}class Ys{constructor(u){this.crossSourceCollisions=u,this.maxGroupID=0,this.collisionGroups={}}get(u){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[u]){const m=++this.maxGroupID;this.collisionGroups[u]={ID:m,predicate:w=>w.collisionGroupID===m}}return this.collisionGroups[u]}}function Do(b,u,m,w,I){const{horizontalAlign:P,verticalAlign:F}=a.bx(b),W=-(P-.5)*u,q=-(F-.5)*m,J=a.bw(b,w);return new a.P(W+J[0]*I,q+J[1]*I)}function Zo(b,u,m,w,I){const P=new a.P(b,u);return m&&P._rotate(w?I:-I),P}class vu{constructor(u,m,w,I,P,F){this.transform=u.clone(),this.projection=u.projection.name,this.collisionIndex=new La(this.transform,P),this.buildingIndex=F,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new Ys(w),this.collisionCircleArrays={},this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(u,m,w,I){const P=w.getBucket(m),F=w.latestFeatureIndex;if(!P||!F||m.fqid!==P.layerIds[0])return;const W=P.layers[0].layout,q=P.layers[0].paint,J=w.collisionBoxArray,ee=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),ae=w.tileSize/a.ab,le=w.tileID.toUnwrapped();this.transform.setProjection(P.projection);const ue=(ve=w.tileID,ye=P.getProjection(),be=this.transform,ye.name===this.projection?be.calculateProjMatrix(ve.toUnwrapped()):qa(be,ye,ve));var ve,ye,be;const we=W.get("text-pitch-alignment")==="map",ke=W.get("text-rotation-alignment")==="map";m.compileFilter();const Ne=m.dynamicFilter(),De=m.dynamicFilterNeedsFeature(),$e=this.transform.calculatePixelsToTileUnitsMatrix(w),je=Zr(ue,w.tileID.canonical,we,ke,this.transform,P.getProjection(),$e);let et=null;if(we){const ut=Gs(ue,w.tileID.canonical,we,ke,this.transform,P.getProjection(),$e);et=a.a6.mat4.multiply([],this.transform.labelPlaneMatrix,ut)}let Ke=null;Ne&&w.latestFeatureIndex&&(Ke={unwrappedTileID:le,dynamicFilter:Ne,dynamicFilterNeedsFeature:De}),this.retainedQueryData[P.bucketInstanceId]=new Wu(P.bucketInstanceId,F,P.sourceLayerIndex,P.index,w.tileID);const tt={bucket:P,layout:W,paint:q,posMatrix:ue,textLabelPlaneMatrix:je,labelToScreenMatrix:et,clippingData:Ke,scale:ee,textPixelRatio:ae,holdingForFade:w.holdingForFade(),collisionBoxArray:J,partiallyEvaluatedTextSize:a.bj(P.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.bj(P.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID),latestFeatureIndex:w.latestFeatureIndex};if(I)for(const ut of P.sortKeyRanges){const{sortKey:at,symbolInstanceStart:rt,symbolInstanceEnd:bt}=ut;u.push({sortKey:at,symbolInstanceStart:rt,symbolInstanceEnd:bt,parameters:tt})}else u.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:tt})}attemptAnchorPlacement(u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye,be,we,ke){const{textOffset0:Ne,textOffset1:De,crossTileID:$e}=le,je=[Ne,De],et=Do(u,w,I,je,P),Ke=this.collisionIndex.placeCollisionBox(ve,P,m,Zo(et.x,et.y,F,W,this.transform.angle),ae,q,J,ee.predicate);if(be){const tt=ve.getSymbolInstanceIconSize(ke,this.transform.zoom,le.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ve,tt,be,Zo(et.x,et.y,F,W,this.transform.angle),ae,q,J,ee.predicate).box.length===0)return}if(Ke.box.length>0){let tt;return this.prevPlacement&&this.prevPlacement.variableOffsets[$e]&&this.prevPlacement.placements[$e]&&this.prevPlacement.placements[$e].text&&(tt=this.prevPlacement.variableOffsets[$e].anchor),this.variableOffsets[$e]={textOffset:je,width:w,height:I,anchor:u,textScale:P,prevAnchor:tt},this.markUsedJustification(ve,u,le,ye),ve.allowVerticalPlacement&&(this.markUsedOrientation(ve,ye,le),this.placedOrientations[$e]=ye),{shift:et,placedGlyphBoxes:Ke}}}placeLayerBucketPart(u,m,w,I){const{bucket:P,layout:F,paint:W,posMatrix:q,textLabelPlaneMatrix:J,labelToScreenMatrix:ee,clippingData:ae,textPixelRatio:le,holdingForFade:ue,collisionBoxArray:ve,partiallyEvaluatedTextSize:ye,partiallyEvaluatedIconSize:be,collisionGroup:we,latestFeatureIndex:ke}=u.parameters,Ne=F.get("text-optional"),De=F.get("icon-optional"),$e=F.get("text-allow-overlap"),je=F.get("icon-allow-overlap"),et=F.get("text-rotation-alignment")==="map",Ke=F.get("text-pitch-alignment")==="map",tt=F.get("symbol-z-elevate"),ut=W.get("symbol-z-offset"),at=W.get("symbol-elevation-reference")==="sea";this.transform.setProjection(P.projection);let rt=$e&&(je||!P.hasIconData()||De),bt=je&&($e||!P.hasTextData()||Ne);const Ft=!ut.isConstant();!P.collisionArrays&&ve&&P.deserializeCollisionBoxes(ve),w&&I&&P.updateCollisionDebugBuffers(this.transform.zoom,ve);const Zt=(kt,hn,wt)=>{const{crossTileID:Wt,numVerticalGlyphVertices:Gt}=kt;let fn=null;if(ae&&ae.dynamicFilterNeedsFeature||Ft){const kr=this.retainedQueryData[P.bucketInstanceId];fn=ke.loadFeature({featureIndex:kt.featureIndex,bucketIndex:kr.bucketIndex,sourceLayerIndex:kr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(ae&&!(0,ae.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},fn,this.retainedQueryData[P.bucketInstanceId].tileID.canonical,new a.P(kt.tileAnchorX,kt.tileAnchorY),this.transform.calculateDistanceTileData(ae.unwrappedTileID)))return this.placements[Wt]=new ul(!1,!1,!1,!0),void m.add(Wt);const pn=ut.evaluate(fn,{});if(m.has(Wt))return;if(ue)return void(this.placements[Wt]=new ul(!1,!1,!1));let qt=!1,en=!1,er=!0,xn=!1,Dn=!1,yr=null,qn={box:null,offscreen:null,occluded:null},ur={box:null,offscreen:null,occluded:null},Ur=null,Br=null,Ci=null,Ui=0,is=0,Xc=0;wt.textFeatureIndex?Ui=wt.textFeatureIndex:kt.useRuntimeCollisionCircles&&(Ui=kt.featureIndex),wt.verticalTextFeatureIndex&&(is=wt.verticalTextFeatureIndex);const ea=kr=>{kr.tileID=this.retainedQueryData[P.bucketInstanceId].tileID;const pi=this.transform.elevation;kr.elevation=at?pn:pn+(pi?pi.getAtTileOffset(kr.tileID,kr.tileAnchorX,kr.tileAnchorY):0),kr.elevation+=kt.zOffset},Yr=wt.textBox;if(Yr){ea(Yr);const kr=Ti=>{let zs=a.bk.horizontal;if(P.allowVerticalPlacement&&!Ti&&this.prevPlacement){const ta=this.prevPlacement.placedOrientations[Wt];ta&&(this.placedOrientations[Wt]=ta,zs=ta,this.markUsedOrientation(P,zs,kt))}return zs},pi=(Ti,zs)=>{if(P.allowVerticalPlacement&&Gt>0&&wt.verticalTextBox){for(const ta of P.writingModes)if(ta===a.bk.vertical?(qn=zs(),ur=qn):qn=Ti(),qn&&qn.box&&qn.box.length)break}else qn=Ti()};if(F.get("text-variable-anchor")){let Ti=F.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Wt]){const ai=this.prevPlacement.variableOffsets[Wt];Ti.indexOf(ai.anchor)>0&&(Ti=Ti.filter(Fa=>Fa!==ai.anchor),Ti.unshift(ai.anchor))}const zs=(ai,Fa,Ka)=>{const Na=P.getSymbolInstanceTextSize(ye,kt,this.transform.zoom,hn),Ki=(ai.x2-ai.x1)*Na+2*ai.padding,ml=(ai.y2-ai.y1)*Na+2*ai.padding,gl=kt.hasIconTextFit&&!je?Fa:null;gl&&ea(gl);let qc={box:[],offscreen:!1,occluded:!1};const mc=$e?2*Ti.length:Ti.length;for(let Dl=0;Dl<mc;++Dl){const Zc=this.attemptAnchorPlacement(Ti[Dl%Ti.length],ai,Ki,ml,Na,et,Ke,le,q,we,Dl>=Ti.length,kt,hn,P,Ka,gl,ye,be);if(Zc&&(qc=Zc.placedGlyphBoxes,qc&&qc.box&&qc.box.length)){qt=!0,yr=Zc.shift;break}}return qc};pi(()=>zs(Yr,wt.iconBox,a.bk.horizontal),()=>{const ai=wt.verticalTextBox;return ai&&ea(ai),P.allowVerticalPlacement&&!(qn&&qn.box&&qn.box.length)&&Gt>0&&ai?zs(ai,wt.verticalIconBox,a.bk.vertical):{box:null,offscreen:null,occluded:null}}),qn&&(qt=qn.box,er=qn.offscreen,xn=qn.occluded);const ta=kr(!(!qn||!qn.box));if(!qt&&this.prevPlacement){const ai=this.prevPlacement.variableOffsets[Wt];ai&&(this.variableOffsets[Wt]=ai,this.markUsedJustification(P,ai.anchor,kt,ta))}}else{const Ti=(zs,ta)=>{const ai=P.getSymbolInstanceTextSize(ye,kt,this.transform.zoom,hn),Fa=this.collisionIndex.placeCollisionBox(P,ai,zs,new a.P(0,0),$e,le,q,we.predicate);return Fa&&Fa.box&&Fa.box.length&&(this.markUsedOrientation(P,ta,kt),this.placedOrientations[Wt]=ta),Fa};pi(()=>Ti(Yr,a.bk.horizontal),()=>{const zs=wt.verticalTextBox;return P.allowVerticalPlacement&&Gt>0&&zs?(ea(zs),Ti(zs,a.bk.vertical)):{box:null,offscreen:null,occluded:null}}),kr(!!(qn&&qn.box&&qn.box.length))}}if(Ur=qn,qt=Ur&&Ur.box&&Ur.box.length>0,er=Ur&&Ur.offscreen,xn=Ur&&Ur.occluded,kt.useRuntimeCollisionCircles){const kr=P.text.placedSymbolArray.get(kt.centerJustifiedTextSymbolIndex>=0?kt.centerJustifiedTextSymbolIndex:kt.verticalPlacedTextSymbolIndex),pi=a.bl(P.textSizeData,ye,kr),Ti=F.get("text-padding");Br=this.collisionIndex.placeCollisionCircles(P,$e,kr,P.lineVertexArray,P.glyphOffsetArray,pi,q,J,ee,w,Ke,we.predicate,kt.collisionCircleDiameter*pi/a.bq,Ti,this.retainedQueryData[P.bucketInstanceId].tileID),qt=$e||Br.circles.length>0&&!Br.collisionDetected,er=er&&Br.offscreen,xn=Br.occluded}if(wt.iconFeatureIndex&&(Xc=wt.iconFeatureIndex),wt.iconBox){const kr=pi=>{ea(pi);const Ti=kt.hasIconTextFit&&yr?Zo(yr.x,yr.y,et,Ke,this.transform.angle):new a.P(0,0),zs=P.getSymbolInstanceIconSize(be,this.transform.zoom,kt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(P,zs,pi,Ti,je,le,q,we.predicate)};ur&&ur.box&&ur.box.length&&wt.verticalIconBox?(Ci=kr(wt.verticalIconBox),en=Ci.box.length>0):(Ci=kr(wt.iconBox),en=Ci.box.length>0),er=er&&Ci.offscreen,Dn=Ci.occluded}const Ni=Ne||kt.numHorizontalGlyphVertices===0&&Gt===0,Ss=De||kt.numIconVertices===0;if(Ni||Ss?Ss?Ni||(en=en&&qt):qt=en&&qt:en=qt=en&&qt,qt&&Ur&&Ur.box&&this.collisionIndex.insertCollisionBox(Ur.box,F.get("text-ignore-placement"),P.bucketInstanceId,ur&&ur.box&&is?is:Ui,we.ID),en&&Ci&&this.collisionIndex.insertCollisionBox(Ci.box,F.get("icon-ignore-placement"),P.bucketInstanceId,Xc,we.ID),Br&&(qt&&this.collisionIndex.insertCollisionCircles(Br.circles,F.get("text-ignore-placement"),P.bucketInstanceId,Ui,we.ID),w)){const kr=P.bucketInstanceId;let pi=this.collisionCircleArrays[kr];pi===void 0&&(pi=this.collisionCircleArrays[kr]=new Zs);for(let Ti=0;Ti<Br.circles.length;Ti+=4)pi.circles.push(Br.circles[Ti+0]),pi.circles.push(Br.circles[Ti+1]),pi.circles.push(Br.circles[Ti+2]),pi.circles.push(Br.collisionDetected?1:0)}const Di=P.projection.name!=="globe";rt=rt&&(Di||!xn),bt=bt&&(Di||!Dn),this.placements[Wt]=new ul(qt||rt,en||bt,er||P.justReloaded),m.add(Wt)};if(tt&&this.buildingIndex&&(this.buildingIndex.updateZOffset(P,this.retainedQueryData[P.bucketInstanceId].tileID),P.updateZOffset()),P.sortFeaturesByY){const kt=P.getSortedSymbolIndexes(this.transform.angle);for(let hn=kt.length-1;hn>=0;--hn){const wt=kt[hn];Zt(P.symbolInstances.get(wt),wt,P.collisionArrays[wt])}P.hasAnyZOffset&&a.w(`${P.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(P.hasAnyZOffset){const kt=P.getSortedIndexesByZOffset();for(let hn=0;hn<kt.length;++hn){const wt=kt[hn];Zt(P.symbolInstances.get(wt),wt,P.collisionArrays[wt])}}else for(let kt=u.symbolInstanceStart;kt<u.symbolInstanceEnd;kt++)Zt(P.symbolInstances.get(kt),kt,P.collisionArrays[kt]);if(w&&P.bucketInstanceId in this.collisionCircleArrays){const kt=this.collisionCircleArrays[P.bucketInstanceId];a.a6.mat4.invert(kt.invProjMatrix,q),kt.viewportMatrix=this.collisionIndex.getViewportMatrix()}P.justReloaded=!1}markUsedJustification(u,m,w,I){const{leftJustifiedTextSymbolIndex:P,centerJustifiedTextSymbolIndex:F,rightJustifiedTextSymbolIndex:W,verticalPlacedTextSymbolIndex:q,crossTileID:J}=w,ee=a.bv(m),ae=I===a.bk.vertical?q:ee==="left"?P:ee==="center"?F:ee==="right"?W:-1;P>=0&&(u.text.placedSymbolArray.get(P).crossTileID=ae>=0&&P!==ae?0:J),F>=0&&(u.text.placedSymbolArray.get(F).crossTileID=ae>=0&&F!==ae?0:J),W>=0&&(u.text.placedSymbolArray.get(W).crossTileID=ae>=0&&W!==ae?0:J),q>=0&&(u.text.placedSymbolArray.get(q).crossTileID=ae>=0&&q!==ae?0:J)}markUsedOrientation(u,m,w){const I=m===a.bk.horizontal||m===a.bk.horizontalOnly?m:0,P=m===a.bk.vertical?m:0,{leftJustifiedTextSymbolIndex:F,centerJustifiedTextSymbolIndex:W,rightJustifiedTextSymbolIndex:q,verticalPlacedTextSymbolIndex:J}=w,ee=u.text.placedSymbolArray;F>=0&&(ee.get(F).placedOrientation=I),W>=0&&(ee.get(W).placedOrientation=I),q>=0&&(ee.get(q).placedOrientation=I),J>=0&&(ee.get(J).placedOrientation=P)}commit(u){this.commitTime=u,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let w=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const I=m?m.symbolFadeChange(u):1,P=m?m.opacities:{},F=m?m.variableOffsets:{},W=m?m.placedOrientations:{};for(const q in this.placements){const J=this.placements[q],ee=P[q];ee?(this.opacities[q]=new _o(ee,I,J.text,J.icon,null,J.clipped),w=w||J.text!==ee.text.placed||J.icon!==ee.icon.placed):(this.opacities[q]=new _o(null,I,J.text,J.icon,J.skipFade,J.clipped),w=w||J.text||J.icon)}for(const q in P){const J=P[q];if(!this.opacities[q]){const ee=new _o(J,I,!1,!1);ee.isHidden()||(this.opacities[q]=ee,w=w||J.text.placed||J.icon.placed)}}for(const q in F)this.variableOffsets[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.variableOffsets[q]=F[q]);for(const q in W)this.placedOrientations[q]||!this.opacities[q]||this.opacities[q].isHidden()||(this.placedOrientations[q]=W[q]);w?this.lastPlacementChangeTime=u:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:u)}updateLayerOpacities(u,m,w,I){const P=new Set;for(const F of m){const W=F.getBucket(u);W&&F.latestFeatureIndex&&u.fqid===W.layerIds[0]&&(this.updateBucketOpacities(W,P,F,F.collisionBoxArray,w,I,F.tileID,u.scope),W.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(W,F.tileID),W.updateZOffset()))}}updateBucketOpacities(u,m,w,I,P,F,W,q){u.hasTextData()&&u.text.opacityVertexArray.clear(),u.hasIconData()&&u.icon.opacityVertexArray.clear(),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexArray.clear(),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexArray.clear();const J=u.layers[0].layout,ee=u.layers[0].paint,ae=!!u.layers[0].dynamicFilter(),le=new _o(null,0,!1,!1,!0),ue=J.get("text-allow-overlap"),ve=J.get("icon-allow-overlap"),ye=J.get("text-variable-anchor"),be=J.get("text-rotation-alignment")==="map",we=J.get("text-pitch-alignment")==="map",ke=ee.get("symbol-z-offset"),Ne=ee.get("symbol-elevation-reference")==="sea",De=!ke.isConstant(),$e=new _o(null,0,ue&&(ve||!u.hasIconData()||J.get("icon-optional")),ve&&(ue||!u.hasTextData()||J.get("text-optional")),!0);!u.collisionArrays&&I&&(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData())&&u.deserializeCollisionBoxes(I);const je=(Ke,tt,ut)=>{for(let at=0;at<tt/4;at++)Ke.opacityVertexArray.emplaceBack(ut)};let et=0;F&&u.updateReplacement(W,F);for(let Ke=0;Ke<u.symbolInstances.length;Ke++){const tt=u.symbolInstances.get(Ke),{numHorizontalGlyphVertices:ut,numVerticalGlyphVertices:at,crossTileID:rt,numIconVertices:bt,tileAnchorX:Ft,tileAnchorY:Zt}=tt;let kt=null;if(tt&&De){const xn=this.retainedQueryData[u.bucketInstanceId];kt=w.latestFeatureIndex.loadFeature({featureIndex:tt.featureIndex,bucketIndex:xn.bucketIndex,sourceLayerIndex:xn.sourceLayerIndex,layoutVertexArrayOffset:0})}const hn=ke.evaluate(kt,{}),wt=m.has(rt);let Wt=this.opacities[rt];wt?Wt=le:Wt||(Wt=$e,this.opacities[rt]=Wt),m.add(rt);const Gt=ut>0||at>0,fn=bt>0,pn=this.placedOrientations[rt],qt=pn===a.bk.vertical,en=pn===a.bk.horizontal||pn===a.bk.horizontalOnly;!Gt&&!fn||Wt.isHidden()||et++;let er=!1;if((Gt||fn)&&F)for(const xn of u.activeReplacements){if(a.br(xn,P,a.bs.Symbol,q)||xn.min.x>Ft||Ft>xn.max.x||xn.min.y>Zt||Zt>xn.max.y)continue;const Dn=a.bt(Ft,Zt,W.canonical,xn.footprintTileId.canonical);if(er=a.bu(Dn,xn.footprint),er)break}if(Gt){const xn=er?_u:Xu(Wt.text);je(u.text,ut,qt?_u:xn),je(u.text,at,en?_u:xn);const Dn=Wt.text.isHidden(),{leftJustifiedTextSymbolIndex:yr,centerJustifiedTextSymbolIndex:qn,rightJustifiedTextSymbolIndex:ur,verticalPlacedTextSymbolIndex:Ur}=tt,Br=u.text.placedSymbolArray,Ci=Dn||qt?1:0;yr>=0&&(Br.get(yr).hidden=Ci),qn>=0&&(Br.get(qn).hidden=Ci),ur>=0&&(Br.get(ur).hidden=Ci),Ur>=0&&(Br.get(Ur).hidden=Dn||en?1:0);const Ui=this.variableOffsets[rt];Ui&&this.markUsedJustification(u,Ui.anchor,tt,pn);const is=this.placedOrientations[rt];is&&(this.markUsedJustification(u,"left",tt,is),this.markUsedOrientation(u,is,tt))}if(fn){const xn=er?_u:Xu(Wt.icon),{placedIconSymbolIndex:Dn,verticalPlacedIconSymbolIndex:yr}=tt,qn=u.icon.placedSymbolArray,ur=Wt.icon.isHidden()?1:0;Dn>=0&&(je(u.icon,bt,qt?_u:xn),qn.get(Dn).hidden=ur),yr>=0&&(je(u.icon,tt.numVerticalIconVertices,en?_u:xn),qn.get(yr).hidden=ur)}if(u.hasIconCollisionBoxData()||u.hasTextCollisionBoxData()){const xn=u.collisionArrays[Ke];if(xn){let Dn=new a.P(0,0),yr=!0;if(xn.textBox||xn.verticalTextBox){if(ye){const ur=this.variableOffsets[rt];ur?(Dn=Do(ur.anchor,ur.width,ur.height,ur.textOffset,ur.textScale),be&&Dn._rotate(we?this.transform.angle:-this.transform.angle)):yr=!1}ae&&(yr=!Wt.clipped),xn.textBox&&Pp(u.textCollisionBox.collisionVertexArray,Wt.text.placed,!yr||qt,hn,Ne,Dn.x,Dn.y),xn.verticalTextBox&&Pp(u.textCollisionBox.collisionVertexArray,Wt.text.placed,!yr||en,hn,Ne,Dn.x,Dn.y)}const qn=yr&&!!(!en&&xn.verticalIconBox);xn.iconBox&&Pp(u.iconCollisionBox.collisionVertexArray,Wt.icon.placed,qn,hn,Ne,tt.hasIconTextFit?Dn.x:0,tt.hasIconTextFit?Dn.y:0),xn.verticalIconBox&&Pp(u.iconCollisionBox.collisionVertexArray,Wt.icon.placed,!qn,hn,Ne,tt.hasIconTextFit?Dn.x:0,tt.hasIconTextFit?Dn.y:0)}}}if(u.fullyClipped=et===0,u.sortFeatures(this.transform.angle),this.retainedQueryData[u.bucketInstanceId]&&(this.retainedQueryData[u.bucketInstanceId].featureSortOrder=u.featureSortOrder),u.hasTextData()&&u.text.opacityVertexBuffer&&u.text.opacityVertexBuffer.updateData(u.text.opacityVertexArray),u.hasIconData()&&u.icon.opacityVertexBuffer&&u.icon.opacityVertexBuffer.updateData(u.icon.opacityVertexArray),u.hasIconCollisionBoxData()&&u.iconCollisionBox.collisionVertexBuffer&&u.iconCollisionBox.collisionVertexBuffer.updateData(u.iconCollisionBox.collisionVertexArray),u.hasTextCollisionBoxData()&&u.textCollisionBox.collisionVertexBuffer&&u.textCollisionBox.collisionVertexBuffer.updateData(u.textCollisionBox.collisionVertexArray),u.bucketInstanceId in this.collisionCircleArrays){const Ke=this.collisionCircleArrays[u.bucketInstanceId];u.placementInvProjMatrix=Ke.invProjMatrix,u.placementViewportMatrix=Ke.viewportMatrix,u.collisionCircleArray=Ke.circles,delete this.collisionCircleArrays[u.bucketInstanceId]}}symbolFadeChange(u){return this.fadeDuration===0?1:(u-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(u){return Math.max(0,(this.transform.zoom-u)/1.5)}hasTransitions(u){return this.stale||u-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(u,m){const w=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*w>u}setStale(){this.stale=!0}}function Pp(b,u,m,w,I,P,F){b.emplaceBack(u?1:0,m?1:0,P||0,F||0,w,I?1:0),b.emplaceBack(u?1:0,m?1:0,P||0,F||0,w,I?1:0),b.emplaceBack(u?1:0,m?1:0,P||0,F||0,w,I?1:0),b.emplaceBack(u?1:0,m?1:0,P||0,F||0,w,I?1:0)}const ao=Math.pow(2,25),$u=Math.pow(2,24),Lp=Math.pow(2,17),Bo=Math.pow(2,16),fg=Math.pow(2,9),Dp=Math.pow(2,8),U0=Math.pow(2,1);function Xu(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const u=b.placed?1:0,m=Math.floor(127*b.opacity);return m*ao+u*$u+m*Lp+u*Bo+m*fg+u*Dp+m*U0+u}const _u=0;class Lx{constructor(u){this._sortAcrossTiles=u.layout.get("symbol-z-order")!=="viewport-y"&&u.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(u,m,w,I,P){const F=this._bucketParts;for(;this._currentTileIndex<u.length;)if(m.getBucketParts(F,I,u[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,F.sort((W,q)=>W.sortKey-q.sortKey));this._currentPartIndex<F.length;){const W=F[this._currentPartIndex];if(m.placeLayerBucketPart(W,this._seenCrossTileIDs,w,W.symbolInstanceStart===0),this._currentPartIndex++,P())return!0}return!1}}class gd{constructor(u,m,w,I,P,F,W,q,J){this.placement=new vu(u,P,F,W,q,J),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=w,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(u,m,w,I){const P=a.q.now(),F=()=>{const W=a.q.now()-P;return!this._forceFullPlacement&&W>2};for(;this._currentPlacementIndex>=0;){const W=m[u[this._currentPlacementIndex]],q=this.placement.collisionIndex.transform.zoom;if(W.type==="symbol"&&(!W.minzoom||W.minzoom<=q)&&(!W.maxzoom||W.maxzoom>q)){const J=W,ee=J.layout.get("symbol-z-elevate"),ae=J.layout.get("symbol-sort-key").constantOr(1)!==void 0,le=J.layout.get("symbol-z-order"),ue=le==="viewport-y"||le==="auto"&&!(le!=="viewport-y"&&ae),ve=J.layout.get("text-allow-overlap")||J.layout.get("icon-allow-overlap")||J.layout.get("text-ignore-placement")||J.layout.get("icon-ignore-placement"),ye=ue&&ve,be=this._inProgressLayer=this._inProgressLayer||new Lx(J),we=a.av(W.source,W.scope);if(be.continuePlacement(ee||ye?I[we]:w[we],this.placement,this._showCollisionBoxes,W,F))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(u){return this.placement.commit(u),this.placement}}const qu=512/a.ab/2;class G0{constructor(u,m,w){this.tileID=u,this.bucketInstanceId=w,this.index=new a.by(m.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const I=u.canonical.x*a.ab,P=u.canonical.y*a.ab;for(let F=0;F<m.length;F++){const{key:W,crossTileID:q,tileAnchorX:J,tileAnchorY:ee}=m.get(F),ae=Math.floor((I+J)*qu),le=Math.floor((P+ee)*qu);this.index.add(ae,le),this.keys.push(W),this.crossTileIDs.push(q)}this.index.finish()}findMatches(u,m,w){const I=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),P=qu/Math.pow(2,m.canonical.z-this.tileID.canonical.z),F=m.canonical.x*a.ab,W=m.canonical.y*a.ab;for(let q=0;q<u.length;q++){const J=u.get(q);if(J.crossTileID)continue;const{key:ee,tileAnchorX:ae,tileAnchorY:le}=J,ue=Math.floor((F+ae)*P),ve=Math.floor((W+le)*P),ye=this.index.range(ue-I,ve-I,ue+I,ve+I);for(const be of ye){const we=this.crossTileIDs[be];if(this.keys[be]===ee&&!w.has(we)){w.add(we),J.crossTileID=we;break}}}}}class tc{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class $h{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(u){const m=Math.round((u-this.lng)/360);if(m!==0)for(const w in this.indexes){const I=this.indexes[w],P={};for(const F in I){const W=I[F];W.tileID=W.tileID.unwrapTo(W.tileID.wrap+m),P[W.tileID.key]=W}this.indexes[w]=P}this.lng=u}addBucket(u,m,w){if(this.indexes[u.overscaledZ]&&this.indexes[u.overscaledZ][u.key]){if(this.indexes[u.overscaledZ][u.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(u.overscaledZ,this.indexes[u.overscaledZ][u.key])}for(let P=0;P<m.symbolInstances.length;P++)m.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[u.overscaledZ]||(this.usedCrossTileIDs[u.overscaledZ]=new Set);const I=this.usedCrossTileIDs[u.overscaledZ];for(const P in this.indexes){const F=this.indexes[P];if(Number(P)>u.overscaledZ)for(const W in F){const q=F[W];q.tileID.isChildOf(u)&&q.findMatches(m.symbolInstances,u,I)}else{const W=F[u.scaledTo(Number(P)).key];W&&W.findMatches(m.symbolInstances,u,I)}}for(let P=0;P<m.symbolInstances.length;P++){const F=m.symbolInstances.get(P);F.crossTileID||(F.crossTileID=w.generate(),I.add(F.crossTileID))}return this.indexes[u.overscaledZ]===void 0&&(this.indexes[u.overscaledZ]={}),this.indexes[u.overscaledZ][u.key]=new G0(u,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(u,m){for(const w of m.crossTileIDs)this.usedCrossTileIDs[u].delete(w)}removeStaleBuckets(u){let m=!1;for(const w in this.indexes){const I=this.indexes[w];for(const P in I)u[I[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,I[P]),delete I[P],m=!0)}return m}}class Xh{constructor(){this.layerIndexes={},this.crossTileIDs=new tc,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(u,m,w,I){let P=this.layerIndexes[u.fqid];P===void 0&&(P=this.layerIndexes[u.fqid]=new $h);let F=!1;const W={};I.name!=="globe"&&P.handleWrapJump(w);for(const q of m){const J=q.getBucket(u);J&&u.fqid===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),P.addBucket(q.tileID,J,this.crossTileIDs)&&(F=!0),W[J.bucketInstanceId]=!0)}return P.removeStaleBuckets(W)&&(F=!0),F}pruneUnusedLayers(u){const m={};u.forEach(w=>{m[w]=!0});for(const w in this.layerIndexes)m[w]||delete this.layerIndexes[w]}}const yo=771;class Mr{constructor(u,m,w,I){this.blendFunction=u,this.blendColor=m,this.mask=w,this.blendEquation=I}}Mr.Replace=[1,0,1,0],Mr.disabled=new Mr(Mr.Replace,a.bz.transparent,[!1,!1,!1,!1]),Mr.unblended=new Mr(Mr.Replace,a.bz.transparent,[!0,!0,!0,!0]),Mr.alphaBlended=new Mr([1,yo,1,yo],a.bz.transparent,[!0,!0,!0,!0]),Mr.alphaBlendedNonPremultiplied=new Mr([770,yo,770,yo],a.bz.transparent,[!0,!0,!0,!0]),Mr.multiply=new Mr([774,0,774,0],a.bz.transparent,[!0,!0,!0,!0]);class Xn{constructor(u,m,w){this.func=u,this.mask=m,this.range=w}}Xn.ReadOnly=!1,Xn.ReadWrite=!0,Xn.disabled=new Xn(519,Xn.ReadOnly,[0,1]);const yu=7680;class pr{constructor(u,m,w,I,P,F){this.test=u,this.ref=m,this.mask=w,this.fail=I,this.depthFail=P,this.pass=F}}pr.disabled=new pr({func:519,mask:0},0,0,yu,yu,yu);const nc=1029,rc=2305;class _r{constructor(u,m,w){this.enable=u,this.mode=m,this.frontFace=w}}function Bp(b,u){const m=a.bC(b,3);a.a6.mat4.fromQuat(b,u),a.bE(b,3,m)}function vd(b,u){const m=a.a6.quat.identity([]);return a.a6.quat.rotateZ(m,m,-u),a.a6.quat.rotateX(m,m,-b),m}function ko(b,u){const m=[b[0],b[1],0],w=[u[0],u[1],0];if(a.a6.vec3.length(m)>=1e-15){const F=a.a6.vec3.normalize([],m);a.a6.vec3.scale(w,F,a.a6.vec3.dot(w,F)),u[0]=w[0],u[1]=w[1]}const I=a.a6.vec3.cross([],u,b);if(a.a6.vec3.len(I)<1e-15)return null;const P=Math.atan2(-I[1],I[0]);return vd(Math.atan2(Math.sqrt(b[0]*b[0]+b[1]*b[1]),-b[2]),P)}_r.disabled=new _r(!1,nc,rc),_r.backCCW=new _r(!0,nc,rc),_r.backCW=new _r(!0,nc,2304),_r.frontCW=new _r(!0,1028,2304),_r.frontCCW=new _r(!0,1028,rc);class xa{constructor(u,m){this.position=u,this.orientation=m}get position(){return this._position}set position(u){if(u){const m=u instanceof a.a5?u:new a.a5(u[0],u[1],u[2]);this._renderWorldCopies&&(m.x=a.bA(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(u,m){if(this.orientation=null,!this.position)return;const w=this.position,I=this._elevation?this._elevation.getAtPointOrZero(a.a5.fromLngLat(u)):0,P=a.a5.fromLngLat(u,I),F=[P.x-w.x,P.y-w.y,P.z-w.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=ko(F,m)}setPitchBearing(u,m){this.orientation=vd(a.bB(u),a.bB(-m))}}class ns{constructor(u,m){this._transform=a.a6.mat4.identity([]),this.orientation=m,this.position=u}get mercatorPosition(){const u=this.position;return new a.a5(u[0],u[1],u[2])}get position(){const u=a.bC(this._transform,3);return[u[0],u[1],u[2]]}set position(u){var m;u&&a.bE(this._transform,3,[(m=u)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(u){this._orientation=u||a.a6.quat.identity([]),u&&Bp(this._transform,this._orientation)}getPitchBearing(){const u=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2])}}setPitchBearing(u,m){this._orientation=vd(u,m),Bp(this._transform,this._orientation)}forward(){const u=a.bC(this._transform,2);return[-u[0],-u[1],-u[2]]}up(){const u=a.bC(this._transform,1);return[-u[0],-u[1],-u[2]]}right(){const u=a.bC(this._transform,0);return[u[0],u[1],u[2]]}getCameraToWorld(u,m){const w=new Float64Array(16);return a.a6.mat4.invert(w,this.getWorldToCamera(u,m)),w}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(u,m,w){const I=this.position;a.a6.vec3.scale(I,I,-u);const P=new Float64Array(16);return a.a6.mat4.fromScaling(P,[w,w,w]),a.a6.mat4.translate(P,P,I),P[10]*=m,P}getWorldToCamera(u,m){const w=new Float64Array(16),I=new Float64Array(4),P=this.position;return a.a6.quat.conjugate(I,this._orientation),a.a6.vec3.scale(P,P,-u),a.a6.mat4.fromQuat(w,I),a.a6.mat4.translate(w,w,P),w[1]*=-1,w[5]*=-1,w[9]*=-1,w[13]*=-1,w[8]*=m,w[9]*=m,w[10]*=m,w[11]*=m,w}getCameraToClipPerspective(u,m,w,I){const P=new Float64Array(16);return a.a6.mat4.perspective(P,u,m,w,I),P}getCameraToClipOrthographic(u,m,w,I,P,F){const W=new Float64Array(16);return a.a6.mat4.ortho(W,u,m,w,I,P,F),W}getDistanceToElevation(u,m=!1){const w=u===0?0:a.bD(u,m?a.aM(this.position[1]):this.position[1]),I=this.forward();return(w-this.position[2])/I[2]}clone(){return new ns([...this.position],[...this.orientation])}}const la={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Yo{constructor(u=0,m=0,w=0,I=0){if(isNaN(u)||u<0||isNaN(m)||m<0||isNaN(w)||w<0||isNaN(I)||I<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=u,this.bottom=m,this.left=w,this.right=I}interpolate(u,m,w){return m.top!=null&&u.top!=null&&(this.top=a.aa(u.top,m.top,w)),m.bottom!=null&&u.bottom!=null&&(this.bottom=a.aa(u.bottom,m.bottom,w)),m.left!=null&&u.left!=null&&(this.left=a.aa(u.left,m.left,w)),m.right!=null&&u.right!=null&&(this.right=a.aa(u.right,m.right,w)),this}getCenter(u,m){const w=a.ap((this.left+u-this.right)/2,0,u),I=a.ap((this.top+m-this.bottom)/2,0,m);return new a.P(w,I)}equals(u){return this.top===u.top&&this.bottom===u.bottom&&this.left===u.left&&this.right===u.right}clone(){return new Yo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const qh=(b,u,m)=>(1-m)*b+m*u,Zh=b=>b*b*b*b*b;class _d{constructor(u,m,w,I,P,F,W){this.tileSize=512,this._renderWorldCopies=P===void 0||P,this._minZoom=u||0,this._maxZoom=m||22,this._minPitch=w??0,this._maxPitch=I??60,this.setProjection(F),this.setMaxBounds(W),this.width=0,this.height=0,this._center=new a.bK(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Yo,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new ns,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const u=new _d(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return u._elevation=this._elevation,u._centerAltitude=this._centerAltitude,u._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,u.tileSize=this.tileSize,u.mercatorFromTransition=this.mercatorFromTransition,u.width=this.width,u.height=this.height,u.cameraElevationReference=this.cameraElevationReference,u._center=this._center,u._setZoom(this.zoom),u._seaLevelZoom=this._seaLevelZoom,u.angle=this.angle,u._fov=this._fov,u._pitch=this._pitch,u._nearZ=this._nearZ,u._farZ=this._farZ,u._averageElevation=this._averageElevation,u._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,u._unmodified=this._unmodified,u._edgeInsets=this._edgeInsets.clone(),u._camera=this._camera.clone(),u._calcMatrices(),u.freezeTileCoverage=this.freezeTileCoverage,u.frustumCorners=this.frustumCorners,u}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(u){this._elevation!==u&&(this._elevation=u,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(u,m=!1){const w=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||w)&&this._updateCameraOnTerrain(),(u||w)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return a.ar(this.projection,["name","center","parallels"])}setProjection(u){this.projectionOptions=u||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=a.bL(this.projectionOptions);const w=this.getProjection(),I=!a.bh(m,w);return I&&this._calcMatrices(),this.mercatorFromTransition=!1,I}setOrthographicProjectionAtLowPitch(u){return this._orthographicProjectionAtLowPitch!==u&&(this._orthographicProjectionAtLowPitch=u,this._calcMatrices(),!0)}setMercatorFromTransition(){const u=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.bL({name:"mercator"});const m=u!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(u){this._minZoom!==u&&(this._minZoom=u,this.zoom=Math.max(this.zoom,u))}get maxZoom(){return this._maxZoom}set maxZoom(u){this._maxZoom!==u&&(this._maxZoom=u,this.zoom=Math.min(this.zoom,u))}get minPitch(){return this._minPitch}set minPitch(u){this._minPitch!==u&&(this._minPitch=u,this.pitch=Math.max(this.pitch,u))}get maxPitch(){return this._maxPitch}set maxPitch(u){this._maxPitch!==u&&(this._maxPitch=u,this.pitch=Math.min(this.pitch,u))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(u){u===void 0?u=!0:u===null&&(u=!1),this._renderWorldCopies=u}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get cameraWorldSize(){const u=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(u))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.bD(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.P(this.width,this.height)}get bearing(){return a.bA(this.rotation,-180,180)}set bearing(u){this.rotation=u}get rotation(){return-this.angle/Math.PI*180}set rotation(u){const m=-u*Math.PI/180;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=a.a6.mat2.create(),a.a6.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(u){const m=a.ap(u,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const u=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/u)}set fov(u){u=Math.max(.01,Math.min(60,u)),this._fov!==u&&(this._unmodified=!1,this._fov=a.bB(u),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(u){this._averageElevation=u,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(u){const m=Math.min(Math.max(u,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(u){this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(u){this._tileCoverLift!==u&&(this._tileCoverLift=u)}_updateCameraOnTerrain(){const u=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,m=this.elevation&&u===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||u===Number.NEGATIVE_INFINITY&&(!m||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const w=this._elevation;m||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&w.exaggeration()&&this._centerAltitudeValidForExaggeration!==w.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*w.exaggeration(),this._centerAltitudeValidForExaggeration=w.exaggeration()):(this._centerAltitude=u||0,this._centerAltitudeValidForExaggeration=w.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const u=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],w=this.horizonLineFromTop();let I=0,P=0;for(let F=0;F<m.length;F++){const W=new a.P(m[F][0]*this.width,w+m[F][1]*(this.height-w)),q=u.pointCoordinate(W);if(!q)continue;const J=1/Math.hypot(q[0]-this._camera.position[0],q[1]-this._camera.position[1]);I+=q[3]*J,P+=J}return P===0?NaN:I/P}get center(){return this._center}set center(u){u.lat===this._center.lat&&u.lng===this._center.lng||(this._unmodified=!1,this._center=u,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const u=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),w=this.pixelsPerMeter/this.worldSize*m,I=this._mercatorZfromZoom(u),P=this._mercatorZfromZoom(this._maxZoom),F=Math.max(I-w,P);this._setZoom(this._zoomFromMercatorZ(F))}get padding(){return this._edgeInsets.toJSON()}set padding(u){this._edgeInsets.equals(u)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,u,1),this._calcMatrices())}computeZoomRelativeTo(u){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,u.toAltitude()));let w;w=u.z<this._camera.position[2]?[m.x,m.y,m.z]:[u.x,u.y,u.z];const I=a.a6.vec3.length(a.a6.vec3.sub([],this._camera.position,w));return a.ap(this._zoomFromMercatorZ(I),this._minZoom,this._maxZoom)}setFreeCameraOptions(u){if(!this.height||!u.position&&!u.orientation)return;this._updateCameraState();let m=!1;if(u.orientation&&!a.a6.quat.exactEquals(u.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(u.orientation)),u.position){const w=[u.position.x,u.position.y,u.position.z];a.a6.vec3.exactEquals(w,this._camera.position)||(this._setCameraPosition(w),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const u=this._camera.position,m=new xa;return m.position=new a.a5(u[0],u[1],u[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(u){if(!a.a6.quat.length(u))return!1;a.a6.quat.normalize(u,u);const m=a.a6.vec3.transformQuat([],[0,0,-1],u),w=a.a6.vec3.transformQuat([],[0,-1,0],u);if(w[2]<0)return!1;const I=ko(m,w);return!!I&&(this._camera.orientation=I,!0)}_setCameraPosition(u){const m=this.zoomScale(this.minZoom)*this.tileSize,w=this.zoomScale(this.maxZoom)*this.tileSize,I=this.cameraToCenterDistance;u[2]=a.ap(u[2],I/w,I/m),this._camera.position=u}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(u){return this._edgeInsets.equals(u)}interpolatePadding(u,m,w){this._unmodified=!1,this._edgeInsets.interpolate(u,m,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(u){const m=(u.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/u.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(u){const m=[new a.bM(0,u)];if(this.renderWorldCopies){const w=this.pointCoordinate(new a.P(0,0)),I=this.pointCoordinate(new a.P(this.width,0)),P=this.pointCoordinate(new a.P(this.width,this.height)),F=this.pointCoordinate(new a.P(0,this.height)),W=Math.floor(Math.min(w.x,I.x,P.x,F.x)),q=Math.floor(Math.max(w.x,I.x,P.x,F.x)),J=1;for(let ee=W-J;ee<=q+J;ee++)ee!==0&&m.push(new a.bM(ee,u))}return m}isLODDisabled(u){return(!u||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(u,m,w){let I=[];const P=w!==void 0,F=!P;if(F&&this.zoom<m||P&&w[0]===0&&w[1]===0)return I;const W=new Set,q=(ee,ae,le,ue,ve)=>{const ye=a.c1(ae,ee,le,ue,ve);W.has(ye)||(I.push(new a.aA(ee,ae,le,ue,ve)),W.add(ye))};for(let ee=0;ee<u.length;ee++){const ae=u[ee];if(F&&ae.canonical.z!==m)continue;const le=ae.canonical,ue=ae.overscaledZ,ve=ae.wrap,ye=1<<le.z,be=le.x+1<ye,we=le.x>0,ke=le.y+1<ye,Ne=le.y>0,De=ae.wrap-(we?0:1),$e=ae.wrap+(be?0:1),je=we?le.x-1:ye-1,et=be?le.x+1:0;if(P)w[0]<0?(q(ue,$e,le.z,et,le.y),w[1]<0&&ke&&(q(ue,ve,le.z,le.x,le.y+1),q(ue,$e,le.z,et,le.y+1)),w[1]>0&&Ne&&(q(ue,ve,le.z,le.x,le.y-1),q(ue,$e,le.z,et,le.y-1))):w[0]>0?(q(ue,De,le.z,je,le.y),w[1]<0&&ke&&(q(ue,ve,le.z,le.x,le.y+1),q(ue,De,le.z,je,le.y+1)),w[1]>0&&Ne&&(q(ue,ve,le.z,le.x,le.y-1),q(ue,De,le.z,je,le.y-1))):w[1]<0&&ke?q(ue,ve,le.z,le.x,le.y+1):Ne&&q(ue,ve,le.z,le.x,le.y-1);else{const Ke=ae.visibleQuadrants;1&Ke&&(q(ue,De,le.z,je,le.y),Ne&&(q(ue,ve,le.z,le.x,le.y-1),q(ue,De,le.z,je,le.y-1))),2&Ke&&(q(ue,$e,le.z,et,le.y),Ne&&(q(ue,ve,le.z,le.x,le.y-1),q(ue,$e,le.z,et,le.y-1))),4&Ke&&(q(ue,De,le.z,je,le.y),ke&&(q(ue,ve,le.z,le.x,le.y+1),q(ue,De,le.z,je,le.y+1))),8&Ke&&(q(ue,$e,le.z,et,le.y),ke&&(q(ue,ve,le.z,le.x,le.y+1),q(ue,$e,le.z,et,le.y+1)))}}const J=[];for(const ee of I)I.some(ae=>ee.isChildOf(ae))||J.push(ee);if(I=J.filter(ee=>!u.some(ae=>!!(ee.overscaledZ<m&&ae.isChildOf(ee))||ee.equals(ae)||ee.isChildOf(ae))),F){const ee=1<<m,ae=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),le=[ee*ae.x,ee*ae.y],ue=4,ve=ue*ue;I=I.filter(ye=>{const be=ye.canonical.x+.5-le[0],we=ye.canonical.y+.5-le[1];return be*be+we*we<ve})}return I}coveringTiles(u){let m=this.coveringZoomLevel(u);const w=m,I=this.elevation&&this.elevation.exaggeration(),P=I&&!u.isTerrainDEM,F=this.projection.name==="mercator";if(u.minzoom!==void 0&&m<u.minzoom)return[];u.maxzoom!==void 0&&m>u.maxzoom&&(m=u.maxzoom);const W=this.locationCoordinate(this.center),q=this.center.lat,J=1<<m,ee=[J*W.x,J*W.y,0],ae=this.projection.name==="globe",le=!ae,ue=a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,le),ve=ae?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ye=J*a.bD(1,this.center.lat),be=this._camera.position[2]/a.bD(1,this.center.lat),we=[J*ve.x,J*ve.y,be*(le?1:ye)],ke=ae||I,Ne=this.cameraToCenterDistance/u.tileSize*(u.roundZoom?1:.502),De=this.isLODDisabled(!0)?m:0;let $e;if(this._elevation&&u.isTerrainDEM)$e=1e4*this._elevation.exaggeration();else if(this._elevation){const wt=this._elevation.getMinMaxForVisibleTiles();$e=wt?wt.max:this._centerAltitude}else $e=this._centerAltitude;const je=u.isTerrainDEM?-$e:this._elevation?this._elevation.getMinElevationBelowMSL():0,et=this.projection.isReprojectedInTileSpace?a.bO(this):1,Ke=wt=>{const Gt=new a.a5(wt.x+25e-6,wt.y,wt.z),fn=new a.a5(wt.x,wt.y+25e-6,wt.z),pn=wt.toLngLat(),qt=Gt.toLngLat(),en=fn.toLngLat(),er=this.locationCoordinate(pn),xn=this.locationCoordinate(qt),Dn=this.locationCoordinate(en),yr=Math.hypot(xn.x-er.x,xn.y-er.y),qn=Math.hypot(Dn.x-er.x,Dn.y-er.y);return Math.sqrt(yr*qn)*et/25e-6},tt=wt=>{const Wt=$e,Gt=je;return{aabb:a.bR(this,J,0,0,0,wt,Gt,Wt,this.projection),zoom:0,x:0,y:0,minZ:Gt,maxZ:Wt,wrap:wt,fullyVisible:!1}},ut=[];let at=[];const rt=m,bt=u.reparseOverscaled?w:m,Ft=(be-this._centerAltitude)*ye,Zt=wt=>{if(!this._elevation||!wt.tileID||!F)return;const Wt=this._elevation.getMinMaxForTile(wt.tileID),Gt=wt.aabb;Wt?(Gt.min[2]=Wt.min,Gt.max[2]=Wt.max,Gt.center[2]=(Gt.min[2]+Gt.max[2])/2):(wt.shouldSplit=hn(wt),wt.shouldSplit||(Gt.min[2]=Gt.max[2]=Gt.center[2]=this._centerAltitude))},kt=(wt,Wt)=>{if(.707*Wt<wt)return 1;const Gt=Wt/wt;return Gt/(1.4144271570014144+(Math.pow(1.1,Gt-1.4144271570014144+1)-1)/(1.1-1)-1)},hn=wt=>{if(wt.zoom<De)return!0;if(wt.zoom===rt)return!1;if(wt.shouldSplit!=null)return wt.shouldSplit;const Wt=wt.aabb.distanceX(we),Gt=wt.aabb.distanceY(we);let fn=Ft,pn=1;if(ae){fn=wt.aabb.distanceZ(we);const qn=Math.pow(2,wt.zoom),ur=a.aM((wt.y+1)/qn),Ur=a.aM(wt.y/qn),Br=Math.min(Math.max(q,ur),Ur),Ci=a.c5(Br)/a.c5(q);if(pn=Br===q?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ci/this._mercatorScaleRatio),this.zoom<=a.c2&&wt.zoom===rt-1&&Ci>=.9)return!0}else if(P&&(fn=wt.aabb.distanceZ(we)*ye),this.projection.isReprojectedInTileSpace&&w<=5){const qn=Math.pow(2,wt.zoom),ur=Ke(new a.a5((wt.x+.5)/qn,(wt.y+.5)/qn));pn=ur>.85?1:ur}if(!F){const qn=Math.sqrt(Wt*Wt+Gt*Gt+fn*fn);let ur=(1<<rt-wt.zoom)*Ne*pn;return ur*=kt(Math.max(fn,Ft),qn),qn<ur}let qt=Number.MAX_VALUE,en=0;const er=wt.aabb.getCorners(),xn=[];for(const qn of er){a.a6.vec3.sub(xn,qn,we),ae||(P?xn[2]*=ye:xn[2]=Ft);const ur=a.a6.vec3.dot(xn,this._camera.forward());ur<qt&&(qt=ur,en=Math.abs(xn[2]))}let Dn=(1<<rt-wt.zoom)*Ne*pn;if(Dn*=kt(Math.max(en,Ft),qt),qt<Dn)return!0;const yr=wt.aabb.closestPoint(ee);return yr[0]===ee[0]&&yr[1]===ee[1]};if(this.renderWorldCopies)for(let wt=1;wt<=3;wt++)ut.push(tt(-wt)),ut.push(tt(wt));for(ut.push(tt(0));ut.length>0;){const wt=ut.pop(),Wt=wt.x,Gt=wt.y;let fn=wt.fullyVisible;const pn=()=>this.projection.name==="globe"&&(wt.y===0||wt.y===(1<<wt.zoom)-1);if(!fn){let qt=ke?wt.aabb.intersects(ue):wt.aabb.intersectsFlat(ue);if(qt===0&&pn()){const en=new a.bP(wt.zoom,Wt,Gt);qt=a.bQ(this,J,en,!0).intersects(ue)}if(qt===0)continue;fn=qt===2}if(wt.zoom!==rt&&hn(wt))for(let qt=0;qt<4;qt++){const en=(Wt<<1)+qt%2,er=(Gt<<1)+(qt>>1),xn={aabb:F?wt.aabb.quadrant(qt):a.bR(this,J,wt.zoom+1,en,er,wt.wrap,wt.minZ,wt.maxZ,this.projection),zoom:wt.zoom+1,x:en,y:er,wrap:wt.wrap,fullyVisible:fn,tileID:void 0,shouldSplit:void 0,minZ:wt.minZ,maxZ:wt.maxZ};P&&!ae&&(xn.tileID=new a.aA(wt.zoom+1===rt?bt:wt.zoom+1,wt.wrap,wt.zoom+1,en,er),Zt(xn)),ut.push(xn)}else{const qt=wt.zoom===rt?bt:wt.zoom;if(u.minzoom&&u.minzoom>qt)continue;let en=0;if(!fn){let yr=ke?wt.aabb.intersectsPrecise(ue):wt.aabb.intersectsPreciseFlat(ue);if(yr===0&&pn()){const qn=new a.bP(wt.zoom,Wt,Gt);yr=a.bQ(this,J,qn,!0).intersectsPrecise(ue)}if(yr===0)continue;if(u.calculateQuadrantVisibility)if(ue.containsPoint(wt.aabb.center))en=15;else for(let qn=0;qn<4;qn++)wt.aabb.quadrant(qn).intersects(ue)!==0&&(en|=1<<qn)}const er=ee[0]-(.5+Wt+(wt.wrap<<wt.zoom))*(1<<m-wt.zoom),xn=ee[1]-.5-Gt,Dn=wt.tileID?wt.tileID:new a.aA(qt,wt.wrap,wt.zoom,Wt,Gt);u.calculateQuadrantVisibility&&(Dn.visibleQuadrants=en),at.push({tileID:Dn,distanceSq:er*er+xn*xn})}}if(this.fogCullDistSq){const wt=this.fogCullDistSq,Wt=this.horizonLineFromTop();at=at.filter(Gt=>{const fn=[0,0,0,1],pn=[a.ab,a.ab,0,1],qt=this.calculateFogTileMatrix(Gt.tileID.toUnwrapped());a.a6.vec4.transformMat4(fn,fn,qt),a.a6.vec4.transformMat4(pn,pn,qt);const en=a.a6.vec4.min([],fn,pn),er=a.a6.vec4.max([],fn,pn),xn=a.bS(en,er);if(xn===0)return!0;let Dn=!1;const yr=this._elevation;if(yr&&xn>wt&&Wt!==0){const qn=this.calculateProjMatrix(Gt.tileID.toUnwrapped());let ur;u.isTerrainDEM||(ur=yr.getMinMaxForTile(Gt.tileID)),ur||(ur={min:je,max:$e});const Ur=a.c3(this.rotation),Br=[Ur[0]*a.ab,Ur[1]*a.ab,ur.max];a.a6.vec3.transformMat4(Br,Br,qn),Dn=(1-Br[1])*this.height*.5<Wt}return xn<wt||Dn})}return at.sort((wt,Wt)=>wt.distanceSq-Wt.distanceSq).map(wt=>wt.tileID)}resize(u,m){this.width=u,this.height=m,this.pixelsToGLUnits=[2/u,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(u){return Math.pow(2,u)}scaleZoom(u){return Math.log(u)/Math.LN2}project(u){const m=a.ap(u.lat,-a.bT,a.bT),w=this.projection.project(u.lng,m);return new a.P(w.x*this.worldSize,w.y*this.worldSize)}unproject(u){return this.projection.unproject(u.x/this.worldSize,u.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.bD(1,this.center.lat)/this.worldSize}setLocationAtPoint(u,m){let w,I;const P=this.centerPoint;if(this.projection.name==="globe"){const W=this.worldSize;w=(m.x-P.x)/W,I=(m.y-P.y)/W}else{const W=this.pointCoordinate(m),q=this.pointCoordinate(P);w=W.x-q.x,I=W.y-q.y}const F=this.locationCoordinate(u);this.setLocation(new a.a5(F.x-w,F.y-I))}setLocation(u){this.center=this.coordinateLocation(u),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(u){return this.projection.locationPoint(this,u)}locationPoint3D(u){return this.projection.locationPoint(this,u,!0)}pointLocation(u){return this.coordinateLocation(this.pointCoordinate(u))}pointLocation3D(u){return this.coordinateLocation(this.pointCoordinate3D(u))}locationCoordinate(u,m){const w=m?a.bD(m,u.lat):void 0,I=this.projection.project(u.lng,u.lat);return new a.a5(I.x,I.y,w)}coordinateLocation(u){return this.projection.unproject(u.x,u.y)}pointRayIntersection(u,m){const w=m??this._centerAltitude,I=[u.x,u.y,0,1],P=[u.x,u.y,1,1];a.a6.vec4.transformMat4(I,I,this.pixelMatrixInverse),a.a6.vec4.transformMat4(P,P,this.pixelMatrixInverse);const F=P[3];a.a6.vec4.scale(I,I,1/I[3]),a.a6.vec4.scale(P,P,1/F);const W=I[2],q=P[2];return{p0:I,p1:P,t:W===q?0:(w-W)/(q-W)}}screenPointToMercatorRay(u){const m=[u.x,u.y,0,1],w=[u.x,u.y,1,1];return a.a6.vec4.transformMat4(m,m,this.pixelMatrixInverse),a.a6.vec4.transformMat4(w,w,this.pixelMatrixInverse),a.a6.vec4.scale(m,m,1/m[3]),a.a6.vec4.scale(w,w,1/w[3]),m[2]=a.bD(m[2],this._center.lat)*this.worldSize,w[2]=a.bD(w[2],this._center.lat)*this.worldSize,a.a6.vec4.scale(m,m,1/this.worldSize),a.a6.vec4.scale(w,w,1/this.worldSize),new a.aj([m[0],m[1],m[2]],a.a6.vec3.normalize([],a.a6.vec3.sub([],w,m)))}rayIntersectionCoordinate(u){const{p0:m,p1:w,t:I}=u,P=a.bD(m[2],this._center.lat),F=a.bD(w[2],this._center.lat);return new a.a5(a.aa(m[0],w[0],I)/this.worldSize,a.aa(m[1],w[1],I)/this.worldSize,a.aa(P,F,I))}pointCoordinate(u,m=this._centerAltitude){return this.projection.pointCoordinate(this,u.x,u.y,m)}pointCoordinate3D(u){if(!this.elevation)return this.pointCoordinate(u);let m=this.projection.pointCoordinate3D(this,u.x,u.y);if(m)return new a.a5(m[0],m[1],m[2]);let w=0,I=this.horizonLineFromTop();if(u.y>I)return this.pointCoordinate(u);const P=.02*I,F=u.clone();for(let W=0;W<10&&I-w>P;W++){F.y=a.aa(w,I,.66);const q=this.projection.pointCoordinate3D(this,F.x,F.y);q?(I=F.y,m=q):w=F.y}return m?new a.a5(m[0],m[1],m[2]):this.pointCoordinate(u)}isPointAboveHorizon(u){return this.projection.isPointAboveHorizon(this,u)}isPointOnSurface(u){if(u.y<0||u.y>this.height||u.x<0||u.x>this.width)return!1;if(this.elevation||this.zoom>=a.bU)return!this.isPointAboveHorizon(u);const m=this.pointCoordinate(u);return m.y>=0&&m.y<=1}_coordinatePoint(u,m){const w=m&&this.elevation?this.elevation.getAtPointOrZero(u,this._centerAltitude):this._centerAltitude,I=[u.x*this.worldSize,u.y*this.worldSize,w+u.toAltitude(),1];return a.a6.vec4.transformMat4(I,I,this.pixelMatrix),I[3]>0?new a.P(I[0]/I[3],I[1]/I[3]):new a.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:u,left:m}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,P=this.pointLocation3D(new a.P(m,u)),F=this.pointLocation3D(new a.P(I,u)),W=this.pointLocation3D(new a.P(I,w)),q=this.pointLocation3D(new a.P(m,w));let J=Math.min(P.lng,F.lng,W.lng,q.lng),ee=Math.max(P.lng,F.lng,W.lng,q.lng),ae=Math.min(P.lat,F.lat,W.lat,q.lat),le=Math.max(P.lat,F.lat,W.lat,q.lat);const ue=Math.pow(2,-this.zoom)/16*270,ve=this.projection.name==="globe"?1:4,ye=(be,we,ke,Ne,De)=>{const $e=(be+ke)/2,je=(we+Ne)/2,et=new a.P($e,je),{lng:Ke,lat:tt}=this.pointLocation3D(et),ut=Math.max(0,J-Ke,ae-tt,Ke-ee,tt-le);J=Math.min(J,Ke),ee=Math.max(ee,Ke),ae=Math.min(ae,tt),le=Math.max(le,tt),(De<ve||ut>ue)&&(ye(be,we,$e,je,De+1),ye($e,je,ke,Ne,De+1))};if(ye(m,u,I,u,1),ye(I,u,I,w,1),ye(I,w,m,w,1),ye(m,w,m,u,1),this.projection.name==="globe"){const[be,we]=a.bV(this);be?(le=90,ee=180,J=-180):we&&(ae=-90,ee=180,J=-180)}return new a.as(new a.bK(J,ae),new a.bK(ee,le))}_getBoundsRectangular(u,m){const{top:w,left:I}=this._edgeInsets,P=this.height-this._edgeInsets.bottom,F=this.width-this._edgeInsets.right,W=new a.P(I,w),q=new a.P(F,w),J=new a.P(F,P),ee=new a.P(I,P);let ae=this.pointCoordinate(W,u),le=this.pointCoordinate(q,u);const ue=this.pointCoordinate(J,m),ve=this.pointCoordinate(ee,m),ye=(be,we)=>(we.y-be.y)/(we.x-be.x);return ae.y>1&&le.y>=0?ae=new a.a5((1-ve.y)/ye(ve,ae)+ve.x,1):ae.y<0&&le.y<=1&&(ae=new a.a5(-ve.y/ye(ve,ae)+ve.x,0)),le.y>1&&ae.y>=0?le=new a.a5((1-ue.y)/ye(ue,le)+ue.x,1):le.y<0&&ae.y<=1&&(le=new a.a5(-ue.y/ye(ue,le)+ue.x,0)),new a.as().extend(this.coordinateLocation(ae)).extend(this.coordinateLocation(le)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(ue))}_getBoundsRectangularTerrain(){const u=this.elevation;if(!u.visibleDemTiles.length||u.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=u.visibleDemTiles.reduce((w,I)=>{if(I.dem){const P=I.dem.tree;w.min=Math.min(w.min,P.minimums[0]),w.max=Math.max(w.max,P.maximums[0])}return w},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*u.exaggeration(),m.max*u.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(u=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,w=this.height/2-m*(1-this._horizonShift);return u?Math.max(0,w):w}getMaxBounds(){return this.maxBounds}setMaxBounds(u){this.maxBounds=u,this.minLat=-a.bT,this.maxLat=a.bT,this.minLng=-180,this.maxLng=180,u&&(this.minLat=u.getSouth(),this.maxLat=u.getNorth(),this.minLng=u.getWest(),this.maxLng=u.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.am(this.minLng)*this.tileSize,this.worldMaxX=a.am(this.maxLng)*this.tileSize,this.worldMinY=a.at(this.maxLat)*this.tileSize,this.worldMaxY=a.at(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(u,m){return this.projection.createTileMatrix(this,m,u)}calculateDistanceTileData(u){const m=u.key,w=this._distanceTileDataCache;if(w[m])return w[m];const I=u.canonical,P=1/this.height,F=this.cameraWorldSize,W=F/this.zoomScale(I.z),q=(I.x+Math.pow(2,I.z)*u.wrap)*W,J=I.y*W,ee=this.point;ee.x*=F/this.worldSize,ee.y*=F/this.worldSize;const ae=this.angle,le=Math.sin(-ae),ue=-Math.cos(-ae);return w[m]={bearing:[le,ue],center:[(ee.x-q)*P,(ee.y-J)*P],scale:W/a.ab*P},w[m]}calculateFogTileMatrix(u){const m=u.key,w=this._fogTileMatrixCache;if(w[m])return w[m];const I=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,u);return a.a6.mat4.multiply(I,this.worldToFogMatrix,I),w[m]=new Float32Array(I),w[m]}calculateProjMatrix(u,m=!1,w=!1){const I=u.key;let P;if(P=w?this._expandedProjMatrixCache:m?this._alignedProjMatrixCache:this._projMatrixCache,P[I])return P[I];const F=this.calculatePosMatrix(u,this.worldSize);let W;return W=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:w?this.expandedFarZProjMatrix:m?this.alignedProjMatrix:this.projMatrix,a.a6.mat4.multiply(F,W,F),P[I]=new Float32Array(F),P[I]}calculatePixelsToTileUnitsMatrix(u){const m=u.tileID.key,w=this._pixelsToTileUnitsCache;if(w[m])return w[m];const I=a.bW(u,this);return w[m]=I,w[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const u=1/this.worldSize,m=a.a6.mat4.fromScaling([],[u,u,u]);return a.a6.mat4.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const u=this._elevation;this._updateCameraState();const m=a.bD(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(m),I=this._camera.forward(),P=a.bD(1,this._center.lat);w[2]/=P,I[2]/=P,a.a6.vec3.normalize(I,I);const F=u.raycast(w,I,u.exaggeration());if(F){const W=a.a6.vec3.scaleAndAdd([],w,I,F),q=new a.a5(W[0],W[1],a.bD(W[2],a.aM(W[1]))),J=(q.z+a.a6.vec3.length([q.x-w[0],q.y-w[1],q.z-w[2]*P]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(J),this._centerAltitude=q.toAltitude(),this._center=this.coordinateLocation(q),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(u=!1){if(!this._elevation)return;const m=this._elevation,w=a.bD(1,this._center.lat)*this.worldSize,I=this._computeCameraPosition(w),P=m.getAtPointOrZero(new a.a5(...I)),F=this.pixelsPerMeter/this.worldSize*P,W=this._minimumHeightOverTerrain(),q=I[2]-F;if(q<=W)if(q<0||u){const J=this.locationCoordinate(this._center,this._centerAltitude),ee=[I[0],I[1],J.z-I[2]],ae=a.a6.vec3.length(ee);ee[2]-=(W-q)/this._pixelsPerMercatorPixel;const le=a.a6.vec3.length(ee);if(le===0)return;a.a6.vec3.scale(ee,ee,ae/le*this._pixelsPerMercatorPixel),this._camera.position=[I[0],I[1],J.z*this._pixelsPerMercatorPixel-ee[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const u=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||u){const le=this.center;return le.lat=a.ap(le.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!u)&&(le.lng=a.ap(le.lng,this.minLng,this.maxLng)),this.center=le,void(this._constraining=!1)}const m=this._unmodified,{x:w,y:I}=this.point;let P=0,F=w,W=I;const q=this.width/2,J=this.height/2,ee=this.worldMinY*this.scale,ae=this.worldMaxY*this.scale;if(I-J<ee&&(W=ee+J),I+J>ae&&(W=ae-J),ae-ee<this.height&&(P=Math.max(P,this.height/(ae-ee)),W=(ae+ee)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const le=this.worldMinX*this.scale,ue=this.worldMaxX*this.scale,ve=this.worldSize/2-(le+ue)/2;F=(w+ve+this.worldSize)%this.worldSize-ve,F-q<le&&(F=le+q),F+q>ue&&(F=ue-q),ue-le<this.width&&(P=Math.max(P,this.width/(ue-le)),F=(ue+le)/2)}F===w&&W===I||(this.center=this.unproject(new a.P(F,W))),P&&(this.zoom+=this.scaleZoom(P)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let u=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(u=Math.max(u,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),u}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const u=this.centerOffset,m=this.projection.name==="globe",w=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.bD(1,this.center.lat)/a.bD(1,a.c4));const I=a.bX(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,I),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const P=this.projection.zAxisUnit==="meters"?w:1,F=this._camera.getWorldToCamera(this.worldSize,P);let W;const q=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(q[8]=2*-u.x/this.width,q[9]=2*u.y/this.height,this.isOrthographic){let tt=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),ut=tt*this.aspect,at=-ut,rt=-tt;ut-=u.x,at-=u.x,tt+=u.y,rt+=u.y,W=this._camera.getCameraToClipOrthographic(at,ut,rt,tt,this._nearZ,this._farZ),((bt,Ft,Zt,kt)=>{for(let hn=0;hn<16;hn++)bt[hn]=qh(Ft[hn],Zt[hn],kt)})(W,W,q,Zh(this.pitch>=15?1:this.pitch/15))}else W=q;const J=a.a6.mat4.mul([],q,F);let ee=a.a6.mat4.mul([],W,F);if(this.projection.isReprojectedInTileSpace){const tt=this.locationCoordinate(this.center),ut=a.a6.mat4.identity([]);a.a6.mat4.translate(ut,ut,[tt.x*this.worldSize,tt.y*this.worldSize,0]),a.a6.mat4.multiply(ut,ut,a.bY(this)),a.a6.mat4.translate(ut,ut,[-tt.x*this.worldSize,-tt.y*this.worldSize,0]),a.a6.mat4.multiply(ee,ee,ut),a.a6.mat4.multiply(J,J,ut),this.inverseAdjustmentMatrix=a.bZ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=a.a6.mat4.scale([],ee,[this.worldSize,this.worldSize,this.worldSize/P,1]),this.projMatrix=ee,this.invProjMatrix=a.a6.mat4.invert(new Float64Array(16),this.projMatrix),m){const tt=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);tt[8]=2*-u.x/this.width,tt[9]=2*u.y/this.height,this.expandedFarZProjMatrix=a.a6.mat4.mul([],tt,F)}else this.expandedFarZProjMatrix=this.projMatrix;const ae=a.a6.mat4.invert([],W);this.frustumCorners=a.b_.fromInvProjectionMatrix(ae,this.horizonLineFromTop(),this.height),this.cameraFrustum=a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!m);const le=new Float32Array(16);a.a6.mat4.identity(le),a.a6.mat4.scale(le,le,[1,-1,1]),a.a6.mat4.rotateX(le,le,this._pitch),a.a6.mat4.rotateZ(le,le,this.angle);const ue=a.a6.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=a.a6.mat4.clone(ue);const ve=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;ue[8]=2*-u.x/this.width,ue[9]=2*(u.y+ve)/this.height,this.skyboxMatrix=a.a6.mat4.multiply(le,ue,le);const ye=this.point,be=ye.x,we=ye.y,ke=this.width%2/2,Ne=this.height%2/2,De=Math.cos(this.angle),$e=Math.sin(this.angle),je=be-Math.round(be)+De*ke+$e*Ne,et=we-Math.round(we)+De*Ne+$e*ke,Ke=new Float64Array(ee);if(a.a6.mat4.translate(Ke,Ke,[je>.5?je-1:je,et>.5?et-1:et,0]),this.alignedProjMatrix=Ke,ee=a.a6.mat4.create(),a.a6.mat4.scale(ee,ee,[this.width/2,-this.height/2,1]),a.a6.mat4.translate(ee,ee,[1,-1,0]),this.labelPlaneMatrix=ee,ee=a.a6.mat4.create(),a.a6.mat4.scale(ee,ee,[1,-1,1]),a.a6.mat4.translate(ee,ee,[-1,-1,0]),a.a6.mat4.scale(ee,ee,[2/this.width,2/this.height,1]),this.glCoordMatrix=ee,this.pixelMatrix=a.a6.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,J),this._calcFogMatrices(),this._distanceTileDataCache={},ee=a.a6.mat4.invert(new Float64Array(16),this.pixelMatrix),!ee)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=ee,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.b$(this);const tt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.a6.vec3.transformMat4(tt,tt,F),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=ee;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const u=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,w=this._camera.position,I=1/this.height/this._pixelsPerMercatorPixel,P=[u,u,m];a.a6.vec3.scale(P,P,I),a.a6.vec3.scale(w,w,-1),a.a6.vec3.multiply(w,w,P);const F=a.a6.mat4.create();a.a6.mat4.translate(F,F,w),a.a6.mat4.scale(F,F,P),this.mercatorFogMatrix=F,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(u,m,I)}_computeCameraPosition(u){const m=(u=u||this.pixelsPerMeter)/this.pixelsPerMeter,w=this._camera.forward(),I=this.point,P=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-u/this.worldSize*this._centerAltitude;return[I.x/this.worldSize-w[0]*P,I.y/this.worldSize-w[1]*P,u/this.worldSize*this._centerAltitude-w[2]*P]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(u){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),w=this._camera.position[2],I=u[2];let P=1;this.projection.wrap&&(this.center=this.center.wrap()),I>0&&(P=Math.min((m-w)/I,1)),this._camera.position=a.a6.vec3.scaleAndAdd([],this._camera.position,u,P),this._updateStateFromCamera()}_updateStateFromCamera(){const u=this._camera.position,m=this._camera.forward(),{pitch:w,bearing:I}=this._camera.getPitchBearing(),P=a.bD(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,F=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.bB(this._maxPitch)),W=Math.max((u[2]-P)/Math.cos(w),F),q=this._zoomFromMercatorZ(W);a.a6.vec3.scaleAndAdd(u,u,m,W),this._pitch=a.ap(w,a.bB(this.minPitch),a.bB(this.maxPitch)),this.angle=a.bA(I,-Math.PI,Math.PI),this._setZoom(a.ap(q,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.a5(u[0],u[1],u[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(u){return Math.pow(2,u)*this.tileSize}_mercatorZfromZoom(u){return this.cameraToCenterDistance/this._worldSizeFromZoom(u)}_minimumHeightOverTerrain(){const u=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(u)}_zoomFromMercatorZ(u){return this.scaleZoom(this.cameraToCenterDistance/(u*this.tileSize))}zoomFromMercatorZAdjusted(u){let m=0,w=a.bU,I=0,P=1/0;for(;w-m>1e-6&&w>m;){const F=m+.5*(w-m),W=this.tileSize*Math.pow(2,F),q=this.getCameraToCenterDistance(this.projection,F,W),J=this.scaleZoom(q/(u*this.tileSize)),ee=Math.abs(F-J);ee<P&&(P=ee,I=F),F<J?m=F:w=F}return I}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(u,m){const w=Math.min(u.x,m.x),I=Math.max(u.x,m.x),P=Math.min(u.y,m.y),F=Math.max(u.y,m.y);if(P<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const W=[new a.P(w,P),new a.P(I,F),new a.P(w,F),new a.P(I,P)],q=this.renderWorldCopies?-3:0,J=this.renderWorldCopies?4:1;for(const ee of W){const ae=this.pointRayIntersection(ee);if(ae.t<0)return!0;const le=this.rayIntersectionCoordinate(ae);if(le.x<q||le.y<0||le.x>J||le.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.c0(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.P(0,0),new a.P(this.width,this.height))}zoomDeltaToMovement(u,m){const w=a.a6.vec3.length(a.a6.vec3.sub([],this._camera.position,u)),I=this._zoomFromMercatorZ(w)+m;return w-this._mercatorZfromZoom(I)}getCameraPoint(){if(this.projection.name==="globe"){const u=function([m,w,I],P){const F=[m,w,I,1];a.a6.vec4.transformMat4(F,F,P);const W=F[3]=Math.max(F[3],1e-6);return F[0]/=W,F[1]/=W,F[2]/=W,F}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.P(u[0],u[1])}{const u=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.P(0,u))}}getCameraToCenterDistance(u,m=this.zoom,w=this.worldSize){const I=a.bX(u,m,this.width,this.height,1024),P=u.pixelSpaceConversion(this.center.lat,w,I);let F=.5/Math.tan(.5*this._fov)*this.height*P;return this.isOrthographic&&(F=qh(1,F,Zh(this.pitch>=15?1:this.pitch/15))),F}getWorldToCameraMatrix(){const u=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.a6.mat4.multiply(u,u,this.globeMatrix),u}getFrustum(u){return a.bN.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,this.projection.zAxisUnit==="meters")}}const ic=(b,u)=>{if(u>0&&b.terrain&&a.w("Cutoff is currently disabled on terrain"),u<=0||b.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const m=b.transform,w=Math.max(Math.abs(m._zoom-(b.minCutoffZoom-1)),1),I=m.isLODDisabled(!1)?a.a7(60,45,m.pitch):a.a7(30,15,m.pitch),P=m._farZ-m._nearZ,F=u*m.height,W=((1-(q=I))*m.cameraToCenterDistance+q*(m._farZ+F))*w;var q;return{shouldRenderCutoff:I<1,uniformValues:{u_cutoff_params:[m._nearZ,m._farZ,(W-m._nearZ)/P,(W-F-m._nearZ)/P]}}},xs={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Yh{constructor(u,m){this.aabb=u,this.lastCascade=m}}class yn{add(u,m){const w=this.receivers[u.key];w!==void 0?(w.aabb.min[0]=Math.min(w.aabb.min[0],m.min[0]),w.aabb.min[1]=Math.min(w.aabb.min[1],m.min[1]),w.aabb.min[2]=Math.min(w.aabb.min[2],m.min[2]),w.aabb.max[0]=Math.max(w.aabb.max[0],m.max[0]),w.aabb.max[1]=Math.max(w.aabb.max[1],m.max[1]),w.aabb.max[2]=Math.max(w.aabb.max[2],m.max[2])):this.receivers[u.key]=new Yh(m,null)}clear(){this.receivers={}}get(u){return this.receivers[u.key]}computeRequiredCascades(u,m,w){const I=a.c9.fromPoints(u.points);let P=0;for(const F in this.receivers){const W=this.receivers[F];if(!W||!I.intersectsAabb(W.aabb))continue;W.aabb.min=I.closestPoint(W.aabb.min),W.aabb.max=I.closestPoint(W.aabb.max);const q=W.aabb.getCorners();for(let J=0;J<w.length;J++){let ee=!0;for(const ae of q){const le=[ae[0]*m,ae[1]*m,ae[2]];if(a.a6.vec3.transformMat4(le,le,w[J].matrix),le[0]<-1||le[0]>1||le[1]<-1||le[1]>1){ee=!1;break}}if(W.lastCascade=J,P=Math.max(P,J),ee)break}}return P+1}}class dg{constructor(u){this.painter=u,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new yn,this._depthMode=new Xn(u.context.gl.LEQUAL,Xn.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,u.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),u.tp.registerParameter(xs,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),u.tp.registerParameter(xs,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),u.tp.registerParameter(xs,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),u.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const u of this._cascades)u.texture.destroy(),u.framebuffer.destroy();this._cascades=[]}updateShadowParameters(u,m){const w=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!m||!m.properties)return;const I=m.properties.get("shadow-intensity");if(!m.shadowsEnabled()||I<=0||(this._shadowLayerCount=w.style.order.reduce((ve,ye)=>{const be=w.style._mergedLayers[ye];return ve+(be.hasShadowPass()&&!be.isHidden(u.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const P=w.context,F=xs.shadowMapResolution,W=xs.shadowMapResolution;if(this._cascades.length===0||xs.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ve=0;ve<xs.cascadeCount;++ve){const ye=w._shadowMapDebug,be=P.gl,we=P.createFramebuffer(F,W,ye,"texture"),ke=new a.T(P,{width:F,height:W,data:null},be.DEPTH_COMPONENT16);if(we.depthAttachment.set(ke.texture),ye){const Ne=new a.T(P,{width:F,height:W,data:null},be.RGBA8);we.colorAttachment.set(Ne.texture)}this._cascades.push({framebuffer:we,texture:ke,matrix:[],far:0,boundingSphereRadius:0,frustum:new a.bN,scale:0})}}this.shadowDirection=Kh(m);let q=0;if(u.elevation){const ve=u.elevation,ye=[1e4,-1e4];ve.visibleDemTiles.filter(be=>be.dem).forEach(be=>{const we=be.dem.tree;ye[0]=Math.min(ye[0],we.minimums[0]),ye[1]=Math.max(ye[1],we.maximums[0])}),ye[0]!==1e4&&(q=(ye[1]-ye[0])*ve.exaggeration())}const J=1.5*u.cameraToCenterDistance,ee=3*J,ae=new Float64Array(16);for(let ve=0;ve<this._cascades.length;++ve){const ye=this._cascades[ve];let be=u.height/50,we=1;xs.cascadeCount===1?we=ee:ve===0?we=J:(be=J,we=ee);const[ke,Ne]=Op(u,this.shadowDirection,be,we,xs.shadowMapResolution,q);ye.scale=u.scale,ye.matrix=ke,ye.boundingSphereRadius=Ne,a.a6.mat4.invert(ae,ye.matrix),ye.frustum=a.bN.fromInvProjectionMatrix(ae,1,0,!0),ye.far=we}const le=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[le].far,this._cascades[le].far],this._uniformValues.u_shadow_intensity=I,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/xs.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=xs.shadowMapResolution,this._uniformValues.u_shadowmap_0=la.ShadowMap0,this._uniformValues.u_shadowmap_1=la.ShadowMap0+1,this._groundShadowTiles=w.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const ue=w.transform.elevation;for(const ve of this._groundShadowTiles){let ye={min:0,max:0};if(ue){const be=ue.getMinMaxForTile(ve);be&&(ye=be)}this.addShadowReceiver(ve.toUnwrapped(),ye.min,ye.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(u){this._enabled=u}drawShadowPass(u,m){if(!this.enabled)return;const w=this.painter,I=w.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(w.transform.getFrustum(0),w.transform.worldSize,this._cascades),I.viewport.set([0,0,xs.shadowMapResolution,xs.shadowMapResolution]);for(let P=0;P<this._numCascadesToRender;++P){w.currentShadowCascade=P,I.bindFramebuffer.set(this._cascades[P].framebuffer.framebuffer),I.clear({color:a.bz.white,depth:1});for(const F of u.order){const W=u._mergedLayers[F];if(!W.hasShadowPass()||W.isHidden(w.transform.zoom))continue;const q=u.getLayerSourceCache(W),J=q?m[q.id]:void 0;(W.type==="model"||J&&J.length)&&w.renderLayer(w,q,W,J)}}w.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const u=this.painter,m=u.style,w=u.context,I=m.directionalLight,P=m.ambientLight;if(!I||!P)return;const F=[],W=ic(u,u.longestCutoffRange);W.shouldRenderCutoff&&F.push("RENDER_CUTOFF");const q=kp(m,I,P),J=new Xn(w.gl.LEQUAL,Xn.ReadOnly,u.depthRangeFor3D);for(const ee of this._groundShadowTiles){const ae=ee.toUnwrapped(),le=u.isTileAffectedByFog(ee),ue=u.getOrCreateProgram("groundShadow",{defines:F,overrideFog:le});this.setupShadows(ae,ue),u.uploadCommonUniforms(w,ue,ae,null,W);const ve={u_matrix:u.transform.calculateProjMatrix(ae),u_ground_shadow_factor:q};ue.draw(u,w.gl.TRIANGLES,J,pr.disabled,Mr.multiply,_r.disabled,ve,"ground_shadow",u.tileExtentBuffer,u.quadTriangleIndexBuffer,u.tileExtentSegments,{},u.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Mr.unblended:Mr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(u){const m=this.painter.transform,w=m.calculatePosMatrix(u,m.worldSize);return a.a6.mat4.multiply(w,this._cascades[this.painter.currentShadowCascade].matrix,w),Float32Array.from(w)}calculateShadowPassMatrixFromMatrix(u){return a.a6.mat4.multiply(u,this._cascades[this.painter.currentShadowCascade].matrix,u),Float32Array.from(u)}setupShadows(u,m,w,I=0){if(!this.enabled)return;const P=this.painter.transform,F=this.painter.context,W=F.gl,q=this._uniformValues,J=new Float64Array(16),ee=P.calculatePosMatrix(u,P.worldSize);for(let ae=0;ae<this._cascades.length;ae++)a.a6.mat4.multiply(J,this._cascades[ae].matrix,ee),q[ae===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(J),F.activeTexture.set(W.TEXTURE0+la.ShadowMap0+ae),this._cascades[ae].texture.bind(W.NEAREST,W.CLAMP_TO_EDGE);if(this.useNormalOffset=!!w,this.useNormalOffset){const ae=a.c8(u.canonical),le=2/P.tileSize*a.ab/xs.shadowMapResolution,ue=le*this._cascades[0].boundingSphereRadius,ve=le*this._cascades[this._cascades.length-1].boundingSphereRadius,ye=(w==="vector-tile"?1:3)/Math.pow(2,I-u.canonical.z-(1-P.zoom+Math.floor(P.zoom)));q.u_shadow_normal_offset=[ae,ue*ye,ve*ye],q.u_shadow_bias=[6e-5,.0012,.012]}else q.u_shadow_bias=[36e-5,.0012,.012];m.setShadowUniformValues(F,q)}setupShadowsFromMatrix(u,m,w=!1){if(!this.enabled)return;const I=this.painter.context,P=I.gl,F=this._uniformValues,W=new Float64Array(16);for(let q=0;q<xs.cascadeCount;q++)a.a6.mat4.multiply(W,this._cascades[q].matrix,u),F[q===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(W),I.activeTexture.set(P.TEXTURE0+la.ShadowMap0+q),this._cascades[q].texture.bind(P.NEAREST,P.CLAMP_TO_EDGE);if(this.useNormalOffset=w,w){const q=xs.normalOffset;F.u_shadow_normal_offset=[1,q,q],F.u_shadow_bias=[6e-5,.0012,.012]}else F.u_shadow_bias=[36e-5,.0012,.012];m.setShadowUniformValues(I,F)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(u,m,w,I){if(I[2]>=0)return{};const P=function(q,J,ee){const ae=ee/(1<<q.canonical.z);return new a.c9([q.canonical.x*ae+q.wrap*ee,q.canonical.y*ae+q.wrap*ee,0],[(q.canonical.x+1)*ae+q.wrap*ee,(q.canonical.y+1)*ae+q.wrap*ee,J])}(u,m,w).getCorners(),F=m/-I[2];I[0]<0?(a.a6.vec3.add(P[0],P[0],[I[0]*F,0,0]),a.a6.vec3.add(P[3],P[3],[I[0]*F,0,0])):I[0]>0&&(a.a6.vec3.add(P[1],P[1],[I[0]*F,0,0]),a.a6.vec3.add(P[2],P[2],[I[0]*F,0,0])),I[1]<0?(a.a6.vec3.add(P[0],P[0],[0,I[1]*F,0]),a.a6.vec3.add(P[1],P[1],[0,I[1]*F,0])):I[1]>0&&(a.a6.vec3.add(P[2],P[2],[0,I[1]*F,0]),a.a6.vec3.add(P[3],P[3],[0,I[1]*F,0]));const W={};return W.vertices=P,W.planes=[zc(P[1],P[0],P[4]),zc(P[2],P[1],P[5]),zc(P[3],P[2],P[6]),zc(P[0],P[3],P[7])],W}addShadowReceiver(u,m,w){this._receivers.add(u,a.c9.fromTileIdAndHeight(u,m,w))}getMaxCascadeForTile(u){const m=this._receivers.get(u);return m&&m.lastCascade?m.lastCascade:0}}function zc(b,u,m){const w=a.a6.vec3.sub([],m,u),I=a.a6.vec3.sub([],b,u),P=a.a6.vec3.cross([],w,I),F=a.a6.vec3.length(P);return F===0?[0,0,1,0]:(a.a6.vec3.scale(P,P,1/F),[P[0],P[1],P[2],-a.a6.vec3.dot(P,u)])}function Kh(b){const u=b.properties.get("direction"),m=a.c7(u.x,u.y,u.z);m[2]=a.ap(m[2],0,75);const w=a.ca([m[0],m[1],m[2]]);return a.a6.vec3.fromValues(w.x,w.y,w.z)}function kp(b,u,m){const w=u.properties.get("color"),I=u.properties.get("intensity"),P=u.properties.get("direction"),F=[P.x,P.y,P.z],W=m.properties.get("color"),q=m.properties.get("intensity"),J=Math.max(a.a6.vec3.dot([0,0,1],F),0),ee=[0,0,0];a.a6.vec3.scale(ee,W.toRenderColor(b.getLut(u.scope)).toArray01Linear().slice(0,3),q);const ae=[0,0,0];return a.a6.vec3.scale(ae,w.toRenderColor(b.getLut(m.scope)).toArray01Linear().slice(0,3),J*I),a.cb([ee[0]>0?ee[0]/(ee[0]+ae[0]):0,ee[1]>0?ee[1]/(ee[1]+ae[1]):0,ee[2]>0?ee[2]/(ee[2]+ae[2]):0])}function Op(b,u,m,w,I,P){const F=b.zoom,W=b.scale,q=b.worldSize,J=1/q,ee=b.aspect,ae=Math.sqrt(1+ee*ee)*Math.tan(.5*b.fovX),le=ae*ae,ue=w-m,ve=w+m;let ye,be;le>ue/ve?(ye=w,be=w*ae):(ye=.5*ve*(1+le),be=.5*Math.sqrt(ue*ue+2*(w*w+m*m)*le+ve*ve*le*le));const we=b.projection.pixelsPerMeter(b.center.lat,q),ke=b._camera.getCameraToWorldMercator(),Ne=[0,0,-ye*J];a.a6.vec3.transformMat4(Ne,Ne,ke);let De=be*J;const $e=b._edgeInsets;if(!($e.left===0&&$e.top===0&&$e.right===0&&$e.bottom===0||$e.left===$e.right&&$e.top===$e.bottom)){const fn=b._camera.getWorldToCamera(b.worldSize,b.projection.zAxisUnit==="meters"?we:1),pn=b._camera.getCameraToClipPerspective(b._fov,b.width/b.height,m,w);pn[8]=2*-b.centerOffset.x/b.width,pn[9]=2*b.centerOffset.y/b.height;const qt=new Float64Array(16);a.a6.mat4.mul(qt,pn,fn);const en=new Float64Array(16);a.a6.mat4.invert(en,qt);const er=a.bN.fromInvProjectionMatrix(en,q,F,!0);for(const xn of er.points){const Dn=((je=xn)[0]/=W,je[1]/=W,je[2]=a.bD(je[2],b._center.lat),je);De=Math.max(De,a.a6.vec3.len(a.a6.vec3.subtract([],Ne,Dn)))}}var je;De*=I/(I-1);const et=Math.acos(u[2]),Ke=Math.atan2(-u[0],-u[1]),tt=new ns;tt.position=Ne,tt.setPitchBearing(et,Ke);const ut=tt.getWorldToCamera(q,we),at=De*q,rt=Math.min(b._mercatorZfromZoom(17)*q*-2,-2*at),bt=tt.getCameraToClipOrthographic(-at,at,-at,at,rt,(at+P*we)/u[2]),Ft=new Float64Array(16);a.a6.mat4.multiply(Ft,bt,ut);const Zt=a.a6.vec3.fromValues(Math.floor(1e6*Ne[0])/1e6*q,Math.floor(1e6*Ne[1])/1e6*q,0),kt=.5*I,hn=[0,0,0];a.a6.vec3.transformMat4(hn,Zt,Ft),a.a6.vec3.scale(hn,hn,kt);const wt=[Math.floor(hn[0]),Math.floor(hn[1]),Math.floor(hn[2])],Wt=[0,0,0];a.a6.vec3.sub(Wt,hn,wt),a.a6.vec3.scale(Wt,Wt,-1/kt);const Gt=new Float64Array(16);return a.a6.mat4.identity(Gt),a.a6.mat4.translate(Gt,Gt,Wt),a.a6.mat4.multiply(Ft,Gt,Ft),[Ft,at]}class Ko extends a.E{constructor(u){super(),this.requestManager=u,this.models={"":{}},this.numModelsLoading={}}loadModel(u,m){return a.aG(this.requestManager.transformRequest(m,a.R.Model).url).then(w=>{if(!w)return;const I=a.aH(w),P=new a.aI(u,void 0,void 0,I);return P.computeBoundsAndApplyParent(),P}).catch(w=>{if(w&&w.status===404)return null;this.fire(new a.t(new Error(`Could not load model ${u} from ${m}: ${w.message}`)))})}load(u,m){this.models[m]||(this.models[m]={});const w=Object.keys(u);this.numModelsLoading[m]=(this.numModelsLoading[m]||0)+w.length;const I=[];for(const P of w)I.push(this.loadModel(P,u[P]));Promise.allSettled(I).then(P=>{for(let F=0;F<P.length;F++){const{status:W,value:q}=P[F];W==="fulfilled"&&q&&(this.models[m][w[F]]={model:q,numReferences:1})}this.numModelsLoading[m]-=w.length,this.fire(new a.x("data",{dataType:"style"}))}).catch(P=>{this.fire(new a.t(new Error(`Could not load models: ${P.message}`)))})}isLoaded(){for(const u in this.numModelsLoading)if(this.numModelsLoading[u]>0)return!1;return!0}hasModel(u,m){return!!this.getModel(u,m)}getModel(u,m){return this.models[m]||(this.models[m]={}),this.models[m][u]?this.models[m][u].model:void 0}addModel(u,m,w){this.models[w]||(this.models[w]={}),this.hasModel(u,w)&&this.models[w][u].numReferences++,this.load({[u]:this.requestManager.normalizeModelURL(m)},w)}addModels(u,m){this.models[m]||(this.models[m]={});const w={};for(const I in u)this.models[m][I]={},w[I]=this.requestManager.normalizeModelURL(u[I]);this.load(w,m)}addModelsFromBucket(u,m){this.models[m]||(this.models[m]={});const w={};for(const I of u)this.hasModel(I,m)?this.models[m][I].numReferences++:w[I]=this.requestManager.normalizeModelURL(I);this.load(w,m)}removeModel(u,m){if(this.models[m]&&this.models[m][u]&&(this.models[m][u].numReferences--,this.models[m][u].numReferences===0)){const w=this.models[m][u].model;delete this.models[m][u],w.destroy()}}listModels(u){return this.models[u]||(this.models[u]={}),Object.keys(this.models[u])}upload(u,m){this.models[m]||(this.models[m]={});for(const w in this.models[m])this.models[m][w].model&&this.models[m][w].model.upload(u.context)}}const pg=new a.a0({data:new a.a1(a._.colorTheme.data)}),oo=(b,u)=>pt(b,u&&u.filter(m=>m.identifier!=="source.canvas")),Oo=a.ar(si,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera","addImport","removeImport","updateImport"]),Uc=a.ar(si,["setCenter","setZoom","setBearing","setPitch"]),Jh={version:8,layers:[],sources:{}},sc={duration:300,delay:0};class Fo extends a.E{constructor(u,m={}){super(),this.map=u,this.scope=m.scope||"",this.globalId=null,this.fragments=[],this.importDepth=m.importDepth||0,this.importsCache=m.importsCache||new Map,this.resolvedImports=m.resolvedImports||new Set,this.transition=a.l({},sc),this._buildingIndex=new Ip(this),this.crossTileSymbolIndex=new Xh,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=m.styleChanges||new cn,this.dispatcher=m.dispatcher?m.dispatcher:new a.cd(a.ce(),this),m.imageManager?this.imageManager=m.imageManager:(this.imageManager=new Jt,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=m.glyphManager?m.glyphManager:new a.cf(u._requestManager,m.localFontFamily?a.cg.all:m.localIdeographFontFamily?a.cg.ideographs:a.cg.none,m.localFontFamily||m.localIdeographFontFamily),m.modelManager?this.modelManager=m.modelManager:(this.modelManager=new Ko(u._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null},this._styleColorThemeForScope={},this.options=m.configOptions?m.configOptions:new Map,this._configDependentLayers=m.configDependentLayers?m.configDependentLayers:new Set,this._config=m.config,this._initialConfig=m.initialConfig,this.dispatcher.broadcast("setReferrer",a.ch());const w=this;this._rtlTextPluginCallback=Fo.registerForPluginStateChange(I=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:I.pluginStatus,pluginURL:I.pluginURL},(P,F)=>{if(a.ci(P),F&&F.every(W=>W))for(const W in w._sourceCaches){const q=w._sourceCaches[W],J=q.getSource().type;J!=="vector"&&J!=="geojson"||q.reload()}})}),this.on("data",I=>{if(I.dataType!=="source"||I.sourceDataType!=="metadata")return;const P=this.getOwnSource(I.sourceId);if(P&&P.vectorLayerIds)for(const F in this._layers){const W=this._layers[F];W.source===P.id&&this._validateLayer(W)}})}load(u){return u?(typeof u=="string"?this.loadURL(u):this.loadJSON(u),this):this}_getGlobalId(u){if(!u)return null;if(typeof u=="string"){if(a.f(u))return u;const m=a.cj(u);if(!m.startsWith("http"))try{return new URL(m,location.href).toString()}catch{return m}return m}return`json://${a.ck(JSON.stringify(u))}`}_diffStyle(u,m,w){this.globalId=this._getGlobalId(u);const I=(P,F)=>{try{F(null,this.setState(P,w))}catch(W){F(W,!1)}};if(typeof u=="string"){const P=this.map._requestManager.normalizeStyleURL(u),F=this.map._requestManager.transformRequest(P,a.R.Style);a.n(F,(W,q)=>{W?this.fire(new a.t(W)):q&&I(q,m)})}else typeof u=="object"&&I(u,m)}loadURL(u,m={}){this.fire(new a.x("dataloading",{dataType:"style"}));const w=typeof m.validate=="boolean"?m.validate:!a.f(u);this.globalId=this._getGlobalId(u),u=this.map._requestManager.normalizeStyleURL(u,m.accessToken),this.resolvedImports.add(u);const I=this.importsCache.get(u);if(I)return this._load(I,w);const P=this.map._requestManager.transformRequest(u,a.R.Style);this._request=a.n(P,(F,W)=>{if(this._request=null,F)this.fire(new a.t(F));else if(W)return this.importsCache.set(u,W),this._load(W,w)})}loadJSON(u,m={}){this.fire(new a.x("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(u),this._request=a.q.frame(()=>{this._request=null,this._load(u,m.validate!==!1)})}loadEmpty(){this.fire(new a.x("dataloading",{dataType:"style"})),this._load(Jh,!1)}_loadImports(u,m,w){if(this.importDepth>=4)return a.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const I=[];for(const P of u){const F=this._createFragmentStyle(P),W=new Promise(ee=>{F.once("style.import.load",ee),F.once("error",ee)}).then(()=>this.mergeAll());if(I.push(W),this.resolvedImports.has(P.url)){F.loadEmpty();continue}const q=P.data||this.importsCache.get(P.url);q?(F.loadJSON(q,{validate:m}),this._isInternalStyle(q)&&(F.globalId=null)):P.url?F.loadURL(P.url,{validate:m}):F.loadEmpty();const J={style:F,id:P.id,config:P.config};if(w){const ee=this.fragments.findIndex(({id:ae})=>ae===w);this.fragments=this.fragments.slice(0,ee).concat(J).concat(this.fragments.slice(ee))}else this.fragments.push(J)}return Promise.allSettled(I)}getImportGlobalIds(u=this,m=new Set){for(const w of u.fragments)w.style.globalId&&m.add(w.style.globalId),this.getImportGlobalIds(w.style,m);return[...m.values()]}_createFragmentStyle(u){const m=this.scope?a.av(u.id,this.scope):u.id;let w;const I=this._initialConfig&&this._initialConfig[m];(u.config||I)&&(w=a.l({},u.config,I));const P=new Fo(this.map,{scope:m,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:w,configOptions:this.options,configDependentLayers:this._configDependentLayers});return P.setEventedParent(this.map,{style:P}),P}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(u){return this.isRootStyle()&&(u.fragment||!!u.schema&&u.fragment!==!1)}_load(u,m){const w=u.schema;if(this._isInternalStyle(u)){const F=a.l({},Jh,{imports:[{id:"basemap",data:u,url:""}]});return void this._load(F,m)}if(this.updateConfig(this._config,w),m&&oo(this,Cn(u)))return;this._loaded=!0,this.stylesheet=a.cl(u);const I=()=>{for(const J in u.sources)this.addSource(J,u.sources[J],{validate:!1,isInitialLoad:!0});u.sprite?this._loadSprite(u.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(u.glyphs,this.scope);const F=Hh(this.stylesheet.layers);if(this._order=F.map(J=>J.id),this.stylesheet.light&&a.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const J=this.stylesheet.lights[0];this.light=new gt(J.properties,J.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new gt(this.stylesheet.light)),this._layers={},this._serializedLayers={};for(const J of F){const ee=a.cq(J,this.scope,this._styleColorTheme.lut,this.options);ee.configDependencies.size!==0&&this._configDependentLayers.add(ee.fqid),ee.setEventedParent(this,{layer:{id:ee.id}}),this._layers[ee.id]=ee,this._serializedLayers[ee.id]=ee.serialize();const ae=this.getOwnLayerSourceCache(ee),le=!!this.directionalLight&&this.directionalLight.shadowsEnabled();ae&&ee.canCastShadows()&&le&&(ae.castsShadows=!0)}this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const W=this.stylesheet.terrain;W&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(W,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new a.x("data",{dataType:"style"}));const q=this.isRootStyle();u.imports?this._loadImports(u.imports,m).then(()=>{this._reloadImports(),this.fire(new a.x(q?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new a.x(q?"style.load":"style.import.load")))},P=this.stylesheet["color-theme"];if(this._styleColorTheme.colorTheme=P,P){const F=this._evaluateColorThemeData(P);this._loadColorTheme(F).then(()=>{I()}).catch(W=>{a.w(`Couldn't load color theme from the stylesheet: ${W}`),I()})}else this._styleColorTheme.lut=null,I()}isRootStyle(){return this.importDepth===0}mergeAll(){let u,m,w,I,P,F,W,q;const J={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(ee=>{if(ee.stylesheet){if(ee.light!=null&&(u=ee.light),ee.stylesheet.lights)for(const ae of ee.stylesheet.lights)ae.type==="ambient"&&ee.ambientLight!=null&&(m=ee.ambientLight),ae.type==="directional"&&ee.directionalLight!=null&&(w=ee.directionalLight);I=this._prioritizeTerrain(I,ee.terrain,ee.stylesheet.terrain),ee.stylesheet.fog&&ee.fog!=null&&(P=ee.fog),ee.stylesheet.camera!=null&&(q=ee.stylesheet.camera),ee.stylesheet.projection!=null&&(F=ee.stylesheet.projection),ee.stylesheet.transition!=null&&(W=ee.stylesheet.transition),J[ee.scope]=ee._styleColorTheme}}),this.light=u,this.ambientLight=m,this.directionalLight=w,this.fog=P,this._styleColorThemeForScope=J,I===null?delete this.terrain:this.terrain=I,this.camera=q||{"camera-projection":"perspective"},this.projection=F||{name:"mercator"},this.transition=a.l({},sc,W),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(u){const m=w=>{for(const I of w.fragments)m(I.style);u(w)};m(this)}_prioritizeTerrain(u,m,w){const I=u&&u.drapeRenderMode===0;return w===null?m&&m.drapeRenderMode===0?m:I?u:null:m!=null&&(!u||I||m&&m.drapeRenderMode===1)?m:u}mergeTerrain(){let u;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(m=>{u=this._prioritizeTerrain(u,m.terrain,m.stylesheet.terrain)}),u===null?delete this.terrain:this.terrain=u}mergeProjection(){let u;this.forEachFragmentStyle(m=>{m.stylesheet.projection!=null&&(u=m.stylesheet.projection)}),this.projection=u||{name:"mercator"}}mergeSources(){const u={},m={},w={};this.forEachFragmentStyle(I=>{for(const P in I._sourceCaches){const F=a.av(P,I.scope);u[F]=I._sourceCaches[P]}for(const P in I._otherSourceCaches){const F=a.av(P,I.scope);m[F]=I._otherSourceCaches[P]}for(const P in I._symbolSourceCaches){const F=a.av(P,I.scope);w[F]=I._symbolSourceCaches[P]}}),this._mergedSourceCaches=u,this._mergedOtherSourceCaches=m,this._mergedSymbolSourceCaches=w}mergeLayers(){const u={},m=[],w={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(P=>{for(const F of P._order){const W=P._layers[F];if(W.type==="slot"){const q=a.cm(F);if(u[q])continue;u[q]=[]}W.slot&&u[W.slot]?u[W.slot].push(W):m.push(W)}}),this._mergedOrder=[];const I=(P=[])=>{for(const F of P)if(F.type==="slot"){const W=a.cm(F.id);u[W]&&I(u[W]),this._mergedSlots.push(W)}else{const W=a.av(F.id,F.scope);this._mergedOrder.push(W),w[W]=F,F.is3D()&&(this._has3DLayers=!0),F.type==="circle"&&(this._hasCircleLayers=!0),F.type==="symbol"&&(this._hasSymbolLayers=!0),F.type==="clip"&&(this._clipLayerPresent=!0)}};I(m),this._mergedOrder.sort((P,F)=>{const W=w[P],q=w[F];return W.hasInitialOcclusionOpacityProperties?q.is3D()?1:0:W.is3D()&&q.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=w,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(u){return this.stylesheet.camera=a.l({},this.stylesheet.camera,u),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(u){return u.data?function(m,w,I){const P=a.l({},w);for(const W of Object.keys(a._.colorTheme))P[W]===void 0&&(P[W]=a._.colorTheme[W].default);const F=new a.$(pg,m,new Map(I));return F.setTransitionOrValue(P,I),F.untransitioned().possiblyEvaluate(new a.a3(0))}(this.scope,u,this.options).get("data"):null}_loadColorTheme(u){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const m=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((w,I)=>{const P="data:image/png;base64,";if(!u||u.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void w();let F=u;F.startsWith(P)||(F=P+F);const W="mapbox-reserved-lut",q=new Image;q.src=F,q.onerror=()=>{this._styleColorTheme.lutLoading=!1,I(new Error("Failed to load image data"))},q.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==m)return void w();this._styleColorTheme.lutLoading=!1;const{width:J,height:ee,data:ae}=a.q.getImageData(q);if(ee>32)return void I(new Error("The height of the image must be less than or equal to 32 pixels."));if(J!==ee*ee)return void I(new Error("The width of the image must be equal to the height squared."));this.getImage(W)&&this.removeImage(W),this.addImage(W,{data:new a.r({width:J,height:ee},ae),pixelRatio:1,sdf:!1,version:0});const le=this.imageManager.getImage(W,this.scope);le?(this._styleColorTheme.lut={image:le.data,data:u},w()):I(new Error("Missing LUT image."))}})}getLut(u){const m=this._styleColorThemeForScope[u];return m?m.lut:null}setProjection(u){u?this.stylesheet.projection=u:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(u){this._spriteRequest=function(m,w,I){let P,F,W;const q=a.q.devicePixelRatio>1?"@2x":"";let J=a.n(w.transformRequest(w.normalizeSpriteURL(m,q,".json"),a.R.SpriteJSON),(le,ue)=>{J=null,W||(W=le,P=ue,ae())}),ee=a.o(w.transformRequest(w.normalizeSpriteURL(m,q,".png"),a.R.SpriteImage),(le,ue)=>{ee=null,W||(W=le,F=ue,ae())});function ae(){if(W)I(W);else if(P&&F){const le=a.q.getImageData(F),ue={};for(const ve in P){const{width:ye,height:be,x:we,y:ke,sdf:Ne,pixelRatio:De,stretchX:$e,stretchY:je,content:et}=P[ve],Ke=new a.r({width:ye,height:be});a.r.copy(le,Ke,{x:we,y:ke},{x:0,y:0},{width:ye,height:be},null),ue[ve]={data:Ke,pixelRatio:De,sdf:Ne,stretchX:$e,stretchY:je,content:et}}I(null,ue)}}return{cancel(){J&&(J.cancel(),J=null),ee&&(ee.cancel(),ee=null)}}}(u,this.map._requestManager,(m,w)=>{if(this._spriteRequest=null,m)this.fire(new a.t(m));else if(w)for(const I in w)this.imageManager.addImage(I,this.scope,w[I]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new a.x("data",{dataType:"style"}))})}_validateLayer(u){const m=this.getOwnSource(u.source);if(!m)return;const w=u.sourceLayer;w&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(w)===-1)&&this.fire(new a.t(new Error(`Source layer "${w}" does not exist on source "${m.id}" as specified by style layer "${u.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const u in this._sourceCaches)if(!this._sourceCaches[u].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:u}of this.fragments)if(!u.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((u,m)=>{const w=this.fragments[m];return w&&w.style&&(u.data=w.style.serialize()),u})}_serializeSources(){const u={};for(const m in this._sourceCaches){const w=this._sourceCaches[m].getSource();u[w.id]||(u[w.id]=w.serialize())}return u}_serializeLayers(u){const m=[];for(const w of u){const I=this._layers[w];I&&I.type!=="custom"&&m.push(I.serialize())}return m}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition())return!0;for(const u in this._sourceCaches)if(this._sourceCaches[u].hasTransition())return!0;for(const u in this._layers)if(this._layers[u].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}isLayerDraped(u){return!!this.terrain&&u.isDraped(this.getLayerSourceCache(u))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(u){const m=this.getOwnLayer(u);if(m)return m;this.fire(new a.t(new Error(`The layer '${u}' does not exist in the map's style.`)))}_checkSource(u){const m=this.getOwnSource(u);if(m)return m;this.fire(new a.t(new Error(`The source '${u}' does not exist in the map's style.`)))}precompilePrograms(u,m){const w=this.map.painter;if(w)for(let I=u.minzoom||0;I<(u.maxzoom||25.5);I++){const P=u.getProgramIds();if(P)for(const F of P){const W=u.getDefaultProgramParams(F,m.zoom,this._styleColorTheme.lut);W&&(w.style=this,this.fog&&(w._fogVisible=!0,W.overrideFog=!0,w.getOrCreateProgram(F,W)),w._fogVisible=!1,W.overrideFog=!1,w.getOrCreateProgram(F,W),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(W.overrideRtt=!0,w.getOrCreateProgram(F,W)))}}}update(u){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(u),this.directionalLight&&this.directionalLight.recalculate(u);const m=this.calculateLightsBrightness();u.brightness=m||0,m!==this._brightness&&(this._brightness=m,this.dispatcher.broadcast("setBrightness",m));const w=this._changes.isDirty();let I=!1;if(this._changes.isDirty()){const F=this._changes.getLayerUpdatesByScope();for(const W in F){const{updatedIds:q,removedIds:J}=F[W];(q||J)&&(this._updateWorkerLayers(W,q,J),I=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(u),this.light&&this.light.updateTransitions(u),this.ambientLight&&this.ambientLight.updateTransitions(u),this.directionalLight&&this.directionalLight.updateTransitions(u),this.fog&&this.fog.updateTransitions(u),this._changes.reset()}const P={};for(const F in this._mergedSourceCaches){const W=this._mergedSourceCaches[F];P[F]=W.used,W.used=!1,W.tileCoverLift=0}for(const F of this._mergedOrder){const W=this._mergedLayers[F];if(W.recalculate(u,this._availableImages),!W.isHidden(u.zoom)){const q=this.getLayerSourceCache(W);q&&(q.used=!0,q.tileCoverLift=Math.max(q.tileCoverLift,W.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(W,u)}):this.precompilePrograms(W,u))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&I&&this.mergeLayers();for(const F in P){const W=this._mergedSourceCaches[F];P[F]!==W.used&&W.getSource().fire(new a.x("data",{sourceDataType:"visibility",dataType:"source",sourceId:W.getSource().id}))}this.light&&this.light.recalculate(u),this.terrain&&this.terrain.recalculate(u),this.fog&&this.fog.recalculate(u),this.z=u.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),w&&this.fire(new a.x("data",{dataType:"style"}))}_updateTilesForChangedImages(){const u=this._changes.getUpdatedImages();if(u.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],u);this._changes.resetUpdatedImages()}}_updateWorkerLayers(u,m,w){const I=this.getFragmentStyle(u);I&&this.dispatcher.broadcast("updateLayers",{layers:m?I._serializeLayers(m):[],scope:u,removedIds:w||[],options:I.options})}setState(u,m){if(this._checkLoaded(),oo(this,Cn(u)))return!1;(u=a.cl(u)).layers=Hh(u.layers);const w=function(F,W){if(!F)return[{command:si.setStyle,args:[W]}];let q=[];try{if(!a.bh(F.version,W.version))return[{command:si.setStyle,args:[W]}];if(a.bh(F.center,W.center)||q.push({command:si.setCenter,args:[W.center]}),a.bh(F.zoom,W.zoom)||q.push({command:si.setZoom,args:[W.zoom]}),a.bh(F.bearing,W.bearing)||q.push({command:si.setBearing,args:[W.bearing]}),a.bh(F.pitch,W.pitch)||q.push({command:si.setPitch,args:[W.pitch]}),a.bh(F.sprite,W.sprite)||q.push({command:si.setSprite,args:[W.sprite]}),a.bh(F.glyphs,W.glyphs)||q.push({command:si.setGlyphs,args:[W.glyphs]}),a.bh(F.imports,W.imports)||function(ue=[],ve=[],ye){ve=ve||[];const be=(ue=ue||[]).map(jh),we=ve.map(jh),ke=ue.reduce(dd,{}),Ne=ve.reduce(dd,{}),De=be.slice();let $e,je,et,Ke;for($e=0,je=0;$e<be.length;$e++)et=be[$e],Ne.hasOwnProperty(et)?je++:(ye.push({command:si.removeImport,args:[et]}),De.splice(De.indexOf(et,je),1));for($e=0,je=0;$e<we.length;$e++)et=we[we.length-1-$e],De[De.length-1-$e]!==et&&(ke.hasOwnProperty(et)?(ye.push({command:si.removeImport,args:[et]}),De.splice(De.lastIndexOf(et,De.length-je),1)):je++,Ke=De[De.length-$e],ye.push({command:si.addImport,args:[Ne[et],Ke]}),De.splice(De.length-$e,0,et));for(const tt of ve){const ut=ke[tt.id];ut&&!a.bh(ut,tt)&&ye.push({command:si.updateImport,args:[tt.id,tt]})}}(F.imports,W.imports,q),a.bh(F.transition,W.transition)||q.push({command:si.setTransition,args:[W.transition]}),a.bh(F.light,W.light)||q.push({command:si.setLight,args:[W.light]}),a.bh(F.fog,W.fog)||q.push({command:si.setFog,args:[W.fog]}),a.bh(F.projection,W.projection)||q.push({command:si.setProjection,args:[W.projection]}),a.bh(F.lights,W.lights)||q.push({command:si.setLights,args:[W.lights]}),a.bh(F.camera,W.camera)||q.push({command:si.setCamera,args:[W.camera]}),!a.bh(F["color-theme"],W["color-theme"]))return[{command:si.setStyle,args:[W]}];const J={},ee=[];(function(ue,ve,ye,be){let we;for(we in ve=ve||{},ue=ue||{})ue.hasOwnProperty(we)&&(ve.hasOwnProperty(we)||vr(we,ye,be));for(we in ve){if(!ve.hasOwnProperty(we))continue;const ke=ve[we];ue.hasOwnProperty(we)?a.bh(ue[we],ke)||(ue[we].type==="geojson"&&ke.type==="geojson"&&cr(ue,ve,we)?ye.push({command:si.setGeoJSONSourceData,args:[we,ke.data]}):Rx(we,ve,ye,be)):Rp(we,ve,ye)}})(F.sources,W.sources,ee,J);const ae=[];F.layers&&F.layers.forEach(ue=>{ue.source&&J[ue.source]?q.push({command:si.removeLayer,args:[ue.id]}):ae.push(ue)});let le=F.terrain;le&&J[le.source]&&(q.push({command:si.setTerrain,args:[void 0]}),le=void 0),q=q.concat(ee),a.bh(le,W.terrain)||q.push({command:si.setTerrain,args:[W.terrain]}),function(ue,ve,ye){ve=ve||[];const be=(ue=ue||[]).map(jh),we=ve.map(jh),ke=ue.reduce(dd,{}),Ne=ve.reduce(dd,{}),De=be.slice(),$e=Object.create(null);let je,et,Ke,tt,ut,at,rt;for(je=0,et=0;je<be.length;je++)Ke=be[je],Ne.hasOwnProperty(Ke)?et++:(ye.push({command:si.removeLayer,args:[Ke]}),De.splice(De.indexOf(Ke,et),1));for(je=0,et=0;je<we.length;je++)Ke=we[we.length-1-je],De[De.length-1-je]!==Ke&&(ke.hasOwnProperty(Ke)?(ye.push({command:si.removeLayer,args:[Ke]}),De.splice(De.lastIndexOf(Ke,De.length-et),1)):et++,at=De[De.length-je],ye.push({command:si.addLayer,args:[Ne[Ke],at]}),De.splice(De.length-je,0,Ke),$e[Ke]=!0);for(je=0;je<we.length;je++)if(Ke=we[je],tt=ke[Ke],ut=Ne[Ke],!$e[Ke]&&!a.bh(tt,ut))if(a.bh(tt.source,ut.source)&&a.bh(tt["source-layer"],ut["source-layer"])&&a.bh(tt.type,ut.type)){for(rt in fd(tt.layout,ut.layout,ye,Ke,null,si.setLayoutProperty),fd(tt.paint,ut.paint,ye,Ke,null,si.setPaintProperty),a.bh(tt.slot,ut.slot)||ye.push({command:si.setSlot,args:[Ke,ut.slot]}),a.bh(tt.filter,ut.filter)||ye.push({command:si.setFilter,args:[Ke,ut.filter]}),a.bh(tt.minzoom,ut.minzoom)&&a.bh(tt.maxzoom,ut.maxzoom)||ye.push({command:si.setLayerZoomRange,args:[Ke,ut.minzoom,ut.maxzoom]}),tt)tt.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?fd(tt[rt],ut[rt],ye,Ke,rt.slice(6),si.setPaintProperty):a.bh(tt[rt],ut[rt])||ye.push({command:si.setLayerProperty,args:[Ke,rt,ut[rt]]}));for(rt in ut)ut.hasOwnProperty(rt)&&!tt.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?fd(tt[rt],ut[rt],ye,Ke,rt.slice(6),si.setPaintProperty):a.bh(tt[rt],ut[rt])||ye.push({command:si.setLayerProperty,args:[Ke,rt,ut[rt]]}))}else ye.push({command:si.removeLayer,args:[Ke]}),at=De[De.lastIndexOf(Ke)+1],ye.push({command:si.addLayer,args:[ut,at]})}(ae,W.layers,q)}catch(J){console.warn("Unable to compute style diff:",J),q=[{command:si.setStyle,args:[W]}]}return q}(this.serialize(),u).filter(F=>!(F.command in Uc));if(w.length===0)return!1;const I=w.filter(F=>!(F.command in Oo));if(I.length>0)throw new Error(`Unimplemented: ${I.map(F=>F.command).join(", ")}.`);const P=[];return w.forEach(F=>{P.push(this[F.command].apply(this,F.args))}),m&&Promise.all(P).then(m),this.stylesheet=u,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(u,m){return this.getImage(u)?this.fire(new a.t(new Error("An image with this name already exists."))):(this.imageManager.addImage(u,this.scope,m),this._afterImageUpdated(u),this)}updateImage(u,m){this.imageManager.updateImage(u,this.scope,m)}getImage(u){return this.imageManager.getImage(u,this.scope)}removeImage(u){return this.getImage(u)?(this.imageManager.removeImage(u,this.scope),this._afterImageUpdated(u),this):this.fire(new a.t(new Error("No image with this name exists.")))}_afterImageUpdated(u){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(u),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new a.x("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(u,m,w={}){return this._checkLoaded(),this._validate(nt,`models.${u}`,m,null,w)||(this.modelManager.addModel(u,m,this.scope),this._changes.setDirty()),this}hasModel(u){return this.modelManager.hasModel(u,this.scope)}removeModel(u){return this.hasModel(u)?(this.modelManager.removeModel(u,this.scope),this):this.fire(new a.t(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(u,m,w={}){if(this._checkLoaded(),this.getOwnSource(u)!==void 0)throw new Error(`There is already a source with ID "${u}".`);if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(Ar,`sources.${u}`,m,null,w))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const I=Yi(u,m,this.dispatcher,this);I.scope=this.scope,I.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(I.id),source:I.serialize(),sourceId:I.id}));const P=F=>{const W=(F?"symbol:":"other:")+I.id,q=a.av(W,this.scope),J=this._sourceCaches[W]=new Xa(q,I,F);(F?this._symbolSourceCaches:this._otherSourceCaches)[I.id]=J,J.onAdd(this.map)};P(!1),m.type!=="vector"&&m.type!=="geojson"||P(!0),I.onAdd&&I.onAdd(this.map),w.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(u){this._checkLoaded();const m=this.getOwnSource(u);if(!m)throw new Error("There is no source with this ID");for(const I in this._layers)if(this._layers[I].source===u)return this.fire(new a.t(new Error(`Source "${u}" cannot be removed while layer "${I}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===u)return this.fire(new a.t(new Error(`Source "${u}" cannot be removed while terrain is using it.`)));const w=this.getOwnSourceCaches(u);for(const I of w){const P=a.cm(I.id);delete this._sourceCaches[P],this._changes.discardSourceCacheUpdate(I.id),I.fire(new a.x("data",{sourceDataType:"metadata",dataType:"source",sourceId:I.getSource().id})),I.setEventedParent(null),I.clearTiles()}return delete this._otherSourceCaches[u],delete this._symbolSourceCaches[u],this.mergeSources(),m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(u,m){this._checkLoaded(),this.getOwnSource(u).setData(m),this._changes.setDirty()}getOwnSource(u){const m=this.getOwnSourceCache(u);return m&&m.getSource()}getOwnSources(){const u=[];for(const m in this._otherSourceCaches){const w=this.getOwnSourceCache(m);w&&u.push(w.getSource())}return u}areTilesLoaded(){const u=this._mergedSourceCaches;for(const m in u){const w=u[m]._tiles;for(const I in w){const P=w[I];if(P.state!=="loaded"&&P.state!=="errored")return!1}}return!0}setLights(u){if(this._checkLoaded(),!u)return delete this.ambientLight,void delete this.directionalLight;const m=this._getTransitionParameters();for(const I of u){if(this._validate(hs,"lights",I))return;switch(I.type){case"ambient":if(this.ambientLight){const P=this.ambientLight;P.set(I),P.updateTransitions(m)}else this.ambientLight=new wn(I,_n||(_n=new a.a0({color:new a.a1(a._.properties_light_ambient.color),intensity:new a.a1(a._.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const P=this.directionalLight;P.set(I),P.updateTransitions(m)}else this.directionalLight=new wn(I,zn||(zn=new a.a0({direction:new a.ad(a._.properties_light_directional.direction),color:new a.a1(a._.properties_light_directional.color),intensity:new a.a1(a._.properties_light_directional.intensity),"cast-shadows":new a.a1(a._.properties_light_directional["cast-shadows"]),"shadow-intensity":new a.a1(a._.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const w=new a.a3(this.z||0,m);this.ambientLight&&this.ambientLight.recalculate(w),this.directionalLight&&this.directionalLight.recalculate(w),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const u=this.directionalLight,m=this.ambientLight;if(!u||!m)return;const w=ae=>.2126*(ae[0]<=.03928?ae[0]/12.92:Math.pow((ae[0]+.055)/1.055,2.4))+.7152*(ae[1]<=.03928?ae[1]/12.92:Math.pow((ae[1]+.055)/1.055,2.4))+.0722*(ae[2]<=.03928?ae[2]/12.92:Math.pow((ae[2]+.055)/1.055,2.4)),I=u.properties.get("color").toRenderColor(null).toArray01(),P=u.properties.get("intensity"),F=u.properties.get("direction"),W=1-a.c7(F.x,F.y,F.z)[2]/90,q=w(I)*P*W,J=m.properties.get("color").toRenderColor(null).toArray01(),ee=m.properties.get("intensity");return(q+w(J)*ee)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const u=[];return this.directionalLight&&u.push(this.directionalLight.get()),this.ambientLight&&u.push(this.ambientLight.get()),u}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(u){if(!u)return this;if(a.cn(u)){const m=a.co(u),w=this.fragments.find(({id:P})=>P===m);if(!w)throw new Error(`Style import not found: ${u}`);const I=a.cm(u);return w.style.getFragmentStyle(I)}{const m=this.fragments.find(({id:w})=>w===u);if(!m)throw new Error(`Style import not found: ${u}`);return m.style}}getConfigProperty(u,m){const w=this.getFragmentStyle(u);if(!w)return null;const I=a.av(m,w.scope),P=w.options.get(I),F=P?P.value||P.default:null;return F?F.serialize():null}setConfigProperty(u,m,w){const I=this.getFragmentStyle(u);if(!I)return;const P=I.stylesheet.schema;if(!P||!P[m])return;const F=a.M(w);if(F.result!=="success")return void oo(this,F.value);const W=F.value.expression,q=a.av(m,I.scope),J=I.options.get(q);if(!J)return;let ee;const{minValue:ae,maxValue:le,stepValue:ue,type:ve,values:ye}=P[m],be=a.M(P[m].default);be.result==="success"&&(ee=be.value.expression),ee?(this.options.set(q,{...J,value:W,default:ee,minValue:ae,maxValue:le,stepValue:ue,type:ve,values:ye}),this.updateConfigDependencies(m)):this.fire(new a.t(new Error(`No schema defined for the config option "${m}" in the "${u}" fragment.`)))}getConfig(u){const m=this.getFragmentStyle(u);if(!m)return null;const w=m.stylesheet.schema;if(!w)return null;const I={};for(const P in w){const F=a.av(P,m.scope),W=m.options.get(F),q=W?W.value||W.default:null;I[P]=q?q.serialize():null}return I}setConfig(u,m){const w=this.getFragmentStyle(u);w&&(w.updateConfig(m,w.stylesheet.schema),this.updateConfigDependencies())}getSchema(u){const m=this.getFragmentStyle(u);return m?m.stylesheet.schema:null}setSchema(u,m){const w=this.getFragmentStyle(u);w&&(w.stylesheet.schema=m,w.updateConfig(w._config,m),this.updateConfigDependencies())}updateConfig(u,m){if(this._config=u,u||m)if(m)for(const w in m){let I,P;const F=a.M(m[w].default);if(F.result==="success"&&(I=F.value.expression),u&&u[w]!==void 0){const le=a.M(u[w]);le.result==="success"&&(P=le.value.expression)}const{minValue:W,maxValue:q,stepValue:J,type:ee,values:ae}=m[w];if(I){const le=a.av(w,this.scope);this.options.set(le,{default:I,value:P,minValue:W,maxValue:q,stepValue:J,type:ee,values:ae})}else this.fire(new a.t(new Error(`No schema defined for config option "${w}".`)))}else this.fire(new a.t(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(u){for(const m of this._configDependentLayers){const w=this.getLayer(m);if(w){if(u&&!w.configDependencies.has(u))continue;w.possiblyEvaluateVisibility(),this._updateLayer(w)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.forEachFragmentStyle(m=>{if(m._styleColorTheme.colorTheme){const w=m._evaluateColorThemeData(m._styleColorTheme.colorTheme);(!m._styleColorTheme.lut&&w!==""||m._styleColorTheme.lut&&w!==m._styleColorTheme.lut.data)&&m.setColorTheme(m._styleColorTheme.colorTheme)}}),this._changes.setDirty()}addLayer(u,m,w={}){this._checkLoaded();const I=u.id;if(this._layers[I])return void this.fire(new a.t(new Error(`Layer with id "${I}" already exists on this map`)));let P;if(u.type==="custom"){if(oo(this,a.cp(u)))return;P=a.cq(u,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof u.source=="object"&&(this.addSource(I,u.source),u=a.cl(u),u=a.l(u,{source:I})),this._validate(Tt,`layers.${I}`,u,{arrayIndex:-1},w))return;P=a.cq(u,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(P),P.setEventedParent(this,{layer:{id:I}}),this._serializedLayers[P.id]=P.serialize()}P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid);let F=this._order.length;if(m){const ee=this._order.indexOf(m);if(ee===-1)return void this.fire(new a.t(new Error(`Layer with id "${m}" does not exist on this map.`)));P.slot===this._layers[m].slot?F=ee:a.w(`Layer with id "${m}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(F,0,I),this._layerOrderChanged=!0,this._layers[I]=P;const W=this.getOwnLayerSourceCache(P),q=!!this.directionalLight&&this.directionalLight.shadowsEnabled();W&&P.canCastShadows()&&q&&(W.castsShadows=!0);const J=this._changes.getRemovedLayer(P);if(J&&P.source&&W&&P.type!=="custom"){this._changes.discardLayerRemoval(P);const ee=a.av(P.source,P.scope);J.type!==P.type?this._changes.updateSourceCache(ee,"clear"):(this._changes.updateSourceCache(ee,"reload"),W.pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map),P.scope=this.scope,this.mergeLayers()}moveLayer(u,m){this._checkLoaded();const w=this._checkLayer(u);if(!w||u===m)return;const I=this._order.indexOf(u);this._order.splice(I,1);let P=this._order.length;if(m){const F=this._order.indexOf(m);if(F===-1)return void this.fire(new a.t(new Error(`Layer with id "${m}" does not exist on this map.`)));w.slot===this._layers[m].slot?P=F:a.w(`Layer with id "${m}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(P,0,u),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(u){this._checkLoaded();const m=this._checkLayer(u);if(!m)return;m.setEventedParent(null);const w=this._order.indexOf(u);this._order.splice(w,1),delete this._layers[u],delete this._serializedLayers[u],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(m.fqid),this._changes.removeLayer(m);const I=this.getOwnLayerSourceCache(m);if(I&&I.castsShadows){let P=!1;for(const F in this._layers)if(this._layers[F].source===m.source&&this._layers[F].canCastShadows()){P=!0;break}I.castsShadows=P}m.onRemove&&m.onRemove(this.map),this.mergeLayers()}getOwnLayer(u){return this._layers[u]}hasLayer(u){return u in this._mergedLayers}hasLayerType(u){for(const m in this._layers)if(this._layers[m].type===u)return!0;return!1}setLayerZoomRange(u,m,w){this._checkLoaded();const I=this._checkLayer(u);I&&(I.minzoom===m&&I.maxzoom===w||(m!=null&&(I.minzoom=m),w!=null&&(I.maxzoom=w),this._updateLayer(I)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(u,m){this._checkLoaded();const w=this._checkLayer(u);w&&w.slot!==m&&(w.slot=m,this._updateLayer(w))}setFilter(u,m,w={}){this._checkLoaded();const I=this._checkLayer(u);if(I&&!a.bh(I.filter,m))return m==null?(I.filter=void 0,void this._updateLayer(I)):void(this._validate(xe,`layers.${I.id}.filter`,m,{layerType:I.type},w)||(I.filter=a.cl(m),this._updateLayer(I)))}getFilter(u){const m=this._checkLayer(u);if(m)return a.cl(m.filter)}setLayoutProperty(u,m,w,I={}){this._checkLoaded();const P=this._checkLayer(u);if(P&&!a.bh(P.getLayoutProperty(m),w)){if(w!=null&&(!I||I.validate!==!1)&&oo(P,Xe.call(Cn,{key:`layers.${u}.layout.${m}`,layerType:P.type,objectKey:m,value:w,styleSpec:a._,style:{glyphs:!0,sprite:!0}})))return;P.setLayoutProperty(m,w),P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),this._updateLayer(P)}}getLayoutProperty(u,m){const w=this._checkLayer(u);if(w)return w.getLayoutProperty(m)}setPaintProperty(u,m,w,I={}){this._checkLoaded();const P=this._checkLayer(u);if(!P||a.bh(P.getPaintProperty(m),w)||w!=null&&(!I||I.validate!==!1)&&oo(P,Ce.call(Cn,{key:`layers.${u}.paint.${m}`,layerType:P.type,objectKey:m,value:w,styleSpec:a._})))return;const F=P.setPaintProperty(m,w);P.configDependencies.size!==0&&this._configDependentLayers.add(P.fqid),F&&this._updateLayer(P),this._changes.updatePaintProperties(P)}getPaintProperty(u,m){const w=this._checkLayer(u);if(w)return w.getPaintProperty(m)}setFeatureState(u,m){this._checkLoaded();const w=u.source,I=u.sourceLayer,P=this._checkSource(w);if(!P)return;const F=P.type;if(F==="geojson"&&I)return void this.fire(new a.t(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(F==="vector"&&!I)return void this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")));u.id===void 0&&this.fire(new a.t(new Error("The feature id parameter must be provided.")));const W=this.getOwnSourceCaches(w);for(const q of W)q.setFeatureState(I,u.id,m)}removeFeatureState(u,m){this._checkLoaded();const w=u.source,I=this._checkSource(w);if(!I)return;const P=I.type,F=P==="vector"?u.sourceLayer:void 0;if(P==="vector"&&!F)return void this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof u.id!="string"&&typeof u.id!="number")return void this.fire(new a.t(new Error("A feature id is required to remove its specific state property.")));const W=this.getOwnSourceCaches(w);for(const q of W)q.removeFeatureState(F,u.id,m)}getFeatureState(u){this._checkLoaded();const m=u.source,w=u.sourceLayer,I=this._checkSource(m);if(I){if(I.type!=="vector"||w)return u.id===void 0&&this.fire(new a.t(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(m)[0].getFeatureState(w,u.id);this.fire(new a.t(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(u){return this.stylesheet.transition=a.l({},this.stylesheet.transition,u),this.transition=this.stylesheet.transition,this}getTransition(){return a.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const u=this.getTerrain(),m=u&&this.terrain&&this.terrain.scope===this.scope?u:this.stylesheet.terrain;return a.cr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:m,fog:this.stylesheet.fog,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},w=>w!==void 0)}_updateLayer(u){this._changes.updateLayer(u);const m=this.getLayerSourceCache(u),w=a.av(u.source,u.scope),I=this._changes.getUpdatedSourceCaches();u.source&&!I[w]&&m&&m.getSource().type!=="raster"&&(this._changes.updateSourceCache(w,"reload"),m.pause()),u.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(u){const m=W=>this._mergedLayers[W].is3D(),w=this.order,I={},P=[];for(let W=w.length-1;W>=0;W--){const q=w[W];if(m(q)){I[q]=W;for(const J of u){const ee=J[q];if(ee)for(const ae of ee)P.push(ae)}}}P.sort((W,q)=>q.intersectionZ-W.intersectionZ);const F=[];for(let W=w.length-1;W>=0;W--){const q=w[W];if(m(q))for(let J=P.length-1;J>=0;J--){const ee=P[J].feature;if(ee.layer&&I[ee.layer.id]<W)break;F.push(ee),P.pop()}else for(const J of u){const ee=J[q];if(ee)for(const ae of ee)F.push(ae.feature)}}return F}queryRenderedFeatures(u,m,w){m&&m.filter&&this._validate(xe,"queryRenderedFeatures.filter",m.filter,null,m),m.scope=this.scope,m.availableImages=this._availableImages,m.serializedLayers=this._serializedLayers;const I={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new a.t(new Error("parameters.layers must be an Array."))),[];for(const J of m.layers){const ee=this._mergedLayers[J];if(!ee)return this.fire(new a.t(new Error(`The layer '${J}' does not exist in the map's style and cannot be queried for features.`))),[];I[ee.source]=!0}}const P=[],F=m.serializedLayers||{},W=m&&m.layers?m.layers.some(J=>{const ee=this.getLayer(J);return ee&&ee.is3D()}):this.has3DLayers(),q=$n.createFromScreenPoints(u,w);for(const J in this._mergedSourceCaches){const ee=this._mergedSourceCaches[J].getSource();if(!ee||ee.scope!==m.scope)continue;const ae=this._mergedSourceCaches[J].getSource().id;m.layers&&!I[ae]||P.push(ys(this._mergedSourceCaches[J],this._mergedLayers,F,q,m,w,W,!!this.map._showQueryGeometry))}return this.placement&&P.push(function(J,ee,ae,le,ue,ve,ye){const be={},we=ve.queryRenderedSymbols(le),ke=[];for(const Ne of Object.keys(we).map(Number))ke.push(ye[Ne]);ke.sort(Ds);for(const Ne of ke){const De=Ne.featureIndex.lookupSymbolFeatures(we[Ne.bucketInstanceId],ee,Ne.bucketIndex,Ne.sourceLayerIndex,ue.filter,ue.layers,ue.availableImages,J);for(const $e in De){const je=be[$e]=be[$e]||[],et=De[$e];et.sort((Ke,tt)=>{const ut=Ne.featureSortOrder;if(ut){const at=ut.indexOf(Ke.featureIndex);return ut.indexOf(tt.featureIndex)-at}return tt.featureIndex-Ke.featureIndex});for(const Ke of et)je.push(Ke)}}for(const Ne in be)be[Ne].forEach(De=>{const $e=De.feature,je=ae(J[Ne]);if(!je)return;const et=je.getFeatureState($e.layer["source-layer"],$e.id);$e.source=$e.layer.source,$e.layer["source-layer"]&&($e.sourceLayer=$e.layer["source-layer"]),$e.state=et});return be}(this._mergedLayers,F,this.getLayerSourceCache.bind(this),q.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(u,m){m&&m.filter&&this._validate(xe,"querySourceFeatures.filter",m.filter,null,m);const w=this.getOwnSourceCaches(u);let I=[];for(const P of w)I=I.concat($a(P,m));return I}addSourceType(u,m,w){return Fo.getSourceType(u)?w(new Error(`A source type called "${u}" already exists.`)):(Fo.setSourceType(u,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:u,url:m.workerSourceURL},w):w(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(u,m,w={}){this._checkLoaded();const I=this.light.getLight();let P=!1;for(const W in u)if(!a.bh(u[W],I[W])){P=!0;break}if(!P)return;const F=this._getTransitionParameters();this.light.setLight(u,m,w),this.light.updateTransitions(F)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=a.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&a.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(u,m=1){if(this._checkLoaded(),!u)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),m===0&&delete this.terrain,u===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let w=u;const I=u.source==null;if(m===1){if(this.disableElevatedTerrain)return;if(typeof w.source=="object"){const W="terrain-dem-src";this.addSource(W,w.source),w=a.cl(w),w=a.l(w,{source:W})}const P=a.l({},w),F={};if(this.terrain&&I){P.source=this.terrain.get().source;const W=this.terrain?this.getFragmentStyle(this.terrain.scope):null;W&&(F.style=W.serialize())}if(this._validate(Ls,"terrain",P,F))return}if(!this.terrain||this.terrain.scope!==this.scope&&!I||this.terrain&&m!==this.terrain.drapeRenderMode){if(!w)return;this._createTerrain(w,m),this.fire(new a.x("data",{dataType:"style"}))}else{const P=this.terrain,F=P.get();for(const W of Object.keys(a._.terrain))!w.hasOwnProperty(W)&&a._.terrain[W].default&&(w[W]=a._.terrain[W].default);for(const W in u)if(!a.bh(u[W],F[W])){P.set(u,this.options),this.stylesheet.terrain=u;const q=this._getTransitionParameters({duration:0});P.updateTransitions(q),this.fire(new a.x("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(u){const m=this.fog=new It(u,this.map.transform,this.scope,this.options);this.stylesheet.fog=m.get();const w=this._getTransitionParameters({duration:0});m.updateTransitions(w)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const u of this.map._markers)u._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(u){if(this._checkLoaded(),!u)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog;if(!a.bh(m.get(),u)){m.set(u,this.options),this.stylesheet.fog=m.get();const w=this._getTransitionParameters({duration:0});m.updateTransitions(w)}}else this._createFog(u);this._markersNeedUpdate=!0}setColorTheme(u){this._checkLoaded();const m=()=>{for(const I in this._layers)this._layers[I].lut=this._styleColorTheme.lut;for(const I in this._sourceCaches)this._sourceCaches[I].clearTiles()};if(this._styleColorTheme.colorTheme=u,!u)return this._styleColorTheme.lut=null,void m();const w=this._evaluateColorThemeData(u);this._loadColorTheme(w).then(()=>{this.fire(new a.x("colorthemeset")),m()}).catch(I=>{a.w(`Couldn't set color theme: ${I}`)})}_getTransitionParameters(u){return{now:a.q.now(),transition:a.l(this.transition,u)}}updateDrapeFirstLayers(){if(!this.terrain)return;const u=[],m=[];for(const w of this._mergedOrder)this.isLayerDraped(this._mergedLayers[w])?u.push(w):m.push(w);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...u),this._drapedFirstOrder.push(...m)}_createTerrain(u,m){const w=this.terrain=new zt(u,m,this.scope,this.options);m===1&&(this.stylesheet.terrain=u),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const I=this._getTransitionParameters({duration:0});w.updateTransitions(I)}_force3DLayerUpdate(){for(const u in this._layers){const m=this._layers[u];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const u in this._layers){const m=this._layers[u];m.type==="symbol"&&this._updateLayer(m)}}_validate(u,m,w,I,P={}){if(P&&P.validate===!1)return!1;const F=a.l({},this.serialize());return oo(this,u.call(Cn,a.l({key:m,style:F,value:w,styleSpec:a._},I)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.cs.off("pluginStateChange",this._rtlTextPluginCallback);for(const u in this._mergedLayers)this._mergedLayers[u].setEventedParent(null);for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].clearTiles(),this._mergedSourceCaches[u].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(u){const m=this.getSourceCaches(u);for(const w of m)w.clearTiles()}clearSources(){for(const u in this._mergedSourceCaches)this._mergedSourceCaches[u].clearTiles()}reloadSource(u){const m=this.getSourceCaches(u);for(const w of m)w.resume(),w.reload()}reloadSources(){for(const u of this.getSources())u.reload&&u.reload()}updateSources(u){let m;this.directionalLight&&(m=Kh(this.directionalLight));for(const w in this._mergedSourceCaches)this._mergedSourceCaches[w].update(u,void 0,void 0,m)}_generateCollisionBoxes(){for(const u in this._sourceCaches){const m=this._sourceCaches[u];m.resume(),m.reload()}}_updatePlacement(u,m,w,I,P,F,W=!1){let q=!1,J=!1;const ee={},ae={};for(const le of this._mergedOrder){const ue=this._mergedLayers[le];if(ue.type!=="symbol")continue;const ve=a.av(ue.source,ue.scope);let ye=ee[ve];if(!ye){const we=this.getLayerSourceCache(ue);if(!we)continue;const ke=we.getRenderableIds(!0).map(Ne=>we.getTileByID(Ne));ae[ve]=ke.slice(),ye=ee[ve]=ke.sort((Ne,De)=>De.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(De.tileID)?-1:1))}const be=this.crossTileSymbolIndex.addLayer(ue,ye,m.center.lng,m.projection);q=q||be}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),W=W||this._layerOrderChanged||I===0,this._layerOrderChanged&&this.fire(new a.x("neworder")),(W||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.q.now(),m.zoom))&&(this.pauseablePlacement=new gd(m,this._mergedOrder,W,w,I,P,this.placement,this.fog&&m.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,ee,ae),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.q.now()),J=!0),q&&this.pauseablePlacement.placement.setStale()),J||q){this._buildingIndex.onNewFrame(m.zoom);for(let le=0;le<this._mergedOrder.length;le++){const ue=this._mergedLayers[this._mergedOrder[le]];if(ue.type!=="symbol")continue;const ve=this.isLayerClipped(ue);this.placement.updateLayerOpacities(ue,ee[a.av(ue.source,ue.scope)],le,ve?F:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.q.now())}}_releaseSymbolFadeTiles(){for(const u in this._sourceCaches)this._sourceCaches[u].releaseSymbolFadeTiles()}addImport(u,m){this._checkLoaded();const w=this.stylesheet.imports=this.stylesheet.imports||[];if(w.findIndex(({id:P})=>P===u.id)!==-1)return void this.fire(new a.t(new Error(`Import with id '${u.id}' already exists in the map's style.`)));if(!m)return w.push(u),this._loadImports([u],!0);const I=w.findIndex(({id:P})=>P===m);return I===-1&&this.fire(new a.t(new Error(`Import with id "${m}" does not exist on this map.`))),this.stylesheet.imports=w.slice(0,I).concat(u).concat(w.slice(I)),this._loadImports([u],!0,m)}updateImport(u,m){this._checkLoaded();const w=this.stylesheet.imports||[],I=this.getImportIndex(u);return I===-1?this:typeof m=="string"?(this.setImportUrl(u,m),this):(m.url&&m.url!==w[I].url&&this.setImportUrl(u,m.url),a.bh(m.config,w[I].config)||this.setImportConfig(u,m.config),a.bh(m.data,w[I].data)||this.setImportData(u,m.data),this)}moveImport(u,m){this._checkLoaded();let w=this.stylesheet.imports||[];const I=this.getImportIndex(u);if(I===-1)return this;const P=this.getImportIndex(m);if(P===-1)return this;const F=w[I],W=this.fragments[I];return w=w.filter(({id:q})=>q!==u),this.fragments=this.fragments.filter(({id:q})=>q!==u),this.stylesheet.imports=w.slice(0,P).concat(F).concat(w.slice(P)),this.fragments=this.fragments.slice(0,P).concat(W).concat(this.fragments.slice(P)),this.mergeLayers(),this}setImportUrl(u,m){this._checkLoaded();const w=this.stylesheet.imports||[],I=this.getImportIndex(u);if(I===-1)return this;w[I].url=m;const P=this.fragments[I];return P.style=this._createFragmentStyle(w[I]),P.style.on("style.import.load",()=>this.mergeAll()),P.style.loadURL(m),this}setImportData(u,m){this._checkLoaded();const w=this.getImportIndex(u),I=this.stylesheet.imports||[];return w===-1?this:m?(this.fragments[w].style.setState(m),this._reloadImports(),this):(delete I[w].data,this.setImportUrl(u,I[w].url))}setImportConfig(u,m){this._checkLoaded();const w=this.getImportIndex(u),I=this.stylesheet.imports||[];if(w===-1)return this;m?I[w].config=m:delete I[w].config;const P=this.fragments[w],F=P.style.stylesheet&&P.style.stylesheet.schema;return P.config=m,P.style.updateConfig(m,F),this.updateConfigDependencies(),this}removeImport(u){this._checkLoaded();const m=this.stylesheet.imports||[],w=this.getImportIndex(u);w!==-1&&(m.splice(w,1),this.fragments[w].style._remove(),this.fragments.splice(w,1),this._reloadImports())}getImportIndex(u){const m=(this.stylesheet.imports||[]).findIndex(w=>w.id===u);return m===-1&&this.fire(new a.t(new Error(`Import '${u}' does not exist in the map's style and cannot be updated.`))),m}getLayer(u){return this._mergedLayers[u]}getSources(){const u=[];for(const m in this._mergedOtherSourceCaches){const w=this._mergedOtherSourceCaches[m];w&&u.push(w.getSource())}return u}getSource(u,m){const w=this.getSourceCache(u,m);return w&&w.getSource()}getLayerSource(u){const m=this.getLayerSourceCache(u);return m&&m.getSource()}getSourceCache(u,m){const w=a.av(u,m);return this._mergedOtherSourceCaches[w]}getLayerSourceCache(u){const m=a.av(u.source,u.scope);return u.type==="symbol"?this._mergedSymbolSourceCaches[m]:this._mergedOtherSourceCaches[m]}getSourceCaches(u){if(u==null)return Object.values(this._mergedSourceCaches);const m=[];return this._mergedOtherSourceCaches[u]&&m.push(this._mergedOtherSourceCaches[u]),this._mergedSymbolSourceCaches[u]&&m.push(this._mergedSymbolSourceCaches[u]),m}updateSourceCaches(){const u=this._changes.getUpdatedSourceCaches();for(const m in u){const w=u[m];w==="reload"?this.reloadSource(m):w==="clear"&&this.clearSource(m)}}updateLayers(u){const m=this._changes.getUpdatedPaintProperties();for(const w of m){const I=this.getLayer(w);I&&I.updateTransitions(u)}}getImages(u,m,w){this.imageManager.getImages(m.icons,m.scope,w),this._updateTilesForChangedImages();const I=P=>{P&&P.setDependencies(m.tileID.key,m.type,m.icons)};I(this._otherSourceCaches[m.source]),I(this._symbolSourceCaches[m.source])}getGlyphs(u,m,w){this.glyphManager.getGlyphs(m.stacks,m.scope,w)}getResource(u,m,w){return a.ct(m,w)}getOwnSourceCache(u){return this._otherSourceCaches[u]}getOwnLayerSourceCache(u){return u.type==="symbol"?this._symbolSourceCaches[u.source]:this._otherSourceCaches[u.source]}getOwnSourceCaches(u){const m=[];return this._otherSourceCaches[u]&&m.push(this._otherSourceCaches[u]),this._symbolSourceCaches[u]&&m.push(this._symbolSourceCaches[u]),m}_isSourceCacheLoaded(u){const m=this.getOwnSourceCaches(u);return m.length===0?(this.fire(new a.t(new Error(`There is no source with ID '${u}'`))),!1):m.every(w=>w.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(u,m){if(!this._clipLayerPresent&&u.type!=="fill-extrusion")return!1;const w=u.type==="fill-extrusion"&&u.sourceLayer==="building";if(u.is3D()){if(w||m&&m.type==="batched-model"||u.type==="model")return!0}else if(u.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(u=>{u.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Fo.getSourceType=function(b){return Qn[b]},Fo.setSourceType=function(b,u){Qn[b]=u},Fo.registerForPluginStateChange=a.cc;var Qh=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,mg=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Fp=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Es="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Np=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,gg=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,vg=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,zp=`#ifdef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Jo=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,ef=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Cs=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef NATIVE
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Da=[];Hs(Qh,Da),Hs(Fp,Da),Hs(mg,Da);const Ks={"_prelude_fog.vertex.glsl":gg,"_prelude_terrain.vertex.glsl":Np,"_prelude_shadow.vertex.glsl":ef,"_prelude_fog.fragment.glsl":vg,"_prelude_shadow.fragment.glsl":Cs,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":zp,"_prelude_raster_particle.glsl":Jo},xu={};Kr("",Np),Kr(vg,gg),Kr(Cs,ef),Kr(zp,""),Kr(Jo,"");const bu=Kr(mg,Fp),Zu=Qh;var Yu={background:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Kr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Kr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Kr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Kr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Kr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);v_flat=vec4(linearProduct(color.rgb,vec3(calculate_NdotL(normal))),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Kr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Kr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Kr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Kr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=out_color.a;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color.rgb=mix(border_color.rgb*border_color.a*trim_alpha,out_color.rgb,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {color=vec4(0,0,0,0);}}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in float a_z_offset;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);
#ifdef ELEVATED_ROADS
gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 halfCellProgress=normal.yx*32.0;float ele0=elevation(pos);float ele_line=max(ele0,max(elevation(pos+halfCellProgress),elevation(pos-halfCellProgress)));float ele1=elevation(pos+offsetTile);float ele2=elevation(pos-offsetTile);float ele_max=max(ele_line,0.5*(ele1+ele2));float ele=ele_max-ele0+ele1+a_z_offset ;gl_Position=u_matrix*vec4(pos+offsetTile,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*0.1*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef LINE_JOIN_NONE
v_width=floorwidth+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Kr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Kr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Kr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Kr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
}`),terrainRaster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Kr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Kr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Es),skyboxGradient:Kr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Es),skyboxCapture:Kr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Kr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Kr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Kr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),occlusion:Kr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Hs(b,u){const m=b.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let w of m)if(w=w.trim(),w[0]==="#"&&w.includes("if")&&!w.includes("endif")){w=w.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const I=w.split(" ");for(const P of I)u.includes(P)||u.push(P)}}function Kr(b,u){const m=/#include\s+"([^"]+)"/g,w=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let I=u.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);I&&(I=I.map(J=>{const ee=J.split(" ");return ee[ee.length-1]}),I=[...new Set(I)]);const P={},F=[],W=[];if(b=b.replace(m,(J,ee)=>(W.push(ee),"")),(u=u.replace(m,(J,ee)=>(F.push(ee),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let q=[...Da];Hs(b,q),Hs(u,q);for(const J of[...F,...W])Ks[J]||console.error(`Undefined include: ${J}`),xu[J]||(xu[J]=[],Hs(Ks[J],xu[J])),q=[...q,...xu[J]];return{fragmentSource:b=b.replace(w,(J,ee,ae,le,ue)=>(P[ue]=!0,ee==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
in ${ae} ${le} ${ue};
#else
uniform ${ae} ${le} u_${ue};
#endif
`:ee==="initialize"?`
#ifdef HAS_UNIFORM_u_${ue}
    ${ae} ${le} ${ue} = u_${ue};
#endif
`:ee==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    in ${ae} ${le} ${ue};
#endif
`:ee==="initialize-attribute"?"":void 0)),vertexSource:u=u.replace(w,(J,ee,ae,le,ue)=>{const ve=le==="float"?"vec2":le,ye=ue.match(/color/)?"color":ve;return ee==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
in ${ae} ${le} a_${ue};
#endif
`:P[ue]?ee==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
in ${ae} ${ve} a_${ue};
out ${ae} ${le} ${ue};
#else
uniform ${ae} ${le} u_${ue};
#endif
`:ee==="initialize"?ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = a_${ue};
#else
    ${ae} ${le} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${ue} = unpack_mix_${ye}(a_${ue}, u_${ue}_t);
#else
    ${ae} ${le} ${ue} = u_${ue};
#endif
`:ee==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    in ${ae} ${le} a_${ue};
    out ${ae} ${le} ${ue};
#endif
`:ee==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    ${ue} = a_${ue};
#endif
`:void 0:ee==="define"?`
#ifndef HAS_UNIFORM_u_${ue}
uniform lowp float u_${ue}_t;
in ${ae} ${ve} a_${ue};
#else
uniform ${ae} ${le} u_${ue};
#endif
`:ee==="define-instanced"?ye==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${ue}0;
in vec4 a_${ue}1;
in vec4 a_${ue}2;
in vec4 a_${ue}3;
#else
uniform ${ae} ${le} u_${ue};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${ae} ${ve} a_${ue};
#else
uniform ${ae} ${le} u_${ue};
#endif
`:ee==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${ue}
    ${ae} ${le} ${ue} = a_${ue};
#endif
`:ye==="vec4"?`
#ifndef HAS_UNIFORM_u_${ue}
    ${ae} ${le} ${ue} = a_${ue};
#else
    ${ae} ${le} ${ue} = u_${ue};
#endif
`:`
#ifndef HAS_UNIFORM_u_${ue}
    ${ae} ${le} ${ue} = unpack_mix_${ye}(a_${ue}, u_${ue}_t);
#else
    ${ae} ${le} ${ue} = u_${ue};
#endif
`}),staticAttributes:I,usedDefines:q,vertexIncludes:F,fragmentIncludes:W}}class Ku{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(u,m,w,I,P,F,W,q){this.context=u;let J=this.boundPaintVertexBuffers.length!==I.length;for(let ae=0;!J&&ae<I.length;ae++)this.boundPaintVertexBuffers[ae]!==I[ae]&&(J=!0);let ee=this.boundDynamicVertexBuffers.length!==W.length;for(let ae=0;!ee&&ae<W.length;ae++)this.boundDynamicVertexBuffers[ae]!==W[ae]&&(ee=!0);if(!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==w||J||ee||this.boundIndexBuffer!==P||this.boundVertexOffset!==F)this.freshBind(m,w,I,P,F,W,q);else{u.bindVertexArrayOES.set(this.vao);for(const ae of W)ae&&(ae.bind(),q&&ae.instanceCount&&ae.setVertexAttribDivisor(u.gl,m,q));P&&P.dynamicDraw&&P.bind()}}freshBind(u,m,w,I,P,F,W){const q=u.numAttributes,J=this.context,ee=J.gl;this.vao&&this.destroy(),this.vao=J.gl.createVertexArray(),J.bindVertexArrayOES.set(this.vao),this.boundProgram=u,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=I,this.boundVertexOffset=P,this.boundDynamicVertexBuffers=F,m.enableAttributes(ee,u),m.bind(),m.setVertexAttribPointers(ee,u,P);for(const ae of w)ae.enableAttributes(ee,u),ae.bind(),ae.setVertexAttribPointers(ee,u,P);for(const ae of F)ae&&(ae.enableAttributes(ee,u),ae.bind(),ae.setVertexAttribPointers(ee,u,P),W&&ae.instanceCount&&ae.setVertexAttribDivisor(ee,u,W));I&&I.bind(),J.currentNumAttributes=q}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function tf(b,u){const m=Math.pow(2,u.canonical.z),w=u.canonical.y;return[new a.a5(0,w/m).toLngLat().lat,new a.a5(0,(w+1)/m).toLngLat().lat]}function Cl(b,u,m,w,I,P,F){const W=b.context,q=W.gl,J=m.hillshadeFBO;if(!J)return;b.prepareDrawTile();const ee=b.isTileAffectedByFog(u),ae=b.getOrCreateProgram("hillshade",{overrideFog:ee});W.activeTexture.set(q.TEXTURE0),q.bindTexture(q.TEXTURE_2D,J.colorAttachment.get());const le=((be,we,ke,Ne)=>{const De=ke.paint.get("hillshade-shadow-color"),$e=ke.paint.get("hillshade-highlight-color"),je=ke.paint.get("hillshade-accent-color"),et=ke.paint.get("hillshade-emissive-strength");let Ke=a.bB(ke.paint.get("hillshade-illumination-direction"));if(ke.paint.get("hillshade-illumination-anchor")==="viewport")Ke-=be.transform.angle;else if(be.style&&be.style.enable3dLights()&&be.style.directionalLight){const ut=be.style.directionalLight.properties.get("direction"),at=a.c7(ut.x,ut.y,ut.z);Ke=a.bB(at[1])}const tt=!be.options.moving;return{u_matrix:Ne||be.transform.calculateProjMatrix(we.tileID.toUnwrapped(),tt),u_image:0,u_latrange:tf(0,we.tileID),u_light:[ke.paint.get("hillshade-exaggeration"),Ke],u_shadow:De.toRenderColor(ke.lut),u_highlight:$e.toRenderColor(ke.lut),u_emissive_strength:et,u_accent:je.toRenderColor(ke.lut)}})(b,m,w,b.terrain?u.projMatrix:null);b.uploadCommonUniforms(W,ae,u.toUnwrapped());const{tileBoundsBuffer:ue,tileBoundsIndexBuffer:ve,tileBoundsSegments:ye}=b.getTileBoundsBuffers(m);ae.draw(b,q.TRIANGLES,I,P,F,_r.disabled,le,w.id,ue,ve,ye)}function hl(b,u,m){if(!u.needsDEMTextureUpload)return;const w=b.context,I=w.gl;w.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||b.getTileTexture(m.stride);const P=m.getPixels();u.demTexture?u.demTexture.update(P,{premultiply:!1}):u.demTexture=new a.T(w,P,I.R32F,{premultiply:!1}),u.needsDEMTextureUpload=!1}function ac(b,u,m){const w=b.context,I=w.gl;if(!u.dem)return;const P=u.dem;if(w.activeTexture.set(I.TEXTURE1),hl(b,u,P),!u.demTexture)return;u.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const F=P.dim;w.activeTexture.set(I.TEXTURE0);let W=u.hillshadeFBO;if(!W){const le=new a.T(w,{width:F,height:F,data:null},I.RGBA8);le.bind(I.LINEAR,I.CLAMP_TO_EDGE),W=u.hillshadeFBO=w.createFramebuffer(F,F,!0,"renderbuffer"),W.colorAttachment.set(le.texture)}w.bindFramebuffer.set(W.framebuffer),w.viewport.set([0,0,F,F]);const{tileBoundsBuffer:q,tileBoundsIndexBuffer:J,tileBoundsSegments:ee}=b.getMercatorTileBoundsBuffers(),ae=[];b.linearFloatFilteringSupported()&&ae.push("TERRAIN_DEM_FLOAT_FORMAT"),b.getOrCreateProgram("hillshadePrepare",{defines:ae}).draw(b,I.TRIANGLES,Xn.disabled,pr.disabled,Mr.unblended,_r.disabled,((le,ue)=>{const ve=ue.stride,ye=a.a6.mat4.create();return a.a6.mat4.ortho(ye,0,a.ab,-a.ab,0,0,1),a.a6.mat4.translate(ye,ye,[0,-a.ab,0]),{u_matrix:ye,u_image:1,u_dimension:[ve,ve],u_zoom:le.overscaledZ}})(u.tileID,P),m.id,q,J,ee),u.needsHillshadePrepare=!1}class bi{constructor(u){this.gl=u.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(u){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yd extends bi{getDefault(){return a.bz.transparent}set(u){const m=this.current;(u.r!==m.r||u.g!==m.g||u.b!==m.b||u.a!==m.a||this.dirty)&&(this.gl.clearColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class V0 extends bi{getDefault(){return 1}set(u){(u!==this.current||this.dirty)&&(this.gl.clearDepth(u),this.current=u,this.dirty=!1)}}class _g extends bi{getDefault(){return 0}set(u){(u!==this.current||this.dirty)&&(this.gl.clearStencil(u),this.current=u,this.dirty=!1)}}class Up extends bi{getDefault(){return[!0,!0,!0,!0]}set(u){const m=this.current;(u[0]!==m[0]||u[1]!==m[1]||u[2]!==m[2]||u[3]!==m[3]||this.dirty)&&(this.gl.colorMask(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class xd extends bi{getDefault(){return!0}set(u){(u!==this.current||this.dirty)&&(this.gl.depthMask(u),this.current=u,this.dirty=!1)}}class H0 extends bi{getDefault(){return 255}set(u){(u!==this.current||this.dirty)&&(this.gl.stencilMask(u),this.current=u,this.dirty=!1)}}class j0 extends bi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(u){const m=this.current;(u.func!==m.func||u.ref!==m.ref||u.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(u.func,u.ref,u.mask),this.current=u,this.dirty=!1)}}class yg extends bi{getDefault(){const u=this.gl;return[u.KEEP,u.KEEP,u.KEEP]}set(u){const m=this.current;(u[0]!==m[0]||u[1]!==m[1]||u[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(u[0],u[1],u[2]),this.current=u,this.dirty=!1)}}class Gc extends bi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;u?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=u,this.dirty=!1}}class W0 extends bi{getDefault(){return[0,1]}set(u){const m=this.current;(u[0]!==m[0]||u[1]!==m[1]||this.dirty)&&(this.gl.depthRange(u[0],u[1]),this.current=u,this.dirty=!1)}}class xg extends bi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;u?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=u,this.dirty=!1}}class bg extends bi{getDefault(){return this.gl.LESS}set(u){(u!==this.current||this.dirty)&&(this.gl.depthFunc(u),this.current=u,this.dirty=!1)}}class $0 extends bi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;u?m.enable(m.BLEND):m.disable(m.BLEND),this.current=u,this.dirty=!1}}class nf extends bi{getDefault(){const u=this.gl;return[u.ONE,u.ZERO,u.ONE,u.ZERO]}set(u){const m=this.current;(u[0]!==m[0]||u[1]!==m[1]||u[2]!==m[2]||u[3]!==m[3]||this.dirty)&&(this.gl.blendFuncSeparate(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class wg extends bi{getDefault(){return a.bz.transparent}set(u){const m=this.current;(u.r!==m.r||u.g!==m.g||u.b!==m.b||u.a!==m.a||this.dirty)&&(this.gl.blendColor(u.r,u.g,u.b,u.a),this.current=u,this.dirty=!1)}}class Sg extends bi{getDefault(){return this.gl.FUNC_ADD}set(u){(u!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(u,u),this.current=u,this.dirty=!1)}}class Ag extends bi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;u?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=u,this.dirty=!1}}class X0 extends bi{getDefault(){return this.gl.BACK}set(u){(u!==this.current||this.dirty)&&(this.gl.cullFace(u),this.current=u,this.dirty=!1)}}class Tg extends bi{getDefault(){return this.gl.CCW}set(u){(u!==this.current||this.dirty)&&(this.gl.frontFace(u),this.current=u,this.dirty=!1)}}let Dx=class extends bi{getDefault(){return null}set(b){(b!==this.current||this.dirty)&&(this.gl.useProgram(b),this.current=b,this.dirty=!1)}};class bd extends bi{getDefault(){return this.gl.TEXTURE0}set(u){(u!==this.current||this.dirty)&&(this.gl.activeTexture(u),this.current=u,this.dirty=!1)}}class Gp extends bi{getDefault(){const u=this.gl;return[0,0,u.drawingBufferWidth,u.drawingBufferHeight]}set(u){const m=this.current;(u[0]!==m[0]||u[1]!==m[1]||u[2]!==m[2]||u[3]!==m[3]||this.dirty)&&(this.gl.viewport(u[0],u[1],u[2],u[3]),this.current=u,this.dirty=!1)}}class q0 extends bi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,u),this.current=u,this.dirty=!1}}class fl extends bi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Z0 extends bi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,u),this.current=u,this.dirty=!1}}class Vp extends bi{getDefault(){return null}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Hp extends bi{getDefault(){return null}set(u){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,u),this.current=u,this.dirty=!1}}class Mg extends bi{getDefault(){return null}set(u){this.gl&&(u!==this.current||this.dirty)&&(this.gl.bindVertexArray(u),this.current=u,this.dirty=!1)}}class Eg extends bi{getDefault(){return 4}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,u),this.current=u,this.dirty=!1}}class rf extends bi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,u),this.current=u,this.dirty=!1}}class Y0 extends bi{getDefault(){return!1}set(u){if(u===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,u),this.current=u,this.dirty=!1}}class jp extends bi{constructor(u,m){super(u),this.context=u,this.parent=m}getDefault(){return null}}class Cg extends jp{setDirty(){this.dirty=!0}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class Wp extends jp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,u),this.current=u,this.dirty=!1}}class Ig extends jp{attachment(){return this.gl.DEPTH_ATTACHMENT}set(u){if(u===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,this.attachment(),m.TEXTURE_2D,u,0),this.current=u,this.dirty=!1}}class wd extends Wp{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Bx=(b,u,m)=>({u_matrix:b,u_image0:0,u_skirt_height:u,u_ground_shadow_factor:m}),K0=(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye)=>({u_proj_matrix:Float32Array.from(b),u_globe_matrix:u,u_normalize_matrix:Float32Array.from(w),u_merc_matrix:m,u_zoom_transition:I,u_merc_center:P,u_image0:0,u_frustum_tl:F,u_frustum_tr:W,u_frustum_br:q,u_frustum_bl:J,u_globe_pos:ee,u_globe_radius:ae,u_viewport:le,u_grid_matrix:ye?Float32Array.from(ye):new Float32Array(9),u_skirt_height:ue,u_far_z_cutoff:ve});function J0(b,u){return b!=null&&u!=null&&!(!b.hasData()||!u.hasData())&&b.demTexture!=null&&u.demTexture!=null&&b.tileID.key!==u.tileID.key}const sf=new class{constructor(){this.operations={}}newMorphing(b,u,m,w,I){if(b in this.operations){const P=this.operations[b];P.to.tileID.key!==m.tileID.key&&(P.queued=m)}else this.operations[b]={startTime:w,phase:0,duration:I,from:u,to:m,queued:null}}getMorphValuesForProxy(b){if(!(b in this.operations))return null;const u=this.operations[b];return{from:u.from,to:u.to,phase:u.phase}}update(b){for(const u in this.operations){const m=this.operations[u];for(m.phase=(b-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,b)){delete this.operations[u];break}}}_nextOp(b,u){return!!b.queued&&(b.from=b.to,b.to=b.queued,b.queued=null,b.phase=0,b.startTime=u,!0)}_validOp(b){return b.from.hasData()&&b.to.hasData()}},Q0={0:null,1:"TERRAIN_VERTEX_MORPHING"};function oc(b,u,m){if(u===0)return 0;const w=u<1&&m===514?.25/u:1;return 6*Math.pow(1.5,22-b)*Math.max(u,1)*w}function Rg(b,u){const m=1<<b.z;return!u&&(b.x===0||b.x===m-1)||b.y===0||b.y===m-1}const wu=b=>({u_matrix:b});function Ju(b,u,m,w,I){if(I>0){const P=a.q.now(),F=(P-b.timeAdded)/I,W=u?(P-u.timeAdded)/I:-1,q=m.getSource(),J=w.coveringZoomLevel({tileSize:q.tileSize,roundZoom:q.roundZoom}),ee=!u||Math.abs(u.tileID.overscaledZ-J)>Math.abs(b.tileID.overscaledZ-J),ae=ee&&b.refreshedUponExpiration?1:a.ap(ee?F:1-W,0,1);return b.refreshedUponExpiration&&F>=1&&(b.refreshedUponExpiration=!1),u?{opacity:1,mix:1-ae}:{opacity:ae,mix:0}}return{opacity:1,mix:0}}class Su extends Xa{constructor(u){const m={type:"raster-dem",maxzoom:u.transform.maxZoom},w=new a.cd(a.ce(),null),I=Yi("mock-dem",m,w,u.style);super("mock-dem",I,!1),I.setEventedParent(this),this._sourceLoaded=!0}_loadTile(u,m){u.state="loaded",m(null)}}class $p extends Xa{constructor(u){const m=Yi("proxy",{type:"geojson",maxzoom:u.transform.maxZoom},new a.cd(a.ce(),null),u.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=u,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(u,m,w){if(u.freezeTileCoverage)return;this.transform=u;const I=u.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((P,F)=>{if(P[F.key]="",!this._tiles[F.key]){const W=new Fc(F,this._source.tileSize*F.overscaleFactor(),u.tileZoom);W.state="loaded",this._tiles[F.key]=W}return P},{});for(const P in this._tiles)P in I||(this.freeFBO(P),this._tiles[P].unloadVectorData(),delete this._tiles[P])}freeFBO(u){const m=this.proxyCachedFBO[u];if(m!==void 0){const w=Object.values(m);this.renderCachePool.push(...w),delete this.proxyCachedFBO[u]}}deallocRenderCache(){this.renderCache.forEach(u=>u.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Pg extends a.aA{constructor(u,m,w){super(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y),this.proxyTileKey=m,this.projMatrix=w}}class af extends a.cE{constructor(u,m){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},u.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),u.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),u.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=u,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[w,I,P]=function(q){const J=new a.a_,ee=new a.aO,ae=131;J.reserve(17161),ee.reserve(33800);const le=a.ab/128,ue=a.ab+le/2,ve=ue+le;for(let be=-le;be<ve;be+=le)for(let we=-le;we<ve;we+=le){const ke=we<0||we>ue||be<0||be>ue?24575:0,Ne=a.ap(Math.round(we),0,a.ab),De=a.ap(Math.round(be),0,a.ab);J.emplaceBack(Ne+ke,De)}const ye=(be,we)=>{const ke=we*ae+be;ee.emplaceBack(ke+1,ke,ke+ae),ee.emplaceBack(ke+ae,ke+ae+1,ke+1)};for(let be=1;be<129;be++)for(let we=1;we<129;we++)ye(we,be);return[0,129].forEach(be=>{for(let we=0;we<130;we++)ye(we,be),ye(be,we)}),[J,ee,32768]}(),F=u.context;this.gridBuffer=F.createVertexBuffer(w,a.b0.members),this.gridIndexBuffer=F.createIndexBuffer(I),this.gridSegments=a.b1.simpleSegment(0,0,w.length,I.length),this.gridNoSkirtSegments=a.b1.simpleSegment(0,0,w.length,P),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new $p(m.map),this.orthoMatrix=a.a6.mat4.create(),a.a6.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.ab,0,a.ab,0,1);const W=F.gl;this._overlapStencilMode=new pr({func:W.GEQUAL,mask:255},0,255,W.KEEP,W.KEEP,W.REPLACE),this._previousZoom=u.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Su(m.map),this._pendingGroundEffectLayers=[]}set style(u){u.on("data",this._onStyleDataEvent.bind(this)),this._style=u,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(u,m,w){if(u&&u.terrain){this._style!==u&&(this.style=u,this._evaluationZoom=void 0);const I=u.terrain.properties,P=u.terrain.drapeRenderMode===0,F=u.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=a.q.now();const W=u.terrain&&u.terrain.scope,q=I.get("source"),J=P?this._mockSourceCache:u.getSourceCache(q,W);if(!J)return void a.w(`Couldn't find terrain source "${q}".`);if(this.sourceCache=J,this._exaggeration=F?this.calculateExaggeration(m):I.get("exaggeration"),!m.projection.requiresDraping&&F&&this._exaggeration===0)return void this._disable();this.enabled=!0;const ee=()=>{this.sourceCache.used&&a.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const ae=this.getScaledDemTileSize();this.sourceCache.update(m,ae,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,ee(),this._initializing=!0),ee(),m.updateElevation(!0,w),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0,this._previousZoom=m.zoom}else this._disable()}calculateExaggeration(u){const m=this._previousCameraAltitude,w=u.getFreeCameraOptions().position.z/u.pixelsPerMeter*u.worldSize;this._previousCameraAltitude=w;const I=m!=null?w-m:Number.MAX_VALUE;if(Math.abs(I)<2)return this._exaggeration;const P=u.zoom,F=this._style.terrain;if(!this._previousUpdateTimestamp)return F.getExaggeration(P);let W=P-this._previousZoom;const q=this._previousUpdateTimestamp;let J=P;this._evaluationZoom!=null&&(J=this._evaluationZoom,Math.abs(P-J)>.5&&(W=.5*(P-J+W)),W*I<0&&(J+=W)),this._evaluationZoom=J;const ee=F.getExaggeration(J),ae=ee===F.getExaggeration(Math.max(0,J-.1));if(ae&&Math.abs(ee-this._exaggeration)<.01)return ee;let le=Math.min(.1,.00375*(this._updateTimestamp-q));return(ae||ee<.1||Math.abs(W)<1e-4)&&(le=Math.min(.2,4*le)),a.aa(this._exaggeration,ee,le)}resetTileLookupCache(u){this._findCoveringTileCache[u]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(u){u.coord&&u.dataType==="source"?this._clearRenderCacheForTile(u.sourceCacheId,u.coord):u.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const u in this._style._mergedSourceCaches)this._style._mergedSourceCaches[u].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(u=>u.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const u=2*this.proxySourceCache.getSource().tileSize;return[u,u]}set useVertexMorphing(u){this._useVertexMorphing=u}updateTileBinding(u){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,w=this.painter.transform;this._initializing&&(this._initializing=w._centerAltitude===0&&this.getAtPointOrZero(a.a5.fromLngLat(w.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const I=this.proxyCoords=m.getIds().map(q=>{const J=m.getTileByID(q).tileID;return J.projMatrix=w.calculateProjMatrix(J.toUnwrapped()),J});(function(q,J){const ee=J.transform.pointCoordinate(J.transform.getCameraPoint()),ae=new a.P(ee.x,ee.y);q.sort((le,ue)=>{if(ue.overscaledZ-le.overscaledZ)return ue.overscaledZ-le.overscaledZ;const ve=new a.P(le.canonical.x+(1<<le.canonical.z)*le.wrap,le.canonical.y),ye=new a.P(ue.canonical.x+(1<<ue.canonical.z)*ue.wrap,ue.canonical.y),be=ae.mult(1<<le.canonical.z);return be.x-=.5,be.y-=.5,be.distSqr(ve)-be.distSqr(ye)})})(I,this.painter);const P=this.proxyToSource||{};this.proxyToSource={},I.forEach(q=>{this.proxyToSource[q.key]={}}),this.terrainTileForTile={};const F=this._style._mergedSourceCaches;for(const q in F){const J=F[q];if(!J.used||(J!==this.sourceCache&&this.resetTileLookupCache(J.id),this._setupProxiedCoordsForOrtho(J,u[q],P),J.usedForTerrain))continue;const ee=u[q];J.getSource().reparseOverscaled&&this._assignTerrainTiles(ee)}this.proxiedCoords[m.id]=I.map(q=>new Pg(q,q.key,this.orthoMatrix)),this._assignTerrainTiles(I),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(P),this.renderingToTexture=!1;const W={};this._visibleDemTiles=[];for(const q of this.proxyCoords){const J=this.terrainTileForTile[q.key];if(!J)continue;const ee=J.tileID.key;ee in W||(this._visibleDemTiles.push(J),W[ee]=ee)}}_assignTerrainTiles(u){this._initializing||u.forEach(m=>{if(this.terrainTileForTile[m.key])return;const w=this._findTileCoveringTileID(m,this.sourceCache);w&&(this.terrainTileForTile[m.key]=w)})}_prepareDEMTextures(){const u=this.painter.context,m=u.gl;for(const w in this.terrainTileForTile){const I=this.terrainTileForTile[w],P=I.dem;!P||I.demTexture&&!I.needsDEMTextureUpload||(u.activeTexture.set(m.TEXTURE1),hl(this.painter,I,P))}}_prepareDemTileUniforms(u,m,w,I){if(!m||m.demTexture==null)return!1;const P=u.tileID.canonical,F=Math.pow(2,m.tileID.canonical.z-P.z),W=I||"";return w[`u_dem_tl${W}`]=[P.x*F%1,P.y*F%1],w[`u_dem_scale${W}`]=F,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let u=0;const m=this._visibleDemTiles.reduce((w,I)=>{if(!I.dem)return w;const P=I.dem.tree.minimums[0];return P>0&&u++,w+P},0);return u?m/u:0}_updateEmptyDEMTexture(){const u=this.painter.context,m=u.gl;u.activeTexture.set(m.TEXTURE2);const w=this._getLoadedAreaMinimum(),I=new a.cF({width:1,height:1},new Float32Array([w]));this._emptyDEMTextureDirty=!1;let P=this._emptyDEMTexture;return P?P.update(I,{premultiply:!1}):P=this._emptyDEMTexture=new a.T(u,I,m.R32F,{premultiply:!1}),P}setupElevationDraw(u,m,w){const I=this.painter.context,P=I.gl,F={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};F.u_exaggeration=this.exaggeration();let W=null,q=null,J=1;if(w&&w.morphing&&this._useVertexMorphing){const ue=w.morphing.srcDemTile,ve=w.morphing.dstDemTile;J=w.morphing.phase,ue&&ve&&(this._prepareDemTileUniforms(u,ue,F,"_prev")&&(q=ue),this._prepareDemTileUniforms(u,ve,F)&&(W=ve))}const ee=ue=>ue&&ue.demTexture&&this.painter.linearFloatFilteringSupported()?P.LINEAR:P.NEAREST;let ae=null;var le;if(this.enabled?q&&W?(ae=W.demTexture,I.activeTexture.set(P.TEXTURE4),q.demTexture.bind(ee(q),P.CLAMP_TO_EDGE),F.u_dem_lerp=J):(W=this.terrainTileForTile[u.tileID.key],ae=this._prepareDemTileUniforms(u,W,F)?W.demTexture:this.emptyDEMTexture):ae=this.emptyDEMTexture,I.activeTexture.set(P.TEXTURE2),ae&&(F.u_dem_size=(le=ae).size[0]===1?1:le.size[0]-2,ae.bind(ee(W),P.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(w&&w.useDepthForOcclusion,m,F),w&&w.useMeterToDem&&W){const ue=(1<<W.tileID.canonical.z)*a.bD(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;F.u_meter_to_dem=ue}if(w&&w.labelPlaneMatrixInv&&(F.u_label_plane_matrix_inv=w.labelPlaneMatrixInv),m.setTerrainUniformValues(I,F),this.painter.transform.projection.name==="globe"){const ue=this.globeUniformValues(this.painter.transform,u.tileID.canonical,w&&w.useDenormalizedUpVectorScale);m.setGlobeUniformValues(I,ue)}}globeUniformValues(u,m,w){const I=u.projection;return{u_tile_tl_up:I.upVector(m,0,0),u_tile_tr_up:I.upVector(m,a.ab,0),u_tile_br_up:I.upVector(m,a.ab,a.ab),u_tile_bl_up:I.upVector(m,0,a.ab),u_tile_up_scale:w?a.cG(1):I.upVectorScale(m,u.center.lat,u.worldSize).metersToTile}}renderToBackBuffer(u){const m=this.painter,w=this.painter.context;u.length!==0&&(w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(I,P,F,W,q){if(I.transform.projection.name==="globe")(function(J,ee,ae,le,ue){const ve=J.context,ye=ve.gl;let be,we;const ke=J.transform,Ne=a.cx(J,ve,ke),De=(bt,Ft)=>{if(we===Ft)return;const Zt=[Q0[Ft],"PROJECTION_GLOBE_VIEW"];Ne&&Zt.push("CUSTOM_ANTIALIASING");const kt=J.isTileAffectedByFog(bt);be=J.getOrCreateProgram("globeRaster",{defines:Zt,overrideFog:kt}),we=Ft},$e=J.colorModeForRenderPass(),je=new Xn(ye.LEQUAL,Xn.ReadWrite,J.depthRangeFor3D);sf.update(ue);const et=a.cy(ke),Ke=[a.am(ke.center.lng),a.at(ke.center.lat)],tt=J.globeSharedBuffers,ut=[ke.width*a.q.devicePixelRatio,ke.height*a.q.devicePixelRatio],at=Float32Array.from(ke.globeMatrix),rt={useDenormalizedUpVectorScale:!0};{const bt=J.transform,Ft=oc(bt.zoom,ee.exaggeration(),ee.sourceCache._source.tileSize);we=-1;const Zt=ye.TRIANGLES;for(const kt of le){const hn=ae.getTile(kt),wt=pr.disabled,Wt=ee.prevTerrainTileForTile[kt.key],Gt=ee.terrainTileForTile[kt.key];J0(Wt,Gt)&&sf.newMorphing(kt.key,Wt,Gt,ue,250),ve.activeTexture.set(ye.TEXTURE0),hn.texture&&hn.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const fn=sf.getMorphValuesForProxy(kt.key),pn=fn?1:0;fn&&a.C(rt,{morphing:{srcDemTile:fn.from,dstDemTile:fn.to,phase:a.cw(fn.phase)}});const qt=a.cz(kt.canonical),en=a.cA(qt.getCenter().lat),er=a.cB(kt.canonical,qt,en,bt.worldSize/bt._pixelsPerMercatorPixel),xn=a.b5(a.cC(kt.canonical)),Dn=K0(bt.expandedFarZProjMatrix,at,et,xn,a.a9(bt.zoom),Ke,bt.frustumCorners.TL,bt.frustumCorners.TR,bt.frustumCorners.BR,bt.frustumCorners.BL,bt.globeCenterInViewSpace,bt.globeRadius,ut,Ft,bt._farZ,er);if(De(kt,pn),be&&(ee.setupElevationDraw(hn,be,rt),J.uploadCommonUniforms(ve,be,kt.toUnwrapped()),tt)){const[yr,qn,ur]=tt.getGridBuffers(en,Ft!==0);be.draw(J,Zt,je,wt,$e,_r.backCCW,Dn,"globe_raster",yr,qn,ur)}}}if(tt&&(J.renderDefaultNorthPole||J.renderDefaultSouthPole)){const bt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Ne&&bt.push("CUSTOM_ANTIALIASING"),be=J.getOrCreateProgram("globeRaster",{defines:bt});for(const Ft of le){const{x:Zt,y:kt,z:hn}=Ft.canonical,wt=kt===0,Wt=kt===(1<<hn)-1,[Gt,fn,pn,qt]=tt.getPoleBuffers(hn,!1);if(qt&&(wt||Wt)){const en=ae.getTile(Ft);ve.activeTexture.set(ye.TEXTURE0),en.texture&&en.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);let er=a.cD(hn,Zt,ke);const xn=a.b5(a.cC(Ft.canonical)),Dn=(yr,qn)=>yr.draw(J,ye.TRIANGLES,je,pr.disabled,$e,_r.disabled,K0(ke.expandedFarZProjMatrix,er,er,xn,0,Ke,ke.frustumCorners.TL,ke.frustumCorners.TR,ke.frustumCorners.BR,ke.frustumCorners.BL,ke.globeCenterInViewSpace,ke.globeRadius,ut,0,ke._farZ),"globe_pole_raster",qn,pn,qt);ee.setupElevationDraw(en,be,rt),J.uploadCommonUniforms(ve,be,Ft.toUnwrapped()),wt&&J.renderDefaultNorthPole&&Dn(be,Gt),Wt&&J.renderDefaultSouthPole&&(er=a.a6.mat4.scale(a.a6.mat4.create(),er,[1,-1,1]),Dn(be,fn))}}}})(I,P,F,W,q);else{const J=I.context,ee=J.gl;let ae,le;const ue=I.shadowRenderer,ve=ic(I,I.longestCutoffRange),ye=$e=>{if(le===$e)return;const je=[];je.push(Q0[$e]),ve.shouldRenderCutoff&&je.push("RENDER_CUTOFF"),ae=I.getOrCreateProgram("terrainRaster",{defines:je}),le=$e},be=I.colorModeForRenderPass(),we=new Xn(ee.LEQUAL,Xn.ReadWrite,I.depthRangeFor3D);sf.update(q);const ke=I.transform,Ne=oc(ke.zoom,P.exaggeration(),P.sourceCache._source.tileSize);let De=[0,0,0];if(ue){const $e=I.style.directionalLight,je=I.style.ambientLight;$e&&je&&(De=kp(I.style,$e,je))}{le=-1;const $e=ee.TRIANGLES,[je,et]=[P.gridIndexBuffer,P.gridSegments];for(const Ke of W){const tt=F.getTile(Ke),ut=pr.disabled,at=P.prevTerrainTileForTile[Ke.key],rt=P.terrainTileForTile[Ke.key];J0(at,rt)&&sf.newMorphing(Ke.key,at,rt,q,250),J.activeTexture.set(ee.TEXTURE0),tt.texture&&tt.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const bt=sf.getMorphValuesForProxy(Ke.key),Ft=bt?1:0;let Zt;bt&&(Zt={morphing:{srcDemTile:bt.from,dstDemTile:bt.to,phase:a.cw(bt.phase)}});const kt=Bx(Ke.projMatrix,Rg(Ke.canonical,ke.renderWorldCopies)?Ne/10:Ne,De);if(ye(Ft),!ae)continue;P.setupElevationDraw(tt,ae,Zt);const hn=Ke.toUnwrapped();ue&&ue.setupShadows(hn,ae),I.uploadCommonUniforms(J,ae,hn,null,ve),ae.draw(I,$e,we,ut,be,_r.backCCW,kt,"terrain_raster",P.gridBuffer,je,et)}}}}(m,this,this.proxySourceCache,u,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),u.splice(0,u.length))}renderBatch(u){if(this._drapedRenderBatches.length===0)return u+1;this.renderingToTexture=!0;const m=this.painter,w=this.painter.context,I=this.proxySourceCache,P=this.proxiedCoords[I.id],F=this._drapedRenderBatches.shift(),W=m.style.order,q=[];let J=0;for(const ee of P){const ae=I.getTileByID(ee.proxyTileKey),le=I.proxyCachedFBO[ee.key]?I.proxyCachedFBO[ee.key][u]:void 0,ue=le!==void 0?I.renderCache[le]:this.pool[J++],ve=le!==void 0;if(ae.texture=ue.tex,ve&&!ue.dirty){q.push(ae.tileID);continue}let ye;w.bindFramebuffer.set(ue.fb.framebuffer),this.renderedToTile=!1,ue.dirty&&(w.clear({color:a.bz.transparent,stencil:0}),ue.dirty=!1);for(let be=F.start;be<=F.end;++be){const we=m.style._mergedLayers[W[be]];if(we.isHidden(m.transform.zoom))continue;const ke=m.style.getLayerSourceCache(we),Ne=ke?this.proxyToSource[ee.key][ke.id]:[ee];if(!Ne)continue;const De=Ne;w.viewport.set([0,0,ue.fb.width,ue.fb.height]),ye!==(ke?ke.id:null)&&(this._setupStencil(ue,Ne,we,ke),ye=ke?ke.id:null),m.renderLayer(m,ke,we,De)}if(this._drapedRenderBatches.length===0)for(const be of this._pendingGroundEffectLayers){const we=m.style._mergedLayers[W[be]];if(we.isHidden(m.transform.zoom))continue;const ke=m.style.getLayerSourceCache(we),Ne=ke?this.proxyToSource[ee.key][ke.id]:[ee];if(!Ne)continue;const De=Ne;w.viewport.set([0,0,ue.fb.width,ue.fb.height]),ye!==(ke?ke.id:null)&&(this._setupStencil(ue,Ne,we,ke),ye=ke?ke.id:null),m.renderLayer(m,ke,we,De)}this.renderedToTile?(ue.dirty=!0,q.push(ae.tileID)):ve||--J,J===5&&(J=0,this.renderToBackBuffer(q))}return this.renderToBackBuffer(q),this.renderingToTexture=!1,w.bindFramebuffer.set(null),w.viewport.set([0,0,m.width,m.height]),F.end+1}postRender(){}isLayerOrderingCorrect(u){const m=u.order.length;let w=-1,I=m;for(let P=0;P<m;++P)this._style.isLayerDraped(u._mergedLayers[u.order[P]])?w=Math.max(w,P):I=Math.min(I,P);return I>w}getMinElevationBelowMSL(){let u=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{u=Math.min(u,m.dem.tree.minimums[0])}),u===0?u:(u-30)*this._exaggeration}raycast(u,m,w){if(!this._visibleDemTiles)return null;const I=this._visibleDemTiles.filter(P=>P.dem).map(P=>{const F=P.tileID,W=1<<F.overscaledZ,{x:q,y:J}=F.canonical,ee=q/W,ae=(q+1)/W,le=J/W,ue=(J+1)/W;return{minx:ee,miny:le,maxx:ae,maxy:ue,t:P.dem.tree.raycastRoot(ee,le,ae,ue,u,m,w),tile:P}});I.sort((P,F)=>(P.t!==null?P.t:Number.MAX_VALUE)-(F.t!==null?F.t:Number.MAX_VALUE));for(const P of I){if(P.t==null)return null;const F=P.tile.dem.tree.raycast(P.minx,P.miny,P.maxx,P.maxy,u,m,w);if(F!=null)return F}return null}_createFBO(){const u=this.painter.context,m=u.gl,w=this.drapeBufferSize;u.activeTexture.set(m.TEXTURE0);const I=new a.T(u,{width:w[0],height:w[1],data:null},m.RGBA8);I.bind(m.LINEAR,m.CLAMP_TO_EDGE);const P=u.createFramebuffer(w[0],w[1],!0,null);return P.colorAttachment.set(I.texture),P.depthAttachment=new wd(u,P.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=u.createRenderbuffer(u.gl.DEPTH_STENCIL,w[0],w[1]),this._stencilRef=0,P.depthAttachment.set(this._sharedDepthStencil),u.clear({stencil:0})):P.depthAttachment.set(this._sharedDepthStencil),u.extTextureFilterAnisotropic&&m.texParameterf(m.TEXTURE_2D,u.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,u.extTextureFilterAnisotropicMax),{fb:P,tex:I,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const u in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[u].hasTransition())return!0;return this._style.order.some(u=>{const m=this._style._mergedLayers[u],w=m.isHidden(this.painter.transform.zoom);return m.type==="hillshade"||m.type==="custom"?!w&&m.shouldRedrape():!w&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let u=!1;for(const w of this._style.getSources())if(w instanceof ji){u=!0;break}if(!u)return;const m={};for(let w=0;w<this._style.order.length;++w){const I=this._style._mergedLayers[this._style.order[w]],P=this._style.getLayerSourceCache(I);if(P&&!m[P.id]&&!I.isHidden(this.painter.transform.zoom)&&I.type==="line"&&I.widthExpression()instanceof a.a4){m[P.id]=!0;for(const F of this.proxyCoords){const W=this.proxyToSource[F.key][P.id];if(W)for(const q of W)this._clearRenderCacheForTile(P.id,q)}}}}_clearRasterLayersFromRenderCache(){let u=!1;for(const w in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[w]._source instanceof As){u=!0;break}if(!u)return;const m={};for(let w=0;w<this._style.order.length;++w){const I=this._style._mergedLayers[this._style.order[w]],P=this._style.getLayerSourceCache(I);if(!P||m[P.id]||I.isHidden(this.painter.transform.zoom)||I.type!=="raster")continue;const F=I.paint.get("raster-fade-duration");for(const W of this.proxyCoords){const q=this.proxyToSource[W.key][P.id];if(q)for(const J of q){const ee=Ju(P.getTile(J),P.findLoadedParent(J,0),P,this.painter.transform,F);(ee.opacity!==1||ee.mix!==0)&&this._clearRenderCacheForTile(P.id,J)}}}}_setupDrapedRenderBatches(){const u=this._style.order,m=u.length;if(m===0)return;const w=[];this._pendingGroundEffectLayers=[];let I,P=0,F=this._style._mergedLayers[u[P]];for(;!this._style.isLayerDraped(F)&&F.isHidden(this.painter.transform.zoom)&&++P<m;)F=this._style._mergedLayers[u[P]];for(;P<m;++P){const W=this._style._mergedLayers[u[P]];W.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(W)?I===void 0&&(I=P):(W.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(P),I!==void 0&&(w.push({start:I,end:P-1}),I=void 0)))}if(I!==void 0&&w.push({start:I,end:P-1}),w.length!==0){const W=w[w.length-1];this._pendingGroundEffectLayers.every(q=>q>W.end)||a.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=w}_setupRenderCache(u){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const F=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let W=0;W<F.length;++W){const q=Object.values(F[W]);m.renderCachePool.push(...q)}}return}this._clearRasterLayersFromRenderCache();const w=this.proxyCoords,I=this._tilesDirty;for(let F=w.length-1;F>=0;F--){const W=w[F];if(m.getTileByID(W.key),m.proxyCachedFBO[W.key]!==void 0){const q=u[W.key],J=this.proxyToSource[W.key];let ee=0;for(const ae in J){const le=J[ae],ue=q[ae];if(!ue||ue.length!==le.length||le.some((ve,ye)=>ve!==ue[ye]||I[ae]&&I[ae].hasOwnProperty(ve.key))){ee=-1;break}++ee}for(const ae in m.proxyCachedFBO[W.key])m.renderCache[m.proxyCachedFBO[W.key][ae]].dirty=ee<0||ee!==Object.values(q).length}}const P=[...this._drapedRenderBatches];P.sort((F,W)=>W.end-W.start-(F.end-F.start));for(const F of P)for(const W of w){if(m.proxyCachedFBO[W.key])continue;let q=m.renderCachePool.pop();q===void 0&&m.renderCache.length<50&&(q=m.renderCache.length,m.renderCache.push(this._createFBO())),q!==void 0&&(m.proxyCachedFBO[W.key]={},m.proxyCachedFBO[W.key][F.start]=q,m.renderCache[q].dirty=!0)}this._tilesDirty={}}_setupStencil(u,m,w,I){if(!I||!this._sourceTilesOverlap[I.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const P=this.painter.context,F=P.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let W;if(w.isTileClipped())W=m.length,this._overlapStencilMode.test={func:F.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);W=1,this._overlapStencilMode.test={func:F.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+W>255&&(P.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=W,this._overlapStencilMode.ref=this._stencilRef,w.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(u){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[u.key]),this._overlapStencilMode):pr.disabled}_renderTileClippingMasks(u,m){const w=this.painter,I=this.painter.context,P=I.gl;w._tileClippingMaskIDs={},I.setColorMode(Mr.disabled),I.setDepthMode(Xn.disabled);const F=w.getOrCreateProgram("clippingMask");for(const W of u){const q=w._tileClippingMaskIDs[W.key]=--m;F.draw(w,P.TRIANGLES,Xn.disabled,new pr({func:P.ALWAYS,mask:0},q,255,P.KEEP,P.KEEP,P.REPLACE),Mr.disabled,_r.disabled,wu(W.projMatrix),"$clipping",w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}}pointCoordinate(u){const m=this.painter.transform;if(u.x<0||u.x>m.width||u.y<0||u.y>m.height)return null;const w=[u.x,u.y,1,1];a.a6.vec4.transformMat4(w,w,m.pixelMatrixInverse),a.a6.vec4.scale(w,w,1/w[3]),w[0]/=m.worldSize,w[1]/=m.worldSize;const I=m._camera.position,P=a.bD(1,m.center.lat),F=[I[0],I[1],I[2]/P,0],W=a.a6.vec3.subtract([],w.slice(0,3),F);a.a6.vec3.normalize(W,W);const q=this.raycast(F,W,this._exaggeration);return q!==null&&q?(a.a6.vec3.scaleAndAdd(F,F,W,q),F[3]=F[2],F[2]*=P,F):null}_setupProxiedCoordsForOrtho(u,m,w){if(u.getSource()instanceof a.aD)return this._setupProxiedCoordsForImageSource(u,m,w);this._findCoveringTileCache[u.id]=this._findCoveringTileCache[u.id]||{};const I=this.proxiedCoords[u.id]=[],P=this.proxyCoords;for(let q=0;q<P.length;q++){const J=P[q],ee=this._findTileCoveringTileID(J,u);if(ee){const ae=this._createProxiedId(J,ee,w[J.key]&&w[J.key][u.id]);I.push(ae),this.proxyToSource[J.key][u.id]=[ae]}}let F=!1;const W=new Set;for(let q=0;q<m.length;q++){const J=u.getTile(m[q]);if(!J||!J.hasData())continue;const ee=this._findTileCoveringTileID(J.tileID,this.proxySourceCache);if(ee&&ee.tileID.canonical.z!==J.tileID.canonical.z){const ae=this.proxyToSource[ee.tileID.key][u.id],le=this._createProxiedId(ee.tileID,J,w[ee.tileID.key]&&w[ee.tileID.key][u.id]);ae?ae.splice(ae.length-1,0,le):this.proxyToSource[ee.tileID.key][u.id]=[le];const ue=this.proxyToSource[ee.tileID.key][u.id];W.has(ue)||W.add(ue),I.push(le),F=!0}}if(this._sourceTilesOverlap[u.id]=F,F&&this._debugParams.sortTilesHiZFirst)for(const q of W)q.sort((J,ee)=>ee.overscaledZ-J.overscaledZ)}_setupProxiedCoordsForImageSource(u,m,w){if(!u.getSource().loaded())return;const I=this.proxiedCoords[u.id]=[],P=this.proxyCoords,F=u.getSource(),W=F.tileID;if(!W)return;const q=new a.P(W.x,W.y)._div(1<<W.z),J=F.coordinates.map(a.a5.fromLngLat).reduce((ae,le)=>(ae.min.x=Math.min(ae.min.x,le.x-q.x),ae.min.y=Math.min(ae.min.y,le.y-q.y),ae.max.x=Math.max(ae.max.x,le.x-q.x),ae.max.y=Math.max(ae.max.y,le.y-q.y),ae),{min:new a.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),ee=(ae,le)=>{const ue=ae.wrap+ae.canonical.x/(1<<ae.canonical.z),ve=ae.canonical.y/(1<<ae.canonical.z),ye=a.ab/(1<<ae.canonical.z),be=le.wrap+le.canonical.x/(1<<le.canonical.z),we=le.canonical.y/(1<<le.canonical.z);return ue+ye<be+J.min.x||ue>be+J.max.x||ve+ye<we+J.min.y||ve>we+J.max.y};for(let ae=0;ae<P.length;ae++){const le=P[ae];for(let ue=0;ue<m.length;ue++){const ve=u.getTile(m[ue]);if(!ve||!ve.hasData()||ee(le,ve.tileID))continue;const ye=this._createProxiedId(le,ve,w[le.key]&&w[le.key][u.id]),be=this.proxyToSource[le.key][u.id];be?be.push(ye):this.proxyToSource[le.key][u.id]=[ye],I.push(ye)}}}_createProxiedId(u,m,w){let I=this.orthoMatrix;if(w){const P=w.find(F=>F.key===m.tileID.key);if(P)return P}if(m.tileID.key!==u.key){const P=u.canonical.z-m.tileID.canonical.z;let F,W,q;I=a.a6.mat4.create();const J=m.tileID.wrap-u.wrap<<u.overscaledZ;P>0?(F=a.ab>>P,W=F*((m.tileID.canonical.x<<P)-u.canonical.x+J),q=F*((m.tileID.canonical.y<<P)-u.canonical.y)):(F=a.ab<<-P,W=a.ab*(m.tileID.canonical.x-(u.canonical.x+J<<-P)),q=a.ab*(m.tileID.canonical.y-(u.canonical.y<<-P))),a.a6.mat4.ortho(I,0,F,0,F,0,1),a.a6.mat4.translate(I,I,[W,q,0])}return new Pg(m.tileID,u.key,I)}_findTileCoveringTileID(u,m){let w=m.getTile(u);if(w&&w.hasData())return w;const I=this._findCoveringTileCache[m.id],P=I[u.key];if(w=P?m.getTileByID(P):null,w&&w.hasData()||P===null)return w;let F=w?w.tileID:u,W=F.overscaledZ;const q=m.getSource().minzoom,J=[];if(!P){const ae=m.getSource().maxzoom;if(u.canonical.z>=ae){const le=u.canonical.z-ae;m.getSource().reparseOverscaled?(W=Math.max(u.canonical.z+2,m.transform.tileZoom),F=new a.aA(W,u.wrap,ae,u.canonical.x>>le,u.canonical.y>>le)):le!==0&&(W=ae,F=new a.aA(W,u.wrap,ae,u.canonical.x>>le,u.canonical.y>>le))}F.key!==u.key&&(J.push(F.key),w=m.getTile(F))}const ee=ae=>{J.forEach(le=>{I[le]=ae}),J.length=0};for(W-=1;W>=q&&(!w||!w.hasData());W--){w&&ee(w.tileID.key);const ae=F.calculateScaledKey(W);if(w=m.getTileByID(ae),w&&w.hasData())break;const le=I[ae];if(le===null)break;le===void 0?J.push(ae):w=m.getTileByID(le)}return ee(w?w.tileID.key:null),w&&w.hasData()?w:null}findDEMTileFor(u){return this.enabled?this._findTileCoveringTileID(u,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(u,m){let w=this._tilesDirty[u];w||(w=this._tilesDirty[u]={}),w[m.key]=!0}}function Za(b,u,m){const w=function(W,q,J){const ee=a.a6.vec3.dot(q,W),ae=a.a6.vec3.dot(J,[.2126,.7152,.0722]),le=(ve,ye,be)=>(1-be)*ve+be*ye,ue=le(1-.3*Math.min(ae,1),1,Math.min(ee+1,1));return le(.92,1,Math.asin(a.ap(q[2],-1,1))/Math.PI+.5)*ue}(b,[0,0,1],u),I=[0,0,0];a.a6.vec3.scale(I,m.slice(0,3),w);const P=[0,0,0];a.a6.vec3.scale(P,u.slice(0,3),b[2]);const F=[0,0,0];return a.a6.vec3.add(F,I,P),a.cb(F)}const of=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],kx=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class ba{static cacheKey(u,m,w,I){let P=`${m}${I?I.cacheKey:""}`;for(const F of w)u.usedDefines.includes(F)&&(P+=`/${F}`);return P}constructor(u,m,w,I,P,F){const W=u.gl;this.program=W.createProgram(),this.configuration=I,this.name=m,this.fixedDefines=[...F];const q=I?I.getBinderAttributes():[],J=(w.staticAttributes||[]).concat(q);let ee=I?I.defines():[];ee=ee.concat(F.map(be=>`#define ${be}`));const ae=`#version 300 es
`;let le=ae+ee.concat("precision mediump float;",Zu,bu.fragmentSource).join(`
`);for(const be of w.fragmentIncludes)le+=`
${Ks[be]}`;le+=`
${w.fragmentSource}`;let ue=ae+ee.concat("precision highp float;",Zu,bu.vertexSource).join(`
`);for(const be of w.vertexIncludes)ue+=`
${Ks[be]}`;ue+=`
${w.vertexSource}`;const ve=W.createShader(W.FRAGMENT_SHADER);if(W.isContextLost())return void(this.failedToCreate=!0);W.shaderSource(ve,le),W.compileShader(ve),W.attachShader(this.program,ve);const ye=W.createShader(W.VERTEX_SHADER);if(W.isContextLost())this.failedToCreate=!0;else{W.shaderSource(ye,ue),W.compileShader(ye),W.attachShader(this.program,ye),this.attributes={},this.numAttributes=J.length;for(let be=0;be<this.numAttributes;be++)if(J[be]){const we=J[be].startsWith("a_")?J[be]:`a_${J[be]}`;W.bindAttribLocation(this.program,be,we),this.attributes[we]=be}W.linkProgram(this.program),W.deleteShader(ye),W.deleteShader(ve),this.fixedUniforms=P(u),this.binderUniforms=I?I.getUniforms(u):[],(F.includes("TERRAIN")||m.indexOf("symbol")!==-1||m.indexOf("circle")!==-1)&&(this.terrainUniforms=(be=>({u_dem:new a.bJ(be),u_dem_prev:new a.bJ(be),u_dem_tl:new a.bG(be),u_dem_scale:new a.bI(be),u_dem_tl_prev:new a.bG(be),u_dem_scale_prev:new a.bI(be),u_dem_size:new a.bI(be),u_dem_lerp:new a.bI(be),u_exaggeration:new a.bI(be),u_depth:new a.bJ(be),u_depth_size_inv:new a.bG(be),u_depth_range_unpack:new a.bG(be),u_occluder_half_size:new a.bI(be),u_occlusion_depth_offset:new a.bI(be),u_meter_to_dem:new a.bI(be),u_label_plane_matrix_inv:new a.bF(be)}))(u)),F.includes("GLOBE")&&(this.globeUniforms=(be=>({u_tile_tl_up:new a.bH(be),u_tile_tr_up:new a.bH(be),u_tile_br_up:new a.bH(be),u_tile_bl_up:new a.bH(be),u_tile_up_scale:new a.bI(be)}))(u)),F.includes("FOG")&&(this.fogUniforms=(be=>({u_fog_matrix:new a.bF(be),u_fog_range:new a.bG(be),u_fog_color:new a.c6(be),u_fog_horizon_blend:new a.bI(be),u_fog_vertical_limit:new a.bG(be),u_fog_temporal_offset:new a.bI(be),u_frustum_tl:new a.bH(be),u_frustum_tr:new a.bH(be),u_frustum_br:new a.bH(be),u_frustum_bl:new a.bH(be),u_globe_pos:new a.bH(be),u_globe_radius:new a.bI(be),u_globe_transition:new a.bI(be),u_is_globe:new a.bJ(be),u_viewport:new a.bG(be)}))(u)),F.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(be=>({u_cutoff_params:new a.c6(be)}))(u)),F.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(be=>({u_lighting_ambient_color:new a.bH(be),u_lighting_directional_dir:new a.bH(be),u_lighting_directional_color:new a.bH(be),u_ground_radiance:new a.bH(be)}))(u)),F.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(be=>({u_light_matrix_0:new a.bF(be),u_light_matrix_1:new a.bF(be),u_fade_range:new a.bG(be),u_shadow_normal_offset:new a.bH(be),u_shadow_intensity:new a.bI(be),u_shadow_texel_size:new a.bI(be),u_shadow_map_resolution:new a.bI(be),u_shadow_direction:new a.bH(be),u_shadow_bias:new a.bH(be),u_shadowmap_0:new a.bJ(be),u_shadowmap_1:new a.bJ(be)}))(u))}}setTerrainUniformValues(u,m){if(!this.terrainUniforms)return;const w=this.terrainUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in m)w[I]&&w[I].set(this.program,I,m[I])}}setGlobeUniformValues(u,m){if(!this.globeUniforms)return;const w=this.globeUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in m)w[I]&&w[I].set(this.program,I,m[I])}}setFogUniformValues(u,m){if(!this.fogUniforms)return;const w=this.fogUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in m)w[I].set(this.program,I,m[I])}}setCutoffUniformValues(u,m){if(!this.cutoffUniforms)return;const w=this.cutoffUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in m)w[I].set(this.program,I,m[I])}}setLightsUniformValues(u,m){if(!this.lightsUniforms)return;const w=this.lightsUniforms;if(!this.failedToCreate){u.program.set(this.program);for(const I in m)w[I].set(this.program,I,m[I])}}setShadowUniformValues(u,m){if(this.failedToCreate||!this.shadowUniforms)return;const w=this.shadowUniforms;u.program.set(this.program);for(const I in m)w[I].set(this.program,I,m[I])}_drawDebugWireframe(u,m,w,I,P,F,W,q,J,ee){const ae=u.options.wireframe;if(ae.terrain===!1&&ae.layers2D===!1&&ae.layers3D===!1)return;const le=u.context;if(!(!(!ae.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!ae.layers2D||u._terrain&&u._terrain.renderingToTexture||!of.includes(this.name))||!(!ae.layers3D||!kx.includes(this.name))))return;const ue=le.gl,ve=u.wireframeDebugCache.getLinesFromTrianglesBuffer(u.frameCounter,P,le);if(!ve)return;const ye=[...this.fixedDefines];ye.push("DEBUG_WIREFRAME");const be=u.getOrCreateProgram(this.name,{config:this.configuration,defines:ye});le.program.set(be.program);const we=(De,$e,je)=>{if($e[De]&&je[De])for(const et in $e[De])je[De][et]&&je[De][et].set(je.program,et,$e[De][et].current)};J&&J.setUniforms(be.program,le,be.binderUniforms,W,{zoom:q}),we("fixedUniforms",this,be),we("terrainUniforms",this,be),we("globeUniforms",this,be),we("fogUniforms",this,be),we("lightsUniforms",this,be),we("shadowUniforms",this,be),ve.bind(),le.setColorMode(new Mr([ue.ONE,ue.ONE_MINUS_SRC_ALPHA,ue.ZERO,ue.ONE],a.bz.transparent,[!0,!0,!0,!1])),le.setDepthMode(new Xn(m.func===ue.LESS?ue.LEQUAL:m.func,Xn.ReadOnly,m.range)),le.setStencilMode(pr.disabled);const ke=3*F.primitiveLength*2,Ne=3*F.primitiveOffset*2*2;ee&&ee>1?ue.drawElementsInstanced(ue.LINES,ke,ue.UNSIGNED_SHORT,Ne,ee):ue.drawElements(ue.LINES,ke,ue.UNSIGNED_SHORT,Ne),P.bind(),le.program.set(this.program),le.setDepthMode(m),le.setStencilMode(w),le.setColorMode(I)}draw(u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye,be){const we=u.context,ke=we.gl;if(this.failedToCreate)return;we.program.set(this.program),we.setDepthMode(w),we.setStencilMode(I),we.setColorMode(P),we.setCullFace(F);for(const $e of Object.keys(this.fixedUniforms))this.fixedUniforms[$e].set(this.program,$e,W[$e]);ve&&ve.setUniforms(this.program,we,this.binderUniforms,le,{zoom:ue});const Ne={[ke.POINTS]:1,[ke.LINES]:2,[ke.TRIANGLES]:3,[ke.LINE_STRIP]:1}[m],De=be&&be>0?1:void 0;for(const $e of ae.get()){const je=$e.vaos||($e.vaos={});(je[q]||(je[q]=new Ku)).bind(we,this,J,ve?ve.getPaintVertexBuffers():[],ee,$e.vertexOffset,ye||[],De),be&&be>1?ke.drawElementsInstanced(m,$e.primitiveLength*Ne,ke.UNSIGNED_SHORT,$e.primitiveOffset*Ne*2,be):ee?ke.drawElements(m,$e.primitiveLength*Ne,ke.UNSIGNED_SHORT,$e.primitiveOffset*Ne*2):ke.drawArrays(m,$e.vertexOffset,$e.vertexLength),m===ke.TRIANGLES&&ee&&this._drawDebugWireframe(u,w,I,P,ee,$e,le,ue,ve,be)}}}function lo(b,u){const m=Math.pow(2,u.tileID.overscaledZ),w=u.tileSize*Math.pow(2,b.transform.tileZoom)/m,I=w*(u.tileID.canonical.x+u.tileID.wrap*m),P=w*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture?u.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/a.ak(u,1,b.transform.tileZoom),u_pixel_coord_upper:[I>>16,P>>16],u_pixel_coord_lower:[65535&I,65535&P]}}const Xp=a.a6.mat4.create(),Lg=(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye)=>{const be=u.style.light,we=be.properties.get("position"),ke=[we.x,we.y,we.z],Ne=a.a6.mat3.create();be.properties.get("anchor")==="viewport"&&(a.a6.mat3.fromRotation(Ne,-u.transform.angle),a.a6.vec3.transformMat3(ke,ke,Ne));const De=be.properties.get("color"),$e=u.transform,je={u_matrix:b,u_lightpos:ke,u_lightintensity:be.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_vertical_gradient:+m,u_opacity:w,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:I,u_edge_radius:P,u_width_scale:F,u_flood_light_color:le,u_vertical_scale:ue,u_flood_light_intensity:ve,u_ground_shadow_factor:ye};return $e.projection.name==="globe"&&(je.u_tile_id=[W.canonical.x,W.canonical.y,1<<W.canonical.z],je.u_zoom_transition=J,je.u_inv_rot_matrix=ae,je.u_merc_center=ee,je.u_up_dir=$e.projection.upVector(new a.bP(0,0,0),ee[0]*a.ab,ee[1]*a.ab),je.u_height_lift=q),je},e_=(b,u,m,w)=>({u_matrix:b,u_edge_radius:u,u_width_scale:m,u_vertical_scale:w}),Dg=(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve)=>{const ye=Lg(b,u,m,w,I,P,F,W,J,ee,ae,le,ue,ve,1,[0,0,0]),be={u_height_factor:-Math.pow(2,W.overscaledZ)/q.tileSize/8};return a.l(ye,lo(u,q),be)},qp=(b,u)=>({u_matrix:b,u_emissive_strength:u}),Bg=(b,u,m,w)=>a.l(qp(b,u),lo(m,w)),t_=(b,u,m)=>({u_matrix:b,u_world:m,u_emissive_strength:u}),lf=(b,u,m,w,I)=>a.l(Bg(b,u,m,w),{u_world:I}),Ox=(b,u,m,w)=>{const I=a.ab/m.tileSize;return{u_matrix:b,u_camera_to_center_distance:u.getCameraToCenterDistance(w),u_extrude_scale:[u.pixelsToGLUnits[0]/I,u.pixelsToGLUnits[1]/I]}},n_=(b,u,m=1)=>({u_matrix:b,u_color:u.toRenderColor(null),u_overlay:0,u_overlay_scale:m}),Zp=a.a6.mat4.create(),kg=(b,u,m,w,I,P,F)=>{const W=b.transform,q=W.projection.name==="globe",J=q?a.cI(W.zoom,u.canonical)*W._pixelsPerMercatorPixel:a.ak(m,1,P),ee={u_matrix:u.projMatrix,u_extrude_scale:J,u_intensity:F,u_inv_rot_matrix:Zp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(q){ee.u_inv_rot_matrix=w,ee.u_merc_center=I,ee.u_tile_id=[u.canonical.x,u.canonical.y,1<<u.canonical.z],ee.u_zoom_transition=a.a9(W.zoom);const ae=I[0]*a.ab,le=I[1]*a.ab;ee.u_up_dir=W.projection.upVector(new a.bP(0,0,0),ae,le)}return ee};function Yp(b,[u,m,w,I],[P,F]){if(P===F)return[0,0,0,0];const W=255*(b-1)/(b*(F-P));return[u*W,m*W,w*W,I*W]}function Sd(b,u,[m,w]){return m===w?0:.5/b+(u-m)*(b-1)/(b*(w-m))}const Ad=(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye,be,we,ke,Ne,De)=>({u_matrix:b,u_normalize_matrix:u,u_globe_matrix:m,u_merc_matrix:w,u_grid_matrix:I,u_tl_parent:P,u_scale_parent:J,u_fade_t:ee.mix,u_opacity:ee.opacity*ae.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ae.paint.get("raster-brightness-min"),u_brightness_high:ae.paint.get("raster-brightness-max"),u_saturation_factor:a.cJ(ae.paint.get("raster-saturation")),u_contrast_factor:a.cK(ae.paint.get("raster-contrast")),u_spin_weights:Og(ae.paint.get("raster-hue-rotate")),u_perspective_transform:le,u_raster_elevation:ue,u_zoom_transition:F,u_merc_center:W,u_cutoff_params:q,u_colorization_mix:Yp(a.cL,ye,we),u_colorization_offset:Sd(a.cL,be,we),u_color_ramp:ve,u_texture_offset:[Ne/(ke+2*Ne),ke/(ke+2*Ne)],u_texture_res:[ke+2*Ne,ke+2*Ne],u_emissive_strength:De});function Og(b){b*=Math.PI/180;const u=Math.sin(b),m=Math.cos(b);return[(2*m+1)/3,(-Math.sqrt(3)*u-m+1)/3,(Math.sqrt(3)*u-m+1)/3]}const dl=.05,r_=(b,u,m,w,I,P,F,W,q,J,ee,ae)=>({u_matrix:b,u_normalize_matrix:u,u_globe_matrix:m,u_merc_matrix:w,u_grid_matrix:I,u_tl_parent:P,u_scale_parent:J,u_fade_t:ee.mix,u_opacity:ee.opacity,u_image0:0,u_image1:1,u_raster_elevation:ae,u_zoom_transition:F,u_merc_center:W,u_cutoff_params:q}),Td=(b,u,m,w,I,P,F,W,q,J)=>({u_particle_texture:b,u_particle_texture_side_len:u,u_tile_offset:m,u_velocity:w,u_color_ramp:P,u_velocity_res:I,u_max_speed:F,u_uv_offset:W,u_data_scale:[255*q[0],255*q[1]],u_data_offset:J,u_particle_pos_scale:1.1,u_particle_pos_offset:[dl,dl]}),Kp=(b,u,m,w,I,P,F,W,q,J)=>({u_particle_texture:b,u_particle_texture_side_len:u,u_velocity:m,u_velocity_res:w,u_max_speed:I,u_speed_factor:P,u_reset_rate:F,u_rand_seed:Math.random(),u_uv_offset:W,u_data_scale:[255*q[0],255*q[1]],u_data_offset:J,u_particle_pos_scale:1.1,u_particle_pos_offset:[dl,dl]}),Il=a.a6.mat4.create(),i_=(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye,be,we,ke,Ne,De)=>{const $e=I.transform,je={u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:$e.getCameraToCenterDistance(ke),u_rotate_symbol:+m,u_aspect_ratio:$e.width/$e.height,u_fade_change:I.options.fadeDuration?I.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:F,u_coord_matrix:W,u_is_text:+J,u_elevation_from_sea:q?1:0,u_pitch_with_map:+w,u_texsize:ee,u_texsize_icon:ae,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Il,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Il,u_up_vector:[0,-1,0],u_color_adj_mat:Ne,u_icon_transition:De||0,u_gamma_scale:w?I.transform.getCameraToCenterDistance(ke)*Math.cos(I.terrain?0:I.transform._pitch):1,u_device_pixel_ratio:a.q.devicePixelRatio,u_is_halo:+le};return ke.name==="globe"&&(je.u_tile_id=[ue.canonical.x,ue.canonical.y,1<<ue.canonical.z],je.u_zoom_transition=ve,je.u_inv_rot_matrix=be,je.u_merc_center=ye,je.u_camera_forward=$e._camera.forward(),je.u_ecef_origin=a.cM($e.globeMatrix,ue.toUnwrapped()),je.u_tile_matrix=Float32Array.from($e.globeMatrix),je.u_up_vector=we),je},Fx=(b,u,m,w)=>({u_matrix:b,u_emissive_strength:u,u_opacity:m,u_color:w}),Vc=(b,u,m,w,I,P,F,W,q)=>a.l(function(J,ee,ae,le,ue,ve){const{width:ye,height:be}=le.imageManager.getPixelSize(ee),we=Math.pow(2,ve.tileID.overscaledZ),ke=ve.tileSize*Math.pow(2,le.transform.tileZoom)/we,Ne=ke*(ve.tileID.canonical.x+ve.tileID.wrap*we),De=ke*ve.tileID.canonical.y;return{u_image:0,u_pattern_tl:ae.tl,u_pattern_br:ae.br,u_texsize:[ye,be],u_pattern_size:ae.displaySize,u_pattern_units_to_pixels:ue?[le.transform.width,-1*le.transform.height]:[1/a.ak(ve,1,le.transform.tileZoom),1/a.ak(ve,1,le.transform.tileZoom)],u_pixel_coord_upper:[Ne>>16,De>>16],u_pixel_coord_lower:[65535&Ne,65535&De]}}(0,P,F,w,W,q),{u_matrix:b,u_emissive_strength:u,u_opacity:m}),Rl=new Float32Array(a.a6.mat4.identity([])),Fn=(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue=[0,0,0],ve)=>{const ye=I.style.light,be=ye.properties.get("position"),we=[-be.x,-be.y,be.z],ke=a.a6.mat3.create();ye.properties.get("anchor")==="viewport"&&(a.a6.mat3.fromRotation(ke,-I.transform.angle),a.a6.vec3.transformMat3(we,we,ke));const Ne=ee.alphaMode==="MASK",De=ye.properties.get("color").toRenderColor(null),$e=le.paint.get("model-ambient-occlusion-intensity"),je=le.paint.get("model-color").constantOr(a.bz.white).toRenderColor(null),et=le.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:b,u_lighting_matrix:u,u_normal_matrix:m,u_node_matrix:w||Rl,u_lightpos:we,u_lightintensity:ye.properties.get("intensity"),u_lightcolor:[De.r,De.g,De.b],u_camera_pos:ue,u_opacity:P,u_baseTextureIsAlpha:0,u_alphaMask:+Ne,u_alphaCutoff:ee.alphaCutoff,u_baseColorFactor:[F.r,F.g,F.b,F.a],u_emissiveFactor:[W[0],W[1],W[2],1],u_metallicFactor:q,u_roughnessFactor:J,u_baseColorTexture:la.BaseColor,u_metallicRoughnessTexture:la.MetallicRoughness,u_normalTexture:la.Normal,u_occlusionTexture:la.Occlusion,u_emissionTexture:la.Emission,u_lutTexture:la.LUT,u_color_mix:[je.r,je.g,je.b,et],u_aoIntensity:$e,u_emissive_strength:ae,u_occlusionTextureTransform:ve||[0,0,0,0]}},sr=(b,u=Rl,m=Rl)=>({u_matrix:b,u_instance:u,u_node_matrix:m}),Jp={fillExtrusion:b=>({u_matrix:new a.bF(b),u_lightpos:new a.bH(b),u_lightintensity:new a.bI(b),u_lightcolor:new a.bH(b),u_vertical_gradient:new a.bI(b),u_opacity:new a.bI(b),u_edge_radius:new a.bI(b),u_width_scale:new a.bI(b),u_ao:new a.bG(b),u_tile_id:new a.bH(b),u_zoom_transition:new a.bI(b),u_inv_rot_matrix:new a.bF(b),u_merc_center:new a.bG(b),u_up_dir:new a.bH(b),u_height_lift:new a.bI(b),u_flood_light_color:new a.bH(b),u_vertical_scale:new a.bI(b),u_flood_light_intensity:new a.bI(b),u_ground_shadow_factor:new a.bH(b)}),fillExtrusionDepth:b=>({u_matrix:new a.bF(b),u_edge_radius:new a.bI(b),u_width_scale:new a.bI(b),u_vertical_scale:new a.bI(b)}),fillExtrusionPattern:b=>({u_matrix:new a.bF(b),u_lightpos:new a.bH(b),u_lightintensity:new a.bI(b),u_lightcolor:new a.bH(b),u_vertical_gradient:new a.bI(b),u_height_factor:new a.bI(b),u_edge_radius:new a.bI(b),u_width_scale:new a.bI(b),u_ao:new a.bG(b),u_tile_id:new a.bH(b),u_zoom_transition:new a.bI(b),u_inv_rot_matrix:new a.bF(b),u_merc_center:new a.bG(b),u_up_dir:new a.bH(b),u_height_lift:new a.bI(b),u_image:new a.bJ(b),u_texsize:new a.bG(b),u_pixel_coord_upper:new a.bG(b),u_pixel_coord_lower:new a.bG(b),u_tile_units_to_pixels:new a.bI(b),u_opacity:new a.bI(b)}),fillExtrusionGroundEffect:b=>({u_matrix:new a.bF(b),u_opacity:new a.bI(b),u_ao_pass:new a.bI(b),u_meter_to_tile:new a.bI(b),u_ao:new a.bG(b),u_flood_light_intensity:new a.bI(b),u_flood_light_color:new a.bH(b),u_attenuation:new a.bI(b),u_edge_radius:new a.bI(b),u_fb:new a.bJ(b),u_fb_size:new a.bI(b),u_dynamic_offset:new a.bI(b)}),fill:b=>({u_matrix:new a.bF(b),u_emissive_strength:new a.bI(b)}),fillPattern:b=>({u_matrix:new a.bF(b),u_emissive_strength:new a.bI(b),u_image:new a.bJ(b),u_texsize:new a.bG(b),u_pixel_coord_upper:new a.bG(b),u_pixel_coord_lower:new a.bG(b),u_tile_units_to_pixels:new a.bI(b)}),fillOutline:b=>({u_matrix:new a.bF(b),u_emissive_strength:new a.bI(b),u_world:new a.bG(b)}),fillOutlinePattern:b=>({u_matrix:new a.bF(b),u_emissive_strength:new a.bI(b),u_world:new a.bG(b),u_image:new a.bJ(b),u_texsize:new a.bG(b),u_pixel_coord_upper:new a.bG(b),u_pixel_coord_lower:new a.bG(b),u_tile_units_to_pixels:new a.bI(b)}),circle:a.cN,collisionBox:b=>({u_matrix:new a.bF(b),u_camera_to_center_distance:new a.bI(b),u_extrude_scale:new a.bG(b)}),collisionCircle:b=>({u_matrix:new a.bF(b),u_inv_matrix:new a.bF(b),u_camera_to_center_distance:new a.bI(b),u_viewport_size:new a.bG(b)}),debug:b=>({u_color:new a.cu(b),u_matrix:new a.bF(b),u_overlay:new a.bJ(b),u_overlay_scale:new a.bI(b)}),clippingMask:b=>({u_matrix:new a.bF(b)}),heatmap:b=>({u_extrude_scale:new a.bI(b),u_intensity:new a.bI(b),u_matrix:new a.bF(b),u_inv_rot_matrix:new a.bF(b),u_merc_center:new a.bG(b),u_tile_id:new a.bH(b),u_zoom_transition:new a.bI(b),u_up_dir:new a.bH(b)}),heatmapTexture:b=>({u_image:new a.bJ(b),u_color_ramp:new a.bJ(b),u_opacity:new a.bI(b)}),hillshade:b=>({u_matrix:new a.bF(b),u_image:new a.bJ(b),u_latrange:new a.bG(b),u_light:new a.bG(b),u_shadow:new a.cu(b),u_highlight:new a.cu(b),u_emissive_strength:new a.bI(b),u_accent:new a.cu(b)}),hillshadePrepare:b=>({u_matrix:new a.bF(b),u_image:new a.bJ(b),u_dimension:new a.bG(b),u_zoom:new a.bI(b)}),line:a.cO,linePattern:a.cP,raster:b=>({u_matrix:new a.bF(b),u_normalize_matrix:new a.bF(b),u_globe_matrix:new a.bF(b),u_merc_matrix:new a.bF(b),u_grid_matrix:new a.cv(b),u_tl_parent:new a.bG(b),u_scale_parent:new a.bI(b),u_fade_t:new a.bI(b),u_opacity:new a.bI(b),u_image0:new a.bJ(b),u_image1:new a.bJ(b),u_brightness_low:new a.bI(b),u_brightness_high:new a.bI(b),u_saturation_factor:new a.bI(b),u_contrast_factor:new a.bI(b),u_spin_weights:new a.bH(b),u_perspective_transform:new a.bG(b),u_raster_elevation:new a.bI(b),u_zoom_transition:new a.bI(b),u_merc_center:new a.bG(b),u_cutoff_params:new a.c6(b),u_colorization_mix:new a.c6(b),u_colorization_offset:new a.bI(b),u_color_ramp:new a.bJ(b),u_texture_offset:new a.bG(b),u_texture_res:new a.bG(b),u_emissive_strength:new a.bI(b)}),rasterParticle:b=>({u_matrix:new a.bF(b),u_normalize_matrix:new a.bF(b),u_globe_matrix:new a.bF(b),u_merc_matrix:new a.bF(b),u_grid_matrix:new a.cv(b),u_tl_parent:new a.bG(b),u_scale_parent:new a.bI(b),u_fade_t:new a.bI(b),u_opacity:new a.bI(b),u_image0:new a.bJ(b),u_image1:new a.bJ(b),u_raster_elevation:new a.bI(b),u_zoom_transition:new a.bI(b),u_merc_center:new a.bG(b),u_cutoff_params:new a.c6(b)}),rasterParticleTexture:b=>({u_texture:new a.bJ(b),u_opacity:new a.bI(b)}),rasterParticleDraw:b=>({u_particle_texture:new a.bJ(b),u_particle_texture_side_len:new a.bI(b),u_tile_offset:new a.bG(b),u_velocity:new a.bJ(b),u_color_ramp:new a.bJ(b),u_velocity_res:new a.bG(b),u_max_speed:new a.bI(b),u_uv_offset:new a.bG(b),u_data_scale:new a.bG(b),u_data_offset:new a.bI(b),u_particle_pos_scale:new a.bI(b),u_particle_pos_offset:new a.bG(b)}),rasterParticleUpdate:b=>({u_particle_texture:new a.bJ(b),u_particle_texture_side_len:new a.bI(b),u_velocity:new a.bJ(b),u_velocity_res:new a.bG(b),u_max_speed:new a.bI(b),u_speed_factor:new a.bI(b),u_reset_rate:new a.bI(b),u_rand_seed:new a.bI(b),u_uv_offset:new a.bG(b),u_data_scale:new a.bG(b),u_data_offset:new a.bI(b),u_particle_pos_scale:new a.bI(b),u_particle_pos_offset:new a.bG(b)}),symbol:b=>({u_is_size_zoom_constant:new a.bJ(b),u_is_size_feature_constant:new a.bJ(b),u_size_t:new a.bI(b),u_size:new a.bI(b),u_camera_to_center_distance:new a.bI(b),u_rotate_symbol:new a.bJ(b),u_aspect_ratio:new a.bI(b),u_fade_change:new a.bI(b),u_matrix:new a.bF(b),u_label_plane_matrix:new a.bF(b),u_coord_matrix:new a.bF(b),u_is_text:new a.bJ(b),u_elevation_from_sea:new a.bJ(b),u_pitch_with_map:new a.bJ(b),u_texsize:new a.bG(b),u_texsize_icon:new a.bG(b),u_texture:new a.bJ(b),u_texture_icon:new a.bJ(b),u_gamma_scale:new a.bI(b),u_device_pixel_ratio:new a.bI(b),u_tile_id:new a.bH(b),u_zoom_transition:new a.bI(b),u_inv_rot_matrix:new a.bF(b),u_merc_center:new a.bG(b),u_camera_forward:new a.bH(b),u_tile_matrix:new a.bF(b),u_up_vector:new a.bH(b),u_ecef_origin:new a.bH(b),u_is_halo:new a.bJ(b),u_icon_transition:new a.bI(b),u_color_adj_mat:new a.bF(b)}),background:b=>({u_matrix:new a.bF(b),u_emissive_strength:new a.bI(b),u_opacity:new a.bI(b),u_color:new a.cu(b)}),backgroundPattern:b=>({u_matrix:new a.bF(b),u_emissive_strength:new a.bI(b),u_opacity:new a.bI(b),u_image:new a.bJ(b),u_pattern_tl:new a.bG(b),u_pattern_br:new a.bG(b),u_texsize:new a.bG(b),u_pattern_size:new a.bG(b),u_pixel_coord_upper:new a.bG(b),u_pixel_coord_lower:new a.bG(b),u_pattern_units_to_pixels:new a.bG(b)}),terrainRaster:b=>({u_matrix:new a.bF(b),u_image0:new a.bJ(b),u_skirt_height:new a.bI(b),u_ground_shadow_factor:new a.bH(b)}),skybox:b=>({u_matrix:new a.bF(b),u_sun_direction:new a.bH(b),u_cubemap:new a.bJ(b),u_opacity:new a.bI(b),u_temporal_offset:new a.bI(b)}),skyboxGradient:b=>({u_matrix:new a.bF(b),u_color_ramp:new a.bJ(b),u_center_direction:new a.bH(b),u_radius:new a.bI(b),u_opacity:new a.bI(b),u_temporal_offset:new a.bI(b)}),skyboxCapture:b=>({u_matrix_3f:new a.cv(b),u_sun_direction:new a.bH(b),u_sun_intensity:new a.bI(b),u_color_tint_r:new a.c6(b),u_color_tint_m:new a.c6(b),u_luminance:new a.bI(b)}),globeRaster:b=>({u_proj_matrix:new a.bF(b),u_globe_matrix:new a.bF(b),u_normalize_matrix:new a.bF(b),u_merc_matrix:new a.bF(b),u_zoom_transition:new a.bI(b),u_merc_center:new a.bG(b),u_image0:new a.bJ(b),u_grid_matrix:new a.cv(b),u_skirt_height:new a.bI(b),u_far_z_cutoff:new a.bI(b),u_frustum_tl:new a.bH(b),u_frustum_tr:new a.bH(b),u_frustum_br:new a.bH(b),u_frustum_bl:new a.bH(b),u_globe_pos:new a.bH(b),u_globe_radius:new a.bI(b),u_viewport:new a.bG(b)}),globeAtmosphere:b=>({u_frustum_tl:new a.bH(b),u_frustum_tr:new a.bH(b),u_frustum_br:new a.bH(b),u_frustum_bl:new a.bH(b),u_horizon:new a.bI(b),u_transition:new a.bI(b),u_fadeout_range:new a.bI(b),u_color:new a.c6(b),u_high_color:new a.c6(b),u_space_color:new a.c6(b),u_temporal_offset:new a.bI(b),u_horizon_angle:new a.bI(b)}),model:b=>({u_matrix:new a.bF(b),u_lighting_matrix:new a.bF(b),u_normal_matrix:new a.bF(b),u_node_matrix:new a.bF(b),u_lightpos:new a.bH(b),u_lightintensity:new a.bI(b),u_lightcolor:new a.bH(b),u_camera_pos:new a.bH(b),u_opacity:new a.bI(b),u_baseColorFactor:new a.c6(b),u_emissiveFactor:new a.c6(b),u_metallicFactor:new a.bI(b),u_roughnessFactor:new a.bI(b),u_baseTextureIsAlpha:new a.bJ(b),u_alphaMask:new a.bJ(b),u_alphaCutoff:new a.bI(b),u_baseColorTexture:new a.bJ(b),u_metallicRoughnessTexture:new a.bJ(b),u_normalTexture:new a.bJ(b),u_occlusionTexture:new a.bJ(b),u_emissionTexture:new a.bJ(b),u_lutTexture:new a.bJ(b),u_color_mix:new a.c6(b),u_aoIntensity:new a.bI(b),u_emissive_strength:new a.bI(b),u_occlusionTextureTransform:new a.c6(b)}),modelDepth:b=>({u_matrix:new a.bF(b),u_instance:new a.bF(b),u_node_matrix:new a.bF(b)}),groundShadow:b=>({u_matrix:new a.bF(b),u_ground_shadow_factor:new a.bH(b)}),stars:b=>({u_matrix:new a.bF(b),u_up:new a.bH(b),u_right:new a.bH(b),u_intensity_multiplier:new a.bI(b)}),occlusion:b=>({u_matrix:new a.bF(b),u_anchorPos:new a.bH(b),u_screenSizePx:new a.bG(b),u_occluderSizePx:new a.bG(b),u_color:new a.c6(b)})};class xo{constructor(u,m,w,I){this.id=xo.uniqueIdxCounter,xo.uniqueIdxCounter++,this.context=u;const P=u.gl;this.buffer=P.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),u.bindElementBuffer.set(this.buffer),P.bufferData(P.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||I||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(u){this.id=xo.uniqueIdxCounter,xo.uniqueIdxCounter++;const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,u.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}xo.uniqueIdxCounter=0;const Qu={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Yn{constructor(u,m,w,I,P,F){this.length=m.length,this.attributes=w,this.itemSize=m.bytesPerElement,this.dynamicDraw=I,this.instanceCount=F,this.context=u;const W=u.gl;this.buffer=W.createBuffer(),u.bindVertexBuffer.set(this.buffer),W.bufferData(W.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?W.DYNAMIC_DRAW:W.STATIC_DRAW),this.dynamicDraw||P||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(u){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,u.arrayBuffer)}enableAttributes(u,m){for(let w=0;w<this.attributes.length;w++){const I=m.attributes[this.attributes[w].name];I!==void 0&&u.enableVertexAttribArray(I)}}setVertexAttribPointers(u,m,w){for(let I=0;I<this.attributes.length;I++){const P=this.attributes[I],F=m.attributes[P.name];F!==void 0&&u.vertexAttribPointer(F,P.components,u[Qu[P.type]],!1,this.itemSize,P.offset+this.itemSize*(w||0))}}setVertexAttribDivisor(u,m,w){for(let I=0;I<this.attributes.length;I++){const P=m.attributes[this.attributes[I].name];P!==void 0&&this.instanceCount&&this.instanceCount>0&&u.vertexAttribDivisor(P,w)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Hc{constructor(u,m,w,I,P){this.context=u,this.width=m,this.height=w;const F=this.framebuffer=u.gl.createFramebuffer();I&&(this.colorAttachment=new Cg(u,F)),P&&(this.depthAttachmentType=P,this.depthAttachment=P==="renderbuffer"?new Wp(u,F):new Ig(u,F))}destroy(){const u=this.context.gl;if(this.colorAttachment){const m=this.colorAttachment.get();m&&u.deleteTexture(m)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const m=this.depthAttachment.get();m&&u.deleteRenderbuffer(m)}else{const m=this.depthAttachment.get();m&&u.deleteTexture(m)}u.deleteFramebuffer(this.framebuffer)}}class Qp{constructor(u,m){this.gl=u,this.clearColor=new yd(this),this.clearDepth=new V0(this),this.clearStencil=new _g(this),this.colorMask=new Up(this),this.depthMask=new xd(this),this.stencilMask=new H0(this),this.stencilFunc=new j0(this),this.stencilOp=new yg(this),this.stencilTest=new Gc(this),this.depthRange=new W0(this),this.depthTest=new xg(this),this.depthFunc=new bg(this),this.blend=new $0(this),this.blendFunc=new nf(this),this.blendColor=new wg(this),this.blendEquation=new Sg(this),this.cullFace=new Ag(this),this.cullFaceSide=new X0(this),this.frontFace=new Tg(this),this.program=new Dx(this),this.activeTexture=new bd(this),this.viewport=new Gp(this),this.bindFramebuffer=new q0(this),this.bindRenderbuffer=new fl(this),this.bindTexture=new Z0(this),this.bindVertexBuffer=new Vp(this),this.bindElementBuffer=new Hp(this),this.bindVertexArrayOES=new Mg(this),this.pixelStoreUnpack=new Eg(this),this.pixelStoreUnpackPremultiplyAlpha=new rf(this),this.pixelStoreUnpackFlipY=new Y0(this),this.options=m?{...m}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=u.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=u.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=u.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=u.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=u.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=u.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=u.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=u.getParameter(u.MAX_TEXTURE_SIZE),this.maxPointSize=u.getParameter(u.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(u,m,w){return new xo(this,u,m,w)}createVertexBuffer(u,m,w,I,P){return new Yn(this,u,m,w,I,P)}createRenderbuffer(u,m,w){const I=this.gl,P=I.createRenderbuffer();return this.bindRenderbuffer.set(P),I.renderbufferStorage(I.RENDERBUFFER,u,m,w),this.bindRenderbuffer.set(null),P}createFramebuffer(u,m,w,I){return new Hc(this,u,m,w,I)}clear({color:u,depth:m,stencil:w,colorMask:I}){const P=this.gl;let F=0;u&&(F|=P.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set(I||[!0,!0,!0,!0])),m!==void 0&&(F|=P.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),w!==void 0&&(F|=P.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),P.clear(F)}setCullFace(u){u.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(u.mode),this.frontFace.set(u.frontFace))}setDepthMode(u){u.func!==this.gl.ALWAYS||u.mask?(this.depthTest.set(!0),this.depthFunc.set(u.func),this.depthMask.set(u.mask),this.depthRange.set(u.range)):this.depthTest.set(!1)}setStencilMode(u){u.test.func!==this.gl.ALWAYS||u.mask?(this.stencilTest.set(!0),this.stencilMask.set(u.mask),this.stencilOp.set([u.fail,u.depthFail,u.pass]),this.stencilFunc.set({func:u.test.func,ref:u.ref,mask:u.test.mask})):this.stencilTest.set(!1)}setColorMode(u){a.bh(u.blendFunction,Mr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(u.blendFunction),this.blendColor.set(u.blendColor),u.blendEquation?this.blendEquation.set(u.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(u.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Md;function em(b,u,m,w,I,P,F){const W=b.context,q=W.gl,J=b.transform,ee=b.getOrCreateProgram("collisionBox"),ae=[];let le=0,ue=0;for(let De=0;De<w.length;De++){const $e=w[De],je=u.getTile($e),et=je.getBucket(m);if(!et)continue;const Ke=Wh($e,et,J);let tt=Ke;I[0]===0&&I[1]===0||(tt=b.translatePosMatrix(Ke,je,I,P));const ut=F?et.textCollisionBox:et.iconCollisionBox,at=et.collisionCircleArray;if(at.length>0){const rt=a.a6.mat4.create(),bt=tt;a.a6.mat4.mul(rt,et.placementInvProjMatrix,J.glCoordMatrix),a.a6.mat4.mul(rt,rt,et.placementViewportMatrix),ae.push({circleArray:at,circleOffset:ue,transform:bt,invTransform:rt,projection:et.getProjection()}),le+=at.length/4,ue=le}ut&&(b.terrain&&b.terrain.setupElevationDraw(je,ee),ee.draw(b,q.LINES,Xn.disabled,pr.disabled,b.colorModeForRenderPass(),_r.disabled,Ox(tt,J,je,et.getProjection()),m.id,ut.layoutVertexBuffer,ut.indexBuffer,ut.segments,null,J.zoom,null,[ut.collisionVertexBuffer,ut.collisionVertexBufferExt]))}if(!F||!ae.length)return;const ve=b.getOrCreateProgram("collisionCircle"),ye=new a.cQ;ye.resize(4*le),ye._trim();let be=0;for(const De of ae)for(let $e=0;$e<De.circleArray.length/4;$e++){const je=4*$e,et=De.circleArray[je+0],Ke=De.circleArray[je+1],tt=De.circleArray[je+2],ut=De.circleArray[je+3];ye.emplace(be++,et,Ke,tt,ut,0),ye.emplace(be++,et,Ke,tt,ut,1),ye.emplace(be++,et,Ke,tt,ut,2),ye.emplace(be++,et,Ke,tt,ut,3)}(!Md||Md.length<2*le)&&(Md=function(De){const $e=2*De,je=new a.aO;je.resize($e),je._trim();for(let et=0;et<$e;et++){const Ke=6*et;je.uint16[Ke+0]=4*et+0,je.uint16[Ke+1]=4*et+1,je.uint16[Ke+2]=4*et+2,je.uint16[Ke+3]=4*et+2,je.uint16[Ke+4]=4*et+3,je.uint16[Ke+5]=4*et+0}return je}(le));const we=W.createIndexBuffer(Md,!0),ke=W.createVertexBuffer(ye,a.cR.members,!0);for(const De of ae){const $e={u_matrix:De.transform,u_inv_matrix:De.invTransform,u_camera_to_center_distance:(Ne=J).getCameraToCenterDistance(De.projection),u_viewport_size:[Ne.width,Ne.height]};ve.draw(b,q.TRIANGLES,Xn.disabled,pr.disabled,b.colorModeForRenderPass(),_r.disabled,$e,m.id,ke,we,a.b1.simpleSegment(0,2*De.circleOffset,De.circleArray.length,De.circleArray.length/2),null,J.zoom)}var Ne;ke.destroy(),we.destroy()}const Ed=a.a6.mat4.create();function Fg(b){const u=b._camera.getWorldToCamera(b.worldSize,1),m=a.a6.mat4.multiply([],u,b.globeMatrix);a.a6.mat4.invert(m,m);const w=[0,0,0],I=[0,1,0,0];return a.a6.vec4.transformMat4(I,I,m),w[0]=I[0],w[1]=I[1],w[2]=I[2],a.a6.vec3.normalize(w,w),w}function Nx({width:b,height:u,anchor:m,textOffset:w,textScale:I},P){const{horizontalAlign:F,verticalAlign:W}=a.bx(m),q=-(F-.5)*b,J=-(W-.5)*u,ee=a.bw(m,w);return new a.P((q/I+ee[0])*P,(J/I+ee[1])*P)}function zx(b,u,m,w,I,P,F,W,q,J,ee){const ae=b.text.placedSymbolArray,le=b.text.dynamicLayoutVertexArray,ue=b.icon.dynamicLayoutVertexArray,ve={},ye=b.getProjection(),be=Nc(W,ye,P),we=P.elevation,ke=ye.upVectorScale(W.canonical,P.center.lat,P.worldSize).metersToTile;le.clear();for(let Ne=0;Ne<ae.length;Ne++){const De=ae.get(Ne),{tileAnchorX:$e,tileAnchorY:je,numGlyphs:et}=De,Ke=De.hidden||!De.crossTileID||b.allowVerticalPlacement&&!De.placedOrientation?null:w[De.crossTileID];if(Ke){let tt=0,ut=0,at=0;if(we){const Gt=we?we.getAtTileOffset(W,$e,je):0,[fn,pn,qt]=ye.upVector(W.canonical,$e,je);tt=Gt*fn*ke,ut=Gt*pn*ke,at=Gt*qt*ke}let[rt,bt,Ft,Zt]=vo(De.projectedAnchorX+tt,De.projectedAnchorY+ut,De.projectedAnchorZ+at,m?be:F);const kt=ni(P.getCameraToCenterDistance(ye),Zt);let hn=I.evaluateSizeForFeature(b.textSizeData,J,De)*kt/a.bq;m&&(hn*=b.tilePixelRatio/q);const wt=Nx(Ke,hn);m?({x:rt,y:bt,z:Ft}=ye.projectTilePoint($e+wt.x,je+wt.y,W.canonical),[rt,bt,Ft]=vo(rt+tt,bt+ut,Ft+at,F)):(u&&wt._rotate(-P.angle),rt+=wt.x,bt+=wt.y,Ft=0);const Wt=b.allowVerticalPlacement&&De.placedOrientation===a.bk.vertical?Math.PI/2:0;for(let Gt=0;Gt<et;Gt++)a.bn(le,rt,bt,Ft,Wt);ee&&De.associatedIconIndex>=0&&(ve[De.associatedIconIndex]={x:rt,y:bt,z:Ft,angle:Wt})}else cl(et,le)}if(ee){ue.clear();const Ne=b.icon.placedSymbolArray;for(let De=0;De<Ne.length;De++){const $e=Ne.get(De),{numGlyphs:je}=$e,et=ve[De];if($e.hidden||!et)cl(je,ue);else{const{x:Ke,y:tt,z:ut,angle:at}=et;for(let rt=0;rt<je;rt++)a.bn(ue,Ke,tt,ut,at)}}b.icon.dynamicLayoutVertexBuffer.updateData(ue)}b.text.dynamicLayoutVertexBuffer.updateData(le)}function Cd(b,u,m,w,I,P,F={}){const W=m.paint.get("icon-translate"),q=m.paint.get("text-translate"),J=m.paint.get("icon-translate-anchor"),ee=m.paint.get("text-translate-anchor"),ae=m.layout.get("icon-rotation-alignment"),le=m.layout.get("text-rotation-alignment"),ue=m.layout.get("icon-pitch-alignment"),ve=m.layout.get("text-pitch-alignment"),ye=m.layout.get("icon-keep-upright"),be=m.layout.get("text-keep-upright"),we=m.paint.get("icon-color-saturation"),ke=m.paint.get("icon-color-contrast"),Ne=m.paint.get("icon-color-brightness-min"),De=m.paint.get("icon-color-brightness-max"),$e=m.paint.get("symbol-elevation-reference")==="sea",je=m.paint.get("text-occlusion-opacity").constantOr(0),et=b.context,Ke=et.gl,tt=b.transform,ut=ae==="map",at=le==="map",rt=ue==="map",bt=ve==="map",Ft=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Zt=!1;const kt=b.depthModeForSublayer(0,Xn.ReadOnly),hn=[a.am(tt.center.lng),a.at(tt.center.lat)],wt=m.layout.get("text-variable-anchor"),Wt=tt.projection.name==="globe",Gt=[],fn=[0,-1,0];for(const pn of w){const qt=u.getTile(pn),en=qt.getBucket(m);if(!en||en.projection.name==="mercator"&&Wt||en.fullyClipped)continue;const er=en.projection.name==="globe",xn=er?a.a9(tt.zoom):0,Dn=Nc(pn,en.getProjection(),tt),yr=tt.calculatePixelsToTileUnitsMatrix(qt),qn=wt&&en.hasTextData(),ur=en.hasIconTextFit()&&qn&&en.hasIconData(),Ur=en.getProjection().createInversionMatrix(tt,pn.canonical),Br=Di=>{tt.depthOcclusionForSymbolsAndCircles&&(m.hasInitialOcclusionOpacityProperties||b.terrain)&&(Di.push("DEPTH_D24"),Di.push("DEPTH_OCCLUSION"))},Ci=()=>{const Di=ut&&m.layout.get("symbol-placement")!=="point",kr=[];Br(kr);const pi=Di||ur,Ti=m.paint.get("icon-image-cross-fade").constantOr(0);b.terrainRenderModeElevated()&&rt&&kr.push("PITCH_WITH_MAP_TERRAIN"),er&&(kr.push("PROJECTION_GLOBE_VIEW"),pi&&kr.push("PROJECTED_POS_ON_VIEWPORT")),Ti>0&&kr.push("ICON_TRANSITION"),en.icon.zOffsetVertexBuffer&&kr.push("Z_OFFSET"),we===0&&ke===0&&Ne===0&&De===1||kr.push("COLOR_ADJUSTMENT"),en.sdfIcons&&kr.push("RENDER_SDF");const zs=en.icon.programConfigurations.get(m.id),ta=b.getOrCreateProgram("symbol",{config:zs,defines:kr}),ai=qt.imageAtlasTexture?qt.imageAtlasTexture.size:[0,0],Fa=en.iconSizeData,Ka=a.bj(Fa,tt.zoom),Na=rt||tt.pitch!==0,Ki=ei(Dn,qt.tileID.canonical,rt,ut,tt,en.getProjection(),yr),ml=Gs(Dn,qt.tileID.canonical,rt,ut,tt,en.getProjection(),yr),gl=b.translatePosMatrix(ml,qt,W,J,!0),qc=b.translatePosMatrix(Dn,qt,W,J),mc=pi?Ed:Ki,Dl=ut&&!rt&&!Di;let Zc=fn;!Wt&&!tt.mercatorFromTransition||ut||(Zc=Fg(tt));const yf=er?Zc:fn,zd=m.getColorAdjustmentMatrix(we,ke,Ne,De),ah=i_(Fa.kind,Ka,Dl,rt,b,qc,mc,gl,$e,!1,ai,[0,0],!0,pn,xn,hn,Ur,yf,en.getProjection(),zd,Ti),Yg=qt.imageAtlasTexture?qt.imageAtlasTexture:null,Kg=m.layout.get("icon-size").constantOr(0)!==1||en.iconsNeedLinear,$x=en.sdfIcons||b.options.rotating||b.options.zooming||Kg||Na?Ke.LINEAR:Ke.NEAREST,Jg=en.sdfIcons&&m.paint.get("icon-halo-width").constantOr(1)!==0,Ji=b.terrain&&rt&&Di?a.a6.mat4.invert(a.a6.mat4.create(),Ki):Ed;if(Di&&en.icon){const lm=tt.elevation,zB=lm?lm.getAtTileOffsetFunc(pn,tt.center.lat,tt.worldSize,en.getProjection()):null,LE=Zr(Dn,qt.tileID.canonical,rt,ut,tt,en.getProjection(),yr);qo(en,Dn,b,!1,LE,ml,rt,ye,zB,pn)}return{program:ta,buffers:en.icon,uniformValues:ah,atlasTexture:Yg,atlasTextureIcon:null,atlasInterpolation:$x,atlasInterpolationIcon:null,isSDF:en.sdfIcons,hasHalo:Jg,tile:qt,labelPlaneMatrixInv:Ji}},Ui=()=>{const Di=at&&m.layout.get("symbol-placement")!=="point",kr=[],pi=Di||wt||ur;b.terrainRenderModeElevated()&&bt&&kr.push("PITCH_WITH_MAP_TERRAIN"),er&&(kr.push("PROJECTION_GLOBE_VIEW"),pi&&kr.push("PROJECTED_POS_ON_VIEWPORT")),en.text.zOffsetVertexBuffer&&kr.push("Z_OFFSET"),en.iconsInText&&kr.push("RENDER_TEXT_AND_SYMBOL"),kr.push("RENDER_SDF"),Br(kr);const Ti=en.text.programConfigurations.get(m.id),zs=b.getOrCreateProgram("symbol",{config:Ti,defines:kr});let ta,ai=[0,0],Fa=null;const Ka=en.textSizeData;en.iconsInText&&(ai=qt.imageAtlasTexture?qt.imageAtlasTexture.size:[0,0],Fa=qt.imageAtlasTexture?qt.imageAtlasTexture:null,ta=bt||tt.pitch!==0||b.options.rotating||b.options.zooming||Ka.kind==="composite"||Ka.kind==="camera"?Ke.LINEAR:Ke.NEAREST);const Na=qt.glyphAtlasTexture?qt.glyphAtlasTexture.size:[0,0],Ki=a.bj(Ka,tt.zoom),ml=ei(Dn,qt.tileID.canonical,bt,at,tt,en.getProjection(),yr),gl=Gs(Dn,qt.tileID.canonical,bt,at,tt,en.getProjection(),yr),qc=b.translatePosMatrix(gl,qt,q,ee,!0),mc=b.translatePosMatrix(Dn,qt,q,ee),Dl=pi?Ed:ml,Zc=at&&!bt&&!Di;let yf=fn;!Wt&&!tt.mercatorFromTransition||at||(yf=Fg(tt));const zd=i_(Ka.kind,Ki,Zc,bt,b,mc,Dl,qc,$e,!0,Na,ai,!0,pn,xn,hn,Ur,er?yf:fn,en.getProjection(),je),ah=qt.glyphAtlasTexture?qt.glyphAtlasTexture:null,Yg=Ke.LINEAR,Kg=m.paint.get("text-halo-width").constantOr(1)!==0,$x=b.terrain&&bt&&Di?a.a6.mat4.invert(a.a6.mat4.create(),ml):Ed;if(Di&&en.text){const Jg=tt.elevation,Ji=Jg?Jg.getAtTileOffsetFunc(pn,tt.center.lat,tt.worldSize,en.getProjection()):null,lm=Zr(Dn,qt.tileID.canonical,bt,at,tt,en.getProjection(),yr);qo(en,Dn,b,!0,lm,gl,bt,be,Ji,pn)}return{program:zs,buffers:en.text,uniformValues:zd,atlasTexture:ah,atlasTextureIcon:Fa,atlasInterpolation:Yg,atlasInterpolationIcon:ta,isSDF:!0,hasHalo:Kg,tile:qt,labelPlaneMatrixInv:$x}},is=en.icon.segments.get().length,Xc=en.text.segments.get().length,ea=is&&!F.onlyText?Ci():null,Yr=Xc&&!F.onlyIcons?Ui():null,Ni=m.paint.get("icon-opacity").constantOr(1),Ss=m.paint.get("text-opacity").constantOr(1);if(Ft&&en.canOverlap){Zt=!0;const Di=Ni&&!F.onlyText?en.icon.segments.get():[],kr=Ss&&!F.onlyIcons?en.text.segments.get():[];for(const pi of Di)Gt.push({segments:new a.b1([pi]),sortKey:pi.sortKey,state:ea});for(const pi of kr)Gt.push({segments:new a.b1([pi]),sortKey:pi.sortKey,state:Yr})}else F.onlyText||Gt.push({segments:Ni?en.icon.segments:new a.b1([]),sortKey:0,state:ea}),F.onlyIcons||Gt.push({segments:Ss?en.text.segments:new a.b1([]),sortKey:0,state:Yr})}Zt&&Gt.sort((pn,qt)=>pn.sortKey-qt.sortKey);for(const pn of Gt){const qt=pn.state;if(qt)if(b.terrain?b.terrain.setupElevationDraw(qt.tile,qt.program,{useDepthForOcclusion:tt.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:qt.labelPlaneMatrixInv}):b.setupDepthForOcclusion(tt.depthOcclusionForSymbolsAndCircles,qt.program),et.activeTexture.set(Ke.TEXTURE0),qt.atlasTexture&&qt.atlasTexture.bind(qt.atlasInterpolation,Ke.CLAMP_TO_EDGE,!0),qt.atlasTextureIcon&&(et.activeTexture.set(Ke.TEXTURE1),qt.atlasTextureIcon&&qt.atlasTextureIcon.bind(qt.atlasInterpolationIcon,Ke.CLAMP_TO_EDGE,!0)),b.uploadCommonLightUniforms(b.context,qt.program),qt.hasHalo){const en=qt.uniformValues;en.u_is_halo=1,cf(qt.buffers,pn.segments,m,b,qt.program,kt,I,P,en,2),en.u_is_halo=0}else{if(qt.isSDF){const en=qt.uniformValues;qt.hasHalo&&(en.u_is_halo=1,cf(qt.buffers,pn.segments,m,b,qt.program,kt,I,P,en,1)),en.u_is_halo=0}cf(qt.buffers,pn.segments,m,b,qt.program,kt,I,P,qt.uniformValues,1)}}}function cf(b,u,m,w,I,P,F,W,q,J){const ee=[b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer,b.iconTransitioningVertexBuffer,b.globeExtVertexBuffer,b.zOffsetVertexBuffer];I.draw(w,w.context.gl.TRIANGLES,P,F,W,_r.disabled,q,m.id,b.layoutVertexBuffer,b.indexBuffer,u,m.paint,w.transform.zoom,b.programConfigurations.get(m.id),ee,J)}function Id(b,u,m,w,I,P,F){const W=b.context.gl,q=m.paint.get("fill-pattern"),J=m.is3D(),ee=J?b.stencilModeFor3D():pr.disabled,ae=q&&q.constantOr(1);let le,ue,ve,ye,be;F?(ue=ae&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",le=W.LINES):(ue=ae?"fillPattern":"fill",le=W.TRIANGLES);for(const we of w){const ke=u.getTile(we);if(ae&&!ke.patternsLoaded())continue;const Ne=ke.getBucket(m);if(!Ne)continue;b.prepareDrawTile();const De=Ne.programConfigurations.get(m.id),$e=b.isTileAffectedByFog(we),je=b.getOrCreateProgram(ue,{config:De,overrideFog:$e});ae&&(b.context.activeTexture.set(W.TEXTURE0),ke.imageAtlasTexture&&ke.imageAtlasTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),De.updatePaintBuffers());const et=q.constantOr(null);if(et&&ke.imageAtlas){const ut=ke.imageAtlas.patternPositions[et.toString()];ut&&De.setConstantPatternPositions(ut)}const Ke=b.translatePosMatrix(we.projMatrix,ke,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor")),tt=m.paint.get("fill-emissive-strength");if(F){ye=Ne.indexBuffer2,be=Ne.segments2;const ut=b.terrain&&b.terrain.renderingToTexture?b.terrain.drapeBufferSize:[W.drawingBufferWidth,W.drawingBufferHeight];ve=ue==="fillOutlinePattern"&&ae?lf(Ke,tt,b,ke,ut):t_(Ke,tt,ut)}else ye=Ne.indexBuffer,be=Ne.segments,ve=ae?Bg(Ke,tt,b,ke):qp(Ke,tt);b.uploadCommonUniforms(b.context,je,we.toUnwrapped()),je.draw(b,le,I,J?ee:b.stencilModeForClipping(we),P,_r.disabled,ve,m.id,Ne.layoutVertexBuffer,ye,be,m.paint,b.transform.zoom,De,void 0)}}function uf(b,u,m,w,I,P,F,W){m.resetLayerRenderingStats(b);const q=b.context,J=q.gl,ee=b.transform,ae=m.paint.get("fill-extrusion-pattern"),le=ae.constantOr(1),ue=m.paint.get("fill-extrusion-opacity"),ve=b.style.enable3dLights(),ye=m.paint.get(ve&&!le?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),be=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),ye],we=m.layout.get("fill-extrusion-edge-radius"),ke=we>0&&!m.paint.get("fill-extrusion-rounded-roof"),Ne=ke?0:we,De=ee.projection.name==="globe"?a.c_():0,$e=ee.projection.name==="globe",je=$e?a.a9(ee.zoom):0,et=[a.am(ee.center.lng),a.at(ee.center.lat)],Ke=m.paint.get("fill-extrusion-flood-light-color").toRenderColor(m.lut).toArray01().slice(0,3),tt=m.paint.get("fill-extrusion-flood-light-intensity"),ut=m.paint.get("fill-extrusion-vertical-scale"),at=m.paint.get("fill-extrusion-line-width").constantOr(1)!==0,rt=ic(b,m.paint.get("fill-extrusion-cutoff-fade-range")),bt=[];let Ft;$e&&bt.push("PROJECTION_GLOBE_VIEW"),be[0]>0&&bt.push("FAUX_AO"),ke&&bt.push("ZERO_ROOF_RADIUS"),W&&bt.push("HAS_CENTROID"),tt>0&&bt.push("FLOOD_LIGHT"),rt.shouldRenderCutoff&&bt.push("RENDER_CUTOFF"),at&&bt.push("RENDER_WALL_MODE");const Zt=b.renderPass==="shadow",kt=b.shadowRenderer,hn=Zt&&!!kt;b.shadowRenderer&&(b.shadowRenderer.useNormalOffset=!0);let wt=[0,0,0];if(kt){const fn=b.style.directionalLight,pn=b.style.ambientLight;fn&&pn&&(wt=kp(b.style,fn,pn)),Ft=bt.concat(["SHADOWS_SINGLE_CASCADE"])}const Wt=hn?"fillExtrusionDepth":le?"fillExtrusionPattern":"fillExtrusion",Gt=m.getLayerRenderingStats();for(const fn of w){const pn=u.getTile(fn),qt=pn.getBucket(m);if(!qt||qt.projection.name!==ee.projection.name)continue;let en=!1;kt&&(en=kt.getMaxCascadeForTile(fn.toUnwrapped())===0);const er=b.isTileAffectedByFog(fn),xn=qt.programConfigurations.get(m.id),Dn=b.getOrCreateProgram(Wt,{config:xn,defines:en?Ft:bt,overrideFog:er});if(b.terrain&&b.terrain.setupElevationDraw(pn,Dn,{useMeterToDem:!0}),!qt.centroidVertexBuffer){const Ui=Dn.attributes.a_centroid_pos;Ui!==void 0&&J.vertexAttrib2f(Ui,0,0)}!Zt&&kt&&kt.setupShadows(pn.tileID.toUnwrapped(),Dn,"vector-tile",pn.tileID.overscaledZ),le&&(b.context.activeTexture.set(J.TEXTURE0),pn.imageAtlasTexture&&pn.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),xn.updatePaintBuffers());const yr=ae.constantOr(null);if(yr&&pn.imageAtlas){const Ui=pn.imageAtlas.patternPositions[yr.toString()];Ui&&xn.setConstantPatternPositions(Ui)}const qn=m.paint.get("fill-extrusion-vertical-gradient"),ur=1/qt.tileToMeter;let Ur;if(Zt&&kt){if(zg(pn.tileID,qt,b))continue;const Ui=kt.calculateShadowPassMatrixFromTile(pn.tileID.toUnwrapped());Ur=e_(Ui,Ne,ur,ut)}else{const Ui=b.translatePosMatrix(fn.expandedProjMatrix,pn,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),is=ee.projection.createInversionMatrix(ee,fn.canonical);Ur=le?Dg(Ui,b,qn,ue,be,Ne,ur,fn,pn,De,je,et,is,Ke,ut):Lg(Ui,b,qn,ue,be,Ne,ur,fn,De,je,et,is,Ke,ut,tt,wt)}b.uploadCommonUniforms(q,Dn,fn.toUnwrapped(),null,rt);let Br=qt.segments;if(ee.projection.name==="mercator"&&!Zt&&(Br=qt.getVisibleSegments(pn.tileID,b.terrain,b.transform.getFrustum(0)),!Br.get().length))continue;if(Gt)if(Zt)for(const Ui of Br.get())Gt.numRenderedVerticesInShadowPass+=Ui.primitiveLength;else for(const Ui of Br.get())Gt.numRenderedVerticesInTransparentPass+=Ui.primitiveLength;const Ci=[];(b.terrain||W)&&Ci.push(qt.centroidVertexBuffer),$e&&Ci.push(qt.layoutVertexExtBuffer),at&&Ci.push(qt.wallVertexBuffer),Dn.draw(b,q.gl.TRIANGLES,I,P,F,_r.backCCW,Ur,m.id,qt.layoutVertexBuffer,qt.indexBuffer,Br,m.paint,b.transform.zoom,xn,Ci)}b.shadowRenderer&&(b.shadowRenderer.useNormalOffset=!1)}function ca(b,u,m,w,I,P,F,W,q,J,ee,ae,le,ue,ve,ye,be,we,ke){const Ne=b.context,De=Ne.gl,$e=b.transform,je=b.transform.zoom,et=[],Ke=ic(b,m.paint.get("fill-extrusion-cutoff-fade-range"));J==="clear"?(et.push("CLEAR_SUBPASS"),ke&&(et.push("CLEAR_FROM_TEXTURE"),Ne.activeTexture.set(De.TEXTURE0),ke.bind(De.LINEAR,De.CLAMP_TO_EDGE))):J==="sdf"&&et.push("SDF_SUBPASS"),be&&et.push("HAS_CENTROID"),Ke.shouldRenderCutoff&&et.push("RENDER_CUTOFF");const tt=m.layout.get("fill-extrusion-edge-radius"),ut=(at,rt,bt,Ft,Zt)=>{const kt=rt.programConfigurations.get(m.id),hn=b.isTileAffectedByFog(at),wt=b.getOrCreateProgram("fillExtrusionGroundEffect",{config:kt,defines:et,overrideFog:hn}),Wt=((fn,pn,qt,en,er,xn,Dn,yr,qn,ur,Ur)=>({u_matrix:pn,u_opacity:qt,u_ao_pass:en?1:0,u_meter_to_tile:er,u_ao:xn,u_flood_light_intensity:Dn,u_flood_light_color:yr,u_attenuation:qn,u_edge_radius:ur,u_fb:0,u_fb_size:Ur,u_dynamic_offset:1}))(0,Ft,ee,q,Zt,[ae,le*Zt],ue,ve,ye,je>=17?0:tt*Zt,ke?ke.size[0]:0),Gt=[];be&&Gt.push(rt.hiddenByLandmarkVertexBuffer),b.uploadCommonUniforms(Ne,wt,at.toUnwrapped(),null,Ke),wt.draw(b,Ne.gl.TRIANGLES,I,P,F,W,Wt,m.id,rt.vertexBuffer,rt.indexBuffer,bt,m.paint,je,kt,Gt)};for(const at of w){const rt=u.getTile(at),bt=rt.getBucket(m);if(!bt||bt.projection.name!==$e.projection.name||!bt.groundEffect||bt.groundEffect&&!bt.groundEffect.hasData())continue;const Ft=bt.groundEffect,Zt=1/bt.tileToMeter;{const kt=b.translatePosMatrix(at.projMatrix,rt,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),hn=Ft.getDefaultSegment();ut(at,Ft,hn,kt,Zt)}if(we)for(let kt=0;kt<4;kt++){const hn=a.c$[kt](at),wt=u.getTile(hn);if(!wt)continue;const Wt=wt.getBucket(m);if(!Wt||Wt.projection.name!==$e.projection.name||!Wt.groundEffect||Wt.groundEffect&&!Wt.groundEffect.hasData())continue;const Gt=Wt.groundEffect;let fn,pn;kt===0?(fn=[-a.ab,0,0],pn=1):kt===1?(fn=[a.ab,0,0],pn=0):kt===2?(fn=[0,-a.ab,0],pn=3):(fn=[0,a.ab,0],pn=2);const qt=Gt.regionSegments[pn];if(!qt)continue;const en=new Float32Array(16);a.a6.mat4.translate(en,at.projMatrix,fn),ut(at,Gt,qt,b.translatePosMatrix(en,rt,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Zt)}}}function lc(b,u,m,w,I,P,F){w.centroidVertexArray.length===0&&w.createCentroidsBuffer();const W=P?P.findDEMTileFor(m):null;if(!(W&&W.dem||F))return;const q=we=>new a.P(Math.ceil((we+a.d2)*a.d3),0),J=we=>{const ke=u.getSource().minzoom,Ne=$e=>{const je=u.getTileByID($e);if(je&&je.hasData())return je.getBucket(I)},De=[0,-1,1];for(const $e of De){if(we.overscaledZ+$e<ke)continue;const je=Ne(we.calculateScaledKey(we.overscaledZ+$e));if(je)return je}},ee=[0,0,0],ae=(we,ke)=>(ee[0]=Math.min(we.min.y,ke.min.y),ee[1]=Math.max(we.max.y,ke.max.y),ee[2]=a.ab-ke.min.x>we.max.x?ke.min.x-a.ab:we.max.x,ee),le=(we,ke)=>(ee[0]=Math.min(we.min.x,ke.min.x),ee[1]=Math.max(we.max.x,ke.max.x),ee[2]=a.ab-ke.min.y>we.max.y?ke.min.y-a.ab:we.max.y,ee),ue=[(we,ke)=>ae(we,ke),(we,ke)=>ae(ke,we),(we,ke)=>le(we,ke),(we,ke)=>le(ke,we)],ve=(we,ke,Ne,De,$e,je,et)=>{if(!P)return 0;const Ke=[[je?Ne:we,je?we:Ne,0],[je?Ne:ke,je?ke:Ne,0]],tt=et<0?a.ab+et:et,ut=[je?tt:(we+ke)/2,je?(we+ke)/2:tt,0];return Ne===0&&et<0||Ne!==0&&et>0?P.getForTilePoints($e,[ut],!0,De):Ke.push(ut),P.getForTilePoints(m,Ke,!0,W),Math.max(Ke[0][2],Ke[1][2],ut[2])/P.exaggeration()};for(let we=0;we<4;we++){const ke=w.borderFeatureIndices[we];if(ke.length===0)continue;const Ne=a.c$[we](m),De=J(Ne);if(!(De&&De instanceof a.d0)||w.borderDoneWithNeighborZ[we]===De.canonical.z)continue;De.centroidVertexArray.length===0&&De.createCentroidsBuffer();const $e=P?P.findDEMTileFor(Ne):null;if(!($e&&$e.dem||F))continue;const je=(we<2?1:5)-we,et=De.borderDoneWithNeighborZ[je]!==w.canonical.z,Ke=De.borderFeatureIndices[je];let tt=0;if(w.canonical.z!==De.canonical.z){for(const ut of ke)w.showCentroid(w.featuresOnBorder[ut]);if(et)for(const ut of Ke)De.showCentroid(De.featuresOnBorder[ut]);w.borderDoneWithNeighborZ[we]=De.canonical.z,De.borderDoneWithNeighborZ[je]=w.canonical.z}for(const ut of ke){const at=w.featuresOnBorder[ut],rt=w.centroidData[at.centroidDataIndex],bt=at.borders[we];let Ft;for(;tt<Ke.length;){Ft=De.featuresOnBorder[Ke[tt]];const Zt=Ft.borders[je];if(Zt[1]>bt[0]+3||Zt[0]>bt[0]-3)break;De.showCentroid(Ft),tt++}if(Ft&&tt<Ke.length){const Zt=tt;let kt=0;for(;!(Ft.borders[je][0]>bt[1]-3)&&(kt++,++tt!==Ke.length);)Ft=De.featuresOnBorder[Ke[tt]];Ft=De.featuresOnBorder[Ke[Zt]];let hn=!1;if(kt>=1){const Gt=Ft.borders[je];Math.abs(bt[0]-Gt[0])<3&&Math.abs(bt[1]-Gt[1])<3&&(kt=1,hn=!0,tt=Zt+1)}else if(kt===0){w.showCentroid(at);continue}const wt=De.centroidData[Ft.centroidDataIndex];F&&hn&&(((ye=rt).flags|(be=wt).flags)&a.d1?(ye.flags|=a.d1,be.flags|=a.d1):(ye.flags&=~a.d1,be.flags&=~a.d1));const Wt=at.intersectsCount()>1||Ft.intersectsCount()>1;if(kt>1)tt=Zt,rt.centroidXY=wt.centroidXY=new a.P(0,0);else if($e&&$e.dem&&!Wt){const Gt=ue[we](rt,wt),fn=we%2?a.ab-1:0,pn=ve(Gt[0],Math.min(a.ab-1,Gt[1]),fn,$e,Ne,we<2,Gt[2]);rt.centroidXY=wt.centroidXY=q(pn)}else Wt?rt.centroidXY=wt.centroidXY=new a.P(0,0):(rt.centroidXY=w.encodeBorderCentroid(at),wt.centroidXY=De.encodeBorderCentroid(Ft));w.writeCentroidToBuffer(rt),De.writeCentroidToBuffer(wt)}else w.showCentroid(at)}w.borderDoneWithNeighborZ[we]=De.canonical.z,De.borderDoneWithNeighborZ[je]=w.canonical.z}var ye,be;(w.needsCentroidUpdate||!w.centroidVertexBuffer&&w.centroidVertexArray.length!==0)&&w.uploadCentroid(b)}const Ux=[1,0,0],s_=[0,1,0],Ng=[0,0,1];function zg(b,u,m){const w=m.transform,I=m.shadowRenderer;if(!I)return!0;const P=b.toUnwrapped(),F=w.tileSize*I._cascades[m.currentShadowCascade].scale;let W=u.maxHeight;if(w.elevation){const ye=w.elevation.getMinMaxForTile(b);ye&&(W+=ye.max)}const q=[...I.shadowDirection];q[2]=-q[2];const J=I.computeSimplifiedTileShadowVolume(P,W,F,q);if(!J)return!1;const ee=[Ux,s_,Ng,q,[q[0],0,q[2]],[0,q[1],q[2]]],ae=w.projection.name==="globe",le=w.scaleZoom(F),ue=a.bN.fromInvProjectionMatrix(w.invProjMatrix,w.worldSize,le,!ae),ve=I.getCurrentCascadeFrustum();return ue.intersectsPrecise(J.vertices,J.planes,ee)===0||ve.intersectsPrecise(J.vertices,J.planes,ee)===0}function Ug(b){return[b[0]*a.d4,b[1]*a.d4,b[2]*a.d4,0]}function No(b,u,m,w,I,P,F,W,q){const J=w.getSource(),ee=m.globeSharedBuffers;if(!ee)return;let ae,le,ue;if(u&&(ae=w.getTile(u)),J instanceof a.aD?(le=J.texture,ue=a.cD(0,0,m.transform)):ae&&u&&(le=ae.texture,ue=a.cD(u.canonical.z,u.canonical.x,m.transform)),!le||!ue)return;b||(ue=a.a6.mat4.scale(a.a6.mat4.create(),ue,[1,-1,1]));const ve=m.context,ye=ve.gl,be=I.paint.get("raster-resampling")==="nearest"?ye.NEAREST:ye.LINEAR,we=m.colorModeForDrapableLayerRenderPass(P),ke=F.defines;ke.push("GLOBE_POLES");const Ne=new Xn(ye.LEQUAL,Xn.ReadWrite,m.depthRangeFor3D),De=Float32Array.from(m.transform.expandedFarZProjMatrix),$e=Float32Array.from(a.b5(a.cC(new a.bP(0,0,0))));m.terrain&&m.terrain.prepareDrawTile(),ve.activeTexture.set(ye.TEXTURE0),le.bind(be,ye.CLAMP_TO_EDGE),ve.activeTexture.set(ye.TEXTURE1),le.bind(be,ye.CLAMP_TO_EDGE),le.useMipmap&&ve.extTextureFilterAnisotropic&&m.transform.pitch>20&&ye.texParameterf(ye.TEXTURE_2D,ve.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ve.extTextureFilterAnisotropicMax);const[je,et,Ke,tt]=u?ee.getPoleBuffers(u.canonical.z,!1):ee.getPoleBuffers(0,!0),ut=I.paint.get("raster-elevation");let at;b?(at=je,m.renderDefaultNorthPole=ut!==0):(at=et,m.renderDefaultSouthPole=ut!==0);const rt=Ug(F.mix),bt=((Zt,kt,hn,wt,Wt,Gt,fn,pn,qt,en,er,xn,Dn)=>Ad(Zt,kt,hn,new Float32Array(16),new Float32Array(9),[0,0],wt,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Gt,[0,0],pn,2,en,er,xn,1,0,Dn))(De,$e,ue,a.a9(m.transform.zoom),0,I,0,ut,0,rt,F.offset,F.range,P),Ft=m.getOrCreateProgram("raster",{defines:ke});m.uploadCommonUniforms(ve,Ft,null),Ft.draw(m,ye.TRIANGLES,Ne,q,we,W,bt,I.id,at,Ke,tt)}function ds(b){const u=b._nearZ,m=b.projection.farthestPixelDistance(b),w=m-u,I=.2*b.height,P=u+I;return[u,m,(P-I-u)/w,(P-u)/w]}function hf(b,u,m,w){if(b)return u instanceof Cr&&b instanceof cg?u.getTextureDescriptor(b,m,!0):{texture:b.texture,mix:Ug(w.mix),offset:w.offset,buffer:0,tileSize:1}}var Rd=a.d5([{name:"a_index",type:"Int16",components:1}]);class tm{constructor(u,m,w,I){const P={width:w[0],height:w[1],data:null},F=u.gl;this.targetColorTexture=new a.T(u,P,F.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new a.T(u,P,F.RGBA8,{useMipmap:!1}),this.context=u,this.updateParticleTexture(m,I),this.lastInvalidatedAt=0}updateParticleTexture(u,m){if(this.particleTextureDimension===m.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const w=this.context.gl,I=m.width*m.height;this.particleTexture0=new a.T(this.context,m,w.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new a.T(this.context,m,w.RGBA8,{premultiply:!1,useMipmap:!1});const P=new a.d6;P.reserve(I);for(let F=0;F<I;F++)P.emplaceBack(F);this.particleIndexBuffer=this.context.createVertexBuffer(P,Rd.members,!0),this.particleSegment=a.b1.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=m.width}update(u){return!(this.lastInvalidatedAt<u&&(this.lastInvalidatedAt=a.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function nm(b,u,m){if(!b)return null;const w=u.getTextureDescriptor(b,m,!0);if(!w)return null;let{texture:I,mix:P,offset:F,tileSize:W,buffer:q,format:J}=w;if(!I||!J)return null;let ee=!1;return J==="uint32"&&(ee=!0,P[3]=0,P=Yp(a.d7,P,[0,m.paint.get("raster-particle-max-speed")]),F=Sd(a.d7,F,[0,m.paint.get("raster-particle-max-speed")])),{texture:I,textureOffset:[q/(W+2*q),W/(W+2*q)],tileSize:W,scalarData:ee,scale:P,offset:F,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[J]]}}function Pd(b){const u=b._nearZ,m=b.projection.farthestPixelDistance(b),w=m-u,I=.2*b.height,P=u+I;return[u,m,(P-I-u)/w,(P-u)/w]}const a_=new a.bz(1,0,0,1),eh=new a.bz(0,1,0,1),th=new a.bz(0,0,1,1),gn=new a.bz(1,0,1,1),Kn=new a.bz(0,1,1,1);function cc(b,u,m,w,I,P,F){const W=b.context,q=b.transform,J=W.gl,ee=q.projection.name==="globe",ae=ee?["PROJECTION_GLOBE_VIEW"]:[];let le=a.a6.mat4.clone(m.projMatrix);if(ee&&a.a9(q.zoom)>0){const rt=a.b4(m.canonical,q),bt=a.d8(rt);le=a.a6.mat4.multiply(new Float32Array(16),q.globeMatrix,bt),a.a6.mat4.multiply(le,q.projMatrix,le)}const ue=a.a6.mat4.create();ue[12]+=2*I/(a.q.devicePixelRatio*q.width),ue[13]+=2*P/(a.q.devicePixelRatio*q.height),a.a6.mat4.multiply(le,ue,le);const ve=b.getOrCreateProgram("debug",{defines:ae}),ye=u.getTileByID(m.key);b.terrain&&b.terrain.setupElevationDraw(ye,ve);const be=Xn.disabled,we=pr.disabled,ke=b.colorModeForRenderPass(),Ne="$debug";W.activeTexture.set(J.TEXTURE0),b.emptyTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),ee?ye._makeGlobeTileDebugBuffers(b.context,q):ye._makeDebugTileBoundsBuffers(b.context,q.projection);const De=ye._tileDebugBuffer||b.debugBuffer,$e=ye._tileDebugIndexBuffer||b.debugIndexBuffer,je=ye._tileDebugSegments||b.debugSegments;if(ve.draw(b,J.LINE_STRIP,be,we,ke,_r.disabled,n_(le,w),Ne,De,$e,je,null,null,null,[ye._globeTileDebugBorderBuffer]),F){const rt=ye.latestRawTileData,bt=Math.floor((rt&&rt.byteLength||0)/1024);let Ft=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(Ft+=` => ${m.overscaledZ}`),Ft+=` ${ye.state}`,Ft+=` ${bt}kb`,function(Zt,kt){Zt.initDebugOverlayCanvas();const hn=Zt.debugOverlayCanvas,wt=Zt.context.gl,Wt=Zt.debugOverlayCanvas.getContext("2d");Wt.clearRect(0,0,hn.width,hn.height),Wt.shadowColor="white",Wt.shadowBlur=2,Wt.lineWidth=1.5,Wt.strokeStyle="white",Wt.textBaseline="top",Wt.font="bold 36px Open Sans, sans-serif",Wt.fillText(kt,5,5),Wt.strokeText(kt,5,5),Zt.debugOverlayTexture.update(hn),Zt.debugOverlayTexture.bind(wt.LINEAR,wt.CLAMP_TO_EDGE)}(b,Ft)}const et=u.getTile(m).tileSize,Ke=512/Math.min(et,512)*(m.overscaledZ/q.zoom)*.5,tt=ye._tileDebugTextBuffer||b.debugBuffer,ut=ye._tileDebugTextIndexBuffer||b.quadTriangleIndexBuffer,at=ye._tileDebugTextSegments||b.debugSegments;ve.draw(b,J.TRIANGLES,be,we,Mr.alphaBlended,_r.disabled,n_(le,a.bz.transparent,Ke),Ne,tt,ut,at,null,null,null,[ye._globeTileDebugTextBuffer])}function Wi(b,u,m,w){ks(b,0,u+m/2,b.transform.width,m,w)}function At(b,u,m,w){ks(b,u-m/2,0,m,b.transform.height,w)}function ks(b,u,m,w,I,P){const F=b.context,W=F.gl;W.enable(W.SCISSOR_TEST),W.scissor(u*a.q.devicePixelRatio,m*a.q.devicePixelRatio,w*a.q.devicePixelRatio,I*a.q.devicePixelRatio),F.clear({color:P}),W.disable(W.SCISSOR_TEST)}const di=a.d5([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Js}=di;function rs(b,u,m,w){b.emplaceBack(u,m,w)}class Ba{constructor(u){this.vertexArray=new a.d9,this.indices=new a.aO,rs(this.vertexArray,-1,-1,1),rs(this.vertexArray,1,-1,1),rs(this.vertexArray,-1,1,1),rs(this.vertexArray,1,1,1),rs(this.vertexArray,-1,-1,-1),rs(this.vertexArray,1,-1,-1),rs(this.vertexArray,-1,1,-1),rs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=u.createVertexBuffer(this.vertexArray,Js),this.indexBuffer=u.createIndexBuffer(this.indices),this.segment=a.b1.simpleSegment(0,0,36,12)}}function ka(b,u,m,w,I,P){const F=b.context.gl,W=u.paint.get("sky-atmosphere-color"),q=u.paint.get("sky-atmosphere-halo-color"),J=u.paint.get("sky-atmosphere-sun-intensity"),ee=((ae,le,ue,ve,ye)=>({u_matrix_3f:ae,u_sun_direction:le,u_sun_intensity:ue,u_color_tint_r:[ve.r,ve.g,ve.b,ve.a],u_color_tint_m:[ye.r,ye.g,ye.b,ye.a],u_luminance:5e-5}))(a.a6.mat3.fromMat4(a.a6.mat3.create(),w),I,J,W,q);F.framebufferTexture2D(F.FRAMEBUFFER,F.COLOR_ATTACHMENT0,F.TEXTURE_CUBE_MAP_POSITIVE_X+P,u.skyboxTexture,0),m.draw(b,F.TRIANGLES,Xn.disabled,pr.disabled,Mr.unblended,_r.frontCW,ee,"skyboxCapture",u.skyboxGeometry.vertexBuffer,u.skyboxGeometry.indexBuffer,u.skyboxGeometry.segment)}const uc=a.d5([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Oa{constructor(u){const m=new a.da;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const w=new a.aO;w.emplaceBack(0,1,2),w.emplaceBack(2,3,0),this.vertexBuffer=u.createVertexBuffer(m,uc.members),this.indexBuffer=u.createIndexBuffer(w),this.segments=a.b1.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const rm=a.d5([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class ff{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class df{constructor(u){this.colorModeAlphaBlendedWriteRGB=new Mr([1,yo,1,yo],a.bz.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Mr([1,0,1,0],a.bz.transparent,[!1,!1,!1,!0]),this.params=new ff,this.updateNeeded=!0,u.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),u.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),u.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),u.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(u){const m=u.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Oa(m);const w=this.params.sizeRange,I=this.params.intensityRange,P=function(ee){const ae=a.dd(30),le=[];for(let ue=0;ue<ee;++ue){const ve=2*Math.PI*ae(),ye=Math.acos(1-2*ae())-.5*Math.PI;le.push(a.a6.vec3.fromValues(Math.cos(ye)*Math.cos(ve),Math.cos(ye)*Math.sin(ve),Math.sin(ye)))}return le}(this.params.starsCount),F=a.dd(300),W=new a.db,q=new a.aO;let J=0;for(let ee=0;ee<P.length;++ee){const ae=a.a6.vec3.scale([],P[ee],200),le=Math.max(0,1+.01*w*(1*F()-.5)),ue=Math.max(0,1+.01*I*(1*F()-.5));W.emplaceBack(ae[0],ae[1],ae[2],-1,-1,le,ue),W.emplaceBack(ae[0],ae[1],ae[2],1,-1,le,ue),W.emplaceBack(ae[0],ae[1],ae[2],1,1,le,ue),W.emplaceBack(ae[0],ae[1],ae[2],-1,1,le,ue),q.emplaceBack(J+0,J+1,J+2),q.emplaceBack(J+0,J+2,J+3),J+=4}this.starsVx=m.createVertexBuffer(W,rm.members),this.starsIdx=m.createIndexBuffer(q),this.starsSegments=a.b1.simpleSegment(0,0,W.length,q.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(u,m){const w=u.context,I=w.gl,P=u.transform,F=new Xn(I.LEQUAL,Xn.ReadOnly,[0,1]),W=a.a9(P.zoom),q=u.style.getLut(m.scope),J=m.properties.get("color").toRenderColor(q).toArray01(),ee=m.properties.get("high-color").toRenderColor(q).toArray01(),ae=m.properties.get("space-color").toRenderColor(q).toArray01PremultipliedAlpha(),le=5e-4,ue=a.dc(m.properties.get("horizon-blend"),0,1,le,.25),ve=a.cx(u,w,P)&&ue===le?P.worldSize/(2*Math.PI*1.025)-1:P.globeRadius,ye=u.frameCounter/1e3%1,be=a.a6.vec3.length(P.globeCenterInViewSpace),we=Math.sqrt(Math.pow(be,2)-Math.pow(ve,2)),ke=Math.acos(we/be),Ne=De=>{const $e=P.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];De&&$e.push("ALPHA_PASS");const je=u.getOrCreateProgram("globeAtmosphere",{defines:$e}),et=((tt,ut,at,rt,bt,Ft,Zt,kt,hn,wt,Wt,Gt)=>({u_frustum_tl:tt,u_frustum_tr:ut,u_frustum_br:at,u_frustum_bl:rt,u_horizon:bt,u_transition:Ft,u_fadeout_range:Zt,u_color:kt,u_high_color:hn,u_space_color:wt,u_temporal_offset:Wt,u_horizon_angle:Gt}))(P.frustumCorners.TL,P.frustumCorners.TR,P.frustumCorners.BR,P.frustumCorners.BL,P.frustumCorners.horizon,W,ue,J,ee,ae,ye,ke);u.uploadCommonUniforms(w,je);const Ke=this.atmosphereBuffer;Ke&&je.draw(u,I.TRIANGLES,F,pr.disabled,De?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,_r.backCW,et,De?"atmosphere_glow_alpha":"atmosphere_glow",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)};Ne(!1),Ne(!0)}drawStars(u,m){const w=a.ap(m.properties.get("star-intensity"),0,1);if(w===0)return;const I=u.context,P=I.gl,F=u.transform,W=u.getOrCreateProgram("stars"),q=a.a6.quat.identity([]);a.a6.quat.rotateX(q,q,-F._pitch),a.a6.quat.rotateZ(q,q,-F.angle),a.a6.quat.rotateX(q,q,a.bB(F._center.lat)),a.a6.quat.rotateY(q,q,-a.bB(F._center.lng));const J=a.a6.mat4.fromQuat(new Float32Array(16),q),ee=a.a6.mat4.multiply([],F.starsProjMatrix,J),ae=a.a6.mat3.fromMat4([],J),le=a.a6.mat3.invert([],ae),ue=[0,1,0];a.a6.vec3.transformMat3(ue,ue,le),a.a6.vec3.scale(ue,ue,this.params.sizeMultiplier);const ve=[1,0,0];a.a6.vec3.transformMat3(ve,ve,le),a.a6.vec3.scale(ve,ve,this.params.sizeMultiplier);const ye=(be=ue,we=ve,ke=w,{u_matrix:Float32Array.from(ee),u_up:be,u_right:we,u_intensity_multiplier:ke});var be,we,ke;u.uploadCommonUniforms(I,W),this.starsVx&&this.starsIdx&&W.draw(u,P.TRIANGLES,Xn.disabled,pr.disabled,this.colorModeAlphaBlendedWriteRGB,_r.disabled,ye,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Ld(b,u){const m=[...b],w=u.cameraWorldSizeForFog/u.worldSize,I=a.a6.mat4.identity([]);return a.a6.mat4.scale(I,I,[w,w,1]),a.a6.mat4.multiply(m,I,m),a.a6.mat4.multiply(m,u.worldToFogMatrix,m),m}function nh(b,u,m,w,I){const P=m.material,F=w.context,{baseColorTexture:W,metallicRoughnessTexture:q}=P.pbrMetallicRoughness,{normalTexture:J,occlusionTexture:ee,emissionTexture:ae}=P;function le(ue,ve,ye){if(ue&&(b.push(ve),F.activeTexture.set(F.gl.TEXTURE0+ye),ue.gfxTexture)){const{minFilter:be,magFilter:we,wrapS:ke,wrapT:Ne}=ue.sampler;ue.gfxTexture.bindExtraParam(be,we,ke,Ne)}}le(W,"HAS_TEXTURE_u_baseColorTexture",la.BaseColor),le(q,"HAS_TEXTURE_u_metallicRoughnessTexture",la.MetallicRoughness),le(J,"HAS_TEXTURE_u_normalTexture",la.Normal),le(ee,"HAS_TEXTURE_u_occlusionTexture",la.Occlusion),le(ae,"HAS_TEXTURE_u_emissionTexture",la.Emission),I&&(I.texture||(I.texture=new a.df(w.context,I.image,[I.image.height,I.image.height,I.image.height],F.gl.RGBA8)),F.activeTexture.set(F.gl.TEXTURE0+la.LUT),I.texture&&I.texture.bind(F.gl.LINEAR,F.gl.CLAMP_TO_EDGE),b.push("APPLY_LUT_ON_GPU")),m.texcoordBuffer&&(b.push("HAS_ATTRIBUTE_a_uv_2f"),u.push(m.texcoordBuffer)),m.colorBuffer&&(b.push(m.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),u.push(m.colorBuffer)),m.normalBuffer&&(b.push("HAS_ATTRIBUTE_a_normal_3f"),u.push(m.normalBuffer)),m.pbrBuffer&&(b.push("HAS_ATTRIBUTE_a_pbr"),b.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),u.push(m.pbrBuffer)),P.alphaMode!=="OPAQUE"&&P.alphaMode!=="MASK"||b.push("UNPREMULT_TEXTURE_IN_SHADER"),P.defined||b.push("DIFFUSE_SHADED"),b.push("USE_STANDARD_DERIVATIVES")}function Ya(b,u,m,w,I,P){const F=m.paint.get("model-opacity"),W=u.context,q=new Xn(u.context.gl.LEQUAL,Xn.ReadWrite,u.depthRangeFor3D),J=u.transform,ee=b.mesh,ae=ee.material,le=ae.pbrMetallicRoughness,ue=u.style.fog;let ve;ve=u.transform.projection.zAxisUnit==="pixels"?[...b.nodeModelMatrix]:a.a6.mat4.multiply([],w.zScaleMatrix,b.nodeModelMatrix),a.a6.mat4.multiply(ve,w.negCameraPosMatrix,ve);const ye=a.a6.mat4.invert([],ve);a.a6.mat4.transpose(ye,ye);const be=m.paint.get("model-emissive-strength").constantOr(0),we=Fn(new Float32Array(b.worldViewProjection),new Float32Array(ve),new Float32Array(ye),null,u,F,le.baseColorFactor.toRenderColor(null),ae.emissiveFactor,le.metallicFactor,le.roughnessFactor,ae,be,m),ke={defines:[]},Ne=[];nh(ke.defines,Ne,ee,u,m.lut);const De=u.shadowRenderer;De&&(De.useNormalOffset=!1);let $e=null;if(ue){const Ke=Ld(b.nodeModelMatrix,u.transform);if($e=new Float32Array(Ke),J.projection.name!=="globe"){const tt=ee.aabb.min,ut=ee.aabb.max,[at,rt]=ue.getOpacityForBounds(Ke,tt[0],tt[1],ut[0],ut[1]);ke.overrideFog=at>=Mn||rt>=Mn}}const je=ic(u,m.paint.get("model-cutoff-fade-range"));je.shouldRenderCutoff&&ke.defines.push("RENDER_CUTOFF");const et=u.getOrCreateProgram("model",ke);u.uploadCommonUniforms(W,et,null,$e,je),u.renderPass!=="shadow"&&De&&De.setupShadowsFromMatrix(b.nodeModelMatrix,et),et.draw(u,W.gl.TRIANGLES,q,I,P,ee.material.doubleSided?_r.disabled:_r.backCCW,we,m.id,ee.vertexBuffer,ee.indexBuffer,ee.segments,m.paint,u.transform.zoom,void 0,Ne)}function pf(b,u,m,w,I,P,F){let W;W=b.projection.name==="globe"?a.dg(m,b):[...m],a.a6.mat4.multiply(W,W,u.matrix);const q=a.a6.mat4.multiply([],w,W);if(u.meshes)for(const J of u.meshes){if(J.material.alphaMode!=="BLEND"){F.push({mesh:J,depth:0,modelIndex:I,worldViewProjection:q,nodeModelMatrix:W});continue}const ee=a.a6.vec3.transformMat4([],J.centroid,q);ee[2]>0&&P.push({mesh:J,depth:ee[2],modelIndex:I,worldViewProjection:q,nodeModelMatrix:W})}if(u.children)for(const J of u.children)pf(b,J,m,w,I,P,F)}function rh(b,u,m,w){const I=m.shadowRenderer;if(!I)return;const P=I.getShadowPassDepthMode(),F=I.getShadowPassColorMode(),W=I.calculateShadowPassMatrixFromMatrix(u),q=sr(W);m.getOrCreateProgram("modelDepth",{defines:m._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(m,m.context.gl.TRIANGLES,P,pr.disabled,F,_r.backCCW,q,w.id,b.vertexBuffer,b.indexBuffer,b.segments,w.paint,m.transform.zoom,void 0,void 0)}function mf(b,u,m){const w=u.updateZoomBasedPaintProperties(),I=function(P,F,W){let q,J,ee,ae=P.terrain?P.terrain.exaggeration():0;if(P.terrain&&ae>0){const le=P.terrain,ue=le.findDEMTileFor(W);ue&&ue.dem?q=a.di.create(le,W,ue):ae=0}if(ae===0&&(F.terrainElevationMin=0,F.terrainElevationMax=0),ae===F.validForExaggeration&&(ae===0||q&&q._demTile&&q._demTile.tileID===F.validForDEMTile.id&&q._dem._timestamp===F.validForDEMTile.timestamp))return!1;for(const le in F.instancesPerModel){const ue=F.instancesPerModel[le];for(let ve=0;ve<ue.instancedDataArray.length;++ve){const ye=(q?ae*q.getElevationAt(0|ue.instancedDataArray.float32[16*ve],0|ue.instancedDataArray.float32[16*ve+1],!0,!0):0)+ue.instancesEvaluatedElevation[ve];ue.instancedDataArray.float32[16*ve+6]=ye,J=J?Math.min(F.terrainElevationMin,ye):ye,ee=ee?Math.max(F.terrainElevationMax,ye):ye}}return F.terrainElevationMin=J||0,F.terrainElevationMax=ee||0,F.validForExaggeration=ae,F.validForDEMTile=q&&q._demTile?{id:q._demTile.tileID,timestamp:q._dem._timestamp}:{id:void 0,timestamp:0},!0}(b,u,m);(w||I)&&(u.uploaded=!1,u.upload(b.context))}const Qo={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new a.c9([0,0,0],[a.ab,a.ab,0])};function o_(b,u){const m=1<<b.canonical.z,w=u.getFreeCameraOptions().position,I=u.elevation,P=b.canonical.x/m,F=(b.canonical.x+1)/m,W=b.canonical.y/m,q=(b.canonical.y+1)/m;let J=u._centerAltitude;if(I){const ue=I.getMinMaxForTile(b);ue&&ue.max>J&&(J=ue.max)}const ee=a.ap(w.x,P,F)-w.x,ae=a.ap(w.y,W,q)-w.y,le=a.bD(J,u.center.lat)-w.z;return u._zoomFromMercatorZ(Math.sqrt(ee*ee+ae*ae+le*le))}function js(b,u,m,w,I,P,F){const W=b.context,q=b.renderPass==="shadow",J=b.shadowRenderer,ee=q&&J?J.getShadowPassDepthMode():new Xn(W.gl.LEQUAL,Xn.ReadWrite,b.depthRangeFor3D),ae=b.isTileAffectedByFog(P);if(m.meshes)for(const le of m.meshes){const ue=["MODEL_POSITION_ON_GPU"],ve=[];let ye,be,we;w.instancedDataArray.length>20&&ue.push("INSTANCED_ARRAYS");const ke=ic(b,u.paint.get("model-cutoff-fade-range"));if(ke.shouldRenderCutoff&&ue.push("RENDER_CUTOFF"),q&&J)ye=b.getOrCreateProgram("modelDepth",{defines:ue}),be=sr(F.shadowTileMatrix,F.shadowTileMatrix,Float32Array.from(m.matrix)),we=J.getShadowPassColorMode();else{nh(ue,ve,le,b,u.lut),ye=b.getOrCreateProgram("model",{defines:ue,overrideFog:ae});const De=le.material,$e=De.pbrMetallicRoughness,je=u.paint.get("model-opacity"),et=u.paint.get("model-emissive-strength").constantOr(0);be=Fn(P.expandedProjMatrix,Float32Array.from(m.matrix),new Float32Array(16),null,b,je,$e.baseColorFactor.toRenderColor(null),De.emissiveFactor,$e.metallicFactor,$e.roughnessFactor,De,et,u,I),J&&(F.shadowUniformsInitialized?ye.setShadowUniformValues(W,J.getShadowUniformValues()):(J.setupShadows(P.toUnwrapped(),ye,"model-tile",P.overscaledZ),F.shadowUniformsInitialized=!0)),we=ke.shouldRenderCutoff||je<1||De.alphaMode!=="OPAQUE"?Mr.alphaBlended:Mr.unblended}b.uploadCommonUniforms(W,ye,P.toUnwrapped(),null,ke);const Ne=le.material.doubleSided?_r.disabled:_r.backCCW;if(w.instancedDataArray.length>20)ve.push(w.instancedDataBuffer),ye.draw(b,W.gl.TRIANGLES,ee,pr.disabled,we,Ne,be,u.id,le.vertexBuffer,le.indexBuffer,le.segments,u.paint,b.transform.zoom,void 0,ve,w.instancedDataArray.length);else{const De=q?"u_instance":"u_normal_matrix";for(let $e=0;$e<w.instancedDataArray.length;++$e)be[De]=new Float32Array(w.instancedDataArray.arrayBuffer,64*$e,16),ye.draw(b,W.gl.TRIANGLES,ee,pr.disabled,we,Ne,be,u.id,le.vertexBuffer,le.indexBuffer,le.segments,u.paint,b.transform.zoom,void 0,ve)}}if(m.children)for(const le of m.children)js(b,u,le,w,I,P,F)}const Gg=[1,-1,1];function Pl(b,u,m,w){if(!m.modelManager)return!0;const I=m.modelManager;if(!m.shadowRenderer)return!0;const P=m.shadowRenderer,F=u.aabb;let W=!0,q=b.maxHeight;if(q===0){let ee=0;for(const ae in b.instancesPerModel){const le=I.getModel(ae,w);le?ee=Math.max(ee,Math.max(Math.max(le.aabb.max[0],le.aabb.max[1]),le.aabb.max[2])):W=!1}q=b.maxScale*ee*1.41+b.maxVerticalOffset,W&&(b.maxHeight=q)}F.max[2]=q,F.min[2]+=b.terrainElevationMin,F.max[2]+=b.terrainElevationMax,a.a6.vec3.transformMat4(F.min,F.min,u.tileMatrix),a.a6.vec3.transformMat4(F.max,F.max,u.tileMatrix);const J=F.intersects(P.getCurrentCascadeFrustum());return m.currentShadowCascade===0&&(b.isInsideFirstShadowMapFrustum=J===2),J===0}function Fi(b,u){const m=b.uniformValues.u_cutoff_params[0],w=b.uniformValues.u_cutoff_params[1],I=b.uniformValues.u_cutoff_params[2],P=b.uniformValues.u_cutoff_params[3];return w===m||P===I?1:a.ap(((u-m)/(w-m)-I)/(P-I),0,1)}function Qr(b,u,m,w){if(u.pitch<20)return 1;const I=u.getWorldToCameraMatrix();a.a6.mat4.multiply(I,I,b);const P=a.a6.vec4.fromValues(m.min[0],m.min[1],m.min[2],1);let F=a.a6.vec4.transformMat4(a.a6.vec4.create(),P,I),W=F,q=F;P[1]=m.max[1],F=a.a6.vec4.transformMat4(a.a6.vec4.create(),P,I),W=F[1]<W[1]?F:W,q=F[1]>q[1]?F:q,P[0]=m.max[0],F=a.a6.vec4.transformMat4(a.a6.vec4.create(),P,I),W=F[1]<W[1]?F:W,q=F[1]>q[1]?F:q,P[1]=m.min[1],F=a.a6.vec4.transformMat4(a.a6.vec4.create(),P,I),W=F[1]<W[1]?F:W,q=F[1]>q[1]?F:q;const J=a.ap(w[0],0,1),ee=100*u.pixelsPerMeter*a.ap(w[1],0,1),ae=a.ap(w[2],0,1),le=a.a6.vec4.lerp(a.a6.vec4.create(),W,q,J),ue=Math.tan(.5*u.fovX),ve=-le[2]*ue;if(ee===0)return le[1]<-Math.abs(ve)?ae:1;const ye=(-Math.abs(ve)-le[1])/ee,be=(ke,Ne,De)=>(1-De)*ke+De*Ne,we=a.ap(be(1,ae,ye),ae,1);return be(1,we,a.ap((u.pitch-20)/20,0,1))}class Vg{}class hc{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(u,m,w){{const ae=this._storage.get(m.id);if(ae)return ae.lastUsedFrameIdx=u,ae.buf}const I=w.gl,P=I.getBufferParameter(I.ELEMENT_ARRAY_BUFFER,I.BUFFER_SIZE),F=new ArrayBuffer(P),W=new Int16Array(F);I.getBufferSubData(I.ELEMENT_ARRAY_BUFFER,0,new Int16Array(F));const q=new a.dk;for(let ae=0;ae<P/2;ae+=3){const le=W[ae],ue=W[ae+1],ve=W[ae+2];q.emplaceBack(le,ue),q.emplaceBack(ue,ve),q.emplaceBack(ve,le)}const J=w.bindVertexArrayOES.current,ee=new Vg;return ee.buf=new xo(w,q),ee.lastUsedFrameIdx=u,this._storage.set(m.id,ee),w.bindVertexArrayOES.set(J),ee.buf}update(u){for(const[m,w]of this._storage)u-w.lastUsedFrameIdx>30&&(w.buf.destroy(),this._storage.delete(m))}destroy(){for(const[u,m]of this._storage)m.buf.destroy(),this._storage.delete(u)}}class gf{constructor(u){this.occluderSize=30,this.depthOffset=-1e-4,u.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),u.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Qs={symbol:function(b,u,m,w,I){if(b.renderPass!=="translucent")return;const P=pr.disabled,F=b.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(J,ee,ae,le,ue,ve,ye){const be=ee.transform,we=ue==="map",ke=ve==="map";for(const Ne of J){const De=le.getTile(Ne),$e=De.getBucket(ae);if(!$e||!$e.text||!$e.text.segments.get().length)continue;const je=a.bj($e.textSizeData,be.zoom),et=Nc(Ne,$e.getProjection(),be),Ke=be.calculatePixelsToTileUnitsMatrix(De),tt=ei(et,De.tileID.canonical,ke,we,be,$e.getProjection(),Ke),ut=$e.hasIconTextFit()&&$e.hasIconData();if(je){const at=Math.pow(2,be.zoom-De.tileID.overscaledZ);zx($e,we,ke,ye,a.cS,be,tt,Ne,at,je,ut)}}}(w,b,m,u,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),I);const W=m.paint.get("icon-opacity").constantOr(1)!==0,q=m.paint.get("text-opacity").constantOr(1)!==0;m.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(W||q)?Cd(b,u,m,w,P,F):(W&&Cd(b,u,m,w,P,F,{onlyIcons:!0}),q&&Cd(b,u,m,w,P,F,{onlyText:!0})),u.map.showCollisionBoxes&&(em(b,u,m,w,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),em(b,u,m,w,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(b,u,m,w){if(b.renderPass!=="translucent")return;const I=m.paint.get("circle-opacity"),P=m.paint.get("circle-stroke-width"),F=m.paint.get("circle-stroke-opacity"),W=m.layout.get("circle-sort-key").constantOr(1)!==void 0,q=m.paint.get("circle-emissive-strength");if(I.constantOr(1)===0&&(P.constantOr(1)===0||F.constantOr(1)===0))return;const J=b.context,ee=J.gl,ae=b.transform,le=b.depthModeForSublayer(0,Xn.ReadOnly),ue=pr.disabled,ve=b.colorModeForDrapableLayerRenderPass(q),ye=ae.projection.name==="globe",be=[a.am(ae.center.lng),a.at(ae.center.lat)],we=[];for(let Ne=0;Ne<w.length;Ne++){const De=w[Ne],$e=u.getTile(De),je=$e.getBucket(m);if(!je||je.projection.name!==ae.projection.name)continue;const et=je.programConfigurations.get(m.id),Ke=a.cT(m),tt=b.isTileAffectedByFog(De);ye&&Ke.push("PROJECTION_GLOBE_VIEW"),Ke.push("DEPTH_D24"),b.terrain&&ae.depthOcclusionForSymbolsAndCircles&&Ke.push("DEPTH_OCCLUSION");const ut=b.getOrCreateProgram("circle",{config:et,defines:Ke,overrideFog:tt}),at=je.layoutVertexBuffer,rt=je.globeExtVertexBuffer,bt=je.indexBuffer,Ft=ae.projection.createInversionMatrix(ae,De.canonical),Zt={programConfiguration:et,program:ut,layoutVertexBuffer:at,globeExtVertexBuffer:rt,indexBuffer:bt,uniformValues:a.cU(b,De,$e,Ft,be,m),tile:$e};if(W){const kt=je.segments.get();for(const hn of kt)we.push({segments:new a.b1([hn]),sortKey:hn.sortKey,state:Zt})}else we.push({segments:je.segments,sortKey:0,state:Zt})}W&&we.sort((Ne,De)=>Ne.sortKey-De.sortKey);const ke={useDepthForOcclusion:ae.depthOcclusionForSymbolsAndCircles};for(const Ne of we){const{programConfiguration:De,program:$e,layoutVertexBuffer:je,globeExtVertexBuffer:et,indexBuffer:Ke,uniformValues:tt,tile:ut}=Ne.state,at=Ne.segments;b.terrain&&b.terrain.setupElevationDraw(ut,$e,ke),b.uploadCommonUniforms(J,$e,ut.tileID.toUnwrapped()),$e.draw(b,ee.TRIANGLES,le,ue,ve,_r.disabled,tt,m.id,je,Ke,at,m.paint,ae.zoom,De,[et])}},heatmap:function(b,u,m,w){if(m.paint.get("heatmap-opacity")!==0)if(b.renderPass==="offscreen"){const I=b.context,P=I.gl,F=pr.disabled,W=new Mr([P.ONE,P.ONE,P.ONE,P.ONE],a.bz.transparent,[!0,!0,!0,!0]);(function(ue,ve,ye,be){const we=ue.gl,ke=ve.width*be,Ne=ve.height*be;ue.activeTexture.set(we.TEXTURE1),ue.viewport.set([0,0,ke,Ne]);let De=ye.heatmapFbo;if(!De||De&&(De.width!==ke||De.height!==Ne)){De&&De.destroy();const $e=we.createTexture();we.bindTexture(we.TEXTURE_2D,$e),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_S,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_WRAP_T,we.CLAMP_TO_EDGE),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MIN_FILTER,we.LINEAR),we.texParameteri(we.TEXTURE_2D,we.TEXTURE_MAG_FILTER,we.LINEAR),De=ye.heatmapFbo=ue.createFramebuffer(ke,Ne,!0,null),function(je,et,Ke,tt,ut,at){const rt=je.gl;rt.texImage2D(rt.TEXTURE_2D,0,je.extRenderToTextureHalfFloat?rt.RGBA16F:rt.RGBA,ut,at,0,rt.RGBA,je.extRenderToTextureHalfFloat?rt.HALF_FLOAT:rt.UNSIGNED_BYTE,null),tt.colorAttachment.set(Ke)}(ue,0,$e,De,ke,Ne)}else we.bindTexture(we.TEXTURE_2D,De.colorAttachment.get()),ue.bindFramebuffer.set(De.framebuffer)})(I,b,m,b.transform.projection.name==="globe"?.5:.25),I.clear({color:a.bz.transparent});const q=b.transform,J=q.projection.name==="globe",ee=J?["PROJECTION_GLOBE_VIEW"]:[],ae=J?_r.frontCCW:_r.disabled,le=[a.am(q.center.lng),a.at(q.center.lat)];for(let ue=0;ue<w.length;ue++){const ve=w[ue];if(u.hasRenderableParent(ve))continue;const ye=u.getTile(ve),be=ye.getBucket(m);if(!be||be.projection.name!==q.projection.name)continue;const we=b.isTileAffectedByFog(ve),ke=be.programConfigurations.get(m.id),Ne=b.getOrCreateProgram("heatmap",{config:ke,defines:ee,overrideFog:we}),{zoom:De}=b.transform;b.terrain&&b.terrain.setupElevationDraw(ye,Ne),b.uploadCommonUniforms(I,Ne,ve.toUnwrapped());const $e=q.projection.createInversionMatrix(q,ve.canonical);Ne.draw(b,P.TRIANGLES,Xn.disabled,F,W,ae,kg(b,ve,ye,$e,le,De,m.paint.get("heatmap-intensity")),m.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,m.paint,b.transform.zoom,ke,J?[be.globeExtVertexBuffer]:null)}I.viewport.set([0,0,b.width,b.height])}else b.renderPass==="translucent"&&(b.context.setColorMode(b.colorModeForRenderPass()),function(I,P){const F=I.context,W=F.gl,q=P.heatmapFbo;if(!q)return;F.activeTexture.set(W.TEXTURE0),W.bindTexture(W.TEXTURE_2D,q.colorAttachment.get()),F.activeTexture.set(W.TEXTURE1);let J=P.colorRampTexture;J||(J=P.colorRampTexture=new a.T(F,P.colorRamp,W.RGBA8)),J.bind(W.LINEAR,W.CLAMP_TO_EDGE),I.getOrCreateProgram("heatmapTexture").draw(I,W.TRIANGLES,Xn.disabled,pr.disabled,I.colorModeForRenderPass(),_r.disabled,((ee,ae,le,ue)=>({u_image:0,u_color_ramp:1,u_opacity:ae.paint.get("heatmap-opacity")}))(0,P),P.id,I.viewportBuffer,I.quadTriangleIndexBuffer,I.viewportSegments,P.paint,I.transform.zoom)}(b,m))},line:function(b,u,m,w){if(b.renderPass!=="translucent")return;const I=m.paint.get("line-opacity"),P=m.paint.get("line-width");if(I.constantOr(1)===0||P.constantOr(1)===0)return;const F=m.paint.get("line-emissive-strength"),W=m.paint.get("line-occlusion-opacity"),q=b.context,J=q.gl,ee=m.layout.get("line-z-offset"),ae=!ee.isConstant()||!!ee.constantOr(0),le=ae?new Xn(b.depthOcclusion?J.GREATER:J.LEQUAL,Xn.ReadOnly,b.depthRangeFor3D):b.depthModeForSublayer(0,Xn.ReadOnly),ue=b.colorModeForDrapableLayerRenderPass(F),ve=b.terrain&&b.terrain.renderingToTexture,ye=ve?1:a.q.devicePixelRatio,be=m.paint.get("line-dasharray"),we=be.constantOr(1),ke=m.layout.get("line-cap"),Ne=be.constantOr(null),De=ke.constantOr(null),$e=m.paint.get("line-pattern"),je=$e.constantOr(1),et=$e.constantOr(null),Ke=m.paint.get("line-opacity").constantOr(1);let tt=!je&&Ke!==1||b.depthOcclusion&&W>0&&W<1;const ut=m.paint.get("line-gradient"),at=je?"linePattern":"line",rt=a.cV(m);let bt;if(ve&&b.terrain&&b.terrain.clipOrMaskOverlapStencilType()&&(tt=!1),W!==0&&b.depthOcclusion){const Zt=m.paint._values["line-opacity"];Zt&&Zt.value&&Zt.value.kind==="constant"?bt=Zt.value:a.w(`Occlusion opacity for layer ${m.id} is supported only when line-opacity isn't data-driven.`)}if(ae&&(b.forceTerrainMode=!0),!ae&&W!==0&&b.terrain&&!ve)return void a.w(`Occlusion opacity for layer ${m.id} is supported on terrain only if the layer has non-zero line-z-offset.`);const Ft=tt&&ae?b.stencilModeFor3D():pr.disabled;for(const Zt of w){const kt=u.getTile(Zt);if(je&&!kt.patternsLoaded())continue;const hn=kt.getBucket(m);if(!hn)continue;b.prepareDrawTile();const wt=hn.programConfigurations.get(m.id),Wt=b.isTileAffectedByFog(Zt),Gt=b.getOrCreateProgram(at,{config:wt,defines:ae?[...rt,"ELEVATED"]:rt,overrideFog:Wt});if(et&&kt.imageAtlas){const xn=kt.imageAtlas.patternPositions[et.toString()];xn&&wt.setConstantPatternPositions(xn)}if(!je&&Ne&&De&&kt.lineAtlas){const xn=kt.lineAtlas.getDash(Ne,De);xn&&wt.setConstantPatternPositions(xn)}let[fn,pn]=m.paint.get("line-trim-offset");(De==="round"||De==="square")&&fn!==pn&&(fn===0&&(fn-=1),pn===1&&(pn+=1));const qt=ve?Zt.projMatrix:null,en=je?a.cW(b,kt,m,qt,ye,[fn,pn]):a.cX(b,kt,m,qt,hn.lineClipsArray.length,ye,[fn,pn]);if(ut){const xn=hn.gradients[m.id];let Dn=xn.texture;if(m.gradientVersion!==xn.version){let yr=256;if(m.stepInterpolant){const qn=u.getSource().maxzoom,ur=Zt.canonical.z===qn?Math.ceil(1<<b.transform.maxZoom-Zt.canonical.z):1;yr=a.ap(a.cY(hn.maxLineLength/a.ab*1024*ur),256,q.maxTextureSize)}xn.gradient=a.cZ({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:yr,image:xn.gradient||void 0,clips:hn.lineClipsArray}),xn.texture?xn.texture.update(xn.gradient):xn.texture=new a.T(q,xn.gradient,J.RGBA8),xn.version=m.gradientVersion,Dn=xn.texture}q.activeTexture.set(J.TEXTURE1),Dn.bind(m.stepInterpolant?J.NEAREST:J.LINEAR,J.CLAMP_TO_EDGE)}we&&(q.activeTexture.set(J.TEXTURE0),kt.lineAtlasTexture&&kt.lineAtlasTexture.bind(J.LINEAR,J.REPEAT),wt.updatePaintBuffers()),je&&(q.activeTexture.set(J.TEXTURE0),kt.imageAtlasTexture&&kt.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),wt.updatePaintBuffers()),ae&&b.terrain.setupElevationDraw(kt,Gt),b.uploadCommonUniforms(q,Gt,Zt.toUnwrapped());const er=xn=>{bt!=null&&(bt.value=Ke*W),Gt.draw(b,J.TRIANGLES,le,xn,ue,_r.disabled,en,m.id,hn.layoutVertexBuffer,hn.indexBuffer,hn.segments,m.paint,b.transform.zoom,wt,[hn.layoutVertexBuffer2,hn.patternVertexBuffer,hn.zOffsetVertexBuffer]),bt!=null&&(bt.value=Ke)};if(tt&&!ae){const xn=b.stencilModeForClipping(Zt).ref;xn===0&&ve&&q.clear({stencil:0});const Dn={func:J.EQUAL,mask:255};en.u_alpha_discard_threshold=.8,er(new pr(Dn,xn,255,J.KEEP,J.KEEP,J.INVERT)),en.u_alpha_discard_threshold=0,er(new pr(Dn,xn,255,J.KEEP,J.KEEP,J.KEEP))}else tt&&ae&&(en.u_alpha_discard_threshold=.001),er(ae?Ft:b.stencilModeForClipping(Zt))}tt&&(b.resetStencilClippingMasks(),ve&&q.clear({stencil:0})),W===0||b.depthOcclusion||ve||b.layersWithOcclusionOpacity.push(b.currentLayer),ae&&(b.forceTerrainMode=!1)},fill:function(b,u,m,w){const I=m.paint.get("fill-color"),P=m.paint.get("fill-opacity"),F=m.is3D(),W=new Xn(b.context.gl.LEQUAL,Xn.ReadWrite,b.depthRangeFor3D);if(P.constantOr(1)===0)return;const q=m.paint.get("fill-emissive-strength"),J=b.colorModeForDrapableLayerRenderPass(q),ee=m.paint.get("fill-pattern"),ae=b.opaquePassEnabledForLayer()&&!ee.constantOr(1)&&I.constantOr(a.bz.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(b.renderPass===ae){const le=F?W:b.depthModeForSublayer(1,b.renderPass==="opaque"?Xn.ReadWrite:Xn.ReadOnly);Id(b,u,m,w,le,J,!1)}if(!F&&b.renderPass==="translucent"&&m.paint.get("fill-antialias")){const le=F?W:b.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,Xn.ReadOnly);Id(b,u,m,w,le,J,!0)}},"fill-extrusion":function(b,u,m,w){const I=m.paint.get("fill-extrusion-opacity"),P=b.context,F=P.gl,W=b.terrain,q=W&&W.renderingToTexture;if(I===0)return;const J=b.conflationActive&&b.style.isLayerClipped(m,u.getSource()),ee=b.style.order.indexOf(m.fqid);if(J&&function(ae,le,ue,ve,ye){for(const be of ve){const we=le.getTile(be).getBucket(ue);we&&(we.updateReplacement(be,ae.replacementSource,ye),we.uploadCentroid(ae.context))}}(b,u,m,w,ee),W||J)for(const ae of w){const le=u.getTile(ae).getBucket(m);le&&lc(b.context,u,ae,le,m,W,J)}if(b.renderPass==="shadow"&&b.shadowRenderer){const ae=b.shadowRenderer;if(W&&I<.65&&m._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof a.a4)return;const le=ae.getShadowPassDepthMode(),ue=ae.getShadowPassColorMode();uf(b,u,m,w,le,pr.disabled,ue,J)}else if(b.renderPass==="translucent"){const ae=!m.paint.get("fill-extrusion-pattern").constantOr(1),le=m.paint.get("fill-extrusion-color").constantOr(a.bz.white);if(!q&&le.a!==0){const ue=new Xn(b.context.gl.LEQUAL,Xn.ReadWrite,b.depthRangeFor3D);I===1&&ae?uf(b,u,m,w,ue,pr.disabled,Mr.unblended,J):(uf(b,u,m,w,ue,pr.disabled,Mr.disabled,J),uf(b,u,m,w,ue,b.stencilModeFor3D(),b.colorModeForRenderPass(),J),b.resetStencilClippingMasks())}if(b.style.enable3dLights()&&ae&&(!W&&b.transform.projection.name!=="globe"||q)){const ue=m.paint.get("fill-extrusion-opacity"),ve=m.paint.get("fill-extrusion-ambient-occlusion-intensity"),ye=m.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),be=m.paint.get("fill-extrusion-flood-light-intensity"),we=m.paint.get("fill-extrusion-flood-light-color").toRenderColor(m.lut).toArray01().slice(0,3),ke=ve>0&&ye>0,Ne=be>0,De=(je,et,Ke)=>(1-Ke)*je+Ke*et,$e=je=>{const et=b.depthModeForSublayer(1,Xn.ReadOnly,F.LEQUAL,!0),Ke=m.paint.get(je?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),tt=De(.1,3,Ke),ut=b._showOverdrawInspector;if(!ut){const at=new pr({func:F.ALWAYS,mask:255},255,255,F.KEEP,F.KEEP,F.REPLACE),rt=new Mr([F.ONE,F.ONE,F.ONE,F.ONE],a.bz.transparent,[!1,!1,!1,!0],F.MIN);ca(b,u,m,w,et,at,rt,_r.disabled,je,"sdf",ue,ve,ye,be,we,tt,J,!1)}{const at=ut?pr.disabled:new pr({func:F.EQUAL,mask:255},255,255,F.KEEP,F.DECR,F.DECR),rt=ut?b.colorModeForRenderPass():new Mr([F.ONE_MINUS_DST_ALPHA,F.DST_ALPHA,F.ONE,F.ONE],a.bz.transparent,[!0,!0,!0,!0]);ca(b,u,m,w,et,at,rt,_r.disabled,je,"color",ue,ve,ye,be,we,tt,J,!1)}};if(q){const je=(et,Ke,tt)=>{const ut=b.depthModeForSublayer(1,Xn.ReadOnly,F.LEQUAL,!1),at=m.paint.get(et?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),rt=De(.1,3,at);{const bt=new Mr([F.ONE,F.ONE,F.ONE,F.ONE],a.bz.transparent,[!1,!1,!1,!0]);ca(b,u,m,w,ut,pr.disabled,bt,_r.disabled,et,"clear",ue,ve,ye,be,we,rt,J,Ke)}{const bt=new pr({func:F.ALWAYS,mask:255},255,255,F.KEEP,F.KEEP,F.REPLACE),Ft=new Mr([F.ONE,F.ONE,F.ONE,F.ONE],a.bz.transparent,[!1,!1,!1,!0],F.MIN);ca(b,u,m,w,ut,bt,Ft,_r.disabled,et,"sdf",ue,ve,ye,be,we,rt,J,Ke)}{const bt=et?F.ZERO:F.ONE_MINUS_DST_ALPHA,Ft=new pr({func:F.EQUAL,mask:255},255,255,F.KEEP,F.DECR,F.DECR),Zt=new Mr([bt,F.DST_ALPHA,F.ONE_MINUS_DST_ALPHA,F.ZERO],a.bz.transparent,[!0,!0,!0,!0]);ca(b,u,m,w,ut,Ft,Zt,_r.disabled,et,"color",ue,ve,ye,be,we,rt,J,Ke)}{const bt=new Mr([F.ONE,F.ONE,F.ONE,et?F.ZERO:F.ONE],a.bz.transparent,[!1,!1,!1,!0],et?F.FUNC_ADD:F.MAX);ca(b,u,m,w,ut,pr.disabled,bt,_r.disabled,et,"clear",ue,ve,ye,be,we,rt,J,Ke,tt)}};if(ke||Ne){let et;if(b.prepareDrawTile(),W){const Ke=W.drapeBufferSize[0],tt=W.drapeBufferSize[1];et=W.framebufferCopyTexture,et&&(!et||et.size[0]===Ke&&et.size[1]===tt)||(et&&et.destroy(),et=W.framebufferCopyTexture=new a.T(P,new a.r({width:Ke,height:tt}),F.RGBA8)),et.bind(F.LINEAR,F.CLAMP_TO_EDGE),F.copyTexImage2D(F.TEXTURE_2D,0,F.RGBA,0,0,Ke,tt,0)}ke&&je(!0,!1,et),Ne&&je(!1,!0,et)}}else ke&&$e(!0),Ne&&$e(!1),(ke||Ne)&&b.resetStencilClippingMasks()}}},hillshade:function(b,u,m,w){if(b.renderPass!=="offscreen"&&b.renderPass!=="translucent"||b.style.disableElevatedTerrain)return;const I=b.context,P=b.terrain&&b.terrain.renderingToTexture,[F,W]=b.renderPass!=="translucent"||P?[{},w]:b.stencilConfigForOverlap(w);for(const q of W){const J=u.getTile(q);if(J.needsHillshadePrepare&&b.renderPass==="offscreen")ac(b,J,m);else if(b.renderPass==="translucent"){const ee=b.depthModeForSublayer(0,Xn.ReadOnly),ae=m.paint.get("hillshade-emissive-strength"),le=b.colorModeForDrapableLayerRenderPass(ae),ue=P&&b.terrain?b.terrain.stencilModeForRTTOverlap(q):F[q.overscaledZ];Cl(b,q,J,m,ee,ue,le)}}I.viewport.set([0,0,b.width,b.height]),b.resetStencilClippingMasks()},raster:function(b,u,m,w,I,P){if(b.renderPass!=="translucent"||m.paint.get("raster-opacity")===0)return;const F=b.transform.projection.name==="globe",W=m.paint.get("raster-elevation")!==0,q=W&&F;if(b.renderElevatedRasterBackface&&!q)return;const J=b.context,ee=J.gl,ae=u.getSource(),le=function(je,et,Ke,tt){const ut=et.paint.get("raster-color"),at=je.type==="raster-array",rt=[],bt=et.paint.get("raster-resampling"),Ft=et.paint.get("raster-color-mix");let Zt=et.paint.get("raster-color-range");const kt=[Ft[0],Ft[1],Ft[2],0],hn=Ft[3];let wt=bt==="nearest"?tt.NEAREST:tt.LINEAR;if(at&&(rt.push("RASTER_ARRAY"),ut||rt.push("RASTER_COLOR"),bt==="linear"&&rt.push("RASTER_ARRAY_LINEAR"),wt=tt.NEAREST,!Zt&&je.rasterLayers)){const Wt=je.rasterLayers.find(({id:Gt})=>Gt===et.sourceLayer);Wt&&Wt.fields&&Wt.fields.range&&(Zt=Wt.fields.range)}if(Zt=Zt||[0,1],ut){rt.push("RASTER_COLOR"),Ke.activeTexture.set(tt.TEXTURE2),et.updateColorRamp(Zt);let Wt=et.colorRampTexture;Wt||(Wt=et.colorRampTexture=new a.T(Ke,et.colorRamp,tt.RGBA8)),Wt.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}return{mix:kt,range:Zt,offset:hn,defines:rt,resampling:wt}}(ae,m,J,ee);if(ae instanceof a.aD&&!w.length&&!F)return;const ue=m.paint.get("raster-emissive-strength"),ve=b.colorModeForDrapableLayerRenderPass(ue),ye=b.terrain&&b.terrain.renderingToTexture,be=!b.options.moving,we=m.paint.get("raster-resampling")==="nearest"?ee.NEAREST:ee.LINEAR;if(ae instanceof a.aD&&!w.length&&(ae.onNorthPole||ae.onSouthPole)){const je=W?b.stencilModeFor3D():pr.disabled;return void No(!!ae.onNorthPole,null,b,u,m,ue,le,_r.disabled,je)}if(!w.length)return;const[ke,Ne]=ae instanceof a.aD||ye?[{},w]:b.stencilConfigForOverlap(w),De=Ne[Ne.length-1].overscaledZ;q&&le.defines.push("PROJECTION_GLOBE_VIEW"),W&&le.defines.push("RENDER_CUTOFF");const $e=(je,et,Ke)=>{for(const tt of je){const ut=tt.toUnwrapped(),at=u.getTile(tt);if(ye&&(!at||!at.hasData()))continue;J.activeTexture.set(ee.TEXTURE0);const rt=hf(at,ae,m,le);if(!rt||!rt.texture)continue;const{texture:bt,mix:Ft,offset:Zt,tileSize:kt,buffer:hn}=rt;let wt,Wt;ye?(wt=Xn.disabled,Wt=tt.projMatrix):W?(wt=new Xn(ee.LEQUAL,Xn.ReadWrite,b.depthRangeFor3D),Wt=F?Float32Array.from(b.transform.expandedFarZProjMatrix):b.transform.calculateProjMatrix(ut,be)):(wt=b.depthModeForSublayer(tt.overscaledZ-De,m.paint.get("raster-opacity")===1?Xn.ReadWrite:Xn.ReadOnly,ee.LESS),Wt=b.transform.calculateProjMatrix(ut,be));const Gt=b.terrain&&ye?b.terrain.stencilModeForRTTOverlap(tt):ke[tt.overscaledZ],fn=P?0:m.paint.get("raster-fade-duration");at.registerFadeDuration(fn);const pn=u.findLoadedParent(tt,0),qt=Ju(at,pn,u,b.transform,fn);let en,er;b.terrain&&b.terrain.prepareDrawTile(),J.activeTexture.set(ee.TEXTURE0),bt.bind(we,ee.CLAMP_TO_EDGE),J.activeTexture.set(ee.TEXTURE1),pn?(pn.texture&&pn.texture.bind(we,ee.CLAMP_TO_EDGE),en=Math.pow(2,pn.tileID.overscaledZ-at.tileID.overscaledZ),er=[at.tileID.canonical.x*en%1,at.tileID.canonical.y*en%1]):bt.bind(we,ee.CLAMP_TO_EDGE),bt.useMipmap&&J.extTextureFilterAnisotropic&&b.transform.pitch>20&&ee.texParameterf(ee.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax);const xn=b.transform;let Dn;const yr=W?ds(xn):[0,0,0,0];let qn,ur,Ur,Br,Ci,Ui=0;if(q&&ae instanceof a.aD&&ae.coordinates.length>3)qn=Float32Array.from(a.b5(a.cC(new a.bP(0,0,0)))),ur=Float32Array.from(xn.globeMatrix),Ur=Float32Array.from(a.cy(xn)),Br=[a.am(xn.center.lng),a.at(xn.center.lat)],Dn=ae.elevatedGlobePerspectiveTransform,Ci=ae.elevatedGlobeGridMatrix||new Float32Array(9);else if(q){const Yr=a.cz(tt.canonical);Ui=a.cA(Yr.getCenter().lat),qn=Float32Array.from(a.b5(a.cC(tt.canonical))),ur=Float32Array.from(xn.globeMatrix),Ur=Float32Array.from(a.cy(xn)),Br=[a.am(xn.center.lng),a.at(xn.center.lat)],Dn=[0,0],Ci=Float32Array.from(a.cB(tt.canonical,Yr,Ui,xn.worldSize/xn._pixelsPerMercatorPixel))}else Dn=ae instanceof a.aD?ae.perspectiveTransform:[0,0],qn=new Float32Array(16),ur=new Float32Array(9),Ur=new Float32Array(16),Br=[0,0],Ci=new Float32Array(9);const is=Ad(Wt,qn,ur,Ur,Ci,er||[0,0],a.a9(b.transform.zoom),Br,yr,en||1,qt,m,Dn,W?m.paint.get("raster-elevation"):0,2,Ft,Zt,le.range,kt,hn,ue),Xc=b.isTileAffectedByFog(tt),ea=b.getOrCreateProgram("raster",{defines:le.defines,overrideFog:Xc});if(b.uploadCommonUniforms(J,ea,ut),ae instanceof a.aD){const Yr=ae.elevatedGlobeVertexBuffer,Ni=ae.elevatedGlobeIndexBuffer;if(ye||!F)ae.boundsBuffer&&ae.boundsSegments&&ea.draw(b,ee.TRIANGLES,wt,pr.disabled,ve,_r.disabled,is,m.id,ae.boundsBuffer,b.quadTriangleIndexBuffer,ae.boundsSegments);else if(Yr&&Ni){const Ss=xn.zoom<=a.c2?ae.elevatedGlobeSegments:ae.getSegmentsForLongitude(xn.center.lng);Ss&&ea.draw(b,ee.TRIANGLES,wt,pr.disabled,ve,et,is,m.id,Yr,Ni,Ss)}}else if(q){wt=new Xn(ee.LEQUAL,Xn.ReadOnly,b.depthRangeFor3D);const Yr=b.globeSharedBuffers;if(Yr){const[Ni,Ss,Di]=Yr.getGridBuffers(Ui,!1);ea.draw(b,ee.TRIANGLES,wt,Ke||Gt,b.colorModeForRenderPass(),et,is,m.id,Ni,Ss,Di)}}else{const{tileBoundsBuffer:Yr,tileBoundsIndexBuffer:Ni,tileBoundsSegments:Ss}=b.getTileBoundsBuffers(at);ea.draw(b,ee.TRIANGLES,wt,Gt,ve,_r.disabled,is,m.id,Yr,Ni,Ss)}}if(!(ae instanceof a.aD)&&q)for(const tt of je){const ut=tt.canonical.y===(1<<tt.canonical.z)-1;tt.canonical.y===0&&No(!0,tt,b,u,m,ue,le,et,Ke||pr.disabled),ut&&No(!1,tt,b,u,m,ue,le,et===_r.frontCW?_r.backCW:_r.frontCW,Ke||pr.disabled)}};q?$e(Ne,b.renderElevatedRasterBackface?_r.backCW:_r.frontCW,b.stencilModeFor3D()):$e(Ne,_r.disabled,void 0),b.resetStencilClippingMasks()},"raster-particle":function(b,u,m,w,I,P){b.renderPass==="offscreen"&&function(F,W,q,J){if(!J.length)return;const ee=F.context,ae=ee.gl,le=W.getSource();if(!(le instanceof Cr))return;const ue=Math.ceil(Math.sqrt(q.paint.get("raster-particle-count")));let ve=q.particlePositionRGBAImage;if(!ve||ve.width!==ue){const Ne=function(De){const $e=De*De,je=new Uint8Array(4*$e),et=function(tt){return tt|=0,tt=Math.imul(2747636419^tt,2654435769),tt=Math.imul(tt^tt>>>16,2654435769),((tt=Math.imul(tt^tt>>>16,2654435769))>>>0)/4294967296},Ke=1/1.1;for(let tt=0;tt<$e;tt++){const ut=Ke*(et(2*tt+0)+dl),at=Ke*(et(2*tt+1)+dl),rt=255*ut%1,bt=255*at%1,Ft=rt,Zt=at-bt/255,kt=bt;je[4*tt+0]=255*(ut-rt/255),je[4*tt+1]=255*Ft,je[4*tt+2]=255*Zt,je[4*tt+3]=255*kt}return je}(ue);ve=q.particlePositionRGBAImage=new a.r({width:ue,height:ue},Ne)}let ye=q.particleFramebuffer;ye?ye.width!==ue&&(ye.destroy(),ye=q.particleFramebuffer=ee.createFramebuffer(ue,ue,!0,null)):ye=q.particleFramebuffer=ee.createFramebuffer(ue,ue,!0,null);const be=[];for(const Ne of J){const De=W.getTile(Ne);if(!(De instanceof cg))continue;const $e=nm(De,le,q);if(!$e)continue;const je=[De.tileSize,De.tileSize];let et=q.tileFramebuffer;et||(et=q.tileFramebuffer=ee.createFramebuffer(je[0],je[1],!0,null));let Ke=De.rasterParticleState;Ke||(Ke=De.rasterParticleState=new tm(ee,Ne,je,ve));const tt=Ke.update(q.lastInvalidatedAt);Ke.particleTextureDimension!==ue&&Ke.updateParticleTexture(Ne,ve);const ut=Ke.targetColorTexture;Ke.targetColorTexture=Ke.backgroundColorTexture,Ke.backgroundColorTexture=ut;const at=Ke.particleTexture0;Ke.particleTexture0=Ke.particleTexture1,Ke.particleTexture1=at,be.push([Ne,$e,Ke,tt])}if(be.length===0)return;const we=a.q.now(),ke=q.previousDrawTimestamp?.001*(we-q.previousDrawTimestamp):.0167;if(q.previousDrawTimestamp=we,q.hasColorMap()){ee.activeTexture.set(ae.TEXTURE0+2);let Ne=q.colorRampTexture;Ne||(Ne=q.colorRampTexture=new a.T(ee,q.colorRamp,ae.RGBA8)),Ne.bind(ae.LINEAR,ae.CLAMP_TO_EDGE)}ee.bindFramebuffer.set(q.tileFramebuffer.framebuffer),function(Ne,De,$e){const je=Ne.context,et=je.gl,Ke=De.tileFramebuffer;je.activeTexture.set(et.TEXTURE0);const tt={u_texture:0,u_opacity:1.05*(at=De.paint.get("raster-particle-fade-opacity-factor"))/(at+.05)},ut=Ne.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var at;for(const rt of $e){const[,,bt,Ft]=rt;Ke.colorAttachment.set(bt.targetColorTexture.texture),je.viewport.set([0,0,Ke.width,Ke.height]),je.clear({color:a.bz.transparent}),Ft&&(bt.backgroundColorTexture.bind(et.NEAREST,et.CLAMP_TO_EDGE),ut.draw(Ne,et.TRIANGLES,Xn.disabled,pr.disabled,Mr.alphaBlended,_r.disabled,tt,De.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments))}}(F,q,be),function(Ne,De,$e,je){const et=Ne.context,Ke=et.gl,tt=$e.tileFramebuffer,ut=Ne.transform.projection.name==="globe",at=$e.paint.get("raster-particle-max-speed");for(const rt of je){const[bt,Ft,Zt]=rt;et.activeTexture.set(Ke.TEXTURE0+0),Ft.texture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),tt.colorAttachment.set(Zt.targetColorTexture.texture);const kt=Ne.getOrCreateProgram("rasterParticleDraw",{defines:Ft.defines,overrideFog:!1});et.activeTexture.set(Ke.TEXTURE0+1);const hn=Ft.scalarData?[]:[0,1,2,3].map(Gt=>a.c$[Gt](bt));hn.push(bt);const wt=bt.canonical.x,Wt=bt.canonical.y;for(const Gt of hn){const fn=De.getTile(ut?Gt.wrapped():Gt);if(!fn)continue;const pn=fn.rasterParticleState;if(!pn)continue;const qt=Gt.canonical.x+(1<<Gt.canonical.z)*(Gt.wrap-bt.wrap),en=Gt.canonical.y;pn.particleTexture0.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);const er=Td(1,pn.particleTexture0.size[0],[qt-wt,en-Wt],0,Ft.texture.size,2,at,Ft.textureOffset,Ft.scale,Ft.offset);kt.draw(Ne,Ke.POINTS,Xn.disabled,pr.disabled,Mr.alphaBlended,_r.disabled,er,$e.id,pn.particleIndexBuffer,void 0,pn.particleSegment)}}}(F,W,q,be),ee.bindFramebuffer.set(q.particleFramebuffer.framebuffer),function(Ne,De,$e,je){const et=Ne.context,Ke=et.gl,tt=De.paint.get("raster-particle-max-speed"),ut=je*De.paint.get("raster-particle-speed-factor")*.15,at=function(bt){return Math.pow(bt,6)}(.01+1*De.paint.get("raster-particle-reset-rate-factor")),rt=De.particleFramebuffer;et.viewport.set([0,0,rt.width,rt.height]);for(const bt of $e){const[,Ft,Zt]=bt;et.activeTexture.set(Ke.TEXTURE0+0),Ft.texture.bind(Ke.LINEAR,Ke.CLAMP_TO_EDGE),et.activeTexture.set(Ke.TEXTURE0+1);const kt=Zt.particleTexture0;kt.bind(Ke.NEAREST,Ke.CLAMP_TO_EDGE);const hn=Kp(1,kt.size[0],0,Ft.texture.size,tt,ut,at,Ft.textureOffset,Ft.scale,Ft.offset);rt.colorAttachment.set(Zt.particleTexture1.texture),et.clear({color:a.bz.transparent}),Ne.getOrCreateProgram("rasterParticleUpdate",{defines:Ft.defines}).draw(Ne,Ke.TRIANGLES,Xn.disabled,pr.disabled,Mr.unblended,_r.disabled,hn,De.id,Ne.viewportBuffer,Ne.quadTriangleIndexBuffer,Ne.viewportSegments)}}(F,q,be,ke)}(b,u,m,w),b.renderPass==="translucent"&&(function(F,W,q,J,ee){const ae=F.context,le=ae.gl,ue=W.getSource().tileSize,ve=5*(1-a.a7(a.bU,a.bU+1,F.transform.zoom))*ue+q.paint.get("raster-particle-elevation"),ye=!F.options.moving,be=F.transform.projection.name==="globe";if(!J.length)return;const[we,ke]=F.stencilConfigForOverlap(J),Ne=[];be&&Ne.push("PROJECTION_GLOBE_VIEW");const De=F.stencilModeFor3D();for(const $e of ke){const je=$e.toUnwrapped(),et=W.getTile($e);if(!et.rasterParticleState)continue;const Ke=et.rasterParticleState,tt=100;et.registerFadeDuration(tt);const ut=W.findLoadedParent($e,0),at=Ju(et,ut,W,F.transform,tt);let rt,bt;F.terrain&&F.terrain.prepareDrawTile(),ae.activeTexture.set(le.TEXTURE0),Ke.targetColorTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),ae.activeTexture.set(le.TEXTURE1),ut&&ut.rasterParticleState?(ut.rasterParticleState.targetColorTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE),rt=Math.pow(2,ut.tileID.overscaledZ-et.tileID.overscaledZ),bt=[et.tileID.canonical.x*rt%1,et.tileID.canonical.y*rt%1]):Ke.targetColorTexture.bind(le.LINEAR,le.CLAMP_TO_EDGE);const Ft=be?Float32Array.from(F.transform.expandedFarZProjMatrix):F.transform.calculateProjMatrix(je,ye),Zt=F.transform,kt=Pd(Zt),hn=a.cz($e.canonical),wt=a.cA(hn.getCenter().lat);let Wt,Gt,fn,pn,qt;be?(Wt=Float32Array.from(a.b5(a.cC($e.canonical))),Gt=Float32Array.from(Zt.globeMatrix),fn=Float32Array.from(a.cy(Zt)),pn=[a.am(Zt.center.lng),a.at(Zt.center.lat)],qt=Float32Array.from(a.cB($e.canonical,hn,wt,Zt.worldSize/Zt._pixelsPerMercatorPixel))):(Wt=new Float32Array(16),Gt=new Float32Array(9),fn=new Float32Array(16),pn=[0,0],qt=new Float32Array(9));const en=r_(Ft,Wt,Gt,fn,qt,bt||[0,0],a.a9(F.transform.zoom),pn,kt,rt||1,at,ve),er=F.isTileAffectedByFog($e),xn=F.getOrCreateProgram("rasterParticle",{defines:Ne,overrideFog:er});if(F.uploadCommonUniforms(ae,xn,je),be){const Dn=new Xn(le.LEQUAL,Xn.ReadOnly,F.depthRangeFor3D),yr=0,qn=F.globeSharedBuffers;if(qn){const[ur,Ur,Br]=qn.getGridBuffers(wt,yr!==0);xn.draw(F,le.TRIANGLES,Dn,De,Mr.alphaBlended,F.renderElevatedRasterBackface?_r.frontCCW:_r.backCCW,en,q.id,ur,Ur,Br)}}else{const Dn=F.depthModeForSublayer(0,Xn.ReadOnly),yr=we[$e.overscaledZ],{tileBoundsBuffer:qn,tileBoundsIndexBuffer:ur,tileBoundsSegments:Ur}=F.getTileBoundsBuffers(et);xn.draw(F,le.TRIANGLES,Dn,yr,Mr.alphaBlended,_r.disabled,en,q.id,qn,ur,Ur)}}F.resetStencilClippingMasks()}(b,u,m,w),b.style.map.triggerRepaint())},background:function(b,u,m,w){const I=m.paint.get("background-color"),P=m.paint.get("background-opacity"),F=m.paint.get("background-emissive-strength"),W=m.paint.get("background-pitch-alignment")==="viewport";if(P===0)return;const q=b.context,J=q.gl,ee=b.transform,ae=ee.tileSize,le=m.paint.get("background-pattern");let ue;if(le!==void 0&&(le===null||(ue=b.imageManager.getPattern(le.toString(),m.scope,b.style.getLut(m.scope)),!ue)))return;const ve=!le&&I.a===1&&P===1&&b.opaquePassEnabledForLayer()?"opaque":"translucent";if(b.renderPass!==ve)return;const ye=pr.disabled,be=b.depthModeForSublayer(0,ve==="opaque"?Xn.ReadWrite:Xn.ReadOnly),we=b.colorModeForDrapableLayerRenderPass(F),ke=le?"backgroundPattern":"background";let Ne,De=w;if(De||(Ne=b.getBackgroundTiles(),De=Object.values(Ne).map($e=>$e.tileID)),le&&(q.activeTexture.set(J.TEXTURE0),b.imageManager.bind(b.context,m.scope)),W){const $e=b.getOrCreateProgram(ke,{overrideFog:!1,overrideRtt:!0}),je=new Float32Array(a.a6.mat4.identity([])),et=new a.aA(0,0,0,0,0),Ke=le?Vc(je,F,P,b,0,m.scope,ue,W,{tileID:et,tileSize:ae}):Fx(je,F,P,I.toRenderColor(m.lut));$e.draw(b,J.TRIANGLES,be,ye,we,_r.disabled,Ke,m.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments)}else for(const $e of De){const je=b.isTileAffectedByFog($e),et=b.getOrCreateProgram(ke,{overrideFog:je}),Ke=$e.toUnwrapped(),tt=w?$e.projMatrix:b.transform.calculateProjMatrix(Ke);b.prepareDrawTile();const ut=u?u.getTile($e):Ne?Ne[$e.key]:new Fc($e,ae,ee.zoom,b),at=le?Vc(tt,F,P,b,0,m.scope,ue,W,{tileID:$e,tileSize:ae}):Fx(tt,F,P,I.toRenderColor(m.lut));b.uploadCommonUniforms(q,et,Ke);const{tileBoundsBuffer:rt,tileBoundsIndexBuffer:bt,tileBoundsSegments:Ft}=b.getTileBoundsBuffers(ut);et.draw(b,J.TRIANGLES,be,ye,we,_r.disabled,at,m.id,rt,bt,Ft)}},sky:function(b,u,m){const w=b._atmosphere?a.a9(b.transform.zoom):1,I=m.paint.get("sky-opacity")*w;if(I===0)return;const P=b.context,F=m.paint.get("sky-type"),W=new Xn(P.gl.LEQUAL,Xn.ReadOnly,[0,1]),q=b.frameCounter/1e3%1;F==="atmosphere"?b.renderPass==="offscreen"?m.needsSkyboxCapture(b)&&(function(J,ee,ae,le){const ue=J.context,ve=ue.gl;let ye=ee.skyboxFbo;if(!ye){ye=ee.skyboxFbo=ue.createFramebuffer(32,32,!0,null),ee.skyboxGeometry=new Ba(ue),ee.skyboxTexture=ue.gl.createTexture(),ve.bindTexture(ve.TEXTURE_CUBE_MAP,ee.skyboxTexture),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_CUBE_MAP,ve.TEXTURE_MAG_FILTER,ve.LINEAR);for(let Ne=0;Ne<6;++Ne)ve.texImage2D(ve.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,0,ve.RGBA,32,32,0,ve.RGBA,ve.UNSIGNED_BYTE,null)}ue.bindFramebuffer.set(ye.framebuffer),ue.viewport.set([0,0,32,32]);const be=ee.getCenter(J,!0),we=J.getOrCreateProgram("skyboxCapture"),ke=new Float64Array(16);a.a6.mat4.identity(ke),a.a6.mat4.rotateY(ke,ke,.5*-Math.PI),ka(J,ee,we,ke,be,0),a.a6.mat4.identity(ke),a.a6.mat4.rotateY(ke,ke,.5*Math.PI),ka(J,ee,we,ke,be,1),a.a6.mat4.identity(ke),a.a6.mat4.rotateX(ke,ke,.5*-Math.PI),ka(J,ee,we,ke,be,2),a.a6.mat4.identity(ke),a.a6.mat4.rotateX(ke,ke,.5*Math.PI),ka(J,ee,we,ke,be,3),a.a6.mat4.identity(ke),ka(J,ee,we,ke,be,4),a.a6.mat4.identity(ke),a.a6.mat4.rotateY(ke,ke,Math.PI),ka(J,ee,we,ke,be,5),ue.viewport.set([0,0,J.width,J.height])}(b,m),m.markSkyboxValid(b)):b.renderPass==="sky"&&function(J,ee,ae,le,ue){const ve=J.context,ye=ve.gl,be=J.transform,we=J.getOrCreateProgram("skybox");ve.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_CUBE_MAP,ee.skyboxTexture);const ke=((Ne,De,$e,je,et)=>({u_matrix:Ne,u_sun_direction:De,u_cubemap:0,u_opacity:je,u_temporal_offset:et}))(be.skyboxMatrix,ee.getCenter(J,!1),0,le,ue);J.uploadCommonUniforms(ve,we),we.draw(J,ye.TRIANGLES,ae,pr.disabled,J.colorModeForRenderPass(),_r.backCW,ke,"skybox",ee.skyboxGeometry.vertexBuffer,ee.skyboxGeometry.indexBuffer,ee.skyboxGeometry.segment)}(b,m,W,I,q):F==="gradient"&&b.renderPass==="sky"&&function(J,ee,ae,le,ue){const ve=J.context,ye=ve.gl,be=J.transform,we=J.getOrCreateProgram("skyboxGradient");ee.skyboxGeometry||(ee.skyboxGeometry=new Ba(ve)),ve.activeTexture.set(ye.TEXTURE0);let ke=ee.colorRampTexture;ke||(ke=ee.colorRampTexture=new a.T(ve,ee.colorRamp,ye.RGBA8)),ke.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const Ne=((De,$e,je,et,Ke)=>({u_matrix:De,u_color_ramp:0,u_center_direction:$e,u_radius:a.bB(je),u_opacity:et,u_temporal_offset:Ke}))(be.skyboxMatrix,ee.getCenter(J,!1),ee.paint.get("sky-gradient-radius"),le,ue);J.uploadCommonUniforms(ve,we),we.draw(J,ye.TRIANGLES,ae,pr.disabled,J.colorModeForRenderPass(),_r.backCW,Ne,"skyboxGradient",ee.skyboxGeometry.vertexBuffer,ee.skyboxGeometry.indexBuffer,ee.skyboxGeometry.segment)}(b,m,W,I,q)},debug:function(b,u,m,w,I,P){for(let F=0;F<m.length;F++)if(I){const J=new a.bz(w.r*.8,w.g*.8,w.b*.8,1);cc(b,u,m[F],w,-1,-1,P),cc(b,u,m[F],w,-1,1,P),cc(b,u,m[F],w,1,1,P),cc(b,u,m[F],w,1,-1,P),cc(b,u,m[F],J,0,0,P)}else cc(b,u,m[F],w,0,0,P)},custom:function(b,u,m,w){const I=b.context,P=m.implementation;if(!b.transform.projection.unsupportedLayers||!b.transform.projection.unsupportedLayers.includes("custom")||b.terrain&&(b.terrain.renderingToTexture||b.renderPass==="offscreen")&&m.isDraped(u)){if(b.renderPass==="offscreen"){const F=P.prerender;if(F){if(b.setCustomLayerDefaults(),I.setColorMode(b.colorModeForRenderPass()),b.transform.projection.name==="globe"){const W=b.transform.pointMerc;F.call(P,I.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),a.a9(b.transform.zoom),[W.x,W.y],b.transform.pixelsPerMeterRatio)}else F.call(P,I.gl,b.transform.customLayerMatrix());I.setDirty(),b.setBaseState()}}else if(b.renderPass==="translucent"){if(b.terrain&&b.terrain.renderingToTexture){const W=P.renderToTile;if(W){const q=w[0].canonical,J=new a.a5(q.x+w[0].wrap*(1<<q.z),q.y,q.z);I.setDepthMode(Xn.disabled),I.setStencilMode(pr.disabled),I.setColorMode(b.colorModeForRenderPass()),b.setCustomLayerDefaults(),W.call(P,I.gl,J),I.setDirty(),b.setBaseState()}return}b.setCustomLayerDefaults(),I.setColorMode(b.colorModeForRenderPass()),I.setStencilMode(pr.disabled);const F=P.renderingMode==="3d"?new Xn(b.context.gl.LEQUAL,Xn.ReadWrite,b.depthRangeFor3D):b.depthModeForSublayer(0,Xn.ReadOnly);if(I.setDepthMode(F),b.transform.projection.name==="globe"){const W=b.transform.pointMerc;P.render(I.gl,b.transform.customLayerMatrix(),b.transform.getProjection(),b.transform.globeToMercatorMatrix(),a.a9(b.transform.zoom),[W.x,W.y],b.transform.pixelsPerMeterRatio)}else P.render(I.gl,b.transform.customLayerMatrix());I.setDirty(),b.setBaseState(),I.bindFramebuffer.set(null)}}else a.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(b,u,m,w){if(b.renderPass==="opaque")return;const I=m.paint.get("model-opacity");if(I===0)return;const P=m.paint.get("model-cast-shadows");if(b.renderPass==="shadow"&&(!P||b.terrain&&I<.65&&m._transitionablePaint._values["model-opacity"].value.expression instanceof a.a4))return;const F=b.shadowRenderer,W=m.paint.get("model-receive-shadows");F&&(F.useNormalOffset=!0,W||(F.enabled=!1));const q=()=>{F&&(F.useNormalOffset=!0,W||(F.enabled=!0))},J=u.getSource();if(b.renderPass==="light-beam"&&J.type!=="batched-model")return;if(J.type==="vector"||J.type==="geojson")return function(we,ke,Ne,De,$e){const je=we.transform;if(je.projection.name!=="mercator")return void a.w(`Drawing 3D models for ${je.projection.name} projection is not yet implemented`);const et=je.getFreeCameraOptions().position;if(!we.modelManager)return;const Ke=we.modelManager;Ne.modelManager=Ke;const tt=we.shadowRenderer;if(!Ne._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const ut=Ne._unevaluatedLayout._values["model-id"],at={...Ne.layout.get("model-id").parameters},rt=we.style.order.indexOf(Ne.fqid);for(const bt of De){const Ft=ke.getTile(bt).getBucket(Ne);if(!Ft||Ft.projection.name!==je.projection.name)continue;const Zt=Ft.getModelUris();Zt&&!Ft.modelsRequested&&(Ke.addModelsFromBucket(Zt,$e),Ft.modelsRequested=!0);const kt=o_(bt,je);at.zoom=kt;const hn=ut.possiblyEvaluate(at);if(mf(we,Ft,bt),Qo.shadowUniformsInitialized=!1,Qo.useSingleShadowCascade=!!tt&&tt.getMaxCascadeForTile(bt.toUnwrapped())===0,we.renderPass==="shadow"&&tt){if(we.currentShadowCascade===1&&Ft.isInsideFirstShadowMapFrustum)continue;const Gt=je.calculatePosMatrix(bt.toUnwrapped(),je.worldSize);if(Qo.tileMatrix.set(Gt),Qo.shadowTileMatrix=Float32Array.from(tt.calculateShadowPassMatrixFromMatrix(Gt)),Qo.aabb.min.fill(0),Qo.aabb.max[0]=Qo.aabb.max[1]=a.ab,Qo.aabb.max[2]=0,Pl(Ft,Qo,we,Ne.scope))continue}const wt=1<<bt.canonical.z,Wt=[((et.x-bt.wrap)*wt-bt.canonical.x)*a.ab,(et.y*wt-bt.canonical.y)*a.ab,et.z*wt*a.ab];we.conflationActive&&Object.keys(Ft.instancesPerModel).length>0&&we.style.isLayerClipped(Ne,ke.getSource())&&Ft.updateReplacement(bt,we.replacementSource,rt,$e)&&(Ft.uploaded=!1,Ft.upload(we.context));for(let Gt in Ft.instancesPerModel){const fn=Ft.instancesPerModel[Gt];fn.features.length>0&&(Gt=hn.evaluate(fn.features[0].feature,{}));const pn=Ke.getModel(Gt,$e);if(pn&&pn.uploaded)for(const qt of pn.nodes)js(we,Ne,qt,fn,Wt,bt,Qo)}}}(b,u,m,w,J.type==="vector"?m.scope:""),void q();if(!J.loaded())return;if(J.type==="batched-model")return function(we,ke,Ne,De){Ne.resetLayerRenderingStats(we);const $e=we.context,je=we.transform,et=we.style.fog,Ke=we.shadowRenderer;if(je.projection.name!=="mercator")return void a.w(`Drawing 3D landmark models for ${je.projection.name} projection is not yet implemented`);const tt=we.transform.getFreeCameraOptions().position,ut=a.a6.vec3.scale([],[tt.x,tt.y,tt.z],we.transform.worldSize),at=a.a6.vec3.negate([],ut),rt=a.a6.mat4.identity([]),bt=a.de(je.center.lat,je.zoom),Ft=a.a6.mat4.fromScaling([],[1,1,1/bt]);a.a6.mat4.translate(rt,rt,at);const Zt=Ne.paint.get("model-opacity"),kt=new Xn($e.gl.LEQUAL,Xn.ReadWrite,we.depthRangeFor3D),hn=new Xn($e.gl.LEQUAL,Xn.ReadOnly,we.depthRangeFor3D),wt=new a.c9([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),Wt=we.renderPass==="shadow",Gt=Wt&&Ke?Ke.getCurrentCascadeFrustum():je.getFrustum(je.scaleZoom(je.worldSize)),fn=Ne.paint.get("model-front-cutoff"),pn=fn[2]<1,qt=ic(we,Ne.paint.get("model-cutoff-fade-range")),en=Ne.getLayerRenderingStats();(function(er,xn,Dn,yr){const qn=er.terrain?er.terrain.exaggeration():0,ur=er.transform.zoom;for(const Ur of yr){const Br=xn.getTile(Ur).getBucket(Dn);Br&&(er.conflationActive&&Br.updateReplacement(Ur,er.replacementSource),Br.evaluateScale(er,Dn),er.terrain&&qn>0&&Br.elevationUpdate(er.terrain,qn,Ur,Dn.source),Br.needsReEvaluation(er,ur,Dn)&&Br.evaluate(Dn))}})(we,ke,Ne,De),function(){let er,xn,Dn;pn?(er=De.length-1,xn=-1,Dn=-1):(er=0,xn=De.length,Dn=1);const yr=new Float64Array(16),qn=a.a6.vec3.create(),ur=new a.P(0,0);for(let Ur=er;Ur!==xn;Ur+=Dn){const Br=De[Ur],Ci=ke.getTile(Br).getBucket(Ne);if(!Ci||!Ci.uploaded)continue;let Ui=!1;Ke&&(Ui=Ke.getMaxCascadeForTile(Br.toUnwrapped())===0);const is=je.calculatePosMatrix(Br.toUnwrapped(),je.worldSize),Xc=Ci.modelTraits;!Wt&&pn&&(a.a6.mat4.invert(yr,is),a.a6.vec3.transformMat4(qn,ut,yr),ur.x=qn[0],ur.y=qn[1]);const ea=[];for(const Yr of Ci.getNodesInfo()){if(Yr.hiddenByReplacement||!Yr.node.meshes)continue;const Ni=Yr.node;let Ss=0;we.terrain&&Ni.elevation&&(Ss=Ni.elevation*we.terrain.exaggeration());const Di=(()=>{const Ki=Yr.aabb;return wt.min=[...Ki.min],wt.max=[...Ki.max],wt.min[2]+=Ss,wt.max[2]+=Ss,a.a6.vec3.transformMat4(wt.min,wt.min,is),a.a6.vec3.transformMat4(wt.max,wt.max,is),wt})(),kr=Yr.evaluatedScale;if(kr[0]<=1&&kr[1]<=1&&kr[2]<=1&&Di.intersects(Gt)===0)continue;if(!Wt&&pn){const Ki=.16666666666666666;Yr.cameraCollisionOpacity=ut[0]>Di.min[0]&&ut[0]<Di.max[0]&&ut[1]>Di.min[1]&&ut[1]<Di.max[1]&&ut[2]*bt<Di.max[2]&&Ni.footprint&&a.bu(ur,Ni.footprint)?Math.max(Yr.cameraCollisionOpacity-Ki,0):Math.min(1,Yr.cameraCollisionOpacity+Ki)}const pi=[...is],Ti=Ni.anchor?Ni.anchor[0]:0,zs=Ni.anchor?Ni.anchor[1]:0;a.a6.mat4.translate(pi,pi,[Ti*(kr[0]-1),zs*(kr[1]-1),Ss]),a.a6.vec3.exactEquals(kr,a.dh)||a.a6.mat4.scale(pi,pi,kr);const ta=a.a6.mat4.multiply([],pi,Ni.matrix),ai=a.a6.mat4.multiply([],je.expandedFarZProjMatrix,ta),Fa=a.a6.mat4.multiply([],je.expandedFarZProjMatrix,pi),Ka=a.a6.vec4.transformMat4([],[Ti,zs,Ss,1],ai)[2];Ni.hidden=!1;let Na=Zt;Wt||(pn&&(Na*=Yr.cameraCollisionOpacity,Na*=Qr(pi,je,Yr.aabb,fn)),Na*=Fi(qt,Ka)),Na!==0?ea.push({nodeInfo:Yr,depth:Ka,opacity:Na,wvpForNode:ai,wvpForTile:Fa,nodeModelMatrix:ta,tileModelMatrix:pi}):Ni.hidden=!0}Wt||ea.sort((Yr,Ni)=>!pn||Yr.opacity===1&&Ni.opacity===1?Yr.depth<Ni.depth?-1:1:Yr.opacity===1?-1:Ni.opacity===1?1:Yr.depth>Ni.depth?-1:1);for(const Yr of ea){const Ni=Yr.nodeInfo,Ss=Ni.node;let Di=a.a6.mat4.multiply([],Ft,Yr.tileModelMatrix);a.a6.mat4.multiply(Di,rt,Di);const kr=a.a6.mat4.invert([],Di);a.a6.mat4.transpose(kr,kr),a.a6.mat4.scale(kr,kr,Gg),Di=a.a6.mat4.multiply(Di,Di,Ss.matrix);const pi=we.renderPass==="light-beam",Ti=Xc&a.dj.HasMapboxMeshFeatures,zs=Ti?0:Ni.evaluatedRMEA[0][2];for(let ta=0;ta<Ss.meshes.length;++ta){const ai=Ss.meshes[ta],Fa=ta===Ss.lightMeshIndex;let Ka=Yr.wvpForNode;if(Fa){if(!pi&&!we.terrain&&we.shadowRenderer){we.currentLayer<we.firstLightBeamLayer&&(we.firstLightBeamLayer=we.currentLayer);continue}Ka=Yr.wvpForTile}else if(pi)continue;const Na={defines:[]},Ki=[];if(nh(Na.defines,Ki,ai,we,Ne.lut),Ti||Na.defines.push("DIFFUSE_SHADED"),Ui&&Na.defines.push("SHADOWS_SINGLE_CASCADE"),en&&(Wt?en.numRenderedVerticesInShadowPass+=ai.vertexArray.length:en.numRenderedVerticesInTransparentPass+=ai.vertexArray.length),Wt){rh(ai,Yr.nodeModelMatrix,we,Ne);continue}let ml=null;if(et){const yf=Ld(Yr.nodeModelMatrix,we.transform);if(ml=new Float32Array(yf),je.projection.name!=="globe"){const zd=ai.aabb.min,ah=ai.aabb.max,[Yg,Kg]=et.getOpacityForBounds(yf,zd[0],zd[1],ah[0],ah[1]);Na.overrideFog=Yg>=Mn||Kg>=Mn}}const gl=ai.material;let qc;gl.occlusionTexture&&gl.occlusionTexture.offsetScale&&(qc=gl.occlusionTexture.offsetScale,Na.defines.push("OCCLUSION_TEXTURE_TRANSFORM")),!Wt&&Ke&&(Ke.useNormalOffset=!!ai.normalBuffer);const mc=we.getOrCreateProgram("model",Na);!Wt&&Ke&&Ke.setupShadowsFromMatrix(Yr.tileModelMatrix,mc,Ke.useNormalOffset),we.uploadCommonUniforms($e,mc,null,ml);const Dl=gl.pbrMetallicRoughness;Dl.metallicFactor=.9,Dl.roughnessFactor=.5;const Zc=Fn(new Float32Array(Ka),new Float32Array(Di),new Float32Array(kr),new Float32Array(Ss.matrix),we,Yr.opacity,Dl.baseColorFactor.toRenderColor(null),gl.emissiveFactor,Dl.metallicFactor,Dl.roughnessFactor,gl,zs,Ne,[0,0,0],qc);!Fa&&(Ni.hasTranslucentParts||Yr.opacity<1)&&mc.draw(we,$e.gl.TRIANGLES,kt,pr.disabled,Mr.disabled,_r.backCCW,Zc,Ne.id,ai.vertexBuffer,ai.indexBuffer,ai.segments,Ne.paint,we.transform.zoom,void 0,Ki),mc.draw(we,$e.gl.TRIANGLES,Fa?hn:kt,pr.disabled,Fa||Yr.opacity<1||Ni.hasTranslucentParts?Mr.alphaBlended:Mr.unblended,_r.backCCW,Zc,Ne.id,ai.vertexBuffer,ai.indexBuffer,ai.segments,Ne.paint,we.transform.zoom,void 0,Ki)}}}}()}(b,u,m,w),void q();if(J.type!=="model")return;const ee=J.getModels(),ae=[],le=b.transform.getFreeCameraOptions().position,ue=a.a6.vec3.scale([],[le.x,le.y,le.z],b.transform.worldSize);a.a6.vec3.negate(ue,ue);const ve=[],ye=[];let be=0;for(const we of ee){const ke=m.paint.get("model-rotation").constantOr(null),Ne=m.paint.get("model-scale").constantOr(null),De=m.paint.get("model-translation").constantOr(null);we.computeModelMatrix(b,ke,Ne,De,!0,!0,!1);const $e=a.a6.mat4.identity([]),je=a.de(we.position.lat,b.transform.zoom),et=a.a6.mat4.fromScaling([],[1,1,1/je]);a.a6.mat4.translate($e,$e,ue),ae.push({zScaleMatrix:et,negCameraPosMatrix:$e});for(const Ke of we.nodes)pf(b.transform,Ke,we.matrix,b.transform.expandedFarZProjMatrix,be,ve,ye);be++}if(ve.sort((we,ke)=>ke.depth-we.depth),b.renderPass!=="shadow"){if(I===1)for(const we of ye)Ya(we,b,m,ae[we.modelIndex],pr.disabled,b.colorModeForRenderPass());else{for(const we of ye)Ya(we,b,m,ae[we.modelIndex],pr.disabled,Mr.disabled);for(const we of ye)Ya(we,b,m,ae[we.modelIndex],b.stencilModeFor3D(),b.colorModeForRenderPass());b.resetStencilClippingMasks()}for(const we of ve)Ya(we,b,m,ae[we.modelIndex],pr.disabled,b.colorModeForRenderPass());q()}else{for(const we of ye)rh(we.mesh,we.nodeModelMatrix,b,m);for(const we of ve)rh(we.mesh,we.nodeModelMatrix,b,m);q()}}},fc={model:function(b,u,m){const w=u.getSource();if(!w.loaded())return;if(w.type==="vector"||w.type==="geojson")return void(m.modelManager&&m.modelManager.upload(m,w.type==="vector"?b.scope:""));if(w.type==="batched-model"||w.type!=="model")return;const I=w.getModels();for(const P of I)P.upload(m.context)},raster:function(b,u,m){const w=u.getSource();if(!(w instanceof Cr&&w.loaded()))return;const I=b.sourceLayer||w.rasterLayerIds&&w.rasterLayerIds[0];if(!I)return;const P=b.paint.get("raster-array-band")||w.getInitialBand(I);if(P==null)return;const F=u.getIds().map(W=>u.getTileByID(W));for(const W of F)W.updateNeeded(I,P)&&w.prepareTile(W,I,P)},"raster-particle":function(b,u,m){const w=u.getSource();if(!(w instanceof Cr&&w.loaded()))return;const I=b.sourceLayer||w.rasterLayerIds&&w.rasterLayerIds[0];if(!I)return;const P=b.paint.get("raster-particle-array-band")||w.getInitialBand(I);if(P==null)return;const F=u.getIds().map(W=>u.getTileByID(W));for(const W of F)W.updateNeeded(I,P)&&w.prepareTile(W,I,P)}};class el{constructor(u,m,w,I){this.context=new Qp(u,m),this.transform=w,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=I,this._timeStamp=a.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const P=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const W of P)this._debugParams.enabledLayers[W]=!0;I.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),I.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),I.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),I.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),I.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const W of P)I.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],W);this.occlusionParams=new gf(I),this.setup(),this.numSublayers=Xa.maxUnderzooming+Xa.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new a.dl,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new dg(this),this._wireframeDebugCache=new hc,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const F=new a.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new a.T(this.context,F,u.RGBA8),this._clippingActiveLastFrame=!1}updateTerrain(u,m){const w=!!u&&!!u.terrain&&this.transform.projection.supportsTerrain;if(!(w||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new af(this,u));const I=this._terrain;this.transform.elevation=w?I:null,I.update(u,this.transform,m),this.transform.elevation&&!I.enabled&&(this.transform.elevation=null)}_updateFog(u){const m=u.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[w,I]=m.getFovAdjustedRange(this.transform._fov);if(w>I)return void(this.transform.fogCullDistSq=null);const P=w+.78*(I-w);this.transform.fogCullDistSq=P*P}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(u){u&&!this._terrain&&(this._terrain=new af(this,this.style)),this._forceTerrainMode=u}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(u,m){if(this.width=u*a.q.devicePixelRatio,this.height=m*a.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const w of this.style.order)this.style._mergedLayers[w].resize()}setup(){const u=this.context,m=new a.a_;m.emplaceBack(0,0),m.emplaceBack(a.ab,0),m.emplaceBack(0,a.ab),m.emplaceBack(a.ab,a.ab),this.tileExtentBuffer=u.createVertexBuffer(m,a.b0.members),this.tileExtentSegments=a.b1.simpleSegment(0,0,4,2);const w=new a.a_;w.emplaceBack(0,0),w.emplaceBack(a.ab,0),w.emplaceBack(0,a.ab),w.emplaceBack(a.ab,a.ab),this.debugBuffer=u.createVertexBuffer(w,a.b0.members),this.debugSegments=a.b1.simpleSegment(0,0,4,5);const I=new a.a_;I.emplaceBack(-1,-1),I.emplaceBack(1,-1),I.emplaceBack(-1,1),I.emplaceBack(1,1),this.viewportBuffer=u.createVertexBuffer(I,a.b0.members),this.viewportSegments=a.b1.simpleSegment(0,0,4,2);const P=new a.aN;P.emplaceBack(0,0,0,0),P.emplaceBack(a.ab,0,a.ab,0),P.emplaceBack(0,a.ab,0,a.ab),P.emplaceBack(a.ab,a.ab,a.ab,a.ab),this.mercatorBoundsBuffer=u.createVertexBuffer(P,a.b3.members),this.mercatorBoundsSegments=a.b1.simpleSegment(0,0,4,2);const F=new a.aO;F.emplaceBack(0,1,2),F.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=u.createIndexBuffer(F);const W=new a.a$;for(const J of[0,1,3,2,0])W.emplaceBack(J);this.debugIndexBuffer=u.createIndexBuffer(W),this.emptyTexture=new a.T(u,new a.r({width:1,height:1},Uint8Array.of(0,0,0,0)),u.gl.RGBA8),this.identityMat=a.a6.mat4.create();const q=this.context.gl;this.stencilClearMode=new pr({func:q.ALWAYS,mask:0},0,255,q.ZERO,q.ZERO,q.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(u){return u._makeTileBoundsBuffers(this.context,this.transform.projection),u._tileBoundsBuffer?{tileBoundsBuffer:u._tileBoundsBuffer,tileBoundsIndexBuffer:u._tileBoundsIndexBuffer,tileBoundsSegments:u._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const u=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,u.TRIANGLES,Xn.disabled,this.stencilClearMode,Mr.disabled,_r.disabled,wu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(u,m,w){if(!m||this.currentStencilSource===m.id||!u.isTileClipped()||!w||w.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let W=!1;for(const q of w)if(this._tileClippingMaskIDs[q.key]===void 0){W=!0;break}if(!W)return}this.currentStencilSource=m.id;const I=this.context,P=I.gl;this.nextStencilID+w.length>256&&this.clearStencil(),I.setColorMode(Mr.disabled),I.setDepthMode(Xn.disabled);const F=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const W of w){const q=m.getTile(W),J=this._tileClippingMaskIDs[W.key]=this.nextStencilID++,{tileBoundsBuffer:ee,tileBoundsIndexBuffer:ae,tileBoundsSegments:le}=this.getTileBoundsBuffers(q);F.draw(this,P.TRIANGLES,Xn.disabled,new pr({func:P.ALWAYS,mask:0},J,255,P.KEEP,P.KEEP,P.REPLACE),Mr.disabled,_r.disabled,wu(W.projMatrix),"$clipping",ee,ae,le)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const u=this.nextStencilID++,m=this.context.gl;return new pr({func:m.NOTEQUAL,mask:255},u,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(u){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(u);const m=this.context.gl;return new pr({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[u.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(u){const m=this.context.gl,w=u.sort((F,W)=>W.overscaledZ-F.overscaledZ),I=w[w.length-1].overscaledZ,P=w[0].overscaledZ-I+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();const F={};for(let W=0;W<P;W++)F[W+I]=new pr({func:m.GEQUAL,mask:255},W+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=P,[F,w]}return[{[I]:pr.disabled},w]}colorModeForRenderPass(){const u=this.context.gl;return this._showOverdrawInspector?new Mr([u.CONSTANT_COLOR,u.ONE,u.CONSTANT_COLOR,u.ONE],new a.bz(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Mr.unblended:Mr.alphaBlended}colorModeForDrapableLayerRenderPass(u){const m=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new Mr([m.ONE,m.ONE_MINUS_SRC_ALPHA,m.CONSTANT_ALPHA,m.ONE_MINUS_SRC_ALPHA],new a.bz(0,0,0,u===void 0?0:u),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(u,m,w,I=!1){if(this.depthOcclusion)return new Xn(this.context.gl.GREATER,Xn.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!I)return Xn.disabled;const P=1-((1+this.currentLayer)*this.numSublayers+u)*this.depthEpsilon;return new Xn(w||this.context.gl.LEQUAL,m,[P,P])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const u=this.context.gl,m=Math.ceil(this.width),w=Math.ceil(this.height),I=this.context.bindFramebuffer.get(),P=u.getParameter(u.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===m&&this.depthFBO.height===w||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),m!==0&&w!==0&&(this.depthFBO=new Hc(this.context,m,w,!1,"texture"),this.depthTexture=new a.T(this.context,{width:m,height:w,data:null},u.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(I),u.bindTexture(u.TEXTURE_2D,P),this.depthFBO&&(u.bindFramebuffer(u.READ_FRAMEBUFFER,null),u.bindFramebuffer(u.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),u.blitFramebuffer(0,0,m,w,0,0,m,w,u.DEPTH_BUFFER_BIT,u.NEAREST),u.bindFramebuffer(u.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((u,m)=>u+m/this._fpsHistory.length,0))}render(u,m){const w=a.q.now();this._dt=w-this._timeStamp,this._timeStamp=w,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=u.map.repaint,this.style=u,this.options=m;const I=this.style._mergedLayers,P=this.style.order.filter(at=>{const rt=I[at];return!(rt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[rt.type]});let F=!1,W=!1;for(const at of P){const rt=I[at];rt.type==="circle"&&(F=!0),rt.type==="symbol"&&(rt.hasInitialOcclusionOpacityProperties?W=!0:F=!0)}const q=P.map(at=>I[at]),J=this.style._mergedSourceCaches;this.imageManager=u.imageManager,this.modelManager=u.modelManager,this.symbolFadeChange=u.placement.symbolFadeChange(a.q.now()),this.imageManager.beginFrame();let ee=0,ae=!1;for(const at in J){const rt=J[at];rt.used&&(rt.prepare(this.context),rt.getSource().usedInConflation&&++ee)}let le=!1;for(const at of q)at.isHidden(this.transform.zoom)||(at.type==="clip"&&(le=!0),this.prepareLayer(at));const ue={},ve={},ye={},be={},we={};for(const at in J){const rt=J[at];ue[at]=rt.getVisibleCoordinates(),ve[at]=ue[at].slice().reverse(),ye[at]=rt.getVisibleCoordinates(!0).reverse(),be[at]=rt.getShadowCasterCoordinates(),we[at]=rt.sortCoordinatesByDistance(ue[at])}const ke=at=>{const rt=this.style.getLayerSourceCache(at);return rt&&rt.used?rt.getSource():null};if(ee||le||this._clippingActiveLastFrame){const at=[],rt=[];let bt=0;for(const Ft of q)this.isSourceForClippingOrConflation(Ft,ke(Ft))&&(at.push(Ft),rt.push(bt)),bt++;if(at&&(le||at.length>1)||this._clippingActiveLastFrame){le=!1;const Ft=[];for(let Zt=0;Zt<at.length;Zt++){const kt=at[Zt],hn=rt[Zt],wt=this.style.getLayerSourceCache(kt);if(!wt||!wt.used||!wt.getSource().usedInConflation&&kt.type!=="clip")continue;let Wt=a.dn,Gt=a.bs.None;const fn=[];let pn=!0;if(kt.type==="clip"){Wt=hn;for(const qt of kt.layout.get("clip-layer-types"))Gt|=qt==="model"?a.bs.Model:qt==="symbol"?a.bs.Symbol:a.bs.FillExtrusion;for(const qt of kt.layout.get("clip-layer-scope"))fn.push(qt);kt.isHidden(this.transform.zoom)?pn=!1:le=!0}pn&&Ft.push({layer:kt.fqid,cache:wt,order:Wt,clipMask:Gt,clipScope:fn})}this.replacementSource.setSources(Ft),ae=!0}}this._clippingActiveLastFrame=le,ae||this.replacementSource.clear(),this.conflationActive=ae,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let at=0;at<q.length;at++){const rt=q[at],bt=rt.cutoffRange();if(this.longestCutoffRange=Math.max(bt,this.longestCutoffRange),bt>0){const Ft=ke(rt);Ft&&(this.minCutoffZoom=Math.max(Ft.minzoom,this.minCutoffZoom)),rt.minzoom&&(this.minCutoffZoom=Math.max(rt.minzoom,this.minCutoffZoom))}rt.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=at),this._lastOcclusionLayer=at)}const Ne=this.style&&this.style.fog;Ne?(this._fogVisible=Ne.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ne.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ye),this.opaquePassCutoff=0);const De=this._shadowRenderer;if(De){De.updateShadowParameters(this.transform,this.style.directionalLight);for(const at in J)for(const rt of ue[at]){let bt={min:0,max:0};this.terrain&&(bt=this.terrain.getMinMaxForTile(rt)||bt),De.addShadowReceiver(rt.toUnwrapped(),bt.min,bt.max)}}if(this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.dm(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new df(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!qe.has(this.context.gl))return;this.renderPass="offscreen";for(const at of q){const rt=u.getLayerSourceCache(at);if(!at.hasOffscreenPass()||at.isHidden(this.transform.zoom))continue;const bt=rt?ve[rt.id]:void 0;(at.type==="custom"||at.type==="raster"||at.type==="raster-particle"||at.isSky()||bt&&bt.length)&&this.renderLayer(this,rt,at,bt)}this.depthRangeFor3D=[0,1-(q.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,be)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const $e=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),je=(()=>{if(m.showOverdrawInspector)return a.bz.black;const at=this.style.fog;if(at&&this.transform.projection.supportsFog){const rt=this.style.getLut(at.scope);if(!$e){const bt=at.properties.get("color").toRenderColor(rt).toArray01();return new a.bz(...bt)}if($e){const bt=at.properties.get("space-color").toRenderColor(rt).toArray01();return new a.bz(...bt)}}return a.bz.transparent})();if(this.context.clear({color:je,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$e&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=P.length-1;this.currentLayer>=0;this.currentLayer--){const at=q[this.currentLayer],rt=u.getLayerSourceCache(at);if(at.isSky())continue;const bt=rt?(at.is3D()?we:ve)[rt.id]:void 0;this._renderTileClippingMasks(at,rt,bt),this.renderLayer(this,rt,at,bt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&$e&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||a.a9(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<P.length;this.currentLayer++){const at=q[this.currentLayer],rt=u.getLayerSourceCache(at);at.isSky()&&this.renderLayer(this,rt,at,rt?ve[rt.id]:void 0)}function et(at,rt){let bt;return rt&&(bt=(at.type==="symbol"?ye:at.is3D()?we:ve)[rt.id]),bt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<P.length;){const at=q[this.currentLayer];if(at.type==="raster"||at.type==="raster-particle"){const rt=u.getLayerSourceCache(at);this.renderLayer(this,rt,at,et(at,rt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Ke=0;De&&(Ke=De.getShadowCastingLayerCount());let tt=!1,ut=-1;for(let at=0;at<P.length;++at){const rt=q[at];rt.isHidden(this.transform.zoom)||rt.is3D()&&(ut=at)}for(W&&ut===-1&&(F=!0);this.currentLayer<P.length;){const at=q[this.currentLayer],rt=u.getLayerSourceCache(at);if(at.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(at)){if(at.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(F&&!tt&&this.terrain&&!this.transform.isOrthographic&&(tt=!0,this.blitDepth()),W&&ut!==-1&&this.currentLayer===ut+1&&!this.transform.isOrthographic&&this.blitDepth(),at.is3D()||this.terrain||this._renderTileClippingMasks(at,rt,rt?ue[rt.id]:void 0),this.renderLayer(this,rt,at,et(at,rt)),!this.terrain&&De&&Ke>0&&at.hasShadowPass()&&--Ke==0&&(De.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const bt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=bt;this.currentLayer++){const Ft=q[this.currentLayer];if(!Ft.hasLightBeamPass())continue;const Zt=u.getLayerSourceCache(Ft);this.renderLayer(this,Zt,Ft,Zt?ve[Zt.id]:void 0)}this.currentLayer=bt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const bt=this.currentLayer;this.depthOcclusion=!0;for(const Ft of this.layersWithOcclusionOpacity){this.currentLayer=Ft;const Zt=q[this.currentLayer],kt=u.getLayerSourceCache(Zt),hn=kt?ve[kt.id]:void 0;Zt.is3D()||this.terrain||this._renderTileClippingMasks(Zt,kt,kt?ue[kt.id]:void 0),this.renderLayer(this,kt,Zt,hn)}this.depthOcclusion=!1,this.currentLayer=bt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let at=null;q.forEach(rt=>{const bt=u.getLayerSourceCache(rt);bt&&!rt.isHidden(this.transform.zoom)&&bt.getVisibleCoordinates().length&&(!at||at.getSource().maxzoom<bt.getSource().maxzoom)&&(at=bt)}),at&&this.options.showTileBoundaries&&Qs.debug(this,at,at.getVisibleCoordinates(),a.bz.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Qs.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new a.bz(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(at){const rt=at.transform.padding;Wi(at,at.transform.height-(rt.top||0),3,a_),Wi(at,rt.bottom||0,3,eh),At(at,rt.left||0,3,th),At(at,at.transform.width-(rt.right||0),3,gn);const bt=at.transform.centerPoint;(function(Ft,Zt,kt,hn){ks(Ft,Zt-1,kt-10,2,20,hn),ks(Ft,Zt-10,kt-1,20,2,hn)})(at,bt.x,at.transform.height-bt.y,Kn)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),ae||(this.conflationActive=!1)}prepareLayer(u){this.gpuTimingStart(u);const{unsupportedLayers:m}=this.transform.projection,w=!m||!m.includes(u.type);if(fc[u.type]&&(w||this.terrain&&u.type==="custom")){const I=this.style.getLayerSourceCache(u);fc[u.type](u,I,this)}this.gpuTimingEnd()}renderLayer(u,m,w,I){w.isHidden(this.transform.zoom)||(w.type==="background"||w.type==="sky"||w.type==="custom"||w.type==="model"||w.type==="raster"||w.type==="raster-particle"||I&&I.length)&&(this.id=w.id,this.gpuTimingStart(w),u.transform.projection.unsupportedLayers&&u.transform.projection.unsupportedLayers.includes(w.type)&&(!u.terrain||w.type!=="custom")||w.type==="clip"||Qs[w.type](u,m,w,I,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(u){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery,w=this.context.gl;let I=this.gpuTimers[u.id];I||(I=this.gpuTimers[u.id]={calls:0,cpuTime:0,query:w.createQuery()}),I.calls++,w.beginQuery(m.TIME_ELAPSED_EXT,I.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const u=this.context.extTimerQuery,m=this.context.gl,w=m.createQuery();this.deferredRenderGpuTimeQueries.push(w),m.beginQuery(u.TIME_ELAPSED_EXT,w)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const u=this.gpuTimers;return this.gpuTimers={},u}collectDeferredRenderGpuQueries(){const u=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],u}queryGpuTimers(u){const m={};for(const w in u){const I=u[w],P=this.context.extTimerQuery,F=P.getQueryParameter(I.query,this.context.gl.QUERY_RESULT)/1e6;P.deleteQueryEXT(I.query),m[w]=F}return m}queryGpuTimeDeferredRender(u){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery,w=this.context.gl;let I=0;for(const P of u)I+=m.getQueryParameter(P,w.QUERY_RESULT)/1e6,m.deleteQueryEXT(P);return I}translatePosMatrix(u,m,w,I,P){if(!w[0]&&!w[1])return u;const F=P?I==="map"?this.transform.angle:0:I==="viewport"?-this.transform.angle:0;if(F){const J=Math.sin(F),ee=Math.cos(F);w=[w[0]*ee-w[1]*J,w[0]*J+w[1]*ee]}const W=[P?w[0]:a.ak(m,w[0],this.transform.zoom),P?w[1]:a.ak(m,w[1],this.transform.zoom),0],q=new Float32Array(16);return a.a6.mat4.translate(q,u,W),q}saveTileTexture(u){const m=u.size[0],w=this._tileTextures[m];w?w.push(u):this._tileTextures[m]=[u]}getTileTexture(u){const m=this._tileTextures[u];return m&&m.length>0?m.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(u,m,w){const I=w===void 0?this.terrain&&this.terrain.renderingToTexture:w,P=[];return this.style&&this.style.enable3dLights()&&(u==="globeRaster"||u==="terrainRaster"?(P.push("LIGHTING_3D_MODE"),P.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):I||P.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||P.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?P.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):P.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(P.push("TERRAIN"),this.linearFloatFilteringSupported()&&P.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&P.push("GLOBE"),!this._fogVisible||I||m!==void 0&&!m||P.push("FOG","FOG_DITHERING"),I&&P.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&P.push("OVERDRAW_INSPECTOR"),P}getOrCreateProgram(u,m){this.cache=this.cache||{};const w=m&&m.defines||[],I=m&&m.config,P=this.currentGlobalDefines(u,m&&m.overrideFog,m&&m.overrideRtt).concat(w),F=ba.cacheKey(Yu[u],u,P,I);return this.cache[F]||(this.cache[F]=new ba(this.context,u,Yu[u],I,Jp[u],P)),this.cache[F]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const u=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(u.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(u,m){if(this.style.enable3dLights()){const w=this.style.directionalLight,I=this.style.ambientLight;if(w&&I){const P=((F,W,q)=>{const J=F.properties.get("direction"),ee=F.properties.get("color").toRenderColor(q.getLut(F.scope)).toArray01(),ae=F.properties.get("intensity"),le=W.properties.get("color").toRenderColor(q.getLut(W.scope)).toArray01(),ue=W.properties.get("intensity"),ve=[J.x,J.y,J.z],ye=a.cH(le,ue),be=a.cH(ee,ae);return{u_lighting_ambient_color:ye,u_lighting_directional_dir:ve,u_lighting_directional_color:be,u_ground_radiance:Za(ve,be,ye)}})(w,I,this.style);m.setLightsUniformValues(u,P)}}}uploadCommonUniforms(u,m,w,I,P){if(this.uploadCommonLightUniforms(u,m),this.terrain&&this.terrain.renderingToTexture)return;const F=this.style.fog;if(F){const W=F.getOpacity(this.transform.pitch),q=((J,ee,ae,le,ue,ve,ye,be,we,ke,Ne,De)=>{const $e=J.transform,je=ee.properties.get("color").toRenderColor(J.style.getLut(ee.scope)).toArray01();je[3]=le;const et=J.frameCounter/1e3%1,[Ke,tt]=ee.properties.get("vertical-range");return{u_fog_matrix:ae?$e.calculateFogTileMatrix(ae):De||J.identityMat,u_fog_range:ee.getFovAdjustedRange($e._fov),u_fog_color:je,u_fog_horizon_blend:ee.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ke,tt),tt],u_fog_temporal_offset:et,u_frustum_tl:ue,u_frustum_tr:ve,u_frustum_br:ye,u_frustum_bl:be,u_globe_pos:we,u_globe_radius:ke,u_viewport:Ne,u_globe_transition:a.a9($e.zoom),u_is_globe:+($e.projection.name==="globe")}})(this,F,w,W,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.q.devicePixelRatio,this.transform.height*a.q.devicePixelRatio],I);m.setFogUniformValues(u,q)}P&&m.setCutoffUniformValues(u,P.uniformValues)}setTileLoadedFlag(u){this.tileLoaded=u}saveCanvasCopy(){const u=this.canvasCopy();u&&(this.frameCopies.push(u),this.tileLoaded=!1)}canvasCopy(){const u=this.context.gl,m=u.createTexture();return u.bindTexture(u.TEXTURE_2D,m),u.copyTexImage2D(u.TEXTURE_2D,0,u.RGBA,0,0,u.drawingBufferWidth,u.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const u=this.style&&this.style.fog;return!!u&&u.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const u=this._backgroundTiles,m=this._backgroundTiles={},w=this.transform.coveringTiles({tileSize:512});for(const I of w)m[I.key]=u[I.key]||new Fc(I,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(u,m){return!(!u.is3D()||u.type!=="clip"&&(u.minzoom&&u.minzoom>this.transform.zoom||(this.style._clipLayerPresent||u.sourceLayer!=="building")&&(!m||m.type!=="batched-model")))}isTileAffectedByFog(u){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let m=this._cachedTileFogOpacities[u.key];return m||(this._cachedTileFogOpacities[u.key]=m=this.style.fog.getOpacityForTile(u)),m[0]>=Mn||m[1]>=Mn}setupDepthForOcclusion(u,m,w){const I=this.context,P=I.gl,F=!!w;var W;w||(w={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),I.activeTexture.set(P.TEXTURE3),u&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),w.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],w.u_depth_range_unpack=[2/((W=this.depthRangeFor3D)[1]-W[0]),-1-2*W[0]/(W[1]-W[0])],w.u_occluder_half_size=.5*this.occlusionParams.occluderSize,w.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(P.NEAREST,P.CLAMP_TO_EDGE),I.activeTexture.set(P.TEXTURE0),F||m.setTerrainUniformValues(I,w)}}function Ll(b,u){let m=!1,w=null;const I=()=>{w=null,m&&(b(),w=setTimeout(I,u),m=!1)};return()=>(m=!0,w||I(),w)}class ua{constructor(u){this._hashName=u&&encodeURIComponent(u),a.aJ(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ll(this._updateHashUnthrottled.bind(this),300)}addTo(u){return this._map=u,window.addEventListener("hashchange",this._onHashChange,!1),u.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const u=this._map;if(!u)return"";const m=jc(u);if(this._hashName){const w=this._hashName;let I=!1;const P=location.hash.slice(1).split("&").map(F=>{const W=F.split("=")[0];return W===w?(I=!0,`${W}=${m}`):F}).filter(F=>F);return I||P.push(`${w}=${m}`),`#${P.join("&")}`}return`#${m}`}_getCurrentHash(){const u=location.hash.replace("#","");if(this._hashName){let m;return u.split("&").map(w=>w.split("=")).forEach(w=>{w[0]===this._hashName&&(m=w)}),(m&&m[1]||"").split("/")}return u.split("/")}_onHashChange(){const u=this._map;if(!u)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(w=>isNaN(w))){const w=u.dragRotate.isEnabled()&&u.touchZoomRotate.isEnabled()?+(m[3]||0):u.getBearing();return u.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:w,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function jc(b,u){const m=b.getCenter(),w=Math.round(100*b.getZoom())/100,I=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,I),F=Math.round(m.lng*P)/P,W=Math.round(m.lat*P)/P,q=b.getBearing(),J=b.getPitch();let ee=u?`/${F}/${W}/${w}`:`${w}/${W}/${F}`;return(q||J)&&(ee+="/"+Math.round(10*q)/10),J&&(ee+=`/${Math.round(J)}`),ee}const Au={linearity:.3,easing:a.dp(0,0,.3,1)},Dd=a.l({deceleration:2500,maxSpeed:1400},Au),l_=a.l({deceleration:20,maxSpeed:1400},Au),Wc=a.l({deceleration:1e3,maxSpeed:360},Au),Hg=a.l({deceleration:1e3,maxSpeed:90},Au);class Tu{constructor(u){this._map=u,this.clear()}clear(){this._inertiaBuffer=[]}record(u){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.q.now(),settings:u})}_drainInertiaBuffer(){const u=this._inertiaBuffer,m=a.q.now();for(;u.length>0&&m-u[0].time>160;)u.shift()}_onMoveEnd(u){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new a.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:P}of this._inertiaBuffer)m.zoom+=P.zoomDelta||0,m.bearing+=P.bearingDelta||0,m.pitch+=P.pitchDelta||0,P.panDelta&&m.pan._add(P.panDelta),P.around&&(m.around=P.around),P.pinchAround&&(m.pinchAround=P.pinchAround);const w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,I={};if(m.pan.mag()){const P=pl(m.pan.mag(),w,a.l({},Dd,u||{}));I.offset=m.pan.mult(P.amount/m.pan.mag()),I.center=this._map.transform.center,ih(I,P)}if(m.zoom){const P=pl(m.zoom,w,l_);I.zoom=this._map.transform.zoom+P.amount,ih(I,P)}if(m.bearing){const P=pl(m.bearing,w,Wc);I.bearing=this._map.transform.bearing+a.ap(P.amount,-179,179),ih(I,P)}if(m.pitch){const P=pl(m.pitch,w,Hg);I.pitch=this._map.transform.pitch+P.amount,ih(I,P)}if(I.zoom||I.bearing){const P=m.pinchAround===void 0?m.around:m.pinchAround;I.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),I.noMoveStart=!0,I}}function ih(b,u){(!b.duration||b.duration<u.duration)&&(b.duration=u.duration,b.easing=u.easing)}function pl(b,u,m){const{maxSpeed:w,linearity:I,deceleration:P}=m,F=a.ap(b*I/(u/1e3),-w,w),W=Math.abs(F)/(P*I);return{easing:m.easing,duration:1e3*W,amount:F*(W/2)}}class bo extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,m,w,I={}){const P=ie(m.getCanvasContainer(),w),F=m.unproject(P);super(u,a.l({point:P,lngLat:F,originalEvent:w},I)),this._defaultPrevented=!1,this.target=m}}class vf extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,m,w){const I=u==="touchend"?w.changedTouches:w.touches,P=oe(m.getCanvasContainer(),I),F=P.map(q=>m.unproject(q)),W=P.reduce((q,J,ee,ae)=>q.add(J.div(ae.length)),new a.P(0,0));super(u,{points:P,point:W,lngLats:F,lngLat:m.unproject(W),originalEvent:w}),this._defaultPrevented=!1}}class wa extends a.x{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(u,m){super("wheel",{originalEvent:m}),this._defaultPrevented=!1}}class Bd{constructor(u,m){this._map=u,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(u){return this._firePreventable(new wa(this._map,u))}mousedown(u,m){return this._mousedownPos=m,this._firePreventable(new bo(u.type,this._map,u))}mouseup(u){this._map.fire(new bo(u.type,this._map,u))}preclick(u){const m=a.l({},u);m.type="preclick",this._map.fire(new bo(m.type,this._map,m))}click(u,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(u),this._map.fire(new bo(u.type,this._map,u)))}dblclick(u){return this._firePreventable(new bo(u.type,this._map,u))}mouseover(u){this._map.fire(new bo(u.type,this._map,u))}mouseout(u){this._map.fire(new bo(u.type,this._map,u))}touchstart(u){return this._firePreventable(new vf(u.type,this._map,u))}touchmove(u){this._map.fire(new vf(u.type,this._map,u))}touchend(u){this._map.fire(new vf(u.type,this._map,u))}touchcancel(u){this._map.fire(new vf(u.type,this._map,u))}_firePreventable(u){if(this._map.fire(u),u.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class c_{constructor(u){this._map=u}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(u){this._map.fire(new bo(u.type,this._map,u))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new bo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(u){this._delayContextMenu?this._contextMenuEvent=u:this._map.fire(new bo(u.type,this._map,u)),this._map.listens("contextmenu")&&u.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kd{constructor(u,m){this._map=u,this._el=u.getCanvasContainer(),this._container=u.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(u,m){this.isEnabled()&&u.shiftKey&&u.button===0&&(X(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(u,m){if(!this._active)return;const w=m,I=this._startPos,P=this._lastPos;if(!I||!P||P.equals(w)||!this._box&&w.dist(I)<this._clickTolerance)return;this._lastPos=w,this._box||(this._box=M("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",u));const F=Math.min(I.x,w.x),W=Math.max(I.x,w.x),q=Math.min(I.y,w.y),J=Math.max(I.y,w.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${F}px,${q}px)`,this._box.style.width=W-F+"px",this._box.style.height=J-q+"px")})}mouseupWindow(u,m){if(!this._active)return;const w=this._startPos,I=m;if(w&&u.button===0){if(this.reset(),re(),w.x!==I.x||w.y!==I.y)return this._map.fire(new a.x("boxzoomend",{originalEvent:u})),{cameraAnimation:P=>P.fitScreenCoordinates(w,I,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",u)}}keydown(u){this._active&&u.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",u))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z(),delete this._startPos,delete this._lastPos}_fireEvent(u,m){return this._map.fire(new a.x(u,{originalEvent:m}))}}function $c(b,u){const m={};for(let w=0;w<b.length;w++)m[b[w].identifier]=u[w];return m}class jg{constructor(u){this.reset(),this.numTouches=u.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(u,m,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=u.timeStamp),w.length===this.numTouches&&(this.centroid=function(I){const P=new a.P(0,0);for(const F of I)P._add(F);return P.div(I.length)}(m),this.touches=$c(w,m)))}touchmove(u,m,w){if(this.aborted||!this.centroid)return;const I=$c(w,m);for(const P in this.touches){const F=I[P];(!F||F.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(u,m,w){if((!this.centroid||u.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){const I=!this.aborted&&this.centroid;if(this.reset(),I)return I}}}class dc{constructor(u){this.singleTap=new jg(u),this.numTaps=u.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(u,m,w){this.singleTap.touchstart(u,m,w)}touchmove(u,m,w){this.singleTap.touchmove(u,m,w)}touchend(u,m,w){const I=this.singleTap.touchend(u,m,w);if(I){const P=u.timeStamp-this.lastTime<500,F=!this.lastTap||this.lastTap.dist(I)<30;if(P&&F||this.reset(),this.count++,this.lastTime=u.timeStamp,this.lastTap=I,this.count===this.numTaps)return this.reset(),I}}}class u_{constructor(){this._zoomIn=new dc({numTouches:1,numTaps:2}),this._zoomOut=new dc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(u,m,w){this._zoomIn.touchstart(u,m,w),this._zoomOut.touchstart(u,m,w)}touchmove(u,m,w){this._zoomIn.touchmove(u,m,w),this._zoomOut.touchmove(u,m,w)}touchend(u,m,w){const I=this._zoomIn.touchend(u,m,w),P=this._zoomOut.touchend(u,m,w);return I?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()+1,around:F.unproject(I)},{originalEvent:u})}):P?(this._active=!0,u.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:F=>F.easeTo({duration:300,zoom:F.getZoom()-1,around:F.unproject(P)},{originalEvent:u})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const pc={0:1,2:2};class Od{constructor(u){this.reset(),this._clickTolerance=u.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(u,m){return!1}_move(u,m){return{}}mousedown(u,m){if(this._lastPoint)return;const w=fe(u);this._correctButton(u,w)&&(this._lastPoint=m,this._eventButton=w)}mousemoveWindow(u,m){const w=this._lastPoint;if(w){if(u.preventDefault(),this._eventButton!=null&&function(I,P){const F=pc[P];return I.buttons===void 0||(I.buttons&F)!==F}(u,this._eventButton))this.reset();else if(this._moved||!(m.dist(w)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(w,m)}}mouseupWindow(u){this._lastPoint&&fe(u)===this._eventButton&&(this._moved&&re(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class co extends Od{mousedown(u,m){super.mousedown(u,m),this._lastPoint&&(this._active=!0)}_correctButton(u,m){return m===0&&!u.ctrlKey}_move(u,m){return{around:m,panDelta:m.sub(u)}}}class Wg extends Od{_correctButton(u,m){return m===0&&u.ctrlKey||m===2}_move(u,m){const w=.8*(m.x-u.x);if(w)return this._active=!0,{bearingDelta:w}}contextmenu(u){u.preventDefault()}}class im extends Od{_correctButton(u,m){return m===0&&u.ctrlKey||m===2}_move(u,m){const w=-.5*(m.y-u.y);if(w)return this._active=!0,{pitchDelta:w}}contextmenu(u){u.preventDefault()}}class Gx{constructor(u,m){this._map=u,this._el=u.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),a.aJ(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.P(0,0)}touchstart(u,m,w){return this._calculateTransform(u,m,w)}touchmove(u,m,w){if(this._active&&!(w.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(w.length===1&&!a.dq())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return u.cancelable&&u.preventDefault(),this._calculateTransform(u,m,w)}}touchend(u,m,w){this._calculateTransform(u,m,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(u,m,w){w.length>0&&(this._active=!0);const I=$c(w,m),P=new a.P(0,0),F=new a.P(0,0);let W=0;for(const J in I){const ee=I[J],ae=this._touches[J];ae&&(P._add(ee),F._add(ee.sub(ae)),W++,I[J]=ee)}if(this._touches=I,W<this._minTouches||!F.mag())return;const q=F.div(W);return this._sum._add(q),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(W),panDelta:q}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class $g{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(u){}_move(u,m,w){return{}}touchstart(u,m,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([m[0],m[1]]))}touchmove(u,m,w){const I=this._firstTwoTouches;if(!I)return;u.preventDefault();const[P,F]=I,W=Fd(w,m,P),q=Fd(w,m,F);if(!W||!q)return;const J=this._aroundCenter?null:W.add(q).div(2);return this._move([W,q],J,u)}touchend(u,m,w){if(!this._firstTwoTouches)return;const[I,P]=this._firstTwoTouches,F=Fd(w,m,I),W=Fd(w,m,P);F&&W||(this._active&&re(),this.reset())}touchcancel(){this.reset()}enable(u){this._enabled=!0,this._aroundCenter=!!u&&u.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Fd(b,u,m){for(let w=0;w<b.length;w++)if(b[w].identifier===m)return u[w]}function Xg(b,u){return Math.log(b/u)/Math.LN2}class Vx extends $g{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(u){this._startDistance=this._distance=u[0].dist(u[1])}_move(u,m){const w=this._distance;if(this._distance=u[0].dist(u[1]),this._active||!(Math.abs(Xg(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xg(this._distance,w),pinchAround:m}}}function tl(b,u){return 180*b.angleWith(u)/Math.PI}class qg extends $g{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(u){this._startVector=this._vector=u[0].sub(u[1]),this._minDiameter=u[0].dist(u[1])}_move(u,m){const w=this._vector;if(this._vector=u[0].sub(u[1]),w&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:tl(this._vector,w),pinchAround:m}}_isBelowThreshold(u){this._minDiameter=Math.min(this._minDiameter,u.mag());const m=25/(Math.PI*this._minDiameter)*360,w=this._startVector;if(!w)return!1;const I=tl(u,w);return Math.abs(I)<m}}function Zg(b){return Math.abs(b.y)>Math.abs(b.x)}class Mu extends $g{constructor(u){super(),this._map=u}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(u){this._lastPoints=u,Zg(u[0].sub(u[1]))&&(this._valid=!1)}_move(u,m,w){const I=this._lastPoints;if(!I)return;const P=u[0].sub(I[0]),F=u[1].sub(I[1]);return this._map._cooperativeGestures&&!a.dq()&&w.touches.length<3||(this._valid=this.gestureBeginsVertically(P,F,w.timeStamp),!this._valid)?void 0:(this._lastPoints=u,this._active=!0,{pitchDelta:(P.y+F.y)/2*-.5})}gestureBeginsVertically(u,m,w){if(this._valid!==void 0)return this._valid;const I=u.mag()>=2,P=m.mag()>=2;if(!I&&!P)return;if(!I||!P)return this._firstMove==null&&(this._firstMove=w),w-this._firstMove<100&&void 0;const F=u.y>0==m.y>0;return Zg(u)&&Zg(m)&&F}}const sm={panStep:100,bearingStep:15,pitchStep:10};class sh{constructor(){const u=sm;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(u){if(u.altKey||u.ctrlKey||u.metaKey)return;let m=0,w=0,I=0,P=0,F=0;switch(u.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:u.shiftKey?w=-1:(u.preventDefault(),P=-1);break;case 39:u.shiftKey?w=1:(u.preventDefault(),P=1);break;case 38:u.shiftKey?I=1:(u.preventDefault(),F=-1);break;case 40:u.shiftKey?I=-1:(u.preventDefault(),F=1);break;default:return}return this._rotationDisabled&&(w=0,I=0),{cameraAnimation:W=>{const q=W.getZoom();W.easeTo({duration:300,easeId:"keyboardHandler",easing:am,zoom:m?Math.round(q)+m*(u.shiftKey?2:1):q,bearing:W.getBearing()+w*this._bearingStep,pitch:W.getPitch()+I*this._pitchStep,offset:[-P*this._panStep,-F*this._panStep],center:W.getCenter()},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function am(b){return b*(2-b)}const om=4.000244140625,h_=1/450;class Hw{constructor(u,m){this._map=u,this._el=u.getCanvasContainer(),this._handler=m,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=h_,a.aJ(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(u){this._defaultZoomRate=u}setWheelZoomRate(u){this._wheelZoomRate=u}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(u){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!u&&u.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(u){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(u.ctrlKey||u.metaKey||this.isZooming()||a.dq()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=u.deltaMode===WheelEvent.DOM_DELTA_LINE?40*u.deltaY:u.deltaY;const w=a.q.now(),I=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,m!==0&&m%om==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":I>400?(this._type=null,this._lastValue=m,this._timeout=window.setTimeout(this._onTimeout,40,u)):this._type||(this._type=Math.abs(I*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),u.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=u,this._delta-=m,this._active||this._start(u)),u.preventDefault()}_onTimeout(u){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)}_start(u){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=ie(this._el,u);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const u=this._map.transform;this._type==="wheel"&&u.projection.wrap&&(u._center.lng>=180||u._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>u._terrainEnabled()&&this._aroundCoord?u.computeZoomRelativeTo(this._aroundCoord):u.zoom;if(this._delta!==0){const J=this._type==="wheel"&&Math.abs(this._delta)>om?this._wheelZoomRate:this._defaultZoomRate;let ee=2/(1+Math.exp(-Math.abs(this._delta*J)));this._delta<0&&ee!==0&&(ee=1/ee);const ae=m(),le=Math.pow(2,ae),ue=typeof this._targetZoom=="number"?u.zoomScale(this._targetZoom):le;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(ue*ee))),this._type==="wheel"&&(this._startZoom=ae,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const w=typeof this._targetZoom=="number"?this._targetZoom:m(),I=this._startZoom,P=this._easing;let F,W=!1;if(this._type==="wheel"&&I&&P){const J=Math.min((a.q.now()-this._lastWheelEventTime)/200,1),ee=P(J);F=a.aa(I,w,ee),J<1?this._frameId||(this._frameId=!0):W=!0}else F=w,W=!0;this._active=!0,W&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let q=F-m();return q*this._lastDelta<0&&(q=0),{noInertia:!0,needsRenderFrame:!W,zoomDelta:q,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(u){let m=a.dr;if(this._prevEase){const w=this._prevEase,I=(a.q.now()-w.start)/w.duration,P=w.easing(I+.01)-w.easing(I),F=.27/Math.sqrt(P*P+1e-4)*.01,W=Math.sqrt(.0729-F*F);m=a.dp(F,W,.25,1)}return this._prevEase={start:a.q.now(),duration:u,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=M("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ws{constructor(u,m){this._clickZoom=u,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class f_{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(u,m){return u.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:w.getZoom()+(u.shiftKey?-1:1),around:w.unproject(m)},{originalEvent:u})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hx{constructor(){this._tap=new dc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(u,m,w){this._swipePoint||(this._tapTime&&u.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?w.length>0&&(this._swipePoint=m[0],this._swipeTouch=w[0].identifier):this._tap.touchstart(u,m,w))}touchmove(u,m,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;const I=m[0],P=I.y-this._swipePoint.y;return this._swipePoint=I,u.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(u,m,w)}touchend(u,m,w){this._tapTime?this._swipePoint&&w.length===0&&this.reset():this._tap.touchend(u,m,w)&&(this._tapTime=u.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jx{constructor(u,m,w){this._el=u,this._mousePan=m,this._touchPan=w}enable(u){this._inertiaOptions=u||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _f{constructor(u,m,w){this._pitchWithRotate=u.pitchWithRotate,this._mouseRotate=m,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Wx{constructor(u,m,w,I){this._el=u,this._touchZoom=m,this._touchRotate=w,this._tapDragZoom=I,this._rotationDisabled=!1,this._enabled=!0}enable(u){this._touchZoom.enable(u),this._rotationDisabled||this._touchRotate.enable(u),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Nd=b=>b.zoom||b.drag||b.pitch||b.rotate;class D extends a.x{}class O{constructor(){this.constants=[1,1,.01],this.radius=0}setup(u,m){const w=a.a6.vec3.sub([],m,u);this.radius=a.a6.vec3.length(w[2]<0?a.a6.vec3.div([],w,this.constants):[w[0],w[1],0])}projectRay(u){a.a6.vec3.div(u,u,this.constants),a.a6.vec3.normalize(u,u),a.a6.vec3.mul(u,u,this.constants);const m=a.a6.vec3.scale([],u,this.radius);if(m[2]>0){const w=a.a6.vec3.scale([],[0,0,1],a.a6.vec3.dot(m,[0,0,1])),I=a.a6.vec3.scale([],a.a6.vec3.normalize([],[m[0],m[1],0]),this.radius),P=a.a6.vec3.add([],m,a.a6.vec3.scale([],a.a6.vec3.sub([],a.a6.vec3.add([],I,w),m),2));m[0]=P[0],m[1]=P[1]}return m}}function Y(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta}class se{constructor(u,m){this._map=u,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Tu(u),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new O,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),a.aJ(["handleEvent","handleWindowEvent"],this);const w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(const[I,P,F]of this._listeners){const W=I===document?this.handleWindowEvent:this.handleEvent;I.addEventListener(P,W,F)}}destroy(){for(const[u,m,w]of this._listeners){const I=u===document?this.handleWindowEvent:this.handleEvent;u.removeEventListener(m,I,w)}}_addDefaultHandlers(u){const m=this._map,w=m.getCanvasContainer();this._add("mapEvent",new Bd(m,u));const I=m.boxZoom=new kd(m,u);this._add("boxZoom",I);const P=new u_,F=new f_;m.doubleClickZoom=new ws(F,P),this._add("tapZoom",P),this._add("clickZoom",F);const W=new Hx;this._add("tapDragZoom",W);const q=m.touchPitch=new Mu(m);this._add("touchPitch",q);const J=new Wg(u),ee=new im(u);m.dragRotate=new _f(u,J,ee),this._add("mouseRotate",J,["mousePitch"]),this._add("mousePitch",ee,["mouseRotate"]);const ae=new co(u),le=new Gx(m,u);m.dragPan=new jx(w,ae,le),this._add("mousePan",ae),this._add("touchPan",le,["touchZoom","touchRotate"]);const ue=new qg,ve=new Vx;m.touchZoomRotate=new Wx(w,ve,ue,W),this._add("touchRotate",ue,["touchPan","touchZoom"]),this._add("touchZoom",ve,["touchPan","touchRotate"]),this._add("blockableMapEvent",new c_(m));const ye=m.scrollZoom=new Hw(m,this);this._add("scrollZoom",ye,["mousePan"]);const be=m.keyboard=new sh;this._add("keyboard",be);for(const we of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])u.interactive&&u[we]&&m[we].enable(u[we])}_add(u,m,w){this._handlers.push({handlerName:u,handler:m,allowed:w}),this._handlersById[u]=m}stop(u){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},u),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:u}of this._handlers)if(u.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Nd(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(u,m,w){for(const I in u)if(I!==w&&(!m||m.indexOf(I)<0))return!0;return!1}handleWindowEvent(u){this.handleEvent(u,`${u.type}Window`)}_getMapTouches(u){const m=[];for(const w of u)this._el.contains(w.target)&&m.push(w);return m}handleEvent(u,m){this._updatingCamera=!0;const w=u.type==="renderFrame",I=w?void 0:u,P={needsRenderFrame:!1},F={},W={},q=u.touches?this._getMapTouches(u.touches):void 0,J=q?oe(this._el,q):w?void 0:ie(this._el,u);for(const{handlerName:le,handler:ue,allowed:ve}of this._handlers){if(!ue.isEnabled())continue;let ye;this._blockedByActive(W,ve,le)?ue.reset():ue[m||u.type]&&(ye=ue[m||u.type](u,J,q),this.mergeHandlerResult(P,F,ye,le,I),ye&&ye.needsRenderFrame&&this._triggerRenderFrame()),(ye||ue.isActive())&&(W[le]=ue)}const ee={};for(const le in this._previousActiveHandlers)W[le]||(ee[le]=I);this._previousActiveHandlers=W,(Object.keys(ee).length||Y(P))&&(this._changes.push([P,F,ee]),this._triggerRenderFrame()),(Object.keys(W).length||Y(P))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ae}=P;ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ae(this._map))}mergeHandlerResult(u,m,w,I,P){if(!w)return;a.l(u,w);const F={handlerName:I,originalEvent:w.originalEvent||P};w.zoomDelta!==void 0&&(m.zoom=F),w.panDelta!==void 0&&(m.drag=F),w.pitchDelta!==void 0&&(m.pitch=F),w.bearingDelta!==void 0&&(m.rotate=F)}_applyChanges(){const u={},m={},w={};for(const[I,P,F]of this._changes)I.panDelta&&(u.panDelta=(u.panDelta||new a.P(0,0))._add(I.panDelta)),I.zoomDelta&&(u.zoomDelta=(u.zoomDelta||0)+I.zoomDelta),I.bearingDelta&&(u.bearingDelta=(u.bearingDelta||0)+I.bearingDelta),I.pitchDelta&&(u.pitchDelta=(u.pitchDelta||0)+I.pitchDelta),I.around!==void 0&&(u.around=I.around),I.aroundCoord!==void 0&&(u.aroundCoord=I.aroundCoord),I.pinchAround!==void 0&&(u.pinchAround=I.pinchAround),I.noInertia&&(u.noInertia=I.noInertia),a.l(m,P),a.l(w,F);this._updateMapTransform(u,m,w),this._changes=[]}_updateMapTransform(u,m,w){const I=this._map,P=I.transform,F=ke=>[ke.x,ke.y,ke.z];if((ke=>{const Ne=this._eventsInProgress.drag;return Ne&&!this._handlersById[Ne.handlerName].isActive()})()&&!Y(u)){const ke=P.zoom;P.cameraElevationReference="sea",this._originalZoom!=null&&P._orthographicProjectionAtLowPitch&&P.projection.name!=="globe"&&P.pitch===0?(P.cameraElevationReference="ground",P.zoom=this._originalZoom):(P.recenterOnTerrain(),P.cameraElevationReference="ground"),ke!==P.zoom&&this._map._update(!0)}if(P._isCameraConstrained&&I._stop(!0),!Y(u))return void this._fireEvents(m,w,!0);let{panDelta:W,zoomDelta:q,bearingDelta:J,pitchDelta:ee,around:ae,aroundCoord:le,pinchAround:ue}=u;P._isCameraConstrained&&(q>0&&(q=0),P._isCameraConstrained=!1),ue!==void 0&&(ae=ue),(q||(ke=>m[ke]&&!this._eventsInProgress[ke])("drag"))&&ae&&(this._dragOrigin=F(P.pointCoordinate3D(ae)),this._originalZoom=P.zoom,this._trackingEllipsoid.setup(P._camera.position,this._dragOrigin)),P.cameraElevationReference="sea",I._stop(!0),ae=ae||I.transform.centerPoint,J&&(P.bearing+=J),ee&&(P.pitch+=ee),P._updateCameraState();const ve=[0,0,0];if(W)if(P.projection.name==="mercator"){const ke=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(ae).dir),Ne=this._trackingEllipsoid.projectRay(P.screenPointToMercatorRay(ae.sub(W)).dir);ve[0]=Ne[0]-ke[0],ve[1]=Ne[1]-ke[1]}else{const ke=P.pointCoordinate(ae);if(P.projection.name==="globe"){W=W.rotate(-P.angle);const Ne=P._pixelsPerMercatorPixel/P.worldSize;ve[0]=-W.x*a.ds(a.aM(ke.y))*Ne,ve[1]=-W.y*a.ds(P.center.lat)*Ne}else{const Ne=P.pointCoordinate(ae.sub(W));ke&&Ne&&(ve[0]=Ne.x-ke.x,ve[1]=Ne.y-ke.y)}}const ye=P.zoom,be=[0,0,0];if(q){const ke=F(le||P.pointCoordinate3D(ae)),Ne={dir:a.a6.vec3.normalize([],a.a6.vec3.sub([],ke,P._camera.position))};if(Ne.dir[2]<0){const De=P.zoomDeltaToMovement(ke,q);a.a6.vec3.scale(be,Ne.dir,De)}}const we=a.a6.vec3.add(ve,ve,be);P._translateCameraConstrained(we),q&&Math.abs(P.zoom-ye)>1e-4&&P.recenterOnTerrain(),P.cameraElevationReference="ground",this._map._update(),u.noInertia||this._inertia.record(u),this._fireEvents(m,w,!0)}_fireEvents(u,m,w){const I=Nd(this._eventsInProgress),P=Nd(u),F={};for(const ee in u){const{originalEvent:ae}=u[ee];this._eventsInProgress[ee]||(F[`${ee}start`]=ae),this._eventsInProgress[ee]=u[ee]}!I&&P&&this._fireEvent("movestart",P.originalEvent);for(const ee in F)this._fireEvent(ee,F[ee]);P&&this._fireEvent("move",P.originalEvent);for(const ee in u){const{originalEvent:ae}=u[ee];this._fireEvent(ee,ae)}const W={};let q;for(const ee in this._eventsInProgress){const{handlerName:ae,originalEvent:le}=this._eventsInProgress[ee];this._handlersById[ae].isActive()||(delete this._eventsInProgress[ee],q=m[ae]||le,W[`${ee}end`]=q)}for(const ee in W)this._fireEvent(ee,W[ee]);const J=Nd(this._eventsInProgress);if(w&&(I||P)&&!J){this._updatingCamera=!0;const ee=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ae=le=>le!==0&&-this._bearingSnap<le&&le<this._bearingSnap;ee?(ae(ee.bearing||this._map.getBearing())&&(ee.bearing=0),this._map.easeTo(ee,{originalEvent:q})):(this._map.fire(new a.x("moveend",{originalEvent:q})),ae(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(u,m){this._map.fire(new a.x(u,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(u=>{this._frameId=void 0,this.handleEvent(new D("renderFrame",{timeStamp:u})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const pe="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Te extends a.E{constructor(u,m){super(),this._moving=!1,this._zooming=!1,this.transform=u,this._bearingSnap=m.bearingSnap,this._respectPrefersReducedMotion=m.respectPrefersReducedMotion!==!1,a.aJ(["_renderFrameCallback"],this)}getCenter(){return new a.bK(this.transform.center.lng,this.transform.center.lat)}setCenter(u,m){return this.jumpTo({center:u},m)}panBy(u,m,w){return u=a.P.convert(u).mult(-1),this.panTo(this.transform.center,a.l({offset:u},m),w)}panTo(u,m,w){return this.easeTo(a.l({center:u},m),w)}getZoom(){return this.transform.zoom}setZoom(u,m){return this.jumpTo({zoom:u},m),this}zoomTo(u,m,w){return this.easeTo(a.l({zoom:u},m),w)}zoomIn(u,m){return this.zoomTo(this.getZoom()+1,u,m),this}zoomOut(u,m){return this.zoomTo(this.getZoom()-1,u,m),this}getBearing(){return this.transform.bearing}setBearing(u,m){return this.jumpTo({bearing:u},m),this}getPadding(){return this.transform.padding}setPadding(u,m){return this.jumpTo({padding:u},m),this}rotateTo(u,m,w){return this.easeTo(a.l({bearing:u},m),w)}resetNorth(u,m){return this.rotateTo(0,a.l({duration:1e3},u),m),this}resetNorthPitch(u,m){return this.easeTo(a.l({bearing:0,pitch:0,duration:1e3},u),m),this}snapToNorth(u,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(u,m):this}getPitch(){return this.transform.pitch}setPitch(u,m){return this.jumpTo({pitch:u},m),this}cameraForBounds(u,m){u=a.as.convert(u);const w=m&&m.bearing||0,I=m&&m.pitch||0,P=u.getNorthWest(),F=u.getSouthEast();return this._cameraForBounds(this.transform,P,F,w,I,m)}_extendPadding(u){const m={top:0,right:0,bottom:0,left:0};return u==null?a.l({},m,this.transform.padding):typeof u=="number"?{top:u,bottom:u,right:u,left:u}:a.l({},m,u)}_extendCameraOptions(u){return(u=a.l({offset:[0,0],maxZoom:this.transform.maxZoom},u)).padding=this._extendPadding(u.padding),u}_minimumAABBFrustumDistance(u,m){const w=m.max[0]-m.min[0],I=m.max[1]-m.min[1];return w/I>u.aspect?w/(2*Math.tan(.5*u.fovX)*u.aspect):I/(2*Math.tan(.5*u.fovY)*u.aspect)}_cameraForBoundsOnGlobe(u,m,w,I,P,F){const W=u.clone(),q=this._extendCameraOptions(F);W.bearing=I,W.pitch=P;const J=a.bK.convert(m),ee=a.bK.convert(w),ae=.5*(J.lat+ee.lat),le=.5*(J.lng+ee.lng),ue=a.dt(ae,le),ve=a.a6.vec3.normalize([],ue),ye=a.a6.vec3.normalize([],a.a6.vec3.cross([],ve,[0,1,0])),be=a.a6.vec3.cross([],ye,ve),we=[ye[0],ye[1],ye[2],0,be[0],be[1],be[2],0,ve[0],ve[1],ve[2],0,0,0,0,1],ke=[ue,a.dt(J.lat,J.lng),a.dt(ee.lat,J.lng),a.dt(ee.lat,ee.lng),a.dt(J.lat,ee.lng),a.dt(ae,J.lng),a.dt(ae,ee.lng),a.dt(J.lat,le),a.dt(ee.lat,le)];let Ne=a.c9.fromPoints(ke.map(Gt=>[a.a6.vec3.dot(ye,Gt),a.a6.vec3.dot(be,Gt),a.a6.vec3.dot(ve,Gt)]));const De=a.a6.vec3.transformMat4([],Ne.center,we);a.a6.vec3.squaredLength(De)===0&&a.a6.vec3.set(De,0,0,1),a.a6.vec3.normalize(De,De),a.a6.vec3.scale(De,De,a.aq),W.center=a.du(De);const $e=W.getWorldToCameraMatrix(),je=a.a6.mat4.invert(new Float64Array(16),$e);Ne=a.c9.applyTransform(Ne,a.a6.mat4.multiply([],$e,we));const et=this._extendAABB(Ne,W,q,I);if(!et)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ne=et,a.a6.vec3.transformMat4(De,De,$e);const Ke=.5*(Ne.max[2]-Ne.min[2]),tt=this._minimumAABBFrustumDistance(W,Ne),ut=a.a6.vec3.scale([],[0,0,1],Ke),at=a.a6.vec3.add(ut,De,ut),rt=tt+(W.pitch===0?0:a.a6.vec3.distance(De,at)),bt=W.globeCenterInViewSpace,Ft=a.a6.vec3.sub([],De,[bt[0],bt[1],bt[2]]);a.a6.vec3.normalize(Ft,Ft),a.a6.vec3.scale(Ft,Ft,rt);const Zt=a.a6.vec3.add([],De,Ft);a.a6.vec3.transformMat4(Zt,Zt,je);const kt=a.dw/a.aq,hn=a.a6.vec3.length(Zt),wt=a.bD(Math.max(hn*kt-a.dw,Number.EPSILON),0),Wt=Math.min(W.zoomFromMercatorZAdjusted(wt),q.maxZoom);return Wt>.5*(a.c2+a.bU)?(W.setProjection({name:"mercator"}),W.zoom=Wt,this._cameraForBounds(W,m,w,I,P,F)):{center:W.center,zoom:Wt,bearing:I,pitch:P}}_extendAABB(u,m,w,I){const P=.5*((w.padding.left||0)+(w.padding.right||0)),F=.5*((w.padding.top||0)+(w.padding.bottom||0)),W=F,q=P,J=P,ee=F,ae=m.width-(q+J),le=m.height-(W+ee),ue=a.a6.vec3.sub([],u.max,u.min),ve=Math.min(ae/ue[0],le/ue[1]),ye=Math.min(m.scaleZoom(m.scale*ve),w.maxZoom);if(isNaN(ye))return null;const be=m.scale/m.zoomScale(ye),we=new a.c9([u.min[0]-q*be,u.min[1]-ee*be,u.min[2]],[u.max[0]+J*be,u.max[1]+W*be,u.max[2]]),ke=(typeof w.offset.x=="number"&&typeof w.offset.y=="number"?new a.P(w.offset.x,w.offset.y):a.P.convert(w.offset)).rotate(-a.bB(I));return we.center[0]-=ke.x*be,we.center[1]+=ke.y*be,we}queryTerrainElevation(u,m){const w=this.transform.elevation;return w?(m=a.l({},{exaggerated:!0},m),w.getAtPoint(a.a5.fromLngLat(u),null,m.exaggerated)):null}_cameraForBounds(u,m,w,I,P,F){if(u.projection.name==="globe")return this._cameraForBoundsOnGlobe(u,m,w,I,P,F);const W=u.clone(),q=this._extendCameraOptions(F);W.bearing=I,W.pitch=P;const J=a.bK.convert(m),ee=a.bK.convert(w),ae=new a.bK(J.lng,ee.lat),le=new a.bK(ee.lng,J.lat),ue=W.project(J),ve=W.project(ee),ye=this.queryTerrainElevation(J),be=this.queryTerrainElevation(ee),we=this.queryTerrainElevation(ae),ke=this.queryTerrainElevation(le),Ne=[[ue.x,ue.y,Math.min(ye||0,be||0,we||0,ke||0)],[ve.x,ve.y,Math.max(ye||0,be||0,we||0,ke||0)]];let De=a.c9.fromPoints(Ne);const $e=W.getWorldToCameraMatrix(),je=a.a6.mat4.invert(new Float64Array(16),$e);De=a.c9.applyTransform(De,$e);const et=this._extendAABB(De,W,q,I);if(!et)return void a.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");De=et;const Ke=.5*a.a6.vec3.sub([],De.max,De.min)[2],tt=this._minimumAABBFrustumDistance(W,De),ut=[0,0,1,0];a.a6.vec4.transformMat4(ut,ut,$e),a.a6.vec4.normalize(ut,ut);const at=a.a6.vec3.scale([],ut,tt+Ke),rt=a.a6.vec3.add([],De.center,at);a.a6.vec3.transformMat4(De.center,De.center,je),a.a6.vec3.transformMat4(rt,rt,je);const bt=W.unproject(new a.P(De.center[0],De.center[1])),Ft=a.dv(W.projection,bt),Zt=Math.pow(2,Ft),kt=Math.min(W._zoomFromMercatorZ(rt[2]*W.pixelsPerMeter*Zt/W.worldSize),q.maxZoom);return W.mercatorFromTransition&&kt<.5*(a.c2+a.bU)?(W.setProjection({name:"globe"}),W.zoom=kt,this._cameraForBounds(W,m,w,I,P,F)):{center:bt,zoom:kt,bearing:I,pitch:P}}fitBounds(u,m,w){const I=this.cameraForBounds(u,m);return this._fitInternal(I,m,w)}fitScreenCoordinates(u,m,w,I,P){const F=a.P.convert(u),W=a.P.convert(m),q=new a.P(Math.min(F.x,W.x),Math.min(F.y,W.y)),J=new a.P(Math.max(F.x,W.x),Math.max(F.y,W.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(F,W))return this;const ee=this.transform.pointLocation3D(q),ae=this.transform.pointLocation3D(J),le=this.transform.pointLocation3D(new a.P(q.x,J.y)),ue=this.transform.pointLocation3D(new a.P(J.x,q.y)),ve=[Math.min(ee.lng,ae.lng,le.lng,ue.lng),Math.min(ee.lat,ae.lat,le.lat,ue.lat)],ye=[Math.max(ee.lng,ae.lng,le.lng,ue.lng),Math.max(ee.lat,ae.lat,le.lat,ue.lat)],be=I&&I.pitch?I.pitch:this.getPitch(),we=this._cameraForBounds(this.transform,ve,ye,w,be,I);return this._fitInternal(we,I,P)}_fitInternal(u,m,w){return u?(m=a.l(u,m)).linear?this.easeTo(m,w):this.flyTo(m,w):this}jumpTo(u,m){this.stop();const w=u.preloadOnly?this.transform.clone():this.transform;let I=!1,P=!1,F=!1;"zoom"in u&&w.zoom!==+u.zoom&&(I=!0,w.zoom=+u.zoom),u.center!==void 0&&(w.center=a.bK.convert(u.center)),"bearing"in u&&w.bearing!==+u.bearing&&(P=!0,w.bearing=+u.bearing),"pitch"in u&&w.pitch!==+u.pitch&&(F=!0,w.pitch=+u.pitch);const W=typeof u.padding=="number"?this._extendPadding(u.padding):u.padding;if(u.padding!=null&&!w.isPaddingEqual(W))if(u.retainPadding===!1){const q=w.clone();q.padding=W,w.setLocationAtPoint(w.center,q.centerPoint)}else w.padding=W;return u.preloadOnly?(this._preloadTiles(w),this):(this.fire(new a.x("movestart",m)).fire(new a.x("move",m)),I&&this.fire(new a.x("zoomstart",m)).fire(new a.x("zoom",m)).fire(new a.x("zoomend",m)),P&&this.fire(new a.x("rotatestart",m)).fire(new a.x("rotate",m)).fire(new a.x("rotateend",m)),F&&this.fire(new a.x("pitchstart",m)).fire(new a.x("pitch",m)).fire(new a.x("pitchend",m)),this.fire(new a.x("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.w(pe),this.transform.getFreeCameraOptions()}setFreeCameraOptions(u,m){const w=this.transform;if(!w.projection.supportsFreeCamera)return a.w(pe),this;this.stop();const I=w.zoom,P=w.pitch,F=w.bearing;w.setFreeCameraOptions(u);const W=I!==w.zoom,q=P!==w.pitch,J=F!==w.bearing;return this.fire(new a.x("movestart",m)).fire(new a.x("move",m)),W&&this.fire(new a.x("zoomstart",m)).fire(new a.x("zoom",m)).fire(new a.x("zoomend",m)),J&&this.fire(new a.x("rotatestart",m)).fire(new a.x("rotate",m)).fire(new a.x("rotateend",m)),q&&this.fire(new a.x("pitchstart",m)).fire(new a.x("pitch",m)).fire(new a.x("pitchend",m)),this.fire(new a.x("moveend",m)),this}easeTo(u,m){this._stop(!1,u.easeId),((u=a.l({offset:[0,0],duration:500,easing:a.dr},u)).animate===!1||this._prefersReducedMotion(u))&&(u.duration=0);const w=this.transform,I=this.getZoom(),P=this.getBearing(),F=this.getPitch(),W=this.getPadding(),q="zoom"in u?+u.zoom:I,J="bearing"in u?this._normalizeBearing(u.bearing,P):P,ee="pitch"in u?+u.pitch:F,ae=this._extendPadding(u.padding),le=a.P.convert(u.offset);let ue,ve,ye;if(w.projection.name==="globe"){const ut=a.a5.fromLngLat(w.center),at=le.rotate(-w.angle);ut.x+=at.x/w.worldSize,ut.y+=at.y/w.worldSize;const rt=ut.toLngLat(),bt=a.bK.convert(u.center||rt);this._normalizeCenter(bt),ue=w.centerPoint.add(at),ve=new a.P(ut.x,ut.y).mult(w.worldSize),ye=new a.P(a.am(bt.lng),a.at(bt.lat)).mult(w.worldSize).sub(ve)}else{ue=w.centerPoint.add(le);const ut=w.pointLocation(ue),at=a.bK.convert(u.center||ut);this._normalizeCenter(at),ve=w.project(ut),ye=w.project(at).sub(ve)}const be=w.zoomScale(q-I);let we,ke;u.around&&(we=a.bK.convert(u.around),ke=w.locationPoint(we));const Ne=this._zooming||q!==I,De=this._rotating||P!==J,$e=this._pitching||ee!==F,je=!w.isPaddingEqual(ae),et=u.retainPadding===!1?w.clone():w,Ke=ut=>at=>{if(Ne&&(ut.zoom=a.aa(I,q,at)),De&&(ut.bearing=a.aa(P,J,at)),$e&&(ut.pitch=a.aa(F,ee,at)),je&&(et.interpolatePadding(W,ae,at),ue=et.centerPoint.add(le)),we)ut.setLocationAtPoint(we,ke);else{const rt=ut.zoomScale(ut.zoom-I),bt=q>I?Math.min(2,be):Math.max(.5,be),Ft=Math.pow(bt,1-at),Zt=ut.unproject(ve.add(ye.mult(at*Ft)).mult(rt));ut.setLocationAtPoint(ut.renderWorldCopies?Zt.wrap():Zt,ue)}return u.preloadOnly||this._fireMoveEvents(m),ut};if(u.preloadOnly){const ut=this._emulate(Ke,u.duration,w);return this._preloadTiles(ut),this}const tt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Ne,this._rotating=De,this._pitching=$e,this._padding=je,this._easeId=u.easeId,this._prepareEase(m,u.noMoveStart,tt),this._ease(Ke(w),ut=>{w.cameraElevationReference==="sea"&&w.recenterOnTerrain(),this._afterEase(m,ut)},u),this}_prepareEase(u,m,w={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),m||w.moving||this.fire(new a.x("movestart",u)),this._zooming&&!w.zooming&&this.fire(new a.x("zoomstart",u)),this._rotating&&!w.rotating&&this.fire(new a.x("rotatestart",u)),this._pitching&&!w.pitching&&this.fire(new a.x("pitchstart",u))}_fireMoveEvents(u){this.fire(new a.x("move",u)),this._zooming&&this.fire(new a.x("zoom",u)),this._rotating&&this.fire(new a.x("rotate",u)),this._pitching&&this.fire(new a.x("pitch",u))}_afterEase(u,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const w=this._zooming,I=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new a.x("zoomend",u)),I&&this.fire(new a.x("rotateend",u)),P&&this.fire(new a.x("pitchend",u)),this.fire(new a.x("moveend",u))}flyTo(u,m){if(this._prefersReducedMotion(u)){const Gt=a.ar(u,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Gt,m)}this.stop(),u=a.l({offset:[0,0],speed:1.2,curve:1.42,easing:a.dr},u);const w=this.transform,I=this.getZoom(),P=this.getBearing(),F=this.getPitch(),W=this.getPadding(),q="zoom"in u?a.ap(+u.zoom,w.minZoom,w.maxZoom):I,J="bearing"in u?this._normalizeBearing(u.bearing,P):P,ee="pitch"in u?+u.pitch:F,ae=this._extendPadding(u.padding),le=w.zoomScale(q-I),ue=a.P.convert(u.offset);let ve=w.centerPoint.add(ue);const ye=w.pointLocation(ve),be=a.bK.convert(u.center||ye);this._normalizeCenter(be);const we=w.project(ye),ke=w.project(be).sub(we);let Ne=u.curve;const De=Math.max(w.width,w.height),$e=De/le,je=ke.mag();if("minZoom"in u){const Gt=a.ap(Math.min(u.minZoom,I,q),w.minZoom,w.maxZoom),fn=De/w.zoomScale(Gt-I);Ne=Math.sqrt(fn/je*2)}const et=Ne*Ne;function Ke(Gt){const fn=($e*$e-De*De+(Gt?-1:1)*et*et*je*je)/(2*(Gt?$e:De)*et*je);return Math.log(Math.sqrt(fn*fn+1)-fn)}function tt(Gt){return(Math.exp(Gt)-Math.exp(-Gt))/2}function ut(Gt){return(Math.exp(Gt)+Math.exp(-Gt))/2}const at=Ke(0);let rt=function(Gt){return ut(at)/ut(at+Ne*Gt)},bt=function(Gt){return De*((ut(at)*(tt(fn=at+Ne*Gt)/ut(fn))-tt(at))/et)/je;var fn},Ft=(Ke(1)-at)/Ne;if(Math.abs(je)<1e-6||!isFinite(Ft)){if(Math.abs(De-$e)<1e-6)return this.easeTo(u,m);const Gt=$e<De?-1:1;Ft=Math.abs(Math.log($e/De))/Ne,bt=function(){return 0},rt=function(fn){return Math.exp(Gt*Ne*fn)}}u.duration="duration"in u?+u.duration:1e3*Ft/("screenSpeed"in u?+u.screenSpeed/Ne:+u.speed),u.maxDuration&&u.duration>u.maxDuration&&(u.duration=0);const Zt=P!==J,kt=ee!==F,hn=!w.isPaddingEqual(ae),wt=u.retainPadding===!1?w.clone():w,Wt=Gt=>fn=>{const pn=fn*Ft,qt=1/rt(pn);Gt.zoom=fn===1?q:I+Gt.scaleZoom(qt),Zt&&(Gt.bearing=a.aa(P,J,fn)),kt&&(Gt.pitch=a.aa(F,ee,fn)),hn&&(wt.interpolatePadding(W,ae,fn),ve=wt.centerPoint.add(ue));const en=fn===1?be:Gt.unproject(we.add(ke.mult(bt(pn))).mult(qt));return Gt.setLocationAtPoint(Gt.renderWorldCopies?en.wrap():en,ve),Gt._updateCameraOnTerrain(),u.preloadOnly||this._fireMoveEvents(m),Gt};if(u.preloadOnly){const Gt=this._emulate(Wt,u.duration,w);return this._preloadTiles(Gt),this}return this._zooming=!0,this._rotating=Zt,this._pitching=kt,this._padding=hn,this._prepareEase(m,!1),this._ease(Wt(w),()=>this._afterEase(m),u),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(u){}_cancelRenderFrame(u){}_stop(u,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const w=this._onEaseEnd;this._onEaseEnd=void 0,w.call(this,m)}if(!u){const w=this.handlers;w&&w.stop(!1)}return this}_ease(u,m,w){w.animate===!1||w.duration===0?(u(1),m()):(this._easeStart=a.q.now(),this._easeOptions=w,this._onEaseFrame=u,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const u=Math.min((a.q.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(u)),u<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(u,m){u=a.bA(u,-180,180);const w=Math.abs(u-m);return Math.abs(u-360-m)<w&&(u-=360),Math.abs(u+360-m)<w&&(u+=360),u}_normalizeCenter(u){const m=this.transform;if(m.maxBounds||m.projection.name!=="globe"&&!m.renderWorldCopies)return;const w=u.lng-m.center.lng;u.lng+=w>180?-360:w<-180?360:0}_prefersReducedMotion(u){return this._respectPrefersReducedMotion&&a.q.prefersReducedMotion&&!(u&&u.essential)}_emulate(u,m,w){const I=Math.ceil(15*m/1e3),P=[],F=u(w.clone());for(let W=0;W<=I;W++){const q=F(W/I);P.push(q.clone())}return P}_preloadTiles(u,m){}}class dt{constructor(u={}){this.options=u,a.aJ(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(u){const m=this.options&&this.options.compact,w=u._getUIString("AttributionControl.ToggleAttribution");this._map=u,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=M("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",w);const I=M("span","mapboxgl-ctrl-icon",this._compactButton);return I.setAttribute("aria-hidden","true"),I.setAttribute("title",w),this._innerContainer=M("div","mapboxgl-ctrl-attrib-inner",this._container),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let u=this._editLink;u||(u=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.e.ACCESS_TOKEN}];if(u){const w=m.reduce((I,P,F)=>(P.value&&(I+=`${P.key}=${P.value}${F<m.length-1?"&":""}`),I),"?");u.href=`${a.e.FEEDBACK_URL}/${w}#${jc(this._map,!0)}`,u.rel="noopener nofollow"}}_updateData(u){!u||u.sourceDataType!=="metadata"&&u.sourceDataType!=="visibility"&&u.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let u=[];if(this._map.style.stylesheet){const I=this._map.style.stylesheet;this.styleOwner=I.owner,this.styleId=I.id}const m=this._map.style._mergedSourceCaches;for(const I in m){const P=m[I];if(P.used){const F=P.getSource();F.attribution&&u.indexOf(F.attribution)<0&&u.push(F.attribution)}}u.sort((I,P)=>I.length-P.length),u=u.filter((I,P)=>{for(let F=P+1;F<u.length;F++)if(u[F].indexOf(I)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?u=[...this.options.customAttribution,...u]:u.unshift(this.options.customAttribution));const w=u.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,u.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Ot{constructor(){a.aJ(["_updateLogo","_updateCompact"],this)}onAdd(u){this._map=u,this._container=M("div","mapboxgl-ctrl");const m=M("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(u){u&&u.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const u=this._map.style._sourceCaches;if(Object.entries(u).length===0)return!0;for(const m in u){const w=u[m].getSource();if(w.hasOwnProperty("mapbox_logo")&&!w.mapbox_logo)return!1}return!0}_updateCompact(){const u=this._container.children;if(u.length){const m=u[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class vn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(u){const m=++this._id;return this._queue.push({callback:u,id:m,cancelled:!1}),m}remove(u){const m=this._currentlyRunning,w=m?this._queue.concat(m):this._queue;for(const I of w)if(I.id===u)return void(I.cancelled=!0)}run(u=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const w of m)if(!w.cancelled&&(w.callback(u),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Wn{constructor(u){this.jumpTo(u)}getValue(u){if(u<=this._startTime)return this._start;if(u>=this._endTime)return this._end;const m=a.cw((u-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(u){return u>=this._startTime&&u<=this._endTime}jumpTo(u){this._startTime=-1/0,this._endTime=-1/0,this._start=u,this._end=u}easeTo(u,m,w){this._start=this.getValue(m),this._end=u,this._startTime=m,this._endTime=m+w}}const br={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class oi{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class zr{constructor(u){this.map=u,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this)}add(u,m){if(this.typeById.has(u))throw new Error(`Interaction id "${u}" already exists.`);const{type:w,filter:I}=m;if(I){const F=a.M(I,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(F.result==="error")throw new Error(F.value.map(W=>`${W.key}: ${W.message}`).join(", "));this.filters.set(u,F.value)}const P=this.interactionsByType.get(w)||new Map;P.size===0&&(this.map.on(w,this.handleType),this.interactionsByType.set(w,P)),P.set(u,m),this.typeById.set(u,w)}remove(u){const m=this.typeById.get(u);if(!m)return;this.typeById.delete(u),this.filters.delete(u);const w=this.interactionsByType.get(m);w&&(w.delete(u),w.size===0&&this.map.off(m,this.handleType))}handleType(u){const m=u.features||this.map.queryRenderedFeatures(u.point);if(!m)return;const w=this.interactionsByType.get(u.type),I={zoom:0};for(const[P,F]of w){const W=this.filters.get(P),{handler:q,layers:J}=F;for(const ee of m)if((!J||J.includes(ee.layer.id))&&(!W||W.evaluate(I,ee))&&q({id:P,feature:ee,interaction:F})!==!1)break}}}const ps={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0},Ir={showCompass:!0,showZoom:!0,visualizePitch:!1};class ha{constructor(u,m,w=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new Wg({clickTolerance:u.dragRotate._mouseRotate._clickTolerance}),this.map=u,w&&(this.mousePitch=new im({clickTolerance:u.dragRotate._mousePitch._clickTolerance})),a.aJ(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(u,m){this.mouseRotate.mousedown(u,m),this.mousePitch&&this.mousePitch.mousedown(u,m),X()}move(u,m){const w=this.map,I=this.mouseRotate.mousemoveWindow(u,m),P=I&&I.bearingDelta;if(P&&w.setBearing(w.getBearing()+P),this.mousePitch){const F=this.mousePitch.mousemoveWindow(u,m),W=F&&F.pitchDelta;W&&w.setPitch(w.getPitch()+W)}}off(){const u=this.element;u.removeEventListener("mousedown",this.mousedown),u.removeEventListener("touchstart",this.touchstart,{passive:!1}),u.removeEventListener("touchmove",this.touchmove),u.removeEventListener("touchend",this.touchend),u.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(u){this.down(a.l({},u,{ctrlKey:!0,preventDefault:()=>u.preventDefault()}),ie(this.element,u)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(u){this.move(u,ie(this.element,u))}mouseup(u){this.mouseRotate.mouseupWindow(u),this.mousePitch&&this.mousePitch.mouseupWindow(u),this.offTemp()}touchstart(u){u.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=oe(this.element,u.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>u.preventDefault()},this._startPos))}touchmove(u){u.targetTouches.length!==1?this.reset():(this._lastPos=oe(this.element,u.targetTouches)[0],this.move({preventDefault:()=>u.preventDefault()},this._lastPos))}touchend(u){u.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function fa(b,u,m){if(b=new a.bK(b.lng,b.lat),u){const w=new a.bK(b.lng-360,b.lat),I=new a.bK(b.lng+360,b.lat),P=360*Math.ceil(Math.abs(b.lng-m.center.lng)/360),F=m.locationPoint(b).distSqr(u),W=u.x<0||u.y<0||u.x>m.width||u.y>m.height;m.locationPoint(w).distSqr(u)<F&&(W||Math.abs(w.lng-m.center.lng)<P)?b=w:m.locationPoint(I).distSqr(u)<F&&(W||Math.abs(I.lng-m.center.lng)<P)&&(b=I)}for(;Math.abs(b.lng-m.center.lng)>180;){const w=m.locationPoint(b);if(w.x>=0&&w.y>=0&&w.x<=m.width&&w.y<=m.height)break;b.lng>m.center.lng?b.lng-=360:b.lng+=360}return b}const $t={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Nt extends a.E{constructor(u,m){if(super(),(u instanceof HTMLElement||m)&&(u=a.l({element:u},m)),a.aJ(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=u&&u.anchor||"center",this._color=u&&u.color||"#3FB1CE",this._scale=u&&u.scale||1,this._draggable=u&&u.draggable||!1,this._clickTolerance=u&&u.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=u&&u.rotation||0,this._rotationAlignment=u&&u.rotationAlignment||"auto",this._pitchAlignment=u&&u.pitchAlignment&&u.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=u&&u.occludedOpacity||.2,u&&u.element)this._element=u.element,this._offset=a.P.convert(u&&u.offset||[0,0]);else{this._defaultMarker=!0,this._element=M("div");const P=41,F=27,W=E("svg",{display:"block",height:P*this._scale+"px",width:F*this._scale+"px",viewBox:`0 0 ${F} ${P}`},this._element),q=E("radialGradient",{id:"shadowGradient"},E("defs",{},W));E("stop",{offset:"10%","stop-opacity":.4},q),E("stop",{offset:"100%","stop-opacity":.05},q),E("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},W),E("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},W),E("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},W),E("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},W),this._offset=a.P.convert(u&&u.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",P=>{P.preventDefault()}),this._element.addEventListener("mousedown",P=>{P.preventDefault()});const w=this._element.classList;for(const P in $t)w.remove(`mapboxgl-marker-anchor-${P}`);w.add(`mapboxgl-marker-anchor-${this._anchor}`);const I=u&&u.className?u.className.trim().split(/\s+/):[];w.add(...I),this._popup=null}addTo(u){return u===this._map||(this.remove(),this._map=u,u.getCanvasContainer().appendChild(this._element),u.on("move",this._updateMoving),u.on("moveend",this._update),u.on("remove",this._clearFadeTimer),u._addMarker(this),this.setDraggable(this._draggable),this._update(),u.on("click",this._onMapClick)),this}remove(){const u=this._map;return u&&(u.off("click",this._onMapClick),u.off("move",this._updateMoving),u.off("moveend",this._update),u.off("mousedown",this._addDragHandler),u.off("touchstart",this._addDragHandler),u.off("mouseup",this._onUp),u.off("touchend",this._onUp),u.off("mousemove",this._onMove),u.off("touchmove",this._onMove),u.off("remove",this._clearFadeTimer),u._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(u){return this._lngLat=a.bK.convert(u),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(u){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),u){if(!("offset"in u.options)){const I=Math.sqrt(Math.pow(13.5,2)/2);u.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[I,-1*(38.1-13.5+I)],"bottom-right":[-I,-1*(38.1-13.5+I)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=u,u._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(u){const m=u.code,w=u.charCode||u.keyCode;m!=="Space"&&m!=="Enter"&&w!==32&&w!==13||this.togglePopup()}_onMapClick(u){const m=u.originalEvent.target,w=this._element;this._popup&&(m===w||w.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const u=this._popup;return u?(u.isOpen()?(u.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(u.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const u=this._map,m=this._pos;if(!u||!m)return!1;const w=u.unproject(m),I=u.getFreeCameraOptions();if(!I.position)return!1;const P=I.position.toLngLat();return P.distanceTo(w)<.9*P.distanceTo(this._lngLat)}_evaluateOpacity(){const u=this._map;if(!u)return;const m=this._pos;if(!m||m.x<0||m.x>u.transform.width||m.y<0||m.y>u.transform.height)return void this._clearFadeTimer();const w=u.unproject(m);let I;u._showingGlobe()&&a.dz(u.transform,this._lngLat)?I=0:(I=1-u._queryFogOpacity(w),u.transform._terrainEnabled()&&u.getTerrain()&&this._behindTerrain()&&(I*=this._occludedOpacity)),this._element.style.opacity=`${I}`,this._element.style.pointerEvents=I>0?"auto":"none",this._popup&&this._popup._setOpacity(I),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const u=this._pos;if(!u||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${u.x}px,${u.y}px)
            ${$t[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const u=this._pos,m=this._map,w=this.getPitchAlignment();if(!m||!u||w!=="map")return"";if(!m._showingGlobe()){const q=m.getPitch();return q?`rotateX(${q}deg)`:""}const I=a.c0(a.dA(m.transform,this._lngLat)),P=u.sub(a.dB(m.transform)),F=Math.abs(P.x)+Math.abs(P.y);if(F===0)return"";const W=I/F;return`rotateX(${-P.y*W}deg) rotateY(${P.x*W}deg)`}_calculateZTransform(){const u=this._pos,m=this._map;if(!m||!u)return"";let w=0;const I=this.getRotationAlignment();if(I==="map")if(m._showingGlobe()){const P=m.project(new a.bK(this._lngLat.lng,this._lngLat.lat+.001)),F=m.project(new a.bK(this._lngLat.lng,this._lngLat.lat-.001)).sub(P);w=a.c0(Math.atan2(F.y,F.x))-90}else w=-m.getBearing();else if(I==="horizon"){const P=a.a7(4,6,m.getZoom()),F=a.dB(m.transform);F.y+=P*m.transform.height;const W=u.sub(F),q=a.c0(Math.atan2(W.y,W.x));w=(q>90?q-270:q+90)*(1-P)}return w+=this._rotation,w?`rotateZ(${w}deg)`:""}_update(u){cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=fa(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),u===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(u){return this._offset=a.P.convert(u),this._update(),this}addClassName(u){return this._element.classList.add(u),this}removeClassName(u){return this._element.classList.remove(u),this}toggleClassName(u){return this._element.classList.toggle(u)}_onMove(u){const m=this._map;if(!m)return;const w=this._pointerdownPos,I=this._positionDelta;if(w&&I){if(!this._isDragging){const P=this._clickTolerance||m._clickTolerance;if(u.point.dist(w)<P)return;this._isDragging=!0}this._pos=u.point.sub(I),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.x("dragstart"))),this.fire(new a.x("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const u=this._map;u&&(u.off("mousemove",this._onMove),u.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.x("dragend")),this._state="inactive"}_addDragHandler(u){const m=this._map,w=this._pos;m&&w&&this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(w),this._pointerdownPos=u.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(u){this._draggable=!!u;const m=this._map;return m&&(u?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(u){return this._rotation=u||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(u){return this._rotationAlignment=u||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(u){return this._pitchAlignment=u||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(u){return this._occludedOpacity=u||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const an={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},rr={maxWidth:100,unit:"metric"},Rr={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},vi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},li=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function zi(b=new a.P(0,0),u="bottom"){if(typeof b=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(b,2)));switch(u){case"top":return new a.P(0,b);case"top-left":return new a.P(m,m);case"top-right":return new a.P(-m,m);case"bottom":return new a.P(0,-b);case"bottom-left":return new a.P(m,-m);case"bottom-right":return new a.P(-m,-m);case"left":return new a.P(b,0);case"right":return new a.P(-b,0)}return new a.P(0,0)}return b instanceof a.P||Array.isArray(b)?a.P.convert(b):a.P.convert(b[u]||[0,0])}return{version:h,supported:C.supported,setRTLTextPlugin:a.dC,getRTLTextPluginStatus:a.dD,Map:class extends Te{constructor(b){p.mark(f.create);const u=b;if((b=a.l({},ps,b)).minZoom!=null&&b.maxZoom!=null&&b.minZoom>b.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(b.minPitch!=null&&b.maxPitch!=null&&b.minPitch>b.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(b.minPitch!=null&&b.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(b.maxPitch!=null&&b.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(b.antialias&&a.dx(window)&&(b.antialias=!1,a.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new _d(b.minZoom,b.maxZoom,b.minPitch,b.maxPitch,b.renderWorldCopies),b),this._repaint=!!b.repaint,this._interactive=b.interactive,this._minTileCacheSize=b.minTileCacheSize,this._maxTileCacheSize=b.maxTileCacheSize,this._failIfMajorPerformanceCaveat=b.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=b.preserveDrawingBuffer,this._antialias=b.antialias,this._trackResize=b.trackResize,this._bearingSnap=b.bearingSnap,this._refreshExpiredTiles=b.refreshExpiredTiles,this._fadeDuration=b.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=b.crossSourceCollisions,this._collectResourceTiming=b.collectResourceTiming,this._language=this._parseLanguage(b.language),this._worldview=b.worldview,this._renderTaskQueue=new vn,this._domRenderTaskQueue=new vn,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.aP(),this._locale=a.l({},br,b.locale),this._clickTolerance=b.clickTolerance,this._cooperativeGestures=b.cooperativeGestures,this._performanceMetricsCollection=b.performanceMetricsCollection,this._tessellationStep=b.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=b.precompilePrograms,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Wn(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._requestManager=new He(b.transformRequest,b.accessToken,b.testMode),this._silenceAuthErrors=!!b.testMode,this._contextCreateOptions=b.contextCreateOptions?{...b.contextCreateOptions}:{},typeof b.container=="string"){const m=document.getElementById(b.container);if(!m)throw new Error(`Container '${b.container.toString()}' not found.`);this._container=m}else{if(!(b.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=b.container}if(this._container.childNodes.length>0&&a.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),b.maxBounds&&this.setMaxBounds(b.maxBounds),a.aJ(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new oi),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new se(this,b),this._localFontFamily=b.localFontFamily,this._localIdeographFontFamily=b.localIdeographFontFamily,(b.style||!b.testMode)&&this.setStyle(b.style||a.e.DEFAULT_STYLE,{config:b.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),b.projection&&this.setProjection(b.projection),b.hash&&(this._hash=new ua(typeof b.hash=="string"&&b.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){u.center==null&&u.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:b.center,zoom:b.zoom,bearing:b.bearing,pitch:b.pitch});const m=b.bounds;m&&(this.resize(),this.fitBounds(m,a.l({},b.fitBoundsOptions,{duration:0})))}this.resize(),b.attributionControl&&this.addControl(new dt({customAttribution:b.customAttribution})),this._logoControl=new Ot,this.addControl(this._logoControl,b.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",m=>{this._update(m.dataType==="style"),this.fire(new a.x(`${m.dataType}data`,m))}),this.on("dataloading",m=>{this.fire(new a.x(`${m.dataType}dataloading`,m))}),this._interactions=new zr(this)}_getMapId(){return this._mapId}addControl(b,u){if(u===void 0&&(u=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new a.t(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=b.onAdd(this);this._controls.push(b);const w=this._controlPositions[u];return u.indexOf("bottom")!==-1?w.insertBefore(m,w.firstChild):w.appendChild(m),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new a.t(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const u=this._controls.indexOf(b);return u>-1&&this._controls.splice(u,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(b){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const u=!this._moving;return u&&this.fire(new a.x("movestart",b)).fire(new a.x("move",b)),this.fire(new a.x("resize",b)),u&&this.fire(new a.x("moveend",b)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(b){return this.transform.setMaxBounds(a.as.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.minZoom=b,this._update(),this.getZoom()<b?this.setZoom(b):this.fire(new a.x("zoomstart")).fire(new a.x("zoom")).fire(new a.x("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.maxZoom=b,this._update(),this.getZoom()>b?this.setZoom(b):this.fire(new a.x("zoomstart")).fire(new a.x("zoom")).fire(new a.x("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.minPitch=b,this._update(),this.getPitch()<b?this.setPitch(b):this.fire(new a.x("pitchstart")).fire(new a.x("pitch")).fire(new a.x("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(b>=this.transform.minPitch)return this.transform.maxPitch=b,this._update(),this.getPitch()>b?this.setPitch(b):this.fire(new a.x("pitchstart")).fire(new a.x("pitch")).fire(new a.x("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.renderWorldCopies=b,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(b){return b==="auto"?navigator.language:Array.isArray(b)?b.length===0?void 0:b.map(u=>u==="auto"?navigator.language:u):b}setLanguage(b){const u=this._parseLanguage(b);if(!this.style||u===this._language)return this;this._language=u,this.style.reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(b){return this.style&&b!==this._worldview?(this._worldview=b,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(b){return this._lazyInitEmptyStyle(),b?typeof b=="string"&&(b={name:b}):b=null,this._useExplicitProjection=!!b,this._prioritizeAndUpdateProjection(b,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const b=this.transform,u=b.projection.name;let m;u==="globe"&&b.zoom>=a.bU?(b.setMercatorFromTransition(),m=!0):u==="mercator"&&b.zoom<a.bU&&(b.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(b,u){return this._updateProjection(b||u||{name:"mercator"})}_updateProjection(b){let u;return u=b.name==="globe"&&this.transform.zoom>=a.bU?this.transform.setMercatorFromTransition():this.transform.setProjection(b),this.style.applyProjectionUpdate(),u&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(b){return this.transform.locationPoint3D(a.bK.convert(b))}unproject(b){return this.transform.pointLocation3D(a.P.convert(b))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(b,u,m){if(b==="mouseenter"||b==="mouseover"){let w=!1;const I=F=>{const W=u.filter(J=>this.getLayer(J)),q=W.length?this.queryRenderedFeatures(F.point,{layers:W}):[];q.length?w||(w=!0,m.call(this,new bo(b,this,F.originalEvent,{features:q}))):w=!1},P=()=>{w=!1};return{layers:new Set(u),listener:m,delegates:{mousemove:I,mouseout:P}}}if(b==="mouseleave"||b==="mouseout"){let w=!1;const I=F=>{const W=u.filter(q=>this.getLayer(q));(W.length?this.queryRenderedFeatures(F.point,{layers:W}):[]).length?w=!0:w&&(w=!1,m.call(this,new bo(b,this,F.originalEvent)))},P=F=>{w&&(w=!1,m.call(this,new bo(b,this,F.originalEvent)))};return{layers:new Set(u),listener:m,delegates:{mousemove:I,mouseout:P}}}{const w=I=>{const P=u.filter(W=>this.getLayer(W)),F=P.length?this.queryRenderedFeatures(I.point,{layers:P}):[];F.length&&(I.features=F,m.call(this,I),delete I.features)};return{layers:new Set(u),listener:m,delegates:{[b]:w}}}}on(b,u,m){if(typeof u=="function"||m===void 0)return super.on(b,u);if(Array.isArray(u)||(u=[u]),u){for(const I of u)if(!this._isValidId(I))return this}const w=this._createDelegatedListener(b,u,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(w);for(const I in w.delegates)this.on(I,w.delegates[I]);return this}once(b,u,m){if(typeof u=="function"||m===void 0)return super.once(b,u);if(Array.isArray(u)||(u=[u]),u){for(const I of u)if(!this._isValidId(I))return this}const w=this._createDelegatedListener(b,u,m);for(const I in w.delegates)this.once(I,w.delegates[I]);return this}off(b,u,m){if(typeof u=="function"||m===void 0)return super.off(b,u);const w=new Set(Array.isArray(u)?u:[u]);for(const F of w)if(!this._isValidId(F))return this;const I=(F,W)=>{if(F.size!==W.size)return!1;for(const q of F)if(!W.has(q))return!1;return!0},P=this._delegatedListeners?this._delegatedListeners[b]:void 0;return P&&(F=>{for(let W=0;W<F.length;W++){const q=F[W];if(q.listener===m&&I(q.layers,w)){for(const J in q.delegates)this.off(J,q.delegates[J]);return F.splice(W,1),this}}})(P),this}queryRenderedFeatures(b,u){if(!this.style)return[];if(u!==void 0||b===void 0||b instanceof a.P||Array.isArray(b)||(u=b,b=void 0),b=b||[[0,0],[this.transform.width,this.transform.height]],(u=u||{}).layers&&Array.isArray(u.layers)){for(const m of u.layers)if(!this._isValidId(m))return[]}return this.style.queryRenderedFeatures(b,u,this.transform)}querySourceFeatures(b,u){return this._isValidId(b)?this.style.querySourceFeatures(b,u):[]}isPointOnSurface(b){const{name:u}=this.transform.projection;return u!=="globe"&&u!=="mercator"&&a.w(`${u} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.P.convert(b))}addInteraction(b,u){return this._interactions.add(b,u),this}removeInteraction(b){return this._interactions.remove(b),this}setStyle(b,u){return u=a.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},u),this.style&&b&&u.diff!==!1&&u.localFontFamily===this._localFontFamily&&u.localIdeographFontFamily===this._localIdeographFontFamily&&!u.config?(this.style._diffStyle(b,(m,w)=>{m?(a.w(`Unable to perform style diff: ${String(m.message||m.error||m)}. Rebuilding the style from scratch.`),this._updateStyle(b,u)):w&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=u.localIdeographFontFamily,this._localFontFamily=u.localFontFamily,this._updateStyle(b,u))}_getUIString(b){const u=this._locale[b];if(u==null)throw new Error(`Missing UI string '${b}'`);return u}_updateStyle(b,u){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),b){const m=a.l({},u);u&&u.config&&(m.initialConfig=u.config,delete m.config),this.style=new Fo(this,m).load(b),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Fo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.w("There is no style added to the map."),!1)}_isValidId(b){return b==null?(this.fire(new a.t(new Error("IDs can't be empty."))),!1):!a.cn(b)||(this.fire(new a.t(new Error(`IDs can't contain special symbols: "${b}".`))),!1)}addSource(b,u){return this._isValidId(b)?(this._lazyInitEmptyStyle(),this.style.addSource(b,u),this._update(!0)):this}isSourceLoaded(b){return!!this._isValidId(b)&&!!this.style&&this.style._isSourceCacheLoaded(b)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(b,u,m){this._lazyInitEmptyStyle(),this.style.addSourceType(b,u,m)}removeSource(b){return this._isValidId(b)?(this.style.removeSource(b),this._updateTerrain(),this._update(!0)):this}getSource(b){return this._isValidId(b)?this.style.getOwnSource(b):null}addImage(b,u,{pixelRatio:m=1,sdf:w=!1,stretchX:I,stretchY:P,content:F}={}){if(this._lazyInitEmptyStyle(),u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap){const{width:W,height:q,data:J}=a.q.getImageData(u);this.style.addImage(b,{data:new a.r({width:W,height:q},J),pixelRatio:m,stretchX:I,stretchY:P,content:F,sdf:w,version:0})}else if(u.width===void 0||u.height===void 0)this.fire(new a.t(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:W,height:q}=u,J=u;this.style.addImage(b,{data:new a.r({width:W,height:q},new Uint8Array(J.data)),pixelRatio:m,stretchX:I,stretchY:P,content:F,sdf:w,version:0,userImage:J}),J.onAdd&&J.onAdd(this,b)}}updateImage(b,u){this._lazyInitEmptyStyle();const m=this.style.getImage(b);if(!m)return void this.fire(new a.t(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap?a.q.getImageData(u):u,{width:I,height:P,data:F}=w;if(I===void 0||P===void 0)return void this.fire(new a.t(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(I!==m.data.width||P!==m.data.height)return void this.fire(new a.t(new Error(`The width and height of the updated image (${I}, ${P})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`)));const W=!(u instanceof HTMLImageElement||ImageBitmap&&u instanceof ImageBitmap);m.data.replace(F,W),this.style.updateImage(b,m)}hasImage(b){return b?!!this.style&&!!this.style.getImage(b):(this.fire(new a.t(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b,u){a.o(this._requestManager.transformRequest(b,a.R.Image),(m,w)=>{u(m,w instanceof HTMLImageElement?a.q.getImageData(w):w)})}listImages(){return this.style.listImages()}addModel(b,u){this._lazyInitEmptyStyle(),this.style.addModel(b,u)}hasModel(b){return b?this.style.hasModel(b):(this.fire(new a.t(new Error("Missing required model id"))),!1)}removeModel(b){this.style.removeModel(b)}listModels(){return this.style.listModels()}addLayer(b,u){return this._isValidId(b.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(b,u),this._update(!0)):this}getSlot(b){const u=this.getLayer(b);return u&&u.slot||null}setSlot(b,u){return this.style.setSlot(b,u),this.style.mergeLayers(),this._update(!0)}addImport(b,u){return this.style.addImport(b,u),this}updateImport(b,u){return typeof u!="string"&&u.id!==b?(this.removeImport(b),this.addImport(u)):(this.style.updateImport(b,u),this._update(!0))}removeImport(b){return this.style.removeImport(b),this}moveImport(b,u){return this.style.moveImport(b,u),this._update(!0)}moveLayer(b,u){return this._isValidId(b)?(this.style.moveLayer(b,u),this._update(!0)):this}removeLayer(b){return this._isValidId(b)?(this.style.removeLayer(b),this._update(!0)):this}getLayer(b){if(!this._isValidId(b))return null;const u=this.style.getOwnLayer(b);return u?u.type==="custom"?u.implementation:u.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(b,u,m){return this._isValidId(b)?(this.style.setLayerZoomRange(b,u,m),this._update(!0)):this}setFilter(b,u,m={}){return this._isValidId(b)?(this.style.setFilter(b,u,m),this._update(!0)):this}getFilter(b){return this._isValidId(b)?this.style.getFilter(b):null}setPaintProperty(b,u,m,w={}){return this._isValidId(b)?(this.style.setPaintProperty(b,u,m,w),this._update(!0)):this}getPaintProperty(b,u){return this._isValidId(b)?this.style.getPaintProperty(b,u):null}setLayoutProperty(b,u,m,w={}){return this._isValidId(b)?(this.style.setLayoutProperty(b,u,m,w),this._update(!0)):this}getLayoutProperty(b,u){return this._isValidId(b)?this.style.getLayoutProperty(b,u):null}getSchema(b){return this.style.getSchema(b)}setSchema(b,u){return this.style.setSchema(b,u),this._update(!0)}getConfig(b){return this.style.getConfig(b)}setConfig(b,u){return this.style.setConfig(b,u),this._update(!0)}getConfigProperty(b,u){return this.style.getConfigProperty(b,u)}setConfigProperty(b,u,m){return this.style.setConfigProperty(b,u,m),this._update(!0)}setLights(b){if(this._lazyInitEmptyStyle(),b&&b.length===1&&b[0].type==="flat"){const u=b[0];u.properties?this.style.setFlatLight(u.properties,u.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(b),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const b=this.style.getLights()||[];return b.length===0&&b.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),b}setLight(b,u={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:b}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(b){return this._lazyInitEmptyStyle(),!b&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(b),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(b){return this._lazyInitEmptyStyle(),this.style.setFog(b),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setColorTheme(b){return this._lazyInitEmptyStyle(),this.style.setColorTheme(b),this._update(!0)}setCamera(b){return this.style.setCamera(b),this._triggerCameraUpdate(b)}_triggerCameraUpdate(b){return this._update(this.transform.setOrthographicProjectionAtLowPitch(b["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(b){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.bK.convert(b),this.transform):0}setFeatureState(b,u){return this._isValidId(b.source)?(this.style.setFeatureState(b,u),this._update()):this}removeFeatureState(b,u){return this._isValidId(b.source)?(this.style.removeFeatureState(b,u),this._update()):this}getFeatureState(b){return this._isValidId(b.source)?this.style.getFeatureState(b):null}_updateContainerDimensions(){if(!this._container)return;const b=this._container.getBoundingClientRect().width||400,u=this._container.getBoundingClientRect().height||300;let m,w,I,P=this._container;for(;P&&(!w||!I);){const F=window.getComputedStyle(P).transform;F&&F!=="none"&&(m=F.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(w=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(I=m[3])),P=P.parentElement}this._containerWidth=w?Math.abs(b/w):b,this._containerHeight=I?Math.abs(u/I):u}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const b=this._container;b.classList.add("mapboxgl-map"),(this._missingCSSCanary=M("div","mapboxgl-canary",b)).style.visibility="hidden",this._detectMissingCSS();const u=this._canvasContainer=M("div","mapboxgl-canvas-container",b);this._canvas=M("canvas","mapboxgl-canvas",u),this._interactive&&(u.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=M("div","mapboxgl-control-container",b),w=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(I=>{w[I]=M("div",`mapboxgl-ctrl-${I}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,u){const m=a.q.devicePixelRatio||1;this._canvas.width=m*Math.ceil(b),this._canvas.height=m*Math.ceil(u),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${u}px`}_addMarker(b){this._markers.push(b)}_removeMarker(b){const u=this._markers.indexOf(b);u!==-1&&this._markers.splice(u,1)}_addPopup(b){this._popups.push(b)}_removePopup(b){const u=this._popups.indexOf(b);u!==-1&&this._popups.splice(u,1)}_setupPainter(){const b=a.l({},C.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),u=this._canvas.getContext("webgl2",b);u?(mn(u,!0),this.painter=new el(u,this._contextCreateOptions,this.transform,this._tp),this.on("data",m=>{m.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),a.m.testSupport(u)):this.fire(new a.t(new Error("Failed to initialize WebGL")))}_contextLost(b){b.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.x("webglcontextlost",{originalEvent:b}))}_contextRestored(b){this._setupPainter(),this.resize(),this._update(),this.fire(new a.x("webglcontextrestored",{originalEvent:b}))}_onMapScroll(b){if(b.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(b){return this.style?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_requestDomTask(b){!this.loaded()||this.loaded()&&!this.isMoving()?b():this._domRenderTaskQueue.add(b)}_render(b){let u;this.fire(new a.x("renderstart")),++this._frameId;const m=this.painter.context.extTimerQuery,w=a.q.now(),I=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(u=I.createQuery(),I.beginQuery(m.TIME_ELAPSED_EXT,u)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(b),this._domRenderTaskQueue.run(b),this._removed)return;this._updateProjectionTransition();const P=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,ee=this.transform.pitch,ae=a.q.now(),le=new a.a3(J,{now:ae,fadeDuration:P,pitch:ee,transition:this.style.transition});this.style.update(le)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let F=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),F=this._updateAverageElevation(w),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):F=this._updateAverageElevation(w);const W=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,P,this._crossSourceCollisions,this.painter.replacementSource);if(W&&(this._placementDirty=W.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:P,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.x("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,p.mark(f.load),this.fire(new a.x("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),u){const J=a.q.now()-w;I.endQuery(m.TIME_ELAPSED_EXT),setTimeout(()=>{const ee=I.getQueryParameter(u,I.QUERY_RESULT)/1e6;I.deleteQuery(u),this.fire(new a.x("gpu-timing-frame",{cpuTime:J,gpuTime:ee}))},50)}if(this.listens("gpu-timing-layer")){const J=this.painter.collectGpuTimers();setTimeout(()=>{const ee=this.painter.queryGpuTimers(J);this.fire(new a.x("gpu-timing-layer",{layerTimes:ee}))},50)}if(this.listens("gpu-timing-deferred-render")){const J=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const ee=this.painter.queryGpuTimeDeferredRender(J);this.fire(new a.x("gpu-timing-deferred-render",{gpuTime:ee}))},50)}const q=this._sourcesDirty||this._styleDirty||this._placementDirty||F;if(q||this._repaint)this.triggerRepaint();else{const J=this.idle();if(J&&(F=this._updateAverageElevation(w,!0)),F)this.triggerRepaint();else if(this._triggerFrame(!1),J&&(this.fire(new a.x("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const ee=this._calculateSpeedIndex();this.fire(new a.x("speedindexcompleted",{speedIndex:ee})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||q||(this._fullyLoaded=!0,p.mark(f.fullLoad),this._performanceMetricsCollection&&Bn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(b){for(const u of this._markers)b&&!this.getRenderWorldCopies()&&(u._lngLat=u._lngLat.wrap()),u._update();for(const u of this._popups)!b||this.getRenderWorldCopies()||u._trackPointer||(u._lngLat=u._lngLat.wrap()),u._update()}_updateAverageElevation(b,u=!1){const m=I=>(this.transform.averageElevation=I,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);const w=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(w||(u||b-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(b)){const I=this.transform.averageElevation;let P=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(P)?P=0:this._averageElevationLastSampledAt=b;const F=Math.abs(I-P);if(F>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(P),m(P);this._averageElevation.easeTo(P,b,300)}else if(F>1e-4)return this._averageElevation.jumpTo(P),m(P)}return!!this._averageElevation.isEasing(b)&&m(this._averageElevation.getValue(b))}_authenticate(){Le(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,b=>{if(b&&(b.message===Ie||b.status===401)){const u=this.painter.context.gl;mn(u,!1),this._logoControl instanceof Ot&&this._logoControl._updateLogo(),u&&u.clear(u.DEPTH_BUFFER_BIT|u.COLOR_BUFFER_BIT|u.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.t(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Ht(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&rn(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const b=this._isDragging();this.painter.updateTerrain(this.style,b)}_calculateSpeedIndex(){const b=this.painter.canvasCopy(),u=this.painter.getCanvasCopiesAndTimestamps();u.timeStamps.push(performance.now());const m=this.painter.context.gl,w=m.createFramebuffer();function I(P){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,P,0);const F=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,F),F}return m.bindFramebuffer(m.FRAMEBUFFER,w),this._canvasPixelComparison(I(b),u.canvasCopies.map(I),u.timeStamps)}_canvasPixelComparison(b,u,m){let w=m[1]-m[0];const I=b.length/4;for(let P=0;P<u.length;P++){const F=u[P];let W=0;for(let q=0;q<F.length;q+=4)F[q]===b[q]&&F[q+1]===b[q+1]&&F[q+2]===b[q+2]&&F[q+3]===b[q+3]&&(W+=1);w+=(m[P+2]-m[P+1])*(1-W/I)}return w}remove(){this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const b=this.painter.context.gl.getExtension("WEBGL_lose_context");b&&b.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),qe.delete(this.painter.context.gl),Tn.remove(),lt.remove(),this._removed=!0,this.fire(new a.x("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(b){this._renderNextFrame=this._renderNextFrame||b,this.style&&!this._frame&&(this._frame=a.q.frame(u=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(u)}))}_preloadTiles(b){const u=this.style?this.style.getSourceCaches():[];return a.bf(u,(m,w)=>m._preloadTiles(b,w),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(b){this._trackResize&&this.resize({originalEvent:b})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(b){this._showParseStatus!==b&&(this._showParseStatus=b,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(b){this._showTerrainWireframe!==b&&(this._showTerrainWireframe=b,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(b){this._showLayers2DWireframe!==b&&(this._showLayers2DWireframe=b,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(b){this._showLayers3DWireframe!==b&&(this._showLayers3DWireframe=b,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(b){this._speedIndexTiming!==b&&(this._speedIndexTiming=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,this._tp.refreshUI(),b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(b){this._showTileAABBs!==b&&(this._showTileAABBs=b,this._tp.refreshUI(),b&&this._update())}_setCacheLimits(b,u){a.dy(b,u)}get version(){return h}},NavigationControl:class{constructor(b={}){this.options=a.l({},Ir,b),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",u=>u.preventDefault()),this.options.showZoom&&(a.aJ(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",u=>{this._map&&this._map.zoomIn({},{originalEvent:u})}),M("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",u=>{this._map&&this._map.zoomOut({},{originalEvent:u})}),M("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.aJ(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",u=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:u}):m.resetNorth({},{originalEvent:u}))}),this._compassIcon=M("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const b=this._map;if(!b)return;const u=b.getZoom(),m=u===b.getMaxZoom(),w=u===b.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())}_rotateCompassArrow(){const b=this._map;if(!b)return;const u=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(b.transform.pitch*(Math.PI/180)),.5)}) rotateX(${b.transform.pitch}deg) rotateZ(${b.transform.angle*(180/Math.PI)}deg)`:`rotate(${b.transform.angle*(180/Math.PI)}deg)`;b._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=u)})}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),b.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&b.on("pitch",this._rotateCompassArrow),b.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new ha(b,this._compass,this.options.visualizePitch)),this._container}onRemove(){const b=this._map;b&&(this._container.remove(),this.options.showZoom&&b.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&b.off("pitch",this._rotateCompassArrow),b.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(b,u){const m=M("button",b,this._container);return m.type="button",m.addEventListener("click",u),m}_setButtonTitle(b,u){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${u}`);b.setAttribute("aria-label",m),b.firstElementChild&&b.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends a.E{constructor(b={}){super();const u=navigator.geolocation;this.options=a.l({geolocation:u},an,b),a.aJ(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ll(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(b){return this._map=b,this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(b){const u=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,b(m)};this._supportsGeolocation!==void 0?b(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(m=>u(m.state!=="denied")).catch(()=>u()):u()}_isOutOfMapMaxBounds(b){const u=this._map.getMaxBounds(),m=b.coords;return!!u&&(m.longitude<u.getWest()||m.longitude>u.getEast()||m.latitude<u.getSouth()||m.latitude>u.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(b){if(this._map){if(this._isOutOfMapMaxBounds(b))return this._setErrorState(),this.fire(new a.x("outofmaxbounds",b)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=b,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(b),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(b),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.x("geolocate",b)),this._finish()}}_updateCamera(b){const u=new a.bK(b.coords.longitude,b.coords.latitude),m=b.coords.accuracy,w=this._map.getBearing(),I=a.l({bearing:w},this.options.fitBoundsOptions);this._map.fitBounds(u.toBounds(m),I,{geolocateSource:!0})}_updateMarker(b){if(b){const u=new a.bK(b.coords.longitude,b.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=b.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const b=this._map.transform,u=a.bD(1,b._center.lat)*b.worldSize,m=Math.ceil(2*this._accuracy*u);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(b){if(this._map){if(this.options.trackUserLocation)if(b.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(b.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new a.x("error",b)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(b){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",u=>u.preventDefault()),this._geolocateButton=M("button","mapboxgl-ctrl-geolocate",this._container),M("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",b===!1){a.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",u),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=M("div","mapboxgl-user-location"),this._dotElement.appendChild(M("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(M("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Nt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=M("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Nt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{u.geolocateSource||this._watchState!=="ACTIVE_LOCK"||u.originalEvent&&u.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.x("trackuserlocationend")))})}}_onDeviceOrientation(b){this._userLocationDotMarker&&(b.webkitCompassHeading?this._heading=b.webkitCompassHeading:b.absolute===!0&&(this._heading=-1*b.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.x("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.x("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.x("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(b={maximumAge:6e5,timeout:0},this._noTimeout=!0):(b=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,b),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const b=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(u=>{u==="granted"&&b()}).catch(console.error):b()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:dt,ScaleControl:class{constructor(b={}){this.options=a.l({},rr,b),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),a.aJ(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const b=this.options.maxWidth||100,u=this._map,m=u._containerHeight/2,w=u._containerWidth/2-b/2,I=u.unproject([w,m]),P=u.unproject([w+b,m]),F=I.distanceTo(P);if(this.options.unit==="imperial"){const W=3.2808*F;W>5280?this._setScale(b,W/5280,"mile"):this._setScale(b,W,"foot")}else this.options.unit==="nautical"?this._setScale(b,F/1852,"nautical-mile"):F>=1e3?this._setScale(b,F/1e3,"kilometer"):this._setScale(b,F,"meter")}_setScale(b,u,m){this._map._requestDomTask(()=>{const w=function(P){const F=Math.pow(10,`${Math.floor(P)}`.length-1);let W=P/F;return W=W>=10?10:W>=5?5:W>=3?3:W>=2?2:W>=1?1:function(q){const J=Math.pow(10,Math.ceil(-Math.log(q)/Math.LN10));return Math.round(q*J)/J}(W),F*W}(u),I=w/u;this._container.innerHTML=this._isNumberFormatSupported&&m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:m}).format(w):`${w}&nbsp;${Rr[m]}`,this._container.style.width=b*I+"px"})}onAdd(b){return this._map=b,this._language=b.getLanguage(),this._container=M("div","mapboxgl-ctrl mapboxgl-ctrl-scale",b.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(b){this._language=b,this._update()}setUnit(b){this.options.unit=b,this._update()}},FullscreenControl:class{constructor(b={}){this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:a.w("Full screen control 'container' must be a DOM element.")),a.aJ(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=M("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const b=this._fullscreenButton=M("button","mapboxgl-ctrl-fullscreen",this._controlContainer);M("span","mapboxgl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",b)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.E{constructor(b){super(),this.options=a.l(Object.create(vi),b),a.aJ(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(b&&b.className?b.className.trim().split(/\s+/):[])}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&b.on("preclick",this._onClose),this.options.closeOnMove&&b.on("move",this._onClose),b.on("remove",this.remove),this._update(),b._addPopup(this),this._focusFirstElement(),this._trackPointer?(b.on("mousemove",this._onMouseEvent),b.on("mouseup",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")):b.on("move",this._update),this.fire(new a.x("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const b=this._map;return b&&(b.off("move",this._update),b.off("move",this._onClose),b.off("preclick",this._onClose),b.off("click",this._onClose),b.off("remove",this.remove),b.off("mousemove",this._onMouseEvent),b.off("mouseup",this._onMouseEvent),b.off("drag",this._onMouseEvent),b._canvasContainer&&b._canvasContainer.classList.remove("mapboxgl-track-pointer"),b._removePopup(this),this._map=void 0),this.fire(new a.x("close")),this}getLngLat(){return this._lngLat}setLngLat(b){this._lngLat=a.bK.convert(b),this._pos=null,this._trackPointer=!1,this._update();const u=this._map;return u&&(u.on("move",this._update),u.off("mousemove",this._onMouseEvent),u._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const b=this._map;return b&&(b.off("move",this._update),b.on("mousemove",this._onMouseEvent),b.on("drag",this._onMouseEvent),b._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const u=document.createDocumentFragment(),m=document.createElement("body");let w;for(m.innerHTML=b;w=m.firstChild,w;)u.appendChild(w);return this.setDOMContent(u)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){let u=this._content;if(u)for(;u.hasChildNodes();)u.firstChild&&u.removeChild(u.firstChild);else u=this._content=M("div","mapboxgl-popup-content",this._container||void 0);if(u.appendChild(b),this.options.closeButton){const m=this._closeButton=M("button","mapboxgl-popup-close-button",u);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(b){return this._classList.add(b),this._updateClassList(),this}removeClassName(b){return this._classList.delete(b),this._updateClassList(),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){let u;return this._classList.delete(b)?u=!1:(this._classList.add(b),u=!0),this._updateClassList(),u}_onMouseEvent(b){this._update(b.point)}_getAnchor(b){if(this.options.anchor)return this.options.anchor;const u=this._map,m=this._container,w=this._pos;if(!u||!m||!w)return"bottom";const I=m.offsetWidth,P=m.offsetHeight,F=w.x<I/2,W=w.x>u.transform.width-I/2;if(w.y+b<P)return F?"top-left":W?"top-right":"top";if(w.y>u.transform.height-P){if(F)return"bottom-left";if(W)return"bottom-right"}return F?"left":W?"right":"bottom"}_updateClassList(){const b=this._container;if(!b)return;const u=[...this._classList];u.push("mapboxgl-popup"),this._anchor&&u.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&u.push("mapboxgl-popup-track-pointer"),b.className=u.join(" ")}_update(b){const u=this._map,m=this._content;if(!u||!this._lngLat&&!this._trackPointer||!m)return;let w=this._container;if(w||(w=this._container=M("div","mapboxgl-popup",u.getContainer()),this._tip=M("div","mapboxgl-popup-tip",w),w.appendChild(m)),this.options.maxWidth&&w.style.maxWidth!==this.options.maxWidth&&(w.style.maxWidth=this.options.maxWidth),u.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=fa(this._lngLat,this._pos,u.transform)),!this._trackPointer||b){const I=this._pos=this._trackPointer&&b instanceof a.P?b:u.project(this._lngLat),P=zi(this.options.offset),F=this._anchor=this._getAnchor(P.y),W=zi(this.options.offset,F),q=I.add(W).round();u._requestDomTask(()=>{this._container&&F&&(this._container.style.transform=`${$t[F]} translate(${q.x}px,${q.y}px)`)})}if(!this._marker&&u._showingGlobe()){const I=a.dz(u.transform,this._lngLat)?0:1;this._setOpacity(I)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(li);b&&b.focus()}_onClose(){this.remove()}_setOpacity(b){this._container&&(this._container.style.opacity=`${b}`),this._content&&(this._content.style.pointerEvents=b?"auto":"none")}},Marker:Nt,Style:Fo,LngLat:a.bK,LngLatBounds:a.as,Point:a.P,MercatorCoordinate:a.a5,FreeCameraOptions:xa,Evented:a.E,config:a.e,prewarm:a.dE,clearPrewarmedResources:a.dF,get accessToken(){return a.e.ACCESS_TOKEN},set accessToken(b){a.e.ACCESS_TOKEN=b},get baseApiUrl(){return a.e.API_URL},set baseApiUrl(b){a.e.API_URL=b},get workerCount(){return a.dG.workerCount},set workerCount(b){a.dG.workerCount=b},get maxParallelImageRequests(){return a.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(b){a.e.MAX_PARALLEL_IMAGE_REQUESTS=b},clearStorage(b){a.dH(b)},get workerUrl(){return a.dI.workerUrl},set workerUrl(b){a.dI.workerUrl=b},get workerClass(){return a.dI.workerClass},set workerClass(b){a.dI.workerClass=b},get workerParams(){return a.dI.workerParams},set workerParams(b){a.dI.workerParams=b},get dracoUrl(){return a.dJ()},set dracoUrl(b){a.dK(b)},get meshoptUrl(){return a.dL()},set meshoptUrl(b){a.dM(b)},setNow:a.q.setNow,restoreNow:a.q.restoreNow}});var l=s;return l})})(qce);var G6e=qce.exports;const Ov=zL(G6e),V6e=()=>{const n=Ae.useRef(null),e=Ae.useRef(null),t={lng:-74.5,lat:40,zoom:9,bearing:0,pitch:0},[r,i]=Ae.useState(t),s=()=>{e.current.flyTo({center:[t.lng,t.lat],zoom:t.zoom,bearing:t.bearing,pitch:t.pitch})};return Ae.useEffect(()=>(Ov.accessToken="pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2t5azNveG05MnRwdTJ4bzhxM2JmNGg3aCJ9.giuzL5T9qkSSl9EWMUK9dg",e.current=new Ov.Map({container:n.current,center:[r.lng,r.lat],zoom:r.zoom,bearing:r.bearing,pitch:r.pitch}),e.current&&e.current.on("move",()=>{const o=e.current.getCenter();i({...r,lng:o.lng,lat:o.lat})}),e.current&&e.current.on("zoom",()=>{const o=e.current.getZoom();i({...r,zoom:o})}),e.current&&e.current.on("rotate",()=>{const o=e.current.getBearing();i({...r,bearing:o})}),e.current&&e.current.on("pitch",()=>{const o=e.current.getPitch();i({...r,pitch:o})}),()=>{e.current.remove()}),[]),me.jsxs("div",{children:[me.jsxs("div",{className:"absolute bottom-0 left-0 m-1 p-1 rounded-md bg-black-500 text-white z-10",children:["Longitude: ",r.lng.toFixed(4)," | Latitude: ",r.lat.toFixed(4)," | Zoom: ",r.zoom.toFixed(2)," | Bearing: ",r.bearing.toFixed(2)," | Pitch: ",r.pitch.toFixed(2),me.jsx("button",{className:"ml-6 bg-slate-500 rounded-md",onClick:s,children:"RESET"})]}),me.jsx("div",{className:"w-screen h-screen z-0",ref:n})]})};(function(){if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function n(k){try{return k.defaultView&&k.defaultView.frameElement||null}catch{return null}}var e=function(k){for(var H=k,X=n(H);X;)H=X.ownerDocument,X=n(H);return H}(window.document),t=[],r=null,i=null;function s(k){this.time=k.time,this.target=k.target,this.rootBounds=S(k.rootBounds),this.boundingClientRect=S(k.boundingClientRect),this.intersectionRect=S(k.intersectionRect||y()),this.isIntersecting=!!k.intersectionRect;var H=this.boundingClientRect,X=H.width*H.height,Z=this.intersectionRect,Q=Z.width*Z.height;X?this.intersectionRatio=Number((Q/X).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function o(k,H){var X=H||{};if(typeof k!="function")throw new Error("callback must be a function");if(X.root&&X.root.nodeType!=1&&X.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=a(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=k,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(X.rootMargin),this.thresholds=this._initThresholds(X.threshold),this.root=X.root||null,this.rootMargin=this._rootMarginValues.map(function(Z){return Z.value+Z.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}o.prototype.THROTTLE_TIMEOUT=100,o.prototype.POLL_INTERVAL=null,o.prototype.USE_MUTATION_OBSERVER=!0,o._setupCrossOriginUpdater=function(){return r||(r=function(k,H){!k||!H?i=y():i=C(k,H),t.forEach(function(X){X._checkForIntersections()})}),r},o._resetCrossOriginUpdater=function(){r=null,i=null},o.prototype.observe=function(k){var H=this._observationTargets.some(function(X){return X.element==k});if(!H){if(!(k&&k.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:k,entry:null}),this._monitorIntersections(k.ownerDocument),this._checkForIntersections()}},o.prototype.unobserve=function(k){this._observationTargets=this._observationTargets.filter(function(H){return H.element!=k}),this._unmonitorIntersections(k.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},o.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},o.prototype.takeRecords=function(){var k=this._queuedEntries.slice();return this._queuedEntries=[],k},o.prototype._initThresholds=function(k){var H=k||[0];return Array.isArray(H)||(H=[H]),H.sort().filter(function(X,Z,Q){if(typeof X!="number"||isNaN(X)||X<0||X>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return X!==Q[Z-1]})},o.prototype._parseRootMargin=function(k){var H=k||"0px",X=H.split(/\s+/).map(function(Z){var Q=/^(-?\d*\.?\d+)(px|%)$/.exec(Z);if(!Q)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(Q[1]),unit:Q[2]}});return X[1]=X[1]||X[0],X[2]=X[2]||X[0],X[3]=X[3]||X[1],X},o.prototype._monitorIntersections=function(k){var H=k.defaultView;if(H&&this._monitoringDocuments.indexOf(k)==-1){var X=this._checkForIntersections,Z=null,Q=null;this.POLL_INTERVAL?Z=H.setInterval(X,this.POLL_INTERVAL):(h(H,"resize",X,!0),h(k,"scroll",X,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in H&&(Q=new H.MutationObserver(X),Q.observe(k,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(k),this._monitoringUnsubscribes.push(function(){var oe=k.defaultView;oe&&(Z&&oe.clearInterval(Z),f(oe,"resize",X,!0)),f(k,"scroll",X,!0),Q&&Q.disconnect()});var re=this.root&&(this.root.ownerDocument||this.root)||e;if(k!=re){var ie=n(k);ie&&this._monitorIntersections(ie.ownerDocument)}}},o.prototype._unmonitorIntersections=function(k){var H=this._monitoringDocuments.indexOf(k);if(H!=-1){var X=this.root&&(this.root.ownerDocument||this.root)||e,Z=this._observationTargets.some(function(ie){var oe=ie.element.ownerDocument;if(oe==k)return!0;for(;oe&&oe!=X;){var fe=n(oe);if(oe=fe&&fe.ownerDocument,oe==k)return!0}return!1});if(!Z){var Q=this._monitoringUnsubscribes[H];if(this._monitoringDocuments.splice(H,1),this._monitoringUnsubscribes.splice(H,1),Q(),k!=X){var re=n(k);re&&this._unmonitorIntersections(re.ownerDocument)}}}},o.prototype._unmonitorAllIntersections=function(){var k=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var H=0;H<k.length;H++)k[H]()},o.prototype._checkForIntersections=function(){if(!(!this.root&&r&&!i)){var k=this._rootIsInDom(),H=k?this._getRootRect():y();this._observationTargets.forEach(function(X){var Z=X.element,Q=v(Z),re=this._rootContainsTarget(Z),ie=X.entry,oe=k&&re&&this._computeTargetAndRootIntersection(Z,Q,H),fe=null;this._rootContainsTarget(Z)?(!r||this.root)&&(fe=H):fe=y();var Se=X.entry=new s({time:l(),target:Z,boundingClientRect:Q,rootBounds:fe,intersectionRect:oe});ie?k&&re?this._hasCrossedThreshold(ie,Se)&&this._queuedEntries.push(Se):ie&&ie.isIntersecting&&this._queuedEntries.push(Se):this._queuedEntries.push(Se)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},o.prototype._computeTargetAndRootIntersection=function(k,H,X){if(window.getComputedStyle(k).display!="none"){for(var Z=H,Q=E(k),re=!1;!re&&Q;){var ie=null,oe=Q.nodeType==1?window.getComputedStyle(Q):{};if(oe.display=="none")return null;if(Q==this.root||Q.nodeType==9)if(re=!0,Q==this.root||Q==e)r&&!this.root?!i||i.width==0&&i.height==0?(Q=null,ie=null,Z=null):ie=i:ie=X;else{var fe=E(Q),Se=fe&&v(fe),Ee=fe&&this._computeTargetAndRootIntersection(fe,Se,X);Se&&Ee?(Q=fe,ie=C(Se,Ee)):(Q=null,Z=null)}else{var Ie=Q.ownerDocument;Q!=Ie.body&&Q!=Ie.documentElement&&oe.overflow!="visible"&&(ie=v(Q))}if(ie&&(Z=p(ie,Z)),!Z)break;Q=Q&&E(Q)}return Z}},o.prototype._getRootRect=function(){var k;if(this.root&&!L(this.root))k=v(this.root);else{var H=L(this.root)?this.root:e,X=H.documentElement,Z=H.body;k={top:0,left:0,right:X.clientWidth||Z.clientWidth,width:X.clientWidth||Z.clientWidth,bottom:X.clientHeight||Z.clientHeight,height:X.clientHeight||Z.clientHeight}}return this._expandRectByRootMargin(k)},o.prototype._expandRectByRootMargin=function(k){var H=this._rootMarginValues.map(function(Z,Q){return Z.unit=="px"?Z.value:Z.value*(Q%2?k.width:k.height)/100}),X={top:k.top-H[0],right:k.right+H[1],bottom:k.bottom+H[2],left:k.left-H[3]};return X.width=X.right-X.left,X.height=X.bottom-X.top,X},o.prototype._hasCrossedThreshold=function(k,H){var X=k&&k.isIntersecting?k.intersectionRatio||0:-1,Z=H.isIntersecting?H.intersectionRatio||0:-1;if(X!==Z)for(var Q=0;Q<this.thresholds.length;Q++){var re=this.thresholds[Q];if(re==X||re==Z||re<X!=re<Z)return!0}},o.prototype._rootIsInDom=function(){return!this.root||M(e,this.root)},o.prototype._rootContainsTarget=function(k){var H=this.root&&(this.root.ownerDocument||this.root)||e;return M(H,k)&&(!this.root||H==k.ownerDocument)},o.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},o.prototype._unregisterInstance=function(){var k=t.indexOf(this);k!=-1&&t.splice(k,1)};function l(){return window.performance&&performance.now&&performance.now()}function a(k,H){var X=null;return function(){X||(X=setTimeout(function(){k(),X=null},H))}}function h(k,H,X,Z){typeof k.addEventListener=="function"?k.addEventListener(H,X,Z):typeof k.attachEvent=="function"&&k.attachEvent("on"+H,X)}function f(k,H,X,Z){typeof k.removeEventListener=="function"?k.removeEventListener(H,X,Z):typeof k.detachEvent=="function"&&k.detachEvent("on"+H,X)}function p(k,H){var X=Math.max(k.top,H.top),Z=Math.min(k.bottom,H.bottom),Q=Math.max(k.left,H.left),re=Math.min(k.right,H.right),ie=re-Q,oe=Z-X;return ie>=0&&oe>=0&&{top:X,bottom:Z,left:Q,right:re,width:ie,height:oe}||null}function v(k){var H;try{H=k.getBoundingClientRect()}catch{}return H?(H.width&&H.height||(H={top:H.top,right:H.right,bottom:H.bottom,left:H.left,width:H.right-H.left,height:H.bottom-H.top}),H):y()}function y(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function S(k){return!k||"x"in k?k:{top:k.top,y:k.top,bottom:k.bottom,left:k.left,x:k.left,right:k.right,width:k.width,height:k.height}}function C(k,H){var X=H.top-k.top,Z=H.left-k.left;return{top:X,left:Z,height:H.height,width:H.width,bottom:X+H.height,right:Z+H.width}}function M(k,H){for(var X=H;X;){if(X==k)return!0;X=E(X)}return!1}function E(k){var H=k.parentNode;return k.nodeType==9&&k!=e?n(k):(H&&H.assignedSlot&&(H=H.assignedSlot.parentNode),H&&H.nodeType==11&&H.host?H.host:H)}function L(k){return k&&k.nodeType===9}window.IntersectionObserver=o,window.IntersectionObserverEntry=s})();function H6e(n,e=document){return typeof n=="string"?Array.from(e.querySelectorAll(n)):n instanceof Element?[n]:n instanceof NodeList?Array.from(n):n instanceof Array?n:[]}function j6e(n){const e=document.createElement("div");e.className=`scrollama__debug-step ${n}`,e.style.position="fixed",e.style.left="0",e.style.width="100%",e.style.zIndex="9999",e.style.borderTop="2px solid black",e.style.borderBottom="2px solid black";const t=document.createElement("p");return t.style.position="absolute",t.style.left="0",t.style.height="1px",t.style.width="100%",t.style.borderTop="1px dashed black",e.appendChild(t),document.body.appendChild(e),e}function W6e({id:n,step:e,marginTop:t}){const{index:r,height:i}=e,s=`scrollama__debug-step--${n}-${r}`;let o=document.querySelector(`.${s}`);o||(o=j6e(s)),o.style.top=`${t*-1}px`,o.style.height=`${i}px`,o.querySelector("p").style.top=`${i/2}px`}function $6e(){const n="abcdefghijklmnopqrstuvwxyz",e=Date.now(),t=[];for(let r=0;r<6;r+=1){const i=n[Math.floor(Math.random()*n.length)];t.push(i)}return`${t.join("")}${e}`}function PI(n){console.error(`scrollama error: ${n}`)}function _A(n){return+n.getAttribute("data-scrollama-index")}function X6e(n,e){const t=Math.ceil(n/e),r=[],i=1/t;for(let s=0;s<t+1;s+=1)r.push(s*i);return r}function yN(n){if(typeof n=="string"&&n.indexOf("px")>0){const e=+n.replace("px","");return isNaN(e)?(err("offset value must be in 'px' format. Fallback to 0.5."),{format:"percent",value:.5}):{format:"pixels",value:e}}else if(typeof n=="number"||!isNaN(+n))return n>1&&err("offset value is greater than 1. Fallback to 1."),n<0&&err("offset value is lower than 0. Fallback to 0."),{format:"percent",value:Math.min(Math.max(0,n),1)};return null}function q6e(n){n.forEach(e=>e.node.setAttribute("data-scrollama-index",e.index))}function Z6e(n){const{top:e}=n.getBoundingClientRect(),t=window.pageYOffset,r=document.body.clientTop||0;return e+t-r}let ab,xR,Am;function Yce(n){const e=n?n.scrollTop:window.pageYOffset;ab!==e&&(ab=e,ab>xR?Am="down":ab<xR&&(Am="up"),xR=ab)}function Y6e(n){ab=0,xR=0,document.addEventListener("scroll",()=>Yce(n))}function K6e(){let n={},e=$6e(),t=[],r,i,s,o=0,l=!1,a=!1,h=!1,f=!1,p=[];function v(){n={stepEnter:()=>{},stepExit:()=>{},stepProgress:()=>{}},p=[]}function y(Ie){Ie&&!l&&Se(),!Ie&&l&&X(),l=Ie}function S(Ie,He){const Re=_A(Ie),st=t[Re];He!==void 0&&(st.progress=He);const _e={element:Ie,index:Re,progress:He,direction:Am};st.state==="enter"&&n.stepProgress(_e)}function C(Ie,He=!0){const Re=_A(Ie),st=t[Re],_e={element:Ie,index:Re,direction:Am};st.direction=Am,st.state="enter",p[Re]||n.stepEnter(_e),f&&(p[Re]=!0)}function M(Ie,He=!0){const Re=_A(Ie),st=t[Re];if(!st.state)return!1;const _e={element:Ie,index:Re,direction:Am};a&&(Am==="down"&&st.progress<1?S(Ie,1):Am==="up"&&st.progress>0&&S(Ie,0)),st.direction=Am,st.state="exit",n.stepExit(_e)}function E([Ie]){const He=_A(Ie.target),Re=t[He],st=Ie.target.offsetHeight;st!==Re.height&&(Re.height=st,H(Re),re(Re),Z(Re))}function L([Ie]){Yce(i);const{isIntersecting:He,target:Re}=Ie;He?C(Re):M(Re)}function k([Ie]){const He=_A(Ie.target),Re=t[He],{isIntersecting:st,intersectionRatio:_e,target:We}=Ie;st&&Re.state==="enter"&&S(We,_e)}function H({observers:Ie}){Object.keys(Ie).map(He=>{Ie[He].disconnect()})}function X(){t.forEach(H)}function Z(Ie){const He=new ResizeObserver(E);He.observe(Ie.node),Ie.observers.resize=He}function Q(){t.forEach(Z)}function re(Ie){const He=window.innerHeight,Re=Ie.offset||r,st=Re.format==="pixels"?1:He,_e=Re.value*st,We=Ie.height/2-_e,Ue=Ie.height/2-(He-_e),lt={rootMargin:`${We}px 0px ${Ue}px 0px`,threshold:.5,root:s},Ht=new IntersectionObserver(L,lt);Ht.observe(Ie.node),Ie.observers.step=Ht,h&&W6e({id:e,step:Ie,marginTop:We,marginBottom:Ue})}function ie(){t.forEach(re)}function oe(Ie){const He=window.innerHeight,Re=Ie.offset||r,st=Re.format==="pixels"?1:He,_e=Re.value*st,We=-_e+Ie.height,Ue=_e-He,vt=`${We}px 0px ${Ue}px 0px`,xt=X6e(Ie.height,o),Vt={rootMargin:vt,threshold:xt},lt=new IntersectionObserver(k,Vt);lt.observe(Ie.node),Ie.observers.progress=lt}function fe(){t.forEach(oe)}function Se(){X(),Q(),ie(),a&&fe()}const Ee={};return Ee.setup=({step:Ie,parent:He,offset:Re=.5,threshold:st=4,progress:_e=!1,once:We=!1,debug:Ue=!1,container:vt=void 0,root:xt=null})=>(Y6e(vt),t=H6e(Ie,He).map((Vt,lt)=>({index:lt,direction:void 0,height:Vt.offsetHeight,node:Vt,observers:{},offset:yN(Vt.dataset.offset),top:Z6e(Vt),progress:0,state:void 0})),t.length?(a=_e,f=We,h=Ue,o=Math.max(1,+st),r=yN(Re),i=vt,s=xt,v(),q6e(t),y(!0),Ee):(PI("no step elements"),Ee)),Ee.enable=()=>(y(!0),Ee),Ee.disable=()=>(y(!1),Ee),Ee.destroy=()=>(y(!1),v(),Ee),Ee.resize=()=>(Se(),Ee),Ee.offset=Ie=>Ie==null?r.value:(r=yN(Ie),Se(),Ee),Ee.onStepEnter=Ie=>(typeof Ie=="function"?n.stepEnter=Ie:PI("onStepEnter requires a function"),Ee),Ee.onStepExit=Ie=>(typeof Ie=="function"?n.stepExit=Ie:PI("onStepExit requires a function"),Ee),Ee.onStepProgress=Ie=>(typeof Ie=="function"?n.stepProgress=Ie:PI("onStepProgress requires a function"),Ee),Ee}const Kce="/about_portfolio/assets/first%20period-Cjp1RjP4.jpeg",F5="/about_portfolio/assets/hui-Ao1uY3rr.jpeg",Jce="/about_portfolio/assets/naipiao-BUdMlmen.jpg",S8="/about_portfolio/assets/qindiao-CKTdrbCg.png",Qce="/about_portfolio/assets/quanqiu-DnDfEiIO.jpeg",eue="/about_portfolio/assets/quanqiuhua-CFNf60Po.jpeg",A8="/about_portfolio/assets/sanjuqingan-Bkq-CSnX.png",T8="/about_portfolio/assets/sanyuan-BxeIias_.png",M8="/about_portfolio/assets/sanyuanshangshi-DbcI-flH.jpeg",E8="/about_portfolio/assets/shangshi-CZtwHG4A.jpeg",tue="/about_portfolio/assets/stage2-D7wGlXfP.png",nue="/about_portfolio/assets/Thankyou-DonPtijT.jpeg",rue="/about_portfolio/assets/zhiliang-CZ_P7IVS.jpeg",J6e="pk.eyJ1IjoibGlua2xpbmsiLCJhIjoiY2t5azNveG05MnRwdTJ4bzhxM2JmNGg3aCJ9.giuzL5T9qkSSl9EWMUK9dg",N5=["mapbox://styles/linklink/cm2v9ot6s00fu01pwfs3q147j","mapbox://styles/linklink/cm2fmcw0200bb01ph6edf69ne","mapbox://styles/linklink/cl097w45i001o15mueqt9chmp"],Gl={style:N5[0],showMarkers:!1,markerColor:"#3FB1CE",inset:!0,theme:"dark",use3dTerrain:!0,title:"      ",byline:`



`,footer:'Source: source citations, etc. <br> Created using <a href="https://github.com/mapbox/storytelling" target="_blank">Mapbox Storytelling</a> template.',chapters:[{id:"first-period",alignment:"fully",hidden:!1,title:"",description:'""',image:Kce,location:{center:[122.418398,34.759483],zoom:4.5,pitch:0,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"qindiao",alignment:"right",hidden:!1,title:"",image:S8,description:"&nbsp;&nbsp;&nbsp;&nbsp;1926<br/>&nbsp;&nbsp;&nbsp;&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;</br>&nbsp;&nbsp;&nbsp;&nbsp;10",location:{center:[120.922941,27.893666],zoom:10,pitch:0,bearing:0},mapType:1,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanyuan",alignment:"left",hidden:!1,title:"",image:T8,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;19495<br/>&nbsp;&nbsp;&nbsp;&nbsp;195631",location:{center:[116.489303,39.923409],zoom:10,pitch:8.01,bearing:0},mapType:1,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"first_conclusion",alignment:"fully",hidden:!1,title:"",image:Jce,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;1958<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[116.418398,34.759483],zoom:4.5,pitch:8.01,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"first_map",alignment:"right",hidden:!0,location:{center:[114.418398,34.759483],zoom:4.5,pitch:8.01,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"second-stage",alignment:"fully",hidden:!1,image:tue,description:"&nbsp;&nbsp;&nbsp;&nbsp;1949-1978197897<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;1978<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"zhengce",alignment:"right",title:"",hidden:!1,image:rue,description:"&nbsp;&nbsp;&nbsp;&nbsp;1984719912000",location:{center:[116.70918,40.142585],zoom:7,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"yilishangshi",alignment:"left",title:"",hidden:!1,image:E8,description:"&nbsp;&nbsp;&nbsp;&nbsp;1996312,A",location:{center:[111.74918,40.842585],zoom:10,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"chengli",alignment:"fully",title:"",hidden:!1,image:F5,description:"&nbsp;&nbsp;&nbsp;&nbsp;19901995<br/>&nbsp;&nbsp;&nbsp;&nbsp;19905<br/>&nbsp;&nbsp;&nbsp;&nbsp;19921<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"second-map",alignment:"left",title:"",hidden:!0,image:F5,location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:2,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"third-stage",alignment:"fully",title:"21",hidden:!1,image:Qce,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanyuan2",alignment:"right",title:"",hidden:!1,image:M8,description:"&nbsp;&nbsp;&nbsp;&nbsp;1984<br/>&nbsp;&nbsp;&nbsp;&nbsp;1985<br/>&nbsp;&nbsp;&nbsp;&nbsp;1997<br/>&nbsp;&nbsp;&nbsp;&nbsp;199750%",location:{center:[116.74918,40.842585],zoom:7,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"sanju",alignment:"left",title:"",hidden:!1,image:A8,description:"&nbsp;&nbsp;&nbsp;&nbsp;2008<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[114.586506,38.151115],zoom:7,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"international",alignment:"fully",title:"",hidden:!1,image:eue,description:"<br/>&nbsp;&nbsp;&nbsp;&nbsp;-------------",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:3,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"third-map",alignment:"fully",hidden:!0,location:{center:[114.586506,38.151115],zoom:3,pitch:0,bearing:0},mapType:4,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]},{id:"Thankyou",alignment:"fully",title:"",hidden:!1,image:nue,description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",location:{center:[113.586506,34.751115],zoom:4,pitch:0,bearing:0},mapType:0,mapAnimation:"flyTo",rotateAnimation:!1,callback:"",onChapterEnter:[],onChapterExit:[]}]},iue="/about_portfolio/assets/bashi-j4Q9hrvQ.png",sue="/about_portfolio/assets/bifengtang-yZIlcoLv.jpeg",aue="/about_portfolio/assets/guangming-Ch0sfKFV.png",C8="/about_portfolio/assets/guangze-COXCU3fq.png",oue="/about_portfolio/assets/hongxing-TMciPCkF.png",lue="/about_portfolio/assets/sanyuan2-ek_zenH7.jpeg",cue="/about_portfolio/assets/song-DXjP89Jt.png",uue="/about_portfolio/assets/wandashan-CrxNEfy8.png",hue="/about_portfolio/assets/weigang-CEFEuaeN.png",fue="/about_portfolio/assets/wushilan-CQSBRYUS.jpeg",due="/about_portfolio/assets/xiaoxiniu-CJwZNYCM.jpeg",pue="/about_portfolio/assets/xiyuchun-BftcuwaV.png",mue="/about_portfolio/assets/yili-xXFaKPoe.jpeg",gue="/about_portfolio/assets/youzhiyou-DEWmaBTZ.jpeg";var Q6e={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[120.722941,27.793666]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1926<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:S8,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.489303,39.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;19495<br/>&nbsp;&nbsp;&nbsp;&nbsp;195631",image:T8,imageHeight:130,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[121.419303,30.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:aue,imageHeight:200,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[129.589303,44.603409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952<br/>&nbsp;&nbsp;&nbsp;&nbsp;50-80",image:oue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[118.847752,32.046235]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1928<br/>&nbsp;&nbsp;&nbsp;&nbsp;75,<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:cue,imageHeight:130,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[87.419303,43.923409]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1955<br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;60,",image:pue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[126.686109,45.738561]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1958<br/>&nbsp;&nbsp;&nbsp;&nbsp;101963750",image:uue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[110.9736,41.1272]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1956<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:mue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.308198,39.869373]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1952,<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:iue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[117.318198,39.259373]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19588<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:C8,imageHeight:100,imageWidth:220}}]},eGe={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[111.74918,40.842585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1996312,A<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:E8,imageHeight:120,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[118.847752,32.046235]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19491983",image:hue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[121.586506,38.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2001",image:C8,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.70918,40.142585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;199750%20012003",image:lue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[114.70918,30.142585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;19986499<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:sue,imageHeight:100,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[110.586506,31.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1998",image:gue,imageHeight:200,imageWidth:200}},{type:"Feature",geometry:{type:"Point",coordinates:[123.586506,23.151115]},properties:{title:"50",description:"&nbsp;&nbsp;&nbsp;&nbsp;501994",image:fue,imageHeight:200,imageWidth:180}},{type:"Feature",geometry:{type:"Point",coordinates:[101.586506,36.751115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2002",image:due,imageHeight:200,imageWidth:200}}]},tGe={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[114.586506,38.151115]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;2008<br/>&nbsp;&nbsp;&nbsp;&nbsp;",image:A8,imageHeight:170,imageWidth:220}},{type:"Feature",geometry:{type:"Point",coordinates:[116.74918,40.842585]},properties:{title:"",description:"&nbsp;&nbsp;&nbsp;&nbsp;1984<br/>&nbsp;&nbsp;&nbsp;&nbsp;1985<br/>&nbsp;&nbsp;&nbsp;&nbsp;1997<br/>&nbsp;&nbsp;&nbsp;&nbsp;199750%",image:M8,imageHeight:120,imageWidth:220}}]},nGe={type:"FeatureCollection",features:[]};const rGe=[null,Q6e,eGe,tGe,nGe],iGe=()=>{const n=Ae.useRef(null);let e=Ae.useRef(null);const t=Ae.useRef(null),r=Ae.useRef(null),i=Ae.useRef(null);let s=!0,o=[],l=0;const a={fill:["fill-opacity"],line:["line-opacity"],circle:["circle-opacity","circle-stroke-opacity"],symbol:["icon-opacity","text-opacity"],raster:["raster-opacity"],"fill-extrusion":["fill-extrusion-opacity"],heatmap:["heatmap-opacity"]},h={left:"lefty",center:"centered",right:"righty",full:"fully"},f=M=>{let E=n.current.getLayer(M).type;return a[E]},p=M=>{f(M.layer).forEach(L=>{let k={};if(M.duration){let H=L+"-transition";k={duration:M.duration},n.current.setPaintProperty(M.layer,H,k)}n.current.setPaintProperty(M.layer,L,M.opacity,k)})},v=M=>{const L=M.indexOf("?")!==-1?"&pluginName=scrollytellingV2":"?pluginName=scrollytellingV2";return{url:M+L}},y=M=>{e.current.addSource("boundsSource",{type:"geojson",data:M}),e.current.addLayer({id:"boundsLayer",type:"fill",source:"boundsSource",layout:{},paint:{"fill-color":"#fff","fill-opacity":.2}}),e.current.addLayer({id:"outlineLayer",type:"line",source:"boundsSource",layout:{},paint:{"line-color":"#000","line-width":1}})},S=M=>{e.current.getSource("boundsSource").setData(M)},C=()=>{let M=n.current.getBounds(),E={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[[M._sw.lng,M._sw.lat],[M._ne.lng,M._sw.lat],[M._ne.lng,M._ne.lat],[M._sw.lng,M._ne.lat],[M._sw.lng,M._sw.lat]]]}}]};s?(y(E),s=!1):S(E)};return Ae.useEffect(()=>{Ov.accessToken=J6e,n.current=new Ov.Map({container:r.current,style:N5[l],center:Gl.chapters[0].location.center,zoom:Gl.chapters[0].location.zoom,bearing:Gl.chapters[0].location.bearing,pitch:Gl.chapters[0].location.pitch,interactive:!0,transformRequest:v,projection:Gl.projection});const M=new Ov.NavigationControl({showCompass:!0,showZoom:!0});n.current.addControl(M,"top-left"),e.current=new Ov.Map({container:t.current,style:"mapbox://styles/mapbox/dark-v10",center:Gl.chapters[0].location.center,zoom:3,hash:!1,interactive:!1,attributionControl:!1});let E=K6e();n.current.on("load",()=>{n.current.addSource("mapbox-dem",{type:"raster-dem",url:"mapbox://mapbox.mapbox-terrain-dem-v1",tileSize:512,maxzoom:14}),n.current.setTerrain({source:"mapbox-dem",exaggeration:1.5}),n.current.addLayer({id:"sky",type:"sky",paint:{"sky-type":"atmosphere","sky-atmosphere-sun":[0,0],"sky-atmosphere-sun-intensity":15}}),n.current.on("move",C),n.current.dragPan.enable(),n.current.keyboard.enable(),E.setup({step:".step",offset:.5}).onStepEnter(L=>{const k=Gl.chapters.find(H=>H.id===L.element.id);if(L.element.classList.add("active"),n.current[k.mapAnimation||"flyTo"](k.location),k.mapType!==l&&(l=k.mapType,l!==0)){if(n.current.setStyle(N5[l]),o!==null)for(let H=o.length-1;H>=0;H--)o[H].remove();for(let H of rGe[l].features){let X=document.createElement("div");X.className="marker",X.style.backgroundImage="url("+H.properties.image+")",X.style.height="50px",X.style.width="50px",o.push(new Ov.Marker(X).setLngLat(H.geometry.coordinates).setPopup(new Ov.Popup({closeButton:!1,offset:25}).setHTML(`<h3>${H.properties.title}</h3><img src=${H.properties.image} height=${H.properties.imageHeight} width=${H.properties.imageWidth}><p>${H.properties.description}</p>`)).addTo(n.current))}}k.location.zoom<5?e.current.flyTo({center:k.location.center,zoom:0}):e.current.flyTo({center:k.location.center,zoom:3}),k.onChapterEnter.length>0&&k.onChapterEnter.forEach(p),k.callback&&window[k.callback](),k.rotateAnimation&&n.current.once("moveend",()=>{const H=n.current.getBearing();n.current.rotateTo(H+180,{duration:3e4,easing:function(X){return X}})})}).onStepExit(L=>{console.log(n.current.getStyle().layers);let k=Gl.chapters.find(H=>H.id===L.element.id);L.element.classList.remove("active"),k.onChapterExit.length>0&&k.onChapterExit.forEach(p)})})},[]),me.jsxs("div",{className:"w-screen h-screen",children:[me.jsx("div",{className:"w-full h-full fixed",ref:r}),me.jsx("div",{className:"top-20 right-4 h-40 w-60 fixed pointer-events-none transition-opacity ease-in-out",ref:t}),me.jsxs("div",{className:"box-content",ref:i,children:[me.jsxs("div",{className:`z-5 top-20 full-bar relative ${Gl.theme}`,children:[me.jsxs("h1",{className:"m-0 p-4 text-center leading-8",children:[" ",Gl.title," "]}),Gl.subtitle&&me.jsx("h2",{className:"m-0 p-4 text-center",children:Gl.subtitle}),me.jsx("p",{className:"m-0 p-4 text-center leading-8",children:Gl.byline})]}),me.jsx("div",{className:"z-5 w-full relative",children:Gl.chapters.map((M,E)=>me.jsxs("div",{id:M.id,className:`p-4 dark step card ${E===0?"active":""} ${M.hidden?"hidden":""} ${h[M.alignment]||"centered"}`,children:[M.title&&me.jsx("h2",{children:M.title}),M.image&&me.jsx("img",{src:M.image,alt:M.title}),M.description&&me.jsx("p",{children:M.description})]},E))}),me.jsx("p",{className:`w-full min-h-5 py-2 text-center text-sm ${Gl.theme}`,children:Gl.footer})]})]})},sGe=()=>me.jsxs("div",{className:"absolute top-20 w-full",children:[me.jsx("h1",{className:"font-bold text-3xl text-center",children:"HTML+CSS  "}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),me.jsxs("div",{className:"barGraph",children:[me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{})]}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),me.jsxs("div",{className:"pieGraph",children:[me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{}),me.jsx("div",{})]})]}),aGe="China",oGe=[{name:"",children:[{name:"",children:[{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""}]},{name:"",children:[{name:""}]}]},{name:"",children:[{name:"",children:[{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""},{name:""}]},{name:"",children:[{name:""},{name:""}]}]}],lGe={name:aGe,children:oGe};function cGe(n){var e=0,t=n.children,r=t&&t.length;if(!r)e=1;else for(;--r>=0;)e+=t[r].value;n.value=e}function uGe(){return this.eachAfter(cGe)}function hGe(n,e){let t=-1;for(const r of this)n.call(e,r,++t,this);return this}function fGe(n,e){for(var t=this,r=[t],i,s,o=-1;t=r.pop();)if(n.call(e,t,++o,this),i=t.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function dGe(n,e){for(var t=this,r=[t],i=[],s,o,l,a=-1;t=r.pop();)if(i.push(t),s=t.children)for(o=0,l=s.length;o<l;++o)r.push(s[o]);for(;t=i.pop();)n.call(e,t,++a,this);return this}function pGe(n,e){let t=-1;for(const r of this)if(n.call(e,r,++t,this))return r}function mGe(n){return this.eachAfter(function(e){for(var t=+n(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)t+=r[i].value;e.value=t})}function gGe(n){return this.eachBefore(function(e){e.children&&e.children.sort(n)})}function vGe(n){for(var e=this,t=_Ge(e,n),r=[e];e!==t;)e=e.parent,r.push(e);for(var i=r.length;n!==t;)r.splice(i,0,n),n=n.parent;return r}function _Ge(n,e){if(n===e)return n;var t=n.ancestors(),r=e.ancestors(),i=null;for(n=t.pop(),e=r.pop();n===e;)i=n,n=t.pop(),e=r.pop();return i}function yGe(){for(var n=this,e=[n];n=n.parent;)e.push(n);return e}function xGe(){return Array.from(this)}function bGe(){var n=[];return this.eachBefore(function(e){e.children||n.push(e)}),n}function wGe(){var n=this,e=[];return n.each(function(t){t!==n&&e.push({source:t.parent,target:t})}),e}function*SGe(){var n=this,e,t=[n],r,i,s;do for(e=t.reverse(),t=[];n=e.pop();)if(yield n,r=n.children)for(i=0,s=r.length;i<s;++i)t.push(r[i]);while(t.length)}function I8(n,e){n instanceof Map?(n=[void 0,n],e===void 0&&(e=MGe)):e===void 0&&(e=TGe);for(var t=new xL(n),r,i=[t],s,o,l,a;r=i.pop();)if((o=e(r.data))&&(a=(o=Array.from(o)).length))for(r.children=o,l=a-1;l>=0;--l)i.push(s=o[l]=new xL(o[l])),s.parent=r,s.depth=r.depth+1;return t.eachBefore(CGe)}function AGe(){return I8(this).eachBefore(EGe)}function TGe(n){return n.children}function MGe(n){return Array.isArray(n)?n[1]:null}function EGe(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function CGe(n){var e=0;do n.height=e;while((n=n.parent)&&n.height<++e)}function xL(n){this.data=n,this.depth=this.height=0,this.parent=null}xL.prototype=I8.prototype={constructor:xL,count:uGe,each:hGe,eachAfter:dGe,eachBefore:fGe,find:pGe,sum:mGe,sort:gGe,path:vGe,ancestors:yGe,descendants:xGe,leaves:bGe,links:wGe,copy:AGe,[Symbol.iterator]:SGe};function IGe(n){return n==null?null:RGe(n)}function RGe(n){if(typeof n!="function")throw new Error;return n}function rJ(){return 0}function PGe(n){return function(){return n}}const LGe=1664525,DGe=1013904223,iJ=4294967296;function BGe(){let n=1;return()=>(n=(LGe*n+DGe)%iJ)/iJ}function kGe(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function OGe(n,e){let t=n.length,r,i;for(;t;)i=e()*t--|0,r=n[t],n[t]=n[i],n[i]=r;return n}function FGe(n,e){for(var t=0,r=(n=OGe(Array.from(n),e)).length,i=[],s,o;t<r;)s=n[t],o&&vue(o,s)?++t:(o=zGe(i=NGe(i,s)),t=0);return o}function NGe(n,e){var t,r;if(xN(e,n))return[e];for(t=0;t<n.length;++t)if(LI(e,n[t])&&xN(UA(n[t],e),n))return[n[t],e];for(t=0;t<n.length-1;++t)for(r=t+1;r<n.length;++r)if(LI(UA(n[t],n[r]),e)&&LI(UA(n[t],e),n[r])&&LI(UA(n[r],e),n[t])&&xN(_ue(n[t],n[r],e),n))return[n[t],n[r],e];throw new Error}function LI(n,e){var t=n.r-e.r,r=e.x-n.x,i=e.y-n.y;return t<0||t*t<r*r+i*i}function vue(n,e){var t=n.r-e.r+Math.max(n.r,e.r,1)*1e-9,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function xN(n,e){for(var t=0;t<e.length;++t)if(!vue(n,e[t]))return!1;return!0}function zGe(n){switch(n.length){case 1:return UGe(n[0]);case 2:return UA(n[0],n[1]);case 3:return _ue(n[0],n[1],n[2])}}function UGe(n){return{x:n.x,y:n.y,r:n.r}}function UA(n,e){var t=n.x,r=n.y,i=n.r,s=e.x,o=e.y,l=e.r,a=s-t,h=o-r,f=l-i,p=Math.sqrt(a*a+h*h);return{x:(t+s+a/p*f)/2,y:(r+o+h/p*f)/2,r:(p+i+l)/2}}function _ue(n,e,t){var r=n.x,i=n.y,s=n.r,o=e.x,l=e.y,a=e.r,h=t.x,f=t.y,p=t.r,v=r-o,y=r-h,S=i-l,C=i-f,M=a-s,E=p-s,L=r*r+i*i-s*s,k=L-o*o-l*l+a*a,H=L-h*h-f*f+p*p,X=y*S-v*C,Z=(S*H-C*k)/(X*2)-r,Q=(C*M-S*E)/X,re=(y*k-v*H)/(X*2)-i,ie=(v*E-y*M)/X,oe=Q*Q+ie*ie-1,fe=2*(s+Z*Q+re*ie),Se=Z*Z+re*re-s*s,Ee=-(Math.abs(oe)>1e-6?(fe+Math.sqrt(fe*fe-4*oe*Se))/(2*oe):Se/fe);return{x:r+Z+Q*Ee,y:i+re+ie*Ee,r:Ee}}function sJ(n,e,t){var r=n.x-e.x,i,s,o=n.y-e.y,l,a,h=r*r+o*o;h?(s=e.r+t.r,s*=s,a=n.r+t.r,a*=a,s>a?(i=(h+a-s)/(2*h),l=Math.sqrt(Math.max(0,a/h-i*i)),t.x=n.x-i*r-l*o,t.y=n.y-i*o+l*r):(i=(h+s-a)/(2*h),l=Math.sqrt(Math.max(0,s/h-i*i)),t.x=e.x+i*r-l*o,t.y=e.y+i*o+l*r)):(t.x=e.x+t.r,t.y=e.y)}function aJ(n,e){var t=n.r+e.r-1e-6,r=e.x-n.x,i=e.y-n.y;return t>0&&t*t>r*r+i*i}function oJ(n){var e=n._,t=n.next._,r=e.r+t.r,i=(e.x*t.r+t.x*e.r)/r,s=(e.y*t.r+t.y*e.r)/r;return i*i+s*s}function DI(n){this._=n,this.next=null,this.previous=null}function GGe(n,e){if(!(s=(n=kGe(n)).length))return 0;var t,r,i,s,o,l,a,h,f,p,v;if(t=n[0],t.x=0,t.y=0,!(s>1))return t.r;if(r=n[1],t.x=-r.r,r.x=t.r,r.y=0,!(s>2))return t.r+r.r;sJ(r,t,i=n[2]),t=new DI(t),r=new DI(r),i=new DI(i),t.next=i.previous=r,r.next=t.previous=i,i.next=r.previous=t;e:for(a=3;a<s;++a){sJ(t._,r._,i=n[a]),i=new DI(i),h=r.next,f=t.previous,p=r._.r,v=t._.r;do if(p<=v){if(aJ(h._,i._)){r=h,t.next=r,r.previous=t,--a;continue e}p+=h._.r,h=h.next}else{if(aJ(f._,i._)){t=f,t.next=r,r.previous=t,--a;continue e}v+=f._.r,f=f.previous}while(h!==f.next);for(i.previous=t,i.next=r,t.next=r.previous=r=i,o=oJ(t);(i=i.next)!==r;)(l=oJ(i))<o&&(t=i,o=l);r=t.next}for(t=[r._],i=r;(i=i.next)!==r;)t.push(i._);for(i=FGe(t,e),a=0;a<s;++a)t=n[a],t.x-=i.x,t.y-=i.y;return i.r}function VGe(n){return Math.sqrt(n.value)}function HGe(){var n=null,e=1,t=1,r=rJ;function i(s){const o=BGe();return s.x=e/2,s.y=t/2,n?s.eachBefore(lJ(n)).eachAfter(bN(r,.5,o)).eachBefore(cJ(1)):s.eachBefore(lJ(VGe)).eachAfter(bN(rJ,1,o)).eachAfter(bN(r,s.r/Math.min(e,t),o)).eachBefore(cJ(Math.min(e,t)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(n=IGe(s),i):n},i.size=function(s){return arguments.length?(e=+s[0],t=+s[1],i):[e,t]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:PGe(+s),i):r},i}function lJ(n){return function(e){e.children||(e.r=Math.max(0,+n(e)||0))}}function bN(n,e,t){return function(r){if(i=r.children){var i,s,o=i.length,l=n(r)*e||0,a;if(l)for(s=0;s<o;++s)i[s].r+=l;if(a=GGe(i,t),l)for(s=0;s<o;++s)i[s].r-=l;r.r=a+l}}}function cJ(n){return function(e){var t=e.parent;e.r*=n,t&&(e.x=t.x+n*e.x,e.y=t.y+n*e.y)}}function GA(n,e,t){this.k=n,this.x=e,this.y=t}GA.prototype={constructor:GA,scale:function(n){return n===1?this:new GA(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new GA(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};GA.prototype;const jGe=()=>{const n=Ae.useRef(null),e=Ae.useRef(null);return Ae.useEffect(()=>{const t=n.current.getContext("2d");t.save();const r=[n.current.width,n.current.height],i=[100,100];t.fillStyle="red",t.translate(-.5*i[0],-.5*i[1]),t.beginPath(),t.rect(.5*r[0],.5*r[1],i[0],i[1]),t.fill(),t.restore();const s=e.current.getContext("2d"),o=[e.current.width,e.current.height],l=I8(lGe).sum(v=>1).sort((v,y)=>y.value-v.value);console.log(l);const h=HGe().size(o).padding(3)(l),f=2*Math.PI,p=(v,y,{fillStyle:S="rgba(0,0,0,0.2)",textColor:C="white"}={})=>{const M=y.children;if(v.fillStyle=S,v.beginPath(),v.arc(y.x,y.y,y.r,0,f),v.fill(),M)for(const E of M)p(v,E);else{const E=y.data.name;v.fillStyle=C,v.font="1rem Aerial",v.textAlign="center",v.fillText(E,y.x,y.y)}};console.log(h.children),p(s,h)},[]),me.jsxs("div",{className:"absolute top-20 w-full",children:[me.jsx("h1",{className:"font-bold text-3xl text-center",children:"canvas "}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:""}),me.jsx("canvas",{ref:n,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(hierarchy)"}),me.jsx("canvas",{ref:e,width:1024,height:1024,className:"ml-3 border-2 border-black-500 border-solid"})]})},WGe=()=>{const n=Ae.useRef(null),e=Ae.useRef(null);let t;const r=`
    attribute vec2 position;
    void main() {
      gl_Position = vec4(position, 1.0, 1.0);
    }
  `,i=`
    precision mediump float;
    void main() {
      gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
    }
  `,s=`
    attribute vec2 position;
    varying vec3 color;
    void main() {
      color = vec3(0.5 + position, 0.0);
      gl_Position = vec4(position, 1.0, 1.0);
    }
  `,o=`
    precision mediump float;
    varying vec3 color;
    void main() {
      gl_FragColor = vec4(color, 1.0);
    }
  `;let l;const a=(v,y,S)=>{t=v.getContext("webgl");const C=t.createShader(t.VERTEX_SHADER);t.shaderSource(C,y),t.compileShader(C),t.getShaderParameter(C,t.COMPILE_STATUS)||console.error("Vertex shader compilation failed:",t.getShaderInfoLog(C));const M=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(M,S),t.compileShader(M),t.getShaderParameter(M,t.COMPILE_STATUS)||console.error("Fragment shader compilation failed:",t.getShaderInfoLog(M)),l=t.createProgram(),t.attachShader(l,C),t.attachShader(l,M),t.linkProgram(l),t.getProgramParameter(l,t.LINK_STATUS)||console.error("Program linking failed:",t.getProgramInfoLog(l)),t.useProgram(l)},h=new Float32Array([-1,-1,0,1,1,-1]),f=()=>{const v=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,v),t.bufferData(t.ARRAY_BUFFER,h,t.STATIC_DRAW);const y=t.getAttribLocation(l,"position");t.vertexAttribPointer(y,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(y)},p=()=>{t.clear(t.COLOR_BUFFER_BIT),t.drawArrays(t.TRIANGLES,0,h.length/2)};return Ae.useEffect(()=>{a(n.current,r,i),f(),p(),a(e.current,s,o),f(),p()},[]),me.jsxs("div",{className:"absolute top-20 w-full flex",children:[me.jsx("canvas",{ref:n,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"}),me.jsx("canvas",{ref:e,width:512,height:512,className:"ml-3 border-2 border-black-500 border-solid"})]})};function wN(n,e,t){if(n&&n.length){const[r,i]=e,s=Math.PI/180*t,o=Math.cos(s),l=Math.sin(s);for(const a of n){const[h,f]=a;a[0]=(h-r)*o-(f-i)*l+r,a[1]=(h-r)*l+(f-i)*o+i}}}function $Ge(n,e){return n[0]===e[0]&&n[1]===e[1]}function XGe(n,e,t,r=1){const i=t,s=Math.max(e,.1),o=n[0]&&n[0][0]&&typeof n[0][0]=="number"?[n]:n,l=[0,0];if(i)for(const h of o)wN(h,l,i);const a=function(h,f,p){const v=[];for(const L of h){const k=[...L];$Ge(k[0],k[k.length-1])||k.push([k[0][0],k[0][1]]),k.length>2&&v.push(k)}const y=[];f=Math.max(f,.1);const S=[];for(const L of v)for(let k=0;k<L.length-1;k++){const H=L[k],X=L[k+1];if(H[1]!==X[1]){const Z=Math.min(H[1],X[1]);S.push({ymin:Z,ymax:Math.max(H[1],X[1]),x:Z===H[1]?H[0]:X[0],islope:(X[0]-H[0])/(X[1]-H[1])})}}if(S.sort((L,k)=>L.ymin<k.ymin?-1:L.ymin>k.ymin?1:L.x<k.x?-1:L.x>k.x?1:L.ymax===k.ymax?0:(L.ymax-k.ymax)/Math.abs(L.ymax-k.ymax)),!S.length)return y;let C=[],M=S[0].ymin,E=0;for(;C.length||S.length;){if(S.length){let L=-1;for(let k=0;k<S.length&&!(S[k].ymin>M);k++)L=k;S.splice(0,L+1).forEach(k=>{C.push({s:M,edge:k})})}if(C=C.filter(L=>!(L.edge.ymax<=M)),C.sort((L,k)=>L.edge.x===k.edge.x?0:(L.edge.x-k.edge.x)/Math.abs(L.edge.x-k.edge.x)),(p!==1||E%f==0)&&C.length>1)for(let L=0;L<C.length;L+=2){const k=L+1;if(k>=C.length)break;const H=C[L].edge,X=C[k].edge;y.push([[Math.round(H.x),M],[Math.round(X.x),M]])}M+=p,C.forEach(L=>{L.edge.x=L.edge.x+p*L.edge.islope}),E++}return y}(o,s,r);if(i){for(const h of o)wN(h,l,-i);(function(h,f,p){const v=[];h.forEach(y=>v.push(...y)),wN(v,f,p)})(a,l,-i)}return a}function IE(n,e){var t;const r=e.hachureAngle+90;let i=e.hachureGap;i<0&&(i=4*e.strokeWidth),i=Math.round(Math.max(i,.1));let s=1;return e.roughness>=1&&(((t=e.randomizer)===null||t===void 0?void 0:t.next())||Math.random())>.7&&(s=i),XGe(n,i,r,s||1)}class R8{constructor(e){this.helper=e}fillPolygons(e,t){return this._fillPolygons(e,t)}_fillPolygons(e,t){const r=IE(e,t);return{type:"fillSketch",ops:this.renderLines(r,t)}}renderLines(e,t){const r=[];for(const i of e)r.push(...this.helper.doubleLineOps(i[0][0],i[0][1],i[1][0],i[1][1],t));return r}}function PB(n){const e=n[0],t=n[1];return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}class qGe extends R8{fillPolygons(e,t){let r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.max(r,.1);const i=IE(e,Object.assign({},t,{hachureGap:r})),s=Math.PI/180*t.hachureAngle,o=[],l=.5*r*Math.cos(s),a=.5*r*Math.sin(s);for(const[h,f]of i)PB([h,f])&&o.push([[h[0]-l,h[1]+a],[...f]],[[h[0]+l,h[1]-a],[...f]]);return{type:"fillSketch",ops:this.renderLines(o,t)}}}class ZGe extends R8{fillPolygons(e,t){const r=this._fillPolygons(e,t),i=Object.assign({},t,{hachureAngle:t.hachureAngle+90}),s=this._fillPolygons(e,i);return r.ops=r.ops.concat(s.ops),r}}class YGe{constructor(e){this.helper=e}fillPolygons(e,t){const r=IE(e,t=Object.assign({},t,{hachureAngle:0}));return this.dotsOnLines(r,t)}dotsOnLines(e,t){const r=[];let i=t.hachureGap;i<0&&(i=4*t.strokeWidth),i=Math.max(i,.1);let s=t.fillWeight;s<0&&(s=t.strokeWidth/2);const o=i/4;for(const l of e){const a=PB(l),h=a/i,f=Math.ceil(h)-1,p=a-f*i,v=(l[0][0]+l[1][0])/2-i/4,y=Math.min(l[0][1],l[1][1]);for(let S=0;S<f;S++){const C=y+p+S*i,M=v-o+2*Math.random()*o,E=C-o+2*Math.random()*o,L=this.helper.ellipse(M,E,s,s,t);r.push(...L.ops)}}return{type:"fillSketch",ops:r}}}class KGe{constructor(e){this.helper=e}fillPolygons(e,t){const r=IE(e,t);return{type:"fillSketch",ops:this.dashedLine(r,t)}}dashedLine(e,t){const r=t.dashOffset<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashOffset,i=t.dashGap<0?t.hachureGap<0?4*t.strokeWidth:t.hachureGap:t.dashGap,s=[];return e.forEach(o=>{const l=PB(o),a=Math.floor(l/(r+i)),h=(l+i-a*(r+i))/2;let f=o[0],p=o[1];f[0]>p[0]&&(f=o[1],p=o[0]);const v=Math.atan((p[1]-f[1])/(p[0]-f[0]));for(let y=0;y<a;y++){const S=y*(r+i),C=S+r,M=[f[0]+S*Math.cos(v)+h*Math.cos(v),f[1]+S*Math.sin(v)+h*Math.sin(v)],E=[f[0]+C*Math.cos(v)+h*Math.cos(v),f[1]+C*Math.sin(v)+h*Math.sin(v)];s.push(...this.helper.doubleLineOps(M[0],M[1],E[0],E[1],t))}}),s}}class JGe{constructor(e){this.helper=e}fillPolygons(e,t){const r=t.hachureGap<0?4*t.strokeWidth:t.hachureGap,i=t.zigzagOffset<0?r:t.zigzagOffset,s=IE(e,t=Object.assign({},t,{hachureGap:r+i}));return{type:"fillSketch",ops:this.zigzagLines(s,i,t)}}zigzagLines(e,t,r){const i=[];return e.forEach(s=>{const o=PB(s),l=Math.round(o/(2*t));let a=s[0],h=s[1];a[0]>h[0]&&(a=s[1],h=s[0]);const f=Math.atan((h[1]-a[1])/(h[0]-a[0]));for(let p=0;p<l;p++){const v=2*p*t,y=2*(p+1)*t,S=Math.sqrt(2*Math.pow(t,2)),C=[a[0]+v*Math.cos(f),a[1]+v*Math.sin(f)],M=[a[0]+y*Math.cos(f),a[1]+y*Math.sin(f)],E=[C[0]+S*Math.cos(f+Math.PI/4),C[1]+S*Math.sin(f+Math.PI/4)];i.push(...this.helper.doubleLineOps(C[0],C[1],E[0],E[1],r),...this.helper.doubleLineOps(E[0],E[1],M[0],M[1],r))}}),i}}const eu={};class QGe{constructor(e){this.seed=e}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const e8e=0,SN=1,uJ=2,BI={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function AN(n,e){return n.type===e}function P8(n){const e=[],t=function(o){const l=new Array;for(;o!=="";)if(o.match(/^([ \t\r\n,]+)/))o=o.substr(RegExp.$1.length);else if(o.match(/^([aAcChHlLmMqQsStTvVzZ])/))l[l.length]={type:e8e,text:RegExp.$1},o=o.substr(RegExp.$1.length);else{if(!o.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];l[l.length]={type:SN,text:`${parseFloat(RegExp.$1)}`},o=o.substr(RegExp.$1.length)}return l[l.length]={type:uJ,text:""},l}(n);let r="BOD",i=0,s=t[i];for(;!AN(s,uJ);){let o=0;const l=[];if(r==="BOD"){if(s.text!=="M"&&s.text!=="m")return P8("M0,0"+n);i++,o=BI[s.text],r=s.text}else AN(s,SN)?o=BI[r]:(i++,o=BI[s.text],r=s.text);if(!(i+o<t.length))throw new Error("Path data ended short");for(let a=i;a<i+o;a++){const h=t[a];if(!AN(h,SN))throw new Error("Param not a number: "+r+","+h.text);l[l.length]=+h.text}if(typeof BI[r]!="number")throw new Error("Bad segment: "+r);{const a={key:r,data:l};e.push(a),i+=o,s=t[i],r==="M"&&(r="L"),r==="m"&&(r="l")}}return e}function yue(n){let e=0,t=0,r=0,i=0;const s=[];for(const{key:o,data:l}of n)switch(o){case"M":s.push({key:"M",data:[...l]}),[e,t]=l,[r,i]=l;break;case"m":e+=l[0],t+=l[1],s.push({key:"M",data:[e,t]}),r=e,i=t;break;case"L":s.push({key:"L",data:[...l]}),[e,t]=l;break;case"l":e+=l[0],t+=l[1],s.push({key:"L",data:[e,t]});break;case"C":s.push({key:"C",data:[...l]}),e=l[4],t=l[5];break;case"c":{const a=l.map((h,f)=>f%2?h+t:h+e);s.push({key:"C",data:a}),e=a[4],t=a[5];break}case"Q":s.push({key:"Q",data:[...l]}),e=l[2],t=l[3];break;case"q":{const a=l.map((h,f)=>f%2?h+t:h+e);s.push({key:"Q",data:a}),e=a[2],t=a[3];break}case"A":s.push({key:"A",data:[...l]}),e=l[5],t=l[6];break;case"a":e+=l[5],t+=l[6],s.push({key:"A",data:[l[0],l[1],l[2],l[3],l[4],e,t]});break;case"H":s.push({key:"H",data:[...l]}),e=l[0];break;case"h":e+=l[0],s.push({key:"H",data:[e]});break;case"V":s.push({key:"V",data:[...l]}),t=l[0];break;case"v":t+=l[0],s.push({key:"V",data:[t]});break;case"S":s.push({key:"S",data:[...l]}),e=l[2],t=l[3];break;case"s":{const a=l.map((h,f)=>f%2?h+t:h+e);s.push({key:"S",data:a}),e=a[2],t=a[3];break}case"T":s.push({key:"T",data:[...l]}),e=l[0],t=l[1];break;case"t":e+=l[0],t+=l[1],s.push({key:"T",data:[e,t]});break;case"Z":case"z":s.push({key:"Z",data:[]}),e=r,t=i}return s}function xue(n){const e=[];let t="",r=0,i=0,s=0,o=0,l=0,a=0;for(const{key:h,data:f}of n){switch(h){case"M":e.push({key:"M",data:[...f]}),[r,i]=f,[s,o]=f;break;case"C":e.push({key:"C",data:[...f]}),r=f[4],i=f[5],l=f[2],a=f[3];break;case"L":e.push({key:"L",data:[...f]}),[r,i]=f;break;case"H":r=f[0],e.push({key:"L",data:[r,i]});break;case"V":i=f[0],e.push({key:"L",data:[r,i]});break;case"S":{let p=0,v=0;t==="C"||t==="S"?(p=r+(r-l),v=i+(i-a)):(p=r,v=i),e.push({key:"C",data:[p,v,...f]}),l=f[0],a=f[1],r=f[2],i=f[3];break}case"T":{const[p,v]=f;let y=0,S=0;t==="Q"||t==="T"?(y=r+(r-l),S=i+(i-a)):(y=r,S=i);const C=r+2*(y-r)/3,M=i+2*(S-i)/3,E=p+2*(y-p)/3,L=v+2*(S-v)/3;e.push({key:"C",data:[C,M,E,L,p,v]}),l=y,a=S,r=p,i=v;break}case"Q":{const[p,v,y,S]=f,C=r+2*(p-r)/3,M=i+2*(v-i)/3,E=y+2*(p-y)/3,L=S+2*(v-S)/3;e.push({key:"C",data:[C,M,E,L,y,S]}),l=p,a=v,r=y,i=S;break}case"A":{const p=Math.abs(f[0]),v=Math.abs(f[1]),y=f[2],S=f[3],C=f[4],M=f[5],E=f[6];p===0||v===0?(e.push({key:"C",data:[r,i,M,E,M,E]}),r=M,i=E):(r!==M||i!==E)&&(bue(r,i,M,E,p,v,y,S,C).forEach(function(L){e.push({key:"C",data:L})}),r=M,i=E);break}case"Z":e.push({key:"Z",data:[]}),r=s,i=o}t=h}return e}function yA(n,e,t){return[n*Math.cos(t)-e*Math.sin(t),n*Math.sin(t)+e*Math.cos(t)]}function bue(n,e,t,r,i,s,o,l,a,h){const f=(p=o,Math.PI*p/180);var p;let v=[],y=0,S=0,C=0,M=0;if(h)[y,S,C,M]=h;else{[n,e]=yA(n,e,-f),[t,r]=yA(t,r,-f);const Ee=(n-t)/2,Ie=(e-r)/2;let He=Ee*Ee/(i*i)+Ie*Ie/(s*s);He>1&&(He=Math.sqrt(He),i*=He,s*=He);const Re=i*i,st=s*s,_e=Re*st-Re*Ie*Ie-st*Ee*Ee,We=Re*Ie*Ie+st*Ee*Ee,Ue=(l===a?-1:1)*Math.sqrt(Math.abs(_e/We));C=Ue*i*Ie/s+(n+t)/2,M=Ue*-s*Ee/i+(e+r)/2,y=Math.asin(parseFloat(((e-M)/s).toFixed(9))),S=Math.asin(parseFloat(((r-M)/s).toFixed(9))),n<C&&(y=Math.PI-y),t<C&&(S=Math.PI-S),y<0&&(y=2*Math.PI+y),S<0&&(S=2*Math.PI+S),a&&y>S&&(y-=2*Math.PI),!a&&S>y&&(S-=2*Math.PI)}let E=S-y;if(Math.abs(E)>120*Math.PI/180){const Ee=S,Ie=t,He=r;S=a&&S>y?y+120*Math.PI/180*1:y+120*Math.PI/180*-1,v=bue(t=C+i*Math.cos(S),r=M+s*Math.sin(S),Ie,He,i,s,o,0,a,[S,Ee,C,M])}E=S-y;const L=Math.cos(y),k=Math.sin(y),H=Math.cos(S),X=Math.sin(S),Z=Math.tan(E/4),Q=4/3*i*Z,re=4/3*s*Z,ie=[n,e],oe=[n+Q*k,e-re*L],fe=[t+Q*X,r-re*H],Se=[t,r];if(oe[0]=2*ie[0]-oe[0],oe[1]=2*ie[1]-oe[1],h)return[oe,fe,Se].concat(v);{v=[oe,fe,Se].concat(v);const Ee=[];for(let Ie=0;Ie<v.length;Ie+=3){const He=yA(v[Ie][0],v[Ie][1],f),Re=yA(v[Ie+1][0],v[Ie+1][1],f),st=yA(v[Ie+2][0],v[Ie+2][1],f);Ee.push([He[0],He[1],Re[0],Re[1],st[0],st[1]])}return Ee}}const t8e={randOffset:function(n,e){return ri(n,e)},randOffsetWithRange:function(n,e,t){return bL(n,e,t)},ellipse:function(n,e,t,r,i){const s=Sue(t,r,i);return z5(n,e,i,s).opset},doubleLineOps:function(n,e,t,r,i){return T0(n,e,t,r,i,!0)}};function wue(n,e,t,r,i){return{type:"path",ops:T0(n,e,t,r,i)}}function bR(n,e,t){const r=(n||[]).length;if(r>2){const i=[];for(let s=0;s<r-1;s++)i.push(...T0(n[s][0],n[s][1],n[s+1][0],n[s+1][1],t));return e&&i.push(...T0(n[r-1][0],n[r-1][1],n[0][0],n[0][1],t)),{type:"path",ops:i}}return r===2?wue(n[0][0],n[0][1],n[1][0],n[1][1],t):{type:"path",ops:[]}}function n8e(n,e,t,r,i){return function(s,o){return bR(s,!0,o)}([[n,e],[n+t,e],[n+t,e+r],[n,e+r]],i)}function hJ(n,e){if(n.length){const t=typeof n[0][0]=="number"?[n]:n,r=kI(t[0],1*(1+.2*e.roughness),e),i=e.disableMultiStroke?[]:kI(t[0],1.5*(1+.22*e.roughness),pJ(e));for(let s=1;s<t.length;s++){const o=t[s];if(o.length){const l=kI(o,1*(1+.2*e.roughness),e),a=e.disableMultiStroke?[]:kI(o,1.5*(1+.22*e.roughness),pJ(e));for(const h of l)h.op!=="move"&&r.push(h);for(const h of a)h.op!=="move"&&i.push(h)}}return{type:"path",ops:r.concat(i)}}return{type:"path",ops:[]}}function Sue(n,e,t){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(n/2,2)+Math.pow(e/2,2))/2)),i=Math.ceil(Math.max(t.curveStepCount,t.curveStepCount/Math.sqrt(200)*r)),s=2*Math.PI/i;let o=Math.abs(n/2),l=Math.abs(e/2);const a=1-t.curveFitting;return o+=ri(o*a,t),l+=ri(l*a,t),{increment:s,rx:o,ry:l}}function z5(n,e,t,r){const[i,s]=mJ(r.increment,n,e,r.rx,r.ry,1,r.increment*bL(.1,bL(.4,1,t),t),t);let o=wL(i,null,t);if(!t.disableMultiStroke&&t.roughness!==0){const[l]=mJ(r.increment,n,e,r.rx,r.ry,1.5,0,t),a=wL(l,null,t);o=o.concat(a)}return{estimatedPoints:s,opset:{type:"path",ops:o}}}function fJ(n,e,t,r,i,s,o,l,a){const h=n,f=e;let p=Math.abs(t/2),v=Math.abs(r/2);p+=ri(.01*p,a),v+=ri(.01*v,a);let y=i,S=s;for(;y<0;)y+=2*Math.PI,S+=2*Math.PI;S-y>2*Math.PI&&(y=0,S=2*Math.PI);const C=2*Math.PI/a.curveStepCount,M=Math.min(C/2,(S-y)/2),E=gJ(M,h,f,p,v,y,S,1,a);if(!a.disableMultiStroke){const L=gJ(M,h,f,p,v,y,S,1.5,a);E.push(...L)}return o&&(l?E.push(...T0(h,f,h+p*Math.cos(y),f+v*Math.sin(y),a),...T0(h,f,h+p*Math.cos(S),f+v*Math.sin(S),a)):E.push({op:"lineTo",data:[h,f]},{op:"lineTo",data:[h+p*Math.cos(y),f+v*Math.sin(y)]})),{type:"path",ops:E}}function dJ(n,e){const t=xue(yue(P8(n))),r=[];let i=[0,0],s=[0,0];for(const{key:o,data:l}of t)switch(o){case"M":s=[l[0],l[1]],i=[l[0],l[1]];break;case"L":r.push(...T0(s[0],s[1],l[0],l[1],e)),s=[l[0],l[1]];break;case"C":{const[a,h,f,p,v,y]=l;r.push(...r8e(a,h,f,p,v,y,s,e)),s=[v,y];break}case"Z":r.push(...T0(s[0],s[1],i[0],i[1],e)),s=[i[0],i[1]]}return{type:"path",ops:r}}function TN(n,e){const t=[];for(const r of n)if(r.length){const i=e.maxRandomnessOffset||0,s=r.length;if(s>2){t.push({op:"move",data:[r[0][0]+ri(i,e),r[0][1]+ri(i,e)]});for(let o=1;o<s;o++)t.push({op:"lineTo",data:[r[o][0]+ri(i,e),r[o][1]+ri(i,e)]})}}return{type:"fillPath",ops:t}}function q1(n,e){return function(t,r){let i=t.fillStyle||"hachure";if(!eu[i])switch(i){case"zigzag":eu[i]||(eu[i]=new qGe(r));break;case"cross-hatch":eu[i]||(eu[i]=new ZGe(r));break;case"dots":eu[i]||(eu[i]=new YGe(r));break;case"dashed":eu[i]||(eu[i]=new KGe(r));break;case"zigzag-line":eu[i]||(eu[i]=new JGe(r));break;default:i="hachure",eu[i]||(eu[i]=new R8(r))}return eu[i]}(e,t8e).fillPolygons(n,e)}function pJ(n){const e=Object.assign({},n);return e.randomizer=void 0,n.seed&&(e.seed=n.seed+1),e}function Aue(n){return n.randomizer||(n.randomizer=new QGe(n.seed||0)),n.randomizer.next()}function bL(n,e,t,r=1){return t.roughness*r*(Aue(t)*(e-n)+n)}function ri(n,e,t=1){return bL(-n,n,e,t)}function T0(n,e,t,r,i,s=!1){const o=s?i.disableMultiStrokeFill:i.disableMultiStroke,l=U5(n,e,t,r,i,!0,!1);if(o)return l;const a=U5(n,e,t,r,i,!0,!0);return l.concat(a)}function U5(n,e,t,r,i,s,o){const l=Math.pow(n-t,2)+Math.pow(e-r,2),a=Math.sqrt(l);let h=1;h=a<200?1:a>500?.4:-.0016668*a+1.233334;let f=i.maxRandomnessOffset||0;f*f*100>l&&(f=a/10);const p=f/2,v=.2+.2*Aue(i);let y=i.bowing*i.maxRandomnessOffset*(r-e)/200,S=i.bowing*i.maxRandomnessOffset*(n-t)/200;y=ri(y,i,h),S=ri(S,i,h);const C=[],M=()=>ri(p,i,h),E=()=>ri(f,i,h),L=i.preserveVertices;return o?C.push({op:"move",data:[n+(L?0:M()),e+(L?0:M())]}):C.push({op:"move",data:[n+(L?0:ri(f,i,h)),e+(L?0:ri(f,i,h))]}),o?C.push({op:"bcurveTo",data:[y+n+(t-n)*v+M(),S+e+(r-e)*v+M(),y+n+2*(t-n)*v+M(),S+e+2*(r-e)*v+M(),t+(L?0:M()),r+(L?0:M())]}):C.push({op:"bcurveTo",data:[y+n+(t-n)*v+E(),S+e+(r-e)*v+E(),y+n+2*(t-n)*v+E(),S+e+2*(r-e)*v+E(),t+(L?0:E()),r+(L?0:E())]}),C}function kI(n,e,t){if(!n.length)return[];const r=[];r.push([n[0][0]+ri(e,t),n[0][1]+ri(e,t)]),r.push([n[0][0]+ri(e,t),n[0][1]+ri(e,t)]);for(let i=1;i<n.length;i++)r.push([n[i][0]+ri(e,t),n[i][1]+ri(e,t)]),i===n.length-1&&r.push([n[i][0]+ri(e,t),n[i][1]+ri(e,t)]);return wL(r,null,t)}function wL(n,e,t){const r=n.length,i=[];if(r>3){const s=[],o=1-t.curveTightness;i.push({op:"move",data:[n[1][0],n[1][1]]});for(let l=1;l+2<r;l++){const a=n[l];s[0]=[a[0],a[1]],s[1]=[a[0]+(o*n[l+1][0]-o*n[l-1][0])/6,a[1]+(o*n[l+1][1]-o*n[l-1][1])/6],s[2]=[n[l+1][0]+(o*n[l][0]-o*n[l+2][0])/6,n[l+1][1]+(o*n[l][1]-o*n[l+2][1])/6],s[3]=[n[l+1][0],n[l+1][1]],i.push({op:"bcurveTo",data:[s[1][0],s[1][1],s[2][0],s[2][1],s[3][0],s[3][1]]})}}else r===3?(i.push({op:"move",data:[n[1][0],n[1][1]]}),i.push({op:"bcurveTo",data:[n[1][0],n[1][1],n[2][0],n[2][1],n[2][0],n[2][1]]})):r===2&&i.push(...U5(n[0][0],n[0][1],n[1][0],n[1][1],t,!0,!0));return i}function mJ(n,e,t,r,i,s,o,l){const a=[],h=[];if(l.roughness===0){n/=4,h.push([e+r*Math.cos(-n),t+i*Math.sin(-n)]);for(let f=0;f<=2*Math.PI;f+=n){const p=[e+r*Math.cos(f),t+i*Math.sin(f)];a.push(p),h.push(p)}h.push([e+r*Math.cos(0),t+i*Math.sin(0)]),h.push([e+r*Math.cos(n),t+i*Math.sin(n)])}else{const f=ri(.5,l)-Math.PI/2;h.push([ri(s,l)+e+.9*r*Math.cos(f-n),ri(s,l)+t+.9*i*Math.sin(f-n)]);const p=2*Math.PI+f-.01;for(let v=f;v<p;v+=n){const y=[ri(s,l)+e+r*Math.cos(v),ri(s,l)+t+i*Math.sin(v)];a.push(y),h.push(y)}h.push([ri(s,l)+e+r*Math.cos(f+2*Math.PI+.5*o),ri(s,l)+t+i*Math.sin(f+2*Math.PI+.5*o)]),h.push([ri(s,l)+e+.98*r*Math.cos(f+o),ri(s,l)+t+.98*i*Math.sin(f+o)]),h.push([ri(s,l)+e+.9*r*Math.cos(f+.5*o),ri(s,l)+t+.9*i*Math.sin(f+.5*o)])}return[h,a]}function gJ(n,e,t,r,i,s,o,l,a){const h=s+ri(.1,a),f=[];f.push([ri(l,a)+e+.9*r*Math.cos(h-n),ri(l,a)+t+.9*i*Math.sin(h-n)]);for(let p=h;p<=o;p+=n)f.push([ri(l,a)+e+r*Math.cos(p),ri(l,a)+t+i*Math.sin(p)]);return f.push([e+r*Math.cos(o),t+i*Math.sin(o)]),f.push([e+r*Math.cos(o),t+i*Math.sin(o)]),wL(f,null,a)}function r8e(n,e,t,r,i,s,o,l){const a=[],h=[l.maxRandomnessOffset||1,(l.maxRandomnessOffset||1)+.3];let f=[0,0];const p=l.disableMultiStroke?1:2,v=l.preserveVertices;for(let y=0;y<p;y++)y===0?a.push({op:"move",data:[o[0],o[1]]}):a.push({op:"move",data:[o[0]+(v?0:ri(h[0],l)),o[1]+(v?0:ri(h[0],l))]}),f=v?[i,s]:[i+ri(h[y],l),s+ri(h[y],l)],a.push({op:"bcurveTo",data:[n+ri(h[y],l),e+ri(h[y],l),t+ri(h[y],l),r+ri(h[y],l),f[0],f[1]]});return a}function xA(n){return[...n]}function vJ(n,e=0){const t=n.length;if(t<3)throw new Error("A curve must have at least three points.");const r=[];if(t===3)r.push(xA(n[0]),xA(n[1]),xA(n[2]),xA(n[2]));else{const i=[];i.push(n[0],n[0]);for(let l=1;l<n.length;l++)i.push(n[l]),l===n.length-1&&i.push(n[l]);const s=[],o=1-e;r.push(xA(i[0]));for(let l=1;l+2<i.length;l++){const a=i[l];s[0]=[a[0],a[1]],s[1]=[a[0]+(o*i[l+1][0]-o*i[l-1][0])/6,a[1]+(o*i[l+1][1]-o*i[l-1][1])/6],s[2]=[i[l+1][0]+(o*i[l][0]-o*i[l+2][0])/6,i[l+1][1]+(o*i[l][1]-o*i[l+2][1])/6],s[3]=[i[l+1][0],i[l+1][1]],r.push(s[1],s[2],s[3])}}return r}function wR(n,e){return Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2)}function i8e(n,e,t){const r=wR(e,t);if(r===0)return wR(n,e);let i=((n[0]-e[0])*(t[0]-e[0])+(n[1]-e[1])*(t[1]-e[1]))/r;return i=Math.max(0,Math.min(1,i)),wR(n,my(e,t,i))}function my(n,e,t){return[n[0]+(e[0]-n[0])*t,n[1]+(e[1]-n[1])*t]}function G5(n,e,t,r){const i=r||[];if(function(l,a){const h=l[a+0],f=l[a+1],p=l[a+2],v=l[a+3];let y=3*f[0]-2*h[0]-v[0];y*=y;let S=3*f[1]-2*h[1]-v[1];S*=S;let C=3*p[0]-2*v[0]-h[0];C*=C;let M=3*p[1]-2*v[1]-h[1];return M*=M,y<C&&(y=C),S<M&&(S=M),y+S}(n,e)<t){const l=n[e+0];i.length?(s=i[i.length-1],o=l,Math.sqrt(wR(s,o))>1&&i.push(l)):i.push(l),i.push(n[e+3])}else{const a=n[e+0],h=n[e+1],f=n[e+2],p=n[e+3],v=my(a,h,.5),y=my(h,f,.5),S=my(f,p,.5),C=my(v,y,.5),M=my(y,S,.5),E=my(C,M,.5);G5([a,v,C,E],0,t,i),G5([E,M,S,p],0,t,i)}var s,o;return i}function s8e(n,e){return SL(n,0,n.length,e)}function SL(n,e,t,r,i){const s=i||[],o=n[e],l=n[t-1];let a=0,h=1;for(let f=e+1;f<t-1;++f){const p=i8e(n[f],o,l);p>a&&(a=p,h=f)}return Math.sqrt(a)>r?(SL(n,e,h+1,r,s),SL(n,h,t,r,s)):(s.length||s.push(o),s.push(l)),s}function MN(n,e=.15,t){const r=[],i=(n.length-1)/3;for(let s=0;s<i;s++)G5(n,3*s,e,r);return t&&t>0?SL(r,0,r.length,t):r}const Pu="none";class AL{constructor(e){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=e||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(e){return e?Object.assign({},this.defaultOptions,e):this.defaultOptions}_d(e,t,r){return{shape:e,sets:t||[],options:r||this.defaultOptions}}line(e,t,r,i,s){const o=this._o(s);return this._d("line",[wue(e,t,r,i,o)],o)}rectangle(e,t,r,i,s){const o=this._o(s),l=[],a=n8e(e,t,r,i,o);if(o.fill){const h=[[e,t],[e+r,t],[e+r,t+i],[e,t+i]];o.fillStyle==="solid"?l.push(TN([h],o)):l.push(q1([h],o))}return o.stroke!==Pu&&l.push(a),this._d("rectangle",l,o)}ellipse(e,t,r,i,s){const o=this._o(s),l=[],a=Sue(r,i,o),h=z5(e,t,o,a);if(o.fill)if(o.fillStyle==="solid"){const f=z5(e,t,o,a).opset;f.type="fillPath",l.push(f)}else l.push(q1([h.estimatedPoints],o));return o.stroke!==Pu&&l.push(h.opset),this._d("ellipse",l,o)}circle(e,t,r,i){const s=this.ellipse(e,t,r,r,i);return s.shape="circle",s}linearPath(e,t){const r=this._o(t);return this._d("linearPath",[bR(e,!1,r)],r)}arc(e,t,r,i,s,o,l=!1,a){const h=this._o(a),f=[],p=fJ(e,t,r,i,s,o,l,!0,h);if(l&&h.fill)if(h.fillStyle==="solid"){const v=Object.assign({},h);v.disableMultiStroke=!0;const y=fJ(e,t,r,i,s,o,!0,!1,v);y.type="fillPath",f.push(y)}else f.push(function(v,y,S,C,M,E,L){const k=v,H=y;let X=Math.abs(S/2),Z=Math.abs(C/2);X+=ri(.01*X,L),Z+=ri(.01*Z,L);let Q=M,re=E;for(;Q<0;)Q+=2*Math.PI,re+=2*Math.PI;re-Q>2*Math.PI&&(Q=0,re=2*Math.PI);const ie=(re-Q)/L.curveStepCount,oe=[];for(let fe=Q;fe<=re;fe+=ie)oe.push([k+X*Math.cos(fe),H+Z*Math.sin(fe)]);return oe.push([k+X*Math.cos(re),H+Z*Math.sin(re)]),oe.push([k,H]),q1([oe],L)}(e,t,r,i,s,o,h));return h.stroke!==Pu&&f.push(p),this._d("arc",f,h)}curve(e,t){const r=this._o(t),i=[],s=hJ(e,r);if(r.fill&&r.fill!==Pu)if(r.fillStyle==="solid"){const o=hJ(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(o.ops)})}else{const o=[],l=e;if(l.length){const a=typeof l[0][0]=="number"?[l]:l;for(const h of a)h.length<3?o.push(...h):h.length===3?o.push(...MN(vJ([h[0],h[0],h[1],h[2]]),10,(1+r.roughness)/2)):o.push(...MN(vJ(h),10,(1+r.roughness)/2))}o.length&&i.push(q1([o],r))}return r.stroke!==Pu&&i.push(s),this._d("curve",i,r)}polygon(e,t){const r=this._o(t),i=[],s=bR(e,!0,r);return r.fill&&(r.fillStyle==="solid"?i.push(TN([e],r)):i.push(q1([e],r))),r.stroke!==Pu&&i.push(s),this._d("polygon",i,r)}path(e,t){const r=this._o(t),i=[];if(!e)return this._d("path",i,r);e=(e||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const s=r.fill&&r.fill!=="transparent"&&r.fill!==Pu,o=r.stroke!==Pu,l=!!(r.simplification&&r.simplification<1),a=function(f,p,v){const y=xue(yue(P8(f))),S=[];let C=[],M=[0,0],E=[];const L=()=>{E.length>=4&&C.push(...MN(E,p)),E=[]},k=()=>{L(),C.length&&(S.push(C),C=[])};for(const{key:X,data:Z}of y)switch(X){case"M":k(),M=[Z[0],Z[1]],C.push(M);break;case"L":L(),C.push([Z[0],Z[1]]);break;case"C":if(!E.length){const Q=C.length?C[C.length-1]:M;E.push([Q[0],Q[1]])}E.push([Z[0],Z[1]]),E.push([Z[2],Z[3]]),E.push([Z[4],Z[5]]);break;case"Z":L(),C.push([M[0],M[1]])}if(k(),!v)return S;const H=[];for(const X of S){const Z=s8e(X,v);Z.length&&H.push(Z)}return H}(e,1,l?4-4*(r.simplification||1):(1+r.roughness)/2),h=dJ(e,r);if(s)if(r.fillStyle==="solid")if(a.length===1){const f=dJ(e,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));i.push({type:"fillPath",ops:this._mergedShape(f.ops)})}else i.push(TN(a,r));else i.push(q1(a,r));return o&&(l?a.forEach(f=>{i.push(bR(f,!1,r))}):i.push(h)),this._d("path",i,r)}opsToPath(e,t){let r="";for(const i of e.ops){const s=typeof t=="number"&&t>=0?i.data.map(o=>+o.toFixed(t)):i.data;switch(i.op){case"move":r+=`M${s[0]} ${s[1]} `;break;case"bcurveTo":r+=`C${s[0]} ${s[1]}, ${s[2]} ${s[3]}, ${s[4]} ${s[5]} `;break;case"lineTo":r+=`L${s[0]} ${s[1]} `}}return r.trim()}toPaths(e){const t=e.sets||[],r=e.options||this.defaultOptions,i=[];for(const s of t){let o=null;switch(s.type){case"path":o={d:this.opsToPath(s),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:Pu};break;case"fillPath":o={d:this.opsToPath(s),stroke:Pu,strokeWidth:0,fill:r.fill||Pu};break;case"fillSketch":o=this.fillSketch(s,r)}o&&i.push(o)}return i}fillSketch(e,t){let r=t.fillWeight;return r<0&&(r=t.strokeWidth/2),{d:this.opsToPath(e),stroke:t.fill||Pu,strokeWidth:r,fill:Pu}}_mergedShape(e){return e.filter((t,r)=>r===0||t.op!=="move")}}class a8e{constructor(e,t){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.gen=new AL(t)}draw(e){const t=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.ctx,s=e.options.fixedDecimalPlaceDigits;for(const o of t)switch(o.type){case"path":i.save(),i.strokeStyle=r.stroke==="none"?"transparent":r.stroke,i.lineWidth=r.strokeWidth,r.strokeLineDash&&i.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(i.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(i,o,s),i.restore();break;case"fillPath":{i.save(),i.fillStyle=r.fill||"";const l=e.shape==="curve"||e.shape==="polygon"||e.shape==="path"?"evenodd":"nonzero";this._drawToContext(i,o,s,l),i.restore();break}case"fillSketch":this.fillSketch(i,o,r)}}fillSketch(e,t,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2),e.save(),r.fillLineDash&&e.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(e.lineDashOffset=r.fillLineDashOffset),e.strokeStyle=r.fill||"",e.lineWidth=i,this._drawToContext(e,t,r.fixedDecimalPlaceDigits),e.restore()}_drawToContext(e,t,r,i="nonzero"){e.beginPath();for(const s of t.ops){const o=typeof r=="number"&&r>=0?s.data.map(l=>+l.toFixed(r)):s.data;switch(s.op){case"move":e.moveTo(o[0],o[1]);break;case"bcurveTo":e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5]);break;case"lineTo":e.lineTo(o[0],o[1])}}t.type==="fillPath"?e.fill(i):e.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(e,t,r,i,s){const o=this.gen.line(e,t,r,i,s);return this.draw(o),o}rectangle(e,t,r,i,s){const o=this.gen.rectangle(e,t,r,i,s);return this.draw(o),o}ellipse(e,t,r,i,s){const o=this.gen.ellipse(e,t,r,i,s);return this.draw(o),o}circle(e,t,r,i){const s=this.gen.circle(e,t,r,i);return this.draw(s),s}linearPath(e,t){const r=this.gen.linearPath(e,t);return this.draw(r),r}polygon(e,t){const r=this.gen.polygon(e,t);return this.draw(r),r}arc(e,t,r,i,s,o,l=!1,a){const h=this.gen.arc(e,t,r,i,s,o,l,a);return this.draw(h),h}curve(e,t){const r=this.gen.curve(e,t);return this.draw(r),r}path(e,t){const r=this.gen.path(e,t);return this.draw(r),r}}const OI="http://www.w3.org/2000/svg";class o8e{constructor(e,t){this.svg=e,this.gen=new AL(t)}draw(e){const t=e.sets||[],r=e.options||this.getDefaultOptions(),i=this.svg.ownerDocument||window.document,s=i.createElementNS(OI,"g"),o=e.options.fixedDecimalPlaceDigits;for(const l of t){let a=null;switch(l.type){case"path":a=i.createElementNS(OI,"path"),a.setAttribute("d",this.opsToPath(l,o)),a.setAttribute("stroke",r.stroke),a.setAttribute("stroke-width",r.strokeWidth+""),a.setAttribute("fill","none"),r.strokeLineDash&&a.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&a.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":a=i.createElementNS(OI,"path"),a.setAttribute("d",this.opsToPath(l,o)),a.setAttribute("stroke","none"),a.setAttribute("stroke-width","0"),a.setAttribute("fill",r.fill||""),e.shape!=="curve"&&e.shape!=="polygon"||a.setAttribute("fill-rule","evenodd");break;case"fillSketch":a=this.fillSketch(i,l,r)}a&&s.appendChild(a)}return s}fillSketch(e,t,r){let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);const s=e.createElementNS(OI,"path");return s.setAttribute("d",this.opsToPath(t,r.fixedDecimalPlaceDigits)),s.setAttribute("stroke",r.fill||""),s.setAttribute("stroke-width",i+""),s.setAttribute("fill","none"),r.fillLineDash&&s.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&s.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),s}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(e,t){return this.gen.opsToPath(e,t)}line(e,t,r,i,s){const o=this.gen.line(e,t,r,i,s);return this.draw(o)}rectangle(e,t,r,i,s){const o=this.gen.rectangle(e,t,r,i,s);return this.draw(o)}ellipse(e,t,r,i,s){const o=this.gen.ellipse(e,t,r,i,s);return this.draw(o)}circle(e,t,r,i){const s=this.gen.circle(e,t,r,i);return this.draw(s)}linearPath(e,t){const r=this.gen.linearPath(e,t);return this.draw(r)}polygon(e,t){const r=this.gen.polygon(e,t);return this.draw(r)}arc(e,t,r,i,s,o,l=!1,a){const h=this.gen.arc(e,t,r,i,s,o,l,a);return this.draw(h)}curve(e,t){const r=this.gen.curve(e,t);return this.draw(r)}path(e,t){const r=this.gen.path(e,t);return this.draw(r)}}var Tue={canvas:(n,e)=>new a8e(n,e),svg:(n,e)=>new o8e(n,e),generator:n=>new AL(n),newSeed:()=>AL.newSeed()};class vw extends Array{constructor(e=1,t=0){super(e,t)}set x(e){this[0]=e}set y(e){this[1]=e}get x(){return this[0]}get y(){return this[1]}get length(){return Math.hypot(this[0],this[1])}get dir(){return Math.atan2(this[1],this[0])}copy(){return new vw(this[0],this[1])}add(e){return this.x+=e.x,this.y+=e.y,this}rotate(e){const[t,r]=this;return this[0]=t*Math.cos(e)-r*Math.sin(e),this[1]=t*Math.sin(e)+r*Math.cos(e),this}scale(e){return this[0]*=e,this[1]*=e,this}}const l8e=()=>{const n=Ae.useRef(null),e={roughness:2.2,strokeWidth:4,fill:"blue"},t={stroke:"red",strokeWidth:4,fill:"yellow",fillStyle:"solid"},r={stroke:"green",strokeWidth:3,fill:"purple",fillStyle:"solid"},i=(s,o,l,a)=>{const h=2*Math.PI/s;let f=new vw(o,l),p=[[f.x,f.y]],v=new vw(a,0);for(let y=0;y<s;y++)f=f.copy().add(v.rotate(h)),p.push([f.x,f.y]);return p};return Ae.useEffect(()=>{const s=Tue.canvas(n.current),o=s.ctx;o.translate(256,256),o.scale(1,-1),s.path("M-180 0L-80 100L20 0",e),s.path("M-20 0L80 100L180 0",e),s.circle(0,150,105,t),s.polygon(i(5,n.current.width/2,0,50),r),s.polygon(i(10,0,0,20),r)},[]),me.jsx("div",{className:"absolute top-20 w-full",children:me.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},c8e=()=>{const n=Ae.useRef(null),e=(t,r,i,s,o,l)=>{let a=new vw().rotate(o).scale(i),h=r.copy().add(a);if(t.lineWidth=s,t.beginPath(),t.moveTo(...r),t.lineTo(...h),t.stroke(),s>2){let f=Math.PI/4+.5*(o+.2)+(Math.random()-.5)*l;e(t,h,i*.9,s*.8,f,l*.9);let p=Math.PI/4+.5*(o-.2)+(Math.random()-.5)*l;e(t,h,i*.9,s*.8,p,l*.9)}s<5&&Math.random()<.3&&(t.save(),t.strokeStyle="red",t.lineWidth=Math.random()*5,t.beginPath(),t.moveTo(...h),t.lineTo(h.x,h.y-2),t.stroke(),t.restore())};return Ae.useEffect(()=>{const t=n.current.getContext("2d");t.translate(0,n.current.height),t.scale(1,-1),t.lineCap="round",e(t,new vw(512,0),50,10,1,3)},[]),me.jsx("div",{className:"absolute top-20 w-full",children:me.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},u8e=()=>{const n=Ae.useRef(null),e={stroke:"green",strokeWidth:3,fill:"purple",fillStyle:"solid"},t={stroke:"blue",strokeWidth:3},r=Math.PI*2,i=60;function s(a,h,f,p=0,v=r){const y=v-p===r?r:v-p,S=[];for(let C=0;C<i;C++){let M=a+f*Math.cos(p+y*C/i),E=h+f*Math.sin(p+y*C/i);S.push([M,E])}return S}function o(a,h,f,p,v=0,y=r){const S=y-v===r?r:y-v,C=[];for(let M=0;M<=i;M++){let E=a+f*Math.cos(v+S*M/i),L=h+p*Math.sin(v+S*M/i);C.push([E,L])}return C}function l(a,h,f,p,v){let y=[];for(let S=0;S<i;S++){const C=S/i,M=(1-C)*p+C*v,E=a+2*f*M*M,L=h+2*f*M;y.push([E,L])}return y}return Ae.useEffect(()=>{const a=Tue.canvas(n.current),h=a.ctx;h.translate(512,256),h.scale(1,-1),a.polygon(s(-100,0,50),e),a.polygon(o(0,0,50,30),e);const f=l(100,0,5,-5,5);for(let p=0;p<f.length-1;p++)a.line(f[p][0],f[p][1],f[p+1][0],f[p+1][1],t)},[]),me.jsx("div",{className:"absolute top-20 w-full",children:me.jsx("canvas",{className:"",width:"1024",height:"512",ref:n})})},h8e=()=>{const n={width:0,height:0,border:"80px solid",margin:2,"border-color":"transparent transparent red"},e={width:0,height:0,border:"80px solid",margin:2,"border-color":"green yellow red black"},t={width:0,height:0,border:"80px solid",margin:2,"border-color":"transparent transparent red","border-left":0},r={width:"160px",height:"`60px",background:"linear-gradient(45deg, red, red 50%, transparent 50%)"},i={width:"160px",height:"120px",position:"relative",overflow:"hidden"},s={content:"",position:"absolute",left:0,top:0,right:0,bottom:0,background:"red",transformOrigin:"left bottom",transform:"rotate(45deg)"},o={position:"relative",width:0,height:0,"border-width":"0 80px 80px","border-style":"solid","border-color":"transparent transparent red"},l={content:"",position:"absolute",top:"1px",left:"-76px","border-width":"0 76px 76px","border-style":"solid","border-color":"transparent transparent yellow"},a={width:"160px",height:"120px",border:"0px solid transparent",borderTop:"60px solid red",borderLeft:"40px solid transparent"};return me.jsxs("div",{className:"absolute top-20 w-full",children:[me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(border; linear-gradient; rotate; +border) "}),me.jsxs("div",{className:"flex",children:[me.jsx("div",{style:n}),me.jsx("div",{style:e}),me.jsx("div",{style:t}),me.jsx("div",{style:r}),me.jsx("div",{style:i,children:me.jsx("div",{style:s})}),me.jsx("div",{style:o,children:me.jsx("div",{style:l})})]}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(skew)"}),me.jsxs("div",{className:"flex",children:[me.jsx("div",{className:"ml-10 w-40 h-20 bg-black -skew-x-12"}),me.jsx("div",{className:"ml-10 w-40 h-20 bg-black -skew-y-12"})]}),me.jsx("h2",{className:"font-bold text-xl pl-3",children:"(border; "}),me.jsx("div",{className:"flex",children:me.jsx("div",{style:a})})]})},f8e=()=>{const n={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"600px",height:"600px",border:"black 1px solid",display:"flex","align-items":"flex-start","flex-wrap":"wrap","align-content":"flex-start"},e={height:"100px",flex:"0 0 25%",border:"red 1px solid",margin:"0"};return me.jsxs("div",{style:n,children:[me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"}),me.jsx("div",{style:e,children:"111"})]})},d8e=()=>{const n={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",color:"white",backgroundColor:"black",display:"flex",alignItems:"center"},e={width:"50px",height:"50px",border:"red 1px solid",marginRight:"10px"},t={overflowWrap:"anywhere"};return me.jsxs("div",{style:n,children:[me.jsx("img",{src:nie,alt:"",style:e}),me.jsx("p",{style:t,children:"ttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttttt"})]})},p8e=()=>{const n={border:"purple 1px solid",flex:1},e={"box-sizing":"border-box",width:"100vw",height:"100vh",display:"flex","flex-direction":"column",border:"yellow 4px solid"},t={border:"red 1px solid",flex:"80%",display:"flex",width:"100%",height:"100%"},r={border:"blue 1px solid",flex:1},i={flex:"0 0 12em"};return me.jsxs("div",{style:e,children:[me.jsx("header",{style:n,children:"header"}),me.jsxs("div",{style:t,children:[me.jsx("div",{style:{...r,...i},children:"1"}),me.jsx("div",{style:r,children:"2"}),me.jsx("div",{style:{...r,...i},children:"3"})]}),me.jsx("footer",{style:n,children:"footer"})]})};function m8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{d:"M2 3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3Z"}),Ae.createElement("path",{fillRule:"evenodd",d:"M13 6H3v6a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V6ZM5.72 7.47a.75.75 0 0 1 1.06 0L8 8.69l1.22-1.22a.75.75 0 1 1 1.06 1.06L9.06 9.75l1.22 1.22a.75.75 0 1 1-1.06 1.06L8 10.81l-1.22 1.22a.75.75 0 0 1-1.06-1.06l1.22-1.22-1.22-1.22a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const g8e=Ae.forwardRef(m8e);function v8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{fillRule:"evenodd",d:"M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const _8e=Ae.forwardRef(v8e);function y8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{fillRule:"evenodd",d:"M11.013 2.513a1.75 1.75 0 0 1 2.475 2.474L6.226 12.25a2.751 2.751 0 0 1-.892.596l-2.047.848a.75.75 0 0 1-.98-.98l.848-2.047a2.75 2.75 0 0 1 .596-.892l7.262-7.261Z",clipRule:"evenodd"}))}const x8e=Ae.forwardRef(y8e);function b8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{d:"M5 6.5A1.5 1.5 0 0 1 6.5 5h6A1.5 1.5 0 0 1 14 6.5v6a1.5 1.5 0 0 1-1.5 1.5h-6A1.5 1.5 0 0 1 5 12.5v-6Z"}),Ae.createElement("path",{d:"M3.5 2A1.5 1.5 0 0 0 2 3.5v6A1.5 1.5 0 0 0 3.5 11V6.5a3 3 0 0 1 3-3H11A1.5 1.5 0 0 0 9.5 2h-6Z"}))}const w8e=Ae.forwardRef(b8e);function S8e({title:n,titleId:e,...t},r){return Ae.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},t),n?Ae.createElement("title",{id:e},n):null,Ae.createElement("path",{fillRule:"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z",clipRule:"evenodd"}))}const _J=Ae.forwardRef(S8e);/*!
 * Compressor.js v1.2.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2023-02-28T14:09:41.732Z
 */function yJ(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function FI(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?yJ(Object(t),!0).forEach(function(r){M8e(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):yJ(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function A8e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function xJ(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Mue(r.key),r)}}function T8e(n,e,t){return e&&xJ(n.prototype,e),t&&xJ(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function M8e(n,e,t){return e=Mue(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function TL(){return TL=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},TL.apply(this,arguments)}function E8e(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Mue(n){var e=E8e(n,"string");return typeof e=="symbol"?e:String(e)}var Eue={exports:{}};(function(n){typeof window>"u"||function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,r=e.Blob&&function(){try{return!!new Blob}catch{return!1}}(),i=r&&e.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),s=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,l=(r||s)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(a){var h,f,p,v,y,S,C,M,E;if(h=a.match(o),!h)throw new Error("invalid data URI");for(f=h[2]?h[1]:"text/plain"+(h[3]||";charset=US-ASCII"),p=!!h[4],v=a.slice(h[0].length),p?y=atob(v):y=decodeURIComponent(v),S=new ArrayBuffer(y.length),C=new Uint8Array(S),M=0;M<y.length;M+=1)C[M]=y.charCodeAt(M);return r?new Blob([i?C:S],{type:f}):(E=new s,E.append(S),E.getBlob(f))};e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(a,h,f){var p=this;setTimeout(function(){f&&t.toDataURL&&l?a(l(p.toDataURL(h,f))):a(p.mozGetAsFile("blob",h))})}:t.toDataURL&&l&&(t.msToBlob?t.toBlob=function(a,h,f){var p=this;setTimeout(function(){(h&&h!=="image/png"||f)&&t.toDataURL&&l?a(l(p.toDataURL(h,f))):a(p.msToBlob(h))})}:t.toBlob=function(a,h,f){var p=this;setTimeout(function(){a(l(p.toDataURL(h,f)))})})),n.exports?n.exports=l:e.dataURLtoBlob=l}(window)})(Eue);var bJ=Eue.exports,C8e=function(e){return typeof Blob>"u"?!1:e instanceof Blob||Object.prototype.toString.call(e)==="[object Blob]"},wJ={strict:!0,checkOrientation:!0,retainExif:!1,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},I8e=typeof window<"u"&&typeof window.document<"u",M0=I8e?window:{},ML=function(e){return e>0&&e<1/0},R8e=Array.prototype.slice;function L8(n){return Array.from?Array.from(n):R8e.call(n)}var P8e=/^image\/.+$/;function V5(n){return P8e.test(n)}function L8e(n){var e=V5(n)?n.substr(6):"";return e==="jpeg"&&(e="jpg"),".".concat(e)}var Cue=String.fromCharCode;function D8e(n,e,t){var r="",i;for(t+=e,i=e;i<t;i+=1)r+=Cue(n.getUint8(i));return r}var B8e=M0.btoa;function SJ(n,e){for(var t=[],r=8192,i=new Uint8Array(n);i.length>0;)t.push(Cue.apply(null,L8(i.subarray(0,r)))),i=i.subarray(r);return"data:".concat(e,";base64,").concat(B8e(t.join("")))}function k8e(n){var e=new DataView(n),t;try{var r,i,s;if(e.getUint8(0)===255&&e.getUint8(1)===216)for(var o=e.byteLength,l=2;l+1<o;){if(e.getUint8(l)===255&&e.getUint8(l+1)===225){i=l;break}l+=1}if(i){var a=i+4,h=i+10;if(D8e(e,a,4)==="Exif"){var f=e.getUint16(h);if(r=f===18761,(r||f===19789)&&e.getUint16(h+2,r)===42){var p=e.getUint32(h+4,r);p>=8&&(s=h+p)}}}if(s){var v=e.getUint16(s,r),y,S;for(S=0;S<v;S+=1)if(y=s+S*12+2,e.getUint16(y,r)===274){y+=8,t=e.getUint16(y,r),e.setUint16(y,1,r);break}}}catch{t=1}return t}function O8e(n){var e=0,t=1,r=1;switch(n){case 2:t=-1;break;case 3:e=-180;break;case 4:r=-1;break;case 5:e=90,r=-1;break;case 6:e=90;break;case 7:e=90,t=-1;break;case 8:e=-90;break}return{rotate:e,scaleX:t,scaleY:r}}var F8e=/\.\d*(?:0|9){12}\d*$/;function AJ(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return F8e.test(n)?Math.round(n*e)/e:n}function bA(n){var e=n.aspectRatio,t=n.height,r=n.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",s=ML(r),o=ML(t);if(s&&o){var l=t*e;(i==="contain"||i==="none")&&l>r||i==="cover"&&l<r?t=r/e:r=t*e}else s?t=r/e:o&&(r=t*e);return{width:r,height:t}}function N8e(n){for(var e=L8(new Uint8Array(n)),t=e.length,r=[],i=0;i+3<t;){var s=e[i],o=e[i+1];if(s===255&&o===218)break;if(s===255&&o===216)i+=2;else{var l=e[i+2]*256+e[i+3],a=i+l+2,h=e.slice(i,a);r.push(h),i=a}}return r.reduce(function(f,p){return p[0]===255&&p[1]===225?f.concat(p):f},[])}function z8e(n,e){var t=L8(new Uint8Array(n));if(t[2]!==255||t[3]!==224)return n;var r=t[4]*256+t[5],i=[255,216].concat(e,t.slice(4+r));return new Uint8Array(i)}var U8e=M0.ArrayBuffer,EN=M0.FileReader,sy=M0.URL||M0.webkitURL,G8e=/\.\w+$/,V8e=M0.Compressor,H8e=function(){function n(e,t){A8e(this,n),this.file=e,this.exif=[],this.image=new Image,this.options=FI(FI({},wJ),t),this.aborted=!1,this.result=null,this.init()}return T8e(n,[{key:"init",value:function(){var t=this,r=this.file,i=this.options;if(!C8e(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var s=r.type;if(!V5(s)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!sy||!EN){this.fail(new Error("The current browser does not support image compression."));return}U8e||(i.checkOrientation=!1,i.retainExif=!1);var o=s==="image/jpeg",l=o&&i.checkOrientation,a=o&&i.retainExif;if(sy&&!l&&!a)this.load({url:sy.createObjectURL(r)});else{var h=new EN;this.reader=h,h.onload=function(f){var p=f.target,v=p.result,y={},S=1;l&&(S=k8e(v),S>1&&TL(y,O8e(S))),a&&(t.exif=N8e(v)),l||a?!sy||S>1?y.url=SJ(v,s):y.url=sy.createObjectURL(r):y.url=v,t.load(y)},h.onabort=function(){t.fail(new Error("Aborted to read the image with FileReader."))},h.onerror=function(){t.fail(new Error("Failed to read the image with FileReader."))},h.onloadend=function(){t.reader=null},l||a?h.readAsArrayBuffer(r):h.readAsDataURL(r)}}},{key:"load",value:function(t){var r=this,i=this.file,s=this.image;s.onload=function(){r.draw(FI(FI({},t),{},{naturalWidth:s.naturalWidth,naturalHeight:s.naturalHeight}))},s.onabort=function(){r.fail(new Error("Aborted to load the image."))},s.onerror=function(){r.fail(new Error("Failed to load the image."))},M0.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(M0.navigator.userAgent)&&(s.crossOrigin="anonymous"),s.alt=i.name,s.src=t.url}},{key:"draw",value:function(t){var r=this,i=t.naturalWidth,s=t.naturalHeight,o=t.rotate,l=o===void 0?0:o,a=t.scaleX,h=a===void 0?1:a,f=t.scaleY,p=f===void 0?1:f,v=this.file,y=this.image,S=this.options,C=document.createElement("canvas"),M=C.getContext("2d"),E=Math.abs(l)%180===90,L=(S.resize==="contain"||S.resize==="cover")&&ML(S.width)&&ML(S.height),k=Math.max(S.maxWidth,0)||1/0,H=Math.max(S.maxHeight,0)||1/0,X=Math.max(S.minWidth,0)||0,Z=Math.max(S.minHeight,0)||0,Q=i/s,re=S.width,ie=S.height;if(E){var oe=[H,k];k=oe[0],H=oe[1];var fe=[Z,X];X=fe[0],Z=fe[1];var Se=[ie,re];re=Se[0],ie=Se[1]}L&&(Q=re/ie);var Ee=bA({aspectRatio:Q,width:k,height:H},"contain");k=Ee.width,H=Ee.height;var Ie=bA({aspectRatio:Q,width:X,height:Z},"cover");if(X=Ie.width,Z=Ie.height,L){var He=bA({aspectRatio:Q,width:re,height:ie},S.resize);re=He.width,ie=He.height}else{var Re=bA({aspectRatio:Q,width:re,height:ie}),st=Re.width;re=st===void 0?i:st;var _e=Re.height;ie=_e===void 0?s:_e}re=Math.floor(AJ(Math.min(Math.max(re,X),k))),ie=Math.floor(AJ(Math.min(Math.max(ie,Z),H)));var We=-re/2,Ue=-ie/2,vt=re,xt=ie,Vt=[];if(L){var lt=0,Ht=0,Qt=i,rn=s,jn=bA({aspectRatio:Q,width:i,height:s},{contain:"cover",cover:"contain"}[S.resize]);Qt=jn.width,rn=jn.height,lt=(i-Qt)/2,Ht=(s-rn)/2,Vt.push(lt,Ht,Qt,rn)}if(Vt.push(We,Ue,vt,xt),E){var Bn=[ie,re];re=Bn[0],ie=Bn[1]}C.width=re,C.height=ie,V5(S.mimeType)||(S.mimeType=v.type);var Tn="transparent";v.size>S.convertSize&&S.convertTypes.indexOf(S.mimeType)>=0&&(S.mimeType="image/jpeg");var Le=S.mimeType==="image/jpeg";if(Le&&(Tn="#fff"),M.fillStyle=Tn,M.fillRect(0,0,re,ie),S.beforeDraw&&S.beforeDraw.call(this,M,C),!this.aborted&&(M.save(),M.translate(re/2,ie/2),M.rotate(l*Math.PI/180),M.scale(h,p),M.drawImage.apply(M,[y].concat(Vt)),M.restore(),S.drew&&S.drew.call(this,M,C),!this.aborted)){var qe=function(cn){if(!r.aborted){var St=function(sn){return r.done({naturalWidth:i,naturalHeight:s,result:sn})};if(cn&&Le&&S.retainExif&&r.exif&&r.exif.length>0){var Jt=function(sn){return St(bJ(SJ(z8e(sn,r.exif),S.mimeType)))};if(cn.arrayBuffer)cn.arrayBuffer().then(Jt).catch(function(){r.fail(new Error("Failed to read the compressed image with Blob.arrayBuffer()."))});else{var kn=new EN;r.reader=kn,kn.onload=function(Gn){var sn=Gn.target;Jt(sn.result)},kn.onabort=function(){r.fail(new Error("Aborted to read the compressed image with FileReader."))},kn.onerror=function(){r.fail(new Error("Failed to read the compressed image with FileReader."))},kn.onloadend=function(){r.reader=null},kn.readAsArrayBuffer(cn)}}else St(cn)}};C.toBlob?C.toBlob(qe,S.mimeType,S.quality):qe(bJ(C.toDataURL(S.mimeType,S.quality)))}}},{key:"done",value:function(t){var r=t.naturalWidth,i=t.naturalHeight,s=t.result,o=this.file,l=this.image,a=this.options;if(sy&&l.src.indexOf("blob:")===0&&sy.revokeObjectURL(l.src),s)if(a.strict&&!a.retainExif&&s.size>o.size&&a.mimeType===o.type&&!(a.width>r||a.height>i||a.minWidth>r||a.minHeight>i||a.maxWidth<r||a.maxHeight<i))s=o;else{var h=new Date;s.lastModified=h.getTime(),s.lastModifiedDate=h,s.name=o.name,s.name&&s.type!==o.type&&(s.name=s.name.replace(G8e,L8e(s.type)))}else s=o;this.result=s,a.success&&a.success.call(this,s)}},{key:"fail",value:function(t){var r=this.options;if(r.error)r.error.call(this,t);else throw t}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=V8e,n}},{key:"setDefaults",value:function(t){TL(wJ,t)}}]),n}();const j8e="/about_portfolio/assets/biaozhun-C5OcRpNC.png",W8e="/about_portfolio/assets/target-DS1CVM5s.svg",ay=[iue,j8e,sue,Kce,aue,C8,oue,F5,Jce,S8,Qce,eue,A8,T8,lue,W8e,nue,uue,hue,fue,due,pue,mue,gue,rue,M8,E8,cue,tue],$8e=()=>{const[n,e]=Ae.useState(0),t=Array.from({length:ay.length}).map(()=>Ae.useRef(null)),r=Ae.useRef(null);return Ae.useEffect(()=>{if(n===1){const i=new IntersectionObserver(s=>{s.forEach(o=>{if(o.isIntersecting){let l=o.target;l.src=l.dataset.src,i.unobserve(l)}})});t.forEach(s=>{s.current&&i.observe(s.current)})}if(n===2&&ay.forEach((i,s)=>{fetch(i).then(o=>o.blob()).then(o=>{new H8e(o,{quality:.6,maxWidth:600,maxHeight:800,success(l){let a=URL.createObjectURL(l);t[s].current.src=a},error(l){console.log("error in compressor:",l)}})}).catch(o=>console.log("error in fetch:",o))}),n===3){const i=new IntersectionObserver(s=>{s[0].isIntersecting&&(ay.forEach((o,l)=>{l>10&&(t[l].current.src=o)}),i.unobserve(r.current))});r.current&&i.observe(r.current)}},[n]),me.jsxs("div",{className:"absolute flex w-screen top-20 flex-col items-center",children:[me.jsxs("header",{className:"flex w-full items-center justify-between border-b-2 border-b-black shadow-xl",children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:""}),me.jsx("div",{className:"mr-8 text-right",children:me.jsxs(Xce,{children:[me.jsxs(b8,{className:"inline-flex items-center gap-2 rounded-md bg-gray-800 py-1.5 px-3 text-sm/6 font-semibold text-white shadow-inner shadow-white/10 focus:outline-none data-[hover]:bg-gray-700 data-[open]:bg-gray-700 data-[focus]:outline-1 data-[focus]:outline-white",children:["",me.jsx(_8e,{className:"size-4 fill-white/60"})]}),me.jsxs(w8,{transition:!0,anchor:"bottom end",className:"w-52 origin-top-right rounded-xl border border-gray-800 bg-gray-700 p-1 text-sm/6 text-white transition duration-100 ease-out [--anchor-gap:var(--spacing-1)] focus:outline-none",children:[me.jsx(Vf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(0),children:['loading="lazy"',me.jsx(x8e,{className:"size-4 fill-white/30"})]})}),me.jsx(Vf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(1),children:["IntersectionObserver",me.jsx(w8e,{className:"size-4 fill-white/30"})]})}),me.jsx(Vf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(2),children:["",me.jsx(g8e,{className:"size-4 fill-white/30"})]})}),me.jsx(Vf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(3),children:["",me.jsx(_J,{className:"size-4 fill-white/30"})]})}),me.jsx(Vf,{children:me.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-lg py-1.5 px-3 data-[focus]:bg-black/10 justify-end",onClick:()=>e(4),children:["",me.jsx(_J,{className:"size-4 fill-white/30"})]})})]})]})})]}),me.jsx("div",{children:n===0&&ay.map((i,s)=>me.jsx("img",{src:i,alt:"",className:"w-full p-2",loading:"lazy"},s))}),n===1&&me.jsxs("div",{children:[me.jsxs("p",{children:[" ","vue@vueuse/core{useIntersectionObserver}dom"," "]}),me.jsx("p",{children:`useIntersectionObserver(refContent, ([{ isIntersecting }]) => {
    isVisible.value = isIntersecting; });`}),me.jsx("p",{children:"refContentdomisIntersectingrefdomisVisibleboolean"}),me.jsx("a",{href:"https://ruanyifeng.com/blog/2016/11/intersectionobserver_api.html",children:""}),ay.map((i,s)=>me.jsx("img",{ref:t[s],"data-src":i,alt:s,className:"w-full p-2"},s))]}),n===2&&me.jsxs("div",{children:[me.jsx("p",{children:""}),me.jsx("p",{children:"compressorjs"}),ay.map((i,s)=>me.jsx("img",{ref:t[s],alt:s,className:"w-full p-2"},s))]}),n===3&&me.jsxs("div",{children:[me.jsx("p",{children:"/"}),ay.map((i,s)=>me.jsxs("div",{children:[s<10&&me.jsx("img",{src:i,alt:s,className:"w-full p-2"},s),s===10&&me.jsx("p",{ref:r,children:"--------------------------------"}),s>10&&me.jsx("img",{ref:t[s],alt:s,className:"w-full  p-2"},s)]}))]}),n===4&&me.jsxs("div",{children:[me.jsx("div",{children:"* CDN"}),me.jsx("div",{children:"* "}),me.jsx("div",{children:"* ElementUIUI"})]})]})},X8e=()=>me.jsxs("div",{className:"absolute top-20 m-4 w-1/2 h-1/2 border-4 border-solid border-cyan-500",children:[me.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:me.jsx("p",{className:"whitespace-nowrap overflow-hidden text-ellipsis",children:"mmliugeojdgasedrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgd               egeeeeeeeeeeeeeeeeee         eeeeeeeeeeeddddddggga    aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})}),me.jsx("br",{}),me.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:me.jsx("p",{className:"whitespace-normal overflow-hidden break-all",children:"mmliugeojdgas      edrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgdegeee              eeeeeeeeeeeeeeeeeeeeeeeeeeddddddgggaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})}),me.jsx("br",{}),me.jsx("div",{className:"w-80 h-20 border-2 border-solid border-yellow-500",children:me.jsx("p",{className:"overflow-hidden break-all text-ellipsis line-clamp-3",children:"mmliugeojdgasedrfdghhohjorehorgjm;ldhl;d;goiprnb'dfgdegeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddddddgggaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"})})]}),q8e=()=>me.jsxs("div",{className:"absolute top-20 m-4 w-1/2",children:[me.jsx("p",{children:"input+buttoninput"}),me.jsx("br",{}),me.jsxs("div",{className:"flex",children:[me.jsx("input",{className:"border-2 flex-grow",type:"text"}),me.jsx("button",{className:"ml-2",children:"Search"})]})]}),Z8e=()=>me.jsx("div",{className:"absolute left-1/4 top-1/4 w-1/3 h-1/3",children:me.jsx("div",{className:"split-line",children:"SplitLine"})}),Y8e=()=>{const n={width:"200px",height:"200px",margin:"10px",border:"1px solid #000"};return me.jsxs("div",{className:"absolute top-20 p-4 w-full h-full flex flex-wrap content-start",children:[me.jsxs("div",{style:n,children:[me.jsx("p",{children:"1(,)flex + m-auto"}),me.jsx("div",{className:"flex w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"m-auto",children:"box1"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"2(,)grid + place-items-center"}),me.jsx("div",{className:"grid place-items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{children:"box2"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"3(,)table-cell + align-middle"}),me.jsx("div",{className:"table-cell text-center align-middle w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{children:"box3"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"4(,) + transform"}),me.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:"box4"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"5(,)"}),me.jsx("div",{className:"flex justify-center items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{children:"box5"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"5-1(,)"}),me.jsx("div",{className:"flex justify-center items-center border-4 border-solid border-red-500",children:me.jsx("div",{children:"box5"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"6()flex + m-auto"}),me.jsx("div",{className:"flex w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500 m-auto",children:"box1"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"7()grid + place-items-center"}),me.jsx("div",{className:"grid place-items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box2"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"8()table-cell + align-middle"}),me.jsx("div",{className:"table-cell text-center align-middle w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box3"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"9() + transform"}),me.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"absolute w-12 h-12 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 border-2 border-solid border-green-500",children:"box4"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"10()"}),me.jsx("div",{className:"flex justify-center items-center w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"w-12 h-12 border-2 border-solid border-green-500",children:"box5"})})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"11(),top-1/2 left-1/2 -ml- -mt-"}),me.jsx("div",{className:"relative w-24 h-24 border-4 border-solid border-red-500",children:me.jsx("div",{className:"absolute w-12 h-12 top-1/2 left-1/2 -ml-6 -mt-6 border-2 border-solid border-green-500",children:"box1"})})]})]})},K8e=()=>{const n={width:"200px",height:"200px",margin:"10px",border:"1px solid #000"},e={"font-size":"10px"},t={transform:"scale(0.83)"};return me.jsxs("div",{className:"absolute top-20 m-4 w-screen h-full flex",children:[me.jsxs("div",{style:n,children:[me.jsx("p",{children:"1, "}),me.jsx("div",{style:e,children:"box1"})]}),me.jsxs("div",{style:n,children:[me.jsx("p",{children:"2text-xs + scale(0.83),10/12"}),me.jsx("div",{className:"text-xs",style:t,children:"box2"})]}),me.jsx("div",{style:n,children:me.jsx("p",{children:"3htmlfont-size100pxfont-size1rem"})})]})},J8e=()=>{const n={display:"flex",height:"100px"},e={flex:"0 0 100px",backgroundColor:"red"},t={flexGrow:1,backgroundColor:"yellow"},r={display:"table",width:"100%"},i={display:"table-cell",width:"100px",height:"100px",backgroundColor:"red"},s={display:"table-cell",backgroundColor:"yellow"},o={display:"grid",gridTemplateColumns:"100px auto",gridTemplateRows:"100px"},l={backgroundColor:"red"},a={backgroundColor:"yellow"},h={width:"100%",overflow:"hidden"},f={display:"inline-block",width:"100px",height:"100px",backgroundColor:"red"},p={display:"inline-block",width:"calc(100% - 100px)",height:"100px",backgroundColor:"yellow"},v={width:"100%",overflow:"hidden"},y={display:"inline-block",position:"absolute",left:0,right:0,width:"100px",height:"100px",backgroundColor:"red"},S={display:"inline-block",marginLeft:"100px",width:"calc(100% - 100px)",height:"100px",backgroundColor:"yellow"};return me.jsxs("div",{className:"absolute w-screen top-20 ",children:[me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: flex; right: flex-grow = 1"}),me.jsxs("div",{style:n,children:[me.jsx("div",{style:e,children:"left"}),me.jsx("div",{style:t,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: grid, grid-template-rows, grid-template-cols;"}),me.jsxs("div",{style:o,children:[me.jsx("div",{style:l,children:"left"}),me.jsx("div",{style:a,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"father: table,; left/right: table-cell"}),me.jsxs("div",{style:r,children:[me.jsx("div",{style:i,children:"left"}),me.jsx("div",{style:s,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"right: calcwidth"}),me.jsxs("div",{style:h,children:[me.jsx("div",{style:f,children:"left"}),me.jsx("div",{style:p,children:"right"})]})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"leftabsolute,rightmargin-leftleft"}),me.jsxs("div",{style:v,children:[me.jsx("div",{style:y,children:"left"}),me.jsx("div",{style:S,children:"right"})]})]})]})},Q8e=()=>{const n={height:"1px",background:"black",transform:"scaleY(0.5)",transformOrigin:"50% 100%"},e={height:"1px",background:"black",boxShadow:"0 0 0.5px  black"};return Ae.useEffect(()=>{document.addEventListener("contextmenu",t=>{t.preventDefault()}),document.addEventListener("selectstart",t=>{t.preventDefault()}),document.addEventListener("copy",t=>{t.preventDefault()}),document.addEventListener("cut",t=>{t.preventDefault()})},[]),me.jsxs("div",{className:"absolute w-screen top-20 ",children:[me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"transform: scaleY(0.5)"}),me.jsx("div",{style:n})]}),me.jsxs("div",{children:[me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:"box-shadow"}),me.jsx("div",{style:e})]}),me.jsx("div",{children:me.jsx("div",{className:"ml-8 font-sans font-bold text-lg",children:""})})]})},eVe=[{title:"-",company_name:"",icon:ATe,iconBg:"#FFFFFF",mainColor:"#008CCB",date:"2021.07-2021.08",points:["",""]},{title:"-",company_name:"AR",icon:TTe,iconBg:"#FFFFFF",mainColor:"#C366A1",date:"2023.07 -2023.08",points:["AR AR ","","Windows AR APP Windows AR AR ","unity c# Lua AR "]},{title:"Web Developer",company_name:"",icon:STe,iconBg:"#FFFFFF",mainColor:"#2BA6DF",date:"2024.06-2024.08",points:["Developing and maintaining web applications using React.js and other related technologies.","Collaborating with cross-functional teams including designers, product managers, and other developers to create high-quality products.","Implementing responsive design and ensuring cross-browser compatibility.","Participating in code reviews and providing constructive feedback to other developers."]},{title:"",company_name:"GIS",icon:MTe,iconBg:"#FFFFFF",mainColor:"#AF2020",date:"2023.09",points:["","","",""]}],tVe=[{name:"619",date:"2019.12",color:"#0076FF"},{name:" ",date:"2020.05",color:"#2B9D4A"},{name:"  ",date:"2020.05",color:"#2B9D4A"},{name:"  ",date:"2020.08",color:"#0076FF"},{name:"567",date:"2020.09",color:"#0076FF"},{name:"",date:"2020.11",color:"#FAC11B"},{name:" ",date:"2020.11",color:"#2B9D4A"},{name:" ",date:"2020.12",color:"#2B9D4A"},{name:"  ",date:"2020.12",color:"#2B9D4A"},{name:"C  ",date:"2020.12",color:"#0076FF"},{name:"  A",date:"2020.12",color:"#0076FF"},{name:" ",date:"2021.03",color:"#2B9D4A"},{name:" ",date:"2021.05",color:"#2B9D4A"},{name:"  ",date:"2021.05",color:"#2B9D4A"},{name:"  ",date:"2021.05",color:"#2B9D4A"},{name:"    ",date:"2021.06",color:"#0076FF"},{name:"  ",date:"2021.08",color:"#0076FF"},{name:"",date:"2021.11",color:"#FAC11B"},{name:"  ",date:"2021.11",color:"#2B9D4A"},{name:"GIS",date:"2021.11",color:"#0076FF"},{name:" ",date:"2021.12",color:"#2B9D4A"},{name:"SuperMap GIS ",date:"2022.01",color:"#2B9D4A"},{name:"  A",date:"2022.03",color:"#0076FF"},{name:"  ",date:"2022.05",color:"#2B9D4A"},{name:"Interdisciplinary Contest In Modeling",date:"2022.05",color:"#2B9D4A"},{name:" C/C++ ",date:"2022.05",color:"#2B9D4A"},{name:"  ",date:"2022.06",color:"#0076FF"},{name:"",date:"2022.11",color:"#FAC11B"},{name:" ",date:"2022.12",color:"#2B9D4A"},{name:"  ",date:"2022.12",color:"#2B9D4A"},{name:"  ",date:"2023.05",color:"#2B9D4A"},{name:"  ",date:"2023.05",color:"#2B9D4A"},{name:"  ",date:"2023.11",color:"#2B9D4A"},{name:"  ",date:"2024.06",color:"#2B9D4A"},{name:"12  ",date:"2024.08",color:"#2B9D4A"},{name:"115 ",date:"2024.09",color:"#0076FF"},{name:"  ",date:"2024.11",color:"#2B9D4A"},{name:" ",date:"2024.11",color:"#2B9D4A"},{name:"",date:"2024.12",color:"#2B9D4A"},{name:"International Cartographic Association Scholarship",date:"2024.12",color:"#2B9D4A"}],nVe=tVe.reverse(),rVe=[{iconUrl:vTe,theme:"btn-back-red",name:"",description:`(2021.10 -2021.12)

KeplerKepler.gl OD 
HTML CSS BootStrap supermap iclient for leaflet SuperMapSuperMap.iserver SQL APIAPIPOI `,link:"https://github.com/youxt-njnu/XuXiaKe"},{iconUrl:_Te,theme:"btn-back-pink",name:"",description:`C#GIS(2021.10 -2021.12) 
dotspatial C# .net GIS  ,,, `,link:"https://github.com/youxt-njnu/ProjectSnapshot/blob/master/c%23%E4%B8%8EGIS%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91-%E5%9C%9F%E5%A3%A4%E5%9B%BE%E6%96%91%E8%AF%86%E5%88%AB%E4%B8%8E%E5%B1%9E%E6%80%A7%E9%A2%84%E6%B5%8B%E7%B3%BB%E7%BB%9F.pdf"},{iconUrl:wTe,theme:"btn-back-green",name:"",description:`(2022.04-2022.06) 

 3D
Mapbox JS JS, Bootstrap Echarts `,link:"https://github.com/youxt-njnu/Milk"},{iconUrl:nie,theme:"btn-back-blue",name:"GIS",description:`GIS WebGIS (2022.10 -2022.12)
Axure QGIS postgresql geoserverJquery Ajax httphttp-server openlayer Mapbox echarts `,link:"https://github.com/youxt-njnu/hgisworkHD"},{iconUrl:bTe,theme:"btn-back-yellow",name:"Flappy Bird",description:`XluaFlappy Birdc#(2023.08-2023.09)
Flappy Bird is a mobile game developed by Vietnamese video game artist and programmer Dong Nguyen. The game is a side-scroller where the player controls a bird, attempting to fly between columns of green pipes without hitting them.`,link:"https://github.com/youxt-njnu/flappy_bird_xlua"},{iconUrl:gTe,theme:"btn-back-black",name:"AR",description:`AR(2023.12-2024.06)
 GISARARAR`,link:"https://mp.weixin.qq.com/s?__biz=MzU4MTc2MDAyNg==&mid=2247484289&idx=1&sn=ca9ab0ac73791c6a453b5d0364130248&chksm=fc6d6a49da4532c55ff74676bd34092d37bd742f1ee040c1740ca72043ab6e9050428ac70ce1&scene=126&sessionid=1724225266#rd"}],ms="/arts/",Iue=[{name:"",img:"https://s2.loli.net/2024/10/17/yexj6A8cqVvMKDN.png",path:ms+"sky",component:kTe,type:"",info:""},{name:"",img:"https://dragonir.github.io/3d/static/media/earthDigital.8c221282f247bb724b85.png",path:ms+"earth-digital",component:RNe,type:"",info:"3Dshader..."},{name:"",img:"https://s2.loli.net/2024/10/05/Ypj16zckvyd78Do.png",path:ms+"earth-moving",component:XNe,type:"",info:"geometry"},{name:"",img:"https://s2.loli.net/2024/10/05/WiUuGJ3CbnagLc6.png",path:ms+"light-model",component:R4e,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/18/16FgOsBTyM8NntV.png",path:ms+"descent-3d",component:L4e,type:"ShaderToy",info:"ShaderToy3D"},{name:"",img:"https://s2.loli.net/2024/11/29/53zmKr7wkDXvEOV.png",path:ms+"box-rotate",component:D4e,type:"rotate",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/xOVH39vBsNUohSE.png",path:ms+"multimedia",component:F4e,type:"multimedia",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/oHnINiSMd9mua7z.png",path:ms+"multimedia2",component:$4e,type:"multimedia",info:"gltfdraco"},{name:"",img:"https://s2.loli.net/2024/11/29/D48EJRLzi5kofpw.png",path:ms+"particle",component:S6e,type:"particle",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/36QACaqtnJ5FHyX.png",path:ms+"astronaut-particle",component:M6e,type:"particle",info:""},{name:"",img:"https://s2.loli.net/2024/11/29/MUL51g9qBvkbtiO.png",path:ms+"postprocess-box",component:P6e,type:"",info:""},{name:"RickMorty",img:"https://s2.loli.net/2024/11/29/Sfsr5BiyhOXI7mc.png",path:ms+"rick-morty",component:F6e,type:"",info:""},{name:"ShaderPattern",img:"https://s2.loli.net/2024/11/29/19j8O2X3ofJuT7F.png",path:ms+"shader-pattern",component:U6e,type:"",info:""}],Rue=[{name:"",img:"https://s2.loli.net/2024/10/17/OsrIyLWMmZ6Ezpk.png",path:ms+"mapbox-simple",component:V6e,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/08/tDnLboVM1TEu47K.png",path:ms+"milk-story",component:iGe,type:"",info:""}],Pue=[{name:"html+css ",img:"https://s2.loli.net/2024/11/16/KmZYDPr6bvtiW5V.png",path:ms+"bar-pie",component:sGe,type:"html+css",info:""},{name:"CanvasDemo",img:"https://s2.loli.net/2024/11/26/A7GhwiavVftz2P3.png",path:ms+"canvas-demo",component:jGe,type:"canvas",info:"canvas"},{name:"WebglUseage",img:"https://s2.loli.net/2025/02/11/DrYwPM5lGSAb2jf.png",path:ms+"webgl-useage",component:WGe,type:"webgl",info:"webgl"},{name:"roughUsage",img:"https://s2.loli.net/2024/12/14/HNgQxS9EdbOqKnF.png",path:ms+"rough-usage",component:l8e,type:"rough",info:""},{name:"randomTree",img:"https://s2.loli.net/2024/12/14/EipXTY8VClbhZ2R.png",path:ms+"random-tree",component:c8e,type:"vector2d",info:"vector2d"},{name:"ParametricEquation",img:"https://s2.loli.net/2025/02/11/6Bv1UXZqFPRaCu5.png",path:ms+"parametric-equation",component:u8e,type:"parametric",info:""}],Lue=[{name:"",img:"https://s2.loli.net/2024/11/06/ozbCSmLM4FHTfXn.png",path:ms+"holy-grail",component:p8e,type:"flex",info:""},{name:"",img:"https://s2.loli.net/2024/11/06/PnIGVfoybwmxq1e.png",path:ms+"hanging",component:d8e,type:"flex",info:""},{name:"",img:"https://s2.loli.net/2024/11/06/ZWJEAH8I9XdKyzl.png",path:ms+"float",component:f8e,type:"flex",info:"flex wrapflex content"},{name:"",img:"https://s2.loli.net/2024/11/08/KTBDMSPIRjyZtxr.png",path:ms+"split-line",component:Z8e,type:"",info:"::before, ::after"},{name:"",img:"https://s2.loli.net/2024/11/16/kpwcFnbIV64gJlo.png",path:ms+"img-load",component:$8e,type:"",info:""},{name:"",img:"https://s2.loli.net/2024/11/16/chJoFXtiAQOIZ24.png",path:ms+"vertical-center",component:Y8e,type:"css",info:""},{name:"10px",img:"https://s2.loli.net/2024/11/16/6UAxNLktFWEp19D.png",path:ms+"px10",component:K8e,type:"css",info:"10px"},{name:"",img:"https://s2.loli.net/2024/11/16/STwlbGxRraoVyvt.png",path:ms+"multi-line",component:X8e,type:"css",info:""},{name:"",img:"https://s2.loli.net/2024/11/16/TGhwNUIS4juCtAP.png",path:ms+"search-btn",component:q8e,type:"css",info:""},{name:"",img:"https://s2.loli.net/2024/11/27/jt7IVgvzb5Scuk8.png",path:ms+"two-band",component:J8e,type:"css",info:""},{name:"0.5px",img:"https://s2.loli.net/2024/11/27/m5CWc6qbVNaH9GJ.png",path:ms+"line05",component:Q8e,type:"css",info:"0.5px+"},{name:"",img:"https://s2.loli.net/2024/11/16/m8LDxkrKYtHVG94.png",path:ms+"draw-poly",component:h8e,type:"css",info:"CSS"}];var LB={},Due={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var s="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(s=i(s,r(l)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return t.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var o="";for(var l in s)e.call(s,l)&&s[l]&&(o=i(o,l));return o}function i(s,o){return o?s?s+" "+o:s+o:s}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(Due);var Bue=Due.exports;LB.__esModule=!0;LB.default=void 0;var iVe=D8(Ae),Iv=D8(Kre),sVe=D8(Bue);function D8(n){return n&&n.__esModule?n:{default:n}}const kue=({animate:n=!0,className:e="",layout:t="2-columns",lineColor:r="#FFF",children:i})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",r),iVe.default.createElement("div",{className:(0,sVe.default)(e,"vertical-timeline",{"vertical-timeline--animate":n,"vertical-timeline--two-columns":t==="2-columns","vertical-timeline--one-column-left":t==="1-column"||t==="1-column-left","vertical-timeline--one-column-right":t==="1-column-right"})},i));kue.propTypes={children:Iv.default.oneOfType([Iv.default.arrayOf(Iv.default.node),Iv.default.node]).isRequired,className:Iv.default.string,animate:Iv.default.bool,layout:Iv.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:Iv.default.string};var aVe=kue;LB.default=aVe;var DB={};function H5(){return H5=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},H5.apply(this,arguments)}function oVe(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,j5(n,e)}function j5(n,e){return j5=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},j5(n,e)}function lVe(n,e){if(n==null)return{};var t={},r=Object.keys(n),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(t[i]=n[i]);return t}var W5=new Map,NI=new WeakMap,TJ=0,Oue=void 0;function cVe(n){Oue=n}function uVe(n){return n?(NI.has(n)||(TJ+=1,NI.set(n,TJ.toString())),NI.get(n)):"0"}function hVe(n){return Object.keys(n).sort().filter(function(e){return n[e]!==void 0}).map(function(e){return e+"_"+(e==="root"?uVe(n.root):n[e])}).toString()}function fVe(n){var e=hVe(n),t=W5.get(e);if(!t){var r=new Map,i,s=new IntersectionObserver(function(o){o.forEach(function(l){var a,h=l.isIntersecting&&i.some(function(f){return l.intersectionRatio>=f});n.trackVisibility&&typeof l.isVisible>"u"&&(l.isVisible=h),(a=r.get(l.target))==null||a.forEach(function(f){f(h,l)})})},n);i=s.thresholds||(Array.isArray(n.threshold)?n.threshold:[n.threshold||0]),t={id:e,observer:s,elements:r},W5.set(e,t)}return t}function B8(n,e,t,r){if(t===void 0&&(t={}),r===void 0&&(r=Oue),typeof window.IntersectionObserver>"u"&&r!==void 0){var i=n.getBoundingClientRect();return e(r,{isIntersecting:r,target:n,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:i,intersectionRect:i,rootBounds:i}),function(){}}var s=fVe(t),o=s.id,l=s.observer,a=s.elements,h=a.get(n)||[];return a.has(n)||a.set(n,h),h.push(e),l.observe(n),function(){h.splice(h.indexOf(e),1),h.length===0&&(a.delete(n),l.unobserve(n)),a.size===0&&(l.disconnect(),W5.delete(o))}}var dVe=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function MJ(n){return typeof n.children!="function"}var EL=function(n){oVe(e,n);function e(r){var i;return i=n.call(this,r)||this,i.node=null,i._unobserveCb=null,i.handleNode=function(s){i.node&&(i.unobserve(),!s&&!i.props.triggerOnce&&!i.props.skip&&i.setState({inView:!!i.props.initialInView,entry:void 0})),i.node=s||null,i.observeNode()},i.handleChange=function(s,o){s&&i.props.triggerOnce&&i.unobserve(),MJ(i.props)||i.setState({inView:s,entry:o}),i.props.onChange&&i.props.onChange(s,o)},i.state={inView:!!r.initialInView,entry:void 0},i}var t=e.prototype;return t.componentDidUpdate=function(i){(i.rootMargin!==this.props.rootMargin||i.root!==this.props.root||i.threshold!==this.props.threshold||i.skip!==this.props.skip||i.trackVisibility!==this.props.trackVisibility||i.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},t.componentWillUnmount=function(){this.unobserve(),this.node=null},t.observeNode=function(){if(!(!this.node||this.props.skip)){var i=this.props,s=i.threshold,o=i.root,l=i.rootMargin,a=i.trackVisibility,h=i.delay,f=i.fallbackInView;this._unobserveCb=B8(this.node,this.handleChange,{threshold:s,root:o,rootMargin:l,trackVisibility:a,delay:h},f)}},t.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},t.render=function(){if(!MJ(this.props)){var i=this.state,s=i.inView,o=i.entry;return this.props.children({inView:s,entry:o,ref:this.handleNode})}var l=this.props,a=l.children,h=l.as,f=lVe(l,dVe);return Ae.createElement(h||"div",H5({ref:this.handleNode},f),a)},e}(Ae.Component);EL.displayName="InView";EL.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function pVe(n){var e=n===void 0?{}:n,t=e.threshold,r=e.delay,i=e.trackVisibility,s=e.rootMargin,o=e.root,l=e.triggerOnce,a=e.skip,h=e.initialInView,f=e.fallbackInView,p=Ae.useRef(),v=Ae.useState({inView:!!h}),y=v[0],S=v[1],C=Ae.useCallback(function(E){p.current!==void 0&&(p.current(),p.current=void 0),!a&&E&&(p.current=B8(E,function(L,k){S({inView:L,entry:k}),k.isIntersecting&&l&&p.current&&(p.current(),p.current=void 0)},{root:o,rootMargin:s,threshold:t,trackVisibility:i,delay:r},f))},[Array.isArray(t)?t.toString():t,o,s,l,a,i,f,r]);Ae.useEffect(function(){!p.current&&y.entry&&!l&&!a&&S({inView:!!h})});var M=[C,y.inView,y.entry];return M.ref=M[0],M.inView=M[1],M.entry=M[2],M}const mVe=Object.freeze(Object.defineProperty({__proto__:null,InView:EL,default:EL,defaultFallbackInView:cVe,observe:B8,useInView:pVe},Symbol.toStringTag,{value:"Module"})),gVe=Wde(mVe);DB.__esModule=!0;DB.default=void 0;var Rv=k8(Ae),Aa=k8(Kre),zI=k8(Bue),vVe=gVe;function k8(n){return n&&n.__esModule?n:{default:n}}const Fue=({children:n="",className:e="",contentArrowStyle:t=null,contentStyle:r=null,date:i="",dateClassName:s="",icon:o=null,iconClassName:l="",iconOnClick:a=null,onTimelineElementClick:h=null,iconStyle:f=null,id:p="",position:v="",style:y=null,textClassName:S="",intersectionObserverProps:C={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:M=!1})=>Rv.default.createElement(vVe.InView,C,({inView:E,ref:L})=>Rv.default.createElement("div",{ref:L,id:p,className:(0,zI.default)(e,"vertical-timeline-element",{"vertical-timeline-element--left":v==="left","vertical-timeline-element--right":v==="right","vertical-timeline-element--no-children":n===""}),style:y},Rv.default.createElement(Rv.default.Fragment,null,Rv.default.createElement("span",{style:f,onClick:a,className:(0,zI.default)(l,"vertical-timeline-element-icon",{"bounce-in":E||M,"is-hidden":!(E||M)})},o),Rv.default.createElement("div",{style:r,onClick:h,className:(0,zI.default)(S,"vertical-timeline-element-content",{"bounce-in":E||M,"is-hidden":!(E||M)})},Rv.default.createElement("div",{style:t,className:"vertical-timeline-element-content-arrow"}),n,Rv.default.createElement("span",{className:(0,zI.default)(s,"vertical-timeline-element-date")},i)))));Fue.propTypes={children:Aa.default.oneOfType([Aa.default.arrayOf(Aa.default.node),Aa.default.node]),className:Aa.default.string,contentArrowStyle:Aa.default.shape({}),contentStyle:Aa.default.shape({}),date:Aa.default.node,dateClassName:Aa.default.string,icon:Aa.default.element,iconClassName:Aa.default.string,iconStyle:Aa.default.shape({}),iconOnClick:Aa.default.func,onTimelineElementClick:Aa.default.func,id:Aa.default.string,position:Aa.default.string,style:Aa.default.shape({}),textClassName:Aa.default.string,visible:Aa.default.bool,intersectionObserverProps:Aa.default.shape({root:Aa.default.object,rootMargin:Aa.default.string,threshold:Aa.default.number,triggerOnce:Aa.default.bool})};var _Ve=Fue;DB.default=_Ve;var CL={VerticalTimeline:LB.default,VerticalTimelineElement:DB.default};const O8=()=>{const{t:n}=Iw();return me.jsxs("section",{className:"cta",children:[me.jsxs("p",{className:"cta-text",children:[n("contact.info")," ",me.jsx("br",{className:"sm:block hidden"}),n("contact.btnText")," "]}),me.jsx(jv,{to:"/contact",className:"btn",children:n("contact.title")})]})},yVe=()=>{const{t:n}=Iw();return me.jsxs("section",{className:"max-container",children:[me.jsxs("h1",{className:"head-text",children:[n("greeting")," ",me.jsxs("span",{className:"blue-gradient_text font-semibold drop-shadow",children:[" ",n("name")," "]})]}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsxs("p",{children:[n("concat")," "]}),me.jsx("p",{children:n("email")}),me.jsx("p",{children:n("policy")}),me.jsx("p",{children:n("research.main")}),me.jsx("p",{children:me.jsxs("ul",{class:"list-disc",children:[me.jsx("li",{children:n("research.gis")}),me.jsx("li",{children:n("research.fe")}),me.jsx("li",{children:n("research.ar")}),me.jsx("li",{children:n("research.future")})]})})]}),me.jsx("div",{className:"py-8 flex flex-col",children:me.jsx("h3",{className:"subhead-text",children:""})}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsx("h4",{className:"text-slate-800",children:"GPA:4.22/52019.09~2023.07"}),me.jsx("p",{children:"GIScience"}),me.jsx("p",{children:"(99)(96)C++GIS(98)C#GIS(97)GIS(95)"}),me.jsx("p",{children:"38322021H2021C/C++ "}),me.jsx("h4",{className:"text-slate-800",children:"2023.09"}),me.jsx("p",{children:""}),me.jsx("p",{children:"2024202412"})]}),me.jsx("div",{className:"py-8 flex flex-col",children:me.jsx("h3",{className:"subhead-text",children:""})}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsx("h4",{className:"text-slate-800",children:""}),me.jsx("p",{children:"You, X., Chen, G.*, & Duan, J. Exploring Traffic Planning Networks across Multiple Scales Based on Urban Morphology: A Case Study of Nanjing, China. Journal of Urban Planning and Development. https://doi.org/10.1061/JUPDDM/UPENG-5086."}),me.jsx("p",{children:"Duan, J., Zhao, Z., Xu, Y., You, X., Yang, F., & Chen, G.* (2024). Spatial distribution characteristics and driving factors of Little Giant enterprises in Chinas megacity clusters based on random forest and MGWR. Land, 13(7), 1105. https://doi.org/10.3390/land13071105."}),me.jsx("p",{children:"Deng, Z., You, X., Shi, Z., Gao, H., Hu, X., Yu, Z., & Yuan, L.* (2022). Identification of urban functional zones based on the spatial specificity of online car-hailing traffic cycle. ISPRS International Journal of Geo-Information, 11(8), 435. https://doi.org/10.3390/ijgi11080435."}),me.jsx("h4",{className:"text-slate-800",children:""}),me.jsx("p",{children:". *,,,,,"}),me.jsx("p",{children:". *,,,,,,"}),me.jsx("p",{children:".*,,,,,"}),me.jsx("p",{children:""})]}),me.jsx("div",{className:"py-8 flex flex-col",children:me.jsx("h3",{className:"subhead-text",children:""})}),me.jsxs("div",{className:"mt-2 flex flex-col gap-3 text-slate-500",children:[me.jsxs("p",{children:["2023 AR ",me.jsx("br",{}),"1. 20802020",me.jsx("br",{}),"2.  AR ",me.jsx("br",{}),"3.  AR "]}),me.jsxs("p",{children:["2020-2023,",me.jsx("br",{}),"1. ",me.jsx("br",{}),"2. "]}),me.jsx("p",{children:"2021-2022"}),me.jsx("p",{children:"2019-2020AHP-"})]}),me.jsxs("div",{className:"py-16",children:[me.jsx("h3",{className:"subhead-text",children:""}),me.jsx("div",{className:"mt-2 flex flex-col gap-3 text-slate-500 "}),me.jsx("div",{className:"mt-12 flex",children:me.jsx(CL.VerticalTimeline,{layout:"1-column-left",children:nVe.map(e=>me.jsx(CL.VerticalTimelineElement,{date:e.date,icon:me.jsx("div",{className:"flex justify-center items-center w-full h-full",children:me.jsx("img",{src:mTe,alt:e.name,className:"w-[60%] h-[60%] object-contain"})}),iconStyle:{background:"white"},contentStyle:{borderBottom:"8px",borderStyle:"solid",borderBottomColor:e.color,boxShadow:"none"},children:me.jsx("div",{children:me.jsx("h3",{className:"text-black text-xl font-poppins font-semibold",children:e.name})})},e.name))})})]}),me.jsx("hr",{className:"border-slate-200"}),me.jsx(O8,{})]})},UI=n=>me.jsxs("div",{className:"group relative",children:[me.jsx("div",{className:"relative h-80 w-full overflow-hidden rounded-lg bg-white sm:aspect-h-1 sm:aspect-w-2 lg:aspect-h-1 lg:aspect-w-1 group-hover:opacity-75 sm:h-64",children:me.jsx("img",{src:n.img,alt:n.name,className:"h-full w-full object-cover object-center"})}),me.jsx("h3",{className:"mt-1 text-sm text-slate-500",children:me.jsxs("div",{children:[me.jsx("span",{className:"absolute inset-0"}),n.type]})}),me.jsx("p",{className:"mb-3 text-base font-semibold text-slate-900",children:n.info})]}),xVe=()=>me.jsxs("section",{className:"max-container",children:[me.jsxs("h1",{className:"head-text",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:"ThreeJS"})," Works "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-6 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:Iue.map((n,e)=>me.jsx(jv,{to:n.path,children:me.jsx(UI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsxs("h1",{className:"head-text mt-6",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:"Mapbox GL JS"})," Works "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:Rue.map((n,e)=>me.jsx(jv,{to:n.path,children:me.jsx(UI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsxs("h1",{className:"head-text mt-6",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:" 2D"})," Visualization "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:Pue.map((n,e)=>me.jsx(jv,{to:n.path,children:me.jsx(UI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsxs("h1",{className:"head-text mt-6",children:[" ",me.jsx("span",{className:"blue-gradient_text font-semibold drop-shadow",children:""}),"  "]}),me.jsx("div",{className:"py-10",children:me.jsx("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:me.jsx("div",{className:"mt-3 space-y-12 lg:grid lg:grid-cols-3 lg:gap-x-6 lg:space-y-0",children:Lue.map((n,e)=>me.jsx(jv,{to:n.path,children:me.jsx(UI,{...n})},e))})})}),me.jsx("hr",{className:"border-slate-200"}),me.jsx(O8,{})]}),LM={_origin:"https://api.emailjs.com"},bVe=(n,e="https://api.emailjs.com")=>{LM._userID=n,LM._origin=e},Nue=(n,e,t)=>{if(!n)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class EJ{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const zue=(n,e,t={})=>new Promise((r,i)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{const l=new EJ(o);l.status===200||l.text==="OK"?r(l):i(l)}),s.addEventListener("error",({target:o})=>{i(new EJ(o))}),s.open("POST",LM._origin+n,!0),Object.keys(t).forEach(o=>{s.setRequestHeader(o,t[o])}),s.send(e)}),wVe=(n,e,t,r)=>{const i=r||LM._userID;return Nue(i,n,e),zue("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:i,service_id:n,template_id:e,template_params:t}),{"Content-type":"application/json"})},SVe=n=>{let e;if(typeof n=="string"?e=document.querySelector(n):e=n,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},AVe=(n,e,t,r)=>{const i=r||LM._userID,s=SVe(t);Nue(i,n,e);const o=new FormData(s);return o.append("lib_version","3.11.0"),o.append("service_id",n),o.append("template_id",e),o.append("user_id",i),zue("/api/v1.0/email/send-form",o)},TVe={init:bVe,send:wVe,sendForm:AVe},MVe=({type:n,text:e})=>me.jsx("div",{className:"absolute top-10 left-0 right-0 flex justify-center items-center",children:me.jsxs("div",{className:`${n==="danger"?"bg-red-800":"bg-blue-800"} p-2 text-indigo-100 leading-none lg:rounded-full flex lg:inline-flex items-center`,role:"alert",children:[me.jsx("p",{className:`${n==="danger"?"bg-red-500":"bg-blue-500"} flex rounded-full uppercase px-2 py-1 font-semibold mr-3 text-xs`,children:n==="danger"?"Failed":"Success"}),me.jsxs("p",{className:"mr-2 text-left",children:[" ",e," "]})]})}),EVe=()=>{const[n,e]=Ae.useState({show:!1,text:"",type:"danger"});return{alert:n,showAlert:({text:i,type:s="danger"})=>e({show:!0,text:i,type:s}),hideAlert:()=>e({show:!1,text:"",type:"danger"})}},CVe=()=>{const n=Ae.useRef(null),[e,t]=Ae.useState({name:"",email:"",message:""}),[r,i]=Ae.useState(!1),[s,o]=Ae.useState("idle"),{alert:l,showAlert:a,hideAlert:h}=EVe(),f=S=>{t({...e,[S.target.name]:S.target.value})},p=()=>{o("walk")},v=()=>{o("idle")},y=S=>{S.preventDefault(),i(!0),o("hit"),TVe.send("service_5bezaam","template_dafnzfi",{from_name:e.name,to_name:"Shealin",from_email:e.email,to_email:"yikeyouIl@gmail.com",message:e.message},"JpbkxBEdlS8faxCrq").then(()=>{i(!1),a({show:!0,text:"Your message has been sent successfully!",type:"success"}),setTimeout(()=>{h(),o("idle"),t({name:"",email:"",message:""})},[3e3])}).catch(C=>{i(!1),o("idle"),console.log(C),a({show:!0,text:"I didn't receive your message",type:"danger"})})};return me.jsxs("section",{className:"relative flex lg:flex-row flex-col max-container h-[100vh]",children:[l.show&&me.jsx(MVe,{...l}),me.jsxs("div",{className:"flex-1 min-w-[50%] flex flex-col",children:[me.jsx("h1",{className:"head-text",children:"Get in Touch"}),me.jsxs("form",{action:"",className:"w-full flex flex-col gap-7 mt-14",ref:n,onSubmit:y,children:[me.jsxs("label",{className:"text-black-500 font-semibold",children:["Name",me.jsx("input",{type:"text",name:"name",className:"input",placeholder:"John",required:!0,value:e.name,onChange:f,onFocus:p,onBlur:v})]}),me.jsxs("label",{className:"text-black-500 font-semibold",children:["Email",me.jsx("input",{type:"email",name:"email",className:"input",placeholder:"John@gmail.com",required:!0,value:e.email,onChange:f,onFocus:p,onBlur:v})]}),me.jsxs("label",{className:"text-black-500 font-semibold",children:["Your Message",me.jsx("textarea",{name:"message",rows:"4",className:"textarea",placeholder:"Let me know how I can help you!",required:!0,value:e.message,onChange:f,onFocus:p,onBlur:v})]}),me.jsx("button",{type:"submit",className:"btn",disabled:r,onFocus:p,onBlur:v,children:r?"Sending...":"Submit"})]})]}),me.jsx("div",{className:"lg:w-1/2 w-full lg:h-auto md:h-[550px] h-[350px]",children:me.jsxs(Vre,{camera:{position:[0,0,5],fov:75,near:.1,far:1e3},children:[me.jsx("ambientLight",{intensity:.5}),me.jsx("directionalLight",{intensity:2.5,position:[0,0,1]}),me.jsx(Ae.Suspense,{fallback:me.jsx(F6,{}),children:me.jsx(BNe,{currentAnimation:s,position:[.5,.35,0],rotation:[12.6,-.5,0],scale:[.5,.5,.5]})})]})})]})},IVe="/about_portfolio/assets/sakura-Dh6hhofb.mp3",CN=({text:n,link:e,btnText:t})=>me.jsxs("div",{className:"info-box",children:[me.jsx("p",{className:"whitespace-pre-wrap font-medium sm:text-xl text-center",children:n}),me.jsxs(jv,{to:e,className:"neo-brutalism-white neo-btn",children:[t,me.jsx("img",{src:tie,className:"w-4 h-4 object-contain"})]})]}),RVe=({currentStage:n})=>{const{t:e}=Iw();return{1:me.jsxs("h1",{className:"sm:text-xl sm:leading-snug text-center neo-brutalism-blue py-4 px-8 text-white mx-5",children:[e("greeting")," ",me.jsx("span",{className:"font-semibold",children:e("name")})," ",me.jsx("br",{}),e("basicInfo")]}),2:me.jsx(CN,{text:e("aboutMe.info"),link:"/about",btnText:e("aboutMe.btnText")}),3:me.jsx(CN,{text:e("projects.info"),link:"/projects",btnText:e("projects.btnText")}),4:me.jsx(CN,{text:e("contact.info"),link:"/contact",btnText:e("contact.btnText")})}[n]||null};var PVe=Object.defineProperty,LVe=(n,e)=>{for(var t in e)PVe(n,t,{get:e[t],enumerable:!0})},_w={};LVe(_w,{assign:()=>FVe,colors:()=>u0,createStringInterpolator:()=>H8,skipAnimation:()=>$ue,to:()=>Wue,willAdvance:()=>j8});var F8=PE(),us=n=>RE(n,F8),N8=PE();us.write=n=>RE(n,N8);var BB=PE();us.onStart=n=>RE(n,BB);var z8=PE();us.onFrame=n=>RE(n,z8);var U8=PE();us.onFinish=n=>RE(n,U8);var Zb=[];us.setTimeout=(n,e)=>{const t=us.now()+e,r=()=>{const s=Zb.findIndex(o=>o.cancel==r);~s&&Zb.splice(s,1),Yv-=~s?1:0},i={time:t,handler:n,cancel:r};return Zb.splice(Uue(t),0,i),Yv+=1,Gue(),i};var Uue=n=>~(~Zb.findIndex(e=>e.time>n)||~Zb.length);us.cancel=n=>{BB.delete(n),z8.delete(n),U8.delete(n),F8.delete(n),N8.delete(n)};us.sync=n=>{$5=!0,us.batchedUpdates(n),$5=!1};us.throttle=n=>{let e;function t(){try{n(...e)}finally{e=null}}function r(...i){e=i,us.onStart(t)}return r.handler=n,r.cancel=()=>{BB.delete(t),e=null},r};var G8=typeof window<"u"?window.requestAnimationFrame:()=>{};us.use=n=>G8=n;us.now=typeof performance<"u"?()=>performance.now():Date.now;us.batchedUpdates=n=>n();us.catch=console.error;us.frameLoop="always";us.advance=()=>{us.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):Hue()};var Zv=-1,Yv=0,$5=!1;function RE(n,e){$5?(e.delete(n),n(0)):(e.add(n),Gue())}function Gue(){Zv<0&&(Zv=0,us.frameLoop!=="demand"&&G8(Vue))}function DVe(){Zv=-1}function Vue(){~Zv&&(G8(Vue),us.batchedUpdates(Hue))}function Hue(){const n=Zv;Zv=us.now();const e=Uue(Zv);if(e&&(jue(Zb.splice(0,e),t=>t.handler()),Yv-=e),!Yv){DVe();return}BB.flush(),F8.flush(n?Math.min(64,Zv-n):16.667),z8.flush(),N8.flush(),U8.flush()}function PE(){let n=new Set,e=n;return{add(t){Yv+=e==n&&!n.has(t)?1:0,n.add(t)},delete(t){return Yv-=e==n&&n.has(t)?1:0,n.delete(t)},flush(t){e.size&&(n=new Set,Yv-=e.size,jue(e,r=>r(t)&&n.add(r)),Yv+=n.size,e=n)}}}function jue(n,e){n.forEach(t=>{try{e(t)}catch(r){us.catch(r)}})}function BVe(){}var kVe=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),io={arr:Array.isArray,obj:n=>!!n&&n.constructor.name==="Object",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",und:n=>n===void 0};function OVe(n,e){if(io.arr(n)){if(!io.arr(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}return n===e}var Gm=(n,e)=>n.forEach(e);function X5(n,e,t){if(io.arr(n)){for(let r=0;r<n.length;r++)e.call(t,n[r],`${r}`);return}for(const r in n)n.hasOwnProperty(r)&&e.call(t,n[r],r)}var GI=n=>io.und(n)?[]:io.arr(n)?n:[n],V8=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),H8,Wue,u0=null,$ue=!1,j8=BVe,FVe=n=>{n.to&&(Wue=n.to),n.now&&(us.now=n.now),n.colors!==void 0&&(u0=n.colors),n.skipAnimation!=null&&($ue=n.skipAnimation),n.createStringInterpolator&&(H8=n.createStringInterpolator),n.requestAnimationFrame&&us.use(n.requestAnimationFrame),n.batchedUpdates&&(us.batchedUpdates=n.batchedUpdates),n.willAdvance&&(j8=n.willAdvance),n.frameLoop&&(us.frameLoop=n.frameLoop)},ET=new Set,Th=[],IN=[],IL=0,W8={get idle(){return!ET.size&&!Th.length},start(n){IL>n.priority?(ET.add(n),us.onStart(NVe)):(Xue(n),us(q5))},advance:q5,sort(n){if(IL)us.onFrame(()=>W8.sort(n));else{const e=Th.indexOf(n);~e&&(Th.splice(e,1),que(n))}},clear(){Th=[],ET.clear()}};function NVe(){ET.forEach(Xue),ET.clear(),us(q5)}function Xue(n){Th.includes(n)||que(n)}function que(n){Th.splice(zVe(Th,e=>e.priority>n.priority),0,n)}function q5(n){const e=IN;for(let t=0;t<Th.length;t++){const r=Th[t];IL=r.priority,r.idle||(j8(r),r.advance(n),r.idle||e.push(r))}return IL=0,IN=Th,IN.length=0,Th=e,Th.length>0}function zVe(n,e){const t=n.findIndex(e);return t<0?n.length:t}var UVe={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},Wf="[-+]?\\d*\\.?\\d+",RL=Wf+"%";function kB(...n){return"\\(\\s*("+n.join(")\\s*,\\s*(")+")\\s*\\)"}var GVe=new RegExp("rgb"+kB(Wf,Wf,Wf)),VVe=new RegExp("rgba"+kB(Wf,Wf,Wf,Wf)),HVe=new RegExp("hsl"+kB(Wf,RL,RL)),jVe=new RegExp("hsla"+kB(Wf,RL,RL,Wf)),WVe=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,$Ve=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,XVe=/^#([0-9a-fA-F]{6})$/,qVe=/^#([0-9a-fA-F]{8})$/;function ZVe(n){let e;return typeof n=="number"?n>>>0===n&&n>=0&&n<=4294967295?n:null:(e=XVe.exec(n))?parseInt(e[1]+"ff",16)>>>0:u0&&u0[n]!==void 0?u0[n]:(e=GVe.exec(n))?(Z1(e[1])<<24|Z1(e[2])<<16|Z1(e[3])<<8|255)>>>0:(e=VVe.exec(n))?(Z1(e[1])<<24|Z1(e[2])<<16|Z1(e[3])<<8|RJ(e[4]))>>>0:(e=WVe.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=qVe.exec(n))?parseInt(e[1],16)>>>0:(e=$Ve.exec(n))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=HVe.exec(n))?(CJ(IJ(e[1]),VI(e[2]),VI(e[3]))|255)>>>0:(e=jVe.exec(n))?(CJ(IJ(e[1]),VI(e[2]),VI(e[3]))|RJ(e[4]))>>>0:null}function RN(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*(2/3-t)*6:n}function CJ(n,e,t){const r=t<.5?t*(1+e):t+e-t*e,i=2*t-r,s=RN(i,r,n+1/3),o=RN(i,r,n),l=RN(i,r,n-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(l*255)<<8}function Z1(n){const e=parseInt(n,10);return e<0?0:e>255?255:e}function IJ(n){return(parseFloat(n)%360+360)%360/360}function RJ(n){const e=parseFloat(n);return e<0?0:e>1?255:Math.round(e*255)}function VI(n){const e=parseFloat(n);return e<0?0:e>100?1:e/100}function PJ(n){let e=ZVe(n);if(e===null)return n;e=e||0;const t=(e&4278190080)>>>24,r=(e&16711680)>>>16,i=(e&65280)>>>8,s=(e&255)/255;return`rgba(${t}, ${r}, ${i}, ${s})`}var DM=(n,e,t)=>{if(io.fun(n))return n;if(io.arr(n))return DM({range:n,output:e,extrapolate:t});if(io.str(n.output[0]))return H8(n);const r=n,i=r.output,s=r.range||[0,1],o=r.extrapolateLeft||r.extrapolate||"extend",l=r.extrapolateRight||r.extrapolate||"extend",a=r.easing||(h=>h);return h=>{const f=KVe(h,s);return YVe(h,s[f],s[f+1],i[f],i[f+1],a,o,l,r.map)}};function YVe(n,e,t,r,i,s,o,l,a){let h=a?a(n):n;if(h<e){if(o==="identity")return h;o==="clamp"&&(h=e)}if(h>t){if(l==="identity")return h;l==="clamp"&&(h=t)}return r===i?r:e===t?n<=e?r:i:(e===-1/0?h=-h:t===1/0?h=h-e:h=(h-e)/(t-e),h=s(h),r===-1/0?h=-h:i===1/0?h=h+r:h=h*(i-r)+r,h)}function KVe(n,e){for(var t=1;t<e.length-1&&!(e[t]>=n);++t);return t-1}var BM=Symbol.for("FluidValue.get"),kM=Symbol.for("FluidValue.observers"),PL=n=>!!(n&&n[BM]),LL=n=>n&&n[BM]?n[BM]():n;function JVe(n,e){n.eventObserved?n.eventObserved(e):n(e)}function Z5(n,e){const t=n[kM];t&&t.forEach(r=>{JVe(r,e)})}var QVe=class{constructor(n){if(!n&&!(n=this.get))throw Error("Unknown getter");eHe(this,n)}},eHe=(n,e)=>Yue(n,BM,e);function Zue(n,e){if(n[BM]){let t=n[kM];t||Yue(n,kM,t=new Set),t.has(e)||(t.add(e),n.observerAdded&&n.observerAdded(t.size,e))}return e}function Y5(n,e){const t=n[kM];if(t&&t.has(e)){const r=t.size-1;r?t.delete(e):n[kM]=null,n.observerRemoved&&n.observerRemoved(r,e)}}var Yue=(n,e,t)=>Object.defineProperty(n,e,{value:t,writable:!0,configurable:!0}),SR=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,tHe=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,LJ=new RegExp(`(${SR.source})(%|[a-z]+)`,"i"),nHe=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,OB=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Kue=n=>{const[e,t]=rHe(n);if(!e||V8())return n;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(t&&t.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(t);return i||n}else{if(t&&OB.test(t))return Kue(t);if(t)return t}return n},rHe=n=>{const e=OB.exec(n);if(!e)return[,];const[,t,r]=e;return[t,r]},PN,iHe=(n,e,t,r,i)=>`rgba(${Math.round(e)}, ${Math.round(t)}, ${Math.round(r)}, ${i})`,Jue=n=>{PN||(PN=u0?new RegExp(`(${Object.keys(u0).join("|")})(?!\\w)`,"g"):/^\b$/);const e=n.output.map(s=>LL(s).replace(OB,Kue).replace(tHe,PJ).replace(PN,PJ)),t=e.map(s=>s.match(SR).map(Number)),i=t[0].map((s,o)=>t.map(l=>{if(!(o in l))throw Error('The arity of each "output" value must be equal');return l[o]})).map(s=>DM({...n,output:s}));return s=>{var a;const o=!LJ.test(e[0])&&((a=e.find(h=>LJ.test(h)))==null?void 0:a.replace(SR,""));let l=0;return e[0].replace(SR,()=>`${i[l++](s)}${o||""}`).replace(nHe,iHe)}},Que="react-spring: ",ehe=n=>{const e=n;let t=!1;if(typeof e!="function")throw new TypeError(`${Que}once requires a function parameter`);return(...r)=>{t||(e(...r),t=!0)}},sHe=ehe(console.warn);function aHe(){sHe(`${Que}The "interpolate" function is deprecated in v9 (use "to" instead)`)}ehe(console.warn);function the(n){return io.str(n)&&(n[0]=="#"||/\d/.test(n)||!V8()&&OB.test(n)||n in(u0||{}))}var nhe=V8()?Ae.useEffect:Ae.useLayoutEffect,oHe=()=>{const n=Ae.useRef(!1);return nhe(()=>(n.current=!0,()=>{n.current=!1}),[]),n};function lHe(){const n=Ae.useState()[1],e=oHe();return()=>{e.current&&n(Math.random())}}function cHe(n,e){const[t]=Ae.useState(()=>({inputs:e,result:n()})),r=Ae.useRef(),i=r.current;let s=i;return s?e&&s.inputs&&uHe(e,s.inputs)||(s={inputs:e,result:n()}):s=t,Ae.useEffect(()=>{r.current=s,i==t&&(t.inputs=t.result=void 0)},[s]),s.result}function uHe(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}var hHe=n=>Ae.useEffect(n,fHe),fHe=[],OM=Symbol.for("Animated:node"),dHe=n=>!!n&&n[OM]===n,$8=n=>n&&n[OM],rhe=(n,e)=>kVe(n,OM,e),X8=n=>n&&n[OM]&&n[OM].getPayload(),ihe=class{constructor(){rhe(this,this)}getPayload(){return this.payload||[]}},FB=class extends ihe{constructor(n){super(),this._value=n,this.done=!0,this.durationProgress=0,io.num(this._value)&&(this.lastPosition=this._value)}static create(n){return new FB(n)}getPayload(){return[this]}getValue(){return this._value}setValue(n,e){return io.num(n)&&(this.lastPosition=n,e&&(n=Math.round(n/e)*e,this.done&&(this.lastPosition=n))),this._value===n?!1:(this._value=n,!0)}reset(){const{done:n}=this;this.done=!1,io.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,n&&(this.lastVelocity=null),this.v0=null)}},q8=class extends FB{constructor(n){super(0),this._string=null,this._toString=DM({output:[n,n]})}static create(n){return new q8(n)}getValue(){const n=this._string;return n??(this._string=this._toString(this._value))}setValue(n){if(io.str(n)){if(n==this._string)return!1;this._string=n,this._value=1}else if(super.setValue(n))this._string=null;else return!1;return!0}reset(n){n&&(this._toString=DM({output:[this.getValue(),n]})),this._value=0,super.reset()}},DL={dependencies:null},Z8=class extends ihe{constructor(n){super(),this.source=n,this.setValue(n)}getValue(n){const e={};return X5(this.source,(t,r)=>{dHe(t)?e[r]=t.getValue(n):PL(t)?e[r]=LL(t):n||(e[r]=t)}),e}setValue(n){this.source=n,this.payload=this._makePayload(n)}reset(){this.payload&&Gm(this.payload,n=>n.reset())}_makePayload(n){if(n){const e=new Set;return X5(n,this._addToPayload,e),Array.from(e)}}_addToPayload(n){DL.dependencies&&PL(n)&&DL.dependencies.add(n);const e=X8(n);e&&Gm(e,t=>this.add(t))}},she=class extends Z8{constructor(n){super(n)}static create(n){return new she(n)}getValue(){return this.source.map(n=>n.getValue())}setValue(n){const e=this.getPayload();return n.length==e.length?e.map((t,r)=>t.setValue(n[r])).some(Boolean):(super.setValue(n.map(pHe)),!0)}};function pHe(n){return(the(n)?q8:FB).create(n)}function mHe(n){const e=$8(n);return e?e.constructor:io.arr(n)?she:the(n)?q8:FB}var DJ=(n,e)=>{const t=!io.fun(n)||n.prototype&&n.prototype.isReactComponent;return Ae.forwardRef((r,i)=>{const s=Ae.useRef(null),o=t&&Ae.useCallback(S=>{s.current=_He(i,S)},[i]),[l,a]=vHe(r,e),h=lHe(),f=()=>{const S=s.current;if(t&&!S)return;(S?e.applyAnimatedValues(S,l.getValue(!0)):!1)===!1&&h()},p=new gHe(f,a),v=Ae.useRef();nhe(()=>(v.current=p,Gm(a,S=>Zue(S,p)),()=>{v.current&&(Gm(v.current.deps,S=>Y5(S,v.current)),us.cancel(v.current.update))})),Ae.useEffect(f,[]),hHe(()=>()=>{const S=v.current;Gm(S.deps,C=>Y5(C,S))});const y=e.getComponentProps(l.getValue());return Ae.createElement(n,{...y,ref:o})})},gHe=class{constructor(n,e){this.update=n,this.deps=e}eventObserved(n){n.type=="change"&&us.write(this.update)}};function vHe(n,e){const t=new Set;return DL.dependencies=t,n.style&&(n={...n,style:e.createAnimatedStyle(n.style)}),n=new Z8(n),DL.dependencies=null,[n,t]}function _He(n,e){return n&&(io.fun(n)?n(e):n.current=e),e}var BJ=Symbol.for("AnimatedComponent"),yHe=(n,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:t=i=>new Z8(i),getComponentProps:r=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:t,getComponentProps:r},s=o=>{const l=kJ(o)||"Anonymous";return io.str(o)?o=s[o]||(s[o]=DJ(o,i)):o=o[BJ]||(o[BJ]=DJ(o,i)),o.displayName=`Animated(${l})`,o};return X5(n,(o,l)=>{io.arr(n)&&(l=kJ(o)),s[l]=s(o)}),{animated:s}},kJ=n=>io.str(n)?n:n&&io.str(n.displayName)?n.displayName:io.fun(n)&&n.name||null,OJ=n=>n instanceof ahe,xHe=1,ahe=class extends QVe{constructor(){super(...arguments),this.id=xHe++,this._priority=0}get priority(){return this._priority}set priority(n){this._priority!=n&&(this._priority=n,this._onPriorityChange(n))}get(){const n=$8(this);return n&&n.getValue()}to(...n){return _w.to(this,n)}interpolate(...n){return aHe(),_w.to(this,n)}toJSON(){return this.get()}observerAdded(n){n==1&&this._attach()}observerRemoved(n){n==0&&this._detach()}_attach(){}_detach(){}_onChange(n,e=!1){Z5(this,{type:"change",parent:this,value:n,idle:e})}_onPriorityChange(n){this.idle||W8.sort(this),Z5(this,{type:"priority",parent:this,priority:n})}},Y8=({children:n,...e})=>{const t=Ae.useContext(BL),r=e.pause||!!t.pause,i=e.immediate||!!t.immediate;e=cHe(()=>({pause:r,immediate:i}),[r,i]);const{Provider:s}=BL;return Ae.createElement(s,{value:e},n)},BL=bHe(Y8,{});Y8.Provider=BL.Provider;Y8.Consumer=BL.Consumer;function bHe(n,e){return Object.assign(n,Ae.createContext(e)),n.Provider._context=n,n.Consumer._context=n,n}var wHe=class extends ahe{constructor(n,e){super(),this.source=n,this.idle=!0,this._active=new Set,this.calc=DM(...e);const t=this._get(),r=mHe(t);rhe(this,r.create(t))}advance(n){const e=this._get(),t=this.get();OVe(e,t)||($8(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&FJ(this._active)&&LN(this)}_get(){const n=io.arr(this.source)?this.source.map(LL):GI(LL(this.source));return this.calc(...n)}_start(){this.idle&&!FJ(this._active)&&(this.idle=!1,Gm(X8(this),n=>{n.done=!1}),_w.skipAnimation?(us.batchedUpdates(()=>this.advance()),LN(this)):W8.start(this))}_attach(){let n=1;Gm(GI(this.source),e=>{PL(e)&&Zue(e,this),OJ(e)&&(e.idle||this._active.add(e),n=Math.max(n,e.priority+1))}),this.priority=n,this._start()}_detach(){Gm(GI(this.source),n=>{PL(n)&&Y5(n,this)}),this._active.clear(),LN(this)}eventObserved(n){n.type=="change"?n.idle?this.advance():(this._active.add(n.parent),this._start()):n.type=="idle"?this._active.delete(n.parent):n.type=="priority"&&(this.priority=GI(this.source).reduce((e,t)=>Math.max(e,(OJ(t)?t.priority:0)+1),0))}};function SHe(n){return n.idle!==!1}function FJ(n){return!n.size||Array.from(n).every(SHe)}function LN(n){n.idle||(n.idle=!0,Gm(X8(n),e=>{e.done=!0}),Z5(n,{type:"idle",parent:n}))}_w.assign({createStringInterpolator:Jue,to:(n,e)=>new wHe(n,e)});var AHe=["primitive"].concat(Object.keys(gre).filter(n=>/^[A-Z]/.test(n)).map(n=>n[0].toLowerCase()+n.slice(1)));_w.assign({createStringInterpolator:Jue,colors:UVe,frameLoop:"demand"});LSe(()=>{us.advance()});var THe=yHe(AHe,{applyAnimatedValues:dy}),MHe=THe.animated;const EHe="/about_portfolio/assets/island-BN767CUw.glb",CHe=({isRotating:n,setIsRotating:e,setCurrentStage:t,...r})=>{const i=Ae.useRef(),{gl:s,viewport:o}=kre(),{nodes:l,materials:a}=ag(EHe),h=Ae.useRef(0),f=Ae.useRef(0),p=.95,v=E=>{E.stopPropagation(),E.preventDefault(),e(!0);const L=E.touches?E.touches[0].clientX:E.clientX;h.current=L},y=E=>{E.stopPropagation(),E.preventDefault(),e(!1)},S=E=>{if(E.stopPropagation(),E.preventDefault(),n){const L=E.touches?E.touches[0].clientX:E.clientX,k=(L-h.current)/o.width;i.current.rotation.y+=k*.01*Math.PI,h.current=L,f.current=k*.01*Math.PI}},C=E=>{E.key==="ArrowLeft"?(n||e(!0),i.current.rotation.y+=.01*Math.PI,f.current=.0125):E.key==="ArrowRight"&&(n||e(!0),i.current.rotation.y-=.01*Math.PI,f.current=-.0125)},M=E=>{(E.key==="ArrowLeft"||E.key==="ArrowRight")&&e(!1)};return uE(()=>{if(!n)f.current*=p,Math.abs(f.current)<.001&&(f.current=0),i.current.rotation.y+=f.current;else{const L=(i.current.rotation.y%(2*Math.PI)+2*Math.PI)%(2*Math.PI);switch(!0){case(L>=5.45&&L<=5.85):t(4);break;case(L>=.85&&L<=1.3):t(3);break;case(L>=2.4&&L<=2.6):t(2);break;case(L>=4.25&&L<=4.75):t(1);break;default:t(null)}}}),Ae.useEffect(()=>{const E=s.domElement;return E.addEventListener("pointerdown",v),E.addEventListener("pointerup",y),E.addEventListener("pointermove",S),document.addEventListener("keydown",C),document.addEventListener("keyup",M),()=>{E.removeEventListener("pointerdown",v),E.removeEventListener("pointerup",y),E.removeEventListener("pointermove",S),document.removeEventListener("keydown",C),document.removeEventListener("keyup",M)}},[s,v,y,S]),me.jsxs(MHe.group,{ref:i,...r,children:[me.jsx("mesh",{geometry:l.polySurface944_tree_body_0.geometry,material:a.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface945_tree1_0.geometry,material:a.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface946_tree2_0.geometry,material:a.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface947_tree1_0.geometry,material:a.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface948_tree_body_0.geometry,material:a.PaletteMaterial001}),me.jsx("mesh",{geometry:l.polySurface949_tree_body_0.geometry,material:a.PaletteMaterial001}),me.jsx("mesh",{geometry:l.pCube11_rocks1_0.geometry,material:a.PaletteMaterial001})]})},IHe="/about_portfolio/assets/plane-Dk3bBBjR.glb",RHe=({isRotating:n,...e})=>{const t=Ae.useRef(),{scene:r,animations:i}=ag(IHe),{actions:s}=O6(i,t);return Ae.useEffect(()=>{n?s["Take 001"].play():s["Take 001"].stop()},[s,n]),me.jsx("mesh",{...e,ref:t,children:me.jsx("primitive",{object:r})})},PHe="/about_portfolio/assets/sky-B0A1kvoP.glb",LHe=({isRotating:n})=>{const e=ag(PHe),t=Ae.useRef();return uE((r,i)=>{n&&(t.current.rotation.y+=.15*i)}),me.jsx("mesh",{ref:t,children:me.jsx("primitive",{object:e.scene})})},DHe=()=>{const n=Ae.useRef(new Audio(IVe));n.current.volume=.4,n.current.loop=!0;const[e,t]=Ae.useState(!1),[r,i]=Ae.useState(1),[s,o]=Ae.useState(!1);Ae.useEffect(()=>(s&&n.current.play(),()=>{n.current.pause()}),[s]);const l=()=>{let S=null,C=[0,7.5,-43],M=[.1,4.7,0];return window.innerWidth<768?S=[.2,.2,.2]:S=[.4,.4,.4],[S,C,M]},[a,h,f]=l(),p=()=>{let S,C;return window.innerWidth<768?(S=[1.5,1.5,1.5],C=[2,0,-1]):(S=[3,3,3],C=[8,0,-4]),[S,C]},[v,y]=p();return me.jsxs("section",{className:"w-full h-screen relative",children:[me.jsxs("div",{className:"absolute top-28 left-0 right-0 z-10 flex items-center justify-center",children:[r&&me.jsx(RVe,{currentStage:r})," "]}),me.jsx(Vre,{className:`w-full h-screen bg-transparent ${e?"cursor-grabbing":"cursor-grab"} `,camera:{near:.1,far:1e3},children:me.jsxs(Ae.Suspense,{fallback:me.jsx(F6,{}),children:[me.jsx("directionalLight",{position:[1,1,1],intensity:2}),me.jsx("ambientLight",{intensity:.5}),me.jsx("hemisphereLight",{skyColor:"#b1e1ff",groundColor:"#000000",intensity:1}),me.jsx(LNe,{}),me.jsx(RHe,{scale:v,position:y,isRotating:e,rotation:[10,0,10]}),me.jsx(LHe,{isRotating:e}),me.jsx(CHe,{position:h,scale:a,rotation:f,isRotating:e,setIsRotating:t,setCurrentStage:i}),me.jsx(ONe,{rotation:[.1,90,0],position:[0,-10,-80],scale:[.6,.6,.6]})]})}),me.jsx("div",{className:"absolute bottom-2 left-2",children:me.jsx("img",{src:s?xTe:yTe,alt:"sound",className:"w-10 h-10 cursor-pointer object-contain",onClick:()=>o(!s)})})]})},BHe=()=>{const{t:n}=Iw();return me.jsxs("section",{className:"max-container",children:[me.jsxs("h1",{className:"head-text",children:[n("projects.fr"),me.jsxs("span",{className:"blue-gradient_text font-semibold drop-shadow",children:[" ",n("projects.ed")]})]}),me.jsx("div",{className:"mt-5 flex flex-col gap-3 text-slate-500",children:me.jsx("p",{children:n("projects.basicIntro")})}),me.jsx("div",{className:"flex flex-wrap my-20 gap-16",children:rVe.map(e=>me.jsxs("div",{className:"lg:w=[400px] w-full",children:[me.jsxs("div",{className:"block-container w-12 h-12",children:[me.jsx("div",{className:`btn-back rounded-xl ${e.theme}`}),me.jsx("div",{className:"btn-front rounded-xl flex justify-center items-center",children:me.jsx("img",{src:e.iconUrl,alt:"Project Icon",className:"w-1/2 h-1/2 object-contain"})})]}),me.jsxs("div",{className:"mt-5 flex flex-col",children:[me.jsx("h4",{className:"text-2xl font-poppins font-semibold",children:e.name}),me.jsx("p",{className:"whitespace-pre-wrap mt-2 text-slate-500",children:e.description}),me.jsxs("div",{className:"mt-5 flex items-center gap-2 font-poppins",children:[me.jsx(jv,{to:e.link,target:"_blank",rel:"noopener noreferrer",className:"font-semibold text-blue-600",children:"Live Link"}),me.jsx("img",{src:tie,alt:"arrow",className:"w-4 h-4 object-contain"})]})]})]},e.name))}),me.jsxs("div",{className:"py-16",children:[me.jsx("h3",{className:"subhead-text",children:""}),me.jsx("div",{className:"mt-2 flex flex-col gap-3 text-slate-500 "}),me.jsx("div",{className:"mt-12 flex",children:me.jsx(CL.VerticalTimeline,{children:eVe.map(e=>me.jsxs(CL.VerticalTimelineElement,{date:e.date,icon:me.jsx("div",{className:"flex justify-center items-center w-full h-full",children:me.jsx("img",{src:e.icon,alt:e.company_name,className:"w-[60%] h-[60%] object-contain"})}),iconStyle:{background:e.iconBg},contentStyle:{borderBottom:"8px",borderStyle:"solid",borderBottomColor:e.mainColor,boxShadow:"none"},children:[me.jsxs("div",{children:[me.jsx("h3",{className:"text-black text-xl font-poppins font-semibold",children:e.title}),me.jsx("p",{className:"text-black-500 font-medium font-base",style:{margin:0},children:e.company_name})]}),me.jsx("ul",{className:"my-5 list-disc ml-5 space-y-2",children:e.points.map((t,r)=>me.jsx("li",{className:"text-black-500/50 font-normal pl-1 text-sm",children:t},`experience-point-${r}`))})]},e.company_name))})})]}),me.jsx("hr",{className:"border-slate-200"}),me.jsx(O8,{})]})},kHe=()=>{const{i18n:n}=Iw(),e=i=>{n.changeLanguage(i),r(i==="zh")},[t,r]=Ae.useState(!0);return me.jsx("button",{className:"fixed bottom-5 right-5 rounded-lg bg-white items-center justify-center flex font-bold shadow-md px-3 py-2",onClick:()=>e(t?"en":"zh"),children:me.jsx("p",{className:"blue-gradient_text",children:t?"Change to English":""})})},OHe=()=>me.jsxs("main",{className:"bg-slate-300/20 h-full",children:[me.jsxs(uve,{basename:"/about_portfolio",children:[me.jsx(pTe,{}),me.jsx(Ae.Suspense,{fallback:me.jsx(F6,{}),children:me.jsxs(rve,{children:[me.jsx(Yd,{path:"/",element:me.jsx(DHe,{})}),me.jsx(Yd,{path:"/about",element:me.jsx(yVe,{})}),me.jsx(Yd,{path:"/projects",element:me.jsx(BHe,{})}),me.jsx(Yd,{path:"/arts",element:me.jsx(xVe,{})}),Iue.map((n,e)=>me.jsx(Yd,{path:n.path,element:me.jsx(n.component,{})},e)),Rue.map((n,e)=>me.jsx(Yd,{path:n.path,element:me.jsx(n.component,{})},e)),Pue.map((n,e)=>me.jsx(Yd,{path:n.path,element:me.jsx(n.component,{})},e)),Lue.map((n,e)=>me.jsx(Yd,{path:n.path,element:me.jsx(n.component,{})},e)),me.jsx(Yd,{path:"/contact",element:me.jsx(CVe,{})})]})})]}),me.jsx(kHe,{})]}),mi=n=>typeof n=="string",wA=()=>{let n,e;const t=new Promise((r,i)=>{n=r,e=i});return t.resolve=n,t.reject=e,t},NJ=n=>n==null?"":""+n,FHe=(n,e,t)=>{n.forEach(r=>{e[r]&&(t[r]=e[r])})},NHe=/###/g,zJ=n=>n&&n.indexOf("###")>-1?n.replace(NHe,"."):n,UJ=n=>!n||mi(n),CT=(n,e,t)=>{const r=mi(e)?e.split("."):e;let i=0;for(;i<r.length-1;){if(UJ(n))return{};const s=zJ(r[i]);!n[s]&&t&&(n[s]=new t),Object.prototype.hasOwnProperty.call(n,s)?n=n[s]:n={},++i}return UJ(n)?{}:{obj:n,k:zJ(r[i])}},GJ=(n,e,t)=>{const{obj:r,k:i}=CT(n,e,Object);if(r!==void 0||e.length===1){r[i]=t;return}let s=e[e.length-1],o=e.slice(0,e.length-1),l=CT(n,o,Object);for(;l.obj===void 0&&o.length;)s=`${o[o.length-1]}.${s}`,o=o.slice(0,o.length-1),l=CT(n,o,Object),l!=null&&l.obj&&typeof l.obj[`${l.k}.${s}`]<"u"&&(l.obj=void 0);l.obj[`${l.k}.${s}`]=t},zHe=(n,e,t,r)=>{const{obj:i,k:s}=CT(n,e,Object);i[s]=i[s]||[],i[s].push(t)},kL=(n,e)=>{const{obj:t,k:r}=CT(n,e);if(t&&Object.prototype.hasOwnProperty.call(t,r))return t[r]},UHe=(n,e,t)=>{const r=kL(n,t);return r!==void 0?r:kL(e,t)},ohe=(n,e,t)=>{for(const r in e)r!=="__proto__"&&r!=="constructor"&&(r in n?mi(n[r])||n[r]instanceof String||mi(e[r])||e[r]instanceof String?t&&(n[r]=e[r]):ohe(n[r],e[r],t):n[r]=e[r]);return n},Y1=n=>n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var GHe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const VHe=n=>mi(n)?n.replace(/[&<>"'\/]/g,e=>GHe[e]):n;class HHe{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}const jHe=[" ",",","?","!",";"],WHe=new HHe(20),$He=(n,e,t)=>{e=e||"",t=t||"";const r=jHe.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(r.length===0)return!0;const i=WHe.getRegExp(`(${r.map(o=>o==="?"?"\\?":o).join("|")})`);let s=!i.test(n);if(!s){const o=n.indexOf(t);o>0&&!i.test(n.substring(0,o))&&(s=!0)}return s},K5=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!n)return;if(n[e])return Object.prototype.hasOwnProperty.call(n,e)?n[e]:void 0;const r=e.split(t);let i=n;for(let s=0;s<r.length;){if(!i||typeof i!="object")return;let o,l="";for(let a=s;a<r.length;++a)if(a!==s&&(l+=t),l+=r[a],o=i[l],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&a<r.length-1)continue;s+=a-s+1;break}i=o}return i},OL=n=>n==null?void 0:n.replace("_","-"),XHe={type:"logger",log(n){this.output("log",n)},warn(n){this.output("warn",n)},error(n){this.output("error",n)},output(n,e){var t,r;(r=(t=console==null?void 0:console[n])==null?void 0:t.apply)==null||r.call(t,console,e)}};class FL{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||XHe,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,i){return i&&!this.debug?null:(mi(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new FL(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new FL(this.logger,e)}}var ap=new FL;class NB{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(r=>{this.observers[r]||(this.observers[r]=new Map);const i=this.observers[r].get(t)||0;this.observers[r].set(t,i+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(o=>{let[l,a]=o;for(let h=0;h<a;h++)l(...r)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[l,a]=o;for(let h=0;h<a;h++)l.apply(l,[e,...r])})}}class VJ extends NB{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r){var h,f;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=i.keySeparator!==void 0?i.keySeparator:this.options.keySeparator,o=i.ignoreJSONStructure!==void 0?i.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;e.indexOf(".")>-1?l=e.split("."):(l=[e,t],r&&(Array.isArray(r)?l.push(...r):mi(r)&&s?l.push(...r.split(s)):l.push(r)));const a=kL(this.data,l);return!a&&!t&&!r&&e.indexOf(".")>-1&&(e=l[0],t=l[1],r=l.slice(2).join(".")),a||!o||!mi(r)?a:K5((f=(h=this.data)==null?void 0:h[e])==null?void 0:f[t],r,s)}addResource(e,t,r,i){let s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator;let l=[e,t];r&&(l=l.concat(o?r.split(o):r)),e.indexOf(".")>-1&&(l=e.split("."),i=t,t=l[1]),this.addNamespaces(t),GJ(this.data,l,i),s.silent||this.emit("added",e,t,r,i)}addResources(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const s in r)(mi(r[s])||Array.isArray(r[s]))&&this.addResource(e,t,s,r[s],{silent:!0});i.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},l=[e,t];e.indexOf(".")>-1&&(l=e.split("."),i=r,r=t,t=l[1]),this.addNamespaces(t);let a=kL(this.data,l)||{};o.skipCopy||(r=JSON.parse(JSON.stringify(r))),i?ohe(a,r,s):a={...a,...r},GJ(this.data,l,a),o.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(i=>t[i]&&Object.keys(t[i]).length>0)}toJSON(){return this.data}}var lhe={processors:{},addPostProcessor(n){this.processors[n.name]=n},handle(n,e,t,r,i){return n.forEach(s=>{var o;e=((o=this.processors[s])==null?void 0:o.process(e,t,r,i))??e}),e}};const HJ={};class NL extends NB{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),FHe(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=ap.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const r=this.resolve(e,t);return(r==null?void 0:r.res)!==void 0}extractFromKey(e,t){let r=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;r===void 0&&(r=":");const i=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let s=t.ns||this.options.defaultNS||[];const o=r&&e.indexOf(r)>-1,l=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!$He(e,r,i);if(o&&!l){const a=e.match(this.interpolator.nestingRegexp);if(a&&a.length>0)return{key:e,namespaces:mi(s)?[s]:s};const h=e.split(r);(r!==i||r===i&&this.options.ns.indexOf(h[0])>-1)&&(s=h.shift()),e=h.join(i)}return{key:e,namespaces:mi(s)?[s]:s}}translate(e,t,r){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const i=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,s=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:o,namespaces:l}=this.extractFromKey(e[e.length-1],t),a=l[l.length-1],h=t.lng||this.language,f=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if((h==null?void 0:h.toLowerCase())==="cimode"){if(f){const H=t.nsSeparator||this.options.nsSeparator;return i?{res:`${a}${H}${o}`,usedKey:o,exactUsedKey:o,usedLng:h,usedNS:a,usedParams:this.getUsedParamsDetails(t)}:`${a}${H}${o}`}return i?{res:o,usedKey:o,exactUsedKey:o,usedLng:h,usedNS:a,usedParams:this.getUsedParamsDetails(t)}:o}const p=this.resolve(e,t);let v=p==null?void 0:p.res;const y=(p==null?void 0:p.usedKey)||o,S=(p==null?void 0:p.exactUsedKey)||o,C=Object.prototype.toString.apply(v),M=["[object Number]","[object Function]","[object RegExp]"],E=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,L=!this.i18nFormat||this.i18nFormat.handleAsObject,k=!mi(v)&&typeof v!="boolean"&&typeof v!="number";if(L&&v&&k&&M.indexOf(C)<0&&!(mi(E)&&Array.isArray(v))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const H=this.options.returnedObjectHandler?this.options.returnedObjectHandler(y,v,{...t,ns:l}):`key '${o} (${this.language})' returned an object instead of string.`;return i?(p.res=H,p.usedParams=this.getUsedParamsDetails(t),p):H}if(s){const H=Array.isArray(v),X=H?[]:{},Z=H?S:y;for(const Q in v)if(Object.prototype.hasOwnProperty.call(v,Q)){const re=`${Z}${s}${Q}`;X[Q]=this.translate(re,{...t,joinArrays:!1,ns:l}),X[Q]===re&&(X[Q]=v[Q])}v=X}}else if(L&&mi(E)&&Array.isArray(v))v=v.join(E),v&&(v=this.extendTranslation(v,e,t,r));else{let H=!1,X=!1;const Z=t.count!==void 0&&!mi(t.count),Q=NL.hasDefaultValue(t),re=Z?this.pluralResolver.getSuffix(h,t.count,t):"",ie=t.ordinal&&Z?this.pluralResolver.getSuffix(h,t.count,{ordinal:!1}):"",oe=Z&&!t.ordinal&&t.count===0,fe=oe&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${re}`]||t[`defaultValue${ie}`]||t.defaultValue;!this.isValidLookup(v)&&Q&&(H=!0,v=fe),this.isValidLookup(v)||(X=!0,v=o);const Ee=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&X?void 0:v,Ie=Q&&fe!==v&&this.options.updateMissing;if(X||H||Ie){if(this.logger.log(Ie?"updateKey":"missingKey",h,a,o,Ie?fe:v),s){const _e=this.resolve(o,{...t,keySeparator:!1});_e&&_e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let He=[];const Re=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&Re&&Re[0])for(let _e=0;_e<Re.length;_e++)He.push(Re[_e]);else this.options.saveMissingTo==="all"?He=this.languageUtils.toResolveHierarchy(t.lng||this.language):He.push(t.lng||this.language);const st=(_e,We,Ue)=>{var xt;const vt=Q&&Ue!==v?Ue:Ee;this.options.missingKeyHandler?this.options.missingKeyHandler(_e,a,We,vt,Ie,t):(xt=this.backendConnector)!=null&&xt.saveMissing&&this.backendConnector.saveMissing(_e,a,We,vt,Ie,t),this.emit("missingKey",_e,a,We,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&Z?He.forEach(_e=>{const We=this.pluralResolver.getSuffixes(_e,t);oe&&t[`defaultValue${this.options.pluralSeparator}zero`]&&We.indexOf(`${this.options.pluralSeparator}zero`)<0&&We.push(`${this.options.pluralSeparator}zero`),We.forEach(Ue=>{st([_e],o+Ue,t[`defaultValue${Ue}`]||fe)})}):st(He,o,fe))}v=this.extendTranslation(v,e,t,p,r),X&&v===o&&this.options.appendNamespaceToMissingKey&&(v=`${a}:${o}`),(X||H)&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${a}:${o}`:o,H?v:void 0))}return i?(p.res=v,p.usedParams=this.getUsedParamsDetails(t),p):v}extendTranslation(e,t,r,i,s){var h,f;var o=this;if((h=this.i18nFormat)!=null&&h.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const p=mi(e)&&(((f=r==null?void 0:r.interpolation)==null?void 0:f.skipOnVariables)!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let v;if(p){const S=e.match(this.interpolator.nestingRegexp);v=S&&S.length}let y=r.replace&&!mi(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(y={...this.options.interpolation.defaultVariables,...y}),e=this.interpolator.interpolate(e,y,r.lng||this.language||i.usedLng,r),p){const S=e.match(this.interpolator.nestingRegexp),C=S&&S.length;v<C&&(r.nest=!1)}!r.lng&&i&&i.res&&(r.lng=this.language||i.usedLng),r.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var S=arguments.length,C=new Array(S),M=0;M<S;M++)C[M]=arguments[M];return(s==null?void 0:s[0])===C[0]&&!r.context?(o.logger.warn(`It seems you are nesting recursively key: ${C[0]} in key: ${t[0]}`),null):o.translate(...C,t)},r)),r.interpolation&&this.interpolator.reset()}const l=r.postProcess||this.options.postProcess,a=mi(l)?[l]:l;return e!=null&&(a!=null&&a.length)&&r.applyPostProcessor!==!1&&(e=lhe.handle(a,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r,i,s,o,l;return mi(e)&&(e=[e]),e.forEach(a=>{if(this.isValidLookup(r))return;const h=this.extractFromKey(a,t),f=h.key;i=f;let p=h.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));const v=t.count!==void 0&&!mi(t.count),y=v&&!t.ordinal&&t.count===0,S=t.context!==void 0&&(mi(t.context)||typeof t.context=="number")&&t.context!=="",C=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);p.forEach(M=>{var E,L;this.isValidLookup(r)||(l=M,!HJ[`${C[0]}-${M}`]&&((E=this.utils)!=null&&E.hasLoadedNamespace)&&!((L=this.utils)!=null&&L.hasLoadedNamespace(l))&&(HJ[`${C[0]}-${M}`]=!0,this.logger.warn(`key "${i}" for languages "${C.join(", ")}" won't get resolved as namespace "${l}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),C.forEach(k=>{var Z;if(this.isValidLookup(r))return;o=k;const H=[f];if((Z=this.i18nFormat)!=null&&Z.addLookupKeys)this.i18nFormat.addLookupKeys(H,f,k,M,t);else{let Q;v&&(Q=this.pluralResolver.getSuffix(k,t.count,t));const re=`${this.options.pluralSeparator}zero`,ie=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(v&&(H.push(f+Q),t.ordinal&&Q.indexOf(ie)===0&&H.push(f+Q.replace(ie,this.options.pluralSeparator)),y&&H.push(f+re)),S){const oe=`${f}${this.options.contextSeparator}${t.context}`;H.push(oe),v&&(H.push(oe+Q),t.ordinal&&Q.indexOf(ie)===0&&H.push(oe+Q.replace(ie,this.options.pluralSeparator)),y&&H.push(oe+re))}}let X;for(;X=H.pop();)this.isValidLookup(r)||(s=X,r=this.getResource(k,M,X,t))}))})}),{res:r,usedKey:i,exactUsedKey:s,usedLng:o,usedNS:l}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,r){var s;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return(s=this.i18nFormat)!=null&&s.getResource?this.i18nFormat.getResource(e,t,r,i):this.resourceStore.getResource(e,t,r,i)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!mi(e.replace);let i=r?e.replace:e;if(r&&typeof e.count<"u"&&(i.count=e.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!r){i={...i};for(const s of t)delete i[s]}return i}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,t.length)&&e[r]!==void 0)return!0;return!1}}class jJ{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ap.create("languageUtils")}getScriptPartFromCode(e){if(e=OL(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=OL(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(mi(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch{}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(r=>{if(t)return;const i=this.formatLanguageCode(r);(!this.options.supportedLngs||this.isSupportedCode(i))&&(t=i)}),!t&&this.options.supportedLngs&&e.forEach(r=>{if(t)return;const i=this.getLanguagePartFromCode(r);if(this.isSupportedCode(i))return t=i;t=this.options.supportedLngs.find(s=>{if(s===i)return s;if(!(s.indexOf("-")<0&&i.indexOf("-")<0)&&(s.indexOf("-")>0&&i.indexOf("-")<0&&s.substring(0,s.indexOf("-"))===i||s.indexOf(i)===0&&i.length>1))return s})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),mi(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),i=[],s=o=>{o&&(this.isSupportedCode(o)?i.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return mi(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&s(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&s(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&s(this.getLanguagePartFromCode(e))):mi(e)&&s(this.formatLanguageCode(e)),r.forEach(o=>{i.indexOf(o)<0&&s(this.formatLanguageCode(o))}),i}}const WJ={zero:0,one:1,two:2,few:3,many:4,other:5},$J={select:n=>n===1?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class qHe{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=ap.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=OL(e==="dev"?"en":e),i=t.ordinal?"ordinal":"cardinal",s=JSON.stringify({cleanedCode:r,type:i});if(s in this.pluralRulesCache)return this.pluralRulesCache[s];let o;try{o=new Intl.PluralRules(r,{type:i})}catch{if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),$J;if(!e.match(/-|_/))return $J;const a=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(a,t)}return this.pluralRulesCache[s]=o,o}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),(r==null?void 0:r.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,r).map(i=>`${t}${i}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?r.resolvedOptions().pluralCategories.sort((i,s)=>WJ[i]-WJ[s]).map(i=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${i}`):[]}getSuffix(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.getRule(e,r);return i?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${i.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,r))}}const XJ=function(n,e,t){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,s=UHe(n,e,t);return!s&&i&&mi(t)&&(s=K5(n,t,r),s===void 0&&(s=K5(e,t,r))),s},DN=n=>n.replace(/\$/g,"$$$$");class ZHe{constructor(){var t;let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ap.create("interpolator"),this.options=e,this.format=((t=e==null?void 0:e.interpolation)==null?void 0:t.format)||(r=>r),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:i,prefix:s,prefixEscaped:o,suffix:l,suffixEscaped:a,formatSeparator:h,unescapeSuffix:f,unescapePrefix:p,nestingPrefix:v,nestingPrefixEscaped:y,nestingSuffix:S,nestingSuffixEscaped:C,nestingOptionsSeparator:M,maxReplaces:E,alwaysFormat:L}=e.interpolation;this.escape=t!==void 0?t:VHe,this.escapeValue=r!==void 0?r:!0,this.useRawValueToEscape=i!==void 0?i:!1,this.prefix=s?Y1(s):o||"{{",this.suffix=l?Y1(l):a||"}}",this.formatSeparator=h||",",this.unescapePrefix=f?"":p||"-",this.unescapeSuffix=this.unescapePrefix?"":f||"",this.nestingPrefix=v?Y1(v):y||Y1("$t("),this.nestingSuffix=S?Y1(S):C||Y1(")"),this.nestingOptionsSeparator=M||",",this.maxReplaces=E||1e3,this.alwaysFormat=L!==void 0?L:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,r)=>(t==null?void 0:t.source)===r?(t.lastIndex=0,t):new RegExp(r,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,r,i){var y;let s,o,l;const a=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},h=S=>{if(S.indexOf(this.formatSeparator)<0){const L=XJ(t,a,S,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(L,void 0,r,{...i,...t,interpolationkey:S}):L}const C=S.split(this.formatSeparator),M=C.shift().trim(),E=C.join(this.formatSeparator).trim();return this.format(XJ(t,a,M,this.options.keySeparator,this.options.ignoreJSONStructure),E,r,{...i,...t,interpolationkey:M})};this.resetRegExp();const f=(i==null?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,p=((y=i==null?void 0:i.interpolation)==null?void 0:y.skipOnVariables)!==void 0?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:S=>DN(S)},{regex:this.regexp,safeValue:S=>this.escapeValue?DN(this.escape(S)):DN(S)}].forEach(S=>{for(l=0;s=S.regex.exec(e);){const C=s[1].trim();if(o=h(C),o===void 0)if(typeof f=="function"){const E=f(e,s,i);o=mi(E)?E:""}else if(i&&Object.prototype.hasOwnProperty.call(i,C))o="";else if(p){o=s[0];continue}else this.logger.warn(`missed to pass in variable ${C} for interpolating ${e}`),o="";else!mi(o)&&!this.useRawValueToEscape&&(o=NJ(o));const M=S.safeValue(o);if(e=e.replace(s[0],M),p?(S.regex.lastIndex+=o.length,S.regex.lastIndex-=s[0].length):S.regex.lastIndex=0,l++,l>=this.maxReplaces)break}}),e}nest(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i,s,o;const l=(a,h)=>{const f=this.nestingOptionsSeparator;if(a.indexOf(f)<0)return a;const p=a.split(new RegExp(`${f}[ ]*{`));let v=`{${p[1]}`;a=p[0],v=this.interpolate(v,o);const y=v.match(/'/g),S=v.match(/"/g);(((y==null?void 0:y.length)??0)%2===0&&!S||S.length%2!==0)&&(v=v.replace(/'/g,'"'));try{o=JSON.parse(v),h&&(o={...h,...o})}catch(C){return this.logger.warn(`failed parsing options string in nesting for key ${a}`,C),`${a}${f}${v}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,a};for(;i=this.nestingRegexp.exec(e);){let a=[];o={...r},o=o.replace&&!mi(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let h=!1;if(i[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(i[1])){const f=i[1].split(this.formatSeparator).map(p=>p.trim());i[1]=f.shift(),a=f,h=!0}if(s=t(l.call(this,i[1].trim(),o),o),s&&i[0]===e&&!mi(s))return s;mi(s)||(s=NJ(s)),s||(this.logger.warn(`missed to resolve ${i[1]} for nesting ${e}`),s=""),h&&(s=a.reduce((f,p)=>this.format(f,p,r.lng,{...r,interpolationkey:i[1].trim()}),s.trim())),e=e.replace(i[0],s),this.regexp.lastIndex=0}return e}}const YHe=n=>{let e=n.toLowerCase().trim();const t={};if(n.indexOf("(")>-1){const r=n.split("(");e=r[0].toLowerCase().trim();const i=r[1].substring(0,r[1].length-1);e==="currency"&&i.indexOf(":")<0?t.currency||(t.currency=i.trim()):e==="relativetime"&&i.indexOf(":")<0?t.range||(t.range=i.trim()):i.split(";").forEach(o=>{if(o){const[l,...a]=o.split(":"),h=a.join(":").trim().replace(/^'+|'+$/g,""),f=l.trim();t[f]||(t[f]=h),h==="false"&&(t[f]=!1),h==="true"&&(t[f]=!0),isNaN(h)||(t[f]=parseInt(h,10))}})}return{formatName:e,formatOptions:t}},K1=n=>{const e={};return(t,r,i)=>{let s=i;i&&i.interpolationkey&&i.formatParams&&i.formatParams[i.interpolationkey]&&i[i.interpolationkey]&&(s={...s,[i.interpolationkey]:void 0});const o=r+JSON.stringify(s);let l=e[o];return l||(l=n(OL(r),i),e[o]=l),l(t)}};class KHe{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=ap.create("formatter"),this.options=e,this.formats={number:K1((t,r)=>{const i=new Intl.NumberFormat(t,{...r});return s=>i.format(s)}),currency:K1((t,r)=>{const i=new Intl.NumberFormat(t,{...r,style:"currency"});return s=>i.format(s)}),datetime:K1((t,r)=>{const i=new Intl.DateTimeFormat(t,{...r});return s=>i.format(s)}),relativetime:K1((t,r)=>{const i=new Intl.RelativeTimeFormat(t,{...r});return s=>i.format(s,r.range||"day")}),list:K1((t,r)=>{const i=new Intl.ListFormat(t,{...r});return s=>i.format(s)})},this.init(e)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=K1(t)}format(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const s=t.split(this.formatSeparator);if(s.length>1&&s[0].indexOf("(")>1&&s[0].indexOf(")")<0&&s.find(l=>l.indexOf(")")>-1)){const l=s.findIndex(a=>a.indexOf(")")>-1);s[0]=[s[0],...s.splice(1,l)].join(this.formatSeparator)}return s.reduce((l,a)=>{var p;const{formatName:h,formatOptions:f}=YHe(a);if(this.formats[h]){let v=l;try{const y=((p=i==null?void 0:i.formatParams)==null?void 0:p[i.interpolationkey])||{},S=y.locale||y.lng||i.locale||i.lng||r;v=this.formats[h](l,S,{...f,...i,...y})}catch(y){this.logger.warn(y)}return v}else this.logger.warn(`there was no format function for ${h}`);return l},e)}}const JHe=(n,e)=>{n.pending[e]!==void 0&&(delete n.pending[e],n.pendingCount--)};class QHe extends NB{constructor(e,t,r){var s,o;let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=i,this.logger=ap.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=i.maxParallelReads||10,this.readingCalls=0,this.maxRetries=i.maxRetries>=0?i.maxRetries:5,this.retryTimeout=i.retryTimeout>=1?i.retryTimeout:350,this.state={},this.queue=[],(o=(s=this.backend)==null?void 0:s.init)==null||o.call(s,r,i.backend,i)}queueLoad(e,t,r,i){const s={},o={},l={},a={};return e.forEach(h=>{let f=!0;t.forEach(p=>{const v=`${h}|${p}`;!r.reload&&this.store.hasResourceBundle(h,p)?this.state[v]=2:this.state[v]<0||(this.state[v]===1?o[v]===void 0&&(o[v]=!0):(this.state[v]=1,f=!1,o[v]===void 0&&(o[v]=!0),s[v]===void 0&&(s[v]=!0),a[p]===void 0&&(a[p]=!0)))}),f||(l[h]=!0)}),(Object.keys(s).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(s),pending:Object.keys(o),toLoadLanguages:Object.keys(l),toLoadNamespaces:Object.keys(a)}}loaded(e,t,r){const i=e.split("|"),s=i[0],o=i[1];t&&this.emit("failedLoading",s,o,t),!t&&r&&this.store.addResourceBundle(s,o,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const l={};this.queue.forEach(a=>{zHe(a.loaded,[s],o),JHe(a,e),t&&a.errors.push(t),a.pendingCount===0&&!a.done&&(Object.keys(a.loaded).forEach(h=>{l[h]||(l[h]={});const f=a.loaded[h];f.length&&f.forEach(p=>{l[h][p]===void 0&&(l[h][p]=!0)})}),a.done=!0,a.errors.length?a.callback(a.errors):a.callback())}),this.emit("loaded",l),this.queue=this.queue.filter(a=>!a.done)}read(e,t,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:r,tried:i,wait:s,callback:o});return}this.readingCalls++;const l=(h,f)=>{if(this.readingCalls--,this.waitingReads.length>0){const p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(h&&f&&i<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,r,i+1,s*2,o)},s);return}o(h,f)},a=this.backend[r].bind(this.backend);if(a.length===2){try{const h=a(e,t);h&&typeof h.then=="function"?h.then(f=>l(null,f)).catch(l):l(null,h)}catch(h){l(h)}return}return a(e,t,l)}prepareLoading(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();mi(e)&&(e=this.languageUtils.toResolveHierarchy(e)),mi(t)&&(t=[t]);const s=this.queueLoad(e,t,r,i);if(!s.toLoad.length)return s.pending.length||i(),null;s.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e.split("|"),i=r[0],s=r[1];this.read(i,s,"read",void 0,void 0,(o,l)=>{o&&this.logger.warn(`${t}loading namespace ${s} for language ${i} failed`,o),!o&&l&&this.logger.log(`${t}loaded namespace ${s} for language ${i}`,l),this.loaded(e,o,l)})}saveMissing(e,t,r,i,s){var a,h,f,p,v;let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},l=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if((h=(a=this.services)==null?void 0:a.utils)!=null&&h.hasLoadedNamespace&&!((p=(f=this.services)==null?void 0:f.utils)!=null&&p.hasLoadedNamespace(t))){this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(r==null||r==="")){if((v=this.backend)!=null&&v.create){const y={...o,isUpdate:s},S=this.backend.create.bind(this.backend);if(S.length<6)try{let C;S.length===5?C=S(e,t,r,i,y):C=S(e,t,r,i),C&&typeof C.then=="function"?C.then(M=>l(null,M)).catch(l):l(null,C)}catch(C){l(C)}else S(e,t,r,i,l,y)}!e||!e[0]||this.store.addResource(e[0],t,r,i)}}}const qJ=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:n=>{let e={};if(typeof n[1]=="object"&&(e=n[1]),mi(n[1])&&(e.defaultValue=n[1]),mi(n[2])&&(e.tDescription=n[2]),typeof n[2]=="object"||typeof n[3]=="object"){const t=n[3]||n[2];Object.keys(t).forEach(r=>{e[r]=t[r]})}return e},interpolation:{escapeValue:!0,format:n=>n,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),ZJ=n=>{var e,t;return mi(n.ns)&&(n.ns=[n.ns]),mi(n.fallbackLng)&&(n.fallbackLng=[n.fallbackLng]),mi(n.fallbackNS)&&(n.fallbackNS=[n.fallbackNS]),((t=(e=n.supportedLngs)==null?void 0:e.indexOf)==null?void 0:t.call(e,"cimode"))<0&&(n.supportedLngs=n.supportedLngs.concat(["cimode"])),typeof n.initImmediate=="boolean"&&(n.initAsync=n.initImmediate),n},HI=()=>{},e9e=n=>{Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(t=>{typeof n[t]=="function"&&(n[t]=n[t].bind(n))})};class FM extends NB{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=ZJ(e),this.services={},this.logger=ap,this.modules={external:[]},e9e(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(r=t,t={}),t.defaultNS==null&&t.ns&&(mi(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const i=qJ();this.options={...i,...this.options,...ZJ(t)},this.options.interpolation={...i.interpolation,...this.options.interpolation},t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const s=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?ap.init(s(this.modules.logger),this.options):ap.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:f=KHe;const p=new jJ(this.options);this.store=new VJ(this.options.resources,this.options);const v=this.services;v.logger=ap,v.resourceStore=this.store,v.languageUtils=p,v.pluralResolver=new qHe(p,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),f&&(!this.options.interpolation.format||this.options.interpolation.format===i.interpolation.format)&&(v.formatter=s(f),v.formatter.init(v,this.options),this.options.interpolation.format=v.formatter.format.bind(v.formatter)),v.interpolator=new ZHe(this.options),v.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},v.backendConnector=new QHe(s(this.modules.backend),v.resourceStore,v,this.options),v.backendConnector.on("*",function(y){for(var S=arguments.length,C=new Array(S>1?S-1:0),M=1;M<S;M++)C[M-1]=arguments[M];e.emit(y,...C)}),this.modules.languageDetector&&(v.languageDetector=s(this.modules.languageDetector),v.languageDetector.init&&v.languageDetector.init(v,this.options.detection,this.options)),this.modules.i18nFormat&&(v.i18nFormat=s(this.modules.i18nFormat),v.i18nFormat.init&&v.i18nFormat.init(this)),this.translator=new NL(this.services,this.options),this.translator.on("*",function(y){for(var S=arguments.length,C=new Array(S>1?S-1:0),M=1;M<S;M++)C[M-1]=arguments[M];e.emit(y,...C)}),this.modules.external.forEach(y=>{y.init&&y.init(this)})}if(this.format=this.options.interpolation.format,r||(r=HI),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=function(){return e.store[f](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=function(){return e.store[f](...arguments),e}});const a=wA(),h=()=>{const f=(p,v)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(v),r(p,v)};if(this.languages&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initAsync?h():setTimeout(h,0),a}loadResources(e){var s,o;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:HI;const i=mi(e)?e:this.language;if(typeof e=="function"&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if((i==null?void 0:i.toLowerCase())==="cimode"&&(!this.options.preload||this.options.preload.length===0))return r();const l=[],a=h=>{if(!h||h==="cimode")return;this.services.languageUtils.toResolveHierarchy(h).forEach(p=>{p!=="cimode"&&l.indexOf(p)<0&&l.push(p)})};i?a(i):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(f=>a(f)),(o=(s=this.options.preload)==null?void 0:s.forEach)==null||o.call(s,h=>a(h)),this.services.backendConnector.load(l,this.options.ns,h=>{!h&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),r(h)})}else r(null)}reloadResources(e,t,r){const i=wA();return typeof e=="function"&&(r=e,e=void 0),typeof t=="function"&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=HI),this.services.backendConnector.reload(e,t,s=>{i.resolve(),r(s)}),i}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&lhe.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const r=this.languages[t];if(!(["cimode","dev"].indexOf(r)>-1)&&this.store.hasLanguageSomeTranslations(r)){this.resolvedLanguage=r;break}}}changeLanguage(e,t){var r=this;this.isLanguageChangingTo=e;const i=wA();this.emit("languageChanging",e);const s=a=>{this.language=a,this.languages=this.services.languageUtils.toResolveHierarchy(a),this.resolvedLanguage=void 0,this.setResolvedLanguage(a)},o=(a,h)=>{h?(s(h),this.translator.changeLanguage(h),this.isLanguageChangingTo=void 0,this.emit("languageChanged",h),this.logger.log("languageChanged",h)):this.isLanguageChangingTo=void 0,i.resolve(function(){return r.t(...arguments)}),t&&t(a,function(){return r.t(...arguments)})},l=a=>{var f,p;!e&&!a&&this.services.languageDetector&&(a=[]);const h=mi(a)?a:this.services.languageUtils.getBestMatchFromCodes(a);h&&(this.language||s(h),this.translator.language||this.translator.changeLanguage(h),(p=(f=this.services.languageDetector)==null?void 0:f.cacheUserLanguage)==null||p.call(f,h)),this.loadResources(h,v=>{o(v,h)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?l(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(l):this.services.languageDetector.detect(l):l(e),i}getFixedT(e,t,r){var i=this;const s=function(o,l){let a;if(typeof l!="object"){for(var h=arguments.length,f=new Array(h>2?h-2:0),p=2;p<h;p++)f[p-2]=arguments[p];a=i.options.overloadTranslationOptionHandler([o,l].concat(f))}else a={...l};a.lng=a.lng||s.lng,a.lngs=a.lngs||s.lngs,a.ns=a.ns||s.ns,a.keyPrefix!==""&&(a.keyPrefix=a.keyPrefix||r||s.keyPrefix);const v=i.options.keySeparator||".";let y;return a.keyPrefix&&Array.isArray(o)?y=o.map(S=>`${a.keyPrefix}${v}${S}`):y=a.keyPrefix?`${a.keyPrefix}${v}${o}`:o,i.t(y,a)};return mi(e)?s.lng=e:s.lngs=e,s.ns=t,s.keyPrefix=r,s}t(){var i;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(i=this.translator)==null?void 0:i.translate(...t)}exists(){var i;for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return(i=this.translator)==null?void 0:i.exists(...t)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],i=this.options?this.options.fallbackLng:!1,s=this.languages[this.languages.length-1];if(r.toLowerCase()==="cimode")return!0;const o=(l,a)=>{const h=this.services.backendConnector.state[`${l}|${a}`];return h===-1||h===0||h===2};if(t.precheck){const l=t.precheck(this,o);if(l!==void 0)return l}return!!(this.hasResourceBundle(r,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(r,e)&&(!i||o(s,e)))}loadNamespaces(e,t){const r=wA();return this.options.ns?(mi(e)&&(e=[e]),e.forEach(i=>{this.options.ns.indexOf(i)<0&&this.options.ns.push(i)}),this.loadResources(i=>{r.resolve(),t&&t(i)}),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=wA();mi(e)&&(e=[e]);const i=this.options.preload||[],s=e.filter(o=>i.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return s.length?(this.options.preload=i.concat(s),this.loadResources(o=>{r.resolve(),t&&t(o)}),r):(t&&t(),Promise.resolve())}dir(e){var i,s;if(e||(e=this.resolvedLanguage||(((i=this.languages)==null?void 0:i.length)>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],r=((s=this.services)==null?void 0:s.languageUtils)||new jJ(qJ());return t.indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new FM(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:HI;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const i={...this.options,...e,isClone:!0},s=new FM(i);if((e.debug!==void 0||e.prefix!==void 0)&&(s.logger=s.logger.clone(e)),["store","services","language"].forEach(l=>{s[l]=this[l]}),s.services={...this.services},s.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},r){const l=Object.keys(this.store.data).reduce((a,h)=>(a[h]={...this.store.data[h]},Object.keys(a[h]).reduce((f,p)=>(f[p]={...a[h][p]},f),{})),{});s.store=new VJ(l,i),s.services.resourceStore=s.store}return s.translator=new NL(s.services,i),s.translator.on("*",function(l){for(var a=arguments.length,h=new Array(a>1?a-1:0),f=1;f<a;f++)h[f-1]=arguments[f];s.emit(l,...h)}),s.init(i,t),s.translator.options=i,s.translator.backendConnector.services.utils={hasLoadedNamespace:s.hasLoadedNamespace.bind(s)},s}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const El=FM.createInstance();El.createInstance=FM.createInstance;El.createInstance;El.dir;El.init;El.loadResources;El.reloadResources;El.use;El.changeLanguage;El.getFixedT;El.t;El.exists;El.setDefaultNamespace;El.hasLoadedNamespace;El.loadNamespaces;El.loadLanguages;const t9e="Hello, I am",n9e="Shealin",r9e="a graduate student from Nanjing, China (currently...)",i9e="+86-15651736857",s9e="you_yxt@163.com",a9e="communist",o9e={main:"Urban Geography, Traffic Planning and Analysis, Story Maps, AR Maps",gis:"GIS developer: QGISGeoserverPostgreSQL&PostGIS",fe:"Front End 3Dhtml&css&js, nodejs, react; BootStrap, ECharts; ThreeJS, Cesium, WebGL",ar:"ARVuforiaU3DMapbox SDK for UnityLua",future:"I have a background in GIS, Augmented Reality and front end, so this is like the perfect place for me."},l9e={title:"Student life",info:"I have a lot of experiences in studying and researching, and I am constantly improving myself...",btnText:"Learn more"},c9e={title:"Projects",info:"I have written interesting projects by myself, and have worked with multiple teams...",btnText:"View projects",fr:"My",ed:"Projects and Internship",basicIntro:"I've embarked on numerous projects throughout the years, but these are the ones I hold closest to my heart. Many of them are open-source, so if you come across something that piques your interest, feel free to explore the codebase and contribute your ideas for further enhancements. You collaboration is highly valued!"},u9e={title:"Contact",info:"If you are interested in me, please feel free to contact me...",btnText:"Let's talk"},h9e={title:"Gallery"},f9e={greeting:t9e,name:n9e,basicInfo:r9e,concat:i9e,email:s9e,policy:a9e,research:o9e,aboutMe:l9e,projects:c9e,contact:u9e,gallery:h9e},d9e="",p9e="",m9e="/+86-15651736857",g9e="you_yxt@163.com",v9e="(...)",_9e="",y9e={main:"AR",gis:"GISArcGIS/QGISGeoserverPostgreSQL&PostGIS",fe:"3Dhtml&css&js, nodejs, react; BootStrap, ECharts; ThreeJS, Cesium, WebGL",ar:"ARVuforiaU3DMapbox SDK for UnityLua",future:""},x9e={title:"",info:"...",btnText:""},b9e={title:"",info:"...",btnText:"",fr:"",ed:"",basicIntro:""},w9e={title:"",info:"?",btnText:""},S9e={title:""},A9e={greeting:d9e,name:p9e,concat:m9e,email:g9e,basicInfo:v9e,policy:_9e,research:y9e,aboutMe:x9e,projects:b9e,contact:w9e,gallery:S9e};El.init({interpolation:{escapeValue:!1},lng:"zh",resources:{en:{translation:f9e},zh:{translation:A9e}}});BN.createRoot(document.getElementById("root")).render(me.jsx(dTe,{i18n:El,children:me.jsx(OHe,{})}))});export default T9e();
